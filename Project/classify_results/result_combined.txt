
Load Dataset
label column: label
label dictionary: {'CC': 0, 'EC': 1, 'HGSC': 2, 'LGSC': 3, 'MC': 4}
number of classes: 5
slide-level counts:  
 label
2    206
0    101
1    117
3     50
4     51
Name: count, dtype: int64
Patient-LVL; Number of samples registered in class 0: 101
Slide-LVL; Number of samples registered in class 0: 101
Patient-LVL; Number of samples registered in class 1: 117
Slide-LVL; Number of samples registered in class 1: 117
Patient-LVL; Number of samples registered in class 2: 206
Slide-LVL; Number of samples registered in class 2: 206
Patient-LVL; Number of samples registered in class 3: 50
Slide-LVL; Number of samples registered in class 3: 50
Patient-LVL; Number of samples registered in class 4: 51
Slide-LVL; Number of samples registered in class 4: 51
split_dir:  splits/task_1_tumor_subtyping_5_classes_test50_100
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  task_1_tumor_subtyping_5_classes_test50
max_epochs:  200
results_dir:  ./results
lr:  0.0002
experiment:  task_1_tumor_subtyping_5_classes_test50
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_sb
model_size:  small
use_drop_out:  0.25
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/task_1_tumor_subtyping_5_classes_test50_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.4917, instance_loss: 1.1720, weighted_loss: 1.3958, label: 4, bag_size: 524
batch 39, loss: 1.4898, instance_loss: 1.0835, weighted_loss: 1.3679, label: 0, bag_size: 729
batch 59, loss: 1.7156, instance_loss: 0.9089, weighted_loss: 1.4736, label: 3, bag_size: 729
batch 79, loss: 1.7193, instance_loss: 0.7467, weighted_loss: 1.4275, label: 0, bag_size: 371
batch 99, loss: 1.5461, instance_loss: 0.6373, weighted_loss: 1.2735, label: 0, bag_size: 410
batch 119, loss: 1.4645, instance_loss: 0.5952, weighted_loss: 1.2037, label: 0, bag_size: 729
batch 139, loss: 1.4727, instance_loss: 0.5358, weighted_loss: 1.1916, label: 4, bag_size: 542
batch 159, loss: 1.4101, instance_loss: 0.5163, weighted_loss: 1.1420, label: 4, bag_size: 729
batch 179, loss: 1.3522, instance_loss: 0.5012, weighted_loss: 1.0969, label: 0, bag_size: 801
batch 199, loss: 1.7776, instance_loss: 0.5290, weighted_loss: 1.4030, label: 4, bag_size: 1121
batch 219, loss: 1.7944, instance_loss: 0.5323, weighted_loss: 1.4158, label: 2, bag_size: 351
batch 239, loss: 1.8994, instance_loss: 0.5370, weighted_loss: 1.4907, label: 2, bag_size: 482
batch 259, loss: 1.3417, instance_loss: 0.4678, weighted_loss: 1.0795, label: 3, bag_size: 936
batch 279, loss: 1.2766, instance_loss: 0.4667, weighted_loss: 1.0336, label: 3, bag_size: 729
batch 299, loss: 1.9173, instance_loss: 0.5463, weighted_loss: 1.5060, label: 2, bag_size: 307
batch 319, loss: 1.8066, instance_loss: 0.5498, weighted_loss: 1.4296, label: 0, bag_size: 371
batch 339, loss: 1.7283, instance_loss: 0.5224, weighted_loss: 1.3665, label: 1, bag_size: 925
batch 359, loss: 1.4120, instance_loss: 0.5004, weighted_loss: 1.1385, label: 0, bag_size: 239
batch 379, loss: 1.5481, instance_loss: 0.5151, weighted_loss: 1.2382, label: 4, bag_size: 663
batch 399, loss: 1.9303, instance_loss: 0.5536, weighted_loss: 1.5173, label: 2, bag_size: 907
batch 419, loss: 1.8832, instance_loss: 0.5586, weighted_loss: 1.4858, label: 2, bag_size: 869


class 0 clustering acc 0.9958235294117647: correct 16929/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 0, train_loss: 1.5757, train_clustering_loss:  0.6222, train_error: 0.7200
class 0: acc 0.25, correct 22/88
class 1: acc 0.0, correct 0/77
class 2: acc 0.0, correct 0/69
class 3: acc 0.5106382978723404, correct 48/94
class 4: acc 0.5051546391752577, correct 49/97

Val Set, val_loss: 1.6529, val_error: 0.9400, auc: 0.5343
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.2, correct 1/5
class 1: acc 0.0, correct 0/20
class 2: acc 0.0, correct 0/21
class 3: acc 0.0, correct 0/2
class 4: acc 1.0, correct 2/2
Validation loss decreased (inf --> 1.652939).  Saving model ...


batch 19, loss: 1.3004, instance_loss: 0.5056, weighted_loss: 1.0620, label: 2, bag_size: 1133
batch 39, loss: 1.8420, instance_loss: 0.5369, weighted_loss: 1.4505, label: 1, bag_size: 487
batch 59, loss: 1.5814, instance_loss: 0.5318, weighted_loss: 1.2665, label: 1, bag_size: 754
batch 79, loss: 1.5794, instance_loss: 0.4917, weighted_loss: 1.2531, label: 4, bag_size: 1278
batch 99, loss: 1.7809, instance_loss: 0.5298, weighted_loss: 1.4056, label: 3, bag_size: 729
batch 119, loss: 1.5397, instance_loss: 0.5096, weighted_loss: 1.2307, label: 0, bag_size: 338
batch 139, loss: 1.5355, instance_loss: 0.5103, weighted_loss: 1.2280, label: 1, bag_size: 1724
batch 159, loss: 1.8413, instance_loss: 0.5310, weighted_loss: 1.4482, label: 4, bag_size: 366
batch 179, loss: 1.6398, instance_loss: 0.5108, weighted_loss: 1.3011, label: 3, bag_size: 556
batch 199, loss: 1.8128, instance_loss: 0.5561, weighted_loss: 1.4358, label: 2, bag_size: 941
batch 219, loss: 1.2872, instance_loss: 0.4915, weighted_loss: 1.0485, label: 4, bag_size: 436
batch 239, loss: 1.5614, instance_loss: 0.4931, weighted_loss: 1.2409, label: 3, bag_size: 1253
batch 259, loss: 1.0828, instance_loss: 0.4439, weighted_loss: 0.8911, label: 4, bag_size: 754
batch 279, loss: 1.9782, instance_loss: 0.5624, weighted_loss: 1.5534, label: 2, bag_size: 649
batch 299, loss: 2.0060, instance_loss: 0.5524, weighted_loss: 1.5700, label: 1, bag_size: 1559
batch 319, loss: 1.2494, instance_loss: 0.5165, weighted_loss: 1.0295, label: 4, bag_size: 729
batch 339, loss: 1.3253, instance_loss: 0.4400, weighted_loss: 1.0597, label: 3, bag_size: 936
batch 359, loss: 1.5259, instance_loss: 0.5067, weighted_loss: 1.2201, label: 2, bag_size: 356
batch 379, loss: 1.0063, instance_loss: 0.4638, weighted_loss: 0.8436, label: 0, bag_size: 545
batch 399, loss: 1.4240, instance_loss: 0.5001, weighted_loss: 1.1468, label: 2, bag_size: 1378
batch 419, loss: 2.1113, instance_loss: 0.5128, weighted_loss: 1.6318, label: 3, bag_size: 952


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4971, train_clustering_loss:  0.5048, train_error: 0.5976
class 0: acc 0.5393258426966292, correct 48/89
class 1: acc 0.1917808219178082, correct 14/73
class 2: acc 0.30337078651685395, correct 27/89
class 3: acc 0.3953488372093023, correct 34/86
class 4: acc 0.5454545454545454, correct 48/88

Val Set, val_loss: 1.5090, val_error: 0.6600, auc: 0.5555
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.2, correct 1/5
class 1: acc 0.7, correct 14/20
class 2: acc 0.09523809523809523, correct 2/21
class 3: acc 0.0, correct 0/2
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.652939 --> 1.508991).  Saving model ...


batch 19, loss: 1.4835, instance_loss: 0.5053, weighted_loss: 1.1900, label: 4, bag_size: 533
batch 39, loss: 0.5892, instance_loss: 0.4312, weighted_loss: 0.5418, label: 4, bag_size: 729
batch 59, loss: 1.1230, instance_loss: 0.4554, weighted_loss: 0.9227, label: 1, bag_size: 1261
batch 79, loss: 0.7618, instance_loss: 0.4660, weighted_loss: 0.6731, label: 4, bag_size: 729
batch 99, loss: 1.3458, instance_loss: 0.4585, weighted_loss: 1.0796, label: 4, bag_size: 511
batch 119, loss: 1.3172, instance_loss: 0.5043, weighted_loss: 1.0733, label: 2, bag_size: 469
batch 139, loss: 1.1302, instance_loss: 0.4629, weighted_loss: 0.9300, label: 0, bag_size: 729
batch 159, loss: 0.7923, instance_loss: 0.4272, weighted_loss: 0.6828, label: 1, bag_size: 1127
batch 179, loss: 1.3990, instance_loss: 0.5018, weighted_loss: 1.1299, label: 2, bag_size: 500
batch 199, loss: 1.5507, instance_loss: 0.4827, weighted_loss: 1.2303, label: 1, bag_size: 343
batch 219, loss: 1.4918, instance_loss: 0.4817, weighted_loss: 1.1887, label: 1, bag_size: 1559
batch 239, loss: 1.4173, instance_loss: 0.4560, weighted_loss: 1.1289, label: 1, bag_size: 700
batch 259, loss: 1.6949, instance_loss: 0.5205, weighted_loss: 1.3426, label: 4, bag_size: 1278
batch 279, loss: 1.6327, instance_loss: 0.4927, weighted_loss: 1.2907, label: 0, bag_size: 245
batch 299, loss: 1.7713, instance_loss: 0.4781, weighted_loss: 1.3833, label: 2, bag_size: 758
batch 319, loss: 1.0313, instance_loss: 0.4537, weighted_loss: 0.8580, label: 1, bag_size: 636
batch 339, loss: 1.1603, instance_loss: 0.4616, weighted_loss: 0.9507, label: 2, bag_size: 248
batch 359, loss: 1.0573, instance_loss: 0.4317, weighted_loss: 0.8696, label: 3, bag_size: 1172
batch 379, loss: 1.4600, instance_loss: 0.5074, weighted_loss: 1.1742, label: 0, bag_size: 898
batch 399, loss: 1.7387, instance_loss: 0.5216, weighted_loss: 1.3736, label: 2, bag_size: 1167
batch 419, loss: 1.3913, instance_loss: 0.4876, weighted_loss: 1.1202, label: 2, bag_size: 869


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.3628, train_clustering_loss:  0.4854, train_error: 0.5435
class 0: acc 0.4430379746835443, correct 35/79
class 1: acc 0.5617977528089888, correct 50/89
class 2: acc 0.3695652173913043, correct 34/92
class 3: acc 0.4, correct 34/85
class 4: acc 0.5125, correct 41/80

Val Set, val_loss: 1.4330, val_error: 0.6000, auc: 0.5981
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.7, correct 14/20
class 2: acc 0.14285714285714285, correct 3/21
class 3: acc 0.0, correct 0/2
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.508991 --> 1.433030).  Saving model ...


batch 19, loss: 1.9814, instance_loss: 0.5506, weighted_loss: 1.5522, label: 4, bag_size: 1337
batch 39, loss: 0.8400, instance_loss: 0.4468, weighted_loss: 0.7221, label: 4, bag_size: 947
batch 59, loss: 1.1798, instance_loss: 0.4536, weighted_loss: 0.9619, label: 4, bag_size: 928
batch 79, loss: 0.9024, instance_loss: 0.3987, weighted_loss: 0.7513, label: 3, bag_size: 316
batch 99, loss: 2.2306, instance_loss: 0.5755, weighted_loss: 1.7341, label: 2, bag_size: 1677
batch 119, loss: 1.9375, instance_loss: 0.5291, weighted_loss: 1.5150, label: 4, bag_size: 533
batch 139, loss: 2.2010, instance_loss: 0.5657, weighted_loss: 1.7104, label: 2, bag_size: 571
batch 159, loss: 0.8502, instance_loss: 0.3669, weighted_loss: 0.7052, label: 3, bag_size: 729
batch 179, loss: 0.9592, instance_loss: 0.4290, weighted_loss: 0.8001, label: 1, bag_size: 834
batch 199, loss: 0.8870, instance_loss: 0.4086, weighted_loss: 0.7435, label: 1, bag_size: 1255
batch 219, loss: 1.0207, instance_loss: 0.4697, weighted_loss: 0.8554, label: 2, bag_size: 323
batch 239, loss: 0.9632, instance_loss: 0.3950, weighted_loss: 0.7927, label: 1, bag_size: 1144
batch 259, loss: 0.7554, instance_loss: 0.4274, weighted_loss: 0.6570, label: 4, bag_size: 388
batch 279, loss: 1.0942, instance_loss: 0.4256, weighted_loss: 0.8936, label: 1, bag_size: 860
batch 299, loss: 0.5022, instance_loss: 0.3558, weighted_loss: 0.4583, label: 4, bag_size: 1235
batch 319, loss: 1.0344, instance_loss: 0.4485, weighted_loss: 0.8586, label: 1, bag_size: 534
batch 339, loss: 1.1940, instance_loss: 0.4159, weighted_loss: 0.9606, label: 4, bag_size: 754
batch 359, loss: 0.5416, instance_loss: 0.4179, weighted_loss: 0.5045, label: 4, bag_size: 729
batch 379, loss: 1.3440, instance_loss: 0.4289, weighted_loss: 1.0695, label: 4, bag_size: 436
batch 399, loss: 0.7505, instance_loss: 0.4136, weighted_loss: 0.6494, label: 0, bag_size: 367
batch 419, loss: 0.3510, instance_loss: 0.2575, weighted_loss: 0.3230, label: 3, bag_size: 305


class 0 clustering acc 0.9992352941176471: correct 16987/17000
class 1 clustering acc 0.0029411764705882353: correct 10/3400
Epoch: 3, train_loss: 1.1758, train_clustering_loss:  0.4537, train_error: 0.3929
class 0: acc 0.5974025974025974, correct 46/77
class 1: acc 0.5869565217391305, correct 54/92
class 2: acc 0.3375, correct 27/80
class 3: acc 0.7849462365591398, correct 73/93
class 4: acc 0.6987951807228916, correct 58/83

Val Set, val_loss: 1.3078, val_error: 0.5600, auc: 0.7161
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.75, correct 15/20
class 2: acc 0.19047619047619047, correct 4/21
class 3: acc 0.0, correct 0/2
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.433030 --> 1.307848).  Saving model ...


batch 19, loss: 0.5224, instance_loss: 0.4183, weighted_loss: 0.4911, label: 1, bag_size: 700
batch 39, loss: 0.6547, instance_loss: 0.3389, weighted_loss: 0.5599, label: 1, bag_size: 474
batch 59, loss: 0.7241, instance_loss: 0.4036, weighted_loss: 0.6280, label: 0, bag_size: 424
batch 79, loss: 1.5539, instance_loss: 0.4770, weighted_loss: 1.2308, label: 1, bag_size: 786
batch 99, loss: 1.8243, instance_loss: 0.5309, weighted_loss: 1.4363, label: 2, bag_size: 319
batch 119, loss: 0.6263, instance_loss: 0.4610, weighted_loss: 0.5767, label: 0, bag_size: 729
batch 139, loss: 0.4719, instance_loss: 0.3146, weighted_loss: 0.4247, label: 4, bag_size: 826
batch 159, loss: 0.9536, instance_loss: 0.4442, weighted_loss: 0.8008, label: 2, bag_size: 292
batch 179, loss: 0.5507, instance_loss: 0.3756, weighted_loss: 0.4982, label: 4, bag_size: 524
batch 199, loss: 1.4516, instance_loss: 0.5499, weighted_loss: 1.1811, label: 2, bag_size: 589
batch 219, loss: 1.4690, instance_loss: 0.5182, weighted_loss: 1.1837, label: 2, bag_size: 537
batch 239, loss: 1.1217, instance_loss: 0.4064, weighted_loss: 0.9071, label: 3, bag_size: 1250
batch 259, loss: 1.0336, instance_loss: 0.4666, weighted_loss: 0.8635, label: 0, bag_size: 367
batch 279, loss: 3.2318, instance_loss: 0.8898, weighted_loss: 2.5292, label: 2, bag_size: 1108
batch 299, loss: 1.0793, instance_loss: 0.4054, weighted_loss: 0.8771, label: 4, bag_size: 974
batch 319, loss: 1.6452, instance_loss: 0.5600, weighted_loss: 1.3196, label: 0, bag_size: 1257
batch 339, loss: 1.2101, instance_loss: 0.5672, weighted_loss: 1.0172, label: 2, bag_size: 1231
batch 359, loss: 0.8533, instance_loss: 0.4204, weighted_loss: 0.7234, label: 2, bag_size: 1448
batch 379, loss: 0.3229, instance_loss: 0.3214, weighted_loss: 0.3225, label: 0, bag_size: 616
batch 399, loss: 0.8223, instance_loss: 0.4584, weighted_loss: 0.7131, label: 4, bag_size: 656
batch 419, loss: 0.3079, instance_loss: 0.5481, weighted_loss: 0.3800, label: 4, bag_size: 882


class 0 clustering acc 0.9984117647058823: correct 16973/17000
class 1 clustering acc 0.02323529411764706: correct 79/3400
Epoch: 4, train_loss: 1.0376, train_clustering_loss:  0.4369, train_error: 0.3647
class 0: acc 0.6666666666666666, correct 54/81
class 1: acc 0.5975609756097561, correct 49/82
class 2: acc 0.45918367346938777, correct 45/98
class 3: acc 0.7142857142857143, correct 60/84
class 4: acc 0.775, correct 62/80

Val Set, val_loss: 1.3700, val_error: 0.5600, auc: 0.6847
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.45, correct 9/20
class 2: acc 0.42857142857142855, correct 9/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.5613, instance_loss: 0.7138, weighted_loss: 2.0071, label: 3, bag_size: 281
batch 39, loss: 0.9593, instance_loss: 0.4777, weighted_loss: 0.8148, label: 2, bag_size: 1155
batch 59, loss: 1.0278, instance_loss: 0.4959, weighted_loss: 0.8682, label: 1, bag_size: 1014
batch 79, loss: 0.4292, instance_loss: 0.3547, weighted_loss: 0.4069, label: 0, bag_size: 402
batch 99, loss: 1.1099, instance_loss: 0.4362, weighted_loss: 0.9078, label: 2, bag_size: 324
batch 119, loss: 0.9475, instance_loss: 0.3958, weighted_loss: 0.7820, label: 1, bag_size: 754
batch 139, loss: 2.8899, instance_loss: 0.6056, weighted_loss: 2.2046, label: 0, bag_size: 818
batch 159, loss: 1.1700, instance_loss: 0.4272, weighted_loss: 0.9472, label: 4, bag_size: 754
batch 179, loss: 0.2081, instance_loss: 0.3138, weighted_loss: 0.2398, label: 3, bag_size: 729
batch 199, loss: 1.9066, instance_loss: 0.6035, weighted_loss: 1.5157, label: 0, bag_size: 801
batch 219, loss: 0.1556, instance_loss: 0.2366, weighted_loss: 0.1799, label: 4, bag_size: 729
batch 239, loss: 0.0452, instance_loss: 0.1810, weighted_loss: 0.0860, label: 4, bag_size: 729
batch 259, loss: 2.5350, instance_loss: 0.6018, weighted_loss: 1.9551, label: 4, bag_size: 436
batch 279, loss: 1.7546, instance_loss: 0.5458, weighted_loss: 1.3920, label: 0, bag_size: 245
batch 299, loss: 0.4150, instance_loss: 0.1900, weighted_loss: 0.3475, label: 3, bag_size: 729
batch 319, loss: 2.1683, instance_loss: 0.5541, weighted_loss: 1.6841, label: 1, bag_size: 936
batch 339, loss: 0.5964, instance_loss: 0.4244, weighted_loss: 0.5448, label: 0, bag_size: 976
batch 359, loss: 0.3025, instance_loss: 0.3258, weighted_loss: 0.3095, label: 0, bag_size: 1466
batch 379, loss: 0.9207, instance_loss: 0.4494, weighted_loss: 0.7793, label: 4, bag_size: 590
batch 399, loss: 0.7553, instance_loss: 0.6006, weighted_loss: 0.7089, label: 0, bag_size: 729
batch 419, loss: 0.2027, instance_loss: 0.2669, weighted_loss: 0.2220, label: 4, bag_size: 790


class 0 clustering acc 0.9980588235294118: correct 16967/17000
class 1 clustering acc 0.09058823529411765: correct 308/3400
Epoch: 5, train_loss: 0.9038, train_clustering_loss:  0.4070, train_error: 0.2918
class 0: acc 0.8214285714285714, correct 69/84
class 1: acc 0.6666666666666666, correct 56/84
class 2: acc 0.4777777777777778, correct 43/90
class 3: acc 0.7362637362637363, correct 67/91
class 4: acc 0.868421052631579, correct 66/76

Val Set, val_loss: 1.1428, val_error: 0.4200, auc: 0.6534
class 0 clustering acc 0.9995: correct 1999/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.65, correct 13/20
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.307848 --> 1.142786).  Saving model ...


batch 19, loss: 0.0754, instance_loss: 0.1375, weighted_loss: 0.0940, label: 3, bag_size: 451
batch 39, loss: 0.4085, instance_loss: 0.3004, weighted_loss: 0.3761, label: 0, bag_size: 367
batch 59, loss: 0.2614, instance_loss: 0.2435, weighted_loss: 0.2560, label: 3, bag_size: 729
batch 79, loss: 0.2552, instance_loss: 0.2755, weighted_loss: 0.2613, label: 0, bag_size: 1517
batch 99, loss: 0.1594, instance_loss: 0.1165, weighted_loss: 0.1465, label: 3, bag_size: 556
batch 119, loss: 0.4283, instance_loss: 0.3567, weighted_loss: 0.4068, label: 0, bag_size: 476
batch 139, loss: 2.8359, instance_loss: 0.7175, weighted_loss: 2.2004, label: 3, bag_size: 281
batch 159, loss: 0.7103, instance_loss: 0.4290, weighted_loss: 0.6259, label: 2, bag_size: 314
batch 179, loss: 0.3303, instance_loss: 0.3201, weighted_loss: 0.3272, label: 3, bag_size: 1250
batch 199, loss: 0.2142, instance_loss: 0.4192, weighted_loss: 0.2757, label: 4, bag_size: 729
batch 219, loss: 2.2387, instance_loss: 0.5843, weighted_loss: 1.7424, label: 4, bag_size: 1337
batch 239, loss: 0.2060, instance_loss: 0.1601, weighted_loss: 0.1922, label: 4, bag_size: 729
batch 259, loss: 0.0909, instance_loss: 0.1420, weighted_loss: 0.1063, label: 4, bag_size: 1235
batch 279, loss: 0.5134, instance_loss: 0.3067, weighted_loss: 0.4514, label: 1, bag_size: 834
batch 299, loss: 0.7213, instance_loss: 0.4450, weighted_loss: 0.6384, label: 2, bag_size: 421
batch 319, loss: 0.0621, instance_loss: 0.3481, weighted_loss: 0.1479, label: 4, bag_size: 663
batch 339, loss: 0.9619, instance_loss: 0.4609, weighted_loss: 0.8116, label: 0, bag_size: 729
batch 359, loss: 0.7170, instance_loss: 0.4272, weighted_loss: 0.6301, label: 2, bag_size: 317
batch 379, loss: 0.8203, instance_loss: 0.4237, weighted_loss: 0.7013, label: 2, bag_size: 314
batch 399, loss: 1.6198, instance_loss: 0.5829, weighted_loss: 1.3087, label: 2, bag_size: 358
batch 419, loss: 0.2435, instance_loss: 0.2551, weighted_loss: 0.2469, label: 0, bag_size: 729


class 0 clustering acc 0.9968823529411764: correct 16947/17000
class 1 clustering acc 0.14470588235294118: correct 492/3400
Epoch: 6, train_loss: 0.7977, train_clustering_loss:  0.3888, train_error: 0.2729
class 0: acc 0.8375, correct 67/80
class 1: acc 0.6808510638297872, correct 64/94
class 2: acc 0.46835443037974683, correct 37/79
class 3: acc 0.8064516129032258, correct 75/93
class 4: acc 0.8354430379746836, correct 66/79

Val Set, val_loss: 1.1392, val_error: 0.3800, auc: 0.6412
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.02: correct 8/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.65, correct 13/20
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.142786 --> 1.139204).  Saving model ...


batch 19, loss: 0.1605, instance_loss: 0.2146, weighted_loss: 0.1767, label: 0, bag_size: 982
batch 39, loss: 0.1021, instance_loss: 0.2065, weighted_loss: 0.1334, label: 4, bag_size: 729
batch 59, loss: 0.8323, instance_loss: 0.4369, weighted_loss: 0.7137, label: 0, bag_size: 350
batch 79, loss: 1.0543, instance_loss: 0.6354, weighted_loss: 0.9286, label: 1, bag_size: 867
batch 99, loss: 0.6396, instance_loss: 0.3253, weighted_loss: 0.5453, label: 0, bag_size: 371
batch 119, loss: 2.0787, instance_loss: 0.5859, weighted_loss: 1.6308, label: 1, bag_size: 308
batch 139, loss: 0.2126, instance_loss: 0.4364, weighted_loss: 0.2797, label: 0, bag_size: 729
batch 159, loss: 0.0312, instance_loss: 0.2495, weighted_loss: 0.0967, label: 4, bag_size: 1474
batch 179, loss: 1.5078, instance_loss: 0.6932, weighted_loss: 1.2634, label: 1, bag_size: 1409
batch 199, loss: 0.7138, instance_loss: 0.4034, weighted_loss: 0.6207, label: 2, bag_size: 419
batch 219, loss: 0.0213, instance_loss: 0.1251, weighted_loss: 0.0524, label: 3, bag_size: 1069
batch 239, loss: 0.4123, instance_loss: 0.2908, weighted_loss: 0.3758, label: 0, bag_size: 375
batch 259, loss: 0.0717, instance_loss: 0.2113, weighted_loss: 0.1136, label: 4, bag_size: 646
batch 279, loss: 0.5819, instance_loss: 0.3900, weighted_loss: 0.5244, label: 1, bag_size: 949
batch 299, loss: 0.5132, instance_loss: 0.3100, weighted_loss: 0.4522, label: 2, bag_size: 846
batch 319, loss: 0.4419, instance_loss: 0.3638, weighted_loss: 0.4185, label: 0, bag_size: 1101
batch 339, loss: 1.2911, instance_loss: 0.4673, weighted_loss: 1.0439, label: 1, bag_size: 1014
batch 359, loss: 3.0807, instance_loss: 0.7139, weighted_loss: 2.3707, label: 1, bag_size: 1799
batch 379, loss: 0.4717, instance_loss: 0.3264, weighted_loss: 0.4281, label: 2, bag_size: 314
batch 399, loss: 0.6110, instance_loss: 0.1949, weighted_loss: 0.4861, label: 4, bag_size: 1002
batch 419, loss: 0.1116, instance_loss: 0.1744, weighted_loss: 0.1304, label: 3, bag_size: 316


class 0 clustering acc 0.9958823529411764: correct 16930/17000
class 1 clustering acc 0.15588235294117647: correct 530/3400
Epoch: 7, train_loss: 0.7850, train_clustering_loss:  0.3870, train_error: 0.2635
class 0: acc 0.8372093023255814, correct 72/86
class 1: acc 0.5128205128205128, correct 40/78
class 2: acc 0.6451612903225806, correct 60/93
class 3: acc 0.8352941176470589, correct 71/85
class 4: acc 0.8433734939759037, correct 70/83

Val Set, val_loss: 1.3551, val_error: 0.5200, auc: 0.6542
class 0 clustering acc 0.995: correct 1990/2000
class 1 clustering acc 0.005: correct 2/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.4, correct 8/20
class 2: acc 0.5714285714285714, correct 12/21
class 3: acc 0.0, correct 0/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.0393, instance_loss: 0.6041, weighted_loss: 1.6087, label: 0, bag_size: 282
batch 39, loss: 0.1205, instance_loss: 0.3795, weighted_loss: 0.1982, label: 4, bag_size: 663
batch 59, loss: 0.3047, instance_loss: 0.3271, weighted_loss: 0.3114, label: 2, bag_size: 1404
batch 79, loss: 0.7991, instance_loss: 0.3509, weighted_loss: 0.6647, label: 1, bag_size: 965
batch 99, loss: 0.1802, instance_loss: 0.1183, weighted_loss: 0.1616, label: 3, bag_size: 729
batch 119, loss: 0.7727, instance_loss: 0.4539, weighted_loss: 0.6770, label: 0, bag_size: 1196
batch 139, loss: 0.2863, instance_loss: 0.2791, weighted_loss: 0.2842, label: 0, bag_size: 607
batch 159, loss: 0.1028, instance_loss: 0.0932, weighted_loss: 0.0999, label: 3, bag_size: 556
batch 179, loss: 1.4631, instance_loss: 0.5671, weighted_loss: 1.1943, label: 4, bag_size: 436
batch 199, loss: 0.2295, instance_loss: 0.2817, weighted_loss: 0.2451, label: 0, bag_size: 1061
batch 219, loss: 0.5325, instance_loss: 0.4158, weighted_loss: 0.4975, label: 0, bag_size: 1196
batch 239, loss: 1.4322, instance_loss: 0.5325, weighted_loss: 1.1623, label: 1, bag_size: 1559
batch 259, loss: 0.0278, instance_loss: 0.1510, weighted_loss: 0.0647, label: 4, bag_size: 729
batch 279, loss: 1.7680, instance_loss: 0.6505, weighted_loss: 1.4327, label: 2, bag_size: 1231
batch 299, loss: 1.0495, instance_loss: 0.4839, weighted_loss: 0.8798, label: 2, bag_size: 878
batch 319, loss: 2.1855, instance_loss: 0.5728, weighted_loss: 1.7017, label: 0, bag_size: 801
batch 339, loss: 0.0236, instance_loss: 0.0470, weighted_loss: 0.0306, label: 3, bag_size: 1069
batch 359, loss: 0.0665, instance_loss: 0.0536, weighted_loss: 0.0626, label: 3, bag_size: 405
batch 379, loss: 1.4637, instance_loss: 0.5300, weighted_loss: 1.1835, label: 0, bag_size: 1527
batch 399, loss: 1.3194, instance_loss: 0.5125, weighted_loss: 1.0773, label: 1, bag_size: 1144
batch 419, loss: 0.4203, instance_loss: 0.2713, weighted_loss: 0.3756, label: 1, bag_size: 1239


class 0 clustering acc 0.9962352941176471: correct 16936/17000
class 1 clustering acc 0.22852941176470587: correct 777/3400
Epoch: 8, train_loss: 0.7417, train_clustering_loss:  0.3704, train_error: 0.2588
class 0: acc 0.7922077922077922, correct 61/77
class 1: acc 0.6823529411764706, correct 58/85
class 2: acc 0.5783132530120482, correct 48/83
class 3: acc 0.8315789473684211, correct 79/95
class 4: acc 0.8117647058823529, correct 69/85

Val Set, val_loss: 1.1979, val_error: 0.4600, auc: 0.6824
class 0 clustering acc 0.9935: correct 1987/2000
class 1 clustering acc 0.005: correct 2/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.45, correct 9/20
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3554, instance_loss: 0.3207, weighted_loss: 0.3450, label: 2, bag_size: 499
batch 39, loss: 0.6419, instance_loss: 0.3810, weighted_loss: 0.5636, label: 2, bag_size: 1148
batch 59, loss: 2.1795, instance_loss: 0.6291, weighted_loss: 1.7144, label: 1, bag_size: 1197
batch 79, loss: 2.7797, instance_loss: 0.6105, weighted_loss: 2.1289, label: 0, bag_size: 818
batch 99, loss: 0.2105, instance_loss: 0.4597, weighted_loss: 0.2853, label: 4, bag_size: 675
batch 119, loss: 0.7689, instance_loss: 0.3933, weighted_loss: 0.6562, label: 3, bag_size: 200
batch 139, loss: 0.4135, instance_loss: 0.2625, weighted_loss: 0.3682, label: 1, bag_size: 790
batch 159, loss: 0.0749, instance_loss: 0.3675, weighted_loss: 0.1627, label: 4, bag_size: 974
batch 179, loss: 0.2909, instance_loss: 0.1921, weighted_loss: 0.2612, label: 1, bag_size: 834
batch 199, loss: 0.1360, instance_loss: 0.5019, weighted_loss: 0.2458, label: 3, bag_size: 791
batch 219, loss: 0.0770, instance_loss: 0.1653, weighted_loss: 0.1035, label: 4, bag_size: 729
batch 239, loss: 0.0238, instance_loss: 0.2271, weighted_loss: 0.0848, label: 4, bag_size: 1278
batch 259, loss: 0.2862, instance_loss: 0.1964, weighted_loss: 0.2593, label: 1, bag_size: 847
batch 279, loss: 0.4909, instance_loss: 0.2539, weighted_loss: 0.4198, label: 3, bag_size: 533
batch 299, loss: 0.1066, instance_loss: 0.1270, weighted_loss: 0.1127, label: 3, bag_size: 729
batch 319, loss: 1.3092, instance_loss: 0.4820, weighted_loss: 1.0610, label: 1, bag_size: 1724
batch 339, loss: 0.1969, instance_loss: 0.2006, weighted_loss: 0.1980, label: 1, bag_size: 696
batch 359, loss: 0.3781, instance_loss: 0.3105, weighted_loss: 0.3578, label: 2, bag_size: 317
batch 379, loss: 0.1169, instance_loss: 0.1676, weighted_loss: 0.1321, label: 0, bag_size: 524
batch 399, loss: 0.0006, instance_loss: 0.0986, weighted_loss: 0.0300, label: 4, bag_size: 729
batch 419, loss: 0.2479, instance_loss: 0.4397, weighted_loss: 0.3055, label: 4, bag_size: 542


class 0 clustering acc 0.9944117647058823: correct 16905/17000
class 1 clustering acc 0.2026470588235294: correct 689/3400
Epoch: 9, train_loss: 0.7036, train_clustering_loss:  0.3750, train_error: 0.2471
class 0: acc 0.8, correct 60/75
class 1: acc 0.6224489795918368, correct 61/98
class 2: acc 0.6206896551724138, correct 54/87
class 3: acc 0.8875, correct 71/80
class 4: acc 0.8705882352941177, correct 74/85

Val Set, val_loss: 1.1909, val_error: 0.4200, auc: 0.6430
class 0 clustering acc 0.995: correct 1990/2000
class 1 clustering acc 0.0325: correct 13/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.6, correct 12/20
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2144, instance_loss: 0.5261, weighted_loss: 1.0079, label: 3, bag_size: 283
batch 39, loss: 2.3101, instance_loss: 0.5380, weighted_loss: 1.7785, label: 3, bag_size: 281
batch 59, loss: 0.1833, instance_loss: 0.2423, weighted_loss: 0.2010, label: 4, bag_size: 646
batch 79, loss: 0.0767, instance_loss: 0.3444, weighted_loss: 0.1570, label: 0, bag_size: 729
batch 99, loss: 0.1557, instance_loss: 0.3131, weighted_loss: 0.2029, label: 3, bag_size: 729
batch 119, loss: 0.6696, instance_loss: 0.5756, weighted_loss: 0.6414, label: 0, bag_size: 1301
batch 139, loss: 0.0783, instance_loss: 0.3534, weighted_loss: 0.1608, label: 3, bag_size: 936
batch 159, loss: 0.1144, instance_loss: 0.4612, weighted_loss: 0.2184, label: 4, bag_size: 663
batch 179, loss: 0.6262, instance_loss: 0.3797, weighted_loss: 0.5523, label: 4, bag_size: 590
batch 199, loss: 0.3873, instance_loss: 0.4504, weighted_loss: 0.4062, label: 1, bag_size: 102
batch 219, loss: 1.8685, instance_loss: 0.6722, weighted_loss: 1.5096, label: 3, bag_size: 281
batch 239, loss: 0.1768, instance_loss: 0.2211, weighted_loss: 0.1901, label: 4, bag_size: 773
batch 259, loss: 0.2275, instance_loss: 0.2623, weighted_loss: 0.2379, label: 2, bag_size: 323
batch 279, loss: 0.2583, instance_loss: 0.2573, weighted_loss: 0.2580, label: 0, bag_size: 729
batch 299, loss: 0.8056, instance_loss: 0.4246, weighted_loss: 0.6913, label: 2, bag_size: 883
batch 319, loss: 1.5696, instance_loss: 0.5520, weighted_loss: 1.2643, label: 1, bag_size: 377
batch 339, loss: 0.7958, instance_loss: 0.3990, weighted_loss: 0.6768, label: 1, bag_size: 348
batch 359, loss: 0.3049, instance_loss: 0.2590, weighted_loss: 0.2911, label: 0, bag_size: 413
batch 379, loss: 0.5357, instance_loss: 0.6047, weighted_loss: 0.5564, label: 4, bag_size: 663
batch 399, loss: 1.9214, instance_loss: 0.6872, weighted_loss: 1.5511, label: 1, bag_size: 700
batch 419, loss: 1.1876, instance_loss: 0.4907, weighted_loss: 0.9786, label: 2, bag_size: 1231


class 0 clustering acc 0.9929411764705882: correct 16880/17000
class 1 clustering acc 0.2529411764705882: correct 860/3400
Epoch: 10, train_loss: 0.6338, train_clustering_loss:  0.3639, train_error: 0.2165
class 0: acc 0.8736842105263158, correct 83/95
class 1: acc 0.6190476190476191, correct 52/84
class 2: acc 0.6746987951807228, correct 56/83
class 3: acc 0.8607594936708861, correct 68/79
class 4: acc 0.8809523809523809, correct 74/84

Val Set, val_loss: 1.1080, val_error: 0.4000, auc: 0.6608
class 0 clustering acc 0.9925: correct 1985/2000
class 1 clustering acc 0.04: correct 16/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.65, correct 13/20
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.0, correct 0/2
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.139204 --> 1.108043).  Saving model ...


batch 19, loss: 0.4677, instance_loss: 0.3850, weighted_loss: 0.4429, label: 2, bag_size: 358
batch 39, loss: 0.0036, instance_loss: 0.1250, weighted_loss: 0.0400, label: 4, bag_size: 764
batch 59, loss: 0.4081, instance_loss: 0.3442, weighted_loss: 0.3889, label: 1, bag_size: 754
batch 79, loss: 1.2573, instance_loss: 0.3876, weighted_loss: 0.9964, label: 3, bag_size: 533
batch 99, loss: 1.4593, instance_loss: 0.7752, weighted_loss: 1.2541, label: 2, bag_size: 636
batch 119, loss: 1.3950, instance_loss: 0.4705, weighted_loss: 1.1176, label: 3, bag_size: 281
batch 139, loss: 0.3279, instance_loss: 0.2560, weighted_loss: 0.3063, label: 2, bag_size: 941
batch 159, loss: 0.5456, instance_loss: 0.3766, weighted_loss: 0.4949, label: 2, bag_size: 499
batch 179, loss: 0.8167, instance_loss: 0.4396, weighted_loss: 0.7035, label: 1, bag_size: 959
batch 199, loss: 0.5073, instance_loss: 0.3700, weighted_loss: 0.4661, label: 3, bag_size: 697
batch 219, loss: 0.2047, instance_loss: 0.2196, weighted_loss: 0.2092, label: 1, bag_size: 1239
batch 239, loss: 2.1706, instance_loss: 0.5417, weighted_loss: 1.6819, label: 1, bag_size: 651
batch 259, loss: 0.1388, instance_loss: 0.1407, weighted_loss: 0.1394, label: 0, bag_size: 446
batch 279, loss: 0.3022, instance_loss: 0.2106, weighted_loss: 0.2747, label: 0, bag_size: 338
batch 299, loss: 0.5496, instance_loss: 0.2348, weighted_loss: 0.4552, label: 3, bag_size: 821
batch 319, loss: 0.0577, instance_loss: 0.1766, weighted_loss: 0.0934, label: 3, bag_size: 729
batch 339, loss: 0.0420, instance_loss: 0.4491, weighted_loss: 0.1641, label: 4, bag_size: 882
batch 359, loss: 0.7803, instance_loss: 0.4465, weighted_loss: 0.6802, label: 1, bag_size: 1255
batch 379, loss: 0.6096, instance_loss: 0.4019, weighted_loss: 0.5473, label: 0, bag_size: 381
batch 399, loss: 0.4298, instance_loss: 0.2528, weighted_loss: 0.3767, label: 0, bag_size: 1579
batch 419, loss: 0.5063, instance_loss: 0.3185, weighted_loss: 0.4500, label: 4, bag_size: 826


class 0 clustering acc 0.9934117647058823: correct 16888/17000
class 1 clustering acc 0.2664705882352941: correct 906/3400
Epoch: 11, train_loss: 0.6503, train_clustering_loss:  0.3667, train_error: 0.2424
class 0: acc 0.8170731707317073, correct 67/82
class 1: acc 0.5888888888888889, correct 53/90
class 2: acc 0.6097560975609756, correct 50/82
class 3: acc 0.8690476190476191, correct 73/84
class 4: acc 0.9080459770114943, correct 79/87

Val Set, val_loss: 1.1478, val_error: 0.4200, auc: 0.6336
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.04: correct 16/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.65, correct 13/20
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.0, correct 0/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3992, instance_loss: 0.3319, weighted_loss: 0.3790, label: 2, bag_size: 1404
batch 39, loss: 0.2864, instance_loss: 0.4812, weighted_loss: 0.3448, label: 4, bag_size: 675
batch 59, loss: 0.3494, instance_loss: 0.2756, weighted_loss: 0.3273, label: 2, bag_size: 941
batch 79, loss: 0.4579, instance_loss: 0.2922, weighted_loss: 0.4082, label: 1, bag_size: 858
batch 99, loss: 1.3368, instance_loss: 0.4539, weighted_loss: 1.0719, label: 1, bag_size: 535
batch 119, loss: 0.4662, instance_loss: 0.4635, weighted_loss: 0.4654, label: 2, bag_size: 271
batch 139, loss: 1.6704, instance_loss: 0.5019, weighted_loss: 1.3199, label: 1, bag_size: 1724
batch 159, loss: 0.0026, instance_loss: 0.0920, weighted_loss: 0.0294, label: 4, bag_size: 729
batch 179, loss: 0.0137, instance_loss: 0.1153, weighted_loss: 0.0442, label: 4, bag_size: 636
batch 199, loss: 0.7581, instance_loss: 0.5112, weighted_loss: 0.6840, label: 4, bag_size: 366
batch 219, loss: 1.1649, instance_loss: 0.4038, weighted_loss: 0.9366, label: 0, bag_size: 736
batch 239, loss: 0.3754, instance_loss: 0.3028, weighted_loss: 0.3536, label: 1, bag_size: 346
batch 259, loss: 1.7807, instance_loss: 0.6050, weighted_loss: 1.4280, label: 3, bag_size: 607
batch 279, loss: 1.5780, instance_loss: 0.5041, weighted_loss: 1.2558, label: 1, bag_size: 968
batch 299, loss: 1.1236, instance_loss: 0.6000, weighted_loss: 0.9665, label: 3, bag_size: 200
batch 319, loss: 0.7754, instance_loss: 0.4669, weighted_loss: 0.6828, label: 2, bag_size: 396
batch 339, loss: 0.1068, instance_loss: 0.1762, weighted_loss: 0.1276, label: 0, bag_size: 729
batch 359, loss: 0.9513, instance_loss: 0.4391, weighted_loss: 0.7976, label: 3, bag_size: 360
batch 379, loss: 0.1286, instance_loss: 0.5134, weighted_loss: 0.2440, label: 1, bag_size: 1152
batch 399, loss: 0.6425, instance_loss: 0.3867, weighted_loss: 0.5658, label: 3, bag_size: 360
batch 419, loss: 0.3081, instance_loss: 0.2403, weighted_loss: 0.2878, label: 0, bag_size: 1517


class 0 clustering acc 0.9930588235294118: correct 16882/17000
class 1 clustering acc 0.24911764705882353: correct 847/3400
Epoch: 12, train_loss: 0.6147, train_clustering_loss:  0.3631, train_error: 0.2212
class 0: acc 0.8617021276595744, correct 81/94
class 1: acc 0.69, correct 69/100
class 2: acc 0.6956521739130435, correct 64/92
class 3: acc 0.8181818181818182, correct 63/77
class 4: acc 0.8709677419354839, correct 54/62

Val Set, val_loss: 1.2176, val_error: 0.4200, auc: 0.6905
class 0 clustering acc 0.9915: correct 1983/2000
class 1 clustering acc 0.025: correct 10/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.6, correct 12/20
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0125, instance_loss: 0.1872, weighted_loss: 0.0649, label: 4, bag_size: 729
batch 39, loss: 0.3447, instance_loss: 0.2679, weighted_loss: 0.3217, label: 2, bag_size: 391
batch 59, loss: 0.3902, instance_loss: 0.3000, weighted_loss: 0.3632, label: 2, bag_size: 202
batch 79, loss: 0.4122, instance_loss: 0.5482, weighted_loss: 0.4530, label: 0, bag_size: 729
batch 99, loss: 0.0118, instance_loss: 0.1253, weighted_loss: 0.0459, label: 4, bag_size: 729
batch 119, loss: 0.2189, instance_loss: 0.4592, weighted_loss: 0.2910, label: 4, bag_size: 675
batch 139, loss: 0.9780, instance_loss: 0.5066, weighted_loss: 0.8366, label: 1, bag_size: 269
batch 159, loss: 0.5261, instance_loss: 0.4845, weighted_loss: 0.5136, label: 2, bag_size: 1700
batch 179, loss: 0.6012, instance_loss: 0.4786, weighted_loss: 0.5644, label: 1, bag_size: 343
batch 199, loss: 1.6795, instance_loss: 0.6384, weighted_loss: 1.3672, label: 0, bag_size: 282
batch 219, loss: 0.2618, instance_loss: 0.3998, weighted_loss: 0.3032, label: 4, bag_size: 928
batch 239, loss: 0.0206, instance_loss: 0.1594, weighted_loss: 0.0622, label: 3, bag_size: 729
batch 259, loss: 0.8148, instance_loss: 0.4196, weighted_loss: 0.6962, label: 1, bag_size: 242
batch 279, loss: 0.0808, instance_loss: 0.0946, weighted_loss: 0.0849, label: 3, bag_size: 729
batch 299, loss: 0.5861, instance_loss: 0.3562, weighted_loss: 0.5171, label: 1, bag_size: 320
batch 319, loss: 0.0199, instance_loss: 0.3235, weighted_loss: 0.1110, label: 4, bag_size: 675
batch 339, loss: 1.4578, instance_loss: 0.4526, weighted_loss: 1.1562, label: 2, bag_size: 1180
batch 359, loss: 0.4689, instance_loss: 0.3919, weighted_loss: 0.4458, label: 2, bag_size: 1052
batch 379, loss: 0.5135, instance_loss: 0.4235, weighted_loss: 0.4865, label: 2, bag_size: 1215
batch 399, loss: 2.2391, instance_loss: 0.6979, weighted_loss: 1.7767, label: 1, bag_size: 269
batch 419, loss: 0.0496, instance_loss: 0.0712, weighted_loss: 0.0561, label: 3, bag_size: 1399


class 0 clustering acc 0.992: correct 16864/17000
class 1 clustering acc 0.3: correct 1020/3400
Epoch: 13, train_loss: 0.5403, train_clustering_loss:  0.3462, train_error: 0.1812
class 0: acc 0.8837209302325582, correct 76/86
class 1: acc 0.735632183908046, correct 64/87
class 2: acc 0.7142857142857143, correct 60/84
class 3: acc 0.948051948051948, correct 73/77
class 4: acc 0.8241758241758241, correct 75/91

Val Set, val_loss: 1.1599, val_error: 0.4600, auc: 0.7272
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.0175: correct 7/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.45, correct 9/20
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0088, instance_loss: 0.2782, weighted_loss: 0.0896, label: 4, bag_size: 974
batch 39, loss: 0.7336, instance_loss: 0.3987, weighted_loss: 0.6331, label: 2, bag_size: 482
batch 59, loss: 0.0168, instance_loss: 0.0827, weighted_loss: 0.0366, label: 3, bag_size: 316
batch 79, loss: 0.5390, instance_loss: 0.2217, weighted_loss: 0.4438, label: 3, bag_size: 343
batch 99, loss: 0.6373, instance_loss: 0.3634, weighted_loss: 0.5552, label: 0, bag_size: 990
batch 119, loss: 0.0034, instance_loss: 0.1602, weighted_loss: 0.0504, label: 4, bag_size: 729
batch 139, loss: 0.3484, instance_loss: 0.2583, weighted_loss: 0.3214, label: 3, bag_size: 729
batch 159, loss: 0.2069, instance_loss: 0.3163, weighted_loss: 0.2397, label: 3, bag_size: 230
batch 179, loss: 0.0109, instance_loss: 0.2856, weighted_loss: 0.0933, label: 4, bag_size: 882
batch 199, loss: 1.6670, instance_loss: 0.7494, weighted_loss: 1.3917, label: 3, bag_size: 281
batch 219, loss: 0.1542, instance_loss: 0.3153, weighted_loss: 0.2025, label: 2, bag_size: 1155
batch 239, loss: 0.1740, instance_loss: 0.1496, weighted_loss: 0.1667, label: 0, bag_size: 1174
batch 259, loss: 0.3823, instance_loss: 0.4155, weighted_loss: 0.3922, label: 2, bag_size: 264
batch 279, loss: 0.2920, instance_loss: 0.3412, weighted_loss: 0.3068, label: 3, bag_size: 360
batch 299, loss: 0.0404, instance_loss: 0.0858, weighted_loss: 0.0540, label: 3, bag_size: 729
batch 319, loss: 0.0355, instance_loss: 0.1693, weighted_loss: 0.0757, label: 3, bag_size: 729
batch 339, loss: 0.1622, instance_loss: 0.2657, weighted_loss: 0.1933, label: 2, bag_size: 399
batch 359, loss: 0.1195, instance_loss: 0.1360, weighted_loss: 0.1244, label: 0, bag_size: 552
batch 379, loss: 0.1027, instance_loss: 0.3038, weighted_loss: 0.1630, label: 2, bag_size: 373
batch 399, loss: 0.5353, instance_loss: 0.5082, weighted_loss: 0.5271, label: 0, bag_size: 1301
batch 419, loss: 0.1761, instance_loss: 0.1616, weighted_loss: 0.1718, label: 3, bag_size: 729


class 0 clustering acc 0.9921764705882353: correct 16867/17000
class 1 clustering acc 0.31941176470588234: correct 1086/3400
Epoch: 14, train_loss: 0.5100, train_clustering_loss:  0.3432, train_error: 0.1741
class 0: acc 0.875, correct 63/72
class 1: acc 0.7142857142857143, correct 60/84
class 2: acc 0.7582417582417582, correct 69/91
class 3: acc 0.8936170212765957, correct 84/94
class 4: acc 0.8928571428571429, correct 75/84

Val Set, val_loss: 1.2788, val_error: 0.4400, auc: 0.7153
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.0875: correct 35/400
class 0: acc 1.0, correct 5/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.5714285714285714, correct 12/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3388, instance_loss: 0.2809, weighted_loss: 0.3214, label: 1, bag_size: 697
batch 39, loss: 0.0776, instance_loss: 0.2517, weighted_loss: 0.1298, label: 4, bag_size: 790
batch 59, loss: 0.1323, instance_loss: 0.1382, weighted_loss: 0.1341, label: 0, bag_size: 340
batch 79, loss: 0.0239, instance_loss: 0.0754, weighted_loss: 0.0394, label: 3, bag_size: 1291
batch 99, loss: 0.0770, instance_loss: 0.1033, weighted_loss: 0.0849, label: 3, bag_size: 316
batch 119, loss: 0.3241, instance_loss: 0.4228, weighted_loss: 0.3537, label: 1, bag_size: 1014
batch 139, loss: 0.0526, instance_loss: 0.1290, weighted_loss: 0.0755, label: 0, bag_size: 807
batch 159, loss: 0.1948, instance_loss: 0.2107, weighted_loss: 0.1996, label: 3, bag_size: 1019
batch 179, loss: 0.5262, instance_loss: 0.3528, weighted_loss: 0.4742, label: 3, bag_size: 697
batch 199, loss: 0.0556, instance_loss: 0.3872, weighted_loss: 0.1550, label: 1, bag_size: 1152
batch 219, loss: 0.3572, instance_loss: 0.2997, weighted_loss: 0.3400, label: 1, bag_size: 530
batch 239, loss: 0.3719, instance_loss: 0.4907, weighted_loss: 0.4076, label: 3, bag_size: 1250
batch 259, loss: 1.0471, instance_loss: 0.4588, weighted_loss: 0.8706, label: 2, bag_size: 409
batch 279, loss: 0.9633, instance_loss: 0.4319, weighted_loss: 0.8038, label: 2, bag_size: 265
batch 299, loss: 0.3044, instance_loss: 0.1249, weighted_loss: 0.2506, label: 3, bag_size: 1177
batch 319, loss: 0.0037, instance_loss: 0.1358, weighted_loss: 0.0433, label: 4, bag_size: 729
batch 339, loss: 0.8302, instance_loss: 0.4635, weighted_loss: 0.7202, label: 1, bag_size: 533
batch 359, loss: 0.0111, instance_loss: 0.0978, weighted_loss: 0.0371, label: 4, bag_size: 636
batch 379, loss: 0.0535, instance_loss: 0.1593, weighted_loss: 0.0852, label: 0, bag_size: 729
batch 399, loss: 0.0292, instance_loss: 0.0662, weighted_loss: 0.0403, label: 3, bag_size: 305
batch 419, loss: 0.0190, instance_loss: 0.2647, weighted_loss: 0.0927, label: 4, bag_size: 646


class 0 clustering acc 0.9908235294117647: correct 16844/17000
class 1 clustering acc 0.3776470588235294: correct 1284/3400
Epoch: 15, train_loss: 0.4748, train_clustering_loss:  0.3314, train_error: 0.1788
class 0: acc 0.9090909090909091, correct 90/99
class 1: acc 0.6410256410256411, correct 50/78
class 2: acc 0.6486486486486487, correct 48/74
class 3: acc 0.9135802469135802, correct 74/81
class 4: acc 0.9354838709677419, correct 87/93

Val Set, val_loss: 1.2071, val_error: 0.4400, auc: 0.6967
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.05: correct 20/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 2.0730, instance_loss: 0.6400, weighted_loss: 1.6431, label: 1, bag_size: 770
batch 39, loss: 0.0683, instance_loss: 0.0839, weighted_loss: 0.0730, label: 0, bag_size: 921
batch 59, loss: 0.6411, instance_loss: 0.4606, weighted_loss: 0.5869, label: 2, bag_size: 766
batch 79, loss: 0.0078, instance_loss: 0.1314, weighted_loss: 0.0449, label: 4, bag_size: 729
batch 99, loss: 0.1251, instance_loss: 0.1437, weighted_loss: 0.1307, label: 1, bag_size: 369
batch 119, loss: 1.6663, instance_loss: 0.5874, weighted_loss: 1.3427, label: 0, bag_size: 801
batch 139, loss: 0.0799, instance_loss: 0.1337, weighted_loss: 0.0960, label: 0, bag_size: 338
batch 159, loss: 0.0889, instance_loss: 0.2095, weighted_loss: 0.1251, label: 0, bag_size: 1061
batch 179, loss: 0.2613, instance_loss: 0.2008, weighted_loss: 0.2432, label: 0, bag_size: 294
batch 199, loss: 0.5876, instance_loss: 0.3759, weighted_loss: 0.5241, label: 3, bag_size: 305
batch 219, loss: 0.0326, instance_loss: 0.0878, weighted_loss: 0.0492, label: 0, bag_size: 729
batch 239, loss: 0.0192, instance_loss: 0.3131, weighted_loss: 0.1074, label: 4, bag_size: 729
batch 259, loss: 0.1024, instance_loss: 0.0619, weighted_loss: 0.0903, label: 3, bag_size: 556
batch 279, loss: 0.1952, instance_loss: 0.2142, weighted_loss: 0.2009, label: 0, bag_size: 371
batch 299, loss: 0.3473, instance_loss: 0.2327, weighted_loss: 0.3129, label: 0, bag_size: 350
batch 319, loss: 0.4442, instance_loss: 0.3023, weighted_loss: 0.4016, label: 1, bag_size: 746
batch 339, loss: 1.7928, instance_loss: 0.6845, weighted_loss: 1.4603, label: 2, bag_size: 967
batch 359, loss: 0.4572, instance_loss: 0.4036, weighted_loss: 0.4411, label: 2, bag_size: 839
batch 379, loss: 2.5245, instance_loss: 0.8846, weighted_loss: 2.0325, label: 2, bag_size: 1043
batch 399, loss: 0.0173, instance_loss: 0.2587, weighted_loss: 0.0897, label: 4, bag_size: 1176
batch 419, loss: 0.0005, instance_loss: 0.1254, weighted_loss: 0.0380, label: 4, bag_size: 729


class 0 clustering acc 0.9906470588235294: correct 16841/17000
class 1 clustering acc 0.335: correct 1139/3400
Epoch: 16, train_loss: 0.4647, train_clustering_loss:  0.3390, train_error: 0.1529
class 0: acc 0.9550561797752809, correct 85/89
class 1: acc 0.7525773195876289, correct 73/97
class 2: acc 0.6419753086419753, correct 52/81
class 3: acc 0.9404761904761905, correct 79/84
class 4: acc 0.9594594594594594, correct 71/74

Val Set, val_loss: 1.1813, val_error: 0.4200, auc: 0.6898
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.075: correct 30/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1713, instance_loss: 0.1795, weighted_loss: 0.1737, label: 0, bag_size: 375
batch 39, loss: 0.1645, instance_loss: 0.2579, weighted_loss: 0.1925, label: 2, bag_size: 935
batch 59, loss: 1.9796, instance_loss: 0.6450, weighted_loss: 1.5792, label: 2, bag_size: 120
batch 79, loss: 0.0061, instance_loss: 0.3956, weighted_loss: 0.1230, label: 4, bag_size: 524
batch 99, loss: 0.5794, instance_loss: 0.3898, weighted_loss: 0.5225, label: 2, bag_size: 537
batch 119, loss: 0.0167, instance_loss: 0.1078, weighted_loss: 0.0440, label: 3, bag_size: 952
batch 139, loss: 0.1619, instance_loss: 0.1881, weighted_loss: 0.1698, label: 0, bag_size: 759
batch 159, loss: 1.7047, instance_loss: 0.5571, weighted_loss: 1.3604, label: 1, bag_size: 936
batch 179, loss: 0.1051, instance_loss: 0.3666, weighted_loss: 0.1836, label: 1, bag_size: 1152
batch 199, loss: 0.9238, instance_loss: 0.6219, weighted_loss: 0.8332, label: 1, bag_size: 651
batch 219, loss: 0.0709, instance_loss: 0.5321, weighted_loss: 0.2093, label: 4, bag_size: 542
batch 239, loss: 0.1335, instance_loss: 0.3677, weighted_loss: 0.2038, label: 2, bag_size: 518
batch 259, loss: 0.7220, instance_loss: 0.3672, weighted_loss: 0.6155, label: 0, bag_size: 718
batch 279, loss: 1.1901, instance_loss: 0.5426, weighted_loss: 0.9958, label: 2, bag_size: 409
batch 299, loss: 0.0171, instance_loss: 0.1040, weighted_loss: 0.0431, label: 3, bag_size: 1253
batch 319, loss: 0.2759, instance_loss: 0.2168, weighted_loss: 0.2582, label: 0, bag_size: 294
batch 339, loss: 0.0170, instance_loss: 0.0840, weighted_loss: 0.0371, label: 3, bag_size: 729
batch 359, loss: 0.0960, instance_loss: 0.1986, weighted_loss: 0.1268, label: 0, bag_size: 478
batch 379, loss: 0.5144, instance_loss: 0.4896, weighted_loss: 0.5070, label: 2, bag_size: 571
batch 399, loss: 1.9810, instance_loss: 0.6257, weighted_loss: 1.5744, label: 2, bag_size: 120
batch 419, loss: 0.1710, instance_loss: 0.3007, weighted_loss: 0.2099, label: 2, bag_size: 1133


class 0 clustering acc 0.9905294117647059: correct 16839/17000
class 1 clustering acc 0.3552941176470588: correct 1208/3400
Epoch: 17, train_loss: 0.4233, train_clustering_loss:  0.3253, train_error: 0.1365
class 0: acc 0.9021739130434783, correct 83/92
class 1: acc 0.8068181818181818, correct 71/88
class 2: acc 0.7474747474747475, correct 74/99
class 3: acc 1.0, correct 72/72
class 4: acc 0.9054054054054054, correct 67/74

Val Set, val_loss: 1.1443, val_error: 0.4200, auc: 0.6979
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0789, instance_loss: 0.1917, weighted_loss: 0.1127, label: 0, bag_size: 729
batch 39, loss: 0.0033, instance_loss: 0.1411, weighted_loss: 0.0446, label: 4, bag_size: 711
batch 59, loss: 0.0145, instance_loss: 0.3772, weighted_loss: 0.1233, label: 4, bag_size: 1176
batch 79, loss: 1.9775, instance_loss: 0.5183, weighted_loss: 1.5397, label: 0, bag_size: 1257
batch 99, loss: 1.2375, instance_loss: 0.5030, weighted_loss: 1.0172, label: 1, bag_size: 968
batch 119, loss: 0.0249, instance_loss: 0.0683, weighted_loss: 0.0379, label: 3, bag_size: 729
batch 139, loss: 0.0660, instance_loss: 0.1194, weighted_loss: 0.0820, label: 3, bag_size: 1399
batch 159, loss: 0.5655, instance_loss: 0.3056, weighted_loss: 0.4875, label: 0, bag_size: 200
batch 179, loss: 0.2928, instance_loss: 0.3131, weighted_loss: 0.2989, label: 2, bag_size: 1200
batch 199, loss: 0.9359, instance_loss: 0.5169, weighted_loss: 0.8102, label: 2, bag_size: 967
batch 219, loss: 0.1196, instance_loss: 0.2765, weighted_loss: 0.1667, label: 2, bag_size: 1164
batch 239, loss: 1.2813, instance_loss: 0.5034, weighted_loss: 1.0479, label: 1, bag_size: 936
batch 259, loss: 0.5923, instance_loss: 0.4805, weighted_loss: 0.5588, label: 2, bag_size: 1218
batch 279, loss: 0.0776, instance_loss: 0.2194, weighted_loss: 0.1202, label: 2, bag_size: 1164
batch 299, loss: 1.9437, instance_loss: 0.4205, weighted_loss: 1.4867, label: 0, bag_size: 1034
batch 319, loss: 0.0855, instance_loss: 0.1953, weighted_loss: 0.1185, label: 2, bag_size: 323
batch 339, loss: 0.0650, instance_loss: 0.2119, weighted_loss: 0.1091, label: 0, bag_size: 1196
batch 359, loss: 1.5365, instance_loss: 0.5229, weighted_loss: 1.2324, label: 0, bag_size: 1257
batch 379, loss: 1.7231, instance_loss: 0.6828, weighted_loss: 1.4110, label: 0, bag_size: 818
batch 399, loss: 0.2965, instance_loss: 0.2277, weighted_loss: 0.2759, label: 0, bag_size: 1190
batch 419, loss: 1.3036, instance_loss: 0.6503, weighted_loss: 1.1076, label: 2, bag_size: 758


class 0 clustering acc 0.9901176470588235: correct 16832/17000
class 1 clustering acc 0.39176470588235296: correct 1332/3400
Epoch: 18, train_loss: 0.4054, train_clustering_loss:  0.3183, train_error: 0.1388
class 0: acc 0.8636363636363636, correct 76/88
class 1: acc 0.7432432432432432, correct 55/74
class 2: acc 0.7865168539325843, correct 70/89
class 3: acc 0.956989247311828, correct 89/93
class 4: acc 0.9382716049382716, correct 76/81

Val Set, val_loss: 1.1209, val_error: 0.3800, auc: 0.7217
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.15: correct 60/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.6, correct 12/20
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.7287, instance_loss: 0.4768, weighted_loss: 0.6531, label: 1, bag_size: 470
batch 39, loss: 0.2893, instance_loss: 0.2668, weighted_loss: 0.2825, label: 1, bag_size: 949
batch 59, loss: 0.0762, instance_loss: 0.7405, weighted_loss: 0.2755, label: 4, bag_size: 542
batch 79, loss: 0.2517, instance_loss: 0.3017, weighted_loss: 0.2667, label: 2, bag_size: 806
batch 99, loss: 0.0335, instance_loss: 0.6009, weighted_loss: 0.2037, label: 4, bag_size: 675
batch 119, loss: 0.0506, instance_loss: 0.0747, weighted_loss: 0.0578, label: 3, bag_size: 1399
batch 139, loss: 0.4221, instance_loss: 0.2793, weighted_loss: 0.3793, label: 1, bag_size: 346
batch 159, loss: 0.0007, instance_loss: 0.3200, weighted_loss: 0.0965, label: 4, bag_size: 524
batch 179, loss: 2.8380, instance_loss: 0.7508, weighted_loss: 2.2118, label: 1, bag_size: 700
batch 199, loss: 0.0026, instance_loss: 0.3595, weighted_loss: 0.1096, label: 4, bag_size: 974
batch 219, loss: 2.5796, instance_loss: 0.9073, weighted_loss: 2.0779, label: 3, bag_size: 1167
batch 239, loss: 0.0026, instance_loss: 0.0822, weighted_loss: 0.0265, label: 3, bag_size: 1172
batch 259, loss: 0.0293, instance_loss: 0.0883, weighted_loss: 0.0470, label: 0, bag_size: 521
batch 279, loss: 1.0593, instance_loss: 0.6785, weighted_loss: 0.9450, label: 3, bag_size: 211
batch 299, loss: 0.3147, instance_loss: 0.2614, weighted_loss: 0.2987, label: 2, bag_size: 202
batch 319, loss: 0.2043, instance_loss: 0.4564, weighted_loss: 0.2799, label: 2, bag_size: 766
batch 339, loss: 0.0920, instance_loss: 0.4459, weighted_loss: 0.1982, label: 3, bag_size: 1250
batch 359, loss: 0.0070, instance_loss: 0.3556, weighted_loss: 0.1116, label: 4, bag_size: 711
batch 379, loss: 0.0113, instance_loss: 0.4187, weighted_loss: 0.1335, label: 4, bag_size: 524
batch 399, loss: 1.0599, instance_loss: 0.4793, weighted_loss: 0.8857, label: 1, bag_size: 1273
batch 419, loss: 0.9076, instance_loss: 0.6895, weighted_loss: 0.8422, label: 3, bag_size: 281


class 0 clustering acc 0.9896470588235294: correct 16824/17000
class 1 clustering acc 0.3558823529411765: correct 1210/3400
Epoch: 19, train_loss: 0.4002, train_clustering_loss:  0.3343, train_error: 0.1435
class 0: acc 0.8947368421052632, correct 68/76
class 1: acc 0.7325581395348837, correct 63/86
class 2: acc 0.75, correct 69/92
class 3: acc 0.935064935064935, correct 72/77
class 4: acc 0.9787234042553191, correct 92/94

Val Set, val_loss: 1.1618, val_error: 0.4400, auc: 0.7548
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.0675: correct 27/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0017, instance_loss: 0.1147, weighted_loss: 0.0356, label: 4, bag_size: 729
batch 39, loss: 0.0254, instance_loss: 0.0477, weighted_loss: 0.0321, label: 0, bag_size: 524
batch 59, loss: 0.0116, instance_loss: 0.2305, weighted_loss: 0.0772, label: 4, bag_size: 729
batch 79, loss: 0.0037, instance_loss: 0.5716, weighted_loss: 0.1740, label: 4, bag_size: 974
batch 99, loss: 0.5837, instance_loss: 0.6330, weighted_loss: 0.5985, label: 2, bag_size: 720
batch 119, loss: 0.1318, instance_loss: 0.2906, weighted_loss: 0.1794, label: 1, bag_size: 696
batch 139, loss: 0.3083, instance_loss: 0.3139, weighted_loss: 0.3100, label: 2, bag_size: 471
batch 159, loss: 0.0042, instance_loss: 0.0890, weighted_loss: 0.0296, label: 4, bag_size: 636
batch 179, loss: 0.2264, instance_loss: 0.2816, weighted_loss: 0.2429, label: 1, bag_size: 949
batch 199, loss: 0.1220, instance_loss: 0.5101, weighted_loss: 0.2384, label: 4, bag_size: 754
batch 219, loss: 0.0979, instance_loss: 0.2777, weighted_loss: 0.1519, label: 3, bag_size: 821
batch 239, loss: 0.0916, instance_loss: 0.3143, weighted_loss: 0.1584, label: 1, bag_size: 828
batch 259, loss: 0.3734, instance_loss: 0.3091, weighted_loss: 0.3541, label: 2, bag_size: 684
batch 279, loss: 0.3111, instance_loss: 0.3976, weighted_loss: 0.3370, label: 2, bag_size: 809
batch 299, loss: 0.0853, instance_loss: 0.0964, weighted_loss: 0.0886, label: 3, bag_size: 556
batch 319, loss: 0.1736, instance_loss: 0.3468, weighted_loss: 0.2256, label: 3, bag_size: 671
batch 339, loss: 0.0536, instance_loss: 0.5936, weighted_loss: 0.2156, label: 3, bag_size: 1167
batch 359, loss: 0.0278, instance_loss: 0.1310, weighted_loss: 0.0587, label: 4, bag_size: 790
batch 379, loss: 0.4977, instance_loss: 0.4868, weighted_loss: 0.4944, label: 1, bag_size: 343
batch 399, loss: 0.7438, instance_loss: 0.5787, weighted_loss: 0.6943, label: 4, bag_size: 436
batch 419, loss: 0.6731, instance_loss: 0.5462, weighted_loss: 0.6350, label: 1, bag_size: 648


class 0 clustering acc 0.9904705882352941: correct 16838/17000
class 1 clustering acc 0.4161764705882353: correct 1415/3400
Epoch: 20, train_loss: 0.3376, train_clustering_loss:  0.3078, train_error: 0.1271
class 0: acc 0.922077922077922, correct 71/77
class 1: acc 0.7922077922077922, correct 61/77
class 2: acc 0.6708860759493671, correct 53/79
class 3: acc 0.9772727272727273, correct 86/88
class 4: acc 0.9615384615384616, correct 100/104

Val Set, val_loss: 1.2006, val_error: 0.4200, auc: 0.7108
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.08: correct 32/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.3205, instance_loss: 0.5558, weighted_loss: 0.3911, label: 3, bag_size: 200
batch 39, loss: 0.0161, instance_loss: 0.0449, weighted_loss: 0.0247, label: 3, bag_size: 729
batch 59, loss: 0.4269, instance_loss: 0.4686, weighted_loss: 0.4394, label: 4, bag_size: 533
batch 79, loss: 0.3121, instance_loss: 0.4901, weighted_loss: 0.3655, label: 1, bag_size: 1255
batch 99, loss: 0.0907, instance_loss: 0.1981, weighted_loss: 0.1229, label: 2, bag_size: 286
batch 119, loss: 0.1610, instance_loss: 0.2904, weighted_loss: 0.1998, label: 0, bag_size: 1135
batch 139, loss: 0.8158, instance_loss: 0.3271, weighted_loss: 0.6692, label: 1, bag_size: 754
batch 159, loss: 0.7234, instance_loss: 0.6089, weighted_loss: 0.6890, label: 3, bag_size: 281
batch 179, loss: 0.2567, instance_loss: 0.4181, weighted_loss: 0.3052, label: 1, bag_size: 533
batch 199, loss: 0.1233, instance_loss: 0.4033, weighted_loss: 0.2073, label: 1, bag_size: 442
batch 219, loss: 0.0708, instance_loss: 0.2485, weighted_loss: 0.1241, label: 2, bag_size: 1289
batch 239, loss: 0.0009, instance_loss: 0.1761, weighted_loss: 0.0534, label: 4, bag_size: 729
batch 259, loss: 0.0103, instance_loss: 0.0944, weighted_loss: 0.0355, label: 4, bag_size: 1121
batch 279, loss: 0.1468, instance_loss: 0.2430, weighted_loss: 0.1757, label: 1, bag_size: 697
batch 299, loss: 0.3189, instance_loss: 0.4512, weighted_loss: 0.3586, label: 3, bag_size: 360
batch 319, loss: 0.1759, instance_loss: 0.3771, weighted_loss: 0.2363, label: 0, bag_size: 338
batch 339, loss: 0.2562, instance_loss: 0.4432, weighted_loss: 0.3123, label: 1, bag_size: 348
batch 359, loss: 0.7266, instance_loss: 0.4785, weighted_loss: 0.6521, label: 1, bag_size: 936
batch 379, loss: 0.0501, instance_loss: 0.0637, weighted_loss: 0.0542, label: 0, bag_size: 524
batch 399, loss: 0.1063, instance_loss: 0.4564, weighted_loss: 0.2113, label: 3, bag_size: 1250
batch 419, loss: 0.0074, instance_loss: 0.2927, weighted_loss: 0.0930, label: 4, bag_size: 1357


class 0 clustering acc 0.9901764705882353: correct 16833/17000
class 1 clustering acc 0.4147058823529412: correct 1410/3400
Epoch: 21, train_loss: 0.3159, train_clustering_loss:  0.3061, train_error: 0.1153
class 0: acc 0.8936170212765957, correct 84/94
class 1: acc 0.8089887640449438, correct 72/89
class 2: acc 0.746268656716418, correct 50/67
class 3: acc 0.9772727272727273, correct 86/88
class 4: acc 0.9655172413793104, correct 84/87

Val Set, val_loss: 1.1807, val_error: 0.3800, auc: 0.7334
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.08: correct 32/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0534, instance_loss: 0.2975, weighted_loss: 0.1266, label: 1, bag_size: 442
batch 39, loss: 0.0645, instance_loss: 0.1417, weighted_loss: 0.0876, label: 4, bag_size: 729
batch 59, loss: 1.6258, instance_loss: 0.4802, weighted_loss: 1.2821, label: 1, bag_size: 1376
batch 79, loss: 0.0493, instance_loss: 0.1058, weighted_loss: 0.0663, label: 1, bag_size: 369
batch 99, loss: 0.0127, instance_loss: 0.0937, weighted_loss: 0.0370, label: 3, bag_size: 451
batch 119, loss: 0.0288, instance_loss: 0.1872, weighted_loss: 0.0763, label: 0, bag_size: 729
batch 139, loss: 0.1077, instance_loss: 0.2010, weighted_loss: 0.1357, label: 1, bag_size: 858
batch 159, loss: 0.0159, instance_loss: 0.0943, weighted_loss: 0.0395, label: 3, bag_size: 729
batch 179, loss: 0.7776, instance_loss: 0.5327, weighted_loss: 0.7042, label: 2, bag_size: 687
batch 199, loss: 0.0000, instance_loss: 0.2082, weighted_loss: 0.0625, label: 4, bag_size: 729
batch 219, loss: 0.0005, instance_loss: 0.1701, weighted_loss: 0.0513, label: 4, bag_size: 388
batch 239, loss: 0.1096, instance_loss: 0.3932, weighted_loss: 0.1947, label: 3, bag_size: 697
batch 259, loss: 0.0396, instance_loss: 0.1427, weighted_loss: 0.0705, label: 4, bag_size: 790
batch 279, loss: 0.0156, instance_loss: 0.1279, weighted_loss: 0.0493, label: 1, bag_size: 636
batch 299, loss: 0.8933, instance_loss: 0.4779, weighted_loss: 0.7687, label: 2, bag_size: 1024
batch 319, loss: 0.1650, instance_loss: 0.2626, weighted_loss: 0.1943, label: 1, bag_size: 949
batch 339, loss: 1.4344, instance_loss: 0.5262, weighted_loss: 1.1620, label: 2, bag_size: 511
batch 359, loss: 0.0392, instance_loss: 0.1965, weighted_loss: 0.0864, label: 2, bag_size: 317
batch 379, loss: 0.4055, instance_loss: 0.4320, weighted_loss: 0.4135, label: 1, bag_size: 242
batch 399, loss: 0.0825, instance_loss: 0.1912, weighted_loss: 0.1151, label: 3, bag_size: 821
batch 419, loss: 0.2318, instance_loss: 0.3696, weighted_loss: 0.2731, label: 4, bag_size: 590


class 0 clustering acc 0.9892352941176471: correct 16817/17000
class 1 clustering acc 0.45176470588235296: correct 1536/3400
Epoch: 22, train_loss: 0.3395, train_clustering_loss:  0.2964, train_error: 0.1224
class 0: acc 0.9333333333333333, correct 84/90
class 1: acc 0.7530864197530864, correct 61/81
class 2: acc 0.7142857142857143, correct 55/77
class 3: acc 0.9888888888888889, correct 89/90
class 4: acc 0.9655172413793104, correct 84/87

Val Set, val_loss: 1.2089, val_error: 0.3600, auc: 0.7151
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.1325: correct 53/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1227, instance_loss: 0.2353, weighted_loss: 0.1565, label: 3, bag_size: 821
batch 39, loss: 0.1807, instance_loss: 0.4325, weighted_loss: 0.2563, label: 4, bag_size: 1337
batch 59, loss: 0.0184, instance_loss: 0.1007, weighted_loss: 0.0431, label: 4, bag_size: 947
batch 79, loss: 0.2084, instance_loss: 0.2683, weighted_loss: 0.2263, label: 1, bag_size: 949
batch 99, loss: 0.0161, instance_loss: 0.2396, weighted_loss: 0.0832, label: 4, bag_size: 729
batch 119, loss: 0.0363, instance_loss: 0.0656, weighted_loss: 0.0451, label: 3, bag_size: 556
batch 139, loss: 0.3134, instance_loss: 0.2809, weighted_loss: 0.3036, label: 0, bag_size: 432
batch 159, loss: 0.2631, instance_loss: 0.3292, weighted_loss: 0.2829, label: 0, bag_size: 630
batch 179, loss: 2.9127, instance_loss: 0.6760, weighted_loss: 2.2417, label: 3, bag_size: 281
batch 199, loss: 3.8862, instance_loss: 0.8053, weighted_loss: 2.9620, label: 0, bag_size: 245
batch 219, loss: 0.7121, instance_loss: 0.8136, weighted_loss: 0.7426, label: 1, bag_size: 1409
batch 239, loss: 1.3685, instance_loss: 0.4913, weighted_loss: 1.1053, label: 1, bag_size: 446
batch 259, loss: 0.2241, instance_loss: 0.4057, weighted_loss: 0.2786, label: 3, bag_size: 533
batch 279, loss: 0.2593, instance_loss: 0.4970, weighted_loss: 0.3306, label: 3, bag_size: 533
batch 299, loss: 1.0891, instance_loss: 0.4687, weighted_loss: 0.9030, label: 1, bag_size: 657
batch 319, loss: 1.7906, instance_loss: 0.6146, weighted_loss: 1.4378, label: 1, bag_size: 308
batch 339, loss: 0.8221, instance_loss: 0.5500, weighted_loss: 0.7405, label: 0, bag_size: 1527
batch 359, loss: 0.0153, instance_loss: 0.0805, weighted_loss: 0.0349, label: 0, bag_size: 729
batch 379, loss: 0.3467, instance_loss: 0.3798, weighted_loss: 0.3566, label: 1, bag_size: 1014
batch 399, loss: 0.0706, instance_loss: 0.1879, weighted_loss: 0.1058, label: 0, bag_size: 729
batch 419, loss: 0.3459, instance_loss: 0.4166, weighted_loss: 0.3671, label: 4, bag_size: 436


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.3664705882352941: correct 1246/3400
Epoch: 23, train_loss: 0.3662, train_clustering_loss:  0.3377, train_error: 0.1271
class 0: acc 0.9113924050632911, correct 72/79
class 1: acc 0.7473684210526316, correct 71/95
class 2: acc 0.7906976744186046, correct 68/86
class 3: acc 0.972972972972973, correct 72/74
class 4: acc 0.967032967032967, correct 88/91

Val Set, val_loss: 1.2063, val_error: 0.3800, auc: 0.6741
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.1325: correct 53/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.65, correct 13/20
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.1000, instance_loss: 0.6803, weighted_loss: 0.2741, label: 3, bag_size: 607
batch 39, loss: 0.0268, instance_loss: 0.0925, weighted_loss: 0.0465, label: 3, bag_size: 849
batch 59, loss: 0.2671, instance_loss: 0.2359, weighted_loss: 0.2578, label: 2, bag_size: 480
batch 79, loss: 0.0306, instance_loss: 0.2391, weighted_loss: 0.0932, label: 1, bag_size: 474
batch 99, loss: 0.0278, instance_loss: 0.0603, weighted_loss: 0.0375, label: 3, bag_size: 1559
batch 119, loss: 0.0219, instance_loss: 0.0596, weighted_loss: 0.0332, label: 0, bag_size: 1235
batch 139, loss: 0.0109, instance_loss: 0.0703, weighted_loss: 0.0287, label: 0, bag_size: 898
batch 159, loss: 0.9699, instance_loss: 0.4055, weighted_loss: 0.8006, label: 1, bag_size: 968
batch 179, loss: 0.0583, instance_loss: 0.1828, weighted_loss: 0.0957, label: 1, bag_size: 828
batch 199, loss: 0.1435, instance_loss: 0.1914, weighted_loss: 0.1579, label: 0, bag_size: 294
batch 219, loss: 0.0560, instance_loss: 0.1503, weighted_loss: 0.0843, label: 3, bag_size: 729
batch 239, loss: 0.0739, instance_loss: 0.5588, weighted_loss: 0.2193, label: 3, bag_size: 607
batch 259, loss: 0.0368, instance_loss: 0.1199, weighted_loss: 0.0617, label: 4, bag_size: 1121
batch 279, loss: 0.3377, instance_loss: 0.5638, weighted_loss: 0.4055, label: 2, bag_size: 248
batch 299, loss: 0.1348, instance_loss: 0.2209, weighted_loss: 0.1606, label: 3, bag_size: 849
batch 319, loss: 0.0110, instance_loss: 0.0446, weighted_loss: 0.0211, label: 0, bag_size: 246
batch 339, loss: 0.0242, instance_loss: 0.0671, weighted_loss: 0.0371, label: 0, bag_size: 729
batch 359, loss: 0.0002, instance_loss: 0.1028, weighted_loss: 0.0310, label: 4, bag_size: 729
batch 379, loss: 0.1996, instance_loss: 0.3017, weighted_loss: 0.2302, label: 1, bag_size: 697
batch 399, loss: 0.0088, instance_loss: 0.1829, weighted_loss: 0.0611, label: 4, bag_size: 947
batch 419, loss: 0.6728, instance_loss: 0.4387, weighted_loss: 0.6026, label: 2, bag_size: 202


class 0 clustering acc 0.988764705882353: correct 16809/17000
class 1 clustering acc 0.415: correct 1411/3400
Epoch: 24, train_loss: 0.3317, train_clustering_loss:  0.3227, train_error: 0.1200
class 0: acc 0.9101123595505618, correct 81/89
class 1: acc 0.7529411764705882, correct 64/85
class 2: acc 0.7391304347826086, correct 51/69
class 3: acc 0.9893617021276596, correct 93/94
class 4: acc 0.9659090909090909, correct 85/88

Val Set, val_loss: 1.4233, val_error: 0.4400, auc: 0.6676
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.085: correct 34/400
class 0: acc 1.0, correct 5/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.5238095238095238, correct 11/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.4354, instance_loss: 0.3561, weighted_loss: 0.4116, label: 2, bag_size: 202
batch 39, loss: 0.7437, instance_loss: 0.4570, weighted_loss: 0.6577, label: 1, bag_size: 535
batch 59, loss: 0.0634, instance_loss: 0.1738, weighted_loss: 0.0966, label: 1, bag_size: 1127
batch 79, loss: 0.5985, instance_loss: 0.6502, weighted_loss: 0.6140, label: 3, bag_size: 200
batch 99, loss: 0.8264, instance_loss: 0.3972, weighted_loss: 0.6976, label: 1, bag_size: 504
batch 119, loss: 0.3138, instance_loss: 0.2894, weighted_loss: 0.3065, label: 2, bag_size: 1448
batch 139, loss: 0.9350, instance_loss: 0.5800, weighted_loss: 0.8285, label: 0, bag_size: 423
batch 159, loss: 0.8434, instance_loss: 0.4006, weighted_loss: 0.7105, label: 2, bag_size: 278
batch 179, loss: 0.0198, instance_loss: 0.0423, weighted_loss: 0.0266, label: 0, bag_size: 1235
batch 199, loss: 0.0261, instance_loss: 0.1272, weighted_loss: 0.0564, label: 0, bag_size: 246
batch 219, loss: 0.0001, instance_loss: 0.3206, weighted_loss: 0.0962, label: 4, bag_size: 823
batch 239, loss: 0.0066, instance_loss: 0.1693, weighted_loss: 0.0554, label: 4, bag_size: 1176
batch 259, loss: 0.5011, instance_loss: 0.4723, weighted_loss: 0.4925, label: 2, bag_size: 1069
batch 279, loss: 0.0061, instance_loss: 0.4047, weighted_loss: 0.1257, label: 4, bag_size: 882
batch 299, loss: 0.0141, instance_loss: 0.0769, weighted_loss: 0.0329, label: 0, bag_size: 729
batch 319, loss: 0.0182, instance_loss: 0.2170, weighted_loss: 0.0778, label: 3, bag_size: 729
batch 339, loss: 0.1502, instance_loss: 0.2544, weighted_loss: 0.1815, label: 2, bag_size: 1155
batch 359, loss: 0.0427, instance_loss: 0.1168, weighted_loss: 0.0649, label: 0, bag_size: 1579
batch 379, loss: 0.0394, instance_loss: 0.1094, weighted_loss: 0.0604, label: 3, bag_size: 729
batch 399, loss: 3.5196, instance_loss: 1.0055, weighted_loss: 2.7654, label: 2, bag_size: 1178
batch 419, loss: 0.4595, instance_loss: 0.4246, weighted_loss: 0.4491, label: 2, bag_size: 1416


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.40705882352941175: correct 1384/3400
Epoch: 25, train_loss: 0.3047, train_clustering_loss:  0.3173, train_error: 0.1059
class 0: acc 0.96875, correct 93/96
class 1: acc 0.7349397590361446, correct 61/83
class 2: acc 0.8068181818181818, correct 71/88
class 3: acc 0.9873417721518988, correct 78/79
class 4: acc 0.9746835443037974, correct 77/79

Val Set, val_loss: 1.2819, val_error: 0.4400, auc: 0.6871
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.105: correct 42/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.45, correct 9/20
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.3435, instance_loss: 0.3324, weighted_loss: 0.3402, label: 2, bag_size: 278
batch 39, loss: 0.3864, instance_loss: 0.2741, weighted_loss: 0.3527, label: 1, bag_size: 834
batch 59, loss: 0.0859, instance_loss: 0.1828, weighted_loss: 0.1150, label: 0, bag_size: 472
batch 79, loss: 2.3202, instance_loss: 0.8201, weighted_loss: 1.8702, label: 1, bag_size: 700
batch 99, loss: 3.4035, instance_loss: 1.0115, weighted_loss: 2.6859, label: 2, bag_size: 1178
batch 119, loss: 0.7898, instance_loss: 0.5945, weighted_loss: 0.7312, label: 4, bag_size: 928
batch 139, loss: 0.7116, instance_loss: 0.6182, weighted_loss: 0.6836, label: 1, bag_size: 786
batch 159, loss: 0.0071, instance_loss: 0.0305, weighted_loss: 0.0141, label: 0, bag_size: 521
batch 179, loss: 0.0720, instance_loss: 0.2445, weighted_loss: 0.1238, label: 1, bag_size: 1426
batch 199, loss: 0.1732, instance_loss: 0.2657, weighted_loss: 0.2010, label: 2, bag_size: 868
batch 219, loss: 0.0016, instance_loss: 0.2148, weighted_loss: 0.0655, label: 4, bag_size: 729
batch 239, loss: 0.1851, instance_loss: 0.2769, weighted_loss: 0.2127, label: 2, bag_size: 270
batch 259, loss: 0.0358, instance_loss: 0.2607, weighted_loss: 0.1033, label: 3, bag_size: 230
batch 279, loss: 0.1297, instance_loss: 0.4705, weighted_loss: 0.2320, label: 3, bag_size: 283
batch 299, loss: 0.9265, instance_loss: 0.4039, weighted_loss: 0.7697, label: 4, bag_size: 511
batch 319, loss: 0.3323, instance_loss: 0.5003, weighted_loss: 0.3827, label: 2, bag_size: 1197
batch 339, loss: 0.0106, instance_loss: 0.0433, weighted_loss: 0.0204, label: 3, bag_size: 556
batch 359, loss: 0.1915, instance_loss: 0.1994, weighted_loss: 0.1939, label: 2, bag_size: 482
batch 379, loss: 0.4484, instance_loss: 0.5583, weighted_loss: 0.4814, label: 1, bag_size: 648
batch 399, loss: 0.3961, instance_loss: 0.8346, weighted_loss: 0.5277, label: 1, bag_size: 660
batch 419, loss: 0.1288, instance_loss: 0.2835, weighted_loss: 0.1752, label: 1, bag_size: 754


class 0 clustering acc 0.987764705882353: correct 16792/17000
class 1 clustering acc 0.435: correct 1479/3400
Epoch: 26, train_loss: 0.3095, train_clustering_loss:  0.3048, train_error: 0.0988
class 0: acc 0.9302325581395349, correct 80/86
class 1: acc 0.7384615384615385, correct 48/65
class 2: acc 0.8404255319148937, correct 79/94
class 3: acc 0.9787234042553191, correct 92/94
class 4: acc 0.9767441860465116, correct 84/86

Val Set, val_loss: 1.1859, val_error: 0.3800, auc: 0.6994
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.1425: correct 57/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0016, instance_loss: 0.1835, weighted_loss: 0.0562, label: 4, bag_size: 729
batch 39, loss: 0.1646, instance_loss: 0.2300, weighted_loss: 0.1842, label: 1, bag_size: 944
batch 59, loss: 0.0280, instance_loss: 0.0779, weighted_loss: 0.0430, label: 0, bag_size: 1235
batch 79, loss: 0.1039, instance_loss: 0.1745, weighted_loss: 0.1251, label: 2, bag_size: 941
batch 99, loss: 2.4313, instance_loss: 0.8011, weighted_loss: 1.9422, label: 1, bag_size: 386
batch 119, loss: 0.0135, instance_loss: 0.2106, weighted_loss: 0.0726, label: 4, bag_size: 636
batch 139, loss: 0.2862, instance_loss: 0.3700, weighted_loss: 0.3114, label: 2, bag_size: 1024
batch 159, loss: 1.7501, instance_loss: 0.5406, weighted_loss: 1.3872, label: 1, bag_size: 1197
batch 179, loss: 0.4024, instance_loss: 0.4234, weighted_loss: 0.4087, label: 2, bag_size: 1133
batch 199, loss: 0.3056, instance_loss: 0.4417, weighted_loss: 0.3465, label: 1, bag_size: 343
batch 219, loss: 0.4245, instance_loss: 0.4725, weighted_loss: 0.4389, label: 2, bag_size: 1047
batch 239, loss: 0.1108, instance_loss: 0.4349, weighted_loss: 0.2080, label: 3, bag_size: 283
batch 259, loss: 0.3341, instance_loss: 0.3477, weighted_loss: 0.3381, label: 3, bag_size: 281
batch 279, loss: 0.0006, instance_loss: 0.2405, weighted_loss: 0.0726, label: 4, bag_size: 1235
batch 299, loss: 0.0015, instance_loss: 0.3013, weighted_loss: 0.0914, label: 4, bag_size: 711
batch 319, loss: 0.0010, instance_loss: 0.1480, weighted_loss: 0.0451, label: 3, bag_size: 729
batch 339, loss: 0.0159, instance_loss: 0.0507, weighted_loss: 0.0264, label: 3, bag_size: 556
batch 359, loss: 0.0522, instance_loss: 0.1940, weighted_loss: 0.0948, label: 0, bag_size: 729
batch 379, loss: 1.1167, instance_loss: 0.5307, weighted_loss: 0.9409, label: 2, bag_size: 943
batch 399, loss: 0.0062, instance_loss: 0.3676, weighted_loss: 0.1146, label: 3, bag_size: 317
batch 419, loss: 0.0025, instance_loss: 0.0781, weighted_loss: 0.0252, label: 3, bag_size: 952


class 0 clustering acc 0.988: correct 16796/17000
class 1 clustering acc 0.41705882352941176: correct 1418/3400
Epoch: 27, train_loss: 0.2728, train_clustering_loss:  0.3151, train_error: 0.0847
class 0: acc 0.8987341772151899, correct 71/79
class 1: acc 0.8421052631578947, correct 80/95
class 2: acc 0.8461538461538461, correct 66/78
class 3: acc 1.0, correct 94/94
class 4: acc 0.9873417721518988, correct 78/79

Val Set, val_loss: 1.1954, val_error: 0.4400, auc: 0.7163
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.1025: correct 41/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1918, instance_loss: 0.2587, weighted_loss: 0.2119, label: 1, bag_size: 746
batch 39, loss: 0.1252, instance_loss: 0.3051, weighted_loss: 0.1792, label: 4, bag_size: 590
batch 59, loss: 3.6357, instance_loss: 0.9330, weighted_loss: 2.8249, label: 2, bag_size: 1178
batch 79, loss: 0.2517, instance_loss: 0.4968, weighted_loss: 0.3253, label: 1, bag_size: 1559
batch 99, loss: 0.0000, instance_loss: 0.0708, weighted_loss: 0.0213, label: 4, bag_size: 729
batch 119, loss: 0.0030, instance_loss: 0.0985, weighted_loss: 0.0316, label: 4, bag_size: 636
batch 139, loss: 0.3363, instance_loss: 0.3161, weighted_loss: 0.3302, label: 0, bag_size: 759
batch 159, loss: 0.5146, instance_loss: 0.4670, weighted_loss: 0.5003, label: 0, bag_size: 759
batch 179, loss: 0.0058, instance_loss: 0.2000, weighted_loss: 0.0641, label: 4, bag_size: 947
batch 199, loss: 0.0058, instance_loss: 0.1218, weighted_loss: 0.0406, label: 3, bag_size: 729
batch 219, loss: 0.0156, instance_loss: 0.3947, weighted_loss: 0.1293, label: 4, bag_size: 663
batch 239, loss: 0.0847, instance_loss: 0.3758, weighted_loss: 0.1720, label: 4, bag_size: 1337
batch 259, loss: 0.0094, instance_loss: 0.5103, weighted_loss: 0.1597, label: 4, bag_size: 663
batch 279, loss: 0.1455, instance_loss: 0.3675, weighted_loss: 0.2121, label: 3, bag_size: 1250
batch 299, loss: 0.1192, instance_loss: 0.1109, weighted_loss: 0.1167, label: 3, bag_size: 952
batch 319, loss: 0.0038, instance_loss: 0.2492, weighted_loss: 0.0774, label: 1, bag_size: 1127
batch 339, loss: 0.0732, instance_loss: 0.2781, weighted_loss: 0.1347, label: 1, bag_size: 696
batch 359, loss: 0.0009, instance_loss: 0.1559, weighted_loss: 0.0474, label: 4, bag_size: 773
batch 379, loss: 0.7591, instance_loss: 0.4383, weighted_loss: 0.6628, label: 1, bag_size: 533
batch 399, loss: 0.1213, instance_loss: 0.7934, weighted_loss: 0.3229, label: 1, bag_size: 651
batch 419, loss: 0.0000, instance_loss: 0.0521, weighted_loss: 0.0156, label: 4, bag_size: 729


class 0 clustering acc 0.988: correct 16796/17000
class 1 clustering acc 0.4379411764705882: correct 1489/3400
Epoch: 28, train_loss: 0.2304, train_clustering_loss:  0.3017, train_error: 0.0682
class 0: acc 0.9620253164556962, correct 76/79
class 1: acc 0.8125, correct 65/80
class 2: acc 0.8648648648648649, correct 64/74
class 3: acc 0.989010989010989, correct 90/91
class 4: acc 1.0, correct 101/101

Val Set, val_loss: 1.3928, val_error: 0.4600, auc: 0.6881
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.12: correct 48/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0629, instance_loss: 0.2635, weighted_loss: 0.1231, label: 1, bag_size: 696
batch 39, loss: 0.0068, instance_loss: 0.1059, weighted_loss: 0.0365, label: 4, bag_size: 790
batch 59, loss: 0.0104, instance_loss: 0.1476, weighted_loss: 0.0516, label: 4, bag_size: 625
batch 79, loss: 0.0176, instance_loss: 0.3204, weighted_loss: 0.1084, label: 3, bag_size: 936
batch 99, loss: 0.0162, instance_loss: 0.0844, weighted_loss: 0.0367, label: 0, bag_size: 246
batch 119, loss: 0.1456, instance_loss: 0.3025, weighted_loss: 0.1927, label: 2, bag_size: 839
batch 139, loss: 0.0121, instance_loss: 0.1267, weighted_loss: 0.0465, label: 3, bag_size: 451
batch 159, loss: 0.0070, instance_loss: 0.1197, weighted_loss: 0.0408, label: 0, bag_size: 1466
batch 179, loss: 0.4859, instance_loss: 0.3167, weighted_loss: 0.4352, label: 2, bag_size: 1133
batch 199, loss: 0.0000, instance_loss: 0.4908, weighted_loss: 0.1473, label: 4, bag_size: 823
batch 219, loss: 0.0444, instance_loss: 0.6164, weighted_loss: 0.2160, label: 3, bag_size: 281
batch 239, loss: 0.0567, instance_loss: 0.0611, weighted_loss: 0.0580, label: 3, bag_size: 556
batch 259, loss: 0.0703, instance_loss: 0.1215, weighted_loss: 0.0856, label: 3, bag_size: 343
batch 279, loss: 0.1282, instance_loss: 0.3825, weighted_loss: 0.2045, label: 4, bag_size: 1278
batch 299, loss: 0.0049, instance_loss: 0.4968, weighted_loss: 0.1525, label: 4, bag_size: 1357
batch 319, loss: 0.2154, instance_loss: 0.5321, weighted_loss: 0.3104, label: 4, bag_size: 754
batch 339, loss: 0.1772, instance_loss: 0.6053, weighted_loss: 0.3057, label: 4, bag_size: 436
batch 359, loss: 0.1692, instance_loss: 0.2945, weighted_loss: 0.2068, label: 2, bag_size: 932
batch 379, loss: 0.0026, instance_loss: 0.1828, weighted_loss: 0.0566, label: 4, bag_size: 947
batch 399, loss: 0.0287, instance_loss: 0.0730, weighted_loss: 0.0420, label: 3, bag_size: 952
batch 419, loss: 0.0164, instance_loss: 0.1425, weighted_loss: 0.0542, label: 0, bag_size: 446


class 0 clustering acc 0.9885294117647059: correct 16805/17000
class 1 clustering acc 0.3997058823529412: correct 1359/3400
Epoch: 29, train_loss: 0.2837, train_clustering_loss:  0.3172, train_error: 0.0965
class 0: acc 0.8625, correct 69/80
class 1: acc 0.8271604938271605, correct 67/81
class 2: acc 0.8433734939759037, correct 70/83
class 3: acc 0.9902912621359223, correct 102/103
class 4: acc 0.9743589743589743, correct 76/78

Val Set, val_loss: 1.3426, val_error: 0.4400, auc: 0.7242
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.1075: correct 43/400
class 0: acc 1.0, correct 5/5
class 1: acc 0.45, correct 9/20
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0634, weighted_loss: 0.0191, label: 1, bag_size: 1376
batch 39, loss: 0.1079, instance_loss: 0.3744, weighted_loss: 0.1879, label: 2, bag_size: 324
batch 59, loss: 0.2656, instance_loss: 0.4125, weighted_loss: 0.3097, label: 2, bag_size: 741
batch 79, loss: 0.1436, instance_loss: 0.6804, weighted_loss: 0.3047, label: 1, bag_size: 860
batch 99, loss: 0.1133, instance_loss: 0.3601, weighted_loss: 0.1874, label: 2, bag_size: 1218
batch 119, loss: 0.1501, instance_loss: 0.4515, weighted_loss: 0.2405, label: 1, bag_size: 818
batch 139, loss: 0.0012, instance_loss: 0.1728, weighted_loss: 0.0527, label: 3, bag_size: 791
batch 159, loss: 0.0001, instance_loss: 0.0645, weighted_loss: 0.0194, label: 4, bag_size: 729
batch 179, loss: 2.5972, instance_loss: 0.6933, weighted_loss: 2.0261, label: 2, bag_size: 110
batch 199, loss: 0.5408, instance_loss: 0.4573, weighted_loss: 0.5158, label: 1, bag_size: 242
batch 219, loss: 0.0198, instance_loss: 0.1743, weighted_loss: 0.0662, label: 1, bag_size: 534
batch 239, loss: 0.1138, instance_loss: 0.1967, weighted_loss: 0.1387, label: 1, bag_size: 965
batch 259, loss: 0.0692, instance_loss: 0.2395, weighted_loss: 0.1203, label: 2, bag_size: 1050
batch 279, loss: 4.5248, instance_loss: 0.9360, weighted_loss: 3.4481, label: 1, bag_size: 867
batch 299, loss: 0.1552, instance_loss: 0.6455, weighted_loss: 0.3022, label: 1, bag_size: 1409
batch 319, loss: 0.4243, instance_loss: 0.4346, weighted_loss: 0.4274, label: 0, bag_size: 1527
batch 339, loss: 0.0098, instance_loss: 0.0860, weighted_loss: 0.0326, label: 0, bag_size: 729
batch 359, loss: 0.1285, instance_loss: 0.2337, weighted_loss: 0.1600, label: 2, bag_size: 910
batch 379, loss: 0.1185, instance_loss: 0.5137, weighted_loss: 0.2371, label: 1, bag_size: 1724
batch 399, loss: 0.1298, instance_loss: 0.2630, weighted_loss: 0.1698, label: 2, bag_size: 1242
batch 419, loss: 0.0607, instance_loss: 0.2533, weighted_loss: 0.1185, label: 2, bag_size: 913


class 0 clustering acc 0.9876470588235294: correct 16790/17000
class 1 clustering acc 0.41970588235294115: correct 1427/3400
Epoch: 30, train_loss: 0.2735, train_clustering_loss:  0.3134, train_error: 0.1012
class 0: acc 0.8904109589041096, correct 65/73
class 1: acc 0.8202247191011236, correct 73/89
class 2: acc 0.8252427184466019, correct 85/103
class 3: acc 1.0, correct 77/77
class 4: acc 0.9879518072289156, correct 82/83

Val Set, val_loss: 1.3064, val_error: 0.4200, auc: 0.7117
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.15: correct 60/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.4, correct 8/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0759, weighted_loss: 0.0230, label: 4, bag_size: 729
batch 39, loss: 1.3477, instance_loss: 0.4541, weighted_loss: 1.0796, label: 2, bag_size: 959
batch 59, loss: 0.0006, instance_loss: 0.1334, weighted_loss: 0.0404, label: 3, bag_size: 729
batch 79, loss: 0.0115, instance_loss: 0.4063, weighted_loss: 0.1300, label: 4, bag_size: 1278
batch 99, loss: 0.0110, instance_loss: 0.4008, weighted_loss: 0.1279, label: 4, bag_size: 675
batch 119, loss: 0.0539, instance_loss: 0.1765, weighted_loss: 0.0907, label: 4, bag_size: 625
batch 139, loss: 0.0004, instance_loss: 0.0701, weighted_loss: 0.0213, label: 4, bag_size: 1235
batch 159, loss: 0.0810, instance_loss: 0.2838, weighted_loss: 0.1418, label: 1, bag_size: 504
batch 179, loss: 2.9992, instance_loss: 0.8463, weighted_loss: 2.3533, label: 2, bag_size: 319
batch 199, loss: 0.4111, instance_loss: 0.6371, weighted_loss: 0.4789, label: 1, bag_size: 1390
batch 219, loss: 0.0228, instance_loss: 0.0793, weighted_loss: 0.0397, label: 0, bag_size: 729
batch 239, loss: 0.0026, instance_loss: 0.2797, weighted_loss: 0.0857, label: 4, bag_size: 524
batch 259, loss: 0.0125, instance_loss: 0.0535, weighted_loss: 0.0248, label: 0, bag_size: 1235
batch 279, loss: 0.0459, instance_loss: 0.3353, weighted_loss: 0.1327, label: 1, bag_size: 442
batch 299, loss: 1.8085, instance_loss: 0.4672, weighted_loss: 1.4061, label: 1, bag_size: 535
batch 319, loss: 1.5307, instance_loss: 0.4670, weighted_loss: 1.2116, label: 1, bag_size: 535
batch 339, loss: 0.0617, instance_loss: 0.1064, weighted_loss: 0.0751, label: 0, bag_size: 653
batch 359, loss: 0.8605, instance_loss: 0.4981, weighted_loss: 0.7518, label: 1, bag_size: 377
batch 379, loss: 0.0081, instance_loss: 0.0661, weighted_loss: 0.0255, label: 0, bag_size: 552
batch 399, loss: 0.0027, instance_loss: 0.2575, weighted_loss: 0.0792, label: 4, bag_size: 947
batch 419, loss: 0.0811, instance_loss: 0.1548, weighted_loss: 0.1032, label: 0, bag_size: 200


class 0 clustering acc 0.9887058823529412: correct 16808/17000
class 1 clustering acc 0.4667647058823529: correct 1587/3400
Epoch: 31, train_loss: 0.2069, train_clustering_loss:  0.2899, train_error: 0.0682
class 0: acc 0.9693877551020408, correct 95/98
class 1: acc 0.8690476190476191, correct 73/84
class 2: acc 0.8055555555555556, correct 58/72
class 3: acc 1.0, correct 81/81
class 4: acc 0.9888888888888889, correct 89/90

Val Set, val_loss: 1.2279, val_error: 0.4000, auc: 0.6990
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0971, instance_loss: 0.2949, weighted_loss: 0.1564, label: 1, bag_size: 348
batch 39, loss: 0.0982, instance_loss: 0.4325, weighted_loss: 0.1985, label: 2, bag_size: 1439
batch 59, loss: 0.0261, instance_loss: 0.1868, weighted_loss: 0.0743, label: 4, bag_size: 947
batch 79, loss: 0.0050, instance_loss: 0.0650, weighted_loss: 0.0230, label: 0, bag_size: 729
batch 99, loss: 0.1008, instance_loss: 0.1872, weighted_loss: 0.1268, label: 0, bag_size: 545
batch 119, loss: 0.0000, instance_loss: 0.3431, weighted_loss: 0.1030, label: 4, bag_size: 823
batch 139, loss: 0.0141, instance_loss: 0.0645, weighted_loss: 0.0293, label: 0, bag_size: 729
batch 159, loss: 0.0081, instance_loss: 0.0656, weighted_loss: 0.0254, label: 0, bag_size: 729
batch 179, loss: 0.0035, instance_loss: 0.0232, weighted_loss: 0.0094, label: 0, bag_size: 402
batch 199, loss: 0.0878, instance_loss: 0.3236, weighted_loss: 0.1585, label: 4, bag_size: 590
batch 219, loss: 0.0027, instance_loss: 0.0642, weighted_loss: 0.0212, label: 3, bag_size: 451
batch 239, loss: 0.0592, instance_loss: 0.2628, weighted_loss: 0.1203, label: 2, bag_size: 292
batch 259, loss: 0.2094, instance_loss: 0.2532, weighted_loss: 0.2226, label: 1, bag_size: 1325
batch 279, loss: 0.0056, instance_loss: 0.0453, weighted_loss: 0.0175, label: 0, bag_size: 616
batch 299, loss: 0.0006, instance_loss: 0.5109, weighted_loss: 0.1537, label: 4, bag_size: 974
batch 319, loss: 0.2831, instance_loss: 0.5149, weighted_loss: 0.3526, label: 1, bag_size: 487
batch 339, loss: 0.1668, instance_loss: 0.8595, weighted_loss: 0.3746, label: 1, bag_size: 660
batch 359, loss: 0.0187, instance_loss: 0.0922, weighted_loss: 0.0407, label: 0, bag_size: 1301
batch 379, loss: 0.0010, instance_loss: 0.3179, weighted_loss: 0.0961, label: 4, bag_size: 711
batch 399, loss: 0.1471, instance_loss: 0.7380, weighted_loss: 0.3244, label: 1, bag_size: 1409
batch 419, loss: 0.0964, instance_loss: 0.2743, weighted_loss: 0.1498, label: 2, bag_size: 784


class 0 clustering acc 0.9873529411764705: correct 16785/17000
class 1 clustering acc 0.4476470588235294: correct 1522/3400
Epoch: 32, train_loss: 0.2090, train_clustering_loss:  0.3018, train_error: 0.0776
class 0: acc 0.9680851063829787, correct 91/94
class 1: acc 0.8444444444444444, correct 76/90
class 2: acc 0.825, correct 66/80
class 3: acc 0.9883720930232558, correct 85/86
class 4: acc 0.9866666666666667, correct 74/75

Val Set, val_loss: 1.2490, val_error: 0.4000, auc: 0.7128
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.15: correct 60/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0509, instance_loss: 0.2545, weighted_loss: 0.1120, label: 1, bag_size: 754
batch 39, loss: 0.0015, instance_loss: 0.2822, weighted_loss: 0.0857, label: 4, bag_size: 754
batch 59, loss: 0.0870, instance_loss: 0.1773, weighted_loss: 0.1141, label: 2, bag_size: 271
batch 79, loss: 0.0039, instance_loss: 0.0929, weighted_loss: 0.0306, label: 0, bag_size: 976
batch 99, loss: 0.0005, instance_loss: 0.0374, weighted_loss: 0.0116, label: 4, bag_size: 764
batch 119, loss: 0.0264, instance_loss: 0.6796, weighted_loss: 0.2223, label: 1, bag_size: 651
batch 139, loss: 0.0602, instance_loss: 0.1888, weighted_loss: 0.0988, label: 2, bag_size: 907
batch 159, loss: 0.0129, instance_loss: 0.0773, weighted_loss: 0.0322, label: 3, bag_size: 1069
batch 179, loss: 0.7320, instance_loss: 0.6486, weighted_loss: 0.7069, label: 1, bag_size: 308
batch 199, loss: 3.2070, instance_loss: 0.3972, weighted_loss: 2.3640, label: 0, bag_size: 552
batch 219, loss: 0.0219, instance_loss: 0.1492, weighted_loss: 0.0601, label: 0, bag_size: 1332
batch 239, loss: 1.6165, instance_loss: 0.5831, weighted_loss: 1.3065, label: 0, bag_size: 1257
batch 259, loss: 0.0894, instance_loss: 0.1391, weighted_loss: 0.1043, label: 3, bag_size: 849
batch 279, loss: 0.4498, instance_loss: 0.5586, weighted_loss: 0.4824, label: 1, bag_size: 1080
batch 299, loss: 0.0150, instance_loss: 0.2091, weighted_loss: 0.0732, label: 0, bag_size: 1012
batch 319, loss: 0.0649, instance_loss: 0.1933, weighted_loss: 0.1034, label: 0, bag_size: 1101
batch 339, loss: 0.0001, instance_loss: 0.1494, weighted_loss: 0.0449, label: 4, bag_size: 729
batch 359, loss: 0.0649, instance_loss: 0.2085, weighted_loss: 0.1080, label: 0, bag_size: 1190
batch 379, loss: 0.0242, instance_loss: 0.3241, weighted_loss: 0.1142, label: 1, bag_size: 399
batch 399, loss: 0.0479, instance_loss: 0.2129, weighted_loss: 0.0974, label: 2, bag_size: 839
batch 419, loss: 0.7765, instance_loss: 0.4766, weighted_loss: 0.6865, label: 0, bag_size: 718


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.46852941176470586: correct 1593/3400
Epoch: 33, train_loss: 0.2137, train_clustering_loss:  0.2905, train_error: 0.0706
class 0: acc 0.935064935064935, correct 72/77
class 1: acc 0.8356164383561644, correct 61/73
class 2: acc 0.8695652173913043, correct 80/92
class 3: acc 0.9885057471264368, correct 86/87
class 4: acc 1.0, correct 96/96

Val Set, val_loss: 1.3185, val_error: 0.3600, auc: 0.7287
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.1425: correct 57/400
class 0: acc 1.0, correct 5/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0029, instance_loss: 0.0465, weighted_loss: 0.0160, label: 3, bag_size: 729
batch 39, loss: 0.0006, instance_loss: 0.4962, weighted_loss: 0.1493, label: 4, bag_size: 823
batch 59, loss: 0.0068, instance_loss: 0.0372, weighted_loss: 0.0159, label: 0, bag_size: 982
batch 79, loss: 0.0813, instance_loss: 0.3676, weighted_loss: 0.1672, label: 1, bag_size: 949
batch 99, loss: 0.2375, instance_loss: 0.3716, weighted_loss: 0.2778, label: 2, bag_size: 278
batch 119, loss: 0.2400, instance_loss: 0.4388, weighted_loss: 0.2997, label: 2, bag_size: 766
batch 139, loss: 0.0012, instance_loss: 0.3679, weighted_loss: 0.1112, label: 4, bag_size: 1235
batch 159, loss: 0.5937, instance_loss: 0.5034, weighted_loss: 0.5666, label: 2, bag_size: 259
batch 179, loss: 0.0160, instance_loss: 0.2791, weighted_loss: 0.0949, label: 0, bag_size: 729
batch 199, loss: 0.3136, instance_loss: 0.6100, weighted_loss: 0.4025, label: 0, bag_size: 818
batch 219, loss: 0.0358, instance_loss: 0.0700, weighted_loss: 0.0461, label: 0, bag_size: 1034
batch 239, loss: 0.5332, instance_loss: 0.6350, weighted_loss: 0.5637, label: 1, bag_size: 386
batch 259, loss: 0.1615, instance_loss: 0.2902, weighted_loss: 0.2001, label: 2, bag_size: 750
batch 279, loss: 0.0183, instance_loss: 0.3524, weighted_loss: 0.1186, label: 1, bag_size: 534
batch 299, loss: 1.5792, instance_loss: 0.5758, weighted_loss: 1.2782, label: 0, bag_size: 1257
batch 319, loss: 0.0687, instance_loss: 0.2411, weighted_loss: 0.1204, label: 2, bag_size: 270
batch 339, loss: 0.0001, instance_loss: 0.0902, weighted_loss: 0.0271, label: 4, bag_size: 729
batch 359, loss: 0.2233, instance_loss: 0.4892, weighted_loss: 0.3030, label: 2, bag_size: 1119
batch 379, loss: 0.2427, instance_loss: 0.3019, weighted_loss: 0.2604, label: 1, bag_size: 913
batch 399, loss: 0.0078, instance_loss: 0.0522, weighted_loss: 0.0211, label: 0, bag_size: 729
batch 419, loss: 0.0779, instance_loss: 0.1511, weighted_loss: 0.0998, label: 3, bag_size: 729


class 0 clustering acc 0.9877058823529412: correct 16791/17000
class 1 clustering acc 0.49117647058823527: correct 1670/3400
Epoch: 34, train_loss: 0.1961, train_clustering_loss:  0.2861, train_error: 0.0706
class 0: acc 0.9444444444444444, correct 85/90
class 1: acc 0.821917808219178, correct 60/73
class 2: acc 0.8876404494382022, correct 79/89
class 3: acc 0.9743589743589743, correct 76/78
class 4: acc 1.0, correct 95/95

Val Set, val_loss: 1.2375, val_error: 0.4000, auc: 0.7329
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.1275: correct 51/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.45, correct 9/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0142, instance_loss: 0.1341, weighted_loss: 0.0502, label: 3, bag_size: 729
batch 39, loss: 0.0137, instance_loss: 0.1000, weighted_loss: 0.0396, label: 3, bag_size: 729
batch 59, loss: 0.1156, instance_loss: 0.2726, weighted_loss: 0.1627, label: 4, bag_size: 646
batch 79, loss: 0.0094, instance_loss: 0.1184, weighted_loss: 0.0421, label: 0, bag_size: 729
batch 99, loss: 0.0627, instance_loss: 0.2623, weighted_loss: 0.1226, label: 4, bag_size: 511
batch 119, loss: 0.6917, instance_loss: 0.3147, weighted_loss: 0.5786, label: 2, bag_size: 806
batch 139, loss: 0.0124, instance_loss: 0.2164, weighted_loss: 0.0736, label: 4, bag_size: 928
batch 159, loss: 0.0042, instance_loss: 0.0623, weighted_loss: 0.0216, label: 0, bag_size: 552
batch 179, loss: 0.6536, instance_loss: 0.2880, weighted_loss: 0.5439, label: 3, bag_size: 360
batch 199, loss: 0.2358, instance_loss: 0.4853, weighted_loss: 0.3106, label: 2, bag_size: 766
batch 219, loss: 1.4755, instance_loss: 0.5793, weighted_loss: 1.2066, label: 1, bag_size: 936
batch 239, loss: 0.0692, instance_loss: 0.6641, weighted_loss: 0.2476, label: 3, bag_size: 281
batch 259, loss: 0.0432, instance_loss: 0.2246, weighted_loss: 0.0976, label: 2, bag_size: 1306
batch 279, loss: 0.3448, instance_loss: 0.4578, weighted_loss: 0.3787, label: 2, bag_size: 1232
batch 299, loss: 0.2881, instance_loss: 0.1909, weighted_loss: 0.2589, label: 0, bag_size: 729
batch 319, loss: 0.0009, instance_loss: 0.1056, weighted_loss: 0.0323, label: 3, bag_size: 729
batch 339, loss: 0.0190, instance_loss: 0.0676, weighted_loss: 0.0336, label: 0, bag_size: 1235
batch 359, loss: 0.5271, instance_loss: 0.4564, weighted_loss: 0.5059, label: 2, bag_size: 948
batch 379, loss: 0.0159, instance_loss: 0.1204, weighted_loss: 0.0472, label: 1, bag_size: 847
batch 399, loss: 0.0004, instance_loss: 0.0517, weighted_loss: 0.0158, label: 4, bag_size: 1235
batch 419, loss: 0.3558, instance_loss: 0.1510, weighted_loss: 0.2943, label: 3, bag_size: 1253


class 0 clustering acc 0.9857058823529412: correct 16757/17000
class 1 clustering acc 0.45: correct 1530/3400
Epoch: 35, train_loss: 0.2862, train_clustering_loss:  0.3121, train_error: 0.0824
class 0: acc 0.9484536082474226, correct 92/97
class 1: acc 0.8607594936708861, correct 68/79
class 2: acc 0.8072289156626506, correct 67/83
class 3: acc 1.0, correct 90/90
class 4: acc 0.9605263157894737, correct 73/76

Val Set, val_loss: 1.3053, val_error: 0.4200, auc: 0.7012
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0091, instance_loss: 0.0695, weighted_loss: 0.0272, label: 3, bag_size: 952
batch 39, loss: 0.0083, instance_loss: 0.3705, weighted_loss: 0.1169, label: 3, bag_size: 671
batch 59, loss: 0.1268, instance_loss: 0.7022, weighted_loss: 0.2994, label: 1, bag_size: 860
batch 79, loss: 0.0504, instance_loss: 0.6214, weighted_loss: 0.2217, label: 2, bag_size: 1150
batch 99, loss: 0.5385, instance_loss: 0.6285, weighted_loss: 0.5655, label: 1, bag_size: 1197
batch 119, loss: 0.2111, instance_loss: 0.2528, weighted_loss: 0.2236, label: 2, bag_size: 1164
batch 139, loss: 0.4119, instance_loss: 0.4970, weighted_loss: 0.4375, label: 1, bag_size: 1080
batch 159, loss: 0.0101, instance_loss: 0.1082, weighted_loss: 0.0395, label: 0, bag_size: 1466
batch 179, loss: 0.1468, instance_loss: 0.2746, weighted_loss: 0.1852, label: 2, bag_size: 1133
batch 199, loss: 1.5725, instance_loss: 0.5552, weighted_loss: 1.2673, label: 2, bag_size: 948
batch 219, loss: 0.1491, instance_loss: 0.3118, weighted_loss: 0.1979, label: 0, bag_size: 1065
batch 239, loss: 0.0763, instance_loss: 0.4955, weighted_loss: 0.2021, label: 4, bag_size: 366
batch 259, loss: 0.0122, instance_loss: 0.0913, weighted_loss: 0.0359, label: 0, bag_size: 367
batch 279, loss: 0.0006, instance_loss: 0.0929, weighted_loss: 0.0283, label: 3, bag_size: 1172
batch 299, loss: 0.0676, instance_loss: 0.4121, weighted_loss: 0.1709, label: 1, bag_size: 887
batch 319, loss: 0.0481, instance_loss: 0.1964, weighted_loss: 0.0926, label: 0, bag_size: 367
batch 339, loss: 0.0062, instance_loss: 0.0887, weighted_loss: 0.0310, label: 3, bag_size: 952
batch 359, loss: 0.0041, instance_loss: 0.0319, weighted_loss: 0.0125, label: 0, bag_size: 982
batch 379, loss: 0.0208, instance_loss: 0.1354, weighted_loss: 0.0552, label: 0, bag_size: 367
batch 399, loss: 1.6752, instance_loss: 0.7396, weighted_loss: 1.3946, label: 1, bag_size: 936
batch 419, loss: 0.0419, instance_loss: 0.1372, weighted_loss: 0.0705, label: 3, bag_size: 821


class 0 clustering acc 0.9855294117647059: correct 16754/17000
class 1 clustering acc 0.46058823529411763: correct 1566/3400
Epoch: 36, train_loss: 0.2245, train_clustering_loss:  0.3044, train_error: 0.0729
class 0: acc 0.9545454545454546, correct 63/66
class 1: acc 0.8266666666666667, correct 62/75
class 2: acc 0.8627450980392157, correct 88/102
class 3: acc 1.0, correct 90/90
class 4: acc 0.9891304347826086, correct 91/92

Val Set, val_loss: 1.3296, val_error: 0.3200, auc: 0.7133
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.16: correct 64/400
class 0: acc 1.0, correct 5/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0021, instance_loss: 0.0391, weighted_loss: 0.0132, label: 0, bag_size: 1235
batch 39, loss: 0.0053, instance_loss: 0.0418, weighted_loss: 0.0163, label: 0, bag_size: 1235
batch 59, loss: 0.0594, instance_loss: 0.1979, weighted_loss: 0.1009, label: 4, bag_size: 817
batch 79, loss: 0.0436, instance_loss: 0.2183, weighted_loss: 0.0960, label: 4, bag_size: 817
batch 99, loss: 0.0133, instance_loss: 0.1801, weighted_loss: 0.0634, label: 4, bag_size: 817
batch 119, loss: 0.0000, instance_loss: 0.0341, weighted_loss: 0.0102, label: 4, bag_size: 729
batch 139, loss: 0.0024, instance_loss: 0.2792, weighted_loss: 0.0854, label: 3, bag_size: 671
batch 159, loss: 0.3253, instance_loss: 0.4112, weighted_loss: 0.3511, label: 1, bag_size: 1080
batch 179, loss: 0.0002, instance_loss: 0.0319, weighted_loss: 0.0097, label: 4, bag_size: 729
batch 199, loss: 0.0174, instance_loss: 0.2553, weighted_loss: 0.0887, label: 2, bag_size: 621
batch 219, loss: 0.0012, instance_loss: 0.2282, weighted_loss: 0.0693, label: 4, bag_size: 754
batch 239, loss: 0.0821, instance_loss: 0.0782, weighted_loss: 0.0809, label: 3, bag_size: 556
batch 259, loss: 0.0123, instance_loss: 0.5707, weighted_loss: 0.1798, label: 1, bag_size: 867
batch 279, loss: 0.3228, instance_loss: 0.3115, weighted_loss: 0.3194, label: 1, bag_size: 913
batch 299, loss: 0.1379, instance_loss: 0.3920, weighted_loss: 0.2141, label: 2, bag_size: 1069
batch 319, loss: 0.1045, instance_loss: 0.4150, weighted_loss: 0.1977, label: 1, bag_size: 754
batch 339, loss: 0.0005, instance_loss: 0.1449, weighted_loss: 0.0438, label: 3, bag_size: 729
batch 359, loss: 0.0419, instance_loss: 0.1969, weighted_loss: 0.0884, label: 0, bag_size: 653
batch 379, loss: 0.0044, instance_loss: 0.0572, weighted_loss: 0.0203, label: 0, bag_size: 552
batch 399, loss: 0.0201, instance_loss: 0.2106, weighted_loss: 0.0773, label: 0, bag_size: 1196
batch 419, loss: 0.5745, instance_loss: 0.4248, weighted_loss: 0.5296, label: 4, bag_size: 1278


class 0 clustering acc 0.9863529411764705: correct 16768/17000
class 1 clustering acc 0.44676470588235295: correct 1519/3400
Epoch: 37, train_loss: 0.2040, train_clustering_loss:  0.3089, train_error: 0.0588
class 0: acc 0.9666666666666667, correct 87/90
class 1: acc 0.8513513513513513, correct 63/74
class 2: acc 0.8877551020408163, correct 87/98
class 3: acc 1.0, correct 77/77
class 4: acc 1.0, correct 86/86

Val Set, val_loss: 1.3057, val_error: 0.3600, auc: 0.7245
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.2: correct 80/400
class 0: acc 1.0, correct 5/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0874, instance_loss: 0.1269, weighted_loss: 0.0993, label: 0, bag_size: 1061
batch 39, loss: 0.0545, instance_loss: 0.1624, weighted_loss: 0.0868, label: 2, bag_size: 480
batch 59, loss: 0.1362, instance_loss: 0.3978, weighted_loss: 0.2146, label: 1, bag_size: 1080
batch 79, loss: 0.0001, instance_loss: 0.0705, weighted_loss: 0.0212, label: 4, bag_size: 729
batch 99, loss: 0.0118, instance_loss: 0.1818, weighted_loss: 0.0628, label: 3, bag_size: 1291
batch 119, loss: 0.1212, instance_loss: 0.6596, weighted_loss: 0.2827, label: 2, bag_size: 878
batch 139, loss: 0.0246, instance_loss: 0.0704, weighted_loss: 0.0383, label: 1, bag_size: 286
batch 159, loss: 0.0018, instance_loss: 0.0994, weighted_loss: 0.0311, label: 4, bag_size: 729
batch 179, loss: 0.2168, instance_loss: 0.8811, weighted_loss: 0.4161, label: 2, bag_size: 878
batch 199, loss: 0.1729, instance_loss: 0.3708, weighted_loss: 0.2323, label: 1, bag_size: 533
batch 219, loss: 0.0497, instance_loss: 0.1716, weighted_loss: 0.0863, label: 3, bag_size: 343
batch 239, loss: 0.0486, instance_loss: 0.4364, weighted_loss: 0.1650, label: 3, bag_size: 360
batch 259, loss: 0.0464, instance_loss: 0.2394, weighted_loss: 0.1043, label: 1, bag_size: 697
batch 279, loss: 0.0006, instance_loss: 0.0571, weighted_loss: 0.0176, label: 4, bag_size: 729
batch 299, loss: 0.1790, instance_loss: 0.5987, weighted_loss: 0.3049, label: 1, bag_size: 786
batch 319, loss: 0.0015, instance_loss: 0.3115, weighted_loss: 0.0945, label: 4, bag_size: 524
batch 339, loss: 0.0922, instance_loss: 0.6965, weighted_loss: 0.2735, label: 1, bag_size: 1390
batch 359, loss: 0.1254, instance_loss: 0.2909, weighted_loss: 0.1751, label: 0, bag_size: 1332
batch 379, loss: 0.0235, instance_loss: 0.2668, weighted_loss: 0.0965, label: 4, bag_size: 773
batch 399, loss: 0.0278, instance_loss: 0.0941, weighted_loss: 0.0477, label: 0, bag_size: 545
batch 419, loss: 0.0089, instance_loss: 0.6150, weighted_loss: 0.1908, label: 3, bag_size: 1167


class 0 clustering acc 0.9857058823529412: correct 16757/17000
class 1 clustering acc 0.4814705882352941: correct 1637/3400
Epoch: 38, train_loss: 0.2042, train_clustering_loss:  0.2969, train_error: 0.0635
class 0: acc 0.9390243902439024, correct 77/82
class 1: acc 0.9010989010989011, correct 82/91
class 2: acc 0.8571428571428571, correct 66/77
class 3: acc 0.9891304347826086, correct 91/92
class 4: acc 0.9879518072289156, correct 82/83

Val Set, val_loss: 1.3219, val_error: 0.3600, auc: 0.7311
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.165: correct 66/400
class 0: acc 0.2, correct 1/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.9047619047619048, correct 19/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0178, instance_loss: 0.3410, weighted_loss: 0.1147, label: 1, bag_size: 1014
batch 39, loss: 0.8841, instance_loss: 0.4391, weighted_loss: 0.7506, label: 1, bag_size: 1197
batch 59, loss: 0.6573, instance_loss: 0.3093, weighted_loss: 0.5529, label: 1, bag_size: 746
batch 79, loss: 0.0530, instance_loss: 0.2652, weighted_loss: 0.1166, label: 0, bag_size: 1190
batch 99, loss: 0.0093, instance_loss: 0.1619, weighted_loss: 0.0551, label: 0, bag_size: 437
batch 119, loss: 0.0008, instance_loss: 0.3933, weighted_loss: 0.1186, label: 4, bag_size: 882
batch 139, loss: 0.0019, instance_loss: 0.0989, weighted_loss: 0.0310, label: 3, bag_size: 1069
batch 159, loss: 0.0199, instance_loss: 0.6567, weighted_loss: 0.2109, label: 4, bag_size: 542
batch 179, loss: 0.0001, instance_loss: 0.2563, weighted_loss: 0.0770, label: 4, bag_size: 524
batch 199, loss: 0.0013, instance_loss: 0.1628, weighted_loss: 0.0497, label: 4, bag_size: 656
batch 219, loss: 0.0101, instance_loss: 0.2150, weighted_loss: 0.0716, label: 3, bag_size: 821
batch 239, loss: 0.0001, instance_loss: 0.0837, weighted_loss: 0.0252, label: 4, bag_size: 729
batch 259, loss: 0.0001, instance_loss: 0.1511, weighted_loss: 0.0454, label: 4, bag_size: 729
batch 279, loss: 0.3281, instance_loss: 0.4146, weighted_loss: 0.3540, label: 2, bag_size: 1148
batch 299, loss: 0.0913, instance_loss: 0.2985, weighted_loss: 0.1534, label: 2, bag_size: 614
batch 319, loss: 0.0000, instance_loss: 0.1493, weighted_loss: 0.0448, label: 4, bag_size: 729
batch 339, loss: 0.0660, instance_loss: 0.3551, weighted_loss: 0.1527, label: 0, bag_size: 1065
batch 359, loss: 0.0000, instance_loss: 0.3688, weighted_loss: 0.1107, label: 4, bag_size: 823
batch 379, loss: 0.0000, instance_loss: 0.0815, weighted_loss: 0.0244, label: 4, bag_size: 1002
batch 399, loss: 0.0752, instance_loss: 0.1546, weighted_loss: 0.0990, label: 1, bag_size: 356
batch 419, loss: 0.2030, instance_loss: 0.6290, weighted_loss: 0.3308, label: 1, bag_size: 1559


class 0 clustering acc 0.9881176470588235: correct 16798/17000
class 1 clustering acc 0.4426470588235294: correct 1505/3400
Epoch: 39, train_loss: 0.1772, train_clustering_loss:  0.3117, train_error: 0.0635
class 0: acc 0.9438202247191011, correct 84/89
class 1: acc 0.8865979381443299, correct 86/97
class 2: acc 0.8382352941176471, correct 57/68
class 3: acc 1.0, correct 90/90
class 4: acc 1.0, correct 81/81

Val Set, val_loss: 1.3063, val_error: 0.4000, auc: 0.7197
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0074, instance_loss: 0.1256, weighted_loss: 0.0428, label: 3, bag_size: 1019
batch 39, loss: 0.0049, instance_loss: 0.0546, weighted_loss: 0.0198, label: 0, bag_size: 982
batch 59, loss: 0.0200, instance_loss: 0.1177, weighted_loss: 0.0493, label: 0, bag_size: 338
batch 79, loss: 0.0017, instance_loss: 0.0196, weighted_loss: 0.0071, label: 3, bag_size: 305
batch 99, loss: 0.0001, instance_loss: 0.1630, weighted_loss: 0.0489, label: 4, bag_size: 729
batch 119, loss: 0.0373, instance_loss: 0.3238, weighted_loss: 0.1233, label: 2, bag_size: 932
batch 139, loss: 0.0400, instance_loss: 0.0895, weighted_loss: 0.0548, label: 3, bag_size: 729
batch 159, loss: 0.0086, instance_loss: 0.4603, weighted_loss: 0.1441, label: 1, bag_size: 442
batch 179, loss: 0.0334, instance_loss: 0.1072, weighted_loss: 0.0555, label: 0, bag_size: 410
batch 199, loss: 0.0560, instance_loss: 0.6761, weighted_loss: 0.2420, label: 1, bag_size: 660
batch 219, loss: 0.0349, instance_loss: 0.0670, weighted_loss: 0.0445, label: 3, bag_size: 316
batch 239, loss: 0.5421, instance_loss: 0.5391, weighted_loss: 0.5412, label: 2, bag_size: 384
batch 259, loss: 0.0241, instance_loss: 0.1641, weighted_loss: 0.0661, label: 3, bag_size: 729
batch 279, loss: 0.1657, instance_loss: 0.3012, weighted_loss: 0.2064, label: 2, bag_size: 848
batch 299, loss: 0.0074, instance_loss: 0.3040, weighted_loss: 0.0964, label: 4, bag_size: 590
batch 319, loss: 0.0966, instance_loss: 0.1652, weighted_loss: 0.1172, label: 3, bag_size: 1291
batch 339, loss: 0.0429, instance_loss: 0.4954, weighted_loss: 0.1786, label: 2, bag_size: 358
batch 359, loss: 0.0668, instance_loss: 0.2618, weighted_loss: 0.1253, label: 2, bag_size: 701
batch 379, loss: 0.0063, instance_loss: 0.0564, weighted_loss: 0.0213, label: 0, bag_size: 729
batch 399, loss: 0.0007, instance_loss: 0.3140, weighted_loss: 0.0947, label: 3, bag_size: 671
batch 419, loss: 0.0201, instance_loss: 0.2134, weighted_loss: 0.0781, label: 2, bag_size: 317


class 0 clustering acc 0.9884705882352941: correct 16804/17000
class 1 clustering acc 0.4370588235294118: correct 1486/3400
Epoch: 40, train_loss: 0.2033, train_clustering_loss:  0.2998, train_error: 0.0565
class 0: acc 0.9878048780487805, correct 81/82
class 1: acc 0.8636363636363636, correct 76/88
class 2: acc 0.9, correct 81/90
class 3: acc 0.9767441860465116, correct 84/86
class 4: acc 1.0, correct 79/79

Val Set, val_loss: 1.3676, val_error: 0.3800, auc: 0.7138
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.2, correct 1/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0637, instance_loss: 0.3844, weighted_loss: 0.1599, label: 2, bag_size: 1439
batch 39, loss: 0.0209, instance_loss: 0.1369, weighted_loss: 0.0557, label: 3, bag_size: 1291
batch 59, loss: 0.0557, instance_loss: 0.2492, weighted_loss: 0.1137, label: 0, bag_size: 542
batch 79, loss: 0.0791, instance_loss: 0.2310, weighted_loss: 0.1246, label: 3, bag_size: 533
batch 99, loss: 0.0006, instance_loss: 0.2870, weighted_loss: 0.0865, label: 3, bag_size: 671
batch 119, loss: 0.0285, instance_loss: 0.2779, weighted_loss: 0.1033, label: 3, bag_size: 821
batch 139, loss: 0.0315, instance_loss: 0.2796, weighted_loss: 0.1060, label: 4, bag_size: 729
batch 159, loss: 0.1556, instance_loss: 0.4898, weighted_loss: 0.2559, label: 2, bag_size: 1677
batch 179, loss: 0.0675, instance_loss: 0.2496, weighted_loss: 0.1222, label: 1, bag_size: 944
batch 199, loss: 0.1363, instance_loss: 0.3925, weighted_loss: 0.2132, label: 1, bag_size: 504
batch 219, loss: 0.0328, instance_loss: 0.4849, weighted_loss: 0.1684, label: 4, bag_size: 533
batch 239, loss: 0.0001, instance_loss: 0.1810, weighted_loss: 0.0544, label: 4, bag_size: 947
batch 259, loss: 0.0016, instance_loss: 0.0354, weighted_loss: 0.0117, label: 0, bag_size: 898
batch 279, loss: 2.9285, instance_loss: 0.7965, weighted_loss: 2.2889, label: 1, bag_size: 651
batch 299, loss: 0.1206, instance_loss: 0.2718, weighted_loss: 0.1659, label: 2, bag_size: 499
batch 319, loss: 0.0056, instance_loss: 0.1097, weighted_loss: 0.0368, label: 0, bag_size: 524
batch 339, loss: 0.0043, instance_loss: 0.0886, weighted_loss: 0.0296, label: 1, bag_size: 286
batch 359, loss: 0.0490, instance_loss: 0.4594, weighted_loss: 0.1721, label: 0, bag_size: 818
batch 379, loss: 0.0419, instance_loss: 0.3461, weighted_loss: 0.1332, label: 1, bag_size: 711
batch 399, loss: 0.0399, instance_loss: 0.4187, weighted_loss: 0.1535, label: 1, bag_size: 711
batch 419, loss: 0.0040, instance_loss: 0.0440, weighted_loss: 0.0160, label: 0, bag_size: 982


class 0 clustering acc 0.9866470588235294: correct 16773/17000
class 1 clustering acc 0.4208823529411765: correct 1431/3400
Epoch: 41, train_loss: 0.2313, train_clustering_loss:  0.3138, train_error: 0.0847
class 0: acc 0.9382716049382716, correct 76/81
class 1: acc 0.8295454545454546, correct 73/88
class 2: acc 0.8469387755102041, correct 83/98
class 3: acc 1.0, correct 78/78
class 4: acc 0.9875, correct 79/80

Val Set, val_loss: 1.2961, val_error: 0.4000, auc: 0.7362
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.1425: correct 57/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.45, correct 9/20
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0326, instance_loss: 0.1014, weighted_loss: 0.0532, label: 0, bag_size: 1517
batch 39, loss: 1.0069, instance_loss: 0.6039, weighted_loss: 0.8860, label: 1, bag_size: 968
batch 59, loss: 0.0529, instance_loss: 0.2947, weighted_loss: 0.1254, label: 2, bag_size: 1180
batch 79, loss: 0.0155, instance_loss: 0.0620, weighted_loss: 0.0295, label: 0, bag_size: 476
batch 99, loss: 0.0585, instance_loss: 0.2266, weighted_loss: 0.1089, label: 2, bag_size: 270
batch 119, loss: 0.0780, instance_loss: 0.2686, weighted_loss: 0.1352, label: 2, bag_size: 932
batch 139, loss: 0.1677, instance_loss: 0.4185, weighted_loss: 0.2430, label: 2, bag_size: 943
batch 159, loss: 0.0514, instance_loss: 0.2393, weighted_loss: 0.1078, label: 2, bag_size: 626
batch 179, loss: 0.0082, instance_loss: 0.1442, weighted_loss: 0.0490, label: 0, bag_size: 729
batch 199, loss: 0.6328, instance_loss: 0.4122, weighted_loss: 0.5666, label: 2, bag_size: 1378
batch 219, loss: 0.1749, instance_loss: 0.4542, weighted_loss: 0.2587, label: 1, bag_size: 925
batch 239, loss: 0.2778, instance_loss: 0.2448, weighted_loss: 0.2679, label: 2, bag_size: 589
batch 259, loss: 0.0139, instance_loss: 0.0766, weighted_loss: 0.0327, label: 0, bag_size: 729
batch 279, loss: 0.0291, instance_loss: 0.6978, weighted_loss: 0.2297, label: 1, bag_size: 651
batch 299, loss: 0.5515, instance_loss: 0.5961, weighted_loss: 0.5648, label: 1, bag_size: 700
batch 319, loss: 0.1131, instance_loss: 0.2920, weighted_loss: 0.1668, label: 0, bag_size: 1190
batch 339, loss: 0.1055, instance_loss: 0.2709, weighted_loss: 0.1551, label: 2, bag_size: 499
batch 359, loss: 0.0032, instance_loss: 0.0985, weighted_loss: 0.0318, label: 4, bag_size: 1121
batch 379, loss: 0.7085, instance_loss: 0.5183, weighted_loss: 0.6514, label: 2, bag_size: 1231
batch 399, loss: 0.0463, instance_loss: 0.5497, weighted_loss: 0.1973, label: 3, bag_size: 1250
batch 419, loss: 0.0018, instance_loss: 0.0475, weighted_loss: 0.0155, label: 4, bag_size: 729


class 0 clustering acc 0.9862352941176471: correct 16766/17000
class 1 clustering acc 0.42911764705882355: correct 1459/3400
Epoch: 42, train_loss: 0.2167, train_clustering_loss:  0.3053, train_error: 0.0588
class 0: acc 0.9583333333333334, correct 69/72
class 1: acc 0.8452380952380952, correct 71/84
class 2: acc 0.9166666666666666, correct 99/108
class 3: acc 1.0, correct 85/85
class 4: acc 1.0, correct 76/76

Val Set, val_loss: 1.3238, val_error: 0.3400, auc: 0.7088
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.1725: correct 69/400
class 0: acc 1.0, correct 5/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0168, instance_loss: 0.0700, weighted_loss: 0.0328, label: 3, bag_size: 729
batch 39, loss: 0.0294, instance_loss: 0.1793, weighted_loss: 0.0744, label: 0, bag_size: 1332
batch 59, loss: 0.0000, instance_loss: 0.1977, weighted_loss: 0.0593, label: 4, bag_size: 729
batch 79, loss: 0.0134, instance_loss: 0.1706, weighted_loss: 0.0605, label: 3, bag_size: 1019
batch 99, loss: 0.0540, instance_loss: 0.3555, weighted_loss: 0.1444, label: 3, bag_size: 281
batch 119, loss: 0.2403, instance_loss: 0.4469, weighted_loss: 0.3023, label: 2, bag_size: 278
batch 139, loss: 0.0009, instance_loss: 0.1647, weighted_loss: 0.0500, label: 1, bag_size: 866
batch 159, loss: 1.2357, instance_loss: 0.4673, weighted_loss: 1.0052, label: 1, bag_size: 1049
batch 179, loss: 0.0509, instance_loss: 0.1275, weighted_loss: 0.0739, label: 4, bag_size: 790
batch 199, loss: 0.1621, instance_loss: 0.6163, weighted_loss: 0.2984, label: 1, bag_size: 293
batch 219, loss: 0.0005, instance_loss: 0.4468, weighted_loss: 0.1343, label: 4, bag_size: 882
batch 239, loss: 0.0010, instance_loss: 0.2560, weighted_loss: 0.0775, label: 3, bag_size: 706
batch 259, loss: 0.0214, instance_loss: 0.2449, weighted_loss: 0.0885, label: 2, bag_size: 1788
batch 279, loss: 0.2238, instance_loss: 0.3362, weighted_loss: 0.2575, label: 0, bag_size: 350
batch 299, loss: 0.7488, instance_loss: 0.6422, weighted_loss: 0.7168, label: 1, bag_size: 700
batch 319, loss: 0.7388, instance_loss: 0.7156, weighted_loss: 0.7318, label: 1, bag_size: 1799
batch 339, loss: 0.0104, instance_loss: 0.2449, weighted_loss: 0.0808, label: 3, bag_size: 1019
batch 359, loss: 0.0431, instance_loss: 0.2410, weighted_loss: 0.1025, label: 2, bag_size: 701
batch 379, loss: 0.1645, instance_loss: 0.3104, weighted_loss: 0.2083, label: 2, bag_size: 1348
batch 399, loss: 0.0483, instance_loss: 0.0541, weighted_loss: 0.0500, label: 3, bag_size: 729
batch 419, loss: 0.0053, instance_loss: 0.1719, weighted_loss: 0.0553, label: 3, bag_size: 729


class 0 clustering acc 0.9882941176470589: correct 16801/17000
class 1 clustering acc 0.465: correct 1581/3400
Epoch: 43, train_loss: 0.1589, train_clustering_loss:  0.2924, train_error: 0.0541
class 0: acc 0.9871794871794872, correct 77/78
class 1: acc 0.8918918918918919, correct 66/74
class 2: acc 0.8651685393258427, correct 77/89
class 3: acc 1.0, correct 96/96
class 4: acc 0.9772727272727273, correct 86/88

Val Set, val_loss: 1.4973, val_error: 0.4000, auc: 0.6878
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.1825: correct 73/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.5897, instance_loss: 0.2920, weighted_loss: 0.5004, label: 2, bag_size: 748
batch 39, loss: 0.0008, instance_loss: 0.0425, weighted_loss: 0.0133, label: 4, bag_size: 947
batch 59, loss: 0.0270, instance_loss: 0.1943, weighted_loss: 0.0772, label: 3, bag_size: 729
batch 79, loss: 0.4160, instance_loss: 0.3103, weighted_loss: 0.3843, label: 2, bag_size: 676
batch 99, loss: 0.2067, instance_loss: 0.1799, weighted_loss: 0.1986, label: 0, bag_size: 478
batch 119, loss: 0.0252, instance_loss: 0.2299, weighted_loss: 0.0866, label: 1, bag_size: 1325
batch 139, loss: 0.1119, instance_loss: 0.3477, weighted_loss: 0.1826, label: 3, bag_size: 281
batch 159, loss: 0.0697, instance_loss: 0.1578, weighted_loss: 0.0961, label: 0, bag_size: 1061
batch 179, loss: 0.0996, instance_loss: 0.3240, weighted_loss: 0.1669, label: 1, bag_size: 696
batch 199, loss: 0.1942, instance_loss: 0.2873, weighted_loss: 0.2221, label: 2, bag_size: 347
batch 219, loss: 0.2693, instance_loss: 0.2155, weighted_loss: 0.2532, label: 0, bag_size: 1034
batch 239, loss: 0.9968, instance_loss: 0.3546, weighted_loss: 0.8041, label: 1, bag_size: 1014
batch 259, loss: 0.0456, instance_loss: 0.4841, weighted_loss: 0.1771, label: 3, bag_size: 281
batch 279, loss: 0.0012, instance_loss: 0.0775, weighted_loss: 0.0241, label: 1, bag_size: 1261
batch 299, loss: 0.0005, instance_loss: 0.1051, weighted_loss: 0.0319, label: 3, bag_size: 729
batch 319, loss: 0.0005, instance_loss: 0.3724, weighted_loss: 0.1121, label: 4, bag_size: 974
batch 339, loss: 0.0081, instance_loss: 0.3433, weighted_loss: 0.1086, label: 3, bag_size: 317
batch 359, loss: 0.4488, instance_loss: 0.3928, weighted_loss: 0.4320, label: 2, bag_size: 278
batch 379, loss: 0.0023, instance_loss: 0.0882, weighted_loss: 0.0281, label: 1, bag_size: 847
batch 399, loss: 0.0069, instance_loss: 0.0589, weighted_loss: 0.0225, label: 0, bag_size: 729
batch 419, loss: 0.0812, instance_loss: 0.1853, weighted_loss: 0.1124, label: 0, bag_size: 1133


class 0 clustering acc 0.9874117647058823: correct 16786/17000
class 1 clustering acc 0.4964705882352941: correct 1688/3400
Epoch: 44, train_loss: 0.1451, train_clustering_loss:  0.2840, train_error: 0.0424
class 0: acc 0.9736842105263158, correct 74/76
class 1: acc 0.9130434782608695, correct 84/92
class 2: acc 0.8974358974358975, correct 70/78
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 99/99

Val Set, val_loss: 1.3677, val_error: 0.3800, auc: 0.7051
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.2: correct 80/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0029, instance_loss: 0.1214, weighted_loss: 0.0385, label: 3, bag_size: 729
batch 39, loss: 0.0001, instance_loss: 0.1886, weighted_loss: 0.0567, label: 4, bag_size: 1235
batch 59, loss: 0.0467, instance_loss: 0.1547, weighted_loss: 0.0791, label: 0, bag_size: 424
batch 79, loss: 0.0025, instance_loss: 0.0323, weighted_loss: 0.0114, label: 0, bag_size: 1143
batch 99, loss: 0.1038, instance_loss: 0.2788, weighted_loss: 0.1563, label: 1, bag_size: 754
batch 119, loss: 0.0144, instance_loss: 0.1336, weighted_loss: 0.0502, label: 0, bag_size: 524
batch 139, loss: 0.0066, instance_loss: 0.3549, weighted_loss: 0.1111, label: 3, bag_size: 671
batch 159, loss: 0.0069, instance_loss: 0.0548, weighted_loss: 0.0213, label: 3, bag_size: 305
batch 179, loss: 0.0007, instance_loss: 0.1446, weighted_loss: 0.0438, label: 4, bag_size: 729
batch 199, loss: 0.0181, instance_loss: 0.3503, weighted_loss: 0.1177, label: 1, bag_size: 1049
batch 219, loss: 0.0139, instance_loss: 0.1059, weighted_loss: 0.0415, label: 0, bag_size: 1301
batch 239, loss: 0.0327, instance_loss: 0.2039, weighted_loss: 0.0840, label: 4, bag_size: 656
batch 259, loss: 0.0008, instance_loss: 0.1772, weighted_loss: 0.0537, label: 3, bag_size: 706
batch 279, loss: 0.0703, instance_loss: 0.4658, weighted_loss: 0.1889, label: 1, bag_size: 711
batch 299, loss: 0.0039, instance_loss: 0.0723, weighted_loss: 0.0244, label: 3, bag_size: 1172
batch 319, loss: 0.0071, instance_loss: 0.0524, weighted_loss: 0.0207, label: 3, bag_size: 1291
batch 339, loss: 0.0029, instance_loss: 0.1133, weighted_loss: 0.0360, label: 0, bag_size: 976
batch 359, loss: 0.0011, instance_loss: 0.3306, weighted_loss: 0.0999, label: 4, bag_size: 754
batch 379, loss: 0.1503, instance_loss: 0.3684, weighted_loss: 0.2157, label: 1, bag_size: 1014
batch 399, loss: 0.0762, instance_loss: 0.2454, weighted_loss: 0.1269, label: 0, bag_size: 350
batch 419, loss: 0.0014, instance_loss: 0.0432, weighted_loss: 0.0139, label: 0, bag_size: 898


class 0 clustering acc 0.9856470588235294: correct 16756/17000
class 1 clustering acc 0.47147058823529414: correct 1603/3400
Epoch: 45, train_loss: 0.1444, train_clustering_loss:  0.2949, train_error: 0.0471
class 0: acc 0.9587628865979382, correct 93/97
class 1: acc 0.9425287356321839, correct 82/87
class 2: acc 0.8450704225352113, correct 60/71
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 90/90

Val Set, val_loss: 1.4477, val_error: 0.3600, auc: 0.7042
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.155: correct 62/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0174, instance_loss: 0.6189, weighted_loss: 0.1979, label: 1, bag_size: 1255
batch 39, loss: 0.2115, instance_loss: 0.2783, weighted_loss: 0.2315, label: 2, bag_size: 883
batch 59, loss: 0.0344, instance_loss: 0.1690, weighted_loss: 0.0748, label: 2, bag_size: 806
batch 79, loss: 0.9465, instance_loss: 0.3843, weighted_loss: 0.7779, label: 0, bag_size: 736
batch 99, loss: 0.0069, instance_loss: 0.1621, weighted_loss: 0.0535, label: 2, bag_size: 910
batch 119, loss: 0.0001, instance_loss: 0.0452, weighted_loss: 0.0136, label: 4, bag_size: 729
batch 139, loss: 0.0398, instance_loss: 0.2701, weighted_loss: 0.1089, label: 1, bag_size: 696
batch 159, loss: 0.0001, instance_loss: 0.0940, weighted_loss: 0.0283, label: 4, bag_size: 729
batch 179, loss: 0.0267, instance_loss: 0.1143, weighted_loss: 0.0530, label: 0, bag_size: 1133
batch 199, loss: 0.0008, instance_loss: 0.0996, weighted_loss: 0.0304, label: 3, bag_size: 729
batch 219, loss: 0.0586, instance_loss: 0.3475, weighted_loss: 0.1453, label: 1, bag_size: 754
batch 239, loss: 0.0086, instance_loss: 0.3301, weighted_loss: 0.1050, label: 3, bag_size: 849
batch 259, loss: 0.0304, instance_loss: 0.1636, weighted_loss: 0.0704, label: 0, bag_size: 294
batch 279, loss: 0.0385, instance_loss: 0.1768, weighted_loss: 0.0800, label: 0, bag_size: 990
batch 299, loss: 0.0981, instance_loss: 0.0859, weighted_loss: 0.0944, label: 3, bag_size: 316
batch 319, loss: 0.0033, instance_loss: 0.0828, weighted_loss: 0.0271, label: 4, bag_size: 773
batch 339, loss: 0.0012, instance_loss: 0.1601, weighted_loss: 0.0488, label: 4, bag_size: 656
batch 359, loss: 0.0011, instance_loss: 0.0181, weighted_loss: 0.0062, label: 0, bag_size: 521
batch 379, loss: 0.2286, instance_loss: 0.7287, weighted_loss: 0.3786, label: 1, bag_size: 386
batch 399, loss: 0.0526, instance_loss: 0.2528, weighted_loss: 0.1127, label: 2, bag_size: 1306
batch 419, loss: 0.0472, instance_loss: 0.1988, weighted_loss: 0.0927, label: 2, bag_size: 806


class 0 clustering acc 0.9864705882352941: correct 16770/17000
class 1 clustering acc 0.5235294117647059: correct 1780/3400
Epoch: 46, train_loss: 0.1301, train_clustering_loss:  0.2730, train_error: 0.0424
class 0: acc 0.967391304347826, correct 89/92
class 1: acc 0.9315068493150684, correct 68/73
class 2: acc 0.8734177215189873, correct 69/79
class 3: acc 1.0, correct 97/97
class 4: acc 1.0, correct 84/84

Val Set, val_loss: 1.4127, val_error: 0.3800, auc: 0.7502
class 0 clustering acc 0.961: correct 1922/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0860, weighted_loss: 0.0260, label: 3, bag_size: 729
batch 39, loss: 0.0392, instance_loss: 0.2293, weighted_loss: 0.0962, label: 2, bag_size: 1133
batch 59, loss: 0.0039, instance_loss: 0.0941, weighted_loss: 0.0309, label: 4, bag_size: 646
batch 79, loss: 0.0208, instance_loss: 0.1903, weighted_loss: 0.0717, label: 2, bag_size: 1050
batch 99, loss: 0.1733, instance_loss: 0.4116, weighted_loss: 0.2448, label: 1, bag_size: 746
batch 119, loss: 0.0001, instance_loss: 0.0644, weighted_loss: 0.0194, label: 4, bag_size: 729
batch 139, loss: 0.0323, instance_loss: 0.4359, weighted_loss: 0.1534, label: 1, bag_size: 818
batch 159, loss: 0.0776, instance_loss: 0.2718, weighted_loss: 0.1359, label: 2, bag_size: 1281
batch 179, loss: 0.2223, instance_loss: 0.3107, weighted_loss: 0.2488, label: 0, bag_size: 1247
batch 199, loss: 0.1426, instance_loss: 0.2526, weighted_loss: 0.1756, label: 2, bag_size: 1281
batch 219, loss: 0.0036, instance_loss: 0.1812, weighted_loss: 0.0569, label: 3, bag_size: 729
batch 239, loss: 0.1791, instance_loss: 0.4871, weighted_loss: 0.2715, label: 1, bag_size: 786
batch 259, loss: 0.0210, instance_loss: 0.2477, weighted_loss: 0.0890, label: 4, bag_size: 646
batch 279, loss: 0.0022, instance_loss: 0.2334, weighted_loss: 0.0716, label: 3, bag_size: 1253
batch 299, loss: 0.0015, instance_loss: 0.1534, weighted_loss: 0.0471, label: 0, bag_size: 976
batch 319, loss: 0.3413, instance_loss: 0.3298, weighted_loss: 0.3378, label: 2, bag_size: 861
batch 339, loss: 0.9690, instance_loss: 0.4941, weighted_loss: 0.8265, label: 2, bag_size: 1139
batch 359, loss: 0.0019, instance_loss: 0.0880, weighted_loss: 0.0277, label: 4, bag_size: 764
batch 379, loss: 0.0035, instance_loss: 0.0548, weighted_loss: 0.0189, label: 0, bag_size: 1143
batch 399, loss: 0.0625, instance_loss: 0.4129, weighted_loss: 0.1676, label: 2, bag_size: 741
batch 419, loss: 0.0078, instance_loss: 0.1529, weighted_loss: 0.0513, label: 0, bag_size: 729


class 0 clustering acc 0.985764705882353: correct 16758/17000
class 1 clustering acc 0.4923529411764706: correct 1674/3400
Epoch: 47, train_loss: 0.1238, train_clustering_loss:  0.2851, train_error: 0.0376
class 0: acc 0.972972972972973, correct 72/74
class 1: acc 0.9166666666666666, correct 77/84
class 2: acc 0.9263157894736842, correct 88/95
class 3: acc 1.0, correct 91/91
class 4: acc 1.0, correct 81/81

Val Set, val_loss: 1.4731, val_error: 0.4200, auc: 0.6928
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.4290, instance_loss: 0.4966, weighted_loss: 0.4493, label: 1, bag_size: 377
batch 39, loss: 0.0010, instance_loss: 0.4094, weighted_loss: 0.1235, label: 4, bag_size: 974
batch 59, loss: 0.2284, instance_loss: 0.4298, weighted_loss: 0.2888, label: 3, bag_size: 281
batch 79, loss: 0.0113, instance_loss: 0.1260, weighted_loss: 0.0457, label: 0, bag_size: 729
batch 99, loss: 0.6030, instance_loss: 0.2703, weighted_loss: 0.5032, label: 2, bag_size: 471
batch 119, loss: 0.0056, instance_loss: 0.0921, weighted_loss: 0.0315, label: 0, bag_size: 729
batch 139, loss: 0.0070, instance_loss: 0.1366, weighted_loss: 0.0459, label: 0, bag_size: 729
batch 159, loss: 0.0278, instance_loss: 0.1699, weighted_loss: 0.0704, label: 0, bag_size: 350
batch 179, loss: 0.0019, instance_loss: 0.1135, weighted_loss: 0.0354, label: 3, bag_size: 729
batch 199, loss: 0.0011, instance_loss: 0.2291, weighted_loss: 0.0695, label: 1, bag_size: 1127
batch 219, loss: 0.5805, instance_loss: 0.7452, weighted_loss: 0.6299, label: 0, bag_size: 423
batch 239, loss: 0.0055, instance_loss: 0.1495, weighted_loss: 0.0487, label: 3, bag_size: 1069
batch 259, loss: 0.0113, instance_loss: 0.0791, weighted_loss: 0.0317, label: 0, bag_size: 340
batch 279, loss: 0.0299, instance_loss: 0.2654, weighted_loss: 0.1005, label: 0, bag_size: 736
batch 299, loss: 0.4520, instance_loss: 0.4908, weighted_loss: 0.4636, label: 1, bag_size: 446
batch 319, loss: 0.0138, instance_loss: 0.3918, weighted_loss: 0.1272, label: 2, bag_size: 636
batch 339, loss: 0.0071, instance_loss: 0.1077, weighted_loss: 0.0373, label: 3, bag_size: 952
batch 359, loss: 0.0023, instance_loss: 0.0201, weighted_loss: 0.0076, label: 0, bag_size: 921
batch 379, loss: 0.0021, instance_loss: 0.3277, weighted_loss: 0.0998, label: 3, bag_size: 317
batch 399, loss: 0.0007, instance_loss: 0.0359, weighted_loss: 0.0113, label: 0, bag_size: 1466
batch 419, loss: 0.0474, instance_loss: 0.1070, weighted_loss: 0.0653, label: 4, bag_size: 790


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.4894117647058824: correct 1664/3400
Epoch: 48, train_loss: 0.1059, train_clustering_loss:  0.2789, train_error: 0.0212
class 0: acc 0.9885057471264368, correct 86/87
class 1: acc 0.9425287356321839, correct 82/87
class 2: acc 0.9659090909090909, correct 85/88
class 3: acc 1.0, correct 87/87
class 4: acc 1.0, correct 76/76

Val Set, val_loss: 1.3342, val_error: 0.3800, auc: 0.7332
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.2225: correct 89/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0769, weighted_loss: 0.0232, label: 4, bag_size: 636
batch 39, loss: 0.0003, instance_loss: 0.0974, weighted_loss: 0.0294, label: 4, bag_size: 1278
batch 59, loss: 0.0156, instance_loss: 0.6398, weighted_loss: 0.2028, label: 2, bag_size: 636
batch 79, loss: 0.1677, instance_loss: 0.3843, weighted_loss: 0.2327, label: 0, bag_size: 1527
batch 99, loss: 0.0015, instance_loss: 0.1008, weighted_loss: 0.0313, label: 4, bag_size: 1474
batch 119, loss: 0.1770, instance_loss: 0.1096, weighted_loss: 0.1568, label: 3, bag_size: 729
batch 139, loss: 0.0406, instance_loss: 0.3346, weighted_loss: 0.1288, label: 1, bag_size: 348
batch 159, loss: 0.1489, instance_loss: 0.6982, weighted_loss: 0.3137, label: 2, bag_size: 720
batch 179, loss: 0.5054, instance_loss: 0.4824, weighted_loss: 0.4985, label: 1, bag_size: 377
batch 199, loss: 0.0181, instance_loss: 0.6523, weighted_loss: 0.2084, label: 4, bag_size: 436
batch 219, loss: 0.0782, instance_loss: 0.5773, weighted_loss: 0.2279, label: 2, bag_size: 878
batch 239, loss: 0.3748, instance_loss: 0.3861, weighted_loss: 0.3782, label: 1, bag_size: 470
batch 259, loss: 0.0642, instance_loss: 0.4434, weighted_loss: 0.1780, label: 1, bag_size: 487
batch 279, loss: 0.0280, instance_loss: 0.2194, weighted_loss: 0.0854, label: 2, bag_size: 1050
batch 299, loss: 0.0046, instance_loss: 0.0587, weighted_loss: 0.0208, label: 0, bag_size: 921
batch 319, loss: 0.0019, instance_loss: 0.0979, weighted_loss: 0.0307, label: 3, bag_size: 1291
batch 339, loss: 0.0955, instance_loss: 0.0922, weighted_loss: 0.0945, label: 0, bag_size: 1247
batch 359, loss: 0.0089, instance_loss: 0.0764, weighted_loss: 0.0292, label: 3, bag_size: 1399
batch 379, loss: 0.0002, instance_loss: 0.0292, weighted_loss: 0.0089, label: 3, bag_size: 305
batch 399, loss: 0.0164, instance_loss: 0.0767, weighted_loss: 0.0345, label: 0, bag_size: 367
batch 419, loss: 0.0103, instance_loss: 0.0621, weighted_loss: 0.0258, label: 0, bag_size: 602


class 0 clustering acc 0.9857058823529412: correct 16757/17000
class 1 clustering acc 0.4858823529411765: correct 1652/3400
Epoch: 49, train_loss: 0.1211, train_clustering_loss:  0.2910, train_error: 0.0329
class 0: acc 0.9634146341463414, correct 79/82
class 1: acc 0.9431818181818182, correct 83/88
class 2: acc 0.9315068493150684, correct 68/73
class 3: acc 1.0, correct 87/87
class 4: acc 0.9894736842105263, correct 94/95

Val Set, val_loss: 1.5052, val_error: 0.3600, auc: 0.7174
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.55, correct 11/20
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0116, instance_loss: 0.3257, weighted_loss: 0.1059, label: 3, bag_size: 533
batch 39, loss: 0.2124, instance_loss: 0.4596, weighted_loss: 0.2865, label: 2, bag_size: 682
batch 59, loss: 0.0005, instance_loss: 0.3090, weighted_loss: 0.0931, label: 3, bag_size: 1253
batch 79, loss: 0.1051, instance_loss: 0.3420, weighted_loss: 0.1761, label: 3, bag_size: 360
batch 99, loss: 0.0928, instance_loss: 0.5340, weighted_loss: 0.2252, label: 2, bag_size: 248
batch 119, loss: 0.0252, instance_loss: 0.0727, weighted_loss: 0.0395, label: 3, bag_size: 556
batch 139, loss: 0.1491, instance_loss: 0.5629, weighted_loss: 0.2732, label: 1, bag_size: 1559
batch 159, loss: 0.0345, instance_loss: 0.2734, weighted_loss: 0.1062, label: 2, bag_size: 1569
batch 179, loss: 0.0009, instance_loss: 0.0834, weighted_loss: 0.0256, label: 3, bag_size: 729
batch 199, loss: 0.0456, instance_loss: 0.4069, weighted_loss: 0.1540, label: 2, bag_size: 1006
batch 219, loss: 0.2876, instance_loss: 0.6921, weighted_loss: 0.4090, label: 1, bag_size: 386
batch 239, loss: 0.0028, instance_loss: 0.0535, weighted_loss: 0.0180, label: 0, bag_size: 521
batch 259, loss: 0.0372, instance_loss: 0.0759, weighted_loss: 0.0489, label: 3, bag_size: 556
batch 279, loss: 0.0684, instance_loss: 0.2523, weighted_loss: 0.1236, label: 3, bag_size: 343
batch 299, loss: 0.0031, instance_loss: 0.0569, weighted_loss: 0.0192, label: 1, bag_size: 286
batch 319, loss: 0.0370, instance_loss: 0.5349, weighted_loss: 0.1864, label: 3, bag_size: 281
batch 339, loss: 0.4307, instance_loss: 0.4486, weighted_loss: 0.4361, label: 1, bag_size: 711
batch 359, loss: 0.0058, instance_loss: 0.0344, weighted_loss: 0.0144, label: 3, bag_size: 729
batch 379, loss: 0.0101, instance_loss: 0.5666, weighted_loss: 0.1771, label: 4, bag_size: 533
batch 399, loss: 0.0014, instance_loss: 0.0312, weighted_loss: 0.0103, label: 0, bag_size: 1466
batch 419, loss: 0.0163, instance_loss: 0.2447, weighted_loss: 0.0848, label: 4, bag_size: 675


class 0 clustering acc 0.989: correct 16813/17000
class 1 clustering acc 0.4526470588235294: correct 1539/3400
Epoch: 50, train_loss: 0.1567, train_clustering_loss:  0.3027, train_error: 0.0447
class 0: acc 0.9662921348314607, correct 86/89
class 1: acc 0.9148936170212766, correct 86/94
class 2: acc 0.922077922077922, correct 71/77
class 3: acc 0.9893617021276596, correct 93/94
class 4: acc 0.9859154929577465, correct 70/71

Val Set, val_loss: 1.4119, val_error: 0.3600, auc: 0.7102
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.175: correct 70/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.65, correct 13/20
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.0151, instance_loss: 0.4140, weighted_loss: 0.1348, label: 2, bag_size: 600
batch 39, loss: 1.1987, instance_loss: 0.4655, weighted_loss: 0.9787, label: 4, bag_size: 729
batch 59, loss: 0.0614, instance_loss: 0.2511, weighted_loss: 0.1183, label: 2, bag_size: 1133
batch 79, loss: 0.0017, instance_loss: 0.0811, weighted_loss: 0.0255, label: 4, bag_size: 646
batch 99, loss: 0.0625, instance_loss: 0.4797, weighted_loss: 0.1876, label: 0, bag_size: 729
batch 119, loss: 0.0004, instance_loss: 0.2955, weighted_loss: 0.0889, label: 4, bag_size: 1357
batch 139, loss: 0.0089, instance_loss: 0.7661, weighted_loss: 0.2361, label: 1, bag_size: 1390
batch 159, loss: 0.0013, instance_loss: 0.1770, weighted_loss: 0.0540, label: 3, bag_size: 1019
batch 179, loss: 0.5424, instance_loss: 0.6630, weighted_loss: 0.5786, label: 0, bag_size: 423
batch 199, loss: 0.0503, instance_loss: 0.7461, weighted_loss: 0.2591, label: 3, bag_size: 200
batch 219, loss: 0.0000, instance_loss: 0.0542, weighted_loss: 0.0163, label: 4, bag_size: 729
batch 239, loss: 0.0667, instance_loss: 0.7140, weighted_loss: 0.2609, label: 1, bag_size: 293
batch 259, loss: 0.0532, instance_loss: 0.4034, weighted_loss: 0.1583, label: 2, bag_size: 1218
batch 279, loss: 0.7700, instance_loss: 0.3757, weighted_loss: 0.6517, label: 1, bag_size: 1014
batch 299, loss: 0.3429, instance_loss: 0.7760, weighted_loss: 0.4729, label: 1, bag_size: 1799
batch 319, loss: 0.0071, instance_loss: 0.0774, weighted_loss: 0.0282, label: 0, bag_size: 729
batch 339, loss: 0.0058, instance_loss: 0.0569, weighted_loss: 0.0212, label: 0, bag_size: 729
batch 359, loss: 0.0059, instance_loss: 0.3368, weighted_loss: 0.1052, label: 4, bag_size: 1278
batch 379, loss: 0.0155, instance_loss: 0.2034, weighted_loss: 0.0719, label: 3, bag_size: 230
batch 399, loss: 0.0257, instance_loss: 0.2728, weighted_loss: 0.0998, label: 2, bag_size: 312
batch 419, loss: 0.0018, instance_loss: 0.0798, weighted_loss: 0.0252, label: 4, bag_size: 790


class 0 clustering acc 0.987764705882353: correct 16792/17000
class 1 clustering acc 0.4761764705882353: correct 1619/3400
Epoch: 51, train_loss: 0.1160, train_clustering_loss:  0.2914, train_error: 0.0353
class 0: acc 0.9791666666666666, correct 94/96
class 1: acc 0.9620253164556962, correct 76/79
class 2: acc 0.9052631578947369, correct 86/95
class 3: acc 1.0, correct 85/85
class 4: acc 0.9857142857142858, correct 69/70

Val Set, val_loss: 1.3298, val_error: 0.3600, auc: 0.7556
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.5, correct 10/20
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 41 out of 20
Early stopping
Val error: 0.4000, ROC AUC: 0.6608
Test error: 0.3000, ROC AUC: 0.9154
class 0: acc 1.0, correct 12/12
class 1: acc 0.8, correct 8/10
class 2: acc 0.5833333333333334, correct 14/24
class 3: acc 0.5, correct 1/2
class 4: acc 0.0, correct 0/2

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.5439, instance_loss: 1.1671, weighted_loss: 1.4309, label: 2, bag_size: 1235
batch 39, loss: 1.5414, instance_loss: 1.0686, weighted_loss: 1.3995, label: 3, bag_size: 729
batch 59, loss: 1.4488, instance_loss: 0.9101, weighted_loss: 1.2872, label: 0, bag_size: 729
batch 79, loss: 1.6146, instance_loss: 0.6864, weighted_loss: 1.3362, label: 3, bag_size: 360
batch 99, loss: 1.3891, instance_loss: 0.6180, weighted_loss: 1.1578, label: 0, bag_size: 410
batch 119, loss: 1.4930, instance_loss: 0.5845, weighted_loss: 1.2205, label: 3, bag_size: 729
batch 139, loss: 1.6743, instance_loss: 0.5426, weighted_loss: 1.3348, label: 4, bag_size: 542
batch 159, loss: 1.4232, instance_loss: 0.5181, weighted_loss: 1.1517, label: 3, bag_size: 729
batch 179, loss: 1.9471, instance_loss: 0.5344, weighted_loss: 1.5233, label: 1, bag_size: 242
batch 199, loss: 1.4387, instance_loss: 0.4902, weighted_loss: 1.1542, label: 2, bag_size: 911
batch 219, loss: 1.5189, instance_loss: 0.5163, weighted_loss: 1.2181, label: 0, bag_size: 478
batch 239, loss: 1.4388, instance_loss: 0.4745, weighted_loss: 1.1495, label: 3, bag_size: 1069
batch 259, loss: 1.5300, instance_loss: 0.5132, weighted_loss: 1.2250, label: 0, bag_size: 607
batch 279, loss: 1.3327, instance_loss: 0.4995, weighted_loss: 1.0828, label: 0, bag_size: 729
batch 299, loss: 1.8404, instance_loss: 0.5555, weighted_loss: 1.4549, label: 1, bag_size: 754
batch 319, loss: 1.2687, instance_loss: 0.4591, weighted_loss: 1.0258, label: 3, bag_size: 360
batch 339, loss: 1.4402, instance_loss: 0.5078, weighted_loss: 1.1604, label: 2, bag_size: 419
batch 359, loss: 1.4289, instance_loss: 0.4990, weighted_loss: 1.1499, label: 2, bag_size: 292
batch 379, loss: 1.7877, instance_loss: 0.5061, weighted_loss: 1.4032, label: 3, bag_size: 630
batch 399, loss: 1.3269, instance_loss: 0.5029, weighted_loss: 1.0797, label: 2, bag_size: 907
batch 419, loss: 1.5065, instance_loss: 0.5095, weighted_loss: 1.2074, label: 2, bag_size: 720


class 0 clustering acc 0.9942352941176471: correct 16902/17000
class 1 clustering acc 0.003823529411764706: correct 13/3400
Epoch: 0, train_loss: 1.5773, train_clustering_loss:  0.6169, train_error: 0.6918
class 0: acc 0.32558139534883723, correct 28/86
class 1: acc 0.0, correct 0/62
class 2: acc 0.24444444444444444, correct 22/90
class 3: acc 0.5869565217391305, correct 54/92
class 4: acc 0.28421052631578947, correct 27/95

Val Set, val_loss: 1.6074, val_error: 0.8400, auc: 0.7347
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/16
class 2: acc 0.2, correct 3/15
class 3: acc 0.0, correct 0/5
class 4: acc 1.0, correct 5/5
Validation loss decreased (inf --> 1.607390).  Saving model ...


batch 19, loss: 2.0112, instance_loss: 0.5529, weighted_loss: 1.5737, label: 3, bag_size: 1019
batch 39, loss: 1.8684, instance_loss: 0.5365, weighted_loss: 1.4689, label: 3, bag_size: 1177
batch 59, loss: 1.8825, instance_loss: 0.5334, weighted_loss: 1.4778, label: 3, bag_size: 821
batch 79, loss: 1.6926, instance_loss: 0.4965, weighted_loss: 1.3338, label: 4, bag_size: 1278
batch 99, loss: 1.4521, instance_loss: 0.5209, weighted_loss: 1.1727, label: 0, bag_size: 729
batch 119, loss: 1.3945, instance_loss: 0.4988, weighted_loss: 1.1258, label: 0, bag_size: 602
batch 139, loss: 1.1657, instance_loss: 0.4492, weighted_loss: 0.9507, label: 2, bag_size: 237
batch 159, loss: 2.3072, instance_loss: 0.5971, weighted_loss: 1.7942, label: 4, bag_size: 297
batch 179, loss: 1.6030, instance_loss: 0.5117, weighted_loss: 1.2756, label: 1, bag_size: 448
batch 199, loss: 1.2685, instance_loss: 0.4838, weighted_loss: 1.0331, label: 3, bag_size: 849
batch 219, loss: 1.2328, instance_loss: 0.4825, weighted_loss: 1.0077, label: 4, bag_size: 436
batch 239, loss: 1.3494, instance_loss: 0.4942, weighted_loss: 1.0928, label: 1, bag_size: 648
batch 259, loss: 1.7062, instance_loss: 0.5065, weighted_loss: 1.3463, label: 3, bag_size: 533
batch 279, loss: 1.3651, instance_loss: 0.4883, weighted_loss: 1.1020, label: 2, bag_size: 774
batch 299, loss: 1.0013, instance_loss: 0.4531, weighted_loss: 0.8368, label: 3, bag_size: 849
batch 319, loss: 1.0983, instance_loss: 0.4574, weighted_loss: 0.9060, label: 3, bag_size: 729
batch 339, loss: 1.6653, instance_loss: 0.5312, weighted_loss: 1.3251, label: 0, bag_size: 607
batch 359, loss: 1.3017, instance_loss: 0.4738, weighted_loss: 1.0534, label: 2, bag_size: 809
batch 379, loss: 0.9806, instance_loss: 0.4512, weighted_loss: 0.8218, label: 2, bag_size: 1700
batch 399, loss: 2.0630, instance_loss: 0.5680, weighted_loss: 1.6145, label: 1, bag_size: 533
batch 419, loss: 1.2489, instance_loss: 0.4868, weighted_loss: 1.0203, label: 2, bag_size: 986


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4856, train_clustering_loss:  0.5037, train_error: 0.6518
class 0: acc 0.1724137931034483, correct 15/87
class 1: acc 0.1527777777777778, correct 11/72
class 2: acc 0.5288461538461539, correct 55/104
class 3: acc 0.36904761904761907, correct 31/84
class 4: acc 0.46153846153846156, correct 36/78

Val Set, val_loss: 1.5377, val_error: 0.6400, auc: 0.7612
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.0, correct 0/16
class 2: acc 1.0, correct 15/15
class 3: acc 0.0, correct 0/5
class 4: acc 0.2, correct 1/5
Validation loss decreased (1.607390 --> 1.537698).  Saving model ...


batch 19, loss: 1.6385, instance_loss: 0.5245, weighted_loss: 1.3043, label: 1, bag_size: 614
batch 39, loss: 0.5049, instance_loss: 0.3872, weighted_loss: 0.4696, label: 4, bag_size: 729
batch 59, loss: 1.4587, instance_loss: 0.5019, weighted_loss: 1.1716, label: 4, bag_size: 1331
batch 79, loss: 1.3177, instance_loss: 0.4903, weighted_loss: 1.0694, label: 3, bag_size: 729
batch 99, loss: 1.6538, instance_loss: 0.5004, weighted_loss: 1.3078, label: 2, bag_size: 567
batch 119, loss: 1.4031, instance_loss: 0.4913, weighted_loss: 1.1296, label: 2, bag_size: 868
batch 139, loss: 1.2920, instance_loss: 0.4694, weighted_loss: 1.0452, label: 3, bag_size: 729
batch 159, loss: 0.9834, instance_loss: 0.4076, weighted_loss: 0.8107, label: 1, bag_size: 1127
batch 179, loss: 1.6408, instance_loss: 0.5117, weighted_loss: 1.3021, label: 2, bag_size: 120
batch 199, loss: 0.8815, instance_loss: 0.4299, weighted_loss: 0.7460, label: 4, bag_size: 646
batch 219, loss: 1.6824, instance_loss: 0.5553, weighted_loss: 1.3442, label: 3, bag_size: 849
batch 239, loss: 1.8356, instance_loss: 0.5173, weighted_loss: 1.4401, label: 1, bag_size: 700
batch 259, loss: 1.4760, instance_loss: 0.4987, weighted_loss: 1.1828, label: 4, bag_size: 1278
batch 279, loss: 1.0311, instance_loss: 0.4493, weighted_loss: 0.8565, label: 2, bag_size: 1155
batch 299, loss: 1.3056, instance_loss: 0.4870, weighted_loss: 1.0600, label: 0, bag_size: 718
batch 319, loss: 1.1979, instance_loss: 0.4796, weighted_loss: 0.9824, label: 0, bag_size: 1086
batch 339, loss: 1.8472, instance_loss: 0.5023, weighted_loss: 1.4437, label: 2, bag_size: 943
batch 359, loss: 0.9681, instance_loss: 0.4407, weighted_loss: 0.8099, label: 0, bag_size: 350
batch 379, loss: 1.4183, instance_loss: 0.4904, weighted_loss: 1.1399, label: 2, bag_size: 347
batch 399, loss: 2.3663, instance_loss: 0.5501, weighted_loss: 1.8214, label: 1, bag_size: 660
batch 419, loss: 1.6772, instance_loss: 0.4917, weighted_loss: 1.3215, label: 2, bag_size: 732


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.3255, train_clustering_loss:  0.4792, train_error: 0.4776
class 0: acc 0.6263736263736264, correct 57/91
class 1: acc 0.6875, correct 66/96
class 2: acc 0.3764705882352941, correct 32/85
class 3: acc 0.23529411764705882, correct 16/68
class 4: acc 0.6, correct 51/85

Val Set, val_loss: 1.3749, val_error: 0.5800, auc: 0.7708
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.625, correct 10/16
class 2: acc 0.2, correct 3/15
class 3: acc 0.4, correct 2/5
class 4: acc 0.2, correct 1/5
Validation loss decreased (1.537698 --> 1.374925).  Saving model ...


batch 19, loss: 1.6651, instance_loss: 0.5152, weighted_loss: 1.3201, label: 0, bag_size: 282
batch 39, loss: 1.2321, instance_loss: 0.4959, weighted_loss: 1.0112, label: 2, bag_size: 655
batch 59, loss: 1.4385, instance_loss: 0.5234, weighted_loss: 1.1640, label: 0, bag_size: 1190
batch 79, loss: 1.3734, instance_loss: 0.4320, weighted_loss: 1.0910, label: 3, bag_size: 316
batch 99, loss: 1.2639, instance_loss: 0.4761, weighted_loss: 1.0275, label: 4, bag_size: 1235
batch 119, loss: 1.1941, instance_loss: 0.4909, weighted_loss: 0.9832, label: 0, bag_size: 1174
batch 139, loss: 0.6429, instance_loss: 0.4158, weighted_loss: 0.5748, label: 0, bag_size: 476
batch 159, loss: 1.0511, instance_loss: 0.4220, weighted_loss: 0.8623, label: 3, bag_size: 729
batch 179, loss: 0.4280, instance_loss: 0.3351, weighted_loss: 0.4001, label: 4, bag_size: 711
batch 199, loss: 0.5824, instance_loss: 0.3750, weighted_loss: 0.5201, label: 1, bag_size: 1376
batch 219, loss: 1.5158, instance_loss: 0.5290, weighted_loss: 1.2198, label: 2, bag_size: 2703
batch 239, loss: 2.1630, instance_loss: 0.5990, weighted_loss: 1.6938, label: 4, bag_size: 1331
batch 259, loss: 0.8466, instance_loss: 0.3950, weighted_loss: 0.7111, label: 1, bag_size: 746
batch 279, loss: 1.2677, instance_loss: 0.4414, weighted_loss: 1.0198, label: 0, bag_size: 381
batch 299, loss: 1.3481, instance_loss: 0.5033, weighted_loss: 1.0947, label: 2, bag_size: 1439
batch 319, loss: 0.8325, instance_loss: 0.4289, weighted_loss: 0.7114, label: 0, bag_size: 756
batch 339, loss: 2.1687, instance_loss: 0.4954, weighted_loss: 1.6667, label: 3, bag_size: 533
batch 359, loss: 1.2067, instance_loss: 0.5134, weighted_loss: 0.9987, label: 4, bag_size: 729
batch 379, loss: 1.1302, instance_loss: 0.4695, weighted_loss: 0.9320, label: 4, bag_size: 436
batch 399, loss: 0.8609, instance_loss: 0.3992, weighted_loss: 0.7224, label: 0, bag_size: 367
batch 419, loss: 0.4395, instance_loss: 0.2911, weighted_loss: 0.3950, label: 3, bag_size: 305


class 0 clustering acc 0.9996470588235294: correct 16994/17000
class 1 clustering acc 0.0002941176470588235: correct 1/3400
Epoch: 3, train_loss: 1.1312, train_clustering_loss:  0.4477, train_error: 0.3906
class 0: acc 0.7931034482758621, correct 69/87
class 1: acc 0.5833333333333334, correct 49/84
class 2: acc 0.34523809523809523, correct 29/84
class 3: acc 0.7070707070707071, correct 70/99
class 4: acc 0.5915492957746479, correct 42/71

Val Set, val_loss: 1.1903, val_error: 0.4400, auc: 0.8708
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.0, correct 0/5
Validation loss decreased (1.374925 --> 1.190347).  Saving model ...


batch 19, loss: 1.4805, instance_loss: 0.5029, weighted_loss: 1.1872, label: 1, bag_size: 700
batch 39, loss: 0.5922, instance_loss: 0.3037, weighted_loss: 0.5056, label: 1, bag_size: 1191
batch 59, loss: 1.5668, instance_loss: 0.4788, weighted_loss: 1.2404, label: 2, bag_size: 732
batch 79, loss: 0.7275, instance_loss: 0.4093, weighted_loss: 0.6320, label: 4, bag_size: 590
batch 99, loss: 0.9123, instance_loss: 0.4643, weighted_loss: 0.7779, label: 0, bag_size: 1255
batch 119, loss: 0.6225, instance_loss: 0.3131, weighted_loss: 0.5297, label: 3, bag_size: 729
batch 139, loss: 0.2990, instance_loss: 0.2977, weighted_loss: 0.2986, label: 0, bag_size: 375
batch 159, loss: 0.5090, instance_loss: 0.3946, weighted_loss: 0.4747, label: 4, bag_size: 817
batch 179, loss: 0.3641, instance_loss: 0.3042, weighted_loss: 0.3462, label: 0, bag_size: 1247
batch 199, loss: 1.9017, instance_loss: 0.5654, weighted_loss: 1.5008, label: 3, bag_size: 607
batch 219, loss: 1.9725, instance_loss: 0.6153, weighted_loss: 1.5654, label: 0, bag_size: 1196
batch 239, loss: 0.4106, instance_loss: 0.3092, weighted_loss: 0.3802, label: 3, bag_size: 1250
batch 259, loss: 0.3452, instance_loss: 0.3176, weighted_loss: 0.3370, label: 0, bag_size: 367
batch 279, loss: 2.4939, instance_loss: 0.8154, weighted_loss: 1.9904, label: 2, bag_size: 1108
batch 299, loss: 2.4623, instance_loss: 0.5713, weighted_loss: 1.8950, label: 3, bag_size: 305
batch 319, loss: 0.3042, instance_loss: 0.2876, weighted_loss: 0.2993, label: 1, bag_size: 828
batch 339, loss: 2.0321, instance_loss: 0.5474, weighted_loss: 1.5866, label: 2, bag_size: 1119
batch 359, loss: 0.8921, instance_loss: 0.4793, weighted_loss: 0.7682, label: 4, bag_size: 656
batch 379, loss: 0.1955, instance_loss: 0.1903, weighted_loss: 0.1940, label: 3, bag_size: 1559
batch 399, loss: 2.1514, instance_loss: 0.7229, weighted_loss: 1.7228, label: 3, bag_size: 1167
batch 419, loss: 0.1566, instance_loss: 0.2523, weighted_loss: 0.1853, label: 0, bag_size: 385


class 0 clustering acc 0.999: correct 16983/17000
class 1 clustering acc 0.02411764705882353: correct 82/3400
Epoch: 4, train_loss: 0.9967, train_clustering_loss:  0.4249, train_error: 0.3482
class 0: acc 0.7916666666666666, correct 76/96
class 1: acc 0.5443037974683544, correct 43/79
class 2: acc 0.5348837209302325, correct 46/86
class 3: acc 0.6309523809523809, correct 53/84
class 4: acc 0.7375, correct 59/80

Val Set, val_loss: 1.1071, val_error: 0.4400, auc: 0.8667
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.005: correct 2/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.4666666666666667, correct 7/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.190347 --> 1.107095).  Saving model ...


batch 19, loss: 0.3795, instance_loss: 0.3465, weighted_loss: 0.3696, label: 4, bag_size: 675
batch 39, loss: 0.7661, instance_loss: 0.3999, weighted_loss: 0.6563, label: 4, bag_size: 542
batch 59, loss: 0.2651, instance_loss: 0.2711, weighted_loss: 0.2669, label: 1, bag_size: 697
batch 79, loss: 1.5984, instance_loss: 0.5352, weighted_loss: 1.2794, label: 2, bag_size: 511
batch 99, loss: 0.4589, instance_loss: 0.3139, weighted_loss: 0.4154, label: 1, bag_size: 504
batch 119, loss: 0.5359, instance_loss: 0.3332, weighted_loss: 0.4751, label: 3, bag_size: 821
batch 139, loss: 3.6091, instance_loss: 0.6426, weighted_loss: 2.7191, label: 0, bag_size: 818
batch 159, loss: 1.3881, instance_loss: 0.4410, weighted_loss: 1.1040, label: 3, bag_size: 533
batch 179, loss: 0.8106, instance_loss: 0.4357, weighted_loss: 0.6982, label: 0, bag_size: 729
batch 199, loss: 0.8697, instance_loss: 0.3901, weighted_loss: 0.7258, label: 1, bag_size: 242
batch 219, loss: 0.5462, instance_loss: 0.5124, weighted_loss: 0.5360, label: 0, bag_size: 729
batch 239, loss: 0.3348, instance_loss: 0.1919, weighted_loss: 0.2919, label: 3, bag_size: 729
batch 259, loss: 3.1814, instance_loss: 0.5981, weighted_loss: 2.4064, label: 4, bag_size: 436
batch 279, loss: 1.2976, instance_loss: 0.4834, weighted_loss: 1.0533, label: 2, bag_size: 272
batch 299, loss: 0.1992, instance_loss: 0.1405, weighted_loss: 0.1816, label: 3, bag_size: 729
batch 319, loss: 0.0145, instance_loss: 0.1460, weighted_loss: 0.0540, label: 4, bag_size: 729
batch 339, loss: 0.5658, instance_loss: 0.3914, weighted_loss: 0.5134, label: 4, bag_size: 773
batch 359, loss: 1.1317, instance_loss: 0.4318, weighted_loss: 0.9217, label: 1, bag_size: 778
batch 379, loss: 1.7499, instance_loss: 0.5325, weighted_loss: 1.3847, label: 1, bag_size: 435
batch 399, loss: 0.2721, instance_loss: 0.2204, weighted_loss: 0.2566, label: 3, bag_size: 729
batch 419, loss: 0.2126, instance_loss: 0.2684, weighted_loss: 0.2294, label: 4, bag_size: 790


class 0 clustering acc 0.9982352941176471: correct 16970/17000
class 1 clustering acc 0.09: correct 306/3400
Epoch: 5, train_loss: 0.9296, train_clustering_loss:  0.4063, train_error: 0.3012
class 0: acc 0.85, correct 68/80
class 1: acc 0.7346938775510204, correct 72/98
class 2: acc 0.46835443037974683, correct 37/79
class 3: acc 0.6265060240963856, correct 52/83
class 4: acc 0.8, correct 68/85

Val Set, val_loss: 1.1114, val_error: 0.5200, auc: 0.8794
class 0 clustering acc 0.998: correct 1996/2000
class 1 clustering acc 0.1025: correct 41/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.2, correct 3/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2047, instance_loss: 0.3015, weighted_loss: 0.2338, label: 3, bag_size: 451
batch 39, loss: 0.4096, instance_loss: 0.3141, weighted_loss: 0.3809, label: 0, bag_size: 367
batch 59, loss: 0.1953, instance_loss: 0.1692, weighted_loss: 0.1874, label: 3, bag_size: 729
batch 79, loss: 0.2228, instance_loss: 0.2430, weighted_loss: 0.2288, label: 0, bag_size: 1517
batch 99, loss: 0.8231, instance_loss: 0.4652, weighted_loss: 0.7157, label: 2, bag_size: 461
batch 119, loss: 2.6011, instance_loss: 0.7401, weighted_loss: 2.0428, label: 2, bag_size: 1677
batch 139, loss: 2.6905, instance_loss: 0.7199, weighted_loss: 2.0993, label: 3, bag_size: 281
batch 159, loss: 0.7024, instance_loss: 0.4663, weighted_loss: 0.6316, label: 2, bag_size: 638
batch 179, loss: 0.3195, instance_loss: 0.3310, weighted_loss: 0.3230, label: 3, bag_size: 1250
batch 199, loss: 0.2844, instance_loss: 0.1706, weighted_loss: 0.2503, label: 4, bag_size: 729
batch 219, loss: 2.0684, instance_loss: 0.5623, weighted_loss: 1.6166, label: 0, bag_size: 282
batch 239, loss: 0.2364, instance_loss: 0.4693, weighted_loss: 0.3063, label: 0, bag_size: 729
batch 259, loss: 1.0374, instance_loss: 0.3874, weighted_loss: 0.8424, label: 3, bag_size: 343
batch 279, loss: 0.0923, instance_loss: 0.1713, weighted_loss: 0.1160, label: 4, bag_size: 711
batch 299, loss: 0.6348, instance_loss: 0.3134, weighted_loss: 0.5384, label: 1, bag_size: 847
batch 319, loss: 0.1675, instance_loss: 0.2482, weighted_loss: 0.1917, label: 3, bag_size: 936
batch 339, loss: 0.2869, instance_loss: 0.2471, weighted_loss: 0.2749, label: 4, bag_size: 729
batch 359, loss: 0.9697, instance_loss: 0.4724, weighted_loss: 0.8205, label: 0, bag_size: 545
batch 379, loss: 0.3987, instance_loss: 0.3452, weighted_loss: 0.3826, label: 2, bag_size: 638
batch 399, loss: 0.4738, instance_loss: 0.3510, weighted_loss: 0.4370, label: 2, bag_size: 399
batch 419, loss: 0.2531, instance_loss: 0.2154, weighted_loss: 0.2418, label: 3, bag_size: 729


class 0 clustering acc 0.9961176470588236: correct 16934/17000
class 1 clustering acc 0.17294117647058824: correct 588/3400
Epoch: 6, train_loss: 0.8045, train_clustering_loss:  0.3786, train_error: 0.2988
class 0: acc 0.8395061728395061, correct 68/81
class 1: acc 0.6756756756756757, correct 50/74
class 2: acc 0.5, correct 42/84
class 3: acc 0.7058823529411765, correct 72/102
class 4: acc 0.7857142857142857, correct 66/84

Val Set, val_loss: 1.0873, val_error: 0.4200, auc: 0.8852
class 0 clustering acc 0.9965: correct 1993/2000
class 1 clustering acc 0.125: correct 50/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.107095 --> 1.087270).  Saving model ...


batch 19, loss: 0.1071, instance_loss: 0.2013, weighted_loss: 0.1354, label: 3, bag_size: 952
batch 39, loss: 0.2152, instance_loss: 0.1641, weighted_loss: 0.1999, label: 3, bag_size: 729
batch 59, loss: 1.7914, instance_loss: 0.5493, weighted_loss: 1.4188, label: 1, bag_size: 535
batch 79, loss: 0.4818, instance_loss: 0.3369, weighted_loss: 0.4383, label: 0, bag_size: 756
batch 99, loss: 1.1750, instance_loss: 0.4954, weighted_loss: 0.9711, label: 3, bag_size: 360
batch 119, loss: 0.1823, instance_loss: 0.2044, weighted_loss: 0.1889, label: 0, bag_size: 338
batch 139, loss: 0.2055, instance_loss: 0.1469, weighted_loss: 0.1879, label: 3, bag_size: 729
batch 159, loss: 1.5052, instance_loss: 0.5589, weighted_loss: 1.2213, label: 2, bag_size: 110
batch 179, loss: 0.0435, instance_loss: 0.3722, weighted_loss: 0.1421, label: 4, bag_size: 974
batch 199, loss: 0.6172, instance_loss: 0.4301, weighted_loss: 0.5610, label: 2, bag_size: 868
batch 219, loss: 1.9108, instance_loss: 0.5220, weighted_loss: 1.4942, label: 3, bag_size: 706
batch 239, loss: 0.6829, instance_loss: 0.4151, weighted_loss: 0.6025, label: 2, bag_size: 571
batch 259, loss: 1.3311, instance_loss: 0.4347, weighted_loss: 1.0622, label: 4, bag_size: 823
batch 279, loss: 2.1724, instance_loss: 0.5498, weighted_loss: 1.6856, label: 1, bag_size: 1724
batch 299, loss: 0.6987, instance_loss: 0.4564, weighted_loss: 0.6260, label: 0, bag_size: 1190
batch 319, loss: 0.3512, instance_loss: 0.3697, weighted_loss: 0.3568, label: 4, bag_size: 826
batch 339, loss: 1.6101, instance_loss: 0.4807, weighted_loss: 1.2713, label: 1, bag_size: 1273
batch 359, loss: 1.0895, instance_loss: 0.6768, weighted_loss: 0.9657, label: 1, bag_size: 1390
batch 379, loss: 0.3143, instance_loss: 0.3637, weighted_loss: 0.3291, label: 2, bag_size: 638
batch 399, loss: 0.1754, instance_loss: 0.1894, weighted_loss: 0.1796, label: 3, bag_size: 1019
batch 419, loss: 0.3579, instance_loss: 0.2328, weighted_loss: 0.3203, label: 3, bag_size: 316


class 0 clustering acc 0.9958235294117647: correct 16929/17000
class 1 clustering acc 0.23323529411764707: correct 793/3400
Epoch: 7, train_loss: 0.7308, train_clustering_loss:  0.3697, train_error: 0.2588
class 0: acc 0.9111111111111111, correct 82/90
class 1: acc 0.6216216216216216, correct 46/74
class 2: acc 0.5384615384615384, correct 49/91
class 3: acc 0.8048780487804879, correct 66/82
class 4: acc 0.8181818181818182, correct 72/88

Val Set, val_loss: 1.0067, val_error: 0.4600, auc: 0.8854
class 0 clustering acc 0.995: correct 1990/2000
class 1 clustering acc 0.14: correct 56/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.4, correct 6/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.087270 --> 1.006744).  Saving model ...


batch 19, loss: 0.6192, instance_loss: 0.4357, weighted_loss: 0.5641, label: 1, bag_size: 102
batch 39, loss: 0.0966, instance_loss: 0.2781, weighted_loss: 0.1511, label: 3, bag_size: 936
batch 59, loss: 0.3167, instance_loss: 0.2779, weighted_loss: 0.3050, label: 0, bag_size: 1190
batch 79, loss: 0.1130, instance_loss: 0.1323, weighted_loss: 0.1188, label: 0, bag_size: 446
batch 99, loss: 0.1446, instance_loss: 0.1118, weighted_loss: 0.1348, label: 3, bag_size: 729
batch 119, loss: 0.1424, instance_loss: 0.1845, weighted_loss: 0.1550, label: 0, bag_size: 1174
batch 139, loss: 1.4548, instance_loss: 0.5646, weighted_loss: 1.1877, label: 0, bag_size: 245
batch 159, loss: 1.4421, instance_loss: 0.5467, weighted_loss: 1.1735, label: 1, bag_size: 448
batch 179, loss: 1.4664, instance_loss: 0.4769, weighted_loss: 1.1695, label: 4, bag_size: 436
batch 199, loss: 0.1923, instance_loss: 0.2525, weighted_loss: 0.2104, label: 1, bag_size: 890
batch 219, loss: 1.7569, instance_loss: 0.5554, weighted_loss: 1.3965, label: 2, bag_size: 629
batch 239, loss: 0.7132, instance_loss: 0.2532, weighted_loss: 0.5752, label: 3, bag_size: 849
batch 259, loss: 0.1879, instance_loss: 0.3800, weighted_loss: 0.2456, label: 4, bag_size: 729
batch 279, loss: 2.0896, instance_loss: 0.4745, weighted_loss: 1.6051, label: 0, bag_size: 1257
batch 299, loss: 0.4926, instance_loss: 0.4490, weighted_loss: 0.4795, label: 4, bag_size: 928
batch 319, loss: 0.5922, instance_loss: 0.3471, weighted_loss: 0.5186, label: 1, bag_size: 242
batch 339, loss: 1.9225, instance_loss: 0.6037, weighted_loss: 1.5269, label: 3, bag_size: 706
batch 359, loss: 0.0850, instance_loss: 0.2955, weighted_loss: 0.1482, label: 4, bag_size: 823
batch 379, loss: 1.2871, instance_loss: 0.4684, weighted_loss: 1.0415, label: 2, bag_size: 748
batch 399, loss: 0.2222, instance_loss: 0.3260, weighted_loss: 0.2534, label: 2, bag_size: 977
batch 419, loss: 1.0993, instance_loss: 0.4137, weighted_loss: 0.8936, label: 1, bag_size: 530


class 0 clustering acc 0.993764705882353: correct 16894/17000
class 1 clustering acc 0.27294117647058824: correct 928/3400
Epoch: 8, train_loss: 0.7289, train_clustering_loss:  0.3665, train_error: 0.2706
class 0: acc 0.8762886597938144, correct 85/97
class 1: acc 0.6266666666666667, correct 47/75
class 2: acc 0.5, correct 39/78
class 3: acc 0.7738095238095238, correct 65/84
class 4: acc 0.8131868131868132, correct 74/91

Val Set, val_loss: 1.0502, val_error: 0.4200, auc: 0.8795
class 0 clustering acc 0.9905: correct 1981/2000
class 1 clustering acc 0.17: correct 68/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7425, instance_loss: 0.3856, weighted_loss: 0.6355, label: 4, bag_size: 354
batch 39, loss: 0.0623, instance_loss: 0.1370, weighted_loss: 0.0847, label: 0, bag_size: 385
batch 59, loss: 0.2748, instance_loss: 0.4620, weighted_loss: 0.3310, label: 3, bag_size: 230
batch 79, loss: 0.1756, instance_loss: 0.1335, weighted_loss: 0.1629, label: 1, bag_size: 696
batch 99, loss: 0.2964, instance_loss: 0.4717, weighted_loss: 0.3490, label: 4, bag_size: 675
batch 119, loss: 1.7467, instance_loss: 0.7293, weighted_loss: 1.4415, label: 2, bag_size: 916
batch 139, loss: 0.0859, instance_loss: 0.1201, weighted_loss: 0.0961, label: 0, bag_size: 1012
batch 159, loss: 1.7988, instance_loss: 0.5392, weighted_loss: 1.4209, label: 3, bag_size: 305
batch 179, loss: 0.0282, instance_loss: 0.2448, weighted_loss: 0.0932, label: 4, bag_size: 711
batch 199, loss: 0.1898, instance_loss: 0.1853, weighted_loss: 0.1885, label: 4, bag_size: 1121
batch 219, loss: 0.0145, instance_loss: 0.1101, weighted_loss: 0.0432, label: 4, bag_size: 729
batch 239, loss: 0.1192, instance_loss: 0.2833, weighted_loss: 0.1684, label: 4, bag_size: 1278
batch 259, loss: 0.4637, instance_loss: 0.3126, weighted_loss: 0.4184, label: 1, bag_size: 754
batch 279, loss: 0.8224, instance_loss: 0.2999, weighted_loss: 0.6656, label: 1, bag_size: 1402
batch 299, loss: 0.0250, instance_loss: 0.1158, weighted_loss: 0.0523, label: 4, bag_size: 729
batch 319, loss: 0.7594, instance_loss: 0.3960, weighted_loss: 0.6504, label: 2, bag_size: 237
batch 339, loss: 0.3049, instance_loss: 0.2523, weighted_loss: 0.2891, label: 1, bag_size: 696
batch 359, loss: 0.5889, instance_loss: 0.3317, weighted_loss: 0.5117, label: 0, bag_size: 545
batch 379, loss: 0.3802, instance_loss: 0.2539, weighted_loss: 0.3423, label: 0, bag_size: 371
batch 399, loss: 0.0486, instance_loss: 0.0767, weighted_loss: 0.0570, label: 3, bag_size: 729
batch 419, loss: 0.1047, instance_loss: 0.6143, weighted_loss: 0.2576, label: 4, bag_size: 542


class 0 clustering acc 0.9923529411764705: correct 16870/17000
class 1 clustering acc 0.2797058823529412: correct 951/3400
Epoch: 9, train_loss: 0.6977, train_clustering_loss:  0.3608, train_error: 0.2635
class 0: acc 0.8589743589743589, correct 67/78
class 1: acc 0.7128712871287128, correct 72/101
class 2: acc 0.5308641975308642, correct 43/81
class 3: acc 0.76, correct 57/75
class 4: acc 0.8222222222222222, correct 74/90

Val Set, val_loss: 1.0784, val_error: 0.4600, auc: 0.8606
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.4666666666666667, correct 7/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1159, instance_loss: 0.5622, weighted_loss: 0.9498, label: 1, bag_size: 786
batch 39, loss: 1.2978, instance_loss: 0.4936, weighted_loss: 1.0565, label: 3, bag_size: 281
batch 59, loss: 0.4838, instance_loss: 0.3594, weighted_loss: 0.4465, label: 3, bag_size: 1380
batch 79, loss: 0.0147, instance_loss: 0.0855, weighted_loss: 0.0360, label: 4, bag_size: 729
batch 99, loss: 0.1505, instance_loss: 0.2005, weighted_loss: 0.1655, label: 0, bag_size: 729
batch 119, loss: 0.0985, instance_loss: 0.1336, weighted_loss: 0.1091, label: 1, bag_size: 847
batch 139, loss: 0.1743, instance_loss: 0.2588, weighted_loss: 0.1997, label: 1, bag_size: 913
batch 159, loss: 0.9543, instance_loss: 0.6343, weighted_loss: 0.8583, label: 1, bag_size: 1172
batch 179, loss: 0.0732, instance_loss: 0.0756, weighted_loss: 0.0739, label: 1, bag_size: 286
batch 199, loss: 0.2959, instance_loss: 0.3669, weighted_loss: 0.3172, label: 4, bag_size: 663
batch 219, loss: 3.2664, instance_loss: 0.8441, weighted_loss: 2.5397, label: 3, bag_size: 281
batch 239, loss: 1.0203, instance_loss: 0.4304, weighted_loss: 0.8434, label: 1, bag_size: 818
batch 259, loss: 0.3351, instance_loss: 0.3479, weighted_loss: 0.3389, label: 2, bag_size: 2703
batch 279, loss: 0.1730, instance_loss: 0.1360, weighted_loss: 0.1619, label: 3, bag_size: 729
batch 299, loss: 1.4789, instance_loss: 0.5504, weighted_loss: 1.2003, label: 2, bag_size: 248
batch 319, loss: 0.4559, instance_loss: 0.2557, weighted_loss: 0.3959, label: 0, bag_size: 602
batch 339, loss: 0.6625, instance_loss: 0.4390, weighted_loss: 0.5955, label: 2, bag_size: 1385
batch 359, loss: 0.2958, instance_loss: 0.3682, weighted_loss: 0.3175, label: 2, bag_size: 758
batch 379, loss: 0.6048, instance_loss: 0.3770, weighted_loss: 0.5365, label: 4, bag_size: 663
batch 399, loss: 0.6643, instance_loss: 0.5398, weighted_loss: 0.6269, label: 2, bag_size: 518
batch 419, loss: 1.5683, instance_loss: 0.6046, weighted_loss: 1.2792, label: 2, bag_size: 1119


class 0 clustering acc 0.9918235294117647: correct 16861/17000
class 1 clustering acc 0.30323529411764705: correct 1031/3400
Epoch: 10, train_loss: 0.6530, train_clustering_loss:  0.3490, train_error: 0.2165
class 0: acc 0.9195402298850575, correct 80/87
class 1: acc 0.7789473684210526, correct 74/95
class 2: acc 0.6373626373626373, correct 58/91
class 3: acc 0.7564102564102564, correct 59/78
class 4: acc 0.8378378378378378, correct 62/74

Val Set, val_loss: 1.0847, val_error: 0.4400, auc: 0.8598
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.1825: correct 73/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0892, instance_loss: 0.2508, weighted_loss: 0.1377, label: 4, bag_size: 524
batch 39, loss: 0.8103, instance_loss: 0.3123, weighted_loss: 0.6609, label: 4, bag_size: 764
batch 59, loss: 0.4198, instance_loss: 0.2686, weighted_loss: 0.3745, label: 3, bag_size: 821
batch 79, loss: 2.2200, instance_loss: 0.6184, weighted_loss: 1.7395, label: 2, bag_size: 1167
batch 99, loss: 0.1046, instance_loss: 0.1471, weighted_loss: 0.1173, label: 4, bag_size: 646
batch 119, loss: 0.1615, instance_loss: 0.2555, weighted_loss: 0.1897, label: 2, bag_size: 1019
batch 139, loss: 0.3440, instance_loss: 0.3206, weighted_loss: 0.3370, label: 3, bag_size: 849
batch 159, loss: 2.4945, instance_loss: 0.7612, weighted_loss: 1.9745, label: 3, bag_size: 281
batch 179, loss: 0.6955, instance_loss: 0.4466, weighted_loss: 0.6208, label: 2, bag_size: 806
batch 199, loss: 0.3263, instance_loss: 0.2900, weighted_loss: 0.3154, label: 3, bag_size: 697
batch 219, loss: 0.7419, instance_loss: 0.3893, weighted_loss: 0.6361, label: 1, bag_size: 530
batch 239, loss: 0.2372, instance_loss: 0.2147, weighted_loss: 0.2304, label: 0, bag_size: 962
batch 259, loss: 0.1170, instance_loss: 0.1963, weighted_loss: 0.1408, label: 0, bag_size: 1133
batch 279, loss: 0.0608, instance_loss: 0.0742, weighted_loss: 0.0648, label: 0, bag_size: 602
batch 299, loss: 0.0475, instance_loss: 0.1304, weighted_loss: 0.0724, label: 0, bag_size: 933
batch 319, loss: 0.0187, instance_loss: 0.1344, weighted_loss: 0.0534, label: 4, bag_size: 729
batch 339, loss: 0.0543, instance_loss: 0.3407, weighted_loss: 0.1402, label: 4, bag_size: 754
batch 359, loss: 0.2139, instance_loss: 0.2163, weighted_loss: 0.2146, label: 1, bag_size: 1376
batch 379, loss: 2.7372, instance_loss: 0.7543, weighted_loss: 2.1423, label: 1, bag_size: 386
batch 399, loss: 0.1290, instance_loss: 0.2013, weighted_loss: 0.1507, label: 0, bag_size: 1579
batch 419, loss: 0.0748, instance_loss: 0.1007, weighted_loss: 0.0826, label: 0, bag_size: 375


class 0 clustering acc 0.9921176470588235: correct 16866/17000
class 1 clustering acc 0.355: correct 1207/3400
Epoch: 11, train_loss: 0.5857, train_clustering_loss:  0.3313, train_error: 0.2141
class 0: acc 0.91, correct 91/100
class 1: acc 0.6436781609195402, correct 56/87
class 2: acc 0.68, correct 51/75
class 3: acc 0.8048780487804879, correct 66/82
class 4: acc 0.8641975308641975, correct 70/81

Val Set, val_loss: 1.0799, val_error: 0.4600, auc: 0.8612
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.4666666666666667, correct 7/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2240, instance_loss: 0.2522, weighted_loss: 0.2325, label: 0, bag_size: 1190
batch 39, loss: 0.2302, instance_loss: 0.3709, weighted_loss: 0.2724, label: 4, bag_size: 675
batch 59, loss: 1.9047, instance_loss: 0.6623, weighted_loss: 1.5320, label: 2, bag_size: 120
batch 79, loss: 1.3830, instance_loss: 0.6159, weighted_loss: 1.1529, label: 4, bag_size: 366
batch 99, loss: 0.1080, instance_loss: 0.2370, weighted_loss: 0.1467, label: 3, bag_size: 821
batch 119, loss: 0.0465, instance_loss: 0.2090, weighted_loss: 0.0953, label: 3, bag_size: 936
batch 139, loss: 0.9333, instance_loss: 0.4284, weighted_loss: 0.7818, label: 2, bag_size: 237
batch 159, loss: 0.4582, instance_loss: 0.1641, weighted_loss: 0.3699, label: 3, bag_size: 729
batch 179, loss: 0.7433, instance_loss: 0.4218, weighted_loss: 0.6468, label: 2, bag_size: 1133
batch 199, loss: 0.6020, instance_loss: 0.2980, weighted_loss: 0.5108, label: 4, bag_size: 297
batch 219, loss: 0.2942, instance_loss: 0.1847, weighted_loss: 0.2614, label: 0, bag_size: 736
batch 239, loss: 1.4614, instance_loss: 0.4929, weighted_loss: 1.1709, label: 2, bag_size: 1259
batch 259, loss: 2.4397, instance_loss: 0.6936, weighted_loss: 1.9159, label: 3, bag_size: 211
batch 279, loss: 1.1695, instance_loss: 0.5203, weighted_loss: 0.9747, label: 4, bag_size: 590
batch 299, loss: 0.7041, instance_loss: 0.2824, weighted_loss: 0.5776, label: 1, bag_size: 898
batch 319, loss: 0.0288, instance_loss: 0.1594, weighted_loss: 0.0680, label: 4, bag_size: 711
batch 339, loss: 0.1847, instance_loss: 0.2275, weighted_loss: 0.1975, label: 0, bag_size: 729
batch 359, loss: 0.9187, instance_loss: 0.5961, weighted_loss: 0.8219, label: 3, bag_size: 360
batch 379, loss: 0.2542, instance_loss: 0.3066, weighted_loss: 0.2699, label: 1, bag_size: 533
batch 399, loss: 0.4128, instance_loss: 0.4792, weighted_loss: 0.4327, label: 3, bag_size: 360
batch 419, loss: 0.5330, instance_loss: 0.4579, weighted_loss: 0.5105, label: 2, bag_size: 1058


class 0 clustering acc 0.9909411764705882: correct 16846/17000
class 1 clustering acc 0.3376470588235294: correct 1148/3400
Epoch: 12, train_loss: 0.5803, train_clustering_loss:  0.3434, train_error: 0.2212
class 0: acc 0.9294117647058824, correct 79/85
class 1: acc 0.7238095238095238, correct 76/105
class 2: acc 0.5365853658536586, correct 44/82
class 3: acc 0.8266666666666667, correct 62/75
class 4: acc 0.8974358974358975, correct 70/78

Val Set, val_loss: 1.0630, val_error: 0.4200, auc: 0.8631
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2664, instance_loss: 0.1428, weighted_loss: 0.2293, label: 3, bag_size: 729
batch 39, loss: 1.1604, instance_loss: 0.4773, weighted_loss: 0.9555, label: 1, bag_size: 861
batch 59, loss: 0.6311, instance_loss: 0.3623, weighted_loss: 0.5504, label: 2, bag_size: 357
batch 79, loss: 0.0174, instance_loss: 0.1418, weighted_loss: 0.0547, label: 4, bag_size: 729
batch 99, loss: 0.1352, instance_loss: 0.1181, weighted_loss: 0.1301, label: 3, bag_size: 729
batch 119, loss: 0.1300, instance_loss: 0.2346, weighted_loss: 0.1614, label: 4, bag_size: 675
batch 139, loss: 0.0958, instance_loss: 0.0909, weighted_loss: 0.0943, label: 0, bag_size: 200
batch 159, loss: 0.3883, instance_loss: 0.3164, weighted_loss: 0.3667, label: 3, bag_size: 697
batch 179, loss: 0.0223, instance_loss: 0.0832, weighted_loss: 0.0406, label: 4, bag_size: 646
batch 199, loss: 0.4299, instance_loss: 0.4567, weighted_loss: 0.4380, label: 4, bag_size: 663
batch 219, loss: 0.5993, instance_loss: 0.3590, weighted_loss: 0.5272, label: 0, bag_size: 1190
batch 239, loss: 0.1238, instance_loss: 0.3539, weighted_loss: 0.1928, label: 0, bag_size: 729
batch 259, loss: 0.1754, instance_loss: 0.1963, weighted_loss: 0.1816, label: 1, bag_size: 1261
batch 279, loss: 0.0764, instance_loss: 0.0652, weighted_loss: 0.0730, label: 3, bag_size: 729
batch 299, loss: 0.5341, instance_loss: 0.3630, weighted_loss: 0.4828, label: 2, bag_size: 262
batch 319, loss: 0.1078, instance_loss: 0.2807, weighted_loss: 0.1597, label: 4, bag_size: 675
batch 339, loss: 0.4630, instance_loss: 0.3464, weighted_loss: 0.4280, label: 2, bag_size: 589
batch 359, loss: 0.0268, instance_loss: 0.0882, weighted_loss: 0.0452, label: 3, bag_size: 952
batch 379, loss: 0.0075, instance_loss: 0.1190, weighted_loss: 0.0410, label: 4, bag_size: 1235
batch 399, loss: 0.4564, instance_loss: 0.3962, weighted_loss: 0.4383, label: 2, bag_size: 1533
batch 419, loss: 4.7609, instance_loss: 1.0656, weighted_loss: 3.6523, label: 1, bag_size: 867


class 0 clustering acc 0.9912941176470588: correct 16852/17000
class 1 clustering acc 0.395: correct 1343/3400
Epoch: 13, train_loss: 0.5556, train_clustering_loss:  0.3217, train_error: 0.2118
class 0: acc 0.875, correct 84/96
class 1: acc 0.7441860465116279, correct 64/86
class 2: acc 0.5875, correct 47/80
class 3: acc 0.8205128205128205, correct 64/78
class 4: acc 0.8941176470588236, correct 76/85

Val Set, val_loss: 1.0828, val_error: 0.4400, auc: 0.8637
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.9900, instance_loss: 0.4732, weighted_loss: 0.8350, label: 3, bag_size: 305
batch 39, loss: 0.0587, instance_loss: 0.0955, weighted_loss: 0.0697, label: 3, bag_size: 1069
batch 59, loss: 0.1070, instance_loss: 0.2173, weighted_loss: 0.1401, label: 4, bag_size: 790
batch 79, loss: 0.2087, instance_loss: 0.5636, weighted_loss: 0.3152, label: 2, bag_size: 373
batch 99, loss: 0.9009, instance_loss: 0.4082, weighted_loss: 0.7531, label: 0, bag_size: 1190
batch 119, loss: 0.0074, instance_loss: 0.1040, weighted_loss: 0.0364, label: 4, bag_size: 729
batch 139, loss: 0.0097, instance_loss: 0.1947, weighted_loss: 0.0652, label: 4, bag_size: 729
batch 159, loss: 0.1169, instance_loss: 0.3763, weighted_loss: 0.1947, label: 3, bag_size: 230
batch 179, loss: 0.0467, instance_loss: 0.3076, weighted_loss: 0.1250, label: 4, bag_size: 754
batch 199, loss: 2.1657, instance_loss: 0.6893, weighted_loss: 1.7228, label: 3, bag_size: 281
batch 219, loss: 0.1603, instance_loss: 0.4213, weighted_loss: 0.2386, label: 4, bag_size: 542
batch 239, loss: 0.1373, instance_loss: 0.2516, weighted_loss: 0.1716, label: 2, bag_size: 1289
batch 259, loss: 0.0453, instance_loss: 0.1976, weighted_loss: 0.0910, label: 4, bag_size: 1002
batch 279, loss: 0.5882, instance_loss: 0.4104, weighted_loss: 0.5348, label: 3, bag_size: 360
batch 299, loss: 0.0972, instance_loss: 0.1738, weighted_loss: 0.1202, label: 0, bag_size: 729
batch 319, loss: 0.0609, instance_loss: 0.1410, weighted_loss: 0.0849, label: 3, bag_size: 729
batch 339, loss: 0.7207, instance_loss: 0.4278, weighted_loss: 0.6329, label: 2, bag_size: 1150
batch 359, loss: 0.3187, instance_loss: 0.2925, weighted_loss: 0.3109, label: 2, bag_size: 395
batch 379, loss: 0.9047, instance_loss: 0.5235, weighted_loss: 0.7903, label: 2, bag_size: 682
batch 399, loss: 0.0514, instance_loss: 0.1070, weighted_loss: 0.0681, label: 3, bag_size: 1172
batch 419, loss: 0.1106, instance_loss: 0.1625, weighted_loss: 0.1262, label: 3, bag_size: 729


class 0 clustering acc 0.9902352941176471: correct 16834/17000
class 1 clustering acc 0.33: correct 1122/3400
Epoch: 14, train_loss: 0.5506, train_clustering_loss:  0.3429, train_error: 0.2024
class 0: acc 0.8974358974358975, correct 70/78
class 1: acc 0.686046511627907, correct 59/86
class 2: acc 0.6842105263157895, correct 65/95
class 3: acc 0.8076923076923077, correct 63/78
class 4: acc 0.9318181818181818, correct 82/88

Val Set, val_loss: 1.1415, val_error: 0.4400, auc: 0.8537
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.25: correct 100/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0394, instance_loss: 0.1289, weighted_loss: 0.0662, label: 0, bag_size: 1466
batch 39, loss: 0.0648, instance_loss: 0.1690, weighted_loss: 0.0960, label: 4, bag_size: 790
batch 59, loss: 0.1946, instance_loss: 0.1847, weighted_loss: 0.1916, label: 0, bag_size: 340
batch 79, loss: 0.1012, instance_loss: 0.2207, weighted_loss: 0.1371, label: 3, bag_size: 1118
batch 99, loss: 0.1427, instance_loss: 0.0750, weighted_loss: 0.1224, label: 3, bag_size: 316
batch 119, loss: 1.0114, instance_loss: 0.4480, weighted_loss: 0.8424, label: 1, bag_size: 1273
batch 139, loss: 0.4241, instance_loss: 0.2963, weighted_loss: 0.3857, label: 1, bag_size: 897
batch 159, loss: 0.3282, instance_loss: 0.2700, weighted_loss: 0.3108, label: 0, bag_size: 1332
batch 179, loss: 0.1268, instance_loss: 0.1690, weighted_loss: 0.1394, label: 3, bag_size: 316
batch 199, loss: 0.1742, instance_loss: 0.2236, weighted_loss: 0.1891, label: 0, bag_size: 545
batch 219, loss: 0.4574, instance_loss: 0.3973, weighted_loss: 0.4394, label: 1, bag_size: 925
batch 239, loss: 0.6714, instance_loss: 0.4058, weighted_loss: 0.5917, label: 3, bag_size: 1250
batch 259, loss: 0.1229, instance_loss: 0.3935, weighted_loss: 0.2041, label: 4, bag_size: 663
batch 279, loss: 0.0315, instance_loss: 0.0617, weighted_loss: 0.0406, label: 0, bag_size: 616
batch 299, loss: 0.3300, instance_loss: 0.4142, weighted_loss: 0.3552, label: 3, bag_size: 671
batch 319, loss: 0.0002, instance_loss: 0.0498, weighted_loss: 0.0151, label: 4, bag_size: 729
batch 339, loss: 1.2370, instance_loss: 0.5210, weighted_loss: 1.0222, label: 2, bag_size: 1617
batch 359, loss: 0.0187, instance_loss: 0.1186, weighted_loss: 0.0487, label: 4, bag_size: 636
batch 379, loss: 0.0134, instance_loss: 0.0902, weighted_loss: 0.0365, label: 3, bag_size: 729
batch 399, loss: 0.0374, instance_loss: 0.0385, weighted_loss: 0.0377, label: 3, bag_size: 305
batch 419, loss: 0.0211, instance_loss: 0.1825, weighted_loss: 0.0695, label: 4, bag_size: 823


class 0 clustering acc 0.9915882352941177: correct 16857/17000
class 1 clustering acc 0.4067647058823529: correct 1383/3400
Epoch: 15, train_loss: 0.4994, train_clustering_loss:  0.3140, train_error: 0.1953
class 0: acc 0.9302325581395349, correct 80/86
class 1: acc 0.6444444444444445, correct 58/90
class 2: acc 0.5522388059701493, correct 37/67
class 3: acc 0.9069767441860465, correct 78/86
class 4: acc 0.9270833333333334, correct 89/96

Val Set, val_loss: 1.1334, val_error: 0.4600, auc: 0.8537
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3035, instance_loss: 0.3323, weighted_loss: 0.3122, label: 2, bag_size: 910
batch 39, loss: 0.1728, instance_loss: 0.1605, weighted_loss: 0.1691, label: 1, bag_size: 1239
batch 59, loss: 0.0084, instance_loss: 0.0504, weighted_loss: 0.0210, label: 4, bag_size: 711
batch 79, loss: 0.0006, instance_loss: 0.0586, weighted_loss: 0.0180, label: 4, bag_size: 729
batch 99, loss: 0.0970, instance_loss: 0.0952, weighted_loss: 0.0965, label: 0, bag_size: 515
batch 119, loss: 2.6293, instance_loss: 0.7020, weighted_loss: 2.0511, label: 2, bag_size: 474
batch 139, loss: 0.0315, instance_loss: 0.0535, weighted_loss: 0.0381, label: 0, bag_size: 602
batch 159, loss: 0.0851, instance_loss: 0.1965, weighted_loss: 0.1185, label: 1, bag_size: 890
batch 179, loss: 0.2966, instance_loss: 0.2420, weighted_loss: 0.2802, label: 1, bag_size: 944
batch 199, loss: 0.7221, instance_loss: 0.4953, weighted_loss: 0.6541, label: 2, bag_size: 707
batch 219, loss: 0.1038, instance_loss: 0.0909, weighted_loss: 0.0999, label: 3, bag_size: 729
batch 239, loss: 0.0030, instance_loss: 0.0977, weighted_loss: 0.0314, label: 4, bag_size: 729
batch 259, loss: 1.4522, instance_loss: 0.6401, weighted_loss: 1.2086, label: 1, bag_size: 448
batch 279, loss: 0.0659, instance_loss: 0.2763, weighted_loss: 0.1290, label: 0, bag_size: 371
batch 299, loss: 0.8528, instance_loss: 0.5200, weighted_loss: 0.7530, label: 1, bag_size: 535
batch 319, loss: 0.2017, instance_loss: 0.3534, weighted_loss: 0.2472, label: 4, bag_size: 826
batch 339, loss: 2.2580, instance_loss: 0.8201, weighted_loss: 1.8266, label: 2, bag_size: 967
batch 359, loss: 0.1461, instance_loss: 0.1976, weighted_loss: 0.1615, label: 0, bag_size: 476
batch 379, loss: 2.6453, instance_loss: 0.7968, weighted_loss: 2.0907, label: 2, bag_size: 1043
batch 399, loss: 0.5742, instance_loss: 0.5160, weighted_loss: 0.5568, label: 2, bag_size: 1235
batch 419, loss: 0.1295, instance_loss: 0.0738, weighted_loss: 0.1128, label: 3, bag_size: 729


class 0 clustering acc 0.9903529411764705: correct 16836/17000
class 1 clustering acc 0.40558823529411764: correct 1379/3400
Epoch: 16, train_loss: 0.4570, train_clustering_loss:  0.3159, train_error: 0.1765
class 0: acc 0.967032967032967, correct 88/91
class 1: acc 0.7263157894736842, correct 69/95
class 2: acc 0.6629213483146067, correct 59/89
class 3: acc 0.8641975308641975, correct 70/81
class 4: acc 0.927536231884058, correct 64/69

Val Set, val_loss: 1.1849, val_error: 0.4400, auc: 0.8517
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 9 out of 20


batch 19, loss: 2.7473, instance_loss: 0.6614, weighted_loss: 2.1215, label: 1, bag_size: 651
batch 39, loss: 0.0246, instance_loss: 0.1868, weighted_loss: 0.0732, label: 3, bag_size: 936
batch 59, loss: 0.2971, instance_loss: 0.3131, weighted_loss: 0.3019, label: 3, bag_size: 1118
batch 79, loss: 0.1966, instance_loss: 0.1664, weighted_loss: 0.1875, label: 0, bag_size: 1247
batch 99, loss: 0.4684, instance_loss: 0.4592, weighted_loss: 0.4657, label: 1, bag_size: 897
batch 119, loss: 0.1147, instance_loss: 0.1838, weighted_loss: 0.1354, label: 1, bag_size: 994
batch 139, loss: 1.0368, instance_loss: 0.7602, weighted_loss: 0.9538, label: 4, bag_size: 511
batch 159, loss: 0.0612, instance_loss: 0.2870, weighted_loss: 0.1290, label: 4, bag_size: 729
batch 179, loss: 0.3694, instance_loss: 0.1990, weighted_loss: 0.3182, label: 0, bag_size: 545
batch 199, loss: 0.1594, instance_loss: 0.1617, weighted_loss: 0.1601, label: 0, bag_size: 962
batch 219, loss: 0.1907, instance_loss: 0.6639, weighted_loss: 0.3327, label: 4, bag_size: 542
batch 239, loss: 0.1748, instance_loss: 0.3442, weighted_loss: 0.2256, label: 2, bag_size: 204
batch 259, loss: 0.4247, instance_loss: 0.2170, weighted_loss: 0.3624, label: 1, bag_size: 858
batch 279, loss: 0.0423, instance_loss: 0.4402, weighted_loss: 0.1616, label: 4, bag_size: 663
batch 299, loss: 0.2135, instance_loss: 0.4614, weighted_loss: 0.2879, label: 1, bag_size: 648
batch 319, loss: 0.1435, instance_loss: 0.1920, weighted_loss: 0.1581, label: 1, bag_size: 944
batch 339, loss: 0.0944, instance_loss: 0.3502, weighted_loss: 0.1712, label: 0, bag_size: 729
batch 359, loss: 0.0875, instance_loss: 0.1255, weighted_loss: 0.0989, label: 0, bag_size: 718
batch 379, loss: 0.0319, instance_loss: 0.1153, weighted_loss: 0.0569, label: 0, bag_size: 476
batch 399, loss: 0.5113, instance_loss: 0.1997, weighted_loss: 0.4178, label: 3, bag_size: 1118
batch 419, loss: 0.0544, instance_loss: 0.1152, weighted_loss: 0.0726, label: 3, bag_size: 1019


class 0 clustering acc 0.9900588235294118: correct 16831/17000
class 1 clustering acc 0.38: correct 1292/3400
Epoch: 17, train_loss: 0.4513, train_clustering_loss:  0.3237, train_error: 0.1412
class 0: acc 0.8918918918918919, correct 66/74
class 1: acc 0.7764705882352941, correct 66/85
class 2: acc 0.7553191489361702, correct 71/94
class 3: acc 0.9166666666666666, correct 88/96
class 4: acc 0.9736842105263158, correct 74/76

Val Set, val_loss: 1.2839, val_error: 0.4000, auc: 0.8440
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.2275: correct 91/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0064, instance_loss: 0.1020, weighted_loss: 0.0350, label: 3, bag_size: 729
batch 39, loss: 0.0121, instance_loss: 0.2469, weighted_loss: 0.0825, label: 4, bag_size: 711
batch 59, loss: 0.8079, instance_loss: 0.5188, weighted_loss: 0.7212, label: 2, bag_size: 409
batch 79, loss: 0.0946, instance_loss: 0.2065, weighted_loss: 0.1281, label: 1, bag_size: 828
batch 99, loss: 0.5596, instance_loss: 0.3578, weighted_loss: 0.4991, label: 4, bag_size: 590
batch 119, loss: 0.0936, instance_loss: 0.0884, weighted_loss: 0.0921, label: 3, bag_size: 729
batch 139, loss: 0.5271, instance_loss: 0.7943, weighted_loss: 0.6073, label: 1, bag_size: 867
batch 159, loss: 0.0091, instance_loss: 0.0308, weighted_loss: 0.0156, label: 0, bag_size: 521
batch 179, loss: 1.1767, instance_loss: 0.6246, weighted_loss: 1.0111, label: 2, bag_size: 1197
batch 199, loss: 0.6207, instance_loss: 0.5376, weighted_loss: 0.5958, label: 2, bag_size: 967
batch 219, loss: 0.0466, instance_loss: 0.1406, weighted_loss: 0.0748, label: 4, bag_size: 1002
batch 239, loss: 0.0817, instance_loss: 0.1244, weighted_loss: 0.0945, label: 4, bag_size: 729
batch 259, loss: 0.1823, instance_loss: 0.3342, weighted_loss: 0.2279, label: 2, bag_size: 1218
batch 279, loss: 0.1155, instance_loss: 0.1407, weighted_loss: 0.1230, label: 4, bag_size: 1002
batch 299, loss: 0.0262, instance_loss: 0.0527, weighted_loss: 0.0342, label: 0, bag_size: 1034
batch 319, loss: 0.4449, instance_loss: 0.3771, weighted_loss: 0.4246, label: 2, bag_size: 883
batch 339, loss: 0.2950, instance_loss: 0.3794, weighted_loss: 0.3203, label: 2, bag_size: 471
batch 359, loss: 0.1194, instance_loss: 0.2012, weighted_loss: 0.1440, label: 1, bag_size: 828
batch 379, loss: 0.2652, instance_loss: 0.2618, weighted_loss: 0.2642, label: 1, bag_size: 696
batch 399, loss: 0.0314, instance_loss: 0.1319, weighted_loss: 0.0615, label: 4, bag_size: 773
batch 419, loss: 0.1213, instance_loss: 0.1519, weighted_loss: 0.1305, label: 0, bag_size: 718


class 0 clustering acc 0.9884705882352941: correct 16804/17000
class 1 clustering acc 0.42558823529411766: correct 1447/3400
Epoch: 18, train_loss: 0.3972, train_clustering_loss:  0.3080, train_error: 0.1482
class 0: acc 0.8588235294117647, correct 73/85
class 1: acc 0.7361111111111112, correct 53/72
class 2: acc 0.7, correct 56/80
class 3: acc 0.9148936170212766, correct 86/94
class 4: acc 1.0, correct 94/94

Val Set, val_loss: 1.1886, val_error: 0.4600, auc: 0.8490
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.2925: correct 117/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.4, correct 6/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1632, instance_loss: 0.2017, weighted_loss: 0.1747, label: 1, bag_size: 945
batch 39, loss: 0.5791, instance_loss: 0.4868, weighted_loss: 0.5514, label: 1, bag_size: 1724
batch 59, loss: 0.1247, instance_loss: 0.2438, weighted_loss: 0.1605, label: 2, bag_size: 684
batch 79, loss: 0.3729, instance_loss: 0.6515, weighted_loss: 0.4565, label: 1, bag_size: 1390
batch 99, loss: 0.0558, instance_loss: 0.3045, weighted_loss: 0.1304, label: 4, bag_size: 675
batch 119, loss: 2.3264, instance_loss: 0.8091, weighted_loss: 1.8712, label: 1, bag_size: 867
batch 139, loss: 0.6213, instance_loss: 0.4674, weighted_loss: 0.5751, label: 2, bag_size: 1259
batch 159, loss: 0.1781, instance_loss: 0.2974, weighted_loss: 0.2139, label: 0, bag_size: 1247
batch 179, loss: 0.3693, instance_loss: 0.6057, weighted_loss: 0.4402, label: 2, bag_size: 518
batch 199, loss: 1.4439, instance_loss: 0.4860, weighted_loss: 1.1565, label: 3, bag_size: 305
batch 219, loss: 0.8715, instance_loss: 0.4301, weighted_loss: 0.7391, label: 4, bag_size: 1337
batch 239, loss: 0.0156, instance_loss: 0.0817, weighted_loss: 0.0354, label: 1, bag_size: 847
batch 259, loss: 0.2032, instance_loss: 0.2677, weighted_loss: 0.2225, label: 2, bag_size: 323
batch 279, loss: 0.0982, instance_loss: 0.2244, weighted_loss: 0.1360, label: 0, bag_size: 800
batch 299, loss: 0.1900, instance_loss: 0.3236, weighted_loss: 0.2301, label: 2, bag_size: 357
batch 319, loss: 0.0033, instance_loss: 0.1889, weighted_loss: 0.0589, label: 4, bag_size: 711
batch 339, loss: 0.6421, instance_loss: 0.5043, weighted_loss: 0.6008, label: 3, bag_size: 1250
batch 359, loss: 0.6757, instance_loss: 0.2859, weighted_loss: 0.5588, label: 2, bag_size: 1448
batch 379, loss: 0.2550, instance_loss: 0.4380, weighted_loss: 0.3099, label: 2, bag_size: 948
batch 399, loss: 0.1339, instance_loss: 0.1766, weighted_loss: 0.1467, label: 1, bag_size: 697
batch 419, loss: 1.6492, instance_loss: 0.6671, weighted_loss: 1.3545, label: 3, bag_size: 281


class 0 clustering acc 0.9888823529411764: correct 16811/17000
class 1 clustering acc 0.38: correct 1292/3400
Epoch: 19, train_loss: 0.3879, train_clustering_loss:  0.3258, train_error: 0.1271
class 0: acc 0.9431818181818182, correct 83/88
class 1: acc 0.75, correct 63/84
class 2: acc 0.7888888888888889, correct 71/90
class 3: acc 0.9333333333333333, correct 70/75
class 4: acc 0.9545454545454546, correct 84/88

Val Set, val_loss: 1.1889, val_error: 0.4200, auc: 0.8440
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0401, instance_loss: 0.1124, weighted_loss: 0.0618, label: 0, bag_size: 729
batch 39, loss: 0.0607, instance_loss: 0.1059, weighted_loss: 0.0743, label: 0, bag_size: 371
batch 59, loss: 0.0520, instance_loss: 0.1129, weighted_loss: 0.0703, label: 3, bag_size: 729
batch 79, loss: 0.8352, instance_loss: 0.3642, weighted_loss: 0.6939, label: 3, bag_size: 305
batch 99, loss: 0.0472, instance_loss: 0.1386, weighted_loss: 0.0746, label: 3, bag_size: 1399
batch 119, loss: 1.0166, instance_loss: 0.5738, weighted_loss: 0.8838, label: 2, bag_size: 1119
batch 139, loss: 0.3261, instance_loss: 0.4890, weighted_loss: 0.3750, label: 2, bag_size: 878
batch 159, loss: 0.4660, instance_loss: 0.4464, weighted_loss: 0.4601, label: 2, bag_size: 1133
batch 179, loss: 1.1952, instance_loss: 0.6409, weighted_loss: 1.0289, label: 1, bag_size: 1724
batch 199, loss: 0.4573, instance_loss: 0.6265, weighted_loss: 0.5081, label: 3, bag_size: 533
batch 219, loss: 0.2854, instance_loss: 0.5038, weighted_loss: 0.3509, label: 1, bag_size: 442
batch 239, loss: 0.0422, instance_loss: 0.0643, weighted_loss: 0.0489, label: 3, bag_size: 1069
batch 259, loss: 0.0136, instance_loss: 0.0893, weighted_loss: 0.0363, label: 0, bag_size: 653
batch 279, loss: 1.1519, instance_loss: 0.6624, weighted_loss: 1.0051, label: 1, bag_size: 936
batch 299, loss: 1.3507, instance_loss: 0.6296, weighted_loss: 1.1344, label: 1, bag_size: 448
batch 319, loss: 0.2428, instance_loss: 0.4309, weighted_loss: 0.2992, label: 2, bag_size: 355
batch 339, loss: 0.5379, instance_loss: 0.5161, weighted_loss: 0.5314, label: 4, bag_size: 1337
batch 359, loss: 0.1286, instance_loss: 0.1419, weighted_loss: 0.1326, label: 4, bag_size: 790
batch 379, loss: 0.0171, instance_loss: 0.0971, weighted_loss: 0.0411, label: 4, bag_size: 646
batch 399, loss: 0.8250, instance_loss: 0.5196, weighted_loss: 0.7334, label: 4, bag_size: 436
batch 419, loss: 0.0197, instance_loss: 0.1007, weighted_loss: 0.0440, label: 0, bag_size: 1143


class 0 clustering acc 0.9900588235294118: correct 16831/17000
class 1 clustering acc 0.43941176470588234: correct 1494/3400
Epoch: 20, train_loss: 0.3458, train_clustering_loss:  0.3073, train_error: 0.1106
class 0: acc 0.9591836734693877, correct 94/98
class 1: acc 0.7605633802816901, correct 54/71
class 2: acc 0.788235294117647, correct 67/85
class 3: acc 0.9367088607594937, correct 74/79
class 4: acc 0.967391304347826, correct 89/92

Val Set, val_loss: 1.2062, val_error: 0.4200, auc: 0.8500
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.2475: correct 99/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3043, instance_loss: 0.3067, weighted_loss: 0.3051, label: 0, bag_size: 432
batch 39, loss: 0.0015, instance_loss: 0.2535, weighted_loss: 0.0771, label: 4, bag_size: 729
batch 59, loss: 0.0503, instance_loss: 0.2795, weighted_loss: 0.1190, label: 1, bag_size: 614
batch 79, loss: 0.0030, instance_loss: 0.0610, weighted_loss: 0.0204, label: 1, bag_size: 1376
batch 99, loss: 0.4105, instance_loss: 0.2057, weighted_loss: 0.3491, label: 1, bag_size: 858
batch 119, loss: 0.7272, instance_loss: 0.4348, weighted_loss: 0.6395, label: 1, bag_size: 1559
batch 139, loss: 0.0231, instance_loss: 0.3491, weighted_loss: 0.1209, label: 3, bag_size: 821
batch 159, loss: 0.1289, instance_loss: 0.4155, weighted_loss: 0.2149, label: 4, bag_size: 675
batch 179, loss: 0.1697, instance_loss: 0.2199, weighted_loss: 0.1848, label: 0, bag_size: 1065
batch 199, loss: 0.4062, instance_loss: 0.3999, weighted_loss: 0.4043, label: 1, bag_size: 1096
batch 219, loss: 0.1615, instance_loss: 0.4427, weighted_loss: 0.2459, label: 4, bag_size: 928
batch 239, loss: 0.0007, instance_loss: 0.1013, weighted_loss: 0.0309, label: 4, bag_size: 729
batch 259, loss: 1.0350, instance_loss: 0.4945, weighted_loss: 0.8729, label: 0, bag_size: 1289
batch 279, loss: 0.0117, instance_loss: 0.0905, weighted_loss: 0.0354, label: 0, bag_size: 1466
batch 299, loss: 0.2302, instance_loss: 0.4127, weighted_loss: 0.2850, label: 3, bag_size: 360
batch 319, loss: 0.1784, instance_loss: 0.3601, weighted_loss: 0.2329, label: 2, bag_size: 400
batch 339, loss: 0.4770, instance_loss: 0.4217, weighted_loss: 0.4604, label: 2, bag_size: 1385
batch 359, loss: 0.0002, instance_loss: 0.1468, weighted_loss: 0.0442, label: 4, bag_size: 729
batch 379, loss: 0.1781, instance_loss: 0.4004, weighted_loss: 0.2448, label: 0, bag_size: 371
batch 399, loss: 0.6633, instance_loss: 0.4629, weighted_loss: 0.6032, label: 3, bag_size: 1250
batch 419, loss: 0.0317, instance_loss: 0.4543, weighted_loss: 0.1585, label: 4, bag_size: 817


class 0 clustering acc 0.9906470588235294: correct 16841/17000
class 1 clustering acc 0.43529411764705883: correct 1480/3400
Epoch: 21, train_loss: 0.3198, train_clustering_loss:  0.3035, train_error: 0.1176
class 0: acc 0.9310344827586207, correct 81/87
class 1: acc 0.8210526315789474, correct 78/95
class 2: acc 0.696969696969697, correct 46/66
class 3: acc 0.967032967032967, correct 88/91
class 4: acc 0.9534883720930233, correct 82/86

Val Set, val_loss: 1.1986, val_error: 0.4400, auc: 0.8559
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.4, correct 6/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3814, instance_loss: 0.4804, weighted_loss: 0.4111, label: 1, bag_size: 1096
batch 39, loss: 0.0049, instance_loss: 0.1782, weighted_loss: 0.0569, label: 3, bag_size: 729
batch 59, loss: 1.9026, instance_loss: 0.6162, weighted_loss: 1.5167, label: 1, bag_size: 1376
batch 79, loss: 0.0245, instance_loss: 0.1736, weighted_loss: 0.0692, label: 0, bag_size: 515
batch 99, loss: 0.0578, instance_loss: 0.1294, weighted_loss: 0.0793, label: 3, bag_size: 451
batch 119, loss: 0.0474, instance_loss: 0.1794, weighted_loss: 0.0870, label: 3, bag_size: 729
batch 139, loss: 0.3103, instance_loss: 0.5471, weighted_loss: 0.3813, label: 4, bag_size: 366
batch 159, loss: 0.0076, instance_loss: 0.0796, weighted_loss: 0.0292, label: 3, bag_size: 729
batch 179, loss: 0.0578, instance_loss: 0.1432, weighted_loss: 0.0834, label: 1, bag_size: 1239
batch 199, loss: 0.0022, instance_loss: 0.0551, weighted_loss: 0.0181, label: 4, bag_size: 729
batch 219, loss: 0.0713, instance_loss: 0.2721, weighted_loss: 0.1315, label: 0, bag_size: 1101
batch 239, loss: 0.0260, instance_loss: 0.0388, weighted_loss: 0.0299, label: 3, bag_size: 316
batch 259, loss: 0.2769, instance_loss: 0.2448, weighted_loss: 0.2673, label: 4, bag_size: 790
batch 279, loss: 0.0104, instance_loss: 0.0326, weighted_loss: 0.0171, label: 0, bag_size: 1086
batch 299, loss: 0.0198, instance_loss: 0.2067, weighted_loss: 0.0759, label: 1, bag_size: 890
batch 319, loss: 0.4122, instance_loss: 0.4527, weighted_loss: 0.4244, label: 1, bag_size: 1724
batch 339, loss: 0.0816, instance_loss: 0.4337, weighted_loss: 0.1872, label: 2, bag_size: 419
batch 359, loss: 0.0432, instance_loss: 0.2582, weighted_loss: 0.1077, label: 0, bag_size: 545
batch 379, loss: 0.0536, instance_loss: 0.1839, weighted_loss: 0.0927, label: 1, bag_size: 1261
batch 399, loss: 0.5078, instance_loss: 0.5366, weighted_loss: 0.5164, label: 1, bag_size: 442
batch 419, loss: 0.0716, instance_loss: 0.0921, weighted_loss: 0.0778, label: 1, bag_size: 286


class 0 clustering acc 0.9888235294117647: correct 16810/17000
class 1 clustering acc 0.44382352941176473: correct 1509/3400
Epoch: 22, train_loss: 0.3048, train_clustering_loss:  0.2984, train_error: 0.0941
class 0: acc 0.9876543209876543, correct 80/81
class 1: acc 0.8375, correct 67/80
class 2: acc 0.7764705882352941, correct 66/85
class 3: acc 0.9574468085106383, correct 90/94
class 4: acc 0.9647058823529412, correct 82/85

Val Set, val_loss: 1.2287, val_error: 0.3800, auc: 0.8604
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.3175: correct 127/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.8, correct 12/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0643, instance_loss: 0.2572, weighted_loss: 0.1222, label: 1, bag_size: 965
batch 39, loss: 0.4657, instance_loss: 0.8052, weighted_loss: 0.5676, label: 0, bag_size: 282
batch 59, loss: 0.2435, instance_loss: 0.1141, weighted_loss: 0.2047, label: 3, bag_size: 1177
batch 79, loss: 0.7471, instance_loss: 0.5022, weighted_loss: 0.6736, label: 1, bag_size: 1724
batch 99, loss: 0.0193, instance_loss: 0.0763, weighted_loss: 0.0364, label: 3, bag_size: 729
batch 119, loss: 0.1615, instance_loss: 0.2757, weighted_loss: 0.1957, label: 2, bag_size: 461
batch 139, loss: 0.1843, instance_loss: 0.2178, weighted_loss: 0.1944, label: 1, bag_size: 945
batch 159, loss: 0.1158, instance_loss: 0.2158, weighted_loss: 0.1458, label: 1, bag_size: 690
batch 179, loss: 0.8410, instance_loss: 0.6120, weighted_loss: 0.7723, label: 3, bag_size: 281
batch 199, loss: 0.2151, instance_loss: 0.4205, weighted_loss: 0.2767, label: 2, bag_size: 1155
batch 219, loss: 0.0020, instance_loss: 0.2767, weighted_loss: 0.0844, label: 4, bag_size: 974
batch 239, loss: 3.4115, instance_loss: 0.6708, weighted_loss: 2.5893, label: 1, bag_size: 446
batch 259, loss: 0.0865, instance_loss: 0.2283, weighted_loss: 0.1290, label: 1, bag_size: 1402
batch 279, loss: 0.4146, instance_loss: 0.5605, weighted_loss: 0.4584, label: 2, bag_size: 1167
batch 299, loss: 0.6865, instance_loss: 0.8429, weighted_loss: 0.7334, label: 1, bag_size: 700
batch 319, loss: 1.4591, instance_loss: 0.5749, weighted_loss: 1.1938, label: 1, bag_size: 377
batch 339, loss: 0.8174, instance_loss: 0.4454, weighted_loss: 0.7058, label: 2, bag_size: 934
batch 359, loss: 0.0385, instance_loss: 0.1555, weighted_loss: 0.0736, label: 3, bag_size: 729
batch 379, loss: 0.6796, instance_loss: 0.3873, weighted_loss: 0.5919, label: 1, bag_size: 1273
batch 399, loss: 1.0557, instance_loss: 0.3517, weighted_loss: 0.8445, label: 4, bag_size: 729
batch 419, loss: 0.1469, instance_loss: 0.3643, weighted_loss: 0.2121, label: 4, bag_size: 436


class 0 clustering acc 0.9881764705882353: correct 16799/17000
class 1 clustering acc 0.4294117647058823: correct 1460/3400
Epoch: 23, train_loss: 0.3903, train_clustering_loss:  0.3130, train_error: 0.1271
class 0: acc 0.9436619718309859, correct 67/71
class 1: acc 0.7692307692307693, correct 70/91
class 2: acc 0.7578947368421053, correct 72/95
class 3: acc 0.9438202247191011, correct 84/89
class 4: acc 0.9873417721518988, correct 78/79

Val Set, val_loss: 1.3567, val_error: 0.4800, auc: 0.8432
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.335: correct 134/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.4, correct 6/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.0024, instance_loss: 0.7529, weighted_loss: 0.9276, label: 3, bag_size: 607
batch 39, loss: 0.3124, instance_loss: 0.3331, weighted_loss: 0.3186, label: 1, bag_size: 598
batch 59, loss: 0.0126, instance_loss: 0.0876, weighted_loss: 0.0351, label: 3, bag_size: 1069
batch 79, loss: 0.0586, instance_loss: 0.0846, weighted_loss: 0.0664, label: 1, bag_size: 1191
batch 99, loss: 0.1868, instance_loss: 0.1641, weighted_loss: 0.1800, label: 1, bag_size: 1325
batch 119, loss: 0.3701, instance_loss: 0.3758, weighted_loss: 0.3718, label: 2, bag_size: 252
batch 139, loss: 0.3502, instance_loss: 0.3764, weighted_loss: 0.3581, label: 2, bag_size: 351
batch 159, loss: 0.2477, instance_loss: 0.2901, weighted_loss: 0.2604, label: 4, bag_size: 590
batch 179, loss: 0.8786, instance_loss: 0.3387, weighted_loss: 0.7166, label: 2, bag_size: 482
batch 199, loss: 0.4612, instance_loss: 0.3113, weighted_loss: 0.4162, label: 1, bag_size: 944
batch 219, loss: 0.0060, instance_loss: 0.1198, weighted_loss: 0.0401, label: 4, bag_size: 729
batch 239, loss: 0.6042, instance_loss: 0.6958, weighted_loss: 0.6317, label: 3, bag_size: 211
batch 259, loss: 0.0077, instance_loss: 0.0325, weighted_loss: 0.0152, label: 0, bag_size: 982
batch 279, loss: 1.1766, instance_loss: 0.5839, weighted_loss: 0.9988, label: 2, bag_size: 272
batch 299, loss: 0.0329, instance_loss: 0.0793, weighted_loss: 0.0468, label: 1, bag_size: 938
batch 319, loss: 0.1576, instance_loss: 0.0920, weighted_loss: 0.1379, label: 3, bag_size: 1559
batch 339, loss: 0.0002, instance_loss: 0.0608, weighted_loss: 0.0184, label: 4, bag_size: 729
batch 359, loss: 0.0274, instance_loss: 0.0901, weighted_loss: 0.0462, label: 0, bag_size: 729
batch 379, loss: 0.0083, instance_loss: 0.0364, weighted_loss: 0.0167, label: 0, bag_size: 1466
batch 399, loss: 0.8955, instance_loss: 0.5105, weighted_loss: 0.7800, label: 1, bag_size: 487
batch 419, loss: 0.3151, instance_loss: 0.4371, weighted_loss: 0.3517, label: 2, bag_size: 357


class 0 clustering acc 0.9869411764705882: correct 16778/17000
class 1 clustering acc 0.4423529411764706: correct 1504/3400
Epoch: 24, train_loss: 0.3645, train_clustering_loss:  0.3139, train_error: 0.1318
class 0: acc 0.9382716049382716, correct 76/81
class 1: acc 0.7647058823529411, correct 65/85
class 2: acc 0.7108433734939759, correct 59/83
class 3: acc 0.9418604651162791, correct 81/86
class 4: acc 0.9777777777777777, correct 88/90

Val Set, val_loss: 1.1695, val_error: 0.4200, auc: 0.8608
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.3025: correct 121/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.2807, instance_loss: 0.3900, weighted_loss: 0.3135, label: 2, bag_size: 357
batch 39, loss: 0.0103, instance_loss: 0.2506, weighted_loss: 0.0824, label: 3, bag_size: 821
batch 59, loss: 0.0026, instance_loss: 0.2559, weighted_loss: 0.0786, label: 1, bag_size: 1127
batch 79, loss: 1.0651, instance_loss: 0.7363, weighted_loss: 0.9664, label: 2, bag_size: 916
batch 99, loss: 0.0050, instance_loss: 0.0385, weighted_loss: 0.0150, label: 0, bag_size: 518
batch 119, loss: 0.0091, instance_loss: 0.2730, weighted_loss: 0.0883, label: 4, bag_size: 656
batch 139, loss: 0.5402, instance_loss: 0.3205, weighted_loss: 0.4743, label: 2, bag_size: 202
batch 159, loss: 0.0805, instance_loss: 0.1300, weighted_loss: 0.0954, label: 1, bag_size: 369
batch 179, loss: 0.1901, instance_loss: 0.3493, weighted_loss: 0.2379, label: 1, bag_size: 1651
batch 199, loss: 0.2370, instance_loss: 0.0868, weighted_loss: 0.1919, label: 3, bag_size: 1559
batch 219, loss: 0.0562, instance_loss: 0.2553, weighted_loss: 0.1159, label: 2, bag_size: 330
batch 239, loss: 0.0987, instance_loss: 0.1688, weighted_loss: 0.1197, label: 1, bag_size: 346
batch 259, loss: 0.0005, instance_loss: 0.1651, weighted_loss: 0.0499, label: 4, bag_size: 388
batch 279, loss: 0.0019, instance_loss: 0.2163, weighted_loss: 0.0662, label: 4, bag_size: 754
batch 299, loss: 0.0125, instance_loss: 0.0804, weighted_loss: 0.0329, label: 3, bag_size: 729
batch 319, loss: 0.0141, instance_loss: 0.0883, weighted_loss: 0.0364, label: 0, bag_size: 729
batch 339, loss: 0.0400, instance_loss: 0.9167, weighted_loss: 0.3030, label: 4, bag_size: 542
batch 359, loss: 0.0088, instance_loss: 0.0421, weighted_loss: 0.0187, label: 0, bag_size: 921
batch 379, loss: 0.0129, instance_loss: 0.0532, weighted_loss: 0.0250, label: 3, bag_size: 729
batch 399, loss: 0.1265, instance_loss: 0.2435, weighted_loss: 0.1616, label: 2, bag_size: 317
batch 419, loss: 0.0179, instance_loss: 0.1329, weighted_loss: 0.0524, label: 0, bag_size: 255


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.4376470588235294: correct 1488/3400
Epoch: 25, train_loss: 0.2943, train_clustering_loss:  0.3040, train_error: 0.0894
class 0: acc 0.96875, correct 93/96
class 1: acc 0.7948717948717948, correct 62/78
class 2: acc 0.8333333333333334, correct 70/84
class 3: acc 0.9431818181818182, correct 83/88
class 4: acc 1.0, correct 79/79

Val Set, val_loss: 1.2743, val_error: 0.4000, auc: 0.8527
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1218, instance_loss: 0.1008, weighted_loss: 0.1155, label: 1, bag_size: 369
batch 39, loss: 0.0038, instance_loss: 0.5694, weighted_loss: 0.1735, label: 4, bag_size: 711
batch 59, loss: 0.0332, instance_loss: 0.1149, weighted_loss: 0.0577, label: 0, bag_size: 472
batch 79, loss: 0.4585, instance_loss: 0.6727, weighted_loss: 0.5228, label: 2, bag_size: 518
batch 99, loss: 0.1795, instance_loss: 0.3656, weighted_loss: 0.2353, label: 1, bag_size: 1152
batch 119, loss: 0.0147, instance_loss: 0.1877, weighted_loss: 0.0666, label: 0, bag_size: 976
batch 139, loss: 0.0539, instance_loss: 0.1231, weighted_loss: 0.0747, label: 0, bag_size: 1255
batch 159, loss: 0.0897, instance_loss: 0.1834, weighted_loss: 0.1178, label: 2, bag_size: 323
batch 179, loss: 0.1380, instance_loss: 0.3723, weighted_loss: 0.2083, label: 4, bag_size: 928
batch 199, loss: 3.0268, instance_loss: 0.7254, weighted_loss: 2.3364, label: 2, bag_size: 758
batch 219, loss: 0.0111, instance_loss: 0.0627, weighted_loss: 0.0266, label: 0, bag_size: 729
batch 239, loss: 0.0009, instance_loss: 0.0775, weighted_loss: 0.0239, label: 3, bag_size: 1069
batch 259, loss: 0.0335, instance_loss: 0.4277, weighted_loss: 0.1517, label: 3, bag_size: 230
batch 279, loss: 3.9799, instance_loss: 0.8218, weighted_loss: 3.0324, label: 2, bag_size: 319
batch 299, loss: 0.0362, instance_loss: 0.3011, weighted_loss: 0.1156, label: 2, bag_size: 567
batch 319, loss: 0.0716, instance_loss: 0.8022, weighted_loss: 0.2907, label: 4, bag_size: 542
batch 339, loss: 2.3351, instance_loss: 0.6355, weighted_loss: 1.8252, label: 1, bag_size: 448
batch 359, loss: 0.1301, instance_loss: 0.3467, weighted_loss: 0.1951, label: 3, bag_size: 706
batch 379, loss: 0.2179, instance_loss: 0.2429, weighted_loss: 0.2254, label: 2, bag_size: 636
batch 399, loss: 0.0193, instance_loss: 0.0809, weighted_loss: 0.0377, label: 0, bag_size: 552
batch 419, loss: 0.0082, instance_loss: 0.2478, weighted_loss: 0.0801, label: 3, bag_size: 821


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.41411764705882353: correct 1408/3400
Epoch: 26, train_loss: 0.2640, train_clustering_loss:  0.3144, train_error: 0.0682
class 0: acc 0.9651162790697675, correct 83/86
class 1: acc 0.85, correct 68/80
class 2: acc 0.8522727272727273, correct 75/88
class 3: acc 0.9894736842105263, correct 94/95
class 4: acc 1.0, correct 76/76

Val Set, val_loss: 1.3585, val_error: 0.4200, auc: 0.8420
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.265: correct 106/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4375, correct 7/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0159, instance_loss: 0.0531, weighted_loss: 0.0271, label: 3, bag_size: 729
batch 39, loss: 0.4843, instance_loss: 0.2771, weighted_loss: 0.4221, label: 3, bag_size: 533
batch 59, loss: 0.0535, instance_loss: 0.2174, weighted_loss: 0.1027, label: 1, bag_size: 1651
batch 79, loss: 0.1909, instance_loss: 0.3235, weighted_loss: 0.2307, label: 3, bag_size: 849
batch 99, loss: 0.1944, instance_loss: 0.2774, weighted_loss: 0.2193, label: 2, bag_size: 1404
batch 119, loss: 0.0158, instance_loss: 0.2068, weighted_loss: 0.0731, label: 4, bag_size: 636
batch 139, loss: 0.0586, instance_loss: 0.3784, weighted_loss: 0.1545, label: 4, bag_size: 1331
batch 159, loss: 0.1400, instance_loss: 0.5142, weighted_loss: 0.2522, label: 3, bag_size: 230
batch 179, loss: 0.1650, instance_loss: 0.2562, weighted_loss: 0.1924, label: 3, bag_size: 1019
batch 199, loss: 0.0056, instance_loss: 0.1022, weighted_loss: 0.0346, label: 4, bag_size: 646
batch 219, loss: 0.1645, instance_loss: 0.2482, weighted_loss: 0.1896, label: 2, bag_size: 323
batch 239, loss: 4.2182, instance_loss: 0.8977, weighted_loss: 3.2221, label: 2, bag_size: 319
batch 259, loss: 0.1594, instance_loss: 0.3162, weighted_loss: 0.2065, label: 3, bag_size: 281
batch 279, loss: 0.0550, instance_loss: 0.2572, weighted_loss: 0.1157, label: 3, bag_size: 343
batch 299, loss: 0.2856, instance_loss: 0.2709, weighted_loss: 0.2812, label: 2, bag_size: 1448
batch 319, loss: 0.0211, instance_loss: 0.0913, weighted_loss: 0.0422, label: 0, bag_size: 729
batch 339, loss: 0.1751, instance_loss: 0.2681, weighted_loss: 0.2030, label: 2, bag_size: 461
batch 359, loss: 0.0087, instance_loss: 0.0645, weighted_loss: 0.0254, label: 0, bag_size: 729
batch 379, loss: 0.0202, instance_loss: 0.7900, weighted_loss: 0.2511, label: 4, bag_size: 542
batch 399, loss: 0.1207, instance_loss: 0.3010, weighted_loss: 0.1748, label: 3, bag_size: 317
batch 419, loss: 0.2273, instance_loss: 0.5411, weighted_loss: 0.3214, label: 2, bag_size: 986


class 0 clustering acc 0.987: correct 16779/17000
class 1 clustering acc 0.4335294117647059: correct 1474/3400
Epoch: 27, train_loss: 0.2488, train_clustering_loss:  0.3101, train_error: 0.0918
class 0: acc 0.9875, correct 79/80
class 1: acc 0.8125, correct 65/80
class 2: acc 0.7934782608695652, correct 73/92
class 3: acc 0.9770114942528736, correct 85/87
class 4: acc 0.9767441860465116, correct 84/86

Val Set, val_loss: 1.3254, val_error: 0.4400, auc: 0.8455
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.1013, instance_loss: 0.2707, weighted_loss: 0.1521, label: 4, bag_size: 826
batch 39, loss: 0.0136, instance_loss: 0.0538, weighted_loss: 0.0256, label: 1, bag_size: 286
batch 59, loss: 0.0228, instance_loss: 0.5288, weighted_loss: 0.1746, label: 1, bag_size: 1152
batch 79, loss: 0.0774, instance_loss: 0.2316, weighted_loss: 0.1237, label: 3, bag_size: 849
batch 99, loss: 0.0170, instance_loss: 0.0398, weighted_loss: 0.0239, label: 3, bag_size: 729
batch 119, loss: 0.0046, instance_loss: 0.0842, weighted_loss: 0.0285, label: 4, bag_size: 636
batch 139, loss: 0.3162, instance_loss: 0.4363, weighted_loss: 0.3522, label: 4, bag_size: 511
batch 159, loss: 0.1995, instance_loss: 0.3733, weighted_loss: 0.2516, label: 4, bag_size: 511
batch 179, loss: 0.1858, instance_loss: 0.0973, weighted_loss: 0.1593, label: 3, bag_size: 1177
batch 199, loss: 0.0014, instance_loss: 0.0871, weighted_loss: 0.0271, label: 3, bag_size: 729
batch 219, loss: 0.1000, instance_loss: 0.2856, weighted_loss: 0.1557, label: 4, bag_size: 663
batch 239, loss: 0.2747, instance_loss: 0.6825, weighted_loss: 0.3970, label: 0, bag_size: 282
batch 259, loss: 0.1306, instance_loss: 0.4974, weighted_loss: 0.2407, label: 3, bag_size: 630
batch 279, loss: 0.0287, instance_loss: 0.3158, weighted_loss: 0.1148, label: 3, bag_size: 1250
batch 299, loss: 0.2659, instance_loss: 0.4092, weighted_loss: 0.3089, label: 2, bag_size: 986
batch 319, loss: 0.0007, instance_loss: 0.1766, weighted_loss: 0.0535, label: 1, bag_size: 1127
batch 339, loss: 0.5821, instance_loss: 0.7103, weighted_loss: 0.6205, label: 2, bag_size: 1231
batch 359, loss: 0.2206, instance_loss: 0.2829, weighted_loss: 0.2393, label: 1, bag_size: 818
batch 379, loss: 0.1405, instance_loss: 0.2699, weighted_loss: 0.1793, label: 0, bag_size: 1065
batch 399, loss: 0.0120, instance_loss: 0.1270, weighted_loss: 0.0465, label: 0, bag_size: 962
batch 419, loss: 0.0038, instance_loss: 0.0719, weighted_loss: 0.0242, label: 3, bag_size: 729


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.4476470588235294: correct 1522/3400
Epoch: 28, train_loss: 0.2617, train_clustering_loss:  0.3081, train_error: 0.0682
class 0: acc 0.9382716049382716, correct 76/81
class 1: acc 0.9148936170212766, correct 86/94
class 2: acc 0.8082191780821918, correct 59/73
class 3: acc 0.9891304347826086, correct 91/92
class 4: acc 0.9882352941176471, correct 84/85

Val Set, val_loss: 1.3616, val_error: 0.4600, auc: 0.8418
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.3275: correct 131/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.4, correct 6/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.9572, instance_loss: 0.6294, weighted_loss: 0.8588, label: 2, bag_size: 1119
batch 39, loss: 0.3916, instance_loss: 0.2828, weighted_loss: 0.3590, label: 2, bag_size: 913
batch 59, loss: 0.1846, instance_loss: 0.3728, weighted_loss: 0.2411, label: 0, bag_size: 542
batch 79, loss: 0.1291, instance_loss: 0.2742, weighted_loss: 0.1726, label: 1, bag_size: 913
batch 99, loss: 0.5397, instance_loss: 0.6590, weighted_loss: 0.5755, label: 2, bag_size: 373
batch 119, loss: 0.0035, instance_loss: 0.1051, weighted_loss: 0.0340, label: 0, bag_size: 476
batch 139, loss: 0.0450, instance_loss: 0.1328, weighted_loss: 0.0713, label: 3, bag_size: 451
batch 159, loss: 0.0630, instance_loss: 0.4044, weighted_loss: 0.1654, label: 1, bag_size: 778
batch 179, loss: 0.0645, instance_loss: 0.2084, weighted_loss: 0.1077, label: 3, bag_size: 1019
batch 199, loss: 0.0394, instance_loss: 0.2222, weighted_loss: 0.0942, label: 4, bag_size: 947
batch 219, loss: 0.3612, instance_loss: 0.5097, weighted_loss: 0.4057, label: 3, bag_size: 281
batch 239, loss: 2.2148, instance_loss: 0.6541, weighted_loss: 1.7466, label: 1, bag_size: 448
batch 259, loss: 0.0581, instance_loss: 0.2608, weighted_loss: 0.1189, label: 1, bag_size: 405
batch 279, loss: 0.0200, instance_loss: 0.1339, weighted_loss: 0.0542, label: 4, bag_size: 1278
batch 299, loss: 0.0353, instance_loss: 0.4056, weighted_loss: 0.1464, label: 4, bag_size: 817
batch 319, loss: 0.1370, instance_loss: 0.2651, weighted_loss: 0.1755, label: 1, bag_size: 504
batch 339, loss: 0.8991, instance_loss: 0.4565, weighted_loss: 0.7663, label: 4, bag_size: 436
batch 359, loss: 0.0084, instance_loss: 0.0446, weighted_loss: 0.0193, label: 0, bag_size: 518
batch 379, loss: 0.1586, instance_loss: 0.1169, weighted_loss: 0.1461, label: 3, bag_size: 1177
batch 399, loss: 0.0283, instance_loss: 0.0867, weighted_loss: 0.0458, label: 1, bag_size: 994
batch 419, loss: 0.7462, instance_loss: 0.4873, weighted_loss: 0.6686, label: 1, bag_size: 1096


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.4211764705882353: correct 1432/3400
Epoch: 29, train_loss: 0.2896, train_clustering_loss:  0.3130, train_error: 0.0941
class 0: acc 0.9767441860465116, correct 84/86
class 1: acc 0.8556701030927835, correct 83/97
class 2: acc 0.7816091954022989, correct 68/87
class 3: acc 0.967391304347826, correct 89/92
class 4: acc 0.9682539682539683, correct 61/63

Val Set, val_loss: 1.3511, val_error: 0.3800, auc: 0.8401
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.2925: correct 117/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2421, instance_loss: 0.2158, weighted_loss: 0.2342, label: 1, bag_size: 903
batch 39, loss: 0.1943, instance_loss: 0.1881, weighted_loss: 0.1924, label: 1, bag_size: 504
batch 59, loss: 0.1120, instance_loss: 0.2515, weighted_loss: 0.1539, label: 1, bag_size: 1651
batch 79, loss: 0.0749, instance_loss: 0.2370, weighted_loss: 0.1236, label: 0, bag_size: 381
batch 99, loss: 1.2738, instance_loss: 0.5270, weighted_loss: 1.0498, label: 2, bag_size: 1218
batch 119, loss: 0.4720, instance_loss: 0.4354, weighted_loss: 0.4611, label: 4, bag_size: 590
batch 139, loss: 0.0523, instance_loss: 0.1443, weighted_loss: 0.0799, label: 4, bag_size: 1121
batch 159, loss: 0.0000, instance_loss: 0.0845, weighted_loss: 0.0254, label: 4, bag_size: 729
batch 179, loss: 0.0010, instance_loss: 0.0460, weighted_loss: 0.0145, label: 0, bag_size: 360
batch 199, loss: 0.0057, instance_loss: 0.1480, weighted_loss: 0.0484, label: 1, bag_size: 1261
batch 219, loss: 0.2653, instance_loss: 0.7341, weighted_loss: 0.4059, label: 2, bag_size: 373
batch 239, loss: 0.0223, instance_loss: 0.1334, weighted_loss: 0.0557, label: 0, bag_size: 446
batch 259, loss: 3.9641, instance_loss: 1.3826, weighted_loss: 3.1896, label: 2, bag_size: 1108
batch 279, loss: 0.0161, instance_loss: 0.0734, weighted_loss: 0.0333, label: 0, bag_size: 616
batch 299, loss: 0.0026, instance_loss: 0.2946, weighted_loss: 0.0902, label: 4, bag_size: 974
batch 319, loss: 0.3884, instance_loss: 0.2914, weighted_loss: 0.3593, label: 2, bag_size: 748
batch 339, loss: 0.0003, instance_loss: 0.0470, weighted_loss: 0.0143, label: 4, bag_size: 729
batch 359, loss: 0.0301, instance_loss: 0.4905, weighted_loss: 0.1682, label: 1, bag_size: 1152
batch 379, loss: 0.5894, instance_loss: 0.3152, weighted_loss: 0.5072, label: 1, bag_size: 860
batch 399, loss: 0.5165, instance_loss: 0.4925, weighted_loss: 0.5093, label: 2, bag_size: 1232
batch 419, loss: 0.0302, instance_loss: 0.3166, weighted_loss: 0.1161, label: 2, bag_size: 421


class 0 clustering acc 0.9891764705882353: correct 16816/17000
class 1 clustering acc 0.4320588235294118: correct 1469/3400
Epoch: 30, train_loss: 0.2616, train_clustering_loss:  0.3050, train_error: 0.0941
class 0: acc 0.9382716049382716, correct 76/81
class 1: acc 0.8586956521739131, correct 79/92
class 2: acc 0.8021978021978022, correct 73/91
class 3: acc 0.9666666666666667, correct 87/90
class 4: acc 0.9859154929577465, correct 70/71

Val Set, val_loss: 1.3644, val_error: 0.4000, auc: 0.8414
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.625, correct 10/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0035, instance_loss: 0.1543, weighted_loss: 0.0487, label: 4, bag_size: 729
batch 39, loss: 0.0372, instance_loss: 0.4438, weighted_loss: 0.1591, label: 1, bag_size: 747
batch 59, loss: 0.0074, instance_loss: 0.0724, weighted_loss: 0.0269, label: 0, bag_size: 729
batch 79, loss: 2.8884, instance_loss: 0.9320, weighted_loss: 2.3015, label: 2, bag_size: 967
batch 99, loss: 0.0112, instance_loss: 0.2837, weighted_loss: 0.0929, label: 4, bag_size: 675
batch 119, loss: 0.0009, instance_loss: 0.0805, weighted_loss: 0.0248, label: 4, bag_size: 1235
batch 139, loss: 0.1056, instance_loss: 0.2135, weighted_loss: 0.1379, label: 3, bag_size: 343
batch 159, loss: 0.0017, instance_loss: 0.0314, weighted_loss: 0.0106, label: 0, bag_size: 518
batch 179, loss: 0.0450, instance_loss: 0.1914, weighted_loss: 0.0889, label: 0, bag_size: 1255
batch 199, loss: 0.2750, instance_loss: 0.2282, weighted_loss: 0.2610, label: 4, bag_size: 1002
batch 219, loss: 0.0798, instance_loss: 0.0778, weighted_loss: 0.0792, label: 3, bag_size: 729
batch 239, loss: 0.0945, instance_loss: 0.1036, weighted_loss: 0.0973, label: 0, bag_size: 1247
batch 259, loss: 0.0509, instance_loss: 0.2678, weighted_loss: 0.1160, label: 1, bag_size: 1651
batch 279, loss: 0.2515, instance_loss: 0.3721, weighted_loss: 0.2877, label: 1, bag_size: 1096
batch 299, loss: 0.0186, instance_loss: 0.1850, weighted_loss: 0.0685, label: 1, bag_size: 965
batch 319, loss: 0.0185, instance_loss: 0.1756, weighted_loss: 0.0656, label: 3, bag_size: 821
batch 339, loss: 0.0030, instance_loss: 0.1273, weighted_loss: 0.0403, label: 4, bag_size: 646
batch 359, loss: 0.0109, instance_loss: 0.0551, weighted_loss: 0.0241, label: 0, bag_size: 602
batch 379, loss: 0.0455, instance_loss: 0.2408, weighted_loss: 0.1041, label: 2, bag_size: 395
batch 399, loss: 0.0493, instance_loss: 0.0652, weighted_loss: 0.0541, label: 3, bag_size: 1177
batch 419, loss: 0.0006, instance_loss: 0.0378, weighted_loss: 0.0117, label: 0, bag_size: 521


class 0 clustering acc 0.9899411764705882: correct 16829/17000
class 1 clustering acc 0.4582352941176471: correct 1558/3400
Epoch: 31, train_loss: 0.1993, train_clustering_loss:  0.2850, train_error: 0.0588
class 0: acc 0.9795918367346939, correct 96/98
class 1: acc 0.8493150684931506, correct 62/73
class 2: acc 0.8481012658227848, correct 67/79
class 3: acc 1.0, correct 86/86
class 4: acc 1.0, correct 89/89

Val Set, val_loss: 1.2930, val_error: 0.3800, auc: 0.8503
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.3075: correct 123/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.4707, instance_loss: 0.3164, weighted_loss: 0.4244, label: 2, bag_size: 632
batch 39, loss: 0.0270, instance_loss: 0.2696, weighted_loss: 0.0998, label: 2, bag_size: 222
batch 59, loss: 0.0413, instance_loss: 0.3269, weighted_loss: 0.1270, label: 2, bag_size: 655
batch 79, loss: 0.0002, instance_loss: 0.0674, weighted_loss: 0.0204, label: 4, bag_size: 729
batch 99, loss: 0.0130, instance_loss: 0.0545, weighted_loss: 0.0255, label: 0, bag_size: 1065
batch 119, loss: 0.0113, instance_loss: 0.1620, weighted_loss: 0.0565, label: 4, bag_size: 947
batch 139, loss: 0.0148, instance_loss: 0.1273, weighted_loss: 0.0485, label: 0, bag_size: 729
batch 159, loss: 0.0240, instance_loss: 0.0846, weighted_loss: 0.0422, label: 3, bag_size: 729
batch 179, loss: 0.8952, instance_loss: 0.6319, weighted_loss: 0.8162, label: 2, bag_size: 511
batch 199, loss: 1.7471, instance_loss: 0.7489, weighted_loss: 1.4477, label: 1, bag_size: 435
batch 219, loss: 0.1520, instance_loss: 0.2311, weighted_loss: 0.1757, label: 3, bag_size: 451
batch 239, loss: 0.0587, instance_loss: 0.3769, weighted_loss: 0.1542, label: 4, bag_size: 817
batch 259, loss: 0.4240, instance_loss: 0.4505, weighted_loss: 0.4319, label: 2, bag_size: 1006
batch 279, loss: 0.1009, instance_loss: 0.0704, weighted_loss: 0.0917, label: 3, bag_size: 1559
batch 299, loss: 0.2737, instance_loss: 0.2928, weighted_loss: 0.2794, label: 3, bag_size: 305
batch 319, loss: 0.0341, instance_loss: 0.0591, weighted_loss: 0.0416, label: 3, bag_size: 1177
batch 339, loss: 0.0100, instance_loss: 0.0608, weighted_loss: 0.0252, label: 0, bag_size: 552
batch 359, loss: 0.0273, instance_loss: 0.0415, weighted_loss: 0.0316, label: 3, bag_size: 1172
batch 379, loss: 0.1479, instance_loss: 0.4767, weighted_loss: 0.2465, label: 2, bag_size: 861
batch 399, loss: 0.0138, instance_loss: 0.0695, weighted_loss: 0.0305, label: 4, bag_size: 1235
batch 419, loss: 0.1042, instance_loss: 0.1944, weighted_loss: 0.1312, label: 1, bag_size: 944


class 0 clustering acc 0.9881764705882353: correct 16799/17000
class 1 clustering acc 0.4802941176470588: correct 1633/3400
Epoch: 32, train_loss: 0.2442, train_clustering_loss:  0.2911, train_error: 0.0659
class 0: acc 0.970873786407767, correct 100/103
class 1: acc 0.8333333333333334, correct 60/72
class 2: acc 0.8607594936708861, correct 68/79
class 3: acc 0.975609756097561, correct 80/82
class 4: acc 1.0, correct 89/89

Val Set, val_loss: 1.3010, val_error: 0.4000, auc: 0.8512
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.3: correct 120/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2007, instance_loss: 0.2870, weighted_loss: 0.2266, label: 3, bag_size: 821
batch 39, loss: 0.1121, instance_loss: 0.3236, weighted_loss: 0.1755, label: 3, bag_size: 533
batch 59, loss: 0.1032, instance_loss: 0.1911, weighted_loss: 0.1296, label: 0, bag_size: 410
batch 79, loss: 0.0096, instance_loss: 0.0758, weighted_loss: 0.0295, label: 4, bag_size: 773
batch 99, loss: 0.0037, instance_loss: 0.0429, weighted_loss: 0.0155, label: 4, bag_size: 764
batch 119, loss: 0.0580, instance_loss: 0.2027, weighted_loss: 0.1014, label: 0, bag_size: 962
batch 139, loss: 0.0609, instance_loss: 0.3087, weighted_loss: 0.1352, label: 2, bag_size: 2081
batch 159, loss: 0.1375, instance_loss: 0.5338, weighted_loss: 0.2564, label: 3, bag_size: 706
batch 179, loss: 0.0555, instance_loss: 0.2747, weighted_loss: 0.1213, label: 0, bag_size: 338
batch 199, loss: 0.1696, instance_loss: 0.3828, weighted_loss: 0.2335, label: 2, bag_size: 932
batch 219, loss: 0.0637, instance_loss: 0.5668, weighted_loss: 0.2146, label: 2, bag_size: 1141
batch 239, loss: 0.0010, instance_loss: 0.0270, weighted_loss: 0.0088, label: 0, bag_size: 360
batch 259, loss: 0.1125, instance_loss: 0.1217, weighted_loss: 0.1153, label: 1, bag_size: 938
batch 279, loss: 0.3880, instance_loss: 0.4302, weighted_loss: 0.4007, label: 1, bag_size: 1080
batch 299, loss: 0.0001, instance_loss: 0.0662, weighted_loss: 0.0199, label: 4, bag_size: 729
batch 319, loss: 0.0111, instance_loss: 0.2084, weighted_loss: 0.0703, label: 4, bag_size: 826
batch 339, loss: 0.0029, instance_loss: 0.1342, weighted_loss: 0.0423, label: 3, bag_size: 729
batch 359, loss: 0.0068, instance_loss: 0.0710, weighted_loss: 0.0261, label: 4, bag_size: 773
batch 379, loss: 0.2005, instance_loss: 0.5024, weighted_loss: 0.2910, label: 2, bag_size: 271
batch 399, loss: 0.0485, instance_loss: 0.1380, weighted_loss: 0.0753, label: 0, bag_size: 476
batch 419, loss: 0.0998, instance_loss: 0.3487, weighted_loss: 0.1745, label: 1, bag_size: 858


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.4708823529411765: correct 1601/3400
Epoch: 33, train_loss: 0.2259, train_clustering_loss:  0.2970, train_error: 0.0776
class 0: acc 0.9411764705882353, correct 80/85
class 1: acc 0.8414634146341463, correct 69/82
class 2: acc 0.8170731707317073, correct 67/82
class 3: acc 1.0, correct 81/81
class 4: acc 1.0, correct 95/95

Val Set, val_loss: 1.3458, val_error: 0.3800, auc: 0.8496
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0481, instance_loss: 0.0665, weighted_loss: 0.0536, label: 3, bag_size: 729
batch 39, loss: 0.0348, instance_loss: 0.2304, weighted_loss: 0.0934, label: 4, bag_size: 947
batch 59, loss: 0.0067, instance_loss: 0.0671, weighted_loss: 0.0248, label: 3, bag_size: 952
batch 79, loss: 0.0974, instance_loss: 0.3520, weighted_loss: 0.1738, label: 1, bag_size: 1724
batch 99, loss: 0.0078, instance_loss: 0.0604, weighted_loss: 0.0236, label: 1, bag_size: 369
batch 119, loss: 0.0005, instance_loss: 0.2078, weighted_loss: 0.0627, label: 4, bag_size: 711
batch 139, loss: 0.0440, instance_loss: 0.2405, weighted_loss: 0.1029, label: 3, bag_size: 343
batch 159, loss: 0.0961, instance_loss: 0.4782, weighted_loss: 0.2107, label: 4, bag_size: 366
batch 179, loss: 0.9276, instance_loss: 0.1114, weighted_loss: 0.6827, label: 3, bag_size: 729
batch 199, loss: 0.0567, instance_loss: 0.1688, weighted_loss: 0.0903, label: 1, bag_size: 696
batch 219, loss: 0.0176, instance_loss: 0.0487, weighted_loss: 0.0270, label: 0, bag_size: 1034
batch 239, loss: 0.4563, instance_loss: 0.3650, weighted_loss: 0.4289, label: 2, bag_size: 1404
batch 259, loss: 0.0403, instance_loss: 0.2495, weighted_loss: 0.1031, label: 0, bag_size: 338
batch 279, loss: 0.0405, instance_loss: 0.2068, weighted_loss: 0.0904, label: 0, bag_size: 756
batch 299, loss: 0.0048, instance_loss: 0.0606, weighted_loss: 0.0215, label: 0, bag_size: 360
batch 319, loss: 0.0452, instance_loss: 0.0523, weighted_loss: 0.0473, label: 3, bag_size: 1069
batch 339, loss: 0.0690, instance_loss: 0.1088, weighted_loss: 0.0810, label: 3, bag_size: 729
batch 359, loss: 0.1453, instance_loss: 0.3112, weighted_loss: 0.1951, label: 1, bag_size: 711
batch 379, loss: 1.9410, instance_loss: 0.5201, weighted_loss: 1.5148, label: 2, bag_size: 1200
batch 399, loss: 0.0131, instance_loss: 0.0953, weighted_loss: 0.0377, label: 0, bag_size: 729
batch 419, loss: 0.0012, instance_loss: 0.0550, weighted_loss: 0.0174, label: 3, bag_size: 729


class 0 clustering acc 0.9887058823529412: correct 16808/17000
class 1 clustering acc 0.4844117647058824: correct 1647/3400
Epoch: 34, train_loss: 0.1754, train_clustering_loss:  0.2888, train_error: 0.0541
class 0: acc 0.9882352941176471, correct 84/85
class 1: acc 0.9021739130434783, correct 83/92
class 2: acc 0.8571428571428571, correct 66/77
class 3: acc 0.9879518072289156, correct 82/83
class 4: acc 0.9886363636363636, correct 87/88

Val Set, val_loss: 1.3731, val_error: 0.4000, auc: 0.8456
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.295: correct 118/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0050, instance_loss: 0.0509, weighted_loss: 0.0188, label: 3, bag_size: 729
batch 39, loss: 0.0237, instance_loss: 0.0238, weighted_loss: 0.0237, label: 3, bag_size: 729
batch 59, loss: 4.3132, instance_loss: 0.3254, weighted_loss: 3.1169, label: 4, bag_size: 823
batch 79, loss: 0.0013, instance_loss: 0.0465, weighted_loss: 0.0148, label: 3, bag_size: 729
batch 99, loss: 0.0017, instance_loss: 0.2618, weighted_loss: 0.0797, label: 4, bag_size: 974
batch 119, loss: 0.2920, instance_loss: 0.5385, weighted_loss: 0.3660, label: 1, bag_size: 1390
batch 139, loss: 0.0016, instance_loss: 0.1152, weighted_loss: 0.0357, label: 0, bag_size: 976
batch 159, loss: 0.0220, instance_loss: 0.2444, weighted_loss: 0.0887, label: 2, bag_size: 395
batch 179, loss: 0.1930, instance_loss: 0.4004, weighted_loss: 0.2552, label: 3, bag_size: 360
batch 199, loss: 0.0019, instance_loss: 0.0429, weighted_loss: 0.0142, label: 4, bag_size: 711
batch 219, loss: 0.0019, instance_loss: 0.1919, weighted_loss: 0.0589, label: 4, bag_size: 729
batch 239, loss: 1.2103, instance_loss: 0.5924, weighted_loss: 1.0249, label: 3, bag_size: 281
batch 259, loss: 0.4442, instance_loss: 0.4642, weighted_loss: 0.4502, label: 2, bag_size: 1133
batch 279, loss: 0.3295, instance_loss: 0.7965, weighted_loss: 0.4696, label: 1, bag_size: 1390
batch 299, loss: 0.0046, instance_loss: 0.0172, weighted_loss: 0.0084, label: 3, bag_size: 729
batch 319, loss: 0.0099, instance_loss: 0.0888, weighted_loss: 0.0335, label: 0, bag_size: 729
batch 339, loss: 0.0600, instance_loss: 0.2923, weighted_loss: 0.1297, label: 2, bag_size: 252
batch 359, loss: 0.0001, instance_loss: 0.4076, weighted_loss: 0.1224, label: 4, bag_size: 663
batch 379, loss: 1.0368, instance_loss: 0.4707, weighted_loss: 0.8670, label: 1, bag_size: 754
batch 399, loss: 0.0349, instance_loss: 0.2852, weighted_loss: 0.1099, label: 3, bag_size: 343
batch 419, loss: 0.0286, instance_loss: 0.5328, weighted_loss: 0.1799, label: 1, bag_size: 648


class 0 clustering acc 0.9895294117647059: correct 16822/17000
class 1 clustering acc 0.46794117647058825: correct 1591/3400
Epoch: 35, train_loss: 0.2292, train_clustering_loss:  0.2891, train_error: 0.0847
class 0: acc 0.9629629629629629, correct 78/81
class 1: acc 0.8666666666666667, correct 65/75
class 2: acc 0.7532467532467533, correct 58/77
class 3: acc 0.9770114942528736, correct 85/87
class 4: acc 0.9809523809523809, correct 103/105

Val Set, val_loss: 1.5694, val_error: 0.4000, auc: 0.8351
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0247, instance_loss: 0.1213, weighted_loss: 0.0537, label: 1, bag_size: 994
batch 39, loss: 0.1389, instance_loss: 0.4142, weighted_loss: 0.2215, label: 2, bag_size: 355
batch 59, loss: 0.2157, instance_loss: 0.3149, weighted_loss: 0.2455, label: 0, bag_size: 381
batch 79, loss: 0.0042, instance_loss: 0.1152, weighted_loss: 0.0375, label: 0, bag_size: 1196
batch 99, loss: 0.3545, instance_loss: 0.3664, weighted_loss: 0.3580, label: 1, bag_size: 1080
batch 119, loss: 0.0693, instance_loss: 0.4543, weighted_loss: 0.1848, label: 2, bag_size: 1141
batch 139, loss: 0.1406, instance_loss: 0.4065, weighted_loss: 0.2204, label: 1, bag_size: 1080
batch 159, loss: 0.1653, instance_loss: 0.4611, weighted_loss: 0.2540, label: 1, bag_size: 778
batch 179, loss: 0.0688, instance_loss: 0.1943, weighted_loss: 0.1064, label: 3, bag_size: 1019
batch 199, loss: 0.0022, instance_loss: 0.3862, weighted_loss: 0.1174, label: 4, bag_size: 663
batch 219, loss: 0.0088, instance_loss: 0.3245, weighted_loss: 0.1035, label: 3, bag_size: 697
batch 239, loss: 0.0730, instance_loss: 0.2965, weighted_loss: 0.1400, label: 4, bag_size: 297
batch 259, loss: 0.1132, instance_loss: 0.1624, weighted_loss: 0.1279, label: 0, bag_size: 367
batch 279, loss: 0.2741, instance_loss: 0.4043, weighted_loss: 0.3131, label: 2, bag_size: 307
batch 299, loss: 0.0049, instance_loss: 0.1040, weighted_loss: 0.0347, label: 0, bag_size: 1196
batch 319, loss: 0.1124, instance_loss: 0.1614, weighted_loss: 0.1271, label: 0, bag_size: 367
batch 339, loss: 0.0547, instance_loss: 0.4321, weighted_loss: 0.1679, label: 2, bag_size: 986
batch 359, loss: 0.0023, instance_loss: 0.0462, weighted_loss: 0.0155, label: 3, bag_size: 952
batch 379, loss: 0.1281, instance_loss: 0.1100, weighted_loss: 0.1227, label: 0, bag_size: 367
batch 399, loss: 0.0003, instance_loss: 0.0578, weighted_loss: 0.0176, label: 4, bag_size: 729
batch 419, loss: 0.1340, instance_loss: 0.3984, weighted_loss: 0.2133, label: 1, bag_size: 442


class 0 clustering acc 0.9885882352941177: correct 16806/17000
class 1 clustering acc 0.4561764705882353: correct 1551/3400
Epoch: 36, train_loss: 0.1847, train_clustering_loss:  0.2946, train_error: 0.0565
class 0: acc 0.9883720930232558, correct 85/86
class 1: acc 0.8863636363636364, correct 78/88
class 2: acc 0.8522727272727273, correct 75/88
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.3809, val_error: 0.4000, auc: 0.8503
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.335: correct 134/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6, correct 9/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0358, instance_loss: 0.1561, weighted_loss: 0.0719, label: 1, bag_size: 1651
batch 39, loss: 0.0522, instance_loss: 0.2264, weighted_loss: 0.1045, label: 2, bag_size: 252
batch 59, loss: 0.1177, instance_loss: 0.3317, weighted_loss: 0.1819, label: 1, bag_size: 1049
batch 79, loss: 0.1206, instance_loss: 0.3142, weighted_loss: 0.1787, label: 1, bag_size: 1049
batch 99, loss: 0.0998, instance_loss: 0.2971, weighted_loss: 0.1590, label: 1, bag_size: 1049
batch 119, loss: 0.0019, instance_loss: 0.0411, weighted_loss: 0.0137, label: 3, bag_size: 729
batch 139, loss: 0.0091, instance_loss: 0.1327, weighted_loss: 0.0462, label: 4, bag_size: 636
batch 159, loss: 0.0019, instance_loss: 0.0594, weighted_loss: 0.0191, label: 0, bag_size: 382
batch 179, loss: 0.0000, instance_loss: 0.0353, weighted_loss: 0.0106, label: 4, bag_size: 729
batch 199, loss: 0.0895, instance_loss: 0.3284, weighted_loss: 0.1612, label: 1, bag_size: 846
batch 219, loss: 0.0274, instance_loss: 0.2322, weighted_loss: 0.0889, label: 1, bag_size: 504
batch 239, loss: 0.2559, instance_loss: 0.6184, weighted_loss: 0.3646, label: 1, bag_size: 448
batch 259, loss: 0.0082, instance_loss: 0.0597, weighted_loss: 0.0236, label: 0, bag_size: 616
batch 279, loss: 1.5504, instance_loss: 0.7807, weighted_loss: 1.3195, label: 0, bag_size: 245
batch 299, loss: 0.0002, instance_loss: 0.1686, weighted_loss: 0.0507, label: 4, bag_size: 388
batch 319, loss: 0.0018, instance_loss: 0.1631, weighted_loss: 0.0502, label: 3, bag_size: 821
batch 339, loss: 0.0270, instance_loss: 0.1171, weighted_loss: 0.0541, label: 0, bag_size: 729
batch 359, loss: 0.0016, instance_loss: 0.0809, weighted_loss: 0.0254, label: 4, bag_size: 646
batch 379, loss: 0.0241, instance_loss: 0.1411, weighted_loss: 0.0592, label: 0, bag_size: 1135
batch 399, loss: 0.1313, instance_loss: 0.2711, weighted_loss: 0.1732, label: 2, bag_size: 471
batch 419, loss: 0.0090, instance_loss: 0.1763, weighted_loss: 0.0592, label: 4, bag_size: 1278


class 0 clustering acc 0.9842941176470589: correct 16733/17000
class 1 clustering acc 0.4626470588235294: correct 1573/3400
Epoch: 37, train_loss: 0.2076, train_clustering_loss:  0.3052, train_error: 0.0612
class 0: acc 0.9550561797752809, correct 85/89
class 1: acc 0.9247311827956989, correct 86/93
class 2: acc 0.8522727272727273, correct 75/88
class 3: acc 0.9878048780487805, correct 81/82
class 4: acc 0.9863013698630136, correct 72/73

Val Set, val_loss: 1.3740, val_error: 0.3800, auc: 0.8612
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.2975: correct 119/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0024, instance_loss: 0.2987, weighted_loss: 0.0913, label: 1, bag_size: 890
batch 39, loss: 0.0193, instance_loss: 0.0631, weighted_loss: 0.0324, label: 3, bag_size: 1069
batch 59, loss: 0.1574, instance_loss: 0.2593, weighted_loss: 0.1880, label: 1, bag_size: 1080
batch 79, loss: 0.0127, instance_loss: 0.0885, weighted_loss: 0.0354, label: 0, bag_size: 729
batch 99, loss: 0.0706, instance_loss: 0.1152, weighted_loss: 0.0840, label: 3, bag_size: 1118
batch 119, loss: 0.0344, instance_loss: 0.3098, weighted_loss: 0.1171, label: 4, bag_size: 928
batch 139, loss: 0.0082, instance_loss: 0.4208, weighted_loss: 0.1320, label: 3, bag_size: 791
batch 159, loss: 0.0162, instance_loss: 0.1007, weighted_loss: 0.0415, label: 0, bag_size: 729
batch 179, loss: 0.0468, instance_loss: 0.1945, weighted_loss: 0.0911, label: 4, bag_size: 928
batch 199, loss: 0.3111, instance_loss: 0.4409, weighted_loss: 0.3500, label: 2, bag_size: 1617
batch 219, loss: 0.0515, instance_loss: 0.5346, weighted_loss: 0.1964, label: 2, bag_size: 373
batch 239, loss: 0.0701, instance_loss: 0.1996, weighted_loss: 0.1090, label: 1, bag_size: 846
batch 259, loss: 0.0014, instance_loss: 0.0299, weighted_loss: 0.0099, label: 0, bag_size: 1466
batch 279, loss: 0.0013, instance_loss: 0.0791, weighted_loss: 0.0246, label: 4, bag_size: 729
batch 299, loss: 0.0081, instance_loss: 0.0919, weighted_loss: 0.0333, label: 0, bag_size: 1255
batch 319, loss: 0.1064, instance_loss: 0.2281, weighted_loss: 0.1430, label: 0, bag_size: 1247
batch 339, loss: 0.3858, instance_loss: 0.4401, weighted_loss: 0.4021, label: 2, bag_size: 1133
batch 359, loss: 0.0554, instance_loss: 0.3691, weighted_loss: 0.1495, label: 2, bag_size: 600
batch 379, loss: 0.1354, instance_loss: 0.3618, weighted_loss: 0.2033, label: 1, bag_size: 818
batch 399, loss: 0.4194, instance_loss: 0.6364, weighted_loss: 0.4845, label: 0, bag_size: 1065
batch 419, loss: 0.0384, instance_loss: 0.4181, weighted_loss: 0.1523, label: 3, bag_size: 1167


class 0 clustering acc 0.9865294117647059: correct 16771/17000
class 1 clustering acc 0.42558823529411766: correct 1447/3400
Epoch: 38, train_loss: 0.2156, train_clustering_loss:  0.3118, train_error: 0.0635
class 0: acc 0.963855421686747, correct 80/83
class 1: acc 0.8913043478260869, correct 82/92
class 2: acc 0.8666666666666667, correct 78/90
class 3: acc 0.9873417721518988, correct 78/79
class 4: acc 0.9876543209876543, correct 80/81

Val Set, val_loss: 1.3425, val_error: 0.4200, auc: 0.8506
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.2925: correct 117/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.2322, instance_loss: 0.3572, weighted_loss: 0.2697, label: 1, bag_size: 1273
batch 39, loss: 0.3019, instance_loss: 0.3336, weighted_loss: 0.3114, label: 1, bag_size: 1080
batch 59, loss: 0.0173, instance_loss: 0.3091, weighted_loss: 0.1049, label: 4, bag_size: 826
batch 79, loss: 0.0059, instance_loss: 0.0371, weighted_loss: 0.0153, label: 3, bag_size: 1172
batch 99, loss: 0.4311, instance_loss: 0.3534, weighted_loss: 0.4078, label: 2, bag_size: 264
batch 119, loss: 0.0019, instance_loss: 0.2707, weighted_loss: 0.0826, label: 4, bag_size: 754
batch 139, loss: 0.0083, instance_loss: 0.3549, weighted_loss: 0.1123, label: 3, bag_size: 706
batch 159, loss: 0.0403, instance_loss: 0.2693, weighted_loss: 0.1090, label: 2, bag_size: 684
batch 179, loss: 0.1965, instance_loss: 0.2354, weighted_loss: 0.2082, label: 0, bag_size: 1247
batch 199, loss: 0.0497, instance_loss: 0.3350, weighted_loss: 0.1353, label: 3, bag_size: 1167
batch 219, loss: 0.0800, instance_loss: 0.3951, weighted_loss: 0.1745, label: 1, bag_size: 965
batch 239, loss: 0.0006, instance_loss: 0.1091, weighted_loss: 0.0332, label: 3, bag_size: 729
batch 259, loss: 0.0179, instance_loss: 0.0951, weighted_loss: 0.0411, label: 0, bag_size: 729
batch 279, loss: 0.0014, instance_loss: 0.0481, weighted_loss: 0.0154, label: 0, bag_size: 385
batch 299, loss: 0.0340, instance_loss: 0.2171, weighted_loss: 0.0889, label: 2, bag_size: 614
batch 319, loss: 0.0000, instance_loss: 0.0299, weighted_loss: 0.0090, label: 4, bag_size: 729
batch 339, loss: 0.9695, instance_loss: 0.3554, weighted_loss: 0.7853, label: 3, bag_size: 697
batch 359, loss: 0.0143, instance_loss: 0.3267, weighted_loss: 0.1080, label: 2, bag_size: 330
batch 379, loss: 0.4839, instance_loss: 0.8429, weighted_loss: 0.5916, label: 2, bag_size: 679
batch 399, loss: 0.0100, instance_loss: 0.2291, weighted_loss: 0.0757, label: 3, bag_size: 791
batch 419, loss: 0.0245, instance_loss: 0.1861, weighted_loss: 0.0730, label: 3, bag_size: 849


class 0 clustering acc 0.9898235294117647: correct 16827/17000
class 1 clustering acc 0.46647058823529414: correct 1586/3400
Epoch: 39, train_loss: 0.1712, train_clustering_loss:  0.2877, train_error: 0.0424
class 0: acc 0.9753086419753086, correct 79/81
class 1: acc 0.925531914893617, correct 87/94
class 2: acc 0.9101123595505618, correct 81/89
class 3: acc 0.9888888888888889, correct 89/90
class 4: acc 1.0, correct 71/71

Val Set, val_loss: 1.2778, val_error: 0.3800, auc: 0.8747
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.325: correct 130/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0672, instance_loss: 0.1991, weighted_loss: 0.1068, label: 0, bag_size: 1332
batch 39, loss: 0.0009, instance_loss: 0.0403, weighted_loss: 0.0127, label: 3, bag_size: 952
batch 59, loss: 0.0056, instance_loss: 0.0345, weighted_loss: 0.0142, label: 0, bag_size: 602
batch 79, loss: 0.0032, instance_loss: 0.0910, weighted_loss: 0.0295, label: 3, bag_size: 305
batch 99, loss: 0.0002, instance_loss: 0.0455, weighted_loss: 0.0138, label: 3, bag_size: 729
batch 119, loss: 0.0011, instance_loss: 0.0280, weighted_loss: 0.0092, label: 0, bag_size: 518
batch 139, loss: 0.0064, instance_loss: 0.0317, weighted_loss: 0.0140, label: 3, bag_size: 729
batch 159, loss: 0.8221, instance_loss: 0.3694, weighted_loss: 0.6863, label: 1, bag_size: 1096
batch 179, loss: 0.1433, instance_loss: 0.2628, weighted_loss: 0.1791, label: 0, bag_size: 736
batch 199, loss: 0.0050, instance_loss: 0.0464, weighted_loss: 0.0175, label: 0, bag_size: 552
batch 219, loss: 0.0130, instance_loss: 0.0948, weighted_loss: 0.0375, label: 3, bag_size: 316
batch 239, loss: 0.0127, instance_loss: 0.1874, weighted_loss: 0.0651, label: 2, bag_size: 655
batch 259, loss: 0.0056, instance_loss: 0.1669, weighted_loss: 0.0540, label: 3, bag_size: 729
batch 279, loss: 0.0102, instance_loss: 0.0607, weighted_loss: 0.0254, label: 0, bag_size: 921
batch 299, loss: 0.0056, instance_loss: 0.0390, weighted_loss: 0.0156, label: 1, bag_size: 286
batch 319, loss: 0.0109, instance_loss: 0.1903, weighted_loss: 0.0647, label: 3, bag_size: 1118
batch 339, loss: 0.2057, instance_loss: 0.2383, weighted_loss: 0.2155, label: 1, bag_size: 903
batch 359, loss: 0.0943, instance_loss: 0.3294, weighted_loss: 0.1648, label: 2, bag_size: 537
batch 379, loss: 0.0002, instance_loss: 0.0404, weighted_loss: 0.0122, label: 4, bag_size: 729
batch 399, loss: 0.0339, instance_loss: 0.3066, weighted_loss: 0.1157, label: 2, bag_size: 355
batch 419, loss: 0.0709, instance_loss: 0.1549, weighted_loss: 0.0961, label: 0, bag_size: 545


class 0 clustering acc 0.9887058823529412: correct 16808/17000
class 1 clustering acc 0.4802941176470588: correct 1633/3400
Epoch: 40, train_loss: 0.1861, train_clustering_loss:  0.2835, train_error: 0.0588
class 0: acc 0.9659090909090909, correct 85/88
class 1: acc 0.9047619047619048, correct 76/84
class 2: acc 0.8108108108108109, correct 60/74
class 3: acc 1.0, correct 96/96
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.4053, val_error: 0.3400, auc: 0.8669
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.8, correct 12/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0088, instance_loss: 0.2846, weighted_loss: 0.0916, label: 2, bag_size: 222
batch 39, loss: 0.0565, instance_loss: 0.1352, weighted_loss: 0.0801, label: 3, bag_size: 1118
batch 59, loss: 0.0180, instance_loss: 0.2371, weighted_loss: 0.0837, label: 3, bag_size: 343
batch 79, loss: 0.0106, instance_loss: 0.2422, weighted_loss: 0.0801, label: 1, bag_size: 1402
batch 99, loss: 0.0037, instance_loss: 0.1765, weighted_loss: 0.0555, label: 4, bag_size: 636
batch 119, loss: 0.1212, instance_loss: 0.4718, weighted_loss: 0.2264, label: 1, bag_size: 442
batch 139, loss: 0.0199, instance_loss: 0.0667, weighted_loss: 0.0339, label: 3, bag_size: 729
batch 159, loss: 0.0017, instance_loss: 0.0368, weighted_loss: 0.0122, label: 4, bag_size: 1235
batch 179, loss: 0.0403, instance_loss: 0.1365, weighted_loss: 0.0692, label: 3, bag_size: 533
batch 199, loss: 0.0006, instance_loss: 0.0243, weighted_loss: 0.0077, label: 0, bag_size: 518
batch 219, loss: 0.0101, instance_loss: 0.2808, weighted_loss: 0.0913, label: 1, bag_size: 614
batch 239, loss: 0.0262, instance_loss: 0.0622, weighted_loss: 0.0370, label: 3, bag_size: 1177
batch 259, loss: 0.0639, instance_loss: 0.2531, weighted_loss: 0.1207, label: 2, bag_size: 351
batch 279, loss: 0.3201, instance_loss: 0.2059, weighted_loss: 0.2858, label: 0, bag_size: 962
batch 299, loss: 0.0828, instance_loss: 0.4619, weighted_loss: 0.1965, label: 3, bag_size: 281
batch 319, loss: 0.0079, instance_loss: 0.0772, weighted_loss: 0.0287, label: 0, bag_size: 371
batch 339, loss: 0.0021, instance_loss: 0.2831, weighted_loss: 0.0864, label: 3, bag_size: 791
batch 359, loss: 0.0076, instance_loss: 0.0957, weighted_loss: 0.0340, label: 1, bag_size: 696
batch 379, loss: 0.0020, instance_loss: 0.0261, weighted_loss: 0.0092, label: 0, bag_size: 524
batch 399, loss: 0.0027, instance_loss: 0.0547, weighted_loss: 0.0183, label: 0, bag_size: 524
batch 419, loss: 0.0030, instance_loss: 0.0589, weighted_loss: 0.0198, label: 3, bag_size: 952


class 0 clustering acc 0.9869411764705882: correct 16778/17000
class 1 clustering acc 0.4673529411764706: correct 1589/3400
Epoch: 41, train_loss: 0.1300, train_clustering_loss:  0.2841, train_error: 0.0259
class 0: acc 1.0, correct 76/76
class 1: acc 0.9230769230769231, correct 84/91
class 2: acc 0.967032967032967, correct 88/91
class 3: acc 0.9880952380952381, correct 83/84
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.3471, val_error: 0.3600, auc: 0.8634
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.3475: correct 139/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0128, instance_loss: 0.0622, weighted_loss: 0.0276, label: 0, bag_size: 1517
batch 39, loss: 0.0245, instance_loss: 0.2903, weighted_loss: 0.1042, label: 4, bag_size: 590
batch 59, loss: 0.0486, instance_loss: 0.2301, weighted_loss: 0.1031, label: 2, bag_size: 589
batch 79, loss: 0.0242, instance_loss: 0.3726, weighted_loss: 0.1287, label: 2, bag_size: 1215
batch 99, loss: 0.0182, instance_loss: 0.0721, weighted_loss: 0.0344, label: 3, bag_size: 1069
batch 119, loss: 0.0010, instance_loss: 0.0450, weighted_loss: 0.0142, label: 0, bag_size: 518
batch 139, loss: 0.0053, instance_loss: 0.6043, weighted_loss: 0.1850, label: 4, bag_size: 542
batch 159, loss: 0.0198, instance_loss: 0.6193, weighted_loss: 0.1996, label: 3, bag_size: 630
batch 179, loss: 0.0034, instance_loss: 0.0499, weighted_loss: 0.0173, label: 0, bag_size: 729
batch 199, loss: 0.0497, instance_loss: 0.2824, weighted_loss: 0.1195, label: 1, bag_size: 533
batch 219, loss: 0.0691, instance_loss: 0.2411, weighted_loss: 0.1207, label: 2, bag_size: 469
batch 239, loss: 0.0938, instance_loss: 0.4133, weighted_loss: 0.1896, label: 3, bag_size: 607
batch 259, loss: 0.0000, instance_loss: 0.0459, weighted_loss: 0.0138, label: 4, bag_size: 729
batch 279, loss: 0.0968, instance_loss: 0.2162, weighted_loss: 0.1326, label: 0, bag_size: 962
batch 299, loss: 0.0010, instance_loss: 0.4659, weighted_loss: 0.1405, label: 1, bag_size: 700
batch 319, loss: 0.0421, instance_loss: 0.1020, weighted_loss: 0.0601, label: 4, bag_size: 773
batch 339, loss: 0.2359, instance_loss: 0.5467, weighted_loss: 0.3292, label: 3, bag_size: 281
batch 359, loss: 0.0035, instance_loss: 0.0312, weighted_loss: 0.0119, label: 0, bag_size: 982
batch 379, loss: 0.0385, instance_loss: 0.4896, weighted_loss: 0.1738, label: 2, bag_size: 1119
batch 399, loss: 0.2979, instance_loss: 0.4932, weighted_loss: 0.3565, label: 3, bag_size: 1250
batch 419, loss: 0.0089, instance_loss: 0.3518, weighted_loss: 0.1117, label: 4, bag_size: 729


class 0 clustering acc 0.984764705882353: correct 16741/17000
class 1 clustering acc 0.46205882352941174: correct 1571/3400
Epoch: 42, train_loss: 0.1543, train_clustering_loss:  0.3068, train_error: 0.0447
class 0: acc 0.9876543209876543, correct 80/81
class 1: acc 0.881578947368421, correct 67/76
class 2: acc 0.90625, correct 87/96
class 3: acc 1.0, correct 77/77
class 4: acc 1.0, correct 95/95

Val Set, val_loss: 1.3667, val_error: 0.4000, auc: 0.8688
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.305: correct 122/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4375, correct 7/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0199, instance_loss: 0.1077, weighted_loss: 0.0462, label: 3, bag_size: 729
batch 39, loss: 0.0131, instance_loss: 0.3289, weighted_loss: 0.1079, label: 2, bag_size: 600
batch 59, loss: 0.0001, instance_loss: 0.1007, weighted_loss: 0.0303, label: 4, bag_size: 729
batch 79, loss: 0.0135, instance_loss: 0.2084, weighted_loss: 0.0720, label: 0, bag_size: 1332
batch 99, loss: 0.1698, instance_loss: 0.2168, weighted_loss: 0.1839, label: 2, bag_size: 1019
batch 119, loss: 0.0262, instance_loss: 0.1337, weighted_loss: 0.0584, label: 1, bag_size: 369
batch 139, loss: 0.0266, instance_loss: 0.1556, weighted_loss: 0.0653, label: 2, bag_size: 399
batch 159, loss: 0.0083, instance_loss: 0.4797, weighted_loss: 0.1497, label: 2, bag_size: 324
batch 179, loss: 0.0454, instance_loss: 0.1496, weighted_loss: 0.0767, label: 4, bag_size: 790
batch 199, loss: 0.0230, instance_loss: 0.0673, weighted_loss: 0.0363, label: 3, bag_size: 1399
batch 219, loss: 0.0008, instance_loss: 0.1723, weighted_loss: 0.0523, label: 4, bag_size: 754
batch 239, loss: 0.1554, instance_loss: 0.4165, weighted_loss: 0.2338, label: 4, bag_size: 524
batch 259, loss: 0.0171, instance_loss: 0.2465, weighted_loss: 0.0859, label: 2, bag_size: 809
batch 279, loss: 0.2304, instance_loss: 0.6153, weighted_loss: 0.3459, label: 1, bag_size: 535
batch 299, loss: 0.0529, instance_loss: 0.4883, weighted_loss: 0.1835, label: 2, bag_size: 518
batch 319, loss: 0.0799, instance_loss: 0.4946, weighted_loss: 0.2043, label: 1, bag_size: 1390
batch 339, loss: 0.0314, instance_loss: 0.2570, weighted_loss: 0.0991, label: 0, bag_size: 1332
batch 359, loss: 0.0994, instance_loss: 0.1406, weighted_loss: 0.1117, label: 0, bag_size: 807
batch 379, loss: 0.0564, instance_loss: 0.1714, weighted_loss: 0.0909, label: 1, bag_size: 1325
batch 399, loss: 0.0008, instance_loss: 0.0323, weighted_loss: 0.0102, label: 4, bag_size: 729
batch 419, loss: 0.0118, instance_loss: 0.2023, weighted_loss: 0.0689, label: 3, bag_size: 729


class 0 clustering acc 0.9867058823529412: correct 16774/17000
class 1 clustering acc 0.48764705882352943: correct 1658/3400
Epoch: 43, train_loss: 0.1416, train_clustering_loss:  0.2887, train_error: 0.0424
class 0: acc 0.9736842105263158, correct 74/76
class 1: acc 0.918918918918919, correct 68/74
class 2: acc 0.9090909090909091, correct 90/99
class 3: acc 0.9879518072289156, correct 82/83
class 4: acc 1.0, correct 93/93

Val Set, val_loss: 1.3845, val_error: 0.4000, auc: 0.8532
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.355: correct 142/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.3810, instance_loss: 0.3274, weighted_loss: 0.3649, label: 2, bag_size: 748
batch 39, loss: 0.2455, instance_loss: 0.1241, weighted_loss: 0.2091, label: 3, bag_size: 1177
batch 59, loss: 0.0003, instance_loss: 0.0768, weighted_loss: 0.0232, label: 4, bag_size: 729
batch 79, loss: 0.0914, instance_loss: 0.4231, weighted_loss: 0.1909, label: 4, bag_size: 366
batch 99, loss: 0.1753, instance_loss: 0.2097, weighted_loss: 0.1856, label: 0, bag_size: 718
batch 119, loss: 0.0039, instance_loss: 0.2584, weighted_loss: 0.0803, label: 2, bag_size: 252
batch 139, loss: 0.1317, instance_loss: 0.4575, weighted_loss: 0.2294, label: 3, bag_size: 281
batch 159, loss: 0.3414, instance_loss: 0.5932, weighted_loss: 0.4169, label: 1, bag_size: 936
batch 179, loss: 0.2376, instance_loss: 0.7809, weighted_loss: 0.4006, label: 2, bag_size: 1231
batch 199, loss: 0.0198, instance_loss: 0.1075, weighted_loss: 0.0461, label: 0, bag_size: 478
batch 219, loss: 0.0039, instance_loss: 0.0433, weighted_loss: 0.0157, label: 0, bag_size: 1034
batch 239, loss: 0.1774, instance_loss: 0.3902, weighted_loss: 0.2412, label: 1, bag_size: 1273
batch 259, loss: 0.0095, instance_loss: 0.3698, weighted_loss: 0.1176, label: 4, bag_size: 675
batch 279, loss: 0.0407, instance_loss: 0.3078, weighted_loss: 0.1208, label: 4, bag_size: 1331
batch 299, loss: 0.0002, instance_loss: 0.0226, weighted_loss: 0.0069, label: 4, bag_size: 729
batch 319, loss: 0.2361, instance_loss: 0.4158, weighted_loss: 0.2900, label: 3, bag_size: 305
batch 339, loss: 0.0430, instance_loss: 0.1321, weighted_loss: 0.0697, label: 0, bag_size: 340
batch 359, loss: 0.0071, instance_loss: 0.0600, weighted_loss: 0.0230, label: 1, bag_size: 369
batch 379, loss: 0.0338, instance_loss: 0.2307, weighted_loss: 0.0929, label: 0, bag_size: 350
batch 399, loss: 0.0149, instance_loss: 0.0845, weighted_loss: 0.0358, label: 3, bag_size: 729
batch 419, loss: 0.0557, instance_loss: 0.6265, weighted_loss: 0.2270, label: 3, bag_size: 630


class 0 clustering acc 0.9873529411764705: correct 16785/17000
class 1 clustering acc 0.4811764705882353: correct 1636/3400
Epoch: 44, train_loss: 0.1709, train_clustering_loss:  0.2863, train_error: 0.0400
class 0: acc 0.963855421686747, correct 80/83
class 1: acc 0.9565217391304348, correct 88/92
class 2: acc 0.8913043478260869, correct 82/92
class 3: acc 1.0, correct 77/77
class 4: acc 1.0, correct 81/81

Val Set, val_loss: 1.4075, val_error: 0.3600, auc: 0.8632
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.355: correct 142/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.0064, instance_loss: 0.0859, weighted_loss: 0.0303, label: 0, bag_size: 729
batch 39, loss: 0.0683, instance_loss: 0.2736, weighted_loss: 0.1299, label: 3, bag_size: 343
batch 59, loss: 0.0072, instance_loss: 0.1845, weighted_loss: 0.0604, label: 0, bag_size: 424
batch 79, loss: 0.0012, instance_loss: 0.0262, weighted_loss: 0.0087, label: 0, bag_size: 898
batch 99, loss: 0.0092, instance_loss: 0.3001, weighted_loss: 0.0965, label: 3, bag_size: 821
batch 119, loss: 0.0021, instance_loss: 0.0284, weighted_loss: 0.0100, label: 0, bag_size: 524
batch 139, loss: 0.1696, instance_loss: 0.4472, weighted_loss: 0.2529, label: 2, bag_size: 355
batch 159, loss: 0.0201, instance_loss: 0.0916, weighted_loss: 0.0415, label: 3, bag_size: 305
batch 179, loss: 0.0002, instance_loss: 0.0890, weighted_loss: 0.0269, label: 4, bag_size: 729
batch 199, loss: 0.0230, instance_loss: 0.7064, weighted_loss: 0.2280, label: 2, bag_size: 324
batch 219, loss: 0.0002, instance_loss: 0.0701, weighted_loss: 0.0212, label: 1, bag_size: 847
batch 239, loss: 0.0059, instance_loss: 0.5232, weighted_loss: 0.1611, label: 3, bag_size: 1167
batch 259, loss: 0.0077, instance_loss: 0.1935, weighted_loss: 0.0634, label: 4, bag_size: 524
batch 279, loss: 0.0013, instance_loss: 0.0506, weighted_loss: 0.0161, label: 0, bag_size: 524
batch 299, loss: 0.0196, instance_loss: 0.1561, weighted_loss: 0.0605, label: 0, bag_size: 350
batch 319, loss: 0.0086, instance_loss: 0.0797, weighted_loss: 0.0300, label: 3, bag_size: 1118
batch 339, loss: 0.0042, instance_loss: 0.0706, weighted_loss: 0.0241, label: 4, bag_size: 773
batch 359, loss: 0.0245, instance_loss: 0.1991, weighted_loss: 0.0769, label: 3, bag_size: 533
batch 379, loss: 0.2218, instance_loss: 0.4678, weighted_loss: 0.2956, label: 1, bag_size: 1273
batch 399, loss: 0.0105, instance_loss: 0.2785, weighted_loss: 0.0909, label: 3, bag_size: 821
batch 419, loss: 2.7915, instance_loss: 0.7624, weighted_loss: 2.1828, label: 2, bag_size: 758


class 0 clustering acc 0.9872352941176471: correct 16783/17000
class 1 clustering acc 0.49: correct 1666/3400
Epoch: 45, train_loss: 0.1756, train_clustering_loss:  0.2868, train_error: 0.0447
class 0: acc 0.9655172413793104, correct 84/87
class 1: acc 0.9659090909090909, correct 85/88
class 2: acc 0.872093023255814, correct 75/86
class 3: acc 0.9888888888888889, correct 89/90
class 4: acc 0.9864864864864865, correct 73/74

Val Set, val_loss: 1.5216, val_error: 0.3800, auc: 0.8480
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4375, correct 7/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0017, instance_loss: 0.1226, weighted_loss: 0.0380, label: 1, bag_size: 1376
batch 39, loss: 0.4753, instance_loss: 0.6080, weighted_loss: 0.5151, label: 2, bag_size: 248
batch 59, loss: 0.1459, instance_loss: 0.6944, weighted_loss: 0.3104, label: 1, bag_size: 1390
batch 79, loss: 0.1489, instance_loss: 0.2204, weighted_loss: 0.1703, label: 0, bag_size: 736
batch 99, loss: 0.7706, instance_loss: 0.5961, weighted_loss: 0.7182, label: 2, bag_size: 1378
batch 119, loss: 0.0003, instance_loss: 0.2378, weighted_loss: 0.0716, label: 4, bag_size: 729
batch 139, loss: 0.1253, instance_loss: 0.6522, weighted_loss: 0.2834, label: 2, bag_size: 1119
batch 159, loss: 0.0014, instance_loss: 0.0239, weighted_loss: 0.0082, label: 3, bag_size: 729
batch 179, loss: 0.0230, instance_loss: 0.4628, weighted_loss: 0.1549, label: 3, bag_size: 630
batch 199, loss: 0.0071, instance_loss: 0.0647, weighted_loss: 0.0244, label: 0, bag_size: 729
batch 219, loss: 0.0019, instance_loss: 0.1941, weighted_loss: 0.0596, label: 3, bag_size: 821
batch 239, loss: 0.1520, instance_loss: 0.3642, weighted_loss: 0.2156, label: 1, bag_size: 598
batch 259, loss: 0.0263, instance_loss: 0.2204, weighted_loss: 0.0846, label: 1, bag_size: 944
batch 279, loss: 0.0049, instance_loss: 0.2506, weighted_loss: 0.0786, label: 1, bag_size: 474
batch 299, loss: 0.0868, instance_loss: 0.1741, weighted_loss: 0.1130, label: 4, bag_size: 790
batch 319, loss: 0.0387, instance_loss: 0.3693, weighted_loss: 0.1379, label: 1, bag_size: 818
batch 339, loss: 0.0057, instance_loss: 0.3275, weighted_loss: 0.1023, label: 4, bag_size: 656
batch 359, loss: 0.1473, instance_loss: 0.2452, weighted_loss: 0.1767, label: 2, bag_size: 323
batch 379, loss: 0.0689, instance_loss: 0.3584, weighted_loss: 0.1557, label: 2, bag_size: 1404
batch 399, loss: 0.3469, instance_loss: 0.5946, weighted_loss: 0.4212, label: 2, bag_size: 1133
batch 419, loss: 0.0418, instance_loss: 0.6121, weighted_loss: 0.2129, label: 1, bag_size: 1390


class 0 clustering acc 0.989: correct 16813/17000
class 1 clustering acc 0.5126470588235295: correct 1743/3400
Epoch: 46, train_loss: 0.0936, train_clustering_loss:  0.2663, train_error: 0.0188
class 0: acc 0.9871794871794872, correct 77/78
class 1: acc 0.9489795918367347, correct 93/98
class 2: acc 0.9696969696969697, correct 64/66
class 3: acc 1.0, correct 100/100
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.4032, val_error: 0.3400, auc: 0.8675
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.375: correct 150/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0329, weighted_loss: 0.0099, label: 4, bag_size: 729
batch 39, loss: 0.0026, instance_loss: 0.1238, weighted_loss: 0.0390, label: 3, bag_size: 1019
batch 59, loss: 0.0026, instance_loss: 0.5665, weighted_loss: 0.1717, label: 3, bag_size: 1380
batch 79, loss: 0.0191, instance_loss: 0.1951, weighted_loss: 0.0719, label: 2, bag_size: 1050
batch 99, loss: 0.0069, instance_loss: 0.1869, weighted_loss: 0.0609, label: 4, bag_size: 826
batch 119, loss: 0.0065, instance_loss: 0.2611, weighted_loss: 0.0829, label: 4, bag_size: 729
batch 139, loss: 0.1027, instance_loss: 0.2838, weighted_loss: 0.1570, label: 4, bag_size: 590
batch 159, loss: 0.0251, instance_loss: 0.1669, weighted_loss: 0.0676, label: 2, bag_size: 1039
batch 179, loss: 0.0001, instance_loss: 0.3948, weighted_loss: 0.1185, label: 4, bag_size: 663
batch 199, loss: 0.0059, instance_loss: 0.1744, weighted_loss: 0.0565, label: 4, bag_size: 1278
batch 219, loss: 0.1557, instance_loss: 0.1221, weighted_loss: 0.1456, label: 3, bag_size: 729
batch 239, loss: 0.0051, instance_loss: 0.0509, weighted_loss: 0.0188, label: 0, bag_size: 1255
batch 259, loss: 0.0049, instance_loss: 0.6107, weighted_loss: 0.1867, label: 3, bag_size: 1380
batch 279, loss: 0.0004, instance_loss: 0.0204, weighted_loss: 0.0064, label: 0, bag_size: 402
batch 299, loss: 0.0081, instance_loss: 0.1300, weighted_loss: 0.0447, label: 4, bag_size: 773
batch 319, loss: 0.0087, instance_loss: 0.3277, weighted_loss: 0.1044, label: 4, bag_size: 656
batch 339, loss: 0.0146, instance_loss: 0.1607, weighted_loss: 0.0585, label: 4, bag_size: 1002
batch 359, loss: 0.0024, instance_loss: 0.0314, weighted_loss: 0.0111, label: 4, bag_size: 764
batch 379, loss: 0.0004, instance_loss: 0.0288, weighted_loss: 0.0089, label: 0, bag_size: 898
batch 399, loss: 0.0101, instance_loss: 0.1177, weighted_loss: 0.0424, label: 1, bag_size: 1651
batch 419, loss: 0.0006, instance_loss: 0.0756, weighted_loss: 0.0231, label: 4, bag_size: 729


class 0 clustering acc 0.9872352941176471: correct 16783/17000
class 1 clustering acc 0.5147058823529411: correct 1750/3400
Epoch: 47, train_loss: 0.1043, train_clustering_loss:  0.2671, train_error: 0.0235
class 0: acc 0.987012987012987, correct 76/77
class 1: acc 0.9518072289156626, correct 79/83
class 2: acc 0.9397590361445783, correct 78/83
class 3: acc 1.0, correct 93/93
class 4: acc 1.0, correct 89/89

Val Set, val_loss: 1.4326, val_error: 0.3600, auc: 0.8631
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.38: correct 152/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.0026, instance_loss: 0.0301, weighted_loss: 0.0108, label: 0, bag_size: 602
batch 39, loss: 0.0989, instance_loss: 0.3758, weighted_loss: 0.1820, label: 3, bag_size: 305
batch 59, loss: 0.1070, instance_loss: 0.4945, weighted_loss: 0.2233, label: 3, bag_size: 281
batch 79, loss: 0.0202, instance_loss: 0.0766, weighted_loss: 0.0371, label: 3, bag_size: 729
batch 99, loss: 0.1605, instance_loss: 0.3021, weighted_loss: 0.2030, label: 2, bag_size: 878
batch 119, loss: 0.7292, instance_loss: 0.3699, weighted_loss: 0.6214, label: 0, bag_size: 729
batch 139, loss: 0.0000, instance_loss: 0.0296, weighted_loss: 0.0089, label: 4, bag_size: 729
batch 159, loss: 0.0016, instance_loss: 0.1681, weighted_loss: 0.0515, label: 3, bag_size: 821
batch 179, loss: 0.0014, instance_loss: 0.1567, weighted_loss: 0.0480, label: 0, bag_size: 729
batch 199, loss: 0.0000, instance_loss: 0.2340, weighted_loss: 0.0702, label: 1, bag_size: 1127
batch 219, loss: 0.0039, instance_loss: 0.2483, weighted_loss: 0.0772, label: 0, bag_size: 552
batch 239, loss: 0.0625, instance_loss: 0.4344, weighted_loss: 0.1741, label: 3, bag_size: 706
batch 259, loss: 0.0089, instance_loss: 0.1144, weighted_loss: 0.0405, label: 1, bag_size: 886
batch 279, loss: 0.0192, instance_loss: 0.1263, weighted_loss: 0.0513, label: 3, bag_size: 451
batch 299, loss: 0.9749, instance_loss: 0.6643, weighted_loss: 0.8817, label: 1, bag_size: 446
batch 319, loss: 0.0077, instance_loss: 0.1680, weighted_loss: 0.0558, label: 4, bag_size: 646
batch 339, loss: 0.0692, instance_loss: 0.5608, weighted_loss: 0.2167, label: 2, bag_size: 248
batch 359, loss: 0.0026, instance_loss: 0.0559, weighted_loss: 0.0186, label: 0, bag_size: 921
batch 379, loss: 0.0198, instance_loss: 0.5108, weighted_loss: 0.1671, label: 3, bag_size: 317
batch 399, loss: 0.0256, instance_loss: 0.5890, weighted_loss: 0.1947, label: 1, bag_size: 778
batch 419, loss: 0.0126, instance_loss: 0.1235, weighted_loss: 0.0458, label: 4, bag_size: 790


class 0 clustering acc 0.9851764705882353: correct 16748/17000
class 1 clustering acc 0.4697058823529412: correct 1597/3400
Epoch: 48, train_loss: 0.1738, train_clustering_loss:  0.3016, train_error: 0.0447
class 0: acc 0.9367088607594937, correct 74/79
class 1: acc 0.9390243902439024, correct 77/82
class 2: acc 0.9347826086956522, correct 86/92
class 3: acc 0.9753086419753086, correct 79/81
class 4: acc 0.989010989010989, correct 90/91

Val Set, val_loss: 1.6019, val_error: 0.3800, auc: 0.8583
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.3475: correct 139/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.8, correct 4/5
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.0023, instance_loss: 0.1768, weighted_loss: 0.0546, label: 4, bag_size: 636
batch 39, loss: 0.0045, instance_loss: 0.0840, weighted_loss: 0.0283, label: 4, bag_size: 1278
batch 59, loss: 0.0029, instance_loss: 0.1190, weighted_loss: 0.0377, label: 4, bag_size: 646
batch 79, loss: 0.0661, instance_loss: 0.1791, weighted_loss: 0.1000, label: 2, bag_size: 405
batch 99, loss: 0.4545, instance_loss: 0.4064, weighted_loss: 0.4400, label: 0, bag_size: 1257
batch 119, loss: 0.0003, instance_loss: 0.0390, weighted_loss: 0.0119, label: 3, bag_size: 729
batch 139, loss: 0.0999, instance_loss: 0.3650, weighted_loss: 0.1794, label: 2, bag_size: 1385
batch 159, loss: 0.0247, instance_loss: 0.0824, weighted_loss: 0.0420, label: 3, bag_size: 1399
batch 179, loss: 0.0618, instance_loss: 0.1362, weighted_loss: 0.0841, label: 0, bag_size: 602
batch 199, loss: 0.1064, instance_loss: 0.4323, weighted_loss: 0.2042, label: 4, bag_size: 436
batch 219, loss: 0.0391, instance_loss: 0.1817, weighted_loss: 0.0819, label: 4, bag_size: 928
batch 239, loss: 0.0010, instance_loss: 0.0824, weighted_loss: 0.0255, label: 4, bag_size: 764
batch 259, loss: 0.0036, instance_loss: 0.0647, weighted_loss: 0.0219, label: 3, bag_size: 1177
batch 279, loss: 0.0234, instance_loss: 0.2225, weighted_loss: 0.0831, label: 2, bag_size: 1050
batch 299, loss: 0.0005, instance_loss: 0.0480, weighted_loss: 0.0148, label: 1, bag_size: 1239
batch 319, loss: 0.0524, instance_loss: 0.1065, weighted_loss: 0.0686, label: 3, bag_size: 1118
batch 339, loss: 0.0059, instance_loss: 0.4109, weighted_loss: 0.1274, label: 4, bag_size: 663
batch 359, loss: 0.0539, instance_loss: 0.2689, weighted_loss: 0.1184, label: 2, bag_size: 265
batch 379, loss: 0.0015, instance_loss: 0.0937, weighted_loss: 0.0291, label: 3, bag_size: 305
batch 399, loss: 0.0101, instance_loss: 0.0920, weighted_loss: 0.0347, label: 0, bag_size: 367
batch 419, loss: 0.0028, instance_loss: 0.0376, weighted_loss: 0.0132, label: 0, bag_size: 1135


class 0 clustering acc 0.9882352941176471: correct 16800/17000
class 1 clustering acc 0.4814705882352941: correct 1637/3400
Epoch: 49, train_loss: 0.1436, train_clustering_loss:  0.2808, train_error: 0.0471
class 0: acc 0.975, correct 78/80
class 1: acc 0.9390243902439024, correct 77/82
class 2: acc 0.8539325842696629, correct 76/89
class 3: acc 1.0, correct 86/86
class 4: acc 1.0, correct 88/88

Val Set, val_loss: 1.6230, val_error: 0.3600, auc: 0.8550
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.3425: correct 137/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.8, correct 12/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.0117, instance_loss: 0.2500, weighted_loss: 0.0832, label: 1, bag_size: 1402
batch 39, loss: 0.0309, instance_loss: 0.4296, weighted_loss: 0.1505, label: 1, bag_size: 1144
batch 59, loss: 0.0009, instance_loss: 0.0307, weighted_loss: 0.0098, label: 0, bag_size: 402
batch 79, loss: 0.0285, instance_loss: 0.3428, weighted_loss: 0.1228, label: 3, bag_size: 360
batch 99, loss: 0.5026, instance_loss: 0.5771, weighted_loss: 0.5249, label: 2, bag_size: 272
batch 119, loss: 0.1012, instance_loss: 0.6549, weighted_loss: 0.2673, label: 1, bag_size: 448
batch 139, loss: 0.0018, instance_loss: 0.1098, weighted_loss: 0.0342, label: 3, bag_size: 849
batch 159, loss: 0.1092, instance_loss: 0.5264, weighted_loss: 0.2344, label: 1, bag_size: 308
batch 179, loss: 0.0017, instance_loss: 0.0361, weighted_loss: 0.0120, label: 0, bag_size: 729
batch 199, loss: 0.0029, instance_loss: 0.1156, weighted_loss: 0.0367, label: 1, bag_size: 834
batch 219, loss: 0.2142, instance_loss: 0.2909, weighted_loss: 0.2372, label: 2, bag_size: 1404
batch 239, loss: 0.0403, instance_loss: 0.2445, weighted_loss: 0.1015, label: 2, bag_size: 408
batch 259, loss: 0.0161, instance_loss: 0.1665, weighted_loss: 0.0612, label: 2, bag_size: 461
batch 279, loss: 0.0818, instance_loss: 0.4759, weighted_loss: 0.2001, label: 2, bag_size: 373
batch 299, loss: 0.0008, instance_loss: 0.2837, weighted_loss: 0.0857, label: 3, bag_size: 791
batch 319, loss: 0.2431, instance_loss: 0.6019, weighted_loss: 0.3507, label: 3, bag_size: 281
batch 339, loss: 0.0033, instance_loss: 0.0807, weighted_loss: 0.0265, label: 0, bag_size: 524
batch 359, loss: 0.0120, instance_loss: 0.0773, weighted_loss: 0.0316, label: 3, bag_size: 729
batch 379, loss: 0.0021, instance_loss: 0.0293, weighted_loss: 0.0103, label: 0, bag_size: 1174
batch 399, loss: 0.0280, instance_loss: 0.2319, weighted_loss: 0.0892, label: 2, bag_size: 1050
batch 419, loss: 0.0019, instance_loss: 0.1947, weighted_loss: 0.0597, label: 4, bag_size: 675


class 0 clustering acc 0.9885882352941177: correct 16806/17000
class 1 clustering acc 0.5067647058823529: correct 1723/3400
Epoch: 50, train_loss: 0.0944, train_clustering_loss:  0.2757, train_error: 0.0188
class 0: acc 0.9868421052631579, correct 75/76
class 1: acc 0.978021978021978, correct 89/91
class 2: acc 0.9518072289156626, correct 79/83
class 3: acc 1.0, correct 89/89
class 4: acc 0.9883720930232558, correct 85/86

Val Set, val_loss: 1.4146, val_error: 0.4000, auc: 0.8600
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.355: correct 142/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 8/16
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.0006, instance_loss: 0.2564, weighted_loss: 0.0773, label: 4, bag_size: 388
batch 39, loss: 0.0042, instance_loss: 0.0378, weighted_loss: 0.0143, label: 3, bag_size: 729
batch 59, loss: 0.0075, instance_loss: 0.1040, weighted_loss: 0.0365, label: 3, bag_size: 1019
batch 79, loss: 0.0139, instance_loss: 0.6977, weighted_loss: 0.2191, label: 3, bag_size: 1380
batch 99, loss: 0.0001, instance_loss: 0.0974, weighted_loss: 0.0293, label: 4, bag_size: 729
batch 119, loss: 0.0203, instance_loss: 0.2015, weighted_loss: 0.0746, label: 1, bag_size: 288
batch 139, loss: 0.2284, instance_loss: 0.5582, weighted_loss: 0.3274, label: 2, bag_size: 1133
batch 159, loss: 0.0034, instance_loss: 0.1500, weighted_loss: 0.0474, label: 0, bag_size: 1332
batch 179, loss: 0.0038, instance_loss: 0.2218, weighted_loss: 0.0692, label: 0, bag_size: 552
batch 199, loss: 1.4223, instance_loss: 0.8192, weighted_loss: 1.2414, label: 2, bag_size: 194
batch 219, loss: 0.0021, instance_loss: 0.0449, weighted_loss: 0.0150, label: 0, bag_size: 729
batch 239, loss: 0.0192, instance_loss: 0.0390, weighted_loss: 0.0251, label: 3, bag_size: 1399
batch 259, loss: 0.0212, instance_loss: 0.3333, weighted_loss: 0.1148, label: 2, bag_size: 1218
batch 279, loss: 0.1478, instance_loss: 0.4959, weighted_loss: 0.2523, label: 1, bag_size: 1273
batch 299, loss: 0.0240, instance_loss: 0.4565, weighted_loss: 0.1538, label: 2, bag_size: 373
batch 319, loss: 0.0030, instance_loss: 0.0662, weighted_loss: 0.0220, label: 3, bag_size: 729
batch 339, loss: 0.0041, instance_loss: 0.0428, weighted_loss: 0.0157, label: 0, bag_size: 729
batch 359, loss: 0.0285, instance_loss: 0.2561, weighted_loss: 0.0968, label: 4, bag_size: 1278
batch 379, loss: 0.0382, instance_loss: 0.2217, weighted_loss: 0.0932, label: 2, bag_size: 391
batch 399, loss: 0.0084, instance_loss: 0.1638, weighted_loss: 0.0550, label: 1, bag_size: 288
batch 419, loss: 0.0356, instance_loss: 0.1216, weighted_loss: 0.0614, label: 4, bag_size: 790


class 0 clustering acc 0.9874705882352941: correct 16787/17000
class 1 clustering acc 0.5264705882352941: correct 1790/3400
Epoch: 51, train_loss: 0.0916, train_clustering_loss:  0.2717, train_error: 0.0212
class 0: acc 0.9795918367346939, correct 96/98
class 1: acc 0.9864864864864865, correct 73/74
class 2: acc 0.9411764705882353, correct 80/85
class 3: acc 0.9900990099009901, correct 100/101
class 4: acc 1.0, correct 67/67

Val Set, val_loss: 1.5302, val_error: 0.3600, auc: 0.8551
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.6875, correct 11/16
class 2: acc 0.8, correct 12/15
class 3: acc 0.6, correct 3/5
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 44 out of 20
Early stopping
Val error: 0.4600, ROC AUC: 0.8854
Test error: 0.3000, ROC AUC: 0.8573
class 0: acc 0.8, correct 8/10
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.7391304347826086, correct 17/23
class 3: acc 1.0, correct 2/2
class 4: acc 0.3333333333333333, correct 1/3

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7264, instance_loss: 1.2069, weighted_loss: 1.5705, label: 0, bag_size: 1247
batch 39, loss: 1.7718, instance_loss: 1.1015, weighted_loss: 1.5707, label: 0, bag_size: 729
batch 59, loss: 1.5521, instance_loss: 0.8918, weighted_loss: 1.3540, label: 3, bag_size: 729
batch 79, loss: 1.3230, instance_loss: 0.6992, weighted_loss: 1.1358, label: 2, bag_size: 405
batch 99, loss: 1.5074, instance_loss: 0.5905, weighted_loss: 1.2324, label: 3, bag_size: 360
batch 119, loss: 1.5855, instance_loss: 0.6069, weighted_loss: 1.2919, label: 0, bag_size: 729
batch 139, loss: 1.5901, instance_loss: 0.5692, weighted_loss: 1.2838, label: 2, bag_size: 636
batch 159, loss: 1.7180, instance_loss: 0.5461, weighted_loss: 1.3665, label: 3, bag_size: 729
batch 179, loss: 1.4864, instance_loss: 0.5178, weighted_loss: 1.1958, label: 0, bag_size: 1061
batch 199, loss: 1.5251, instance_loss: 0.5033, weighted_loss: 1.2186, label: 3, bag_size: 791
batch 219, loss: 1.4699, instance_loss: 0.4977, weighted_loss: 1.1783, label: 0, bag_size: 898
batch 239, loss: 1.5483, instance_loss: 0.4977, weighted_loss: 1.2331, label: 3, bag_size: 706
batch 259, loss: 1.5535, instance_loss: 0.5012, weighted_loss: 1.2378, label: 1, bag_size: 913
batch 279, loss: 1.2475, instance_loss: 0.5169, weighted_loss: 1.0283, label: 4, bag_size: 729
batch 299, loss: 1.3632, instance_loss: 0.5059, weighted_loss: 1.1060, label: 0, bag_size: 1133
batch 319, loss: 1.6135, instance_loss: 0.5054, weighted_loss: 1.2810, label: 2, bag_size: 934
batch 339, loss: 1.6775, instance_loss: 0.5236, weighted_loss: 1.3313, label: 0, bag_size: 402
batch 359, loss: 1.7150, instance_loss: 0.5206, weighted_loss: 1.3566, label: 3, bag_size: 697
batch 379, loss: 1.4359, instance_loss: 0.4911, weighted_loss: 1.1524, label: 4, bag_size: 711
batch 399, loss: 1.6056, instance_loss: 0.5096, weighted_loss: 1.2768, label: 3, bag_size: 211
batch 419, loss: 1.4290, instance_loss: 0.5006, weighted_loss: 1.1505, label: 3, bag_size: 305


class 0 clustering acc 0.9928823529411764: correct 16879/17000
class 1 clustering acc 0.009705882352941177: correct 33/3400
Epoch: 0, train_loss: 1.5821, train_clustering_loss:  0.6246, train_error: 0.7388
class 0: acc 0.14814814814814814, correct 12/81
class 1: acc 0.04285714285714286, correct 3/70
class 2: acc 0.46, correct 46/100
class 3: acc 0.18823529411764706, correct 16/85
class 4: acc 0.38202247191011235, correct 34/89

Val Set, val_loss: 1.5288, val_error: 0.5800, auc: 0.7110
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.8421052631578947, correct 16/19
class 3: acc 0.0, correct 0/6
class 4: acc 0.8333333333333334, correct 5/6
Validation loss decreased (inf --> 1.528788).  Saving model ...


batch 19, loss: 1.7606, instance_loss: 0.5283, weighted_loss: 1.3909, label: 1, bag_size: 1390
batch 39, loss: 1.5869, instance_loss: 0.5060, weighted_loss: 1.2627, label: 4, bag_size: 636
batch 59, loss: 1.7265, instance_loss: 0.5322, weighted_loss: 1.3682, label: 1, bag_size: 102
batch 79, loss: 1.1410, instance_loss: 0.4503, weighted_loss: 0.9338, label: 2, bag_size: 237
batch 99, loss: 1.1800, instance_loss: 0.4979, weighted_loss: 0.9754, label: 4, bag_size: 729
batch 119, loss: 1.6007, instance_loss: 0.5307, weighted_loss: 1.2797, label: 1, bag_size: 504
batch 139, loss: 1.2433, instance_loss: 0.5014, weighted_loss: 1.0207, label: 1, bag_size: 1191
batch 159, loss: 1.4114, instance_loss: 0.4880, weighted_loss: 1.1344, label: 1, bag_size: 866
batch 179, loss: 1.3866, instance_loss: 0.4802, weighted_loss: 1.1147, label: 1, bag_size: 448
batch 199, loss: 1.6734, instance_loss: 0.5435, weighted_loss: 1.3344, label: 0, bag_size: 338
batch 219, loss: 1.2145, instance_loss: 0.4911, weighted_loss: 0.9975, label: 0, bag_size: 381
batch 239, loss: 1.7426, instance_loss: 0.5181, weighted_loss: 1.3753, label: 2, bag_size: 687
batch 259, loss: 1.3980, instance_loss: 0.5086, weighted_loss: 1.1312, label: 0, bag_size: 760
batch 279, loss: 1.3276, instance_loss: 0.4851, weighted_loss: 1.0748, label: 3, bag_size: 841
batch 299, loss: 1.4090, instance_loss: 0.5045, weighted_loss: 1.1377, label: 0, bag_size: 338
batch 319, loss: 1.3357, instance_loss: 0.4743, weighted_loss: 1.0773, label: 3, bag_size: 729
batch 339, loss: 1.5524, instance_loss: 0.4832, weighted_loss: 1.2317, label: 1, bag_size: 913
batch 359, loss: 1.5686, instance_loss: 0.4935, weighted_loss: 1.2461, label: 1, bag_size: 1144
batch 379, loss: 1.1603, instance_loss: 0.4518, weighted_loss: 0.9477, label: 2, bag_size: 795
batch 399, loss: 1.1331, instance_loss: 0.4480, weighted_loss: 0.9276, label: 2, bag_size: 883
batch 419, loss: 1.1483, instance_loss: 0.4785, weighted_loss: 0.9474, label: 0, bag_size: 982


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4637, train_clustering_loss:  0.4999, train_error: 0.5929
class 0: acc 0.34831460674157305, correct 31/89
class 1: acc 0.30666666666666664, correct 23/75
class 2: acc 0.5833333333333334, correct 56/96
class 3: acc 0.25609756097560976, correct 21/82
class 4: acc 0.5060240963855421, correct 42/83

Val Set, val_loss: 1.4221, val_error: 0.5000, auc: 0.7443
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/10
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.8947368421052632, correct 17/19
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6666666666666666, correct 4/6
Validation loss decreased (1.528788 --> 1.422060).  Saving model ...


batch 19, loss: 1.4614, instance_loss: 0.4681, weighted_loss: 1.1634, label: 2, bag_size: 537
batch 39, loss: 1.3400, instance_loss: 0.4981, weighted_loss: 1.0874, label: 0, bag_size: 729
batch 59, loss: 1.1600, instance_loss: 0.5076, weighted_loss: 0.9642, label: 4, bag_size: 729
batch 79, loss: 1.4423, instance_loss: 0.4948, weighted_loss: 1.1581, label: 0, bag_size: 729
batch 99, loss: 1.6020, instance_loss: 0.4905, weighted_loss: 1.2686, label: 2, bag_size: 1215
batch 119, loss: 1.1664, instance_loss: 0.4390, weighted_loss: 0.9482, label: 2, bag_size: 511
batch 139, loss: 1.3854, instance_loss: 0.4845, weighted_loss: 1.1151, label: 3, bag_size: 729
batch 159, loss: 1.0635, instance_loss: 0.4588, weighted_loss: 0.8821, label: 1, bag_size: 1127
batch 179, loss: 1.7790, instance_loss: 0.5561, weighted_loss: 1.4121, label: 2, bag_size: 358
batch 199, loss: 1.2854, instance_loss: 0.4913, weighted_loss: 1.0472, label: 3, bag_size: 1380
batch 219, loss: 1.8056, instance_loss: 0.5468, weighted_loss: 1.4279, label: 1, bag_size: 377
batch 239, loss: 1.9390, instance_loss: 0.5459, weighted_loss: 1.5211, label: 1, bag_size: 1376
batch 259, loss: 1.4915, instance_loss: 0.4900, weighted_loss: 1.1911, label: 1, bag_size: 1724
batch 279, loss: 1.6365, instance_loss: 0.4879, weighted_loss: 1.2919, label: 2, bag_size: 943
batch 299, loss: 1.4138, instance_loss: 0.4915, weighted_loss: 1.1371, label: 2, bag_size: 863
batch 319, loss: 1.8602, instance_loss: 0.5389, weighted_loss: 1.4638, label: 1, bag_size: 308
batch 339, loss: 1.3095, instance_loss: 0.4747, weighted_loss: 1.0591, label: 1, bag_size: 1646
batch 359, loss: 0.9949, instance_loss: 0.4505, weighted_loss: 0.8316, label: 0, bag_size: 446
batch 379, loss: 0.6880, instance_loss: 0.4195, weighted_loss: 0.6074, label: 0, bag_size: 1143
batch 399, loss: 1.1261, instance_loss: 0.4617, weighted_loss: 0.9268, label: 1, bag_size: 944
batch 419, loss: 0.5900, instance_loss: 0.3579, weighted_loss: 0.5203, label: 3, bag_size: 305


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.3372, train_clustering_loss:  0.4790, train_error: 0.5318
class 0: acc 0.4772727272727273, correct 42/88
class 1: acc 0.3373493975903614, correct 28/83
class 2: acc 0.38202247191011235, correct 34/89
class 3: acc 0.5833333333333334, correct 49/84
class 4: acc 0.5679012345679012, correct 46/81

Val Set, val_loss: 1.3719, val_error: 0.5600, auc: 0.7862
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.05263157894736842, correct 1/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
Validation loss decreased (1.422060 --> 1.371857).  Saving model ...


batch 19, loss: 1.5875, instance_loss: 0.4965, weighted_loss: 1.2602, label: 2, bag_size: 245
batch 39, loss: 1.5926, instance_loss: 0.5146, weighted_loss: 1.2692, label: 3, bag_size: 671
batch 59, loss: 1.3323, instance_loss: 0.4905, weighted_loss: 1.0798, label: 2, bag_size: 471
batch 79, loss: 1.5014, instance_loss: 0.5245, weighted_loss: 1.2083, label: 2, bag_size: 317
batch 99, loss: 1.1114, instance_loss: 0.4398, weighted_loss: 0.9099, label: 4, bag_size: 1235
batch 119, loss: 1.3929, instance_loss: 0.5054, weighted_loss: 1.1266, label: 2, bag_size: 537
batch 139, loss: 0.8577, instance_loss: 0.4569, weighted_loss: 0.7374, label: 0, bag_size: 962
batch 159, loss: 0.2355, instance_loss: 0.2564, weighted_loss: 0.2418, label: 4, bag_size: 729
batch 179, loss: 1.5487, instance_loss: 0.4989, weighted_loss: 1.2338, label: 1, bag_size: 867
batch 199, loss: 0.8761, instance_loss: 0.3693, weighted_loss: 0.7240, label: 3, bag_size: 533
batch 219, loss: 1.4135, instance_loss: 0.4842, weighted_loss: 1.1347, label: 0, bag_size: 521
batch 239, loss: 0.2344, instance_loss: 0.2368, weighted_loss: 0.2351, label: 4, bag_size: 729
batch 259, loss: 1.3752, instance_loss: 0.5027, weighted_loss: 1.1135, label: 2, bag_size: 1069
batch 279, loss: 0.3690, instance_loss: 0.2898, weighted_loss: 0.3452, label: 3, bag_size: 1172
batch 299, loss: 0.8931, instance_loss: 0.3607, weighted_loss: 0.7334, label: 3, bag_size: 343
batch 319, loss: 1.4734, instance_loss: 0.4342, weighted_loss: 1.1616, label: 3, bag_size: 281
batch 339, loss: 0.7967, instance_loss: 0.4493, weighted_loss: 0.6924, label: 0, bag_size: 760
batch 359, loss: 0.6577, instance_loss: 0.3496, weighted_loss: 0.5653, label: 4, bag_size: 729
batch 379, loss: 1.4572, instance_loss: 0.5396, weighted_loss: 1.1819, label: 2, bag_size: 1404
batch 399, loss: 0.5345, instance_loss: 0.3871, weighted_loss: 0.4903, label: 0, bag_size: 367
batch 419, loss: 0.6100, instance_loss: 0.3624, weighted_loss: 0.5357, label: 3, bag_size: 841


class 0 clustering acc 0.9997058823529412: correct 16995/17000
class 1 clustering acc 0.004411764705882353: correct 15/3400
Epoch: 3, train_loss: 1.1098, train_clustering_loss:  0.4440, train_error: 0.4094
class 0: acc 0.7191011235955056, correct 64/89
class 1: acc 0.5882352941176471, correct 50/85
class 2: acc 0.2261904761904762, correct 19/84
class 3: acc 0.719626168224299, correct 77/107
class 4: acc 0.6833333333333333, correct 41/60

Val Set, val_loss: 1.2342, val_error: 0.4800, auc: 0.8021
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.16666666666666666, correct 1/6
Validation loss decreased (1.371857 --> 1.234239).  Saving model ...


batch 19, loss: 2.0539, instance_loss: 0.6126, weighted_loss: 1.6215, label: 1, bag_size: 1376
batch 39, loss: 1.1398, instance_loss: 0.4467, weighted_loss: 0.9319, label: 1, bag_size: 965
batch 59, loss: 0.2552, instance_loss: 0.2073, weighted_loss: 0.2408, label: 3, bag_size: 305
batch 79, loss: 0.8085, instance_loss: 0.4406, weighted_loss: 0.6981, label: 3, bag_size: 283
batch 99, loss: 0.8121, instance_loss: 0.4781, weighted_loss: 0.7119, label: 3, bag_size: 283
batch 119, loss: 0.4947, instance_loss: 0.4312, weighted_loss: 0.4756, label: 0, bag_size: 729
batch 139, loss: 0.3570, instance_loss: 0.3152, weighted_loss: 0.3445, label: 4, bag_size: 826
batch 159, loss: 0.5666, instance_loss: 0.3818, weighted_loss: 0.5112, label: 4, bag_size: 790
batch 179, loss: 0.4081, instance_loss: 0.4136, weighted_loss: 0.4098, label: 0, bag_size: 1247
batch 199, loss: 1.3671, instance_loss: 0.4668, weighted_loss: 1.0970, label: 3, bag_size: 200
batch 219, loss: 2.0046, instance_loss: 0.5422, weighted_loss: 1.5659, label: 1, bag_size: 887
batch 239, loss: 0.3344, instance_loss: 0.3309, weighted_loss: 0.3334, label: 0, bag_size: 1517
batch 259, loss: 0.5624, instance_loss: 0.3998, weighted_loss: 0.5136, label: 0, bag_size: 367
batch 279, loss: 0.8187, instance_loss: 0.4109, weighted_loss: 0.6964, label: 1, bag_size: 886
batch 299, loss: 1.5230, instance_loss: 0.4279, weighted_loss: 1.1945, label: 3, bag_size: 305
batch 319, loss: 0.0810, instance_loss: 0.1903, weighted_loss: 0.1137, label: 3, bag_size: 1069
batch 339, loss: 0.9542, instance_loss: 0.4594, weighted_loss: 0.8058, label: 2, bag_size: 1039
batch 359, loss: 1.8174, instance_loss: 0.5865, weighted_loss: 1.4482, label: 2, bag_size: 373
batch 379, loss: 0.5996, instance_loss: 0.4144, weighted_loss: 0.5440, label: 0, bag_size: 424
batch 399, loss: 0.9937, instance_loss: 0.4361, weighted_loss: 0.8265, label: 1, bag_size: 1325
batch 419, loss: 0.7764, instance_loss: 0.3998, weighted_loss: 0.6634, label: 2, bag_size: 292


class 0 clustering acc 0.9991764705882353: correct 16986/17000
class 1 clustering acc 0.06529411764705882: correct 222/3400
Epoch: 4, train_loss: 0.9051, train_clustering_loss:  0.4124, train_error: 0.3106
class 0: acc 0.8444444444444444, correct 76/90
class 1: acc 0.43283582089552236, correct 29/67
class 2: acc 0.47058823529411764, correct 40/85
class 3: acc 0.7894736842105263, correct 75/95
class 4: acc 0.8295454545454546, correct 73/88

Val Set, val_loss: 1.1555, val_error: 0.3600, auc: 0.8043
class 0 clustering acc 0.9995: correct 1999/2000
class 1 clustering acc 0.035: correct 14/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
Validation loss decreased (1.234239 --> 1.155508).  Saving model ...


batch 19, loss: 1.6756, instance_loss: 0.4780, weighted_loss: 1.3163, label: 1, bag_size: 838
batch 39, loss: 1.7987, instance_loss: 0.4775, weighted_loss: 1.4024, label: 0, bag_size: 653
batch 59, loss: 1.4603, instance_loss: 0.4133, weighted_loss: 1.1462, label: 1, bag_size: 1273
batch 79, loss: 0.0972, instance_loss: 0.2735, weighted_loss: 0.1501, label: 3, bag_size: 1253
batch 99, loss: 0.9246, instance_loss: 0.4442, weighted_loss: 0.7805, label: 2, bag_size: 262
batch 119, loss: 2.0788, instance_loss: 0.5579, weighted_loss: 1.6225, label: 0, bag_size: 282
batch 139, loss: 0.1737, instance_loss: 0.2921, weighted_loss: 0.2092, label: 4, bag_size: 1278
batch 159, loss: 0.1477, instance_loss: 0.2265, weighted_loss: 0.1714, label: 0, bag_size: 760
batch 179, loss: 0.3566, instance_loss: 0.2575, weighted_loss: 0.3269, label: 3, bag_size: 729
batch 199, loss: 0.3413, instance_loss: 0.3287, weighted_loss: 0.3375, label: 0, bag_size: 1061
batch 219, loss: 0.4410, instance_loss: 0.2257, weighted_loss: 0.3764, label: 3, bag_size: 729
batch 239, loss: 0.1042, instance_loss: 0.2599, weighted_loss: 0.1509, label: 0, bag_size: 729
batch 259, loss: 0.4901, instance_loss: 0.3850, weighted_loss: 0.4586, label: 0, bag_size: 381
batch 279, loss: 1.3385, instance_loss: 0.4711, weighted_loss: 1.0783, label: 2, bag_size: 1197
batch 299, loss: 0.4965, instance_loss: 0.2270, weighted_loss: 0.4156, label: 3, bag_size: 729
batch 319, loss: 0.4660, instance_loss: 0.2645, weighted_loss: 0.4055, label: 3, bag_size: 729
batch 339, loss: 0.6394, instance_loss: 0.4054, weighted_loss: 0.5692, label: 2, bag_size: 1289
batch 359, loss: 2.1265, instance_loss: 0.7298, weighted_loss: 1.7075, label: 2, bag_size: 1050
batch 379, loss: 1.9687, instance_loss: 0.5802, weighted_loss: 1.5522, label: 2, bag_size: 319
batch 399, loss: 1.0886, instance_loss: 0.6832, weighted_loss: 0.9670, label: 0, bag_size: 729
batch 419, loss: 1.0209, instance_loss: 0.4688, weighted_loss: 0.8553, label: 1, bag_size: 533


class 0 clustering acc 0.9958235294117647: correct 16929/17000
class 1 clustering acc 0.10529411764705883: correct 358/3400
Epoch: 5, train_loss: 0.7950, train_clustering_loss:  0.3926, train_error: 0.2871
class 0: acc 0.9032258064516129, correct 84/93
class 1: acc 0.6363636363636364, correct 56/88
class 2: acc 0.35064935064935066, correct 27/77
class 3: acc 0.7402597402597403, correct 57/77
class 4: acc 0.8777777777777778, correct 79/90

Val Set, val_loss: 1.2286, val_error: 0.5200, auc: 0.8030
class 0 clustering acc 0.9965: correct 1993/2000
class 1 clustering acc 0.06: correct 24/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7099, instance_loss: 0.3936, weighted_loss: 0.6151, label: 0, bag_size: 736
batch 39, loss: 0.7391, instance_loss: 0.5087, weighted_loss: 0.6700, label: 0, bag_size: 1034
batch 59, loss: 0.2280, instance_loss: 0.4252, weighted_loss: 0.2872, label: 0, bag_size: 729
batch 79, loss: 0.2791, instance_loss: 0.2388, weighted_loss: 0.2670, label: 0, bag_size: 1872
batch 99, loss: 0.2650, instance_loss: 0.1541, weighted_loss: 0.2317, label: 3, bag_size: 556
batch 119, loss: 1.2230, instance_loss: 0.6904, weighted_loss: 1.0632, label: 1, bag_size: 1409
batch 139, loss: 1.0205, instance_loss: 0.4631, weighted_loss: 0.8533, label: 1, bag_size: 711
batch 159, loss: 0.1929, instance_loss: 0.2047, weighted_loss: 0.1964, label: 0, bag_size: 478
batch 179, loss: 1.0209, instance_loss: 0.4648, weighted_loss: 0.8541, label: 2, bag_size: 1058
batch 199, loss: 0.1972, instance_loss: 0.2640, weighted_loss: 0.2172, label: 0, bag_size: 729
batch 219, loss: 1.6700, instance_loss: 0.4890, weighted_loss: 1.3157, label: 2, bag_size: 1006
batch 239, loss: 0.0427, instance_loss: 0.1468, weighted_loss: 0.0739, label: 3, bag_size: 729
batch 259, loss: 0.6331, instance_loss: 0.3413, weighted_loss: 0.5455, label: 3, bag_size: 343
batch 279, loss: 0.4894, instance_loss: 0.3138, weighted_loss: 0.4367, label: 1, bag_size: 534
batch 299, loss: 0.5921, instance_loss: 0.3499, weighted_loss: 0.5194, label: 3, bag_size: 697
batch 319, loss: 0.0945, instance_loss: 0.3443, weighted_loss: 0.1694, label: 3, bag_size: 936
batch 339, loss: 0.1826, instance_loss: 0.3666, weighted_loss: 0.2378, label: 0, bag_size: 729
batch 359, loss: 0.1527, instance_loss: 0.2203, weighted_loss: 0.1730, label: 3, bag_size: 952
batch 379, loss: 0.1995, instance_loss: 0.2255, weighted_loss: 0.2073, label: 0, bag_size: 478
batch 399, loss: 0.9435, instance_loss: 0.3215, weighted_loss: 0.7569, label: 1, bag_size: 858
batch 419, loss: 0.2020, instance_loss: 0.1836, weighted_loss: 0.1964, label: 3, bag_size: 729


class 0 clustering acc 0.9961176470588236: correct 16934/17000
class 1 clustering acc 0.17882352941176471: correct 608/3400
Epoch: 6, train_loss: 0.7661, train_clustering_loss:  0.3777, train_error: 0.2494
class 0: acc 0.8717948717948718, correct 68/78
class 1: acc 0.7340425531914894, correct 69/94
class 2: acc 0.47297297297297297, correct 35/74
class 3: acc 0.7586206896551724, correct 66/87
class 4: acc 0.8804347826086957, correct 81/92

Val Set, val_loss: 1.1458, val_error: 0.4400, auc: 0.8261
class 0 clustering acc 0.997: correct 1994/2000
class 1 clustering acc 0.0925: correct 37/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
Validation loss decreased (1.155508 --> 1.145792).  Saving model ...


batch 19, loss: 0.1357, instance_loss: 0.1737, weighted_loss: 0.1471, label: 4, bag_size: 1121
batch 39, loss: 0.2446, instance_loss: 0.2014, weighted_loss: 0.2317, label: 3, bag_size: 729
batch 59, loss: 1.0443, instance_loss: 0.5244, weighted_loss: 0.8884, label: 2, bag_size: 626
batch 79, loss: 1.3614, instance_loss: 0.5149, weighted_loss: 1.1075, label: 3, bag_size: 281
batch 99, loss: 1.5078, instance_loss: 0.5555, weighted_loss: 1.2221, label: 2, bag_size: 405
batch 119, loss: 0.0893, instance_loss: 0.3390, weighted_loss: 0.1642, label: 4, bag_size: 754
batch 139, loss: 0.1757, instance_loss: 0.2187, weighted_loss: 0.1886, label: 3, bag_size: 729
batch 159, loss: 1.1240, instance_loss: 0.4972, weighted_loss: 0.9360, label: 2, bag_size: 482
batch 179, loss: 0.5372, instance_loss: 0.4554, weighted_loss: 0.5127, label: 4, bag_size: 625
batch 199, loss: 0.1267, instance_loss: 0.1320, weighted_loss: 0.1283, label: 0, bag_size: 1143
batch 219, loss: 0.0463, instance_loss: 0.1343, weighted_loss: 0.0727, label: 4, bag_size: 1176
batch 239, loss: 0.0875, instance_loss: 0.2217, weighted_loss: 0.1277, label: 4, bag_size: 826
batch 259, loss: 0.4552, instance_loss: 0.3865, weighted_loss: 0.4346, label: 4, bag_size: 947
batch 279, loss: 0.2218, instance_loss: 0.2091, weighted_loss: 0.2180, label: 1, bag_size: 1191
batch 299, loss: 1.3079, instance_loss: 0.5124, weighted_loss: 1.0693, label: 2, bag_size: 629
batch 319, loss: 0.4822, instance_loss: 0.3101, weighted_loss: 0.4306, label: 1, bag_size: 746
batch 339, loss: 1.1713, instance_loss: 0.4521, weighted_loss: 0.9555, label: 1, bag_size: 1273
batch 359, loss: 1.1546, instance_loss: 0.4866, weighted_loss: 0.9542, label: 2, bag_size: 120
batch 379, loss: 0.1389, instance_loss: 0.2029, weighted_loss: 0.1581, label: 0, bag_size: 478
batch 399, loss: 1.4425, instance_loss: 0.6049, weighted_loss: 1.1912, label: 2, bag_size: 373
batch 419, loss: 0.4243, instance_loss: 0.3883, weighted_loss: 0.4135, label: 2, bag_size: 317


class 0 clustering acc 0.9954117647058823: correct 16922/17000
class 1 clustering acc 0.23852941176470588: correct 811/3400
Epoch: 7, train_loss: 0.7247, train_clustering_loss:  0.3679, train_error: 0.2941
class 0: acc 0.8024691358024691, correct 65/81
class 1: acc 0.5862068965517241, correct 51/87
class 2: acc 0.4823529411764706, correct 41/85
class 3: acc 0.7647058823529411, correct 65/85
class 4: acc 0.896551724137931, correct 78/87

Val Set, val_loss: 1.1068, val_error: 0.4200, auc: 0.8354
class 0 clustering acc 0.998: correct 1996/2000
class 1 clustering acc 0.0875: correct 35/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5, correct 3/6
Validation loss decreased (1.145792 --> 1.106837).  Saving model ...


batch 19, loss: 0.7535, instance_loss: 0.4386, weighted_loss: 0.6591, label: 2, bag_size: 252
batch 39, loss: 0.0621, instance_loss: 0.3186, weighted_loss: 0.1390, label: 3, bag_size: 936
batch 59, loss: 0.4675, instance_loss: 0.2878, weighted_loss: 0.4136, label: 1, bag_size: 754
batch 79, loss: 0.5925, instance_loss: 0.5527, weighted_loss: 0.5805, label: 3, bag_size: 1167
batch 99, loss: 0.2668, instance_loss: 0.1811, weighted_loss: 0.2411, label: 3, bag_size: 729
batch 119, loss: 1.9277, instance_loss: 0.5460, weighted_loss: 1.5132, label: 4, bag_size: 297
batch 139, loss: 0.7628, instance_loss: 0.5436, weighted_loss: 0.6971, label: 2, bag_size: 248
batch 159, loss: 1.4681, instance_loss: 0.4553, weighted_loss: 1.1643, label: 1, bag_size: 448
batch 179, loss: 1.4472, instance_loss: 0.4784, weighted_loss: 1.1566, label: 0, bag_size: 381
batch 199, loss: 1.3173, instance_loss: 0.5382, weighted_loss: 1.0836, label: 4, bag_size: 1331
batch 219, loss: 1.0842, instance_loss: 0.4381, weighted_loss: 0.8904, label: 4, bag_size: 297
batch 239, loss: 1.6350, instance_loss: 0.5349, weighted_loss: 1.3050, label: 1, bag_size: 377
batch 259, loss: 0.0489, instance_loss: 0.2070, weighted_loss: 0.0963, label: 4, bag_size: 729
batch 279, loss: 0.0854, instance_loss: 0.0917, weighted_loss: 0.0873, label: 0, bag_size: 360
batch 299, loss: 0.1948, instance_loss: 0.1866, weighted_loss: 0.1923, label: 0, bag_size: 731
batch 319, loss: 0.3120, instance_loss: 0.3087, weighted_loss: 0.3110, label: 0, bag_size: 1061
batch 339, loss: 1.3539, instance_loss: 0.4797, weighted_loss: 1.0917, label: 2, bag_size: 358
batch 359, loss: 0.5084, instance_loss: 0.4089, weighted_loss: 0.4786, label: 4, bag_size: 947
batch 379, loss: 1.8752, instance_loss: 0.5166, weighted_loss: 1.4676, label: 4, bag_size: 436
batch 399, loss: 0.5857, instance_loss: 0.4654, weighted_loss: 0.5496, label: 2, bag_size: 682
batch 419, loss: 0.7454, instance_loss: 0.3897, weighted_loss: 0.6387, label: 2, bag_size: 848


class 0 clustering acc 0.9941176470588236: correct 16900/17000
class 1 clustering acc 0.23352941176470587: correct 794/3400
Epoch: 8, train_loss: 0.7004, train_clustering_loss:  0.3676, train_error: 0.2659
class 0: acc 0.8108108108108109, correct 60/74
class 1: acc 0.6666666666666666, correct 66/99
class 2: acc 0.5764705882352941, correct 49/85
class 3: acc 0.8148148148148148, correct 66/81
class 4: acc 0.8255813953488372, correct 71/86

Val Set, val_loss: 1.0857, val_error: 0.3800, auc: 0.8359
class 0 clustering acc 0.9965: correct 1993/2000
class 1 clustering acc 0.12: correct 48/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5, correct 3/6
Validation loss decreased (1.106837 --> 1.085671).  Saving model ...


batch 19, loss: 0.1139, instance_loss: 0.2630, weighted_loss: 0.1586, label: 4, bag_size: 1474
batch 39, loss: 0.2750, instance_loss: 0.2866, weighted_loss: 0.2785, label: 4, bag_size: 1357
batch 59, loss: 1.0010, instance_loss: 0.5520, weighted_loss: 0.8663, label: 2, bag_size: 1514
batch 79, loss: 0.0563, instance_loss: 0.2707, weighted_loss: 0.1206, label: 4, bag_size: 1278
batch 99, loss: 1.2744, instance_loss: 0.5641, weighted_loss: 1.0613, label: 3, bag_size: 360
batch 119, loss: 0.6201, instance_loss: 0.4940, weighted_loss: 0.5823, label: 0, bag_size: 432
batch 139, loss: 1.1739, instance_loss: 0.4878, weighted_loss: 0.9681, label: 1, bag_size: 936
batch 159, loss: 0.9947, instance_loss: 0.5063, weighted_loss: 0.8481, label: 3, bag_size: 305
batch 179, loss: 0.6570, instance_loss: 0.3058, weighted_loss: 0.5516, label: 1, bag_size: 534
batch 199, loss: 0.3887, instance_loss: 0.3332, weighted_loss: 0.3721, label: 1, bag_size: 356
batch 219, loss: 0.1435, instance_loss: 0.2362, weighted_loss: 0.1713, label: 0, bag_size: 729
batch 239, loss: 1.5796, instance_loss: 0.5458, weighted_loss: 1.2694, label: 1, bag_size: 1724
batch 259, loss: 0.5998, instance_loss: 0.4272, weighted_loss: 0.5480, label: 1, bag_size: 1096
batch 279, loss: 0.0568, instance_loss: 0.5252, weighted_loss: 0.1973, label: 4, bag_size: 882
batch 299, loss: 0.0042, instance_loss: 0.1049, weighted_loss: 0.0344, label: 4, bag_size: 729
batch 319, loss: 0.1728, instance_loss: 0.1680, weighted_loss: 0.1713, label: 1, bag_size: 1191
batch 339, loss: 0.0288, instance_loss: 0.1809, weighted_loss: 0.0744, label: 4, bag_size: 1278
batch 359, loss: 0.1582, instance_loss: 0.2366, weighted_loss: 0.1817, label: 3, bag_size: 952
batch 379, loss: 0.8526, instance_loss: 0.4720, weighted_loss: 0.7384, label: 0, bag_size: 1527
batch 399, loss: 0.1472, instance_loss: 0.3550, weighted_loss: 0.2095, label: 0, bag_size: 729
batch 419, loss: 0.7909, instance_loss: 0.4811, weighted_loss: 0.6979, label: 2, bag_size: 636


class 0 clustering acc 0.994: correct 16898/17000
class 1 clustering acc 0.26323529411764707: correct 895/3400
Epoch: 9, train_loss: 0.6402, train_clustering_loss:  0.3563, train_error: 0.2471
class 0: acc 0.8333333333333334, correct 65/78
class 1: acc 0.6702127659574468, correct 63/94
class 2: acc 0.5194805194805194, correct 40/77
class 3: acc 0.810126582278481, correct 64/79
class 4: acc 0.9072164948453608, correct 88/97

Val Set, val_loss: 1.1108, val_error: 0.4200, auc: 0.8496
class 0 clustering acc 0.994: correct 1988/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.6, correct 6/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7258, instance_loss: 0.3355, weighted_loss: 0.6087, label: 4, bag_size: 928
batch 39, loss: 0.1469, instance_loss: 0.2116, weighted_loss: 0.1663, label: 4, bag_size: 354
batch 59, loss: 0.2867, instance_loss: 0.3121, weighted_loss: 0.2943, label: 4, bag_size: 947
batch 79, loss: 0.0033, instance_loss: 0.0633, weighted_loss: 0.0213, label: 4, bag_size: 729
batch 99, loss: 0.0078, instance_loss: 0.0922, weighted_loss: 0.0331, label: 4, bag_size: 729
batch 119, loss: 0.1715, instance_loss: 0.1941, weighted_loss: 0.1783, label: 0, bag_size: 933
batch 139, loss: 2.5672, instance_loss: 0.5691, weighted_loss: 1.9678, label: 0, bag_size: 245
batch 159, loss: 0.0258, instance_loss: 0.2435, weighted_loss: 0.0911, label: 3, bag_size: 936
batch 179, loss: 0.7325, instance_loss: 0.4519, weighted_loss: 0.6483, label: 1, bag_size: 786
batch 199, loss: 0.2140, instance_loss: 0.2391, weighted_loss: 0.2215, label: 1, bag_size: 834
batch 219, loss: 0.0446, instance_loss: 0.1386, weighted_loss: 0.0728, label: 0, bag_size: 524
batch 239, loss: 0.0326, instance_loss: 0.0918, weighted_loss: 0.0503, label: 0, bag_size: 976
batch 259, loss: 0.0688, instance_loss: 0.1406, weighted_loss: 0.0904, label: 0, bag_size: 521
batch 279, loss: 0.0318, instance_loss: 0.0803, weighted_loss: 0.0464, label: 3, bag_size: 729
batch 299, loss: 0.2503, instance_loss: 0.3191, weighted_loss: 0.2709, label: 2, bag_size: 323
batch 319, loss: 0.6909, instance_loss: 0.3830, weighted_loss: 0.5985, label: 1, bag_size: 504
batch 339, loss: 0.0643, instance_loss: 0.1455, weighted_loss: 0.0886, label: 1, bag_size: 828
batch 359, loss: 1.4127, instance_loss: 0.5613, weighted_loss: 1.1573, label: 0, bag_size: 423
batch 379, loss: 1.4161, instance_loss: 0.6684, weighted_loss: 1.1918, label: 2, bag_size: 766
batch 399, loss: 0.2045, instance_loss: 0.1646, weighted_loss: 0.1925, label: 0, bag_size: 1061
batch 419, loss: 0.2225, instance_loss: 0.2856, weighted_loss: 0.2414, label: 2, bag_size: 1039


class 0 clustering acc 0.9932941176470588: correct 16886/17000
class 1 clustering acc 0.2938235294117647: correct 999/3400
Epoch: 10, train_loss: 0.5477, train_clustering_loss:  0.3422, train_error: 0.1835
class 0: acc 0.9204545454545454, correct 81/88
class 1: acc 0.7647058823529411, correct 65/85
class 2: acc 0.6595744680851063, correct 62/94
class 3: acc 0.8617021276595744, correct 81/94
class 4: acc 0.90625, correct 58/64

Val Set, val_loss: 1.1341, val_error: 0.4400, auc: 0.8514
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.1775: correct 71/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0371, instance_loss: 0.1611, weighted_loss: 0.0743, label: 4, bag_size: 524
batch 39, loss: 0.2176, instance_loss: 0.1364, weighted_loss: 0.1932, label: 3, bag_size: 556
batch 59, loss: 0.4727, instance_loss: 0.4498, weighted_loss: 0.4658, label: 1, bag_size: 102
batch 79, loss: 0.3292, instance_loss: 0.6101, weighted_loss: 0.4135, label: 4, bag_size: 882
batch 99, loss: 0.7695, instance_loss: 0.4675, weighted_loss: 0.6789, label: 3, bag_size: 1380
batch 119, loss: 0.3652, instance_loss: 0.3252, weighted_loss: 0.3532, label: 4, bag_size: 354
batch 139, loss: 0.9167, instance_loss: 0.6376, weighted_loss: 0.8330, label: 0, bag_size: 338
batch 159, loss: 0.7365, instance_loss: 0.3970, weighted_loss: 0.6346, label: 1, bag_size: 711
batch 179, loss: 0.9315, instance_loss: 0.5257, weighted_loss: 0.8098, label: 1, bag_size: 1559
batch 199, loss: 1.7858, instance_loss: 0.4407, weighted_loss: 1.3823, label: 2, bag_size: 986
batch 219, loss: 0.5408, instance_loss: 0.4146, weighted_loss: 0.5029, label: 2, bag_size: 848
batch 239, loss: 2.3944, instance_loss: 0.6993, weighted_loss: 1.8859, label: 1, bag_size: 651
batch 259, loss: 1.2986, instance_loss: 0.4059, weighted_loss: 1.0308, label: 4, bag_size: 656
batch 279, loss: 0.3416, instance_loss: 0.3022, weighted_loss: 0.3298, label: 1, bag_size: 504
batch 299, loss: 1.0536, instance_loss: 0.5916, weighted_loss: 0.9150, label: 4, bag_size: 1337
batch 319, loss: 0.0005, instance_loss: 0.0366, weighted_loss: 0.0114, label: 4, bag_size: 729
batch 339, loss: 0.5378, instance_loss: 0.3506, weighted_loss: 0.4817, label: 2, bag_size: 292
batch 359, loss: 0.1998, instance_loss: 0.3063, weighted_loss: 0.2318, label: 3, bag_size: 533
batch 379, loss: 0.1008, instance_loss: 0.1693, weighted_loss: 0.1213, label: 1, bag_size: 847
batch 399, loss: 0.1631, instance_loss: 0.3921, weighted_loss: 0.2318, label: 3, bag_size: 1250
batch 419, loss: 0.0369, instance_loss: 0.2656, weighted_loss: 0.1055, label: 4, bag_size: 826


class 0 clustering acc 0.9917058823529412: correct 16859/17000
class 1 clustering acc 0.28647058823529414: correct 974/3400
Epoch: 11, train_loss: 0.6085, train_clustering_loss:  0.3517, train_error: 0.2259
class 0: acc 0.8243243243243243, correct 61/74
class 1: acc 0.6363636363636364, correct 56/88
class 2: acc 0.6744186046511628, correct 58/86
class 3: acc 0.8076923076923077, correct 63/78
class 4: acc 0.9191919191919192, correct 91/99

Val Set, val_loss: 1.1064, val_error: 0.4000, auc: 0.8632
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.195: correct 78/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4420, instance_loss: 0.3169, weighted_loss: 0.4045, label: 1, bag_size: 754
batch 39, loss: 2.0852, instance_loss: 0.5346, weighted_loss: 1.6200, label: 1, bag_size: 838
batch 59, loss: 5.2527, instance_loss: 0.9348, weighted_loss: 3.9573, label: 2, bag_size: 358
batch 79, loss: 0.8469, instance_loss: 0.5739, weighted_loss: 0.7650, label: 0, bag_size: 718
batch 99, loss: 0.9049, instance_loss: 0.4451, weighted_loss: 0.7670, label: 0, bag_size: 282
batch 119, loss: 0.1159, instance_loss: 0.1357, weighted_loss: 0.1219, label: 0, bag_size: 607
batch 139, loss: 0.1822, instance_loss: 0.1662, weighted_loss: 0.1774, label: 1, bag_size: 1191
batch 159, loss: 0.0605, instance_loss: 0.1610, weighted_loss: 0.0907, label: 0, bag_size: 729
batch 179, loss: 0.1073, instance_loss: 0.3945, weighted_loss: 0.1935, label: 3, bag_size: 230
batch 199, loss: 1.3106, instance_loss: 0.5135, weighted_loss: 1.0715, label: 2, bag_size: 358
batch 219, loss: 0.3772, instance_loss: 0.3127, weighted_loss: 0.3578, label: 2, bag_size: 470
batch 239, loss: 0.3111, instance_loss: 0.5747, weighted_loss: 0.3902, label: 4, bag_size: 663
batch 259, loss: 0.9097, instance_loss: 0.6796, weighted_loss: 0.8407, label: 2, bag_size: 916
batch 279, loss: 0.0658, instance_loss: 0.1820, weighted_loss: 0.1006, label: 4, bag_size: 773
batch 299, loss: 0.8787, instance_loss: 0.4821, weighted_loss: 0.7597, label: 0, bag_size: 432
batch 319, loss: 0.1202, instance_loss: 0.0924, weighted_loss: 0.1119, label: 0, bag_size: 616
batch 339, loss: 0.0491, instance_loss: 0.1460, weighted_loss: 0.0781, label: 3, bag_size: 729
batch 359, loss: 3.3467, instance_loss: 0.8010, weighted_loss: 2.5830, label: 0, bag_size: 818
batch 379, loss: 0.8039, instance_loss: 0.3687, weighted_loss: 0.6734, label: 2, bag_size: 883
batch 399, loss: 2.0819, instance_loss: 0.5763, weighted_loss: 1.6302, label: 0, bag_size: 818
batch 419, loss: 0.0951, instance_loss: 0.1541, weighted_loss: 0.1128, label: 0, bag_size: 1872


class 0 clustering acc 0.9920588235294118: correct 16865/17000
class 1 clustering acc 0.305: correct 1037/3400
Epoch: 12, train_loss: 0.5867, train_clustering_loss:  0.3508, train_error: 0.2047
class 0: acc 0.8314606741573034, correct 74/89
class 1: acc 0.6538461538461539, correct 51/78
class 2: acc 0.6818181818181818, correct 60/88
class 3: acc 0.8658536585365854, correct 71/82
class 4: acc 0.9318181818181818, correct 82/88

Val Set, val_loss: 1.0859, val_error: 0.4000, auc: 0.8639
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.18: correct 72/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0401, instance_loss: 0.2207, weighted_loss: 0.0943, label: 3, bag_size: 729
batch 39, loss: 1.9049, instance_loss: 0.4649, weighted_loss: 1.4729, label: 0, bag_size: 472
batch 59, loss: 0.6309, instance_loss: 0.3465, weighted_loss: 0.5456, label: 2, bag_size: 262
batch 79, loss: 0.0494, instance_loss: 0.1017, weighted_loss: 0.0650, label: 0, bag_size: 729
batch 99, loss: 0.0129, instance_loss: 0.1228, weighted_loss: 0.0459, label: 3, bag_size: 729
batch 119, loss: 0.9650, instance_loss: 0.5428, weighted_loss: 0.8383, label: 3, bag_size: 360
batch 139, loss: 0.5278, instance_loss: 0.4641, weighted_loss: 0.5087, label: 1, bag_size: 818
batch 159, loss: 0.1722, instance_loss: 0.4080, weighted_loss: 0.2430, label: 2, bag_size: 986
batch 179, loss: 0.0138, instance_loss: 0.1070, weighted_loss: 0.0417, label: 4, bag_size: 646
batch 199, loss: 0.6226, instance_loss: 0.3495, weighted_loss: 0.5407, label: 1, bag_size: 1651
batch 219, loss: 0.5037, instance_loss: 0.3327, weighted_loss: 0.4524, label: 2, bag_size: 471
batch 239, loss: 0.0012, instance_loss: 0.0580, weighted_loss: 0.0182, label: 4, bag_size: 729
batch 259, loss: 0.0833, instance_loss: 0.1560, weighted_loss: 0.1051, label: 0, bag_size: 1012
batch 279, loss: 0.0261, instance_loss: 0.0646, weighted_loss: 0.0377, label: 3, bag_size: 729
batch 299, loss: 0.0287, instance_loss: 0.0867, weighted_loss: 0.0461, label: 4, bag_size: 790
batch 319, loss: 0.4936, instance_loss: 0.4699, weighted_loss: 0.4865, label: 3, bag_size: 360
batch 339, loss: 1.4622, instance_loss: 0.6731, weighted_loss: 1.2255, label: 2, bag_size: 194
batch 359, loss: 0.0354, instance_loss: 0.0598, weighted_loss: 0.0427, label: 0, bag_size: 521
batch 379, loss: 0.0036, instance_loss: 0.7585, weighted_loss: 0.2301, label: 4, bag_size: 1235
batch 399, loss: 0.1815, instance_loss: 0.3376, weighted_loss: 0.2283, label: 1, bag_size: 818
batch 419, loss: 0.5281, instance_loss: 0.3245, weighted_loss: 0.4670, label: 0, bag_size: 912


class 0 clustering acc 0.9935294117647059: correct 16890/17000
class 1 clustering acc 0.3679411764705882: correct 1251/3400
Epoch: 13, train_loss: 0.4694, train_clustering_loss:  0.3155, train_error: 0.1741
class 0: acc 0.9230769230769231, correct 72/78
class 1: acc 0.7093023255813954, correct 61/86
class 2: acc 0.6341463414634146, correct 52/82
class 3: acc 0.9047619047619048, correct 76/84
class 4: acc 0.9473684210526315, correct 90/95

Val Set, val_loss: 1.0849, val_error: 0.4400, auc: 0.8674
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
Validation loss decreased (1.085671 --> 1.084879).  Saving model ...


batch 19, loss: 0.9473, instance_loss: 0.3931, weighted_loss: 0.7810, label: 3, bag_size: 305
batch 39, loss: 0.7250, instance_loss: 0.5012, weighted_loss: 0.6578, label: 3, bag_size: 706
batch 59, loss: 0.1901, instance_loss: 0.1910, weighted_loss: 0.1904, label: 0, bag_size: 466
batch 79, loss: 1.1804, instance_loss: 0.4775, weighted_loss: 0.9695, label: 0, bag_size: 801
batch 99, loss: 0.2616, instance_loss: 0.2781, weighted_loss: 0.2665, label: 1, bag_size: 754
batch 119, loss: 0.0050, instance_loss: 0.0879, weighted_loss: 0.0298, label: 4, bag_size: 729
batch 139, loss: 0.0056, instance_loss: 0.1200, weighted_loss: 0.0399, label: 4, bag_size: 729
batch 159, loss: 0.0961, instance_loss: 0.1170, weighted_loss: 0.1024, label: 0, bag_size: 472
batch 179, loss: 0.0588, instance_loss: 0.2648, weighted_loss: 0.1206, label: 1, bag_size: 318
batch 199, loss: 0.0694, instance_loss: 0.1364, weighted_loss: 0.0895, label: 0, bag_size: 524
batch 219, loss: 0.5226, instance_loss: 0.3126, weighted_loss: 0.4596, label: 0, bag_size: 653
batch 239, loss: 0.0589, instance_loss: 0.0865, weighted_loss: 0.0672, label: 0, bag_size: 1196
batch 259, loss: 0.9816, instance_loss: 0.5477, weighted_loss: 0.8514, label: 2, bag_size: 1232
batch 279, loss: 3.3417, instance_loss: 0.7336, weighted_loss: 2.5592, label: 0, bag_size: 818
batch 299, loss: 0.1148, instance_loss: 0.2008, weighted_loss: 0.1406, label: 3, bag_size: 729
batch 319, loss: 0.1032, instance_loss: 0.1642, weighted_loss: 0.1215, label: 0, bag_size: 729
batch 339, loss: 0.2107, instance_loss: 0.6058, weighted_loss: 0.3292, label: 4, bag_size: 366
batch 359, loss: 0.1761, instance_loss: 0.1776, weighted_loss: 0.1766, label: 0, bag_size: 413
batch 379, loss: 0.2096, instance_loss: 0.2235, weighted_loss: 0.2138, label: 1, bag_size: 790
batch 399, loss: 0.4320, instance_loss: 0.3700, weighted_loss: 0.4134, label: 1, bag_size: 442
batch 419, loss: 0.2786, instance_loss: 0.1348, weighted_loss: 0.2355, label: 3, bag_size: 729


class 0 clustering acc 0.990764705882353: correct 16843/17000
class 1 clustering acc 0.3335294117647059: correct 1134/3400
Epoch: 14, train_loss: 0.5167, train_clustering_loss:  0.3356, train_error: 0.1741
class 0: acc 0.9102564102564102, correct 71/78
class 1: acc 0.6477272727272727, correct 57/88
class 2: acc 0.6888888888888889, correct 62/90
class 3: acc 0.9666666666666667, correct 87/90
class 4: acc 0.9367088607594937, correct 74/79

Val Set, val_loss: 1.0219, val_error: 0.4200, auc: 0.8683
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.6, correct 6/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5, correct 3/6
Validation loss decreased (1.084879 --> 1.021933).  Saving model ...


batch 19, loss: 0.8839, instance_loss: 0.6057, weighted_loss: 0.8005, label: 1, bag_size: 778
batch 39, loss: 0.2104, instance_loss: 0.3777, weighted_loss: 0.2606, label: 1, bag_size: 533
batch 59, loss: 0.4870, instance_loss: 0.3193, weighted_loss: 0.4367, label: 3, bag_size: 317
batch 79, loss: 0.1561, instance_loss: 0.3178, weighted_loss: 0.2046, label: 2, bag_size: 400
batch 99, loss: 0.5248, instance_loss: 0.3378, weighted_loss: 0.4687, label: 2, bag_size: 317
batch 119, loss: 0.7206, instance_loss: 0.4378, weighted_loss: 0.6357, label: 1, bag_size: 1273
batch 139, loss: 0.2824, instance_loss: 0.4077, weighted_loss: 0.3200, label: 4, bag_size: 297
batch 159, loss: 0.0262, instance_loss: 0.1211, weighted_loss: 0.0547, label: 4, bag_size: 1002
batch 179, loss: 0.0533, instance_loss: 0.3649, weighted_loss: 0.1468, label: 1, bag_size: 1152
batch 199, loss: 0.0327, instance_loss: 0.2049, weighted_loss: 0.0843, label: 3, bag_size: 952
batch 219, loss: 0.0260, instance_loss: 0.2021, weighted_loss: 0.0788, label: 3, bag_size: 1253
batch 239, loss: 0.1110, instance_loss: 0.5013, weighted_loss: 0.2281, label: 1, bag_size: 700
batch 259, loss: 0.2718, instance_loss: 0.5930, weighted_loss: 0.3681, label: 4, bag_size: 663
batch 279, loss: 0.4636, instance_loss: 0.3834, weighted_loss: 0.4396, label: 0, bag_size: 912
batch 299, loss: 0.0095, instance_loss: 0.1574, weighted_loss: 0.0538, label: 4, bag_size: 636
batch 319, loss: 0.0366, instance_loss: 0.1010, weighted_loss: 0.0559, label: 3, bag_size: 729
batch 339, loss: 0.0284, instance_loss: 0.1821, weighted_loss: 0.0745, label: 3, bag_size: 952
batch 359, loss: 0.1690, instance_loss: 0.2627, weighted_loss: 0.1971, label: 3, bag_size: 230
batch 379, loss: 0.0341, instance_loss: 0.0769, weighted_loss: 0.0469, label: 3, bag_size: 729
batch 399, loss: 0.1575, instance_loss: 0.2801, weighted_loss: 0.1943, label: 3, bag_size: 841
batch 419, loss: 0.0110, instance_loss: 0.3047, weighted_loss: 0.0991, label: 4, bag_size: 947


class 0 clustering acc 0.992: correct 16864/17000
class 1 clustering acc 0.38058823529411767: correct 1294/3400
Epoch: 15, train_loss: 0.4472, train_clustering_loss:  0.3095, train_error: 0.1694
class 0: acc 0.9135802469135802, correct 74/81
class 1: acc 0.7209302325581395, correct 62/86
class 2: acc 0.7108433734939759, correct 59/83
class 3: acc 0.8924731182795699, correct 83/93
class 4: acc 0.9146341463414634, correct 75/82

Val Set, val_loss: 1.0937, val_error: 0.4000, auc: 0.8638
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.2125: correct 85/400
class 0: acc 0.6, correct 6/10
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0552, instance_loss: 0.0869, weighted_loss: 0.0647, label: 4, bag_size: 1121
batch 39, loss: 0.0984, instance_loss: 0.3286, weighted_loss: 0.1675, label: 3, bag_size: 1250
batch 59, loss: 0.5502, instance_loss: 0.4121, weighted_loss: 0.5087, label: 1, bag_size: 534
batch 79, loss: 0.1687, instance_loss: 0.3087, weighted_loss: 0.2107, label: 0, bag_size: 729
batch 99, loss: 0.2905, instance_loss: 0.3804, weighted_loss: 0.3175, label: 3, bag_size: 283
batch 119, loss: 0.2406, instance_loss: 0.2182, weighted_loss: 0.2339, label: 1, bag_size: 790
batch 139, loss: 0.9980, instance_loss: 0.5046, weighted_loss: 0.8500, label: 1, bag_size: 504
batch 159, loss: 1.0556, instance_loss: 0.5698, weighted_loss: 0.9098, label: 4, bag_size: 1331
batch 179, loss: 0.2015, instance_loss: 0.2794, weighted_loss: 0.2249, label: 4, bag_size: 1357
batch 199, loss: 0.1390, instance_loss: 0.2973, weighted_loss: 0.1865, label: 2, bag_size: 222
batch 219, loss: 0.1305, instance_loss: 0.2018, weighted_loss: 0.1519, label: 3, bag_size: 729
batch 239, loss: 0.0096, instance_loss: 0.2705, weighted_loss: 0.0879, label: 4, bag_size: 729
batch 259, loss: 0.0992, instance_loss: 0.2373, weighted_loss: 0.1406, label: 2, bag_size: 461
batch 279, loss: 0.8108, instance_loss: 0.5001, weighted_loss: 0.7176, label: 0, bag_size: 1527
batch 299, loss: 0.2546, instance_loss: 0.1764, weighted_loss: 0.2312, label: 0, bag_size: 1133
batch 319, loss: 0.7254, instance_loss: 0.4802, weighted_loss: 0.6518, label: 2, bag_size: 600
batch 339, loss: 0.4527, instance_loss: 0.4122, weighted_loss: 0.4406, label: 1, bag_size: 860
batch 359, loss: 0.3595, instance_loss: 0.2482, weighted_loss: 0.3261, label: 0, bag_size: 962
batch 379, loss: 2.3917, instance_loss: 0.9109, weighted_loss: 1.9475, label: 2, bag_size: 1043
batch 399, loss: 0.9749, instance_loss: 0.4759, weighted_loss: 0.8252, label: 0, bag_size: 1247
batch 419, loss: 0.0708, instance_loss: 0.1661, weighted_loss: 0.0994, label: 0, bag_size: 729


class 0 clustering acc 0.9900588235294118: correct 16831/17000
class 1 clustering acc 0.33294117647058824: correct 1132/3400
Epoch: 16, train_loss: 0.4911, train_clustering_loss:  0.3445, train_error: 0.1671
class 0: acc 0.8840579710144928, correct 61/69
class 1: acc 0.6666666666666666, correct 52/78
class 2: acc 0.7156862745098039, correct 73/102
class 3: acc 0.9775280898876404, correct 87/89
class 4: acc 0.9310344827586207, correct 81/87

Val Set, val_loss: 1.0269, val_error: 0.4000, auc: 0.8652
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.1925: correct 77/400
class 0: acc 0.6, correct 6/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0934, instance_loss: 0.3170, weighted_loss: 0.1605, label: 4, bag_size: 826
batch 39, loss: 0.1781, instance_loss: 0.2507, weighted_loss: 0.1999, label: 0, bag_size: 607
batch 59, loss: 0.2034, instance_loss: 0.1960, weighted_loss: 0.2012, label: 1, bag_size: 903
batch 79, loss: 0.4619, instance_loss: 0.3903, weighted_loss: 0.4404, label: 2, bag_size: 948
batch 99, loss: 0.6164, instance_loss: 0.4517, weighted_loss: 0.5670, label: 1, bag_size: 887
batch 119, loss: 0.0179, instance_loss: 0.0400, weighted_loss: 0.0246, label: 0, bag_size: 982
batch 139, loss: 0.6380, instance_loss: 0.6996, weighted_loss: 0.6565, label: 1, bag_size: 1409
batch 159, loss: 0.0522, instance_loss: 0.1038, weighted_loss: 0.0677, label: 3, bag_size: 729
batch 179, loss: 0.0618, instance_loss: 0.2176, weighted_loss: 0.1085, label: 3, bag_size: 952
batch 199, loss: 0.2973, instance_loss: 0.3408, weighted_loss: 0.3103, label: 2, bag_size: 839
batch 219, loss: 0.9365, instance_loss: 0.5096, weighted_loss: 0.8084, label: 2, bag_size: 636
batch 239, loss: 1.6454, instance_loss: 0.5373, weighted_loss: 1.3129, label: 1, bag_size: 936
batch 259, loss: 2.2040, instance_loss: 0.6898, weighted_loss: 1.7497, label: 2, bag_size: 758
batch 279, loss: 0.2087, instance_loss: 0.3331, weighted_loss: 0.2460, label: 4, bag_size: 663
batch 299, loss: 0.1752, instance_loss: 0.2810, weighted_loss: 0.2069, label: 2, bag_size: 687
batch 319, loss: 0.1108, instance_loss: 0.2057, weighted_loss: 0.1393, label: 4, bag_size: 1357
batch 339, loss: 0.0035, instance_loss: 0.0795, weighted_loss: 0.0263, label: 4, bag_size: 729
batch 359, loss: 0.2999, instance_loss: 0.3985, weighted_loss: 0.3294, label: 2, bag_size: 863
batch 379, loss: 0.4721, instance_loss: 0.2408, weighted_loss: 0.4027, label: 0, bag_size: 962
batch 399, loss: 0.2613, instance_loss: 0.2417, weighted_loss: 0.2554, label: 1, bag_size: 903
batch 419, loss: 0.9663, instance_loss: 0.7520, weighted_loss: 0.9020, label: 1, bag_size: 1390


class 0 clustering acc 0.989: correct 16813/17000
class 1 clustering acc 0.3120588235294118: correct 1061/3400
Epoch: 17, train_loss: 0.4697, train_clustering_loss:  0.3436, train_error: 0.1694
class 0: acc 0.8717948717948718, correct 68/78
class 1: acc 0.7083333333333334, correct 68/96
class 2: acc 0.7171717171717171, correct 71/99
class 3: acc 0.9166666666666666, correct 66/72
class 4: acc 1.0, correct 80/80

Val Set, val_loss: 1.0877, val_error: 0.4000, auc: 0.8596
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.19: correct 76/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0221, instance_loss: 0.1011, weighted_loss: 0.0458, label: 3, bag_size: 729
batch 39, loss: 0.0385, instance_loss: 0.0634, weighted_loss: 0.0460, label: 0, bag_size: 616
batch 59, loss: 0.1958, instance_loss: 0.1602, weighted_loss: 0.1851, label: 0, bag_size: 1247
batch 79, loss: 0.0210, instance_loss: 0.1060, weighted_loss: 0.0465, label: 3, bag_size: 1069
batch 99, loss: 0.3144, instance_loss: 0.4673, weighted_loss: 0.3602, label: 3, bag_size: 283
batch 119, loss: 0.0071, instance_loss: 0.2814, weighted_loss: 0.0894, label: 4, bag_size: 729
batch 139, loss: 0.6666, instance_loss: 0.3891, weighted_loss: 0.5833, label: 0, bag_size: 912
batch 159, loss: 0.2275, instance_loss: 0.3525, weighted_loss: 0.2650, label: 4, bag_size: 590
batch 179, loss: 0.1062, instance_loss: 0.4071, weighted_loss: 0.1965, label: 1, bag_size: 1646
batch 199, loss: 0.2110, instance_loss: 0.6531, weighted_loss: 0.3436, label: 1, bag_size: 860
batch 219, loss: 2.7167, instance_loss: 0.7774, weighted_loss: 2.1349, label: 1, bag_size: 1799
batch 239, loss: 0.0006, instance_loss: 0.1043, weighted_loss: 0.0317, label: 4, bag_size: 729
batch 259, loss: 0.2482, instance_loss: 0.3379, weighted_loss: 0.2751, label: 0, bag_size: 1301
batch 279, loss: 2.2882, instance_loss: 0.6811, weighted_loss: 1.8061, label: 1, bag_size: 1799
batch 299, loss: 0.1786, instance_loss: 0.1988, weighted_loss: 0.1847, label: 0, bag_size: 1034
batch 319, loss: 0.0301, instance_loss: 0.0528, weighted_loss: 0.0369, label: 0, bag_size: 521
batch 339, loss: 0.1525, instance_loss: 0.2948, weighted_loss: 0.1952, label: 4, bag_size: 297
batch 359, loss: 0.0215, instance_loss: 0.0258, weighted_loss: 0.0228, label: 3, bag_size: 1069
batch 379, loss: 0.0146, instance_loss: 0.1266, weighted_loss: 0.0482, label: 4, bag_size: 1278
batch 399, loss: 0.1445, instance_loss: 0.2391, weighted_loss: 0.1729, label: 1, bag_size: 614
batch 419, loss: 0.3726, instance_loss: 0.4530, weighted_loss: 0.3967, label: 2, bag_size: 863


class 0 clustering acc 0.9888823529411764: correct 16811/17000
class 1 clustering acc 0.415: correct 1411/3400
Epoch: 18, train_loss: 0.4273, train_clustering_loss:  0.3210, train_error: 0.1435
class 0: acc 0.9125, correct 73/80
class 1: acc 0.7272727272727273, correct 64/88
class 2: acc 0.6901408450704225, correct 49/71
class 3: acc 0.9411764705882353, correct 80/85
class 4: acc 0.9702970297029703, correct 98/101

Val Set, val_loss: 0.9868, val_error: 0.3800, auc: 0.8697
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.1925: correct 77/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
Validation loss decreased (1.021933 --> 0.986793).  Saving model ...


batch 19, loss: 0.0026, instance_loss: 0.0423, weighted_loss: 0.0145, label: 4, bag_size: 764
batch 39, loss: 0.1705, instance_loss: 0.3011, weighted_loss: 0.2097, label: 0, bag_size: 1301
batch 59, loss: 0.5314, instance_loss: 0.5550, weighted_loss: 0.5385, label: 2, bag_size: 636
batch 79, loss: 1.7259, instance_loss: 0.5678, weighted_loss: 1.3785, label: 2, bag_size: 120
batch 99, loss: 1.4830, instance_loss: 0.5728, weighted_loss: 1.2100, label: 1, bag_size: 838
batch 119, loss: 0.4681, instance_loss: 0.3495, weighted_loss: 0.4325, label: 0, bag_size: 912
batch 139, loss: 0.6299, instance_loss: 0.4504, weighted_loss: 0.5760, label: 2, bag_size: 1259
batch 159, loss: 0.1468, instance_loss: 0.1034, weighted_loss: 0.1338, label: 0, bag_size: 1247
batch 179, loss: 0.0782, instance_loss: 0.1132, weighted_loss: 0.0887, label: 0, bag_size: 1061
batch 199, loss: 0.1918, instance_loss: 0.3572, weighted_loss: 0.2414, label: 3, bag_size: 305
batch 219, loss: 0.0414, instance_loss: 0.0431, weighted_loss: 0.0419, label: 0, bag_size: 1235
batch 239, loss: 0.0269, instance_loss: 0.0813, weighted_loss: 0.0432, label: 0, bag_size: 933
batch 259, loss: 0.3284, instance_loss: 0.2233, weighted_loss: 0.2969, label: 0, bag_size: 200
batch 279, loss: 0.0222, instance_loss: 0.7125, weighted_loss: 0.2293, label: 3, bag_size: 607
batch 299, loss: 1.3239, instance_loss: 0.4551, weighted_loss: 1.0633, label: 2, bag_size: 1148
batch 319, loss: 0.4546, instance_loss: 0.3145, weighted_loss: 0.4126, label: 1, bag_size: 534
batch 339, loss: 0.0783, instance_loss: 0.1045, weighted_loss: 0.0862, label: 0, bag_size: 1517
batch 359, loss: 0.0759, instance_loss: 0.0775, weighted_loss: 0.0764, label: 0, bag_size: 616
batch 379, loss: 0.3146, instance_loss: 0.3721, weighted_loss: 0.3319, label: 1, bag_size: 399
batch 399, loss: 0.0552, instance_loss: 0.2387, weighted_loss: 0.1102, label: 1, bag_size: 697
batch 419, loss: 0.0136, instance_loss: 0.0840, weighted_loss: 0.0347, label: 0, bag_size: 524


class 0 clustering acc 0.992764705882353: correct 16877/17000
class 1 clustering acc 0.39941176470588236: correct 1358/3400
Epoch: 19, train_loss: 0.3584, train_clustering_loss:  0.3065, train_error: 0.1106
class 0: acc 0.9361702127659575, correct 88/94
class 1: acc 0.7654320987654321, correct 62/81
class 2: acc 0.7647058823529411, correct 65/85
class 3: acc 0.9885057471264368, correct 86/87
class 4: acc 0.9871794871794872, correct 77/78

Val Set, val_loss: 1.0905, val_error: 0.3400, auc: 0.8791
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0516, instance_loss: 0.0690, weighted_loss: 0.0568, label: 3, bag_size: 729
batch 39, loss: 0.3594, instance_loss: 0.3458, weighted_loss: 0.3553, label: 0, bag_size: 1527
batch 59, loss: 0.0419, instance_loss: 0.1499, weighted_loss: 0.0743, label: 3, bag_size: 729
batch 79, loss: 0.4325, instance_loss: 0.3782, weighted_loss: 0.4162, label: 3, bag_size: 305
batch 99, loss: 0.0951, instance_loss: 0.1579, weighted_loss: 0.1139, label: 0, bag_size: 630
batch 119, loss: 0.1825, instance_loss: 0.2957, weighted_loss: 0.2165, label: 2, bag_size: 1039
batch 139, loss: 0.1028, instance_loss: 0.2135, weighted_loss: 0.1360, label: 0, bag_size: 807
batch 159, loss: 0.0286, instance_loss: 0.2813, weighted_loss: 0.1044, label: 3, bag_size: 230
batch 179, loss: 0.1673, instance_loss: 0.3464, weighted_loss: 0.2210, label: 0, bag_size: 1301
batch 199, loss: 0.0522, instance_loss: 0.4373, weighted_loss: 0.1677, label: 4, bag_size: 817
batch 219, loss: 0.1252, instance_loss: 0.5840, weighted_loss: 0.2628, label: 4, bag_size: 1337
batch 239, loss: 0.2880, instance_loss: 0.3227, weighted_loss: 0.2984, label: 3, bag_size: 706
batch 259, loss: 0.0040, instance_loss: 0.0987, weighted_loss: 0.0324, label: 4, bag_size: 646
batch 279, loss: 0.1005, instance_loss: 0.3829, weighted_loss: 0.1852, label: 4, bag_size: 1331
batch 299, loss: 2.2222, instance_loss: 0.6198, weighted_loss: 1.7415, label: 1, bag_size: 448
batch 319, loss: 1.8860, instance_loss: 0.6437, weighted_loss: 1.5133, label: 1, bag_size: 1197
batch 339, loss: 0.0445, instance_loss: 0.0446, weighted_loss: 0.0446, label: 0, bag_size: 1235
batch 359, loss: 0.1600, instance_loss: 0.3679, weighted_loss: 0.2223, label: 1, bag_size: 533
batch 379, loss: 0.0088, instance_loss: 0.1076, weighted_loss: 0.0385, label: 4, bag_size: 646
batch 399, loss: 0.5107, instance_loss: 0.2979, weighted_loss: 0.4468, label: 0, bag_size: 381
batch 419, loss: 0.0151, instance_loss: 0.3196, weighted_loss: 0.1064, label: 3, bag_size: 1253


class 0 clustering acc 0.9905882352941177: correct 16840/17000
class 1 clustering acc 0.39588235294117646: correct 1346/3400
Epoch: 20, train_loss: 0.3963, train_clustering_loss:  0.3210, train_error: 0.1318
class 0: acc 0.9367088607594937, correct 74/79
class 1: acc 0.6623376623376623, correct 51/77
class 2: acc 0.7640449438202247, correct 68/89
class 3: acc 0.9885057471264368, correct 86/87
class 4: acc 0.967741935483871, correct 90/93

Val Set, val_loss: 1.1326, val_error: 0.4000, auc: 0.8727
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0509, instance_loss: 0.2338, weighted_loss: 0.1058, label: 1, bag_size: 945
batch 39, loss: 0.0021, instance_loss: 0.0996, weighted_loss: 0.0313, label: 4, bag_size: 729
batch 59, loss: 0.2558, instance_loss: 0.2943, weighted_loss: 0.2673, label: 0, bag_size: 807
batch 79, loss: 0.2473, instance_loss: 0.5314, weighted_loss: 0.3325, label: 3, bag_size: 533
batch 99, loss: 1.4608, instance_loss: 0.6990, weighted_loss: 1.2322, label: 2, bag_size: 758
batch 119, loss: 0.0351, instance_loss: 0.0766, weighted_loss: 0.0476, label: 0, bag_size: 518
batch 139, loss: 0.1768, instance_loss: 0.4402, weighted_loss: 0.2558, label: 1, bag_size: 102
batch 159, loss: 0.0338, instance_loss: 0.1028, weighted_loss: 0.0545, label: 0, bag_size: 524
batch 179, loss: 0.0169, instance_loss: 0.1703, weighted_loss: 0.0629, label: 3, bag_size: 952
batch 199, loss: 0.0338, instance_loss: 0.3638, weighted_loss: 0.1328, label: 4, bag_size: 656
batch 219, loss: 0.1085, instance_loss: 0.2923, weighted_loss: 0.1637, label: 1, bag_size: 897
batch 239, loss: 0.0406, instance_loss: 0.1717, weighted_loss: 0.0799, label: 3, bag_size: 729
batch 259, loss: 0.0037, instance_loss: 0.2597, weighted_loss: 0.0805, label: 3, bag_size: 791
batch 279, loss: 2.0351, instance_loss: 0.8157, weighted_loss: 1.6693, label: 1, bag_size: 778
batch 299, loss: 2.0953, instance_loss: 0.7317, weighted_loss: 1.6862, label: 0, bag_size: 818
batch 319, loss: 1.0537, instance_loss: 0.4778, weighted_loss: 0.8809, label: 2, bag_size: 357
batch 339, loss: 0.0503, instance_loss: 0.2212, weighted_loss: 0.1015, label: 1, bag_size: 828
batch 359, loss: 0.0050, instance_loss: 0.0476, weighted_loss: 0.0178, label: 3, bag_size: 729
batch 379, loss: 0.3149, instance_loss: 0.3098, weighted_loss: 0.3134, label: 0, bag_size: 1527
batch 399, loss: 0.0422, instance_loss: 0.0645, weighted_loss: 0.0489, label: 0, bag_size: 1517
batch 419, loss: 0.0111, instance_loss: 0.1360, weighted_loss: 0.0486, label: 3, bag_size: 316


class 0 clustering acc 0.9913529411764705: correct 16853/17000
class 1 clustering acc 0.41441176470588237: correct 1409/3400
Epoch: 21, train_loss: 0.3227, train_clustering_loss:  0.3022, train_error: 0.1200
class 0: acc 0.9438202247191011, correct 84/89
class 1: acc 0.75, correct 63/84
class 2: acc 0.725, correct 58/80
class 3: acc 0.9775280898876404, correct 87/89
class 4: acc 0.9879518072289156, correct 82/83

Val Set, val_loss: 1.1202, val_error: 0.3800, auc: 0.8600
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0121, instance_loss: 0.3160, weighted_loss: 0.1032, label: 4, bag_size: 656
batch 39, loss: 0.0012, instance_loss: 0.1120, weighted_loss: 0.0344, label: 3, bag_size: 729
batch 59, loss: 0.0113, instance_loss: 0.0572, weighted_loss: 0.0251, label: 3, bag_size: 451
batch 79, loss: 0.2866, instance_loss: 0.3746, weighted_loss: 0.3130, label: 3, bag_size: 283
batch 99, loss: 0.2957, instance_loss: 0.2640, weighted_loss: 0.2862, label: 2, bag_size: 1289
batch 119, loss: 0.0492, instance_loss: 0.3317, weighted_loss: 0.1339, label: 0, bag_size: 729
batch 139, loss: 0.6876, instance_loss: 0.5013, weighted_loss: 0.6317, label: 0, bag_size: 718
batch 159, loss: 0.0139, instance_loss: 0.0938, weighted_loss: 0.0378, label: 0, bag_size: 729
batch 179, loss: 0.0480, instance_loss: 0.0747, weighted_loss: 0.0560, label: 0, bag_size: 1579
batch 199, loss: 0.0003, instance_loss: 0.0722, weighted_loss: 0.0219, label: 4, bag_size: 729
batch 219, loss: 0.3810, instance_loss: 0.4339, weighted_loss: 0.3969, label: 2, bag_size: 1069
batch 239, loss: 1.6926, instance_loss: 0.3648, weighted_loss: 1.2942, label: 2, bag_size: 1378
batch 259, loss: 0.8553, instance_loss: 0.4769, weighted_loss: 0.7418, label: 1, bag_size: 533
batch 279, loss: 0.1608, instance_loss: 0.3428, weighted_loss: 0.2154, label: 2, bag_size: 750
batch 299, loss: 0.0003, instance_loss: 0.0639, weighted_loss: 0.0194, label: 4, bag_size: 729
batch 319, loss: 0.1218, instance_loss: 0.1520, weighted_loss: 0.1309, label: 1, bag_size: 1191
batch 339, loss: 0.0128, instance_loss: 0.0428, weighted_loss: 0.0218, label: 0, bag_size: 402
batch 359, loss: 0.0123, instance_loss: 0.1597, weighted_loss: 0.0565, label: 3, bag_size: 952
batch 379, loss: 0.1007, instance_loss: 0.1466, weighted_loss: 0.1145, label: 0, bag_size: 1012
batch 399, loss: 0.1574, instance_loss: 0.4488, weighted_loss: 0.2448, label: 4, bag_size: 1337
batch 419, loss: 0.5548, instance_loss: 0.4812, weighted_loss: 0.5327, label: 1, bag_size: 786


class 0 clustering acc 0.9896470588235294: correct 16824/17000
class 1 clustering acc 0.42764705882352944: correct 1454/3400
Epoch: 22, train_loss: 0.3342, train_clustering_loss:  0.3030, train_error: 0.1129
class 0: acc 0.9239130434782609, correct 85/92
class 1: acc 0.7692307692307693, correct 60/78
class 2: acc 0.7468354430379747, correct 59/79
class 3: acc 0.989010989010989, correct 90/91
class 4: acc 0.9764705882352941, correct 83/85

Val Set, val_loss: 1.1520, val_error: 0.3800, auc: 0.8656
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 0.6, correct 6/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1662, instance_loss: 0.5672, weighted_loss: 0.2865, label: 4, bag_size: 1337
batch 39, loss: 0.2443, instance_loss: 0.3328, weighted_loss: 0.2708, label: 2, bag_size: 1006
batch 59, loss: 0.1155, instance_loss: 0.1343, weighted_loss: 0.1211, label: 1, bag_size: 937
batch 79, loss: 0.1222, instance_loss: 0.2120, weighted_loss: 0.1492, label: 1, bag_size: 1191
batch 99, loss: 0.0010, instance_loss: 0.0649, weighted_loss: 0.0201, label: 3, bag_size: 729
batch 119, loss: 0.0870, instance_loss: 0.2348, weighted_loss: 0.1313, label: 2, bag_size: 461
batch 139, loss: 0.0006, instance_loss: 0.0653, weighted_loss: 0.0200, label: 4, bag_size: 764
batch 159, loss: 0.5138, instance_loss: 0.7302, weighted_loss: 0.5787, label: 1, bag_size: 348
batch 179, loss: 0.0737, instance_loss: 0.2768, weighted_loss: 0.1347, label: 4, bag_size: 354
batch 199, loss: 2.4390, instance_loss: 0.5212, weighted_loss: 1.8636, label: 2, bag_size: 943
batch 219, loss: 0.0212, instance_loss: 0.3794, weighted_loss: 0.1286, label: 4, bag_size: 625
batch 239, loss: 0.1376, instance_loss: 0.4562, weighted_loss: 0.2332, label: 2, bag_size: 1218
batch 259, loss: 0.0486, instance_loss: 0.7196, weighted_loss: 0.2499, label: 4, bag_size: 882
batch 279, loss: 0.0394, instance_loss: 0.8013, weighted_loss: 0.2680, label: 4, bag_size: 882
batch 299, loss: 3.1613, instance_loss: 0.8969, weighted_loss: 2.4820, label: 1, bag_size: 700
batch 319, loss: 0.1002, instance_loss: 0.2809, weighted_loss: 0.1544, label: 4, bag_size: 754
batch 339, loss: 3.3652, instance_loss: 0.5246, weighted_loss: 2.5130, label: 4, bag_size: 436
batch 359, loss: 0.0572, instance_loss: 0.1708, weighted_loss: 0.0913, label: 0, bag_size: 729
batch 379, loss: 0.0320, instance_loss: 0.3056, weighted_loss: 0.1141, label: 1, bag_size: 1014
batch 399, loss: 0.0027, instance_loss: 0.1029, weighted_loss: 0.0328, label: 4, bag_size: 729
batch 419, loss: 0.2170, instance_loss: 0.2291, weighted_loss: 0.2206, label: 0, bag_size: 381


class 0 clustering acc 0.9891764705882353: correct 16816/17000
class 1 clustering acc 0.41205882352941176: correct 1401/3400
Epoch: 23, train_loss: 0.3664, train_clustering_loss:  0.3182, train_error: 0.1247
class 0: acc 0.8837209302325582, correct 76/86
class 1: acc 0.8051948051948052, correct 62/77
class 2: acc 0.7349397590361446, correct 61/83
class 3: acc 0.9893617021276596, correct 93/94
class 4: acc 0.9411764705882353, correct 80/85

Val Set, val_loss: 1.1238, val_error: 0.4000, auc: 0.8738
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.2425: correct 97/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2251, instance_loss: 0.5033, weighted_loss: 0.3086, label: 3, bag_size: 200
batch 39, loss: 0.0124, instance_loss: 0.1891, weighted_loss: 0.0654, label: 1, bag_size: 1376
batch 59, loss: 0.0300, instance_loss: 0.3869, weighted_loss: 0.1371, label: 3, bag_size: 706
batch 79, loss: 0.1149, instance_loss: 0.2523, weighted_loss: 0.1561, label: 1, bag_size: 965
batch 99, loss: 2.0783, instance_loss: 0.7297, weighted_loss: 1.6737, label: 1, bag_size: 293
batch 119, loss: 0.3598, instance_loss: 0.2154, weighted_loss: 0.3165, label: 3, bag_size: 1399
batch 139, loss: 0.0201, instance_loss: 0.0372, weighted_loss: 0.0252, label: 0, bag_size: 1143
batch 159, loss: 0.0346, instance_loss: 0.1798, weighted_loss: 0.0782, label: 4, bag_size: 773
batch 179, loss: 0.0636, instance_loss: 0.0830, weighted_loss: 0.0694, label: 3, bag_size: 1069
batch 199, loss: 0.0435, instance_loss: 0.1055, weighted_loss: 0.0621, label: 4, bag_size: 1357
batch 219, loss: 0.0006, instance_loss: 0.2146, weighted_loss: 0.0648, label: 4, bag_size: 729
batch 239, loss: 0.2144, instance_loss: 0.5327, weighted_loss: 0.3099, label: 2, bag_size: 916
batch 259, loss: 0.0094, instance_loss: 0.2305, weighted_loss: 0.0757, label: 3, bag_size: 791
batch 279, loss: 0.2625, instance_loss: 0.4617, weighted_loss: 0.3223, label: 2, bag_size: 1197
batch 299, loss: 0.1989, instance_loss: 0.2427, weighted_loss: 0.2120, label: 2, bag_size: 525
batch 319, loss: 0.0685, instance_loss: 0.2060, weighted_loss: 0.1097, label: 2, bag_size: 1019
batch 339, loss: 0.0001, instance_loss: 0.0669, weighted_loss: 0.0202, label: 4, bag_size: 729
batch 359, loss: 0.0194, instance_loss: 0.1830, weighted_loss: 0.0684, label: 3, bag_size: 729
batch 379, loss: 0.2011, instance_loss: 0.4577, weighted_loss: 0.2781, label: 1, bag_size: 778
batch 399, loss: 0.0413, instance_loss: 0.0822, weighted_loss: 0.0536, label: 1, bag_size: 937
batch 419, loss: 0.8582, instance_loss: 0.4419, weighted_loss: 0.7333, label: 2, bag_size: 1148


class 0 clustering acc 0.9885882352941177: correct 16806/17000
class 1 clustering acc 0.415: correct 1411/3400
Epoch: 24, train_loss: 0.3376, train_clustering_loss:  0.3143, train_error: 0.1176
class 0: acc 0.9506172839506173, correct 77/81
class 1: acc 0.78, correct 78/100
class 2: acc 0.782051282051282, correct 61/78
class 3: acc 0.9315068493150684, correct 68/73
class 4: acc 0.978494623655914, correct 91/93

Val Set, val_loss: 1.0869, val_error: 0.4000, auc: 0.8633
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.2075: correct 83/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0939, instance_loss: 0.2749, weighted_loss: 0.1482, label: 2, bag_size: 262
batch 39, loss: 0.6337, instance_loss: 0.4948, weighted_loss: 0.5920, label: 0, bag_size: 282
batch 59, loss: 0.3354, instance_loss: 0.2553, weighted_loss: 0.3114, label: 1, bag_size: 1127
batch 79, loss: 0.2045, instance_loss: 0.3946, weighted_loss: 0.2615, label: 0, bag_size: 432
batch 99, loss: 1.9669, instance_loss: 0.7019, weighted_loss: 1.5874, label: 0, bag_size: 423
batch 119, loss: 1.1470, instance_loss: 0.5629, weighted_loss: 0.9717, label: 2, bag_size: 373
batch 139, loss: 0.0300, instance_loss: 0.3256, weighted_loss: 0.1187, label: 4, bag_size: 817
batch 159, loss: 0.2355, instance_loss: 0.2025, weighted_loss: 0.2256, label: 4, bag_size: 928
batch 179, loss: 0.2071, instance_loss: 0.1228, weighted_loss: 0.1818, label: 3, bag_size: 1399
batch 199, loss: 0.1238, instance_loss: 0.2171, weighted_loss: 0.1518, label: 2, bag_size: 1019
batch 219, loss: 0.1401, instance_loss: 0.2512, weighted_loss: 0.1734, label: 3, bag_size: 671
batch 239, loss: 0.1103, instance_loss: 0.2321, weighted_loss: 0.1469, label: 2, bag_size: 409
batch 259, loss: 1.1972, instance_loss: 0.3549, weighted_loss: 0.9445, label: 3, bag_size: 1019
batch 279, loss: 0.0240, instance_loss: 0.2673, weighted_loss: 0.0970, label: 1, bag_size: 318
batch 299, loss: 0.0004, instance_loss: 0.1308, weighted_loss: 0.0395, label: 3, bag_size: 729
batch 319, loss: 0.0000, instance_loss: 0.1434, weighted_loss: 0.0430, label: 4, bag_size: 729
batch 339, loss: 0.0147, instance_loss: 0.0407, weighted_loss: 0.0225, label: 0, bag_size: 653
batch 359, loss: 0.1734, instance_loss: 0.4128, weighted_loss: 0.2452, label: 3, bag_size: 1250
batch 379, loss: 0.0000, instance_loss: 0.0318, weighted_loss: 0.0096, label: 4, bag_size: 729
batch 399, loss: 2.0452, instance_loss: 0.6472, weighted_loss: 1.6258, label: 1, bag_size: 770
batch 419, loss: 0.2282, instance_loss: 0.3439, weighted_loss: 0.2630, label: 2, bag_size: 499


class 0 clustering acc 0.9900588235294118: correct 16831/17000
class 1 clustering acc 0.39441176470588235: correct 1341/3400
Epoch: 25, train_loss: 0.3399, train_clustering_loss:  0.3182, train_error: 0.1153
class 0: acc 0.90625, correct 87/96
class 1: acc 0.7397260273972602, correct 54/73
class 2: acc 0.8152173913043478, correct 75/92
class 3: acc 0.975609756097561, correct 80/82
class 4: acc 0.975609756097561, correct 80/82

Val Set, val_loss: 1.1132, val_error: 0.4000, auc: 0.8698
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.2125: correct 85/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.6581, instance_loss: 0.2463, weighted_loss: 0.5345, label: 4, bag_size: 928
batch 39, loss: 0.2485, instance_loss: 0.3857, weighted_loss: 0.2897, label: 1, bag_size: 867
batch 59, loss: 0.3055, instance_loss: 0.6624, weighted_loss: 0.4126, label: 3, bag_size: 211
batch 79, loss: 0.0700, instance_loss: 0.1770, weighted_loss: 0.1021, label: 0, bag_size: 1061
batch 99, loss: 1.5579, instance_loss: 0.6207, weighted_loss: 1.2768, label: 1, bag_size: 770
batch 119, loss: 0.1175, instance_loss: 0.1742, weighted_loss: 0.1345, label: 1, bag_size: 1426
batch 139, loss: 0.1097, instance_loss: 0.4165, weighted_loss: 0.2018, label: 3, bag_size: 283
batch 159, loss: 1.3959, instance_loss: 0.4786, weighted_loss: 1.1207, label: 0, bag_size: 200
batch 179, loss: 0.1959, instance_loss: 0.2771, weighted_loss: 0.2202, label: 0, bag_size: 731
batch 199, loss: 0.1313, instance_loss: 0.2963, weighted_loss: 0.1808, label: 2, bag_size: 419
batch 219, loss: 0.0039, instance_loss: 0.0885, weighted_loss: 0.0292, label: 3, bag_size: 729
batch 239, loss: 0.0393, instance_loss: 0.3340, weighted_loss: 0.1277, label: 3, bag_size: 706
batch 259, loss: 0.0669, instance_loss: 0.2930, weighted_loss: 0.1347, label: 0, bag_size: 472
batch 279, loss: 0.1166, instance_loss: 0.2240, weighted_loss: 0.1488, label: 4, bag_size: 928
batch 299, loss: 0.3161, instance_loss: 0.4173, weighted_loss: 0.3464, label: 2, bag_size: 1215
batch 319, loss: 0.7318, instance_loss: 0.4962, weighted_loss: 0.6611, label: 1, bag_size: 343
batch 339, loss: 0.0986, instance_loss: 0.2950, weighted_loss: 0.1575, label: 2, bag_size: 461
batch 359, loss: 0.8957, instance_loss: 0.3828, weighted_loss: 0.7418, label: 2, bag_size: 358
batch 379, loss: 0.0144, instance_loss: 0.3947, weighted_loss: 0.1285, label: 3, bag_size: 1253
batch 399, loss: 0.2441, instance_loss: 0.3246, weighted_loss: 0.2682, label: 3, bag_size: 533
batch 419, loss: 0.0908, instance_loss: 0.4655, weighted_loss: 0.2032, label: 1, bag_size: 102


class 0 clustering acc 0.9894705882352941: correct 16821/17000
class 1 clustering acc 0.39029411764705885: correct 1327/3400
Epoch: 26, train_loss: 0.3497, train_clustering_loss:  0.3242, train_error: 0.1200
class 0: acc 0.9036144578313253, correct 75/83
class 1: acc 0.7792207792207793, correct 60/77
class 2: acc 0.7555555555555555, correct 68/90
class 3: acc 1.0, correct 102/102
class 4: acc 0.9452054794520548, correct 69/73

Val Set, val_loss: 1.1070, val_error: 0.3800, auc: 0.8699
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.5, correct 5/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1755, instance_loss: 0.1095, weighted_loss: 0.1557, label: 0, bag_size: 729
batch 39, loss: 0.0854, instance_loss: 0.5207, weighted_loss: 0.2160, label: 4, bag_size: 817
batch 59, loss: 0.1499, instance_loss: 0.2025, weighted_loss: 0.1657, label: 3, bag_size: 1399
batch 79, loss: 0.1196, instance_loss: 0.1252, weighted_loss: 0.1213, label: 0, bag_size: 338
batch 99, loss: 0.9383, instance_loss: 0.4825, weighted_loss: 0.8016, label: 2, bag_size: 307
batch 119, loss: 0.0741, instance_loss: 0.4588, weighted_loss: 0.1895, label: 3, bag_size: 230
batch 139, loss: 0.0004, instance_loss: 0.0751, weighted_loss: 0.0228, label: 4, bag_size: 729
batch 159, loss: 0.4957, instance_loss: 0.7755, weighted_loss: 0.5796, label: 1, bag_size: 875
batch 179, loss: 0.2374, instance_loss: 0.7059, weighted_loss: 0.3780, label: 1, bag_size: 1390
batch 199, loss: 0.0102, instance_loss: 0.0709, weighted_loss: 0.0284, label: 4, bag_size: 646
batch 219, loss: 0.0776, instance_loss: 0.3638, weighted_loss: 0.1634, label: 2, bag_size: 1533
batch 239, loss: 0.7654, instance_loss: 0.3759, weighted_loss: 0.6485, label: 4, bag_size: 928
batch 259, loss: 0.0635, instance_loss: 0.2868, weighted_loss: 0.1305, label: 4, bag_size: 354
batch 279, loss: 0.1097, instance_loss: 0.1976, weighted_loss: 0.1361, label: 3, bag_size: 343
batch 299, loss: 0.0063, instance_loss: 0.0362, weighted_loss: 0.0153, label: 0, bag_size: 616
batch 319, loss: 0.0152, instance_loss: 0.0822, weighted_loss: 0.0353, label: 3, bag_size: 729
batch 339, loss: 0.0783, instance_loss: 0.0981, weighted_loss: 0.0842, label: 3, bag_size: 556
batch 359, loss: 0.0083, instance_loss: 0.1393, weighted_loss: 0.0476, label: 3, bag_size: 729
batch 379, loss: 0.0254, instance_loss: 0.0749, weighted_loss: 0.0403, label: 0, bag_size: 653
batch 399, loss: 0.2462, instance_loss: 0.3119, weighted_loss: 0.2659, label: 3, bag_size: 317
batch 419, loss: 0.0067, instance_loss: 0.0459, weighted_loss: 0.0185, label: 0, bag_size: 982


class 0 clustering acc 0.9905882352941177: correct 16840/17000
class 1 clustering acc 0.4097058823529412: correct 1393/3400
Epoch: 27, train_loss: 0.2313, train_clustering_loss:  0.3087, train_error: 0.0659
class 0: acc 0.9852941176470589, correct 67/68
class 1: acc 0.8241758241758241, correct 75/91
class 2: acc 0.8734177215189873, correct 69/79
class 3: acc 1.0, correct 91/91
class 4: acc 0.9895833333333334, correct 95/96

Val Set, val_loss: 1.1576, val_error: 0.4400, auc: 0.8646
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3556, instance_loss: 0.3112, weighted_loss: 0.3423, label: 1, bag_size: 746
batch 39, loss: 0.4694, instance_loss: 0.5261, weighted_loss: 0.4864, label: 1, bag_size: 786
batch 59, loss: 1.3410, instance_loss: 0.5144, weighted_loss: 1.0930, label: 1, bag_size: 770
batch 79, loss: 1.4368, instance_loss: 0.5539, weighted_loss: 1.1719, label: 1, bag_size: 377
batch 99, loss: 0.0153, instance_loss: 0.0810, weighted_loss: 0.0350, label: 0, bag_size: 729
batch 119, loss: 0.0975, instance_loss: 0.2662, weighted_loss: 0.1481, label: 3, bag_size: 230
batch 139, loss: 0.2236, instance_loss: 0.7395, weighted_loss: 0.3784, label: 1, bag_size: 1409
batch 159, loss: 0.0194, instance_loss: 0.1255, weighted_loss: 0.0512, label: 1, bag_size: 1086
batch 179, loss: 0.0751, instance_loss: 0.0866, weighted_loss: 0.0786, label: 1, bag_size: 937
batch 199, loss: 0.0114, instance_loss: 0.0496, weighted_loss: 0.0229, label: 0, bag_size: 729
batch 219, loss: 0.5483, instance_loss: 0.5975, weighted_loss: 0.5630, label: 2, bag_size: 766
batch 239, loss: 0.1916, instance_loss: 0.5138, weighted_loss: 0.2882, label: 2, bag_size: 1006
batch 259, loss: 0.0021, instance_loss: 0.7206, weighted_loss: 0.2176, label: 4, bag_size: 711
batch 279, loss: 0.0155, instance_loss: 0.0388, weighted_loss: 0.0225, label: 0, bag_size: 1517
batch 299, loss: 0.0039, instance_loss: 0.0386, weighted_loss: 0.0143, label: 0, bag_size: 982
batch 319, loss: 0.0264, instance_loss: 0.0743, weighted_loss: 0.0408, label: 0, bag_size: 367
batch 339, loss: 0.0017, instance_loss: 0.0430, weighted_loss: 0.0141, label: 4, bag_size: 1278
batch 359, loss: 0.0044, instance_loss: 0.0927, weighted_loss: 0.0309, label: 0, bag_size: 976
batch 379, loss: 0.0108, instance_loss: 0.3384, weighted_loss: 0.1091, label: 3, bag_size: 952
batch 399, loss: 0.5577, instance_loss: 0.9142, weighted_loss: 0.6647, label: 1, bag_size: 651
batch 419, loss: 0.0080, instance_loss: 0.1062, weighted_loss: 0.0375, label: 3, bag_size: 729


class 0 clustering acc 0.9881176470588235: correct 16798/17000
class 1 clustering acc 0.46058823529411763: correct 1566/3400
Epoch: 28, train_loss: 0.2578, train_clustering_loss:  0.2943, train_error: 0.0918
class 0: acc 0.9375, correct 90/96
class 1: acc 0.8095238095238095, correct 68/84
class 2: acc 0.7671232876712328, correct 56/73
class 3: acc 1.0, correct 82/82
class 4: acc 1.0, correct 90/90

Val Set, val_loss: 1.1935, val_error: 0.3800, auc: 0.8615
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1867, instance_loss: 0.3066, weighted_loss: 0.2227, label: 2, bag_size: 1039
batch 39, loss: 0.7503, instance_loss: 0.4020, weighted_loss: 0.6458, label: 0, bag_size: 545
batch 59, loss: 0.4324, instance_loss: 0.3008, weighted_loss: 0.3929, label: 3, bag_size: 305
batch 79, loss: 1.1395, instance_loss: 0.6045, weighted_loss: 0.9790, label: 0, bag_size: 245
batch 99, loss: 0.1115, instance_loss: 0.1618, weighted_loss: 0.1266, label: 2, bag_size: 1019
batch 119, loss: 0.2668, instance_loss: 0.2753, weighted_loss: 0.2693, label: 2, bag_size: 839
batch 139, loss: 0.3583, instance_loss: 0.2193, weighted_loss: 0.3166, label: 2, bag_size: 1289
batch 159, loss: 0.1656, instance_loss: 0.2066, weighted_loss: 0.1779, label: 2, bag_size: 1050
batch 179, loss: 0.3271, instance_loss: 0.6284, weighted_loss: 0.4175, label: 1, bag_size: 1390
batch 199, loss: 0.2377, instance_loss: 0.4122, weighted_loss: 0.2901, label: 3, bag_size: 671
batch 219, loss: 0.3501, instance_loss: 0.3471, weighted_loss: 0.3492, label: 1, bag_size: 711
batch 239, loss: 0.1645, instance_loss: 0.3214, weighted_loss: 0.2116, label: 2, bag_size: 461
batch 259, loss: 0.0211, instance_loss: 0.1596, weighted_loss: 0.0627, label: 1, bag_size: 405
batch 279, loss: 0.1479, instance_loss: 0.4209, weighted_loss: 0.2298, label: 2, bag_size: 237
batch 299, loss: 0.0124, instance_loss: 0.1570, weighted_loss: 0.0558, label: 3, bag_size: 316
batch 319, loss: 0.6524, instance_loss: 0.4318, weighted_loss: 0.5862, label: 0, bag_size: 760
batch 339, loss: 0.0841, instance_loss: 0.2257, weighted_loss: 0.1266, label: 2, bag_size: 1404
batch 359, loss: 2.5561, instance_loss: 0.6770, weighted_loss: 1.9924, label: 0, bag_size: 423
batch 379, loss: 2.6027, instance_loss: 0.6532, weighted_loss: 2.0179, label: 2, bag_size: 355
batch 399, loss: 0.0084, instance_loss: 0.0458, weighted_loss: 0.0196, label: 0, bag_size: 982
batch 419, loss: 0.0209, instance_loss: 0.3955, weighted_loss: 0.1333, label: 4, bag_size: 656


class 0 clustering acc 0.9882941176470589: correct 16801/17000
class 1 clustering acc 0.385: correct 1309/3400
Epoch: 29, train_loss: 0.3143, train_clustering_loss:  0.3204, train_error: 0.0988
class 0: acc 0.9230769230769231, correct 72/78
class 1: acc 0.8297872340425532, correct 78/94
class 2: acc 0.8446601941747572, correct 87/103
class 3: acc 0.9883720930232558, correct 85/86
class 4: acc 0.953125, correct 61/64

Val Set, val_loss: 1.1982, val_error: 0.3800, auc: 0.8659
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.22: correct 88/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.9083, instance_loss: 0.6300, weighted_loss: 1.5248, label: 2, bag_size: 295
batch 39, loss: 0.1733, instance_loss: 0.2827, weighted_loss: 0.2061, label: 2, bag_size: 262
batch 59, loss: 0.1990, instance_loss: 0.2486, weighted_loss: 0.2139, label: 3, bag_size: 1399
batch 79, loss: 0.0046, instance_loss: 0.1260, weighted_loss: 0.0410, label: 3, bag_size: 1172
batch 99, loss: 0.0607, instance_loss: 0.1258, weighted_loss: 0.0802, label: 0, bag_size: 1301
batch 119, loss: 0.1035, instance_loss: 0.1741, weighted_loss: 0.1247, label: 4, bag_size: 773
batch 139, loss: 1.4808, instance_loss: 0.6193, weighted_loss: 1.2223, label: 1, bag_size: 435
batch 159, loss: 0.0000, instance_loss: 0.0661, weighted_loss: 0.0198, label: 4, bag_size: 729
batch 179, loss: 0.1710, instance_loss: 0.1414, weighted_loss: 0.1621, label: 3, bag_size: 1069
batch 199, loss: 0.0308, instance_loss: 0.0880, weighted_loss: 0.0479, label: 0, bag_size: 1012
batch 219, loss: 0.2407, instance_loss: 0.6399, weighted_loss: 0.3604, label: 3, bag_size: 281
batch 239, loss: 0.0241, instance_loss: 0.5089, weighted_loss: 0.1695, label: 3, bag_size: 1167
batch 259, loss: 0.1025, instance_loss: 0.2110, weighted_loss: 0.1351, label: 1, bag_size: 886
batch 279, loss: 0.1938, instance_loss: 0.5410, weighted_loss: 0.2979, label: 3, bag_size: 281
batch 299, loss: 0.0380, instance_loss: 0.2972, weighted_loss: 0.1157, label: 4, bag_size: 625
batch 319, loss: 1.4914, instance_loss: 0.6117, weighted_loss: 1.2275, label: 4, bag_size: 436
batch 339, loss: 0.0001, instance_loss: 0.0779, weighted_loss: 0.0234, label: 4, bag_size: 729
batch 359, loss: 0.6255, instance_loss: 0.4499, weighted_loss: 0.5728, label: 2, bag_size: 911
batch 379, loss: 0.0165, instance_loss: 0.1044, weighted_loss: 0.0429, label: 3, bag_size: 1172
batch 399, loss: 0.0152, instance_loss: 0.0762, weighted_loss: 0.0335, label: 0, bag_size: 1086
batch 419, loss: 0.2611, instance_loss: 0.4950, weighted_loss: 0.3313, label: 2, bag_size: 1617


class 0 clustering acc 0.9884705882352941: correct 16804/17000
class 1 clustering acc 0.445: correct 1513/3400
Epoch: 30, train_loss: 0.2920, train_clustering_loss:  0.3011, train_error: 0.1082
class 0: acc 0.94, correct 94/100
class 1: acc 0.7272727272727273, correct 56/77
class 2: acc 0.8469387755102041, correct 83/98
class 3: acc 0.9864864864864865, correct 73/74
class 4: acc 0.9605263157894737, correct 73/76

Val Set, val_loss: 1.2411, val_error: 0.4000, auc: 0.8549
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0401, instance_loss: 0.1855, weighted_loss: 0.0837, label: 0, bag_size: 729
batch 39, loss: 0.3511, instance_loss: 0.4177, weighted_loss: 0.3710, label: 1, bag_size: 1255
batch 59, loss: 0.0000, instance_loss: 0.2401, weighted_loss: 0.0720, label: 4, bag_size: 729
batch 79, loss: 0.1633, instance_loss: 0.5142, weighted_loss: 0.2686, label: 1, bag_size: 860
batch 99, loss: 0.4826, instance_loss: 0.4583, weighted_loss: 0.4753, label: 1, bag_size: 838
batch 119, loss: 0.0016, instance_loss: 0.4337, weighted_loss: 0.1312, label: 4, bag_size: 1235
batch 139, loss: 0.0172, instance_loss: 0.1506, weighted_loss: 0.0573, label: 3, bag_size: 343
batch 159, loss: 1.3709, instance_loss: 0.4808, weighted_loss: 1.1039, label: 0, bag_size: 423
batch 179, loss: 0.1449, instance_loss: 0.4155, weighted_loss: 0.2261, label: 3, bag_size: 283
batch 199, loss: 0.5395, instance_loss: 0.2992, weighted_loss: 0.4674, label: 2, bag_size: 404
batch 219, loss: 0.0198, instance_loss: 0.2062, weighted_loss: 0.0758, label: 0, bag_size: 729
batch 239, loss: 0.4635, instance_loss: 0.3463, weighted_loss: 0.4284, label: 1, bag_size: 399
batch 259, loss: 0.0664, instance_loss: 0.0929, weighted_loss: 0.0743, label: 3, bag_size: 1399
batch 279, loss: 0.0215, instance_loss: 0.4859, weighted_loss: 0.1608, label: 3, bag_size: 1167
batch 299, loss: 0.0152, instance_loss: 0.4773, weighted_loss: 0.1538, label: 4, bag_size: 1337
batch 319, loss: 1.1772, instance_loss: 0.5959, weighted_loss: 1.0028, label: 0, bag_size: 282
batch 339, loss: 0.0277, instance_loss: 0.2018, weighted_loss: 0.0799, label: 4, bag_size: 646
batch 359, loss: 0.0795, instance_loss: 0.2848, weighted_loss: 0.1411, label: 2, bag_size: 1569
batch 379, loss: 0.4163, instance_loss: 0.2844, weighted_loss: 0.3767, label: 1, bag_size: 1402
batch 399, loss: 1.8375, instance_loss: 0.5520, weighted_loss: 1.4518, label: 2, bag_size: 355
batch 419, loss: 0.0386, instance_loss: 0.3204, weighted_loss: 0.1231, label: 4, bag_size: 590


class 0 clustering acc 0.9895294117647059: correct 16822/17000
class 1 clustering acc 0.4235294117647059: correct 1440/3400
Epoch: 31, train_loss: 0.2965, train_clustering_loss:  0.3093, train_error: 0.1082
class 0: acc 0.9066666666666666, correct 68/75
class 1: acc 0.8021978021978022, correct 73/91
class 2: acc 0.7702702702702703, correct 57/74
class 3: acc 0.9887640449438202, correct 88/89
class 4: acc 0.96875, correct 93/96

Val Set, val_loss: 1.2722, val_error: 0.3800, auc: 0.8623
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.1975: correct 79/400
class 0: acc 0.5, correct 5/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.8947368421052632, correct 17/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3119, instance_loss: 0.3840, weighted_loss: 0.3335, label: 2, bag_size: 1653
batch 39, loss: 0.2010, instance_loss: 0.3735, weighted_loss: 0.2528, label: 1, bag_size: 405
batch 59, loss: 0.1000, instance_loss: 0.3483, weighted_loss: 0.1745, label: 3, bag_size: 671
batch 79, loss: 0.0001, instance_loss: 0.0512, weighted_loss: 0.0154, label: 4, bag_size: 729
batch 99, loss: 1.8405, instance_loss: 1.1360, weighted_loss: 1.6291, label: 2, bag_size: 1178
batch 119, loss: 0.0648, instance_loss: 0.2620, weighted_loss: 0.1240, label: 3, bag_size: 671
batch 139, loss: 0.0084, instance_loss: 0.0393, weighted_loss: 0.0177, label: 0, bag_size: 729
batch 159, loss: 0.0005, instance_loss: 0.0459, weighted_loss: 0.0141, label: 3, bag_size: 729
batch 179, loss: 0.0261, instance_loss: 0.2930, weighted_loss: 0.1062, label: 3, bag_size: 1253
batch 199, loss: 0.1071, instance_loss: 0.2431, weighted_loss: 0.1479, label: 4, bag_size: 773
batch 219, loss: 0.1222, instance_loss: 0.2448, weighted_loss: 0.1590, label: 2, bag_size: 499
batch 239, loss: 0.0857, instance_loss: 0.0983, weighted_loss: 0.0895, label: 4, bag_size: 790
batch 259, loss: 0.8023, instance_loss: 0.6268, weighted_loss: 0.7497, label: 2, bag_size: 1400
batch 279, loss: 0.3153, instance_loss: 0.5217, weighted_loss: 0.3772, label: 1, bag_size: 139
batch 299, loss: 0.5633, instance_loss: 0.4056, weighted_loss: 0.5160, label: 3, bag_size: 305
batch 319, loss: 0.0017, instance_loss: 0.2881, weighted_loss: 0.0876, label: 4, bag_size: 636
batch 339, loss: 0.1677, instance_loss: 0.3027, weighted_loss: 0.2082, label: 3, bag_size: 533
batch 359, loss: 0.0051, instance_loss: 0.0411, weighted_loss: 0.0159, label: 0, bag_size: 933
batch 379, loss: 0.0352, instance_loss: 0.1986, weighted_loss: 0.0842, label: 0, bag_size: 756
batch 399, loss: 0.0461, instance_loss: 0.2761, weighted_loss: 0.1151, label: 4, bag_size: 625
batch 419, loss: 0.0528, instance_loss: 0.0893, weighted_loss: 0.0637, label: 4, bag_size: 1357


class 0 clustering acc 0.989764705882353: correct 16826/17000
class 1 clustering acc 0.41705882352941176: correct 1418/3400
Epoch: 32, train_loss: 0.2992, train_clustering_loss:  0.3040, train_error: 0.0894
class 0: acc 0.8875, correct 71/80
class 1: acc 0.8533333333333334, correct 64/75
class 2: acc 0.8351648351648352, correct 76/91
class 3: acc 0.9895833333333334, correct 95/96
class 4: acc 0.9759036144578314, correct 81/83

Val Set, val_loss: 1.2188, val_error: 0.4200, auc: 0.8419
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.225: correct 90/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1151, instance_loss: 0.4859, weighted_loss: 0.2263, label: 1, bag_size: 102
batch 39, loss: 0.0236, instance_loss: 0.0451, weighted_loss: 0.0301, label: 0, bag_size: 760
batch 59, loss: 0.4018, instance_loss: 0.4071, weighted_loss: 0.4034, label: 3, bag_size: 360
batch 79, loss: 0.0159, instance_loss: 0.2426, weighted_loss: 0.0839, label: 2, bag_size: 1289
batch 99, loss: 0.1625, instance_loss: 0.0615, weighted_loss: 0.1322, label: 3, bag_size: 556
batch 119, loss: 0.2445, instance_loss: 0.3429, weighted_loss: 0.2741, label: 2, bag_size: 839
batch 139, loss: 0.1649, instance_loss: 0.6287, weighted_loss: 0.3040, label: 3, bag_size: 211
batch 159, loss: 0.0248, instance_loss: 0.1834, weighted_loss: 0.0724, label: 4, bag_size: 1176
batch 179, loss: 0.0056, instance_loss: 0.2747, weighted_loss: 0.0863, label: 4, bag_size: 754
batch 199, loss: 0.9590, instance_loss: 0.5915, weighted_loss: 0.8488, label: 1, bag_size: 917
batch 219, loss: 0.7602, instance_loss: 0.2001, weighted_loss: 0.5922, label: 3, bag_size: 1019
batch 239, loss: 0.0045, instance_loss: 0.0363, weighted_loss: 0.0141, label: 3, bag_size: 1069
batch 259, loss: 0.1184, instance_loss: 0.2312, weighted_loss: 0.1522, label: 2, bag_size: 525
batch 279, loss: 0.2734, instance_loss: 0.4790, weighted_loss: 0.3351, label: 1, bag_size: 861
batch 299, loss: 0.0003, instance_loss: 0.0492, weighted_loss: 0.0150, label: 4, bag_size: 729
batch 319, loss: 0.0157, instance_loss: 0.1377, weighted_loss: 0.0523, label: 0, bag_size: 1101
batch 339, loss: 0.0096, instance_loss: 0.0363, weighted_loss: 0.0176, label: 0, bag_size: 729
batch 359, loss: 0.4552, instance_loss: 0.2084, weighted_loss: 0.3812, label: 1, bag_size: 614
batch 379, loss: 0.2025, instance_loss: 0.2549, weighted_loss: 0.2182, label: 2, bag_size: 935
batch 399, loss: 0.6793, instance_loss: 0.3069, weighted_loss: 0.5676, label: 0, bag_size: 962
batch 419, loss: 0.2186, instance_loss: 0.3372, weighted_loss: 0.2542, label: 0, bag_size: 478


class 0 clustering acc 0.991: correct 16847/17000
class 1 clustering acc 0.44941176470588234: correct 1528/3400
Epoch: 33, train_loss: 0.2610, train_clustering_loss:  0.2909, train_error: 0.1012
class 0: acc 0.9375, correct 75/80
class 1: acc 0.8089887640449438, correct 72/89
class 2: acc 0.7974683544303798, correct 63/79
class 3: acc 0.9761904761904762, correct 82/84
class 4: acc 0.967741935483871, correct 90/93

Val Set, val_loss: 1.0920, val_error: 0.3400, auc: 0.8655
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0044, instance_loss: 0.0882, weighted_loss: 0.0295, label: 3, bag_size: 729
batch 39, loss: 0.5047, instance_loss: 0.5694, weighted_loss: 0.5241, label: 1, bag_size: 487
batch 59, loss: 0.4382, instance_loss: 0.4003, weighted_loss: 0.4268, label: 2, bag_size: 1047
batch 79, loss: 0.0204, instance_loss: 0.0965, weighted_loss: 0.0432, label: 0, bag_size: 1301
batch 99, loss: 0.0487, instance_loss: 0.1858, weighted_loss: 0.0899, label: 4, bag_size: 928
batch 119, loss: 0.3931, instance_loss: 0.2473, weighted_loss: 0.3493, label: 1, bag_size: 534
batch 139, loss: 0.0232, instance_loss: 0.2725, weighted_loss: 0.0980, label: 3, bag_size: 343
batch 159, loss: 0.1043, instance_loss: 0.3857, weighted_loss: 0.1887, label: 0, bag_size: 718
batch 179, loss: 0.0214, instance_loss: 0.2214, weighted_loss: 0.0814, label: 3, bag_size: 729
batch 199, loss: 0.0016, instance_loss: 0.2041, weighted_loss: 0.0623, label: 4, bag_size: 1278
batch 219, loss: 0.0150, instance_loss: 0.1019, weighted_loss: 0.0411, label: 0, bag_size: 1034
batch 239, loss: 0.7324, instance_loss: 0.4691, weighted_loss: 0.6534, label: 2, bag_size: 307
batch 259, loss: 0.0401, instance_loss: 0.3071, weighted_loss: 0.1202, label: 2, bag_size: 324
batch 279, loss: 0.1016, instance_loss: 0.5533, weighted_loss: 0.2371, label: 3, bag_size: 281
batch 299, loss: 0.0095, instance_loss: 0.0760, weighted_loss: 0.0295, label: 3, bag_size: 1069
batch 319, loss: 0.0136, instance_loss: 0.4340, weighted_loss: 0.1397, label: 3, bag_size: 706
batch 339, loss: 0.0098, instance_loss: 0.0823, weighted_loss: 0.0316, label: 0, bag_size: 729
batch 359, loss: 0.3851, instance_loss: 0.5029, weighted_loss: 0.4204, label: 2, bag_size: 1281
batch 379, loss: 1.3211, instance_loss: 0.6889, weighted_loss: 1.1315, label: 2, bag_size: 272
batch 399, loss: 0.0412, instance_loss: 0.0979, weighted_loss: 0.0583, label: 3, bag_size: 729
batch 419, loss: 0.0826, instance_loss: 0.0835, weighted_loss: 0.0829, label: 3, bag_size: 729


class 0 clustering acc 0.9897058823529412: correct 16825/17000
class 1 clustering acc 0.40558823529411764: correct 1379/3400
Epoch: 34, train_loss: 0.2738, train_clustering_loss:  0.3224, train_error: 0.0894
class 0: acc 0.956989247311828, correct 89/93
class 1: acc 0.8133333333333334, correct 61/75
class 2: acc 0.7906976744186046, correct 68/86
class 3: acc 0.978021978021978, correct 89/91
class 4: acc 1.0, correct 80/80

Val Set, val_loss: 1.2805, val_error: 0.4600, auc: 0.8684
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.215: correct 86/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0113, instance_loss: 0.0716, weighted_loss: 0.0294, label: 3, bag_size: 729
batch 39, loss: 0.0340, instance_loss: 0.0545, weighted_loss: 0.0402, label: 3, bag_size: 729
batch 59, loss: 0.0126, instance_loss: 0.3188, weighted_loss: 0.1044, label: 4, bag_size: 947
batch 79, loss: 0.0069, instance_loss: 0.0640, weighted_loss: 0.0240, label: 3, bag_size: 729
batch 99, loss: 0.0950, instance_loss: 0.3840, weighted_loss: 0.1817, label: 4, bag_size: 625
batch 119, loss: 0.5417, instance_loss: 0.4844, weighted_loss: 0.5245, label: 2, bag_size: 120
batch 139, loss: 0.2210, instance_loss: 0.3550, weighted_loss: 0.2612, label: 1, bag_size: 1426
batch 159, loss: 0.2521, instance_loss: 0.2940, weighted_loss: 0.2647, label: 1, bag_size: 1402
batch 179, loss: 0.9179, instance_loss: 0.8481, weighted_loss: 0.8969, label: 0, bag_size: 818
batch 199, loss: 0.0522, instance_loss: 0.2563, weighted_loss: 0.1135, label: 1, bag_size: 534
batch 219, loss: 0.0023, instance_loss: 0.0846, weighted_loss: 0.0270, label: 3, bag_size: 729
batch 239, loss: 0.0029, instance_loss: 0.0553, weighted_loss: 0.0186, label: 0, bag_size: 524
batch 259, loss: 0.0574, instance_loss: 0.2618, weighted_loss: 0.1187, label: 2, bag_size: 1123
batch 279, loss: 2.3387, instance_loss: 0.5582, weighted_loss: 1.8046, label: 2, bag_size: 500
batch 299, loss: 0.0419, instance_loss: 0.1143, weighted_loss: 0.0636, label: 3, bag_size: 729
batch 319, loss: 0.0000, instance_loss: 0.0464, weighted_loss: 0.0140, label: 4, bag_size: 729
batch 339, loss: 0.0871, instance_loss: 0.1143, weighted_loss: 0.0953, label: 3, bag_size: 1399
batch 359, loss: 0.1539, instance_loss: 0.3227, weighted_loss: 0.2045, label: 2, bag_size: 271
batch 379, loss: 0.4108, instance_loss: 0.5781, weighted_loss: 0.4610, label: 1, bag_size: 1096
batch 399, loss: 0.1497, instance_loss: 0.1441, weighted_loss: 0.1480, label: 3, bag_size: 343
batch 419, loss: 0.1695, instance_loss: 0.3683, weighted_loss: 0.2291, label: 2, bag_size: 687


class 0 clustering acc 0.988764705882353: correct 16809/17000
class 1 clustering acc 0.4370588235294118: correct 1486/3400
Epoch: 35, train_loss: 0.2295, train_clustering_loss:  0.3015, train_error: 0.0800
class 0: acc 0.9577464788732394, correct 68/71
class 1: acc 0.8295454545454546, correct 73/88
class 2: acc 0.8314606741573034, correct 74/89
class 3: acc 1.0, correct 83/83
class 4: acc 0.9893617021276596, correct 93/94

Val Set, val_loss: 1.1263, val_error: 0.3800, auc: 0.8815
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.6, correct 6/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0763, instance_loss: 0.2756, weighted_loss: 0.1361, label: 2, bag_size: 1052
batch 39, loss: 0.2746, instance_loss: 0.3713, weighted_loss: 0.3036, label: 1, bag_size: 1080
batch 59, loss: 0.0035, instance_loss: 0.0845, weighted_loss: 0.0278, label: 3, bag_size: 1172
batch 79, loss: 0.0267, instance_loss: 0.1567, weighted_loss: 0.0657, label: 2, bag_size: 399
batch 99, loss: 0.0111, instance_loss: 0.2281, weighted_loss: 0.0762, label: 2, bag_size: 1514
batch 119, loss: 0.0598, instance_loss: 0.1181, weighted_loss: 0.0773, label: 3, bag_size: 1019
batch 139, loss: 0.5008, instance_loss: 0.5342, weighted_loss: 0.5108, label: 1, bag_size: 861
batch 159, loss: 3.5485, instance_loss: 1.1472, weighted_loss: 2.8281, label: 2, bag_size: 1108
batch 179, loss: 0.0856, instance_loss: 0.5698, weighted_loss: 0.2309, label: 1, bag_size: 1390
batch 199, loss: 0.5056, instance_loss: 0.3842, weighted_loss: 0.4692, label: 2, bag_size: 271
batch 219, loss: 0.0194, instance_loss: 0.1253, weighted_loss: 0.0512, label: 1, bag_size: 994
batch 239, loss: 0.0032, instance_loss: 0.1506, weighted_loss: 0.0474, label: 1, bag_size: 866
batch 259, loss: 0.0784, instance_loss: 0.1967, weighted_loss: 0.1139, label: 0, bag_size: 367
batch 279, loss: 0.0435, instance_loss: 0.1141, weighted_loss: 0.0647, label: 0, bag_size: 446
batch 299, loss: 0.0804, instance_loss: 0.1993, weighted_loss: 0.1161, label: 2, bag_size: 399
batch 319, loss: 0.0628, instance_loss: 0.0782, weighted_loss: 0.0674, label: 0, bag_size: 367
batch 339, loss: 0.0036, instance_loss: 0.0392, weighted_loss: 0.0143, label: 0, bag_size: 982
batch 359, loss: 0.5803, instance_loss: 0.3400, weighted_loss: 0.5082, label: 2, bag_size: 1047
batch 379, loss: 0.2676, instance_loss: 0.2691, weighted_loss: 0.2681, label: 0, bag_size: 367
batch 399, loss: 0.0010, instance_loss: 0.0647, weighted_loss: 0.0201, label: 3, bag_size: 729
batch 419, loss: 0.0537, instance_loss: 0.5442, weighted_loss: 0.2008, label: 4, bag_size: 1337


class 0 clustering acc 0.9893529411764705: correct 16819/17000
class 1 clustering acc 0.4194117647058824: correct 1426/3400
Epoch: 36, train_loss: 0.2203, train_clustering_loss:  0.3078, train_error: 0.0753
class 0: acc 0.9871794871794872, correct 77/78
class 1: acc 0.7922077922077922, correct 61/77
class 2: acc 0.8478260869565217, correct 78/92
class 3: acc 0.989010989010989, correct 90/91
class 4: acc 1.0, correct 87/87

Val Set, val_loss: 1.1653, val_error: 0.3400, auc: 0.8811
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.225: correct 90/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0868, instance_loss: 0.1480, weighted_loss: 0.1051, label: 3, bag_size: 1399
batch 39, loss: 0.1635, instance_loss: 0.1715, weighted_loss: 0.1659, label: 3, bag_size: 1399
batch 59, loss: 0.0177, instance_loss: 0.2478, weighted_loss: 0.0867, label: 2, bag_size: 421
batch 79, loss: 0.0047, instance_loss: 0.0309, weighted_loss: 0.0126, label: 0, bag_size: 239
batch 99, loss: 0.0200, instance_loss: 0.2441, weighted_loss: 0.0873, label: 2, bag_size: 421
batch 119, loss: 0.0177, instance_loss: 0.0469, weighted_loss: 0.0265, label: 0, bag_size: 729
batch 139, loss: 1.0046, instance_loss: 0.4310, weighted_loss: 0.8325, label: 1, bag_size: 1197
batch 159, loss: 0.5142, instance_loss: 0.4492, weighted_loss: 0.4947, label: 1, bag_size: 861
batch 179, loss: 0.0026, instance_loss: 0.0922, weighted_loss: 0.0295, label: 3, bag_size: 729
batch 199, loss: 0.1440, instance_loss: 0.2505, weighted_loss: 0.1760, label: 1, bag_size: 696
batch 219, loss: 0.1268, instance_loss: 0.1063, weighted_loss: 0.1207, label: 0, bag_size: 760
batch 239, loss: 0.0370, instance_loss: 0.2359, weighted_loss: 0.0967, label: 2, bag_size: 461
batch 259, loss: 0.0904, instance_loss: 0.5881, weighted_loss: 0.2397, label: 3, bag_size: 281
batch 279, loss: 0.1079, instance_loss: 0.3051, weighted_loss: 0.1671, label: 2, bag_size: 1200
batch 299, loss: 0.3466, instance_loss: 0.1610, weighted_loss: 0.2909, label: 3, bag_size: 1019
batch 319, loss: 0.0228, instance_loss: 0.4003, weighted_loss: 0.1360, label: 1, bag_size: 102
batch 339, loss: 0.0000, instance_loss: 0.0186, weighted_loss: 0.0056, label: 4, bag_size: 729
batch 359, loss: 0.1590, instance_loss: 0.1837, weighted_loss: 0.1664, label: 4, bag_size: 646
batch 379, loss: 0.5088, instance_loss: 0.3271, weighted_loss: 0.4543, label: 1, bag_size: 1402
batch 399, loss: 0.0699, instance_loss: 0.4763, weighted_loss: 0.1918, label: 4, bag_size: 297
batch 419, loss: 0.0331, instance_loss: 0.4767, weighted_loss: 0.1662, label: 2, bag_size: 237


class 0 clustering acc 0.9898823529411764: correct 16828/17000
class 1 clustering acc 0.4061764705882353: correct 1381/3400
Epoch: 37, train_loss: 0.2440, train_clustering_loss:  0.3069, train_error: 0.0824
class 0: acc 0.9397590361445783, correct 78/83
class 1: acc 0.8117647058823529, correct 69/85
class 2: acc 0.8712871287128713, correct 88/101
class 3: acc 1.0, correct 80/80
class 4: acc 0.9868421052631579, correct 75/76

Val Set, val_loss: 1.2495, val_error: 0.3600, auc: 0.8615
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.27: correct 108/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2345, instance_loss: 0.5168, weighted_loss: 0.3192, label: 4, bag_size: 1331
batch 39, loss: 0.0116, instance_loss: 0.3900, weighted_loss: 0.1251, label: 3, bag_size: 706
batch 59, loss: 0.3485, instance_loss: 0.5150, weighted_loss: 0.3985, label: 1, bag_size: 861
batch 79, loss: 0.0009, instance_loss: 0.0754, weighted_loss: 0.0233, label: 3, bag_size: 729
batch 99, loss: 0.0134, instance_loss: 0.0549, weighted_loss: 0.0259, label: 0, bag_size: 602
batch 119, loss: 0.0404, instance_loss: 0.3681, weighted_loss: 0.1387, label: 1, bag_size: 897
batch 139, loss: 0.0627, instance_loss: 0.3485, weighted_loss: 0.1484, label: 4, bag_size: 590
batch 159, loss: 0.0059, instance_loss: 0.0764, weighted_loss: 0.0270, label: 3, bag_size: 729
batch 179, loss: 0.0586, instance_loss: 0.4031, weighted_loss: 0.1619, label: 1, bag_size: 897
batch 199, loss: 0.0262, instance_loss: 0.1453, weighted_loss: 0.0619, label: 3, bag_size: 952
batch 219, loss: 1.2743, instance_loss: 0.6003, weighted_loss: 1.0721, label: 0, bag_size: 801
batch 239, loss: 0.0394, instance_loss: 0.1908, weighted_loss: 0.0848, label: 1, bag_size: 696
batch 259, loss: 0.2035, instance_loss: 0.6683, weighted_loss: 0.3429, label: 1, bag_size: 778
batch 279, loss: 0.0002, instance_loss: 0.1265, weighted_loss: 0.0381, label: 4, bag_size: 729
batch 299, loss: 0.0829, instance_loss: 0.4179, weighted_loss: 0.1834, label: 3, bag_size: 283
batch 319, loss: 1.8923, instance_loss: 0.6290, weighted_loss: 1.5133, label: 2, bag_size: 948
batch 339, loss: 0.3138, instance_loss: 0.2225, weighted_loss: 0.2864, label: 2, bag_size: 404
batch 359, loss: 0.0171, instance_loss: 0.1032, weighted_loss: 0.0429, label: 3, bag_size: 1019
batch 379, loss: 0.0037, instance_loss: 0.0586, weighted_loss: 0.0202, label: 0, bag_size: 976
batch 399, loss: 3.7695, instance_loss: 1.1112, weighted_loss: 2.9720, label: 2, bag_size: 1178
batch 419, loss: 0.0948, instance_loss: 0.1779, weighted_loss: 0.1197, label: 1, bag_size: 1325


class 0 clustering acc 0.990764705882353: correct 16843/17000
class 1 clustering acc 0.4223529411764706: correct 1436/3400
Epoch: 38, train_loss: 0.1772, train_clustering_loss:  0.2997, train_error: 0.0494
class 0: acc 0.95, correct 57/60
class 1: acc 0.9176470588235294, correct 78/85
class 2: acc 0.8690476190476191, correct 73/84
class 3: acc 1.0, correct 109/109
class 4: acc 1.0, correct 87/87

Val Set, val_loss: 1.3256, val_error: 0.4000, auc: 0.8800
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 0.5, correct 5/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.2771, instance_loss: 0.4973, weighted_loss: 0.3431, label: 1, bag_size: 1273
batch 39, loss: 0.4089, instance_loss: 0.5085, weighted_loss: 0.4388, label: 2, bag_size: 1514
batch 59, loss: 0.6669, instance_loss: 0.5351, weighted_loss: 0.6274, label: 1, bag_size: 746
batch 79, loss: 0.2228, instance_loss: 0.4041, weighted_loss: 0.2772, label: 1, bag_size: 442
batch 99, loss: 0.2302, instance_loss: 0.3135, weighted_loss: 0.2552, label: 1, bag_size: 598
batch 119, loss: 0.0109, instance_loss: 0.1872, weighted_loss: 0.0638, label: 1, bag_size: 318
batch 139, loss: 0.0042, instance_loss: 0.3126, weighted_loss: 0.0967, label: 4, bag_size: 1176
batch 159, loss: 0.0547, instance_loss: 0.2563, weighted_loss: 0.1152, label: 1, bag_size: 682
batch 179, loss: 0.1522, instance_loss: 0.3988, weighted_loss: 0.2261, label: 1, bag_size: 399
batch 199, loss: 0.2492, instance_loss: 0.2916, weighted_loss: 0.2620, label: 2, bag_size: 1348
batch 219, loss: 0.0467, instance_loss: 0.5473, weighted_loss: 0.1969, label: 4, bag_size: 1337
batch 239, loss: 0.0001, instance_loss: 0.1007, weighted_loss: 0.0303, label: 3, bag_size: 729
batch 259, loss: 0.0006, instance_loss: 0.1513, weighted_loss: 0.0458, label: 3, bag_size: 729
batch 279, loss: 0.0811, instance_loss: 0.1430, weighted_loss: 0.0997, label: 4, bag_size: 1357
batch 299, loss: 0.0256, instance_loss: 0.1074, weighted_loss: 0.0501, label: 3, bag_size: 451
batch 319, loss: 0.0068, instance_loss: 0.0415, weighted_loss: 0.0172, label: 4, bag_size: 729
batch 339, loss: 0.1151, instance_loss: 0.6244, weighted_loss: 0.2679, label: 2, bag_size: 248
batch 359, loss: 0.0291, instance_loss: 0.2856, weighted_loss: 0.1060, label: 3, bag_size: 671
batch 379, loss: 0.0234, instance_loss: 0.2913, weighted_loss: 0.1038, label: 2, bag_size: 1164
batch 399, loss: 0.0466, instance_loss: 0.1752, weighted_loss: 0.0852, label: 0, bag_size: 1255
batch 419, loss: 0.0073, instance_loss: 0.0693, weighted_loss: 0.0259, label: 0, bag_size: 338


class 0 clustering acc 0.9894117647058823: correct 16820/17000
class 1 clustering acc 0.4429411764705882: correct 1506/3400
Epoch: 39, train_loss: 0.1956, train_clustering_loss:  0.3003, train_error: 0.0588
class 0: acc 0.9166666666666666, correct 77/84
class 1: acc 0.9204545454545454, correct 81/88
class 2: acc 0.8625, correct 69/80
class 3: acc 1.0, correct 83/83
class 4: acc 1.0, correct 90/90

Val Set, val_loss: 1.5404, val_error: 0.4000, auc: 0.8533
class 0 clustering acc 0.9655: correct 1931/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0162, instance_loss: 0.2570, weighted_loss: 0.0884, label: 4, bag_size: 1002
batch 39, loss: 0.0197, instance_loss: 0.0467, weighted_loss: 0.0278, label: 4, bag_size: 1121
batch 59, loss: 0.0184, instance_loss: 0.3131, weighted_loss: 0.1068, label: 1, bag_size: 504
batch 79, loss: 0.0154, instance_loss: 0.2385, weighted_loss: 0.0823, label: 3, bag_size: 841
batch 99, loss: 0.0166, instance_loss: 0.0750, weighted_loss: 0.0341, label: 0, bag_size: 729
batch 119, loss: 1.0095, instance_loss: 0.5514, weighted_loss: 0.8720, label: 0, bag_size: 423
batch 139, loss: 0.0008, instance_loss: 0.0378, weighted_loss: 0.0119, label: 3, bag_size: 729
batch 159, loss: 0.0032, instance_loss: 0.2565, weighted_loss: 0.0792, label: 4, bag_size: 656
batch 179, loss: 0.2758, instance_loss: 0.3407, weighted_loss: 0.2953, label: 2, bag_size: 621
batch 199, loss: 0.0304, instance_loss: 0.3578, weighted_loss: 0.1286, label: 3, bag_size: 533
batch 219, loss: 1.2520, instance_loss: 0.4859, weighted_loss: 1.0222, label: 2, bag_size: 317
batch 239, loss: 0.0403, instance_loss: 0.3194, weighted_loss: 0.1241, label: 3, bag_size: 671
batch 259, loss: 0.0013, instance_loss: 0.0825, weighted_loss: 0.0257, label: 4, bag_size: 729
batch 279, loss: 0.0057, instance_loss: 0.4572, weighted_loss: 0.1411, label: 3, bag_size: 1250
batch 299, loss: 0.2435, instance_loss: 0.5970, weighted_loss: 0.3495, label: 1, bag_size: 786
batch 319, loss: 0.2548, instance_loss: 0.2441, weighted_loss: 0.2516, label: 1, bag_size: 903
batch 339, loss: 0.2325, instance_loss: 0.3233, weighted_loss: 0.2598, label: 2, bag_size: 932
batch 359, loss: 0.0534, instance_loss: 0.7329, weighted_loss: 0.2572, label: 4, bag_size: 366
batch 379, loss: 0.0000, instance_loss: 0.2792, weighted_loss: 0.0838, label: 4, bag_size: 729
batch 399, loss: 0.7953, instance_loss: 0.5014, weighted_loss: 0.7071, label: 1, bag_size: 1197
batch 419, loss: 0.0166, instance_loss: 0.1820, weighted_loss: 0.0662, label: 3, bag_size: 952


class 0 clustering acc 0.9889411764705882: correct 16812/17000
class 1 clustering acc 0.455: correct 1547/3400
Epoch: 40, train_loss: 0.2112, train_clustering_loss:  0.2965, train_error: 0.0776
class 0: acc 0.9659090909090909, correct 85/88
class 1: acc 0.797752808988764, correct 71/89
class 2: acc 0.84, correct 63/75
class 3: acc 1.0, correct 90/90
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.2374, val_error: 0.3600, auc: 0.8823
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0980, instance_loss: 0.3422, weighted_loss: 0.1713, label: 1, bag_size: 405
batch 39, loss: 0.0175, instance_loss: 0.2333, weighted_loss: 0.0823, label: 2, bag_size: 400
batch 59, loss: 0.1043, instance_loss: 0.1975, weighted_loss: 0.1323, label: 3, bag_size: 343
batch 79, loss: 0.0073, instance_loss: 0.5713, weighted_loss: 0.1765, label: 4, bag_size: 882
batch 99, loss: 0.1639, instance_loss: 0.3996, weighted_loss: 0.2346, label: 3, bag_size: 230
batch 119, loss: 0.0151, instance_loss: 0.3970, weighted_loss: 0.1297, label: 4, bag_size: 1337
batch 139, loss: 0.0001, instance_loss: 0.0576, weighted_loss: 0.0174, label: 3, bag_size: 729
batch 159, loss: 0.0009, instance_loss: 0.1776, weighted_loss: 0.0539, label: 4, bag_size: 1235
batch 179, loss: 0.0007, instance_loss: 0.3690, weighted_loss: 0.1112, label: 4, bag_size: 817
batch 199, loss: 0.2725, instance_loss: 0.6212, weighted_loss: 0.3771, label: 0, bag_size: 423
batch 219, loss: 0.0851, instance_loss: 0.3327, weighted_loss: 0.1594, label: 0, bag_size: 807
batch 239, loss: 0.0557, instance_loss: 0.1259, weighted_loss: 0.0767, label: 1, bag_size: 937
batch 259, loss: 0.0090, instance_loss: 0.0352, weighted_loss: 0.0168, label: 0, bag_size: 1143
batch 279, loss: 0.0199, instance_loss: 0.6556, weighted_loss: 0.2106, label: 1, bag_size: 651
batch 299, loss: 0.5931, instance_loss: 0.2473, weighted_loss: 0.4894, label: 1, bag_size: 711
batch 319, loss: 0.1178, instance_loss: 0.3072, weighted_loss: 0.1747, label: 0, bag_size: 1527
batch 339, loss: 0.0219, instance_loss: 0.2405, weighted_loss: 0.0875, label: 4, bag_size: 590
batch 359, loss: 0.0015, instance_loss: 0.0302, weighted_loss: 0.0101, label: 4, bag_size: 1278
batch 379, loss: 1.9268, instance_loss: 0.6349, weighted_loss: 1.5392, label: 2, bag_size: 748
batch 399, loss: 1.5951, instance_loss: 0.5080, weighted_loss: 1.2690, label: 1, bag_size: 446
batch 419, loss: 0.4165, instance_loss: 0.3688, weighted_loss: 0.4022, label: 2, bag_size: 1047


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.4455882352941177: correct 1515/3400
Epoch: 41, train_loss: 0.1852, train_clustering_loss:  0.2953, train_error: 0.0659
class 0: acc 0.9855072463768116, correct 68/69
class 1: acc 0.8484848484848485, correct 84/99
class 2: acc 0.8658536585365854, correct 71/82
class 3: acc 1.0, correct 78/78
class 4: acc 0.9896907216494846, correct 96/97

Val Set, val_loss: 1.3139, val_error: 0.3800, auc: 0.8779
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.6, correct 6/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0067, instance_loss: 0.0280, weighted_loss: 0.0131, label: 0, bag_size: 1872
batch 39, loss: 0.0618, instance_loss: 0.2642, weighted_loss: 0.1225, label: 4, bag_size: 773
batch 59, loss: 0.0430, instance_loss: 0.7417, weighted_loss: 0.2526, label: 3, bag_size: 200
batch 79, loss: 0.2923, instance_loss: 0.2774, weighted_loss: 0.2878, label: 2, bag_size: 1215
batch 99, loss: 0.0197, instance_loss: 0.5177, weighted_loss: 0.1691, label: 3, bag_size: 706
batch 119, loss: 0.1756, instance_loss: 0.4677, weighted_loss: 0.2632, label: 0, bag_size: 423
batch 139, loss: 0.0230, instance_loss: 0.0940, weighted_loss: 0.0443, label: 0, bag_size: 653
batch 159, loss: 0.0003, instance_loss: 0.5410, weighted_loss: 0.1625, label: 4, bag_size: 711
batch 179, loss: 0.0095, instance_loss: 0.0262, weighted_loss: 0.0145, label: 3, bag_size: 729
batch 199, loss: 0.1910, instance_loss: 0.2374, weighted_loss: 0.2049, label: 2, bag_size: 2703
batch 219, loss: 0.0555, instance_loss: 0.2404, weighted_loss: 0.1110, label: 1, bag_size: 530
batch 239, loss: 0.0846, instance_loss: 0.4429, weighted_loss: 0.1921, label: 3, bag_size: 200
batch 259, loss: 0.0000, instance_loss: 0.2720, weighted_loss: 0.0816, label: 4, bag_size: 729
batch 279, loss: 0.0176, instance_loss: 0.8572, weighted_loss: 0.2695, label: 1, bag_size: 651
batch 299, loss: 1.4010, instance_loss: 0.6261, weighted_loss: 1.1685, label: 1, bag_size: 1376
batch 319, loss: 0.0279, instance_loss: 0.2014, weighted_loss: 0.0799, label: 1, bag_size: 614
batch 339, loss: 0.0782, instance_loss: 0.3020, weighted_loss: 0.1453, label: 1, bag_size: 711
batch 359, loss: 0.0013, instance_loss: 0.3314, weighted_loss: 0.1003, label: 3, bag_size: 791
batch 379, loss: 0.0784, instance_loss: 0.2710, weighted_loss: 0.1362, label: 2, bag_size: 1039
batch 399, loss: 0.0115, instance_loss: 0.0473, weighted_loss: 0.0222, label: 0, bag_size: 1517
batch 419, loss: 0.0002, instance_loss: 0.1551, weighted_loss: 0.0467, label: 4, bag_size: 729


class 0 clustering acc 0.988764705882353: correct 16809/17000
class 1 clustering acc 0.42323529411764704: correct 1439/3400
Epoch: 42, train_loss: 0.1823, train_clustering_loss:  0.3063, train_error: 0.0518
class 0: acc 0.9615384615384616, correct 75/78
class 1: acc 0.875, correct 77/88
class 2: acc 0.9263157894736842, correct 88/95
class 3: acc 0.9879518072289156, correct 82/83
class 4: acc 1.0, correct 81/81

Val Set, val_loss: 1.2435, val_error: 0.3400, auc: 0.8724
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.26: correct 104/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0469, instance_loss: 0.2055, weighted_loss: 0.0945, label: 3, bag_size: 729
batch 39, loss: 0.0637, instance_loss: 0.1834, weighted_loss: 0.0996, label: 3, bag_size: 1019
batch 59, loss: 0.0001, instance_loss: 0.1581, weighted_loss: 0.0475, label: 4, bag_size: 729
batch 79, loss: 0.0010, instance_loss: 0.3256, weighted_loss: 0.0984, label: 4, bag_size: 1002
batch 99, loss: 0.0343, instance_loss: 0.2629, weighted_loss: 0.1029, label: 4, bag_size: 354
batch 119, loss: 0.0165, instance_loss: 0.2946, weighted_loss: 0.1000, label: 4, bag_size: 928
batch 139, loss: 0.0736, instance_loss: 0.1800, weighted_loss: 0.1055, label: 1, bag_size: 858
batch 159, loss: 0.1074, instance_loss: 0.3330, weighted_loss: 0.1751, label: 1, bag_size: 320
batch 179, loss: 0.7981, instance_loss: 0.3894, weighted_loss: 0.6755, label: 1, bag_size: 533
batch 199, loss: 0.8799, instance_loss: 0.5806, weighted_loss: 0.7901, label: 2, bag_size: 649
batch 219, loss: 0.0060, instance_loss: 0.1592, weighted_loss: 0.0520, label: 1, bag_size: 318
batch 239, loss: 0.0021, instance_loss: 0.1697, weighted_loss: 0.0524, label: 4, bag_size: 524
batch 259, loss: 0.0365, instance_loss: 0.3831, weighted_loss: 0.1405, label: 1, bag_size: 1144
batch 279, loss: 0.0209, instance_loss: 0.0800, weighted_loss: 0.0387, label: 0, bag_size: 1133
batch 299, loss: 0.0268, instance_loss: 0.0667, weighted_loss: 0.0388, label: 0, bag_size: 1061
batch 319, loss: 0.7560, instance_loss: 0.5524, weighted_loss: 0.6949, label: 2, bag_size: 120
batch 339, loss: 0.0010, instance_loss: 0.0983, weighted_loss: 0.0302, label: 4, bag_size: 1002
batch 359, loss: 0.0712, instance_loss: 0.6370, weighted_loss: 0.2410, label: 4, bag_size: 366
batch 379, loss: 2.2347, instance_loss: 0.6753, weighted_loss: 1.7669, label: 1, bag_size: 293
batch 399, loss: 0.0001, instance_loss: 0.1163, weighted_loss: 0.0350, label: 3, bag_size: 729
batch 419, loss: 0.0098, instance_loss: 0.0951, weighted_loss: 0.0354, label: 3, bag_size: 729


class 0 clustering acc 0.9892352941176471: correct 16817/17000
class 1 clustering acc 0.4547058823529412: correct 1546/3400
Epoch: 43, train_loss: 0.1762, train_clustering_loss:  0.2914, train_error: 0.0565
class 0: acc 0.9605263157894737, correct 73/76
class 1: acc 0.8571428571428571, correct 72/84
class 2: acc 0.9052631578947369, correct 86/95
class 3: acc 1.0, correct 93/93
class 4: acc 1.0, correct 77/77

Val Set, val_loss: 1.2263, val_error: 0.3600, auc: 0.8710
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.2425: correct 97/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.1135, instance_loss: 0.5140, weighted_loss: 0.2336, label: 4, bag_size: 436
batch 39, loss: 0.0593, instance_loss: 0.1599, weighted_loss: 0.0895, label: 1, bag_size: 937
batch 59, loss: 0.0003, instance_loss: 0.0866, weighted_loss: 0.0261, label: 4, bag_size: 729
batch 79, loss: 0.0380, instance_loss: 0.1454, weighted_loss: 0.0702, label: 1, bag_size: 858
batch 99, loss: 0.0644, instance_loss: 0.3132, weighted_loss: 0.1391, label: 2, bag_size: 863
batch 119, loss: 0.2294, instance_loss: 0.1785, weighted_loss: 0.2141, label: 3, bag_size: 1399
batch 139, loss: 0.1834, instance_loss: 0.2988, weighted_loss: 0.2180, label: 0, bag_size: 570
batch 159, loss: 0.0744, instance_loss: 0.4457, weighted_loss: 0.1858, label: 4, bag_size: 1331
batch 179, loss: 0.0019, instance_loss: 0.0236, weighted_loss: 0.0084, label: 4, bag_size: 1278
batch 199, loss: 0.0030, instance_loss: 0.1606, weighted_loss: 0.0503, label: 0, bag_size: 898
batch 219, loss: 0.0613, instance_loss: 0.2294, weighted_loss: 0.1117, label: 0, bag_size: 1034
batch 239, loss: 0.8145, instance_loss: 0.7062, weighted_loss: 0.7820, label: 1, bag_size: 1273
batch 259, loss: 0.0630, instance_loss: 0.3575, weighted_loss: 0.1514, label: 1, bag_size: 838
batch 279, loss: 0.0008, instance_loss: 0.2110, weighted_loss: 0.0639, label: 4, bag_size: 729
batch 299, loss: 0.0000, instance_loss: 0.2445, weighted_loss: 0.0733, label: 4, bag_size: 729
batch 319, loss: 0.0441, instance_loss: 0.3895, weighted_loss: 0.1477, label: 3, bag_size: 305
batch 339, loss: 0.0255, instance_loss: 0.3092, weighted_loss: 0.1106, label: 3, bag_size: 317
batch 359, loss: 0.0499, instance_loss: 0.2608, weighted_loss: 0.1131, label: 4, bag_size: 928
batch 379, loss: 0.2577, instance_loss: 0.3313, weighted_loss: 0.2798, label: 1, bag_size: 1096
batch 399, loss: 0.0025, instance_loss: 0.1747, weighted_loss: 0.0542, label: 3, bag_size: 729
batch 419, loss: 0.0012, instance_loss: 0.8115, weighted_loss: 0.2443, label: 4, bag_size: 711


class 0 clustering acc 0.9890588235294118: correct 16814/17000
class 1 clustering acc 0.4388235294117647: correct 1492/3400
Epoch: 44, train_loss: 0.1791, train_clustering_loss:  0.2976, train_error: 0.0682
class 0: acc 0.9367088607594937, correct 74/79
class 1: acc 0.8804347826086957, correct 81/92
class 2: acc 0.8651685393258427, correct 77/89
class 3: acc 0.9895833333333334, correct 95/96
class 4: acc 1.0, correct 69/69

Val Set, val_loss: 1.3590, val_error: 0.4200, auc: 0.8801
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0000, instance_loss: 0.1069, weighted_loss: 0.0321, label: 4, bag_size: 729
batch 39, loss: 0.1350, instance_loss: 0.2868, weighted_loss: 0.1805, label: 3, bag_size: 343
batch 59, loss: 0.0021, instance_loss: 0.0727, weighted_loss: 0.0233, label: 3, bag_size: 305
batch 79, loss: 0.0021, instance_loss: 0.0306, weighted_loss: 0.0106, label: 0, bag_size: 402
batch 99, loss: 0.0465, instance_loss: 0.4724, weighted_loss: 0.1743, label: 1, bag_size: 102
batch 119, loss: 0.3200, instance_loss: 0.5977, weighted_loss: 0.4033, label: 2, bag_size: 748
batch 139, loss: 0.0307, instance_loss: 0.2774, weighted_loss: 0.1047, label: 1, bag_size: 1080
batch 159, loss: 0.0194, instance_loss: 0.2861, weighted_loss: 0.0994, label: 3, bag_size: 841
batch 179, loss: 0.0005, instance_loss: 0.0645, weighted_loss: 0.0197, label: 3, bag_size: 729
batch 199, loss: 0.2851, instance_loss: 0.3968, weighted_loss: 0.3186, label: 1, bag_size: 320
batch 219, loss: 0.0018, instance_loss: 0.0327, weighted_loss: 0.0111, label: 0, bag_size: 933
batch 239, loss: 0.0461, instance_loss: 0.2803, weighted_loss: 0.1163, label: 0, bag_size: 1018
batch 259, loss: 0.0006, instance_loss: 0.0879, weighted_loss: 0.0268, label: 4, bag_size: 524
batch 279, loss: 3.0120, instance_loss: 0.7108, weighted_loss: 2.3216, label: 1, bag_size: 446
batch 299, loss: 0.0232, instance_loss: 0.0801, weighted_loss: 0.0403, label: 0, bag_size: 446
batch 319, loss: 0.0117, instance_loss: 0.0286, weighted_loss: 0.0168, label: 0, bag_size: 602
batch 339, loss: 0.0320, instance_loss: 0.1973, weighted_loss: 0.0816, label: 2, bag_size: 1289
batch 359, loss: 0.0069, instance_loss: 0.0737, weighted_loss: 0.0269, label: 0, bag_size: 760
batch 379, loss: 0.3707, instance_loss: 0.8519, weighted_loss: 0.5150, label: 1, bag_size: 1273
batch 399, loss: 0.0233, instance_loss: 0.4149, weighted_loss: 0.1408, label: 1, bag_size: 102
batch 419, loss: 0.0154, instance_loss: 0.1720, weighted_loss: 0.0624, label: 2, bag_size: 469


class 0 clustering acc 0.989764705882353: correct 16826/17000
class 1 clustering acc 0.4888235294117647: correct 1662/3400
Epoch: 45, train_loss: 0.1897, train_clustering_loss:  0.2767, train_error: 0.0471
class 0: acc 0.9903846153846154, correct 103/104
class 1: acc 0.9324324324324325, correct 69/74
class 2: acc 0.8441558441558441, correct 65/77
class 3: acc 1.0, correct 90/90
class 4: acc 0.975, correct 78/80

Val Set, val_loss: 1.3960, val_error: 0.3400, auc: 0.8661
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.8421052631578947, correct 16/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0576, instance_loss: 0.2579, weighted_loss: 0.1177, label: 3, bag_size: 533
batch 39, loss: 0.0274, instance_loss: 0.1573, weighted_loss: 0.0664, label: 2, bag_size: 323
batch 59, loss: 0.7980, instance_loss: 0.4463, weighted_loss: 0.6925, label: 2, bag_size: 500
batch 79, loss: 0.0213, instance_loss: 0.1557, weighted_loss: 0.0616, label: 2, bag_size: 470
batch 99, loss: 0.0222, instance_loss: 0.4138, weighted_loss: 0.1397, label: 2, bag_size: 323
batch 119, loss: 0.0003, instance_loss: 0.0862, weighted_loss: 0.0261, label: 3, bag_size: 729
batch 139, loss: 0.0019, instance_loss: 0.1396, weighted_loss: 0.0432, label: 4, bag_size: 1278
batch 159, loss: 0.0016, instance_loss: 0.0584, weighted_loss: 0.0186, label: 3, bag_size: 729
batch 179, loss: 0.0477, instance_loss: 0.3800, weighted_loss: 0.1474, label: 2, bag_size: 861
batch 199, loss: 0.0117, instance_loss: 0.0877, weighted_loss: 0.0345, label: 3, bag_size: 729
batch 219, loss: 0.0310, instance_loss: 0.4921, weighted_loss: 0.1693, label: 1, bag_size: 102
batch 239, loss: 0.0002, instance_loss: 0.1907, weighted_loss: 0.0574, label: 1, bag_size: 1376
batch 259, loss: 0.0026, instance_loss: 0.1363, weighted_loss: 0.0427, label: 4, bag_size: 1357
batch 279, loss: 0.3545, instance_loss: 0.2268, weighted_loss: 0.3162, label: 0, bag_size: 350
batch 299, loss: 0.2609, instance_loss: 0.4199, weighted_loss: 0.3086, label: 0, bag_size: 466
batch 319, loss: 0.0013, instance_loss: 0.0603, weighted_loss: 0.0190, label: 0, bag_size: 976
batch 339, loss: 0.0154, instance_loss: 0.1180, weighted_loss: 0.0462, label: 0, bag_size: 1018
batch 359, loss: 0.1538, instance_loss: 0.4096, weighted_loss: 0.2305, label: 2, bag_size: 1533
batch 379, loss: 0.0448, instance_loss: 0.2790, weighted_loss: 0.1150, label: 2, bag_size: 307
batch 399, loss: 0.0231, instance_loss: 0.2362, weighted_loss: 0.0870, label: 2, bag_size: 1123
batch 419, loss: 0.5420, instance_loss: 0.3625, weighted_loss: 0.4881, label: 2, bag_size: 500


class 0 clustering acc 0.988764705882353: correct 16809/17000
class 1 clustering acc 0.49470588235294116: correct 1682/3400
Epoch: 46, train_loss: 0.1142, train_clustering_loss:  0.2773, train_error: 0.0165
class 0: acc 1.0, correct 86/86
class 1: acc 0.9436619718309859, correct 67/71
class 2: acc 0.9680851063829787, correct 91/94
class 3: acc 1.0, correct 93/93
class 4: acc 1.0, correct 81/81

Val Set, val_loss: 1.4542, val_error: 0.3400, auc: 0.8789
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.305: correct 122/400
class 0: acc 0.5, correct 5/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.9473684210526315, correct 18/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0361, weighted_loss: 0.0108, label: 4, bag_size: 729
batch 39, loss: 0.0371, instance_loss: 0.6041, weighted_loss: 0.2072, label: 1, bag_size: 1390
batch 59, loss: 0.0006, instance_loss: 0.1919, weighted_loss: 0.0580, label: 4, bag_size: 947
batch 79, loss: 0.1221, instance_loss: 0.1447, weighted_loss: 0.1289, label: 1, bag_size: 886
batch 99, loss: 0.1115, instance_loss: 0.1525, weighted_loss: 0.1238, label: 1, bag_size: 746
batch 119, loss: 0.0005, instance_loss: 0.1224, weighted_loss: 0.0371, label: 3, bag_size: 729
batch 139, loss: 0.0111, instance_loss: 0.1281, weighted_loss: 0.0462, label: 4, bag_size: 773
batch 159, loss: 0.0478, instance_loss: 0.2098, weighted_loss: 0.0964, label: 1, bag_size: 949
batch 179, loss: 0.0565, instance_loss: 0.4285, weighted_loss: 0.1681, label: 4, bag_size: 663
batch 199, loss: 0.0374, instance_loss: 0.2099, weighted_loss: 0.0892, label: 1, bag_size: 949
batch 219, loss: 0.0089, instance_loss: 0.1681, weighted_loss: 0.0566, label: 3, bag_size: 729
batch 239, loss: 0.1106, instance_loss: 0.4808, weighted_loss: 0.2217, label: 3, bag_size: 283
batch 259, loss: 0.3915, instance_loss: 0.5911, weighted_loss: 0.4514, label: 2, bag_size: 384
batch 279, loss: 0.0018, instance_loss: 0.0222, weighted_loss: 0.0079, label: 0, bag_size: 921
batch 299, loss: 0.0114, instance_loss: 0.2861, weighted_loss: 0.0938, label: 2, bag_size: 846
batch 319, loss: 0.0275, instance_loss: 0.1917, weighted_loss: 0.0768, label: 0, bag_size: 1018
batch 339, loss: 3.3359, instance_loss: 0.7013, weighted_loss: 2.5456, label: 1, bag_size: 1799
batch 359, loss: 0.1127, instance_loss: 0.1160, weighted_loss: 0.1137, label: 3, bag_size: 556
batch 379, loss: 0.0568, instance_loss: 0.4628, weighted_loss: 0.1786, label: 1, bag_size: 648
batch 399, loss: 0.0217, instance_loss: 0.1341, weighted_loss: 0.0554, label: 3, bag_size: 1399
batch 419, loss: 0.0018, instance_loss: 0.0392, weighted_loss: 0.0130, label: 0, bag_size: 729


class 0 clustering acc 0.9854117647058823: correct 16752/17000
class 1 clustering acc 0.4808823529411765: correct 1635/3400
Epoch: 47, train_loss: 0.1696, train_clustering_loss:  0.2979, train_error: 0.0518
class 0: acc 0.9578947368421052, correct 91/95
class 1: acc 0.8953488372093024, correct 77/86
class 2: acc 0.8977272727272727, correct 79/88
class 3: acc 1.0, correct 72/72
class 4: acc 1.0, correct 84/84

Val Set, val_loss: 1.3652, val_error: 0.3400, auc: 0.8783
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.275: correct 110/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.8421052631578947, correct 16/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0490, instance_loss: 0.2584, weighted_loss: 0.1118, label: 2, bag_size: 1569
batch 39, loss: 0.0973, instance_loss: 0.5414, weighted_loss: 0.2305, label: 2, bag_size: 1439
batch 59, loss: 0.0283, instance_loss: 0.4063, weighted_loss: 0.1417, label: 4, bag_size: 354
batch 79, loss: 0.0009, instance_loss: 0.1535, weighted_loss: 0.0467, label: 3, bag_size: 729
batch 99, loss: 0.0102, instance_loss: 0.0820, weighted_loss: 0.0318, label: 0, bag_size: 807
batch 119, loss: 0.0044, instance_loss: 0.0500, weighted_loss: 0.0181, label: 0, bag_size: 729
batch 139, loss: 0.0000, instance_loss: 0.0175, weighted_loss: 0.0053, label: 4, bag_size: 729
batch 159, loss: 0.0372, instance_loss: 0.4620, weighted_loss: 0.1647, label: 1, bag_size: 102
batch 179, loss: 0.0118, instance_loss: 0.1255, weighted_loss: 0.0460, label: 3, bag_size: 729
batch 199, loss: 0.0232, instance_loss: 0.2199, weighted_loss: 0.0822, label: 1, bag_size: 1127
batch 219, loss: 0.8650, instance_loss: 0.4355, weighted_loss: 0.7362, label: 4, bag_size: 817
batch 239, loss: 0.0044, instance_loss: 0.4292, weighted_loss: 0.1318, label: 4, bag_size: 1176
batch 259, loss: 0.0738, instance_loss: 0.1064, weighted_loss: 0.0836, label: 0, bag_size: 340
batch 279, loss: 0.0608, instance_loss: 0.2358, weighted_loss: 0.1133, label: 2, bag_size: 499
batch 299, loss: 0.0331, instance_loss: 0.3492, weighted_loss: 0.1279, label: 2, bag_size: 1218
batch 319, loss: 0.0382, instance_loss: 0.4939, weighted_loss: 0.1749, label: 3, bag_size: 1380
batch 339, loss: 0.0847, instance_loss: 0.3259, weighted_loss: 0.1571, label: 2, bag_size: 1052
batch 359, loss: 0.1123, instance_loss: 0.3616, weighted_loss: 0.1871, label: 3, bag_size: 1250
batch 379, loss: 0.0229, instance_loss: 0.2665, weighted_loss: 0.0959, label: 3, bag_size: 317
batch 399, loss: 0.0930, instance_loss: 0.2602, weighted_loss: 0.1432, label: 2, bag_size: 1050
batch 419, loss: 0.1376, instance_loss: 0.4241, weighted_loss: 0.2236, label: 1, bag_size: 533


class 0 clustering acc 0.9882941176470589: correct 16801/17000
class 1 clustering acc 0.4555882352941176: correct 1549/3400
Epoch: 48, train_loss: 0.1504, train_clustering_loss:  0.2979, train_error: 0.0447
class 0: acc 0.9775280898876404, correct 87/89
class 1: acc 0.8928571428571429, correct 75/84
class 2: acc 0.9222222222222223, correct 83/90
class 3: acc 1.0, correct 82/82
class 4: acc 0.9875, correct 79/80

Val Set, val_loss: 1.5002, val_error: 0.4000, auc: 0.8754
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0221, instance_loss: 0.4101, weighted_loss: 0.1385, label: 3, bag_size: 230
batch 39, loss: 0.0251, instance_loss: 0.2788, weighted_loss: 0.1012, label: 1, bag_size: 949
batch 59, loss: 0.0536, instance_loss: 0.4667, weighted_loss: 0.1775, label: 3, bag_size: 1380
batch 79, loss: 0.0679, instance_loss: 0.3765, weighted_loss: 0.1605, label: 4, bag_size: 436
batch 99, loss: 0.0454, instance_loss: 0.2112, weighted_loss: 0.0952, label: 2, bag_size: 270
batch 119, loss: 0.0102, instance_loss: 0.0439, weighted_loss: 0.0203, label: 3, bag_size: 729
batch 139, loss: 0.0099, instance_loss: 0.3611, weighted_loss: 0.1152, label: 1, bag_size: 828
batch 159, loss: 0.0311, instance_loss: 0.1315, weighted_loss: 0.0612, label: 0, bag_size: 630
batch 179, loss: 0.1008, instance_loss: 0.2168, weighted_loss: 0.1356, label: 2, bag_size: 1569
batch 199, loss: 0.0919, instance_loss: 0.2735, weighted_loss: 0.1464, label: 2, bag_size: 1404
batch 219, loss: 0.0022, instance_loss: 0.0340, weighted_loss: 0.0117, label: 0, bag_size: 731
batch 239, loss: 0.0001, instance_loss: 0.0525, weighted_loss: 0.0159, label: 4, bag_size: 764
batch 259, loss: 0.0002, instance_loss: 0.1762, weighted_loss: 0.0530, label: 4, bag_size: 636
batch 279, loss: 0.0826, instance_loss: 0.1313, weighted_loss: 0.0972, label: 1, bag_size: 886
batch 299, loss: 0.0163, instance_loss: 0.3434, weighted_loss: 0.1144, label: 3, bag_size: 1250
batch 319, loss: 0.2817, instance_loss: 0.1944, weighted_loss: 0.2555, label: 1, bag_size: 903
batch 339, loss: 0.0234, instance_loss: 0.6645, weighted_loss: 0.2157, label: 4, bag_size: 663
batch 359, loss: 0.0262, instance_loss: 0.2948, weighted_loss: 0.1068, label: 1, bag_size: 690
batch 379, loss: 0.0028, instance_loss: 0.3565, weighted_loss: 0.1089, label: 3, bag_size: 841
batch 399, loss: 0.0130, instance_loss: 0.0728, weighted_loss: 0.0309, label: 0, bag_size: 367
batch 419, loss: 0.1845, instance_loss: 0.2988, weighted_loss: 0.2188, label: 1, bag_size: 1402


class 0 clustering acc 0.9893529411764705: correct 16819/17000
class 1 clustering acc 0.4844117647058824: correct 1647/3400
Epoch: 49, train_loss: 0.0979, train_clustering_loss:  0.2782, train_error: 0.0282
class 0: acc 0.9615384615384616, correct 75/78
class 1: acc 0.9655172413793104, correct 84/87
class 2: acc 0.925, correct 74/80
class 3: acc 1.0, correct 87/87
class 4: acc 1.0, correct 93/93

Val Set, val_loss: 1.4187, val_error: 0.4200, auc: 0.8799
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.2975: correct 119/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.16666666666666666, correct 1/6
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0087, instance_loss: 0.7054, weighted_loss: 0.2177, label: 4, bag_size: 882
batch 39, loss: 0.1188, instance_loss: 0.2352, weighted_loss: 0.1537, label: 2, bag_size: 455
batch 59, loss: 0.0010, instance_loss: 0.0203, weighted_loss: 0.0068, label: 0, bag_size: 921
batch 79, loss: 0.5777, instance_loss: 0.7651, weighted_loss: 0.6339, label: 0, bag_size: 818
batch 99, loss: 0.0129, instance_loss: 0.3622, weighted_loss: 0.1176, label: 1, bag_size: 1646
batch 119, loss: 0.5560, instance_loss: 0.6800, weighted_loss: 0.5932, label: 1, bag_size: 448
batch 139, loss: 0.0051, instance_loss: 0.0787, weighted_loss: 0.0272, label: 0, bag_size: 338
batch 159, loss: 0.3647, instance_loss: 0.3051, weighted_loss: 0.3468, label: 1, bag_size: 1049
batch 179, loss: 0.0028, instance_loss: 0.0749, weighted_loss: 0.0244, label: 3, bag_size: 729
batch 199, loss: 0.0049, instance_loss: 0.2062, weighted_loss: 0.0653, label: 2, bag_size: 2826
batch 219, loss: 0.0433, instance_loss: 0.1722, weighted_loss: 0.0820, label: 0, bag_size: 350
batch 239, loss: 0.0048, instance_loss: 0.0439, weighted_loss: 0.0165, label: 0, bag_size: 200
batch 259, loss: 0.0210, instance_loss: 0.2005, weighted_loss: 0.0748, label: 2, bag_size: 461
batch 279, loss: 0.5761, instance_loss: 0.3583, weighted_loss: 0.5108, label: 0, bag_size: 801
batch 299, loss: 0.0280, instance_loss: 0.2988, weighted_loss: 0.1093, label: 4, bag_size: 590
batch 319, loss: 0.0008, instance_loss: 0.0458, weighted_loss: 0.0143, label: 0, bag_size: 524
batch 339, loss: 3.1449, instance_loss: 0.7729, weighted_loss: 2.4333, label: 1, bag_size: 446
batch 359, loss: 0.0036, instance_loss: 0.0678, weighted_loss: 0.0229, label: 3, bag_size: 729
batch 379, loss: 0.0983, instance_loss: 0.4644, weighted_loss: 0.2081, label: 2, bag_size: 537
batch 399, loss: 0.2083, instance_loss: 0.2071, weighted_loss: 0.2080, label: 1, bag_size: 886
batch 419, loss: 0.0823, instance_loss: 0.4478, weighted_loss: 0.1919, label: 1, bag_size: 838


class 0 clustering acc 0.9865882352941177: correct 16772/17000
class 1 clustering acc 0.4702941176470588: correct 1599/3400
Epoch: 50, train_loss: 0.1764, train_clustering_loss:  0.2940, train_error: 0.0729
class 0: acc 0.9375, correct 90/96
class 1: acc 0.8809523809523809, correct 74/84
class 2: acc 0.8351648351648352, correct 76/91
class 3: acc 1.0, correct 83/83
class 4: acc 1.0, correct 71/71

Val Set, val_loss: 1.4367, val_error: 0.4600, auc: 0.8362
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.1987, instance_loss: 0.5711, weighted_loss: 0.3104, label: 2, bag_size: 679
batch 39, loss: 0.0282, instance_loss: 0.1363, weighted_loss: 0.0606, label: 0, bag_size: 729
batch 59, loss: 0.0091, instance_loss: 0.4390, weighted_loss: 0.1380, label: 1, bag_size: 1390
batch 79, loss: 0.0034, instance_loss: 0.4642, weighted_loss: 0.1416, label: 4, bag_size: 947
batch 99, loss: 0.0062, instance_loss: 0.0490, weighted_loss: 0.0190, label: 0, bag_size: 729
batch 119, loss: 0.0233, instance_loss: 0.2103, weighted_loss: 0.0794, label: 3, bag_size: 316
batch 139, loss: 0.0350, instance_loss: 0.2781, weighted_loss: 0.1079, label: 2, bag_size: 1123
batch 159, loss: 0.0011, instance_loss: 0.0623, weighted_loss: 0.0195, label: 4, bag_size: 1002
batch 179, loss: 0.4385, instance_loss: 0.3747, weighted_loss: 0.4193, label: 4, bag_size: 817
batch 199, loss: 0.0604, instance_loss: 0.1618, weighted_loss: 0.0908, label: 1, bag_size: 945
batch 219, loss: 0.0042, instance_loss: 0.1272, weighted_loss: 0.0411, label: 3, bag_size: 729
batch 239, loss: 0.0901, instance_loss: 0.5076, weighted_loss: 0.2154, label: 2, bag_size: 649
batch 259, loss: 0.0509, instance_loss: 0.2444, weighted_loss: 0.1089, label: 0, bag_size: 1301
batch 279, loss: 0.5846, instance_loss: 0.5772, weighted_loss: 0.5824, label: 1, bag_size: 1273
batch 299, loss: 0.7690, instance_loss: 0.6581, weighted_loss: 0.7357, label: 2, bag_size: 120
batch 319, loss: 0.0000, instance_loss: 0.0196, weighted_loss: 0.0059, label: 3, bag_size: 729
batch 339, loss: 0.0006, instance_loss: 0.0588, weighted_loss: 0.0181, label: 3, bag_size: 729
batch 359, loss: 0.1304, instance_loss: 0.4861, weighted_loss: 0.2371, label: 1, bag_size: 860
batch 379, loss: 0.0061, instance_loss: 0.0757, weighted_loss: 0.0270, label: 0, bag_size: 472
batch 399, loss: 0.0009, instance_loss: 0.1662, weighted_loss: 0.0505, label: 3, bag_size: 316
batch 419, loss: 0.3646, instance_loss: 0.3703, weighted_loss: 0.3663, label: 1, bag_size: 533


class 0 clustering acc 0.988: correct 16796/17000
class 1 clustering acc 0.4461764705882353: correct 1517/3400
Epoch: 51, train_loss: 0.1618, train_clustering_loss:  0.3043, train_error: 0.0424
class 0: acc 0.9789473684210527, correct 93/95
class 1: acc 0.9368421052631579, correct 89/95
class 2: acc 0.8591549295774648, correct 61/71
class 3: acc 1.0, correct 89/89
class 4: acc 1.0, correct 75/75

Val Set, val_loss: 1.3750, val_error: 0.4200, auc: 0.8679
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 33 out of 20
Early stopping
Val error: 0.3800, ROC AUC: 0.8697
Test error: 0.3600, ROC AUC: 0.8711
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.875, correct 14/16
class 3: acc 1.0, correct 3/3
class 4: acc 0.0, correct 0/4

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.3995, instance_loss: 1.1701, weighted_loss: 1.3307, label: 3, bag_size: 706
batch 39, loss: 1.2869, instance_loss: 1.0266, weighted_loss: 1.2088, label: 3, bag_size: 729
batch 59, loss: 1.2676, instance_loss: 0.8254, weighted_loss: 1.1349, label: 3, bag_size: 729
batch 79, loss: 1.7190, instance_loss: 0.7367, weighted_loss: 1.4244, label: 2, bag_size: 499
batch 99, loss: 1.9237, instance_loss: 0.6933, weighted_loss: 1.5546, label: 0, bag_size: 1517
batch 119, loss: 1.3279, instance_loss: 0.5671, weighted_loss: 1.0997, label: 3, bag_size: 729
batch 139, loss: 1.4692, instance_loss: 0.5313, weighted_loss: 1.1878, label: 3, bag_size: 936
batch 159, loss: 1.8153, instance_loss: 0.5677, weighted_loss: 1.4410, label: 0, bag_size: 729
batch 179, loss: 1.9323, instance_loss: 0.5326, weighted_loss: 1.5124, label: 1, bag_size: 242
batch 199, loss: 1.3916, instance_loss: 0.4791, weighted_loss: 1.1179, label: 4, bag_size: 1121
batch 219, loss: 1.5107, instance_loss: 0.4991, weighted_loss: 1.2072, label: 2, bag_size: 259
batch 239, loss: 1.5436, instance_loss: 0.5000, weighted_loss: 1.2305, label: 4, bag_size: 1474
batch 259, loss: 1.8648, instance_loss: 0.5302, weighted_loss: 1.4644, label: 2, bag_size: 948
batch 279, loss: 1.3943, instance_loss: 0.5004, weighted_loss: 1.1261, label: 0, bag_size: 729
batch 299, loss: 1.2968, instance_loss: 0.4714, weighted_loss: 1.0492, label: 3, bag_size: 1172
batch 319, loss: 1.5350, instance_loss: 0.4911, weighted_loss: 1.2218, label: 3, bag_size: 281
batch 339, loss: 1.4847, instance_loss: 0.4918, weighted_loss: 1.1868, label: 0, bag_size: 478
batch 359, loss: 1.5245, instance_loss: 0.5201, weighted_loss: 1.2232, label: 1, bag_size: 318
batch 379, loss: 1.5821, instance_loss: 0.5094, weighted_loss: 1.2603, label: 0, bag_size: 933
batch 399, loss: 1.4772, instance_loss: 0.5037, weighted_loss: 1.1851, label: 1, bag_size: 861
batch 419, loss: 1.7836, instance_loss: 0.5212, weighted_loss: 1.4049, label: 3, bag_size: 1399


class 0 clustering acc 0.9914117647058823: correct 16854/17000
class 1 clustering acc 0.01588235294117647: correct 54/3400
Epoch: 0, train_loss: 1.5959, train_clustering_loss:  0.6200, train_error: 0.7412
class 0: acc 0.18604651162790697, correct 16/86
class 1: acc 0.13333333333333333, correct 10/75
class 2: acc 0.0379746835443038, correct 3/79
class 3: acc 0.4782608695652174, correct 44/92
class 4: acc 0.3978494623655914, correct 37/93

Val Set, val_loss: 1.6755, val_error: 0.8400, auc: 0.7701
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.0, correct 0/27
class 3: acc 0.0, correct 0/4
class 4: acc 0.3333333333333333, correct 1/3
Validation loss decreased (inf --> 1.675502).  Saving model ...


batch 19, loss: 1.2084, instance_loss: 0.5060, weighted_loss: 0.9977, label: 4, bag_size: 1002
batch 39, loss: 1.4430, instance_loss: 0.4967, weighted_loss: 1.1591, label: 4, bag_size: 823
batch 59, loss: 1.2825, instance_loss: 0.4776, weighted_loss: 1.0410, label: 1, bag_size: 847
batch 79, loss: 1.4877, instance_loss: 0.4859, weighted_loss: 1.1872, label: 1, bag_size: 446
batch 99, loss: 1.0660, instance_loss: 0.5153, weighted_loss: 0.9008, label: 4, bag_size: 729
batch 119, loss: 2.2292, instance_loss: 0.6093, weighted_loss: 1.7433, label: 2, bag_size: 358
batch 139, loss: 1.3832, instance_loss: 0.4868, weighted_loss: 1.1143, label: 4, bag_size: 436
batch 159, loss: 1.6286, instance_loss: 0.5401, weighted_loss: 1.3021, label: 0, bag_size: 807
batch 179, loss: 1.4562, instance_loss: 0.5122, weighted_loss: 1.1730, label: 3, bag_size: 556
batch 199, loss: 1.4233, instance_loss: 0.5195, weighted_loss: 1.1522, label: 3, bag_size: 1291
batch 219, loss: 1.6100, instance_loss: 0.4831, weighted_loss: 1.2719, label: 4, bag_size: 1278
batch 239, loss: 1.4575, instance_loss: 0.5130, weighted_loss: 1.1742, label: 2, bag_size: 469
batch 259, loss: 1.5826, instance_loss: 0.5312, weighted_loss: 1.2672, label: 2, bag_size: 1569
batch 279, loss: 1.6280, instance_loss: 0.5477, weighted_loss: 1.3039, label: 0, bag_size: 912
batch 299, loss: 1.2323, instance_loss: 0.4548, weighted_loss: 0.9991, label: 3, bag_size: 849
batch 319, loss: 1.0715, instance_loss: 0.4252, weighted_loss: 0.8776, label: 3, bag_size: 729
batch 339, loss: 1.5990, instance_loss: 0.5210, weighted_loss: 1.2756, label: 2, bag_size: 948
batch 359, loss: 1.1746, instance_loss: 0.4542, weighted_loss: 0.9585, label: 1, bag_size: 790
batch 379, loss: 1.4740, instance_loss: 0.4689, weighted_loss: 1.1725, label: 3, bag_size: 316
batch 399, loss: 1.2485, instance_loss: 0.4683, weighted_loss: 1.0145, label: 1, bag_size: 533
batch 419, loss: 1.6312, instance_loss: 0.5160, weighted_loss: 1.2966, label: 2, bag_size: 730


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4623, train_clustering_loss:  0.5015, train_error: 0.5647
class 0: acc 0.34523809523809523, correct 29/84
class 1: acc 0.7282608695652174, correct 67/92
class 2: acc 0.0641025641025641, correct 5/78
class 3: acc 0.46511627906976744, correct 40/86
class 4: acc 0.5176470588235295, correct 44/85

Val Set, val_loss: 1.4210, val_error: 0.7000, auc: 0.7561
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.037037037037037035, correct 1/27
class 3: acc 0.0, correct 0/4
class 4: acc 0.0, correct 0/3
Validation loss decreased (1.675502 --> 1.420951).  Saving model ...


batch 19, loss: 1.4879, instance_loss: 0.5108, weighted_loss: 1.1948, label: 0, bag_size: 1174
batch 39, loss: 1.7842, instance_loss: 0.5097, weighted_loss: 1.4018, label: 0, bag_size: 729
batch 59, loss: 0.5571, instance_loss: 0.4219, weighted_loss: 0.5165, label: 4, bag_size: 729
batch 79, loss: 0.8971, instance_loss: 0.4042, weighted_loss: 0.7492, label: 3, bag_size: 729
batch 99, loss: 1.3699, instance_loss: 0.4904, weighted_loss: 1.1060, label: 4, bag_size: 625
batch 119, loss: 1.2773, instance_loss: 0.5026, weighted_loss: 1.0449, label: 0, bag_size: 718
batch 139, loss: 0.8057, instance_loss: 0.3710, weighted_loss: 0.6753, label: 3, bag_size: 729
batch 159, loss: 1.6028, instance_loss: 0.4930, weighted_loss: 1.2699, label: 3, bag_size: 317
batch 179, loss: 0.9890, instance_loss: 0.4184, weighted_loss: 0.8178, label: 3, bag_size: 1291
batch 199, loss: 1.3835, instance_loss: 0.5017, weighted_loss: 1.1190, label: 2, bag_size: 1155
batch 219, loss: 1.5337, instance_loss: 0.5088, weighted_loss: 1.2262, label: 3, bag_size: 849
batch 239, loss: 0.8450, instance_loss: 0.3908, weighted_loss: 0.7088, label: 1, bag_size: 1239
batch 259, loss: 1.4811, instance_loss: 0.4879, weighted_loss: 1.1831, label: 2, bag_size: 748
batch 279, loss: 1.4513, instance_loss: 0.4815, weighted_loss: 1.1603, label: 4, bag_size: 663
batch 299, loss: 1.5603, instance_loss: 0.5035, weighted_loss: 1.2433, label: 2, bag_size: 676
batch 319, loss: 1.6498, instance_loss: 0.4783, weighted_loss: 1.2983, label: 1, bag_size: 1559
batch 339, loss: 1.9358, instance_loss: 0.5339, weighted_loss: 1.5152, label: 1, bag_size: 1172
batch 359, loss: 0.5298, instance_loss: 0.3142, weighted_loss: 0.4651, label: 1, bag_size: 1191
batch 379, loss: 1.4026, instance_loss: 0.4877, weighted_loss: 1.1281, label: 2, bag_size: 314
batch 399, loss: 1.2484, instance_loss: 0.5008, weighted_loss: 1.0241, label: 0, bag_size: 518
batch 419, loss: 1.0653, instance_loss: 0.4379, weighted_loss: 0.8771, label: 3, bag_size: 1399


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.3080, train_clustering_loss:  0.4759, train_error: 0.5012
class 0: acc 0.46153846153846156, correct 36/78
class 1: acc 0.7222222222222222, correct 65/90
class 2: acc 0.2988505747126437, correct 26/87
class 3: acc 0.5517241379310345, correct 48/87
class 4: acc 0.4457831325301205, correct 37/83

Val Set, val_loss: 1.2592, val_error: 0.4600, auc: 0.7897
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5555555555555556, correct 15/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.420951 --> 1.259165).  Saving model ...


batch 19, loss: 1.4931, instance_loss: 0.4996, weighted_loss: 1.1950, label: 0, bag_size: 282
batch 39, loss: 1.2507, instance_loss: 0.4447, weighted_loss: 1.0089, label: 3, bag_size: 1380
batch 59, loss: 1.1872, instance_loss: 0.4664, weighted_loss: 0.9709, label: 4, bag_size: 928
batch 79, loss: 0.9335, instance_loss: 0.4604, weighted_loss: 0.7915, label: 0, bag_size: 239
batch 99, loss: 1.9464, instance_loss: 0.5282, weighted_loss: 1.5209, label: 4, bag_size: 974
batch 119, loss: 1.1646, instance_loss: 0.4597, weighted_loss: 0.9531, label: 2, bag_size: 471
batch 139, loss: 1.0310, instance_loss: 0.4731, weighted_loss: 0.8637, label: 0, bag_size: 476
batch 159, loss: 0.2266, instance_loss: 0.2279, weighted_loss: 0.2270, label: 4, bag_size: 729
batch 179, loss: 0.5283, instance_loss: 0.3363, weighted_loss: 0.4707, label: 4, bag_size: 711
batch 199, loss: 2.0353, instance_loss: 0.5258, weighted_loss: 1.5825, label: 1, bag_size: 660
batch 219, loss: 1.3775, instance_loss: 0.5115, weighted_loss: 1.1177, label: 2, bag_size: 408
batch 239, loss: 0.2074, instance_loss: 0.2138, weighted_loss: 0.2093, label: 4, bag_size: 729
batch 259, loss: 0.2925, instance_loss: 0.3128, weighted_loss: 0.2986, label: 4, bag_size: 388
batch 279, loss: 1.6373, instance_loss: 0.5379, weighted_loss: 1.3075, label: 1, bag_size: 1724
batch 299, loss: 1.5408, instance_loss: 0.4326, weighted_loss: 1.2084, label: 3, bag_size: 305
batch 319, loss: 0.9787, instance_loss: 0.4855, weighted_loss: 0.8307, label: 0, bag_size: 756
batch 339, loss: 1.0530, instance_loss: 0.4681, weighted_loss: 0.8775, label: 2, bag_size: 1569
batch 359, loss: 0.4922, instance_loss: 0.3590, weighted_loss: 0.4523, label: 4, bag_size: 729
batch 379, loss: 0.7162, instance_loss: 0.4395, weighted_loss: 0.6332, label: 4, bag_size: 1278
batch 399, loss: 0.3549, instance_loss: 0.2337, weighted_loss: 0.3186, label: 1, bag_size: 1277
batch 419, loss: 1.3624, instance_loss: 0.4764, weighted_loss: 1.0966, label: 2, bag_size: 774


class 0 clustering acc 0.9998823529411764: correct 16998/17000
class 1 clustering acc 0.004705882352941176: correct 16/3400
Epoch: 3, train_loss: 1.1297, train_clustering_loss:  0.4449, train_error: 0.4212
class 0: acc 0.4931506849315068, correct 36/73
class 1: acc 0.6082474226804123, correct 59/97
class 2: acc 0.34523809523809523, correct 29/84
class 3: acc 0.7473684210526316, correct 71/95
class 4: acc 0.6710526315789473, correct 51/76

Val Set, val_loss: 1.2537, val_error: 0.5200, auc: 0.8058
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.0225: correct 9/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.37037037037037035, correct 10/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.0, correct 0/3
Validation loss decreased (1.259165 --> 1.253679).  Saving model ...


batch 19, loss: 0.1354, instance_loss: 0.2632, weighted_loss: 0.1737, label: 3, bag_size: 1253
batch 39, loss: 1.0523, instance_loss: 0.4433, weighted_loss: 0.8696, label: 0, bag_size: 381
batch 59, loss: 1.3360, instance_loss: 0.5102, weighted_loss: 1.0883, label: 2, bag_size: 1400
batch 79, loss: 1.2755, instance_loss: 0.4435, weighted_loss: 1.0259, label: 1, bag_size: 968
batch 99, loss: 1.6019, instance_loss: 0.5386, weighted_loss: 1.2830, label: 2, bag_size: 319
batch 119, loss: 0.8482, instance_loss: 0.4676, weighted_loss: 0.7340, label: 0, bag_size: 729
batch 139, loss: 0.9427, instance_loss: 0.4518, weighted_loss: 0.7954, label: 2, bag_size: 839
batch 159, loss: 1.3714, instance_loss: 0.4438, weighted_loss: 1.0931, label: 1, bag_size: 470
batch 179, loss: 2.3747, instance_loss: 0.6218, weighted_loss: 1.8488, label: 3, bag_size: 706
batch 199, loss: 1.5713, instance_loss: 0.6923, weighted_loss: 1.3076, label: 2, bag_size: 916
batch 219, loss: 0.9968, instance_loss: 0.3724, weighted_loss: 0.8095, label: 1, bag_size: 897
batch 239, loss: 0.2018, instance_loss: 0.3491, weighted_loss: 0.2460, label: 3, bag_size: 1253
batch 259, loss: 0.5322, instance_loss: 0.2870, weighted_loss: 0.4587, label: 1, bag_size: 1277
batch 279, loss: 0.5889, instance_loss: 0.4459, weighted_loss: 0.5460, label: 0, bag_size: 1466
batch 299, loss: 0.5940, instance_loss: 0.3903, weighted_loss: 0.5329, label: 0, bag_size: 542
batch 319, loss: 1.2435, instance_loss: 0.4691, weighted_loss: 1.0112, label: 2, bag_size: 1385
batch 339, loss: 1.6133, instance_loss: 0.5084, weighted_loss: 1.2818, label: 3, bag_size: 360
batch 359, loss: 0.5279, instance_loss: 0.3758, weighted_loss: 0.4823, label: 4, bag_size: 656
batch 379, loss: 0.8475, instance_loss: 0.4395, weighted_loss: 0.7251, label: 2, bag_size: 247
batch 399, loss: 0.9712, instance_loss: 0.6282, weighted_loss: 0.8683, label: 3, bag_size: 1167
batch 419, loss: 2.2423, instance_loss: 0.5512, weighted_loss: 1.7350, label: 1, bag_size: 1049


class 0 clustering acc 0.9991764705882353: correct 16986/17000
class 1 clustering acc 0.05382352941176471: correct 183/3400
Epoch: 4, train_loss: 0.9828, train_clustering_loss:  0.4216, train_error: 0.3553
class 0: acc 0.75, correct 57/76
class 1: acc 0.6947368421052632, correct 66/95
class 2: acc 0.41836734693877553, correct 41/98
class 3: acc 0.7349397590361446, correct 61/83
class 4: acc 0.6712328767123288, correct 49/73

Val Set, val_loss: 1.1755, val_error: 0.5000, auc: 0.8160
class 0 clustering acc 0.9975: correct 1995/2000
class 1 clustering acc 0.0225: correct 9/400
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.48148148148148145, correct 13/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.253679 --> 1.175502).  Saving model ...


batch 19, loss: 1.1862, instance_loss: 0.5290, weighted_loss: 0.9891, label: 0, bag_size: 410
batch 39, loss: 0.1178, instance_loss: 0.3254, weighted_loss: 0.1801, label: 3, bag_size: 936
batch 59, loss: 1.7874, instance_loss: 0.5325, weighted_loss: 1.4110, label: 1, bag_size: 448
batch 79, loss: 0.7775, instance_loss: 0.4023, weighted_loss: 0.6649, label: 2, bag_size: 863
batch 99, loss: 0.8309, instance_loss: 0.3777, weighted_loss: 0.6950, label: 1, bag_size: 504
batch 119, loss: 0.9503, instance_loss: 0.4393, weighted_loss: 0.7970, label: 2, bag_size: 307
batch 139, loss: 1.1712, instance_loss: 0.4340, weighted_loss: 0.9500, label: 1, bag_size: 838
batch 159, loss: 0.9131, instance_loss: 0.4453, weighted_loss: 0.7727, label: 2, bag_size: 1569
batch 179, loss: 0.4701, instance_loss: 0.4439, weighted_loss: 0.4622, label: 0, bag_size: 729
batch 199, loss: 1.2713, instance_loss: 0.4433, weighted_loss: 1.0229, label: 1, bag_size: 242
batch 219, loss: 0.2842, instance_loss: 0.2056, weighted_loss: 0.2606, label: 3, bag_size: 729
batch 239, loss: 0.8577, instance_loss: 0.4459, weighted_loss: 0.7341, label: 0, bag_size: 729
batch 259, loss: 0.3634, instance_loss: 0.3634, weighted_loss: 0.3634, label: 4, bag_size: 1278
batch 279, loss: 2.2999, instance_loss: 0.6256, weighted_loss: 1.7976, label: 1, bag_size: 1172
batch 299, loss: 0.0989, instance_loss: 0.1158, weighted_loss: 0.1040, label: 3, bag_size: 729
batch 319, loss: 0.1710, instance_loss: 0.1378, weighted_loss: 0.1611, label: 3, bag_size: 729
batch 339, loss: 1.1842, instance_loss: 0.5545, weighted_loss: 0.9953, label: 2, bag_size: 278
batch 359, loss: 0.3583, instance_loss: 0.2850, weighted_loss: 0.3363, label: 1, bag_size: 697
batch 379, loss: 1.2204, instance_loss: 0.5127, weighted_loss: 1.0081, label: 4, bag_size: 590
batch 399, loss: 0.4163, instance_loss: 0.2579, weighted_loss: 0.3687, label: 3, bag_size: 729
batch 419, loss: 0.8892, instance_loss: 0.3272, weighted_loss: 0.7206, label: 4, bag_size: 1357


class 0 clustering acc 0.9988823529411764: correct 16981/17000
class 1 clustering acc 0.09323529411764706: correct 317/3400
Epoch: 5, train_loss: 0.8833, train_clustering_loss:  0.4034, train_error: 0.3247
class 0: acc 0.7375, correct 59/80
class 1: acc 0.6333333333333333, correct 57/90
class 2: acc 0.5116279069767442, correct 44/86
class 3: acc 0.7471264367816092, correct 65/87
class 4: acc 0.7560975609756098, correct 62/82

Val Set, val_loss: 1.1499, val_error: 0.5000, auc: 0.8362
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.02: correct 8/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.2222222222222222, correct 6/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.175502 --> 1.149864).  Saving model ...


batch 19, loss: 0.3833, instance_loss: 0.2549, weighted_loss: 0.3448, label: 3, bag_size: 1250
batch 39, loss: 0.8653, instance_loss: 0.5442, weighted_loss: 0.7690, label: 0, bag_size: 1034
batch 59, loss: 0.9703, instance_loss: 0.6942, weighted_loss: 0.8875, label: 0, bag_size: 729
batch 79, loss: 1.5779, instance_loss: 0.5245, weighted_loss: 1.2619, label: 2, bag_size: 687
batch 99, loss: 0.1087, instance_loss: 0.2472, weighted_loss: 0.1503, label: 4, bag_size: 764
batch 119, loss: 2.5418, instance_loss: 0.6928, weighted_loss: 1.9871, label: 1, bag_size: 1409
batch 139, loss: 0.7206, instance_loss: 0.4488, weighted_loss: 0.6390, label: 4, bag_size: 675
batch 159, loss: 1.3233, instance_loss: 0.5917, weighted_loss: 1.1038, label: 4, bag_size: 366
batch 179, loss: 0.0697, instance_loss: 0.1688, weighted_loss: 0.0994, label: 3, bag_size: 1253
batch 199, loss: 0.5969, instance_loss: 0.5364, weighted_loss: 0.5788, label: 0, bag_size: 729
batch 219, loss: 1.9283, instance_loss: 0.5934, weighted_loss: 1.5278, label: 0, bag_size: 282
batch 239, loss: 0.0660, instance_loss: 0.0987, weighted_loss: 0.0758, label: 3, bag_size: 729
batch 259, loss: 1.3852, instance_loss: 0.4009, weighted_loss: 1.0900, label: 3, bag_size: 305
batch 279, loss: 0.0839, instance_loss: 0.1809, weighted_loss: 0.1130, label: 4, bag_size: 711
batch 299, loss: 0.5999, instance_loss: 0.3196, weighted_loss: 0.5158, label: 1, bag_size: 288
batch 319, loss: 0.5334, instance_loss: 0.3107, weighted_loss: 0.4666, label: 1, bag_size: 346
batch 339, loss: 0.2448, instance_loss: 0.2054, weighted_loss: 0.2330, label: 4, bag_size: 729
batch 359, loss: 0.4463, instance_loss: 0.3358, weighted_loss: 0.4132, label: 0, bag_size: 545
batch 379, loss: 1.8625, instance_loss: 0.6265, weighted_loss: 1.4917, label: 4, bag_size: 366
batch 399, loss: 1.3000, instance_loss: 0.4762, weighted_loss: 1.0529, label: 4, bag_size: 297
batch 419, loss: 0.2290, instance_loss: 0.1156, weighted_loss: 0.1950, label: 3, bag_size: 729


class 0 clustering acc 0.9968823529411764: correct 16947/17000
class 1 clustering acc 0.1723529411764706: correct 586/3400
Epoch: 6, train_loss: 0.8087, train_clustering_loss:  0.3883, train_error: 0.3035
class 0: acc 0.7323943661971831, correct 52/71
class 1: acc 0.5540540540540541, correct 41/74
class 2: acc 0.4782608695652174, correct 44/92
class 3: acc 0.8415841584158416, correct 85/101
class 4: acc 0.8505747126436781, correct 74/87

Val Set, val_loss: 1.1005, val_error: 0.3600, auc: 0.8401
class 0 clustering acc 0.993: correct 1986/2000
class 1 clustering acc 0.0325: correct 13/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.48148148148148145, correct 13/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.149864 --> 1.100538).  Saving model ...


batch 19, loss: 1.4191, instance_loss: 0.6049, weighted_loss: 1.1748, label: 2, bag_size: 911
batch 39, loss: 0.1235, instance_loss: 0.1473, weighted_loss: 0.1306, label: 3, bag_size: 729
batch 59, loss: 0.0373, instance_loss: 0.0865, weighted_loss: 0.0521, label: 3, bag_size: 1172
batch 79, loss: 0.4408, instance_loss: 0.3292, weighted_loss: 0.4073, label: 0, bag_size: 756
batch 99, loss: 0.6938, instance_loss: 0.4244, weighted_loss: 0.6129, label: 2, bag_size: 499
batch 119, loss: 0.6673, instance_loss: 0.3871, weighted_loss: 0.5832, label: 0, bag_size: 1046
batch 139, loss: 0.2909, instance_loss: 0.1570, weighted_loss: 0.2507, label: 3, bag_size: 729
batch 159, loss: 0.5980, instance_loss: 0.3750, weighted_loss: 0.5311, label: 2, bag_size: 499
batch 179, loss: 0.2809, instance_loss: 0.4659, weighted_loss: 0.3364, label: 4, bag_size: 974
batch 199, loss: 0.6217, instance_loss: 0.4096, weighted_loss: 0.5581, label: 0, bag_size: 718
batch 219, loss: 1.2773, instance_loss: 0.4637, weighted_loss: 1.0332, label: 2, bag_size: 1653
batch 239, loss: 0.2206, instance_loss: 0.3382, weighted_loss: 0.2559, label: 4, bag_size: 1360
batch 259, loss: 0.6134, instance_loss: 0.6169, weighted_loss: 0.6145, label: 4, bag_size: 542
batch 279, loss: 3.1123, instance_loss: 0.7326, weighted_loss: 2.3984, label: 4, bag_size: 436
batch 299, loss: 0.6626, instance_loss: 0.3990, weighted_loss: 0.5835, label: 4, bag_size: 928
batch 319, loss: 0.3422, instance_loss: 0.2858, weighted_loss: 0.3252, label: 0, bag_size: 375
batch 339, loss: 1.6944, instance_loss: 0.5255, weighted_loss: 1.3437, label: 1, bag_size: 448
batch 359, loss: 2.3868, instance_loss: 0.6523, weighted_loss: 1.8664, label: 1, bag_size: 1799
batch 379, loss: 0.6417, instance_loss: 0.5169, weighted_loss: 0.6043, label: 4, bag_size: 366
batch 399, loss: 0.0641, instance_loss: 0.2525, weighted_loss: 0.1206, label: 4, bag_size: 1002
batch 419, loss: 0.3591, instance_loss: 0.3646, weighted_loss: 0.3608, label: 0, bag_size: 239


class 0 clustering acc 0.996: correct 16932/17000
class 1 clustering acc 0.18911764705882353: correct 643/3400
Epoch: 7, train_loss: 0.7755, train_clustering_loss:  0.3774, train_error: 0.2753
class 0: acc 0.8631578947368421, correct 82/95
class 1: acc 0.44, correct 33/75
class 2: acc 0.5308641975308642, correct 43/81
class 3: acc 0.8539325842696629, correct 76/89
class 4: acc 0.8705882352941177, correct 74/85

Val Set, val_loss: 1.0784, val_error: 0.3400, auc: 0.8294
class 0 clustering acc 0.993: correct 1986/2000
class 1 clustering acc 0.0375: correct 15/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.6666666666666666, correct 18/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.100538 --> 1.078351).  Saving model ...


batch 19, loss: 0.5773, instance_loss: 0.4496, weighted_loss: 0.5390, label: 1, bag_size: 102
batch 39, loss: 0.4041, instance_loss: 0.2574, weighted_loss: 0.3601, label: 1, bag_size: 346
batch 59, loss: 0.5296, instance_loss: 0.3320, weighted_loss: 0.4703, label: 1, bag_size: 860
batch 79, loss: 0.4980, instance_loss: 0.2836, weighted_loss: 0.4337, label: 3, bag_size: 821
batch 99, loss: 0.1845, instance_loss: 0.1460, weighted_loss: 0.1729, label: 3, bag_size: 729
batch 119, loss: 1.9609, instance_loss: 0.5368, weighted_loss: 1.5336, label: 4, bag_size: 533
batch 139, loss: 1.1895, instance_loss: 0.4644, weighted_loss: 0.9720, label: 1, bag_size: 399
batch 159, loss: 0.0866, instance_loss: 0.0705, weighted_loss: 0.0818, label: 3, bag_size: 556
batch 179, loss: 0.0733, instance_loss: 0.2846, weighted_loss: 0.1367, label: 4, bag_size: 1278
batch 199, loss: 0.2574, instance_loss: 0.3150, weighted_loss: 0.2746, label: 1, bag_size: 890
batch 219, loss: 1.5342, instance_loss: 0.4724, weighted_loss: 1.2157, label: 4, bag_size: 533
batch 239, loss: 0.2379, instance_loss: 0.2637, weighted_loss: 0.2456, label: 3, bag_size: 849
batch 259, loss: 0.4039, instance_loss: 0.2475, weighted_loss: 0.3570, label: 4, bag_size: 729
batch 279, loss: 0.6262, instance_loss: 0.3724, weighted_loss: 0.5501, label: 4, bag_size: 354
batch 299, loss: 1.2681, instance_loss: 0.4624, weighted_loss: 1.0264, label: 2, bag_size: 345
batch 319, loss: 1.0961, instance_loss: 0.5247, weighted_loss: 0.9247, label: 1, bag_size: 242
batch 339, loss: 1.7730, instance_loss: 0.5674, weighted_loss: 1.4114, label: 0, bag_size: 1257
batch 359, loss: 0.3608, instance_loss: 0.5049, weighted_loss: 0.4040, label: 4, bag_size: 542
batch 379, loss: 1.4275, instance_loss: 0.5651, weighted_loss: 1.1688, label: 2, bag_size: 1231
batch 399, loss: 1.3210, instance_loss: 0.4602, weighted_loss: 1.0628, label: 2, bag_size: 356
batch 419, loss: 0.4798, instance_loss: 0.3767, weighted_loss: 0.4489, label: 2, bag_size: 636


class 0 clustering acc 0.9961176470588236: correct 16934/17000
class 1 clustering acc 0.17529411764705882: correct 596/3400
Epoch: 8, train_loss: 0.7276, train_clustering_loss:  0.3778, train_error: 0.2635
class 0: acc 0.8444444444444444, correct 76/90
class 1: acc 0.6222222222222222, correct 56/90
class 2: acc 0.6170212765957447, correct 58/94
class 3: acc 0.7948717948717948, correct 62/78
class 4: acc 0.8356164383561644, correct 61/73

Val Set, val_loss: 1.1064, val_error: 0.4200, auc: 0.8283
class 0 clustering acc 0.9905: correct 1981/2000
class 1 clustering acc 0.0675: correct 27/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.37037037037037035, correct 10/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0199, instance_loss: 0.0401, weighted_loss: 0.0260, label: 3, bag_size: 305
batch 39, loss: 1.2611, instance_loss: 0.5996, weighted_loss: 1.0627, label: 1, bag_size: 1049
batch 59, loss: 0.5973, instance_loss: 0.3312, weighted_loss: 0.5174, label: 1, bag_size: 1080
batch 79, loss: 1.1870, instance_loss: 0.4497, weighted_loss: 0.9658, label: 1, bag_size: 838
batch 99, loss: 1.1564, instance_loss: 0.4654, weighted_loss: 0.9491, label: 0, bag_size: 736
batch 119, loss: 1.2206, instance_loss: 0.4813, weighted_loss: 0.9988, label: 3, bag_size: 200
batch 139, loss: 0.2802, instance_loss: 0.3505, weighted_loss: 0.3013, label: 2, bag_size: 455
batch 159, loss: 0.2434, instance_loss: 0.2534, weighted_loss: 0.2464, label: 0, bag_size: 542
batch 179, loss: 0.0340, instance_loss: 0.2288, weighted_loss: 0.0924, label: 4, bag_size: 711
batch 199, loss: 0.9827, instance_loss: 0.3902, weighted_loss: 0.8049, label: 3, bag_size: 791
batch 219, loss: 0.1547, instance_loss: 0.2143, weighted_loss: 0.1726, label: 0, bag_size: 729
batch 239, loss: 0.4975, instance_loss: 0.4097, weighted_loss: 0.4712, label: 2, bag_size: 748
batch 259, loss: 0.0653, instance_loss: 0.1059, weighted_loss: 0.0775, label: 3, bag_size: 1172
batch 279, loss: 1.1583, instance_loss: 0.4304, weighted_loss: 0.9399, label: 0, bag_size: 413
batch 299, loss: 0.0214, instance_loss: 0.1107, weighted_loss: 0.0482, label: 4, bag_size: 729
batch 319, loss: 2.3200, instance_loss: 0.6574, weighted_loss: 1.8212, label: 4, bag_size: 436
batch 339, loss: 0.5858, instance_loss: 0.3604, weighted_loss: 0.5182, label: 0, bag_size: 371
batch 359, loss: 1.8814, instance_loss: 0.4235, weighted_loss: 1.4440, label: 0, bag_size: 545
batch 379, loss: 0.5031, instance_loss: 0.3315, weighted_loss: 0.4516, label: 1, bag_size: 846
batch 399, loss: 0.3004, instance_loss: 0.4182, weighted_loss: 0.3357, label: 0, bag_size: 729
batch 419, loss: 0.0294, instance_loss: 0.3205, weighted_loss: 0.1167, label: 3, bag_size: 936


class 0 clustering acc 0.9959411764705882: correct 16931/17000
class 1 clustering acc 0.2214705882352941: correct 753/3400
Epoch: 9, train_loss: 0.6690, train_clustering_loss:  0.3682, train_error: 0.2400
class 0: acc 0.8172043010752689, correct 76/93
class 1: acc 0.6666666666666666, correct 62/93
class 2: acc 0.6395348837209303, correct 55/86
class 3: acc 0.9014084507042254, correct 64/71
class 4: acc 0.8048780487804879, correct 66/82

Val Set, val_loss: 1.0815, val_error: 0.3800, auc: 0.8488
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.11: correct 44/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.48148148148148145, correct 13/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3795, instance_loss: 0.4322, weighted_loss: 0.3953, label: 4, bag_size: 773
batch 39, loss: 1.3328, instance_loss: 0.5184, weighted_loss: 1.0885, label: 1, bag_size: 139
batch 59, loss: 0.3390, instance_loss: 0.5400, weighted_loss: 0.3993, label: 4, bag_size: 542
batch 79, loss: 0.0778, instance_loss: 0.1269, weighted_loss: 0.0926, label: 4, bag_size: 729
batch 99, loss: 0.0592, instance_loss: 0.2380, weighted_loss: 0.1128, label: 4, bag_size: 729
batch 119, loss: 0.1438, instance_loss: 0.2581, weighted_loss: 0.1781, label: 1, bag_size: 474
batch 139, loss: 0.7806, instance_loss: 0.3337, weighted_loss: 0.6466, label: 1, bag_size: 399
batch 159, loss: 0.1193, instance_loss: 0.3441, weighted_loss: 0.1867, label: 4, bag_size: 524
batch 179, loss: 0.7812, instance_loss: 0.4228, weighted_loss: 0.6737, label: 4, bag_size: 590
batch 199, loss: 1.0293, instance_loss: 0.4787, weighted_loss: 0.8641, label: 1, bag_size: 1096
batch 219, loss: 0.5168, instance_loss: 0.2601, weighted_loss: 0.4398, label: 0, bag_size: 410
batch 239, loss: 0.2942, instance_loss: 0.2364, weighted_loss: 0.2769, label: 1, bag_size: 369
batch 259, loss: 0.2892, instance_loss: 0.3256, weighted_loss: 0.3002, label: 2, bag_size: 323
batch 279, loss: 0.1431, instance_loss: 0.1113, weighted_loss: 0.1335, label: 3, bag_size: 729
batch 299, loss: 2.4910, instance_loss: 0.4946, weighted_loss: 1.8921, label: 1, bag_size: 868
batch 319, loss: 0.4808, instance_loss: 0.2522, weighted_loss: 0.4122, label: 0, bag_size: 338
batch 339, loss: 2.2190, instance_loss: 0.5803, weighted_loss: 1.7274, label: 0, bag_size: 868
batch 359, loss: 1.0856, instance_loss: 0.6005, weighted_loss: 0.9400, label: 2, bag_size: 750
batch 379, loss: 1.0170, instance_loss: 0.4984, weighted_loss: 0.8614, label: 1, bag_size: 1096
batch 399, loss: 1.6576, instance_loss: 0.7018, weighted_loss: 1.3709, label: 2, bag_size: 411
batch 419, loss: 0.4934, instance_loss: 0.3540, weighted_loss: 0.4516, label: 3, bag_size: 360


class 0 clustering acc 0.9948823529411764: correct 16913/17000
class 1 clustering acc 0.2917647058823529: correct 992/3400
Epoch: 10, train_loss: 0.6089, train_clustering_loss:  0.3509, train_error: 0.2118
class 0: acc 0.8631578947368421, correct 82/95
class 1: acc 0.6867469879518072, correct 57/83
class 2: acc 0.6666666666666666, correct 56/84
class 3: acc 0.8987341772151899, correct 71/79
class 4: acc 0.8214285714285714, correct 69/84

Val Set, val_loss: 1.1568, val_error: 0.3800, auc: 0.8569
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.16: correct 64/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4444444444444444, correct 12/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0069, instance_loss: 0.0189, weighted_loss: 0.0105, label: 3, bag_size: 1069
batch 39, loss: 0.1028, instance_loss: 0.1392, weighted_loss: 0.1137, label: 4, bag_size: 764
batch 59, loss: 0.0840, instance_loss: 0.1564, weighted_loss: 0.1057, label: 1, bag_size: 847
batch 79, loss: 0.4680, instance_loss: 0.2629, weighted_loss: 0.4065, label: 1, bag_size: 1402
batch 99, loss: 1.6270, instance_loss: 0.5929, weighted_loss: 1.3167, label: 2, bag_size: 272
batch 119, loss: 0.7482, instance_loss: 0.3173, weighted_loss: 0.6190, label: 0, bag_size: 424
batch 139, loss: 0.0342, instance_loss: 0.0676, weighted_loss: 0.0442, label: 3, bag_size: 1291
batch 159, loss: 0.1494, instance_loss: 0.4049, weighted_loss: 0.2260, label: 4, bag_size: 675
batch 179, loss: 0.8933, instance_loss: 0.3942, weighted_loss: 0.7436, label: 1, bag_size: 959
batch 199, loss: 0.4486, instance_loss: 0.3350, weighted_loss: 0.4145, label: 2, bag_size: 913
batch 219, loss: 0.3958, instance_loss: 0.3722, weighted_loss: 0.3887, label: 2, bag_size: 636
batch 239, loss: 0.5772, instance_loss: 0.4079, weighted_loss: 0.5264, label: 0, bag_size: 759
batch 259, loss: 0.3801, instance_loss: 0.2639, weighted_loss: 0.3452, label: 1, bag_size: 965
batch 279, loss: 1.4897, instance_loss: 0.4860, weighted_loss: 1.1886, label: 2, bag_size: 358
batch 299, loss: 2.0167, instance_loss: 0.5264, weighted_loss: 1.5696, label: 1, bag_size: 535
batch 319, loss: 0.0033, instance_loss: 0.1817, weighted_loss: 0.0568, label: 4, bag_size: 729
batch 339, loss: 0.9146, instance_loss: 0.5205, weighted_loss: 0.7964, label: 0, bag_size: 423
batch 359, loss: 2.3206, instance_loss: 0.7245, weighted_loss: 1.8418, label: 1, bag_size: 660
batch 379, loss: 0.7791, instance_loss: 0.4996, weighted_loss: 0.6953, label: 1, bag_size: 1724
batch 399, loss: 0.0929, instance_loss: 0.1062, weighted_loss: 0.0969, label: 0, bag_size: 402
batch 419, loss: 0.9863, instance_loss: 0.4730, weighted_loss: 0.8323, label: 4, bag_size: 1360


class 0 clustering acc 0.994: correct 16898/17000
class 1 clustering acc 0.2817647058823529: correct 958/3400
Epoch: 11, train_loss: 0.6038, train_clustering_loss:  0.3506, train_error: 0.2024
class 0: acc 0.8941176470588236, correct 76/85
class 1: acc 0.6666666666666666, correct 62/93
class 2: acc 0.7127659574468085, correct 67/94
class 3: acc 0.8918918918918919, correct 66/74
class 4: acc 0.8607594936708861, correct 68/79

Val Set, val_loss: 1.1480, val_error: 0.4200, auc: 0.8447
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4444444444444444, correct 12/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6438, instance_loss: 0.3636, weighted_loss: 0.5597, label: 1, bag_size: 860
batch 39, loss: 0.5030, instance_loss: 0.3566, weighted_loss: 0.4591, label: 0, bag_size: 736
batch 59, loss: 0.0341, instance_loss: 0.1933, weighted_loss: 0.0818, label: 3, bag_size: 1291
batch 79, loss: 0.4089, instance_loss: 0.3324, weighted_loss: 0.3860, label: 2, bag_size: 701
batch 99, loss: 0.3716, instance_loss: 0.2877, weighted_loss: 0.3464, label: 0, bag_size: 350
batch 119, loss: 0.2641, instance_loss: 0.2611, weighted_loss: 0.2632, label: 0, bag_size: 1247
batch 139, loss: 2.0346, instance_loss: 0.6516, weighted_loss: 1.6197, label: 4, bag_size: 436
batch 159, loss: 0.1479, instance_loss: 0.2174, weighted_loss: 0.1688, label: 0, bag_size: 729
batch 179, loss: 0.1305, instance_loss: 0.1409, weighted_loss: 0.1336, label: 1, bag_size: 937
batch 199, loss: 0.6021, instance_loss: 0.3712, weighted_loss: 0.5328, label: 2, bag_size: 1150
batch 219, loss: 0.4426, instance_loss: 0.3654, weighted_loss: 0.4194, label: 2, bag_size: 1058
batch 239, loss: 0.0425, instance_loss: 0.2370, weighted_loss: 0.1008, label: 4, bag_size: 1176
batch 259, loss: 0.1919, instance_loss: 0.2263, weighted_loss: 0.2022, label: 0, bag_size: 800
batch 279, loss: 0.5997, instance_loss: 0.3575, weighted_loss: 0.5270, label: 1, bag_size: 818
batch 299, loss: 0.5400, instance_loss: 0.4121, weighted_loss: 0.5016, label: 3, bag_size: 200
batch 319, loss: 0.4660, instance_loss: 0.4366, weighted_loss: 0.4572, label: 2, bag_size: 1448
batch 339, loss: 0.0373, instance_loss: 0.1341, weighted_loss: 0.0664, label: 3, bag_size: 729
batch 359, loss: 2.5049, instance_loss: 0.7530, weighted_loss: 1.9793, label: 3, bag_size: 281
batch 379, loss: 0.6703, instance_loss: 0.3280, weighted_loss: 0.5676, label: 0, bag_size: 545
batch 399, loss: 2.1776, instance_loss: 0.7044, weighted_loss: 1.7356, label: 3, bag_size: 281
batch 419, loss: 0.1930, instance_loss: 0.1905, weighted_loss: 0.1922, label: 1, bag_size: 1239


class 0 clustering acc 0.9939411764705882: correct 16897/17000
class 1 clustering acc 0.29058823529411765: correct 988/3400
Epoch: 12, train_loss: 0.6188, train_clustering_loss:  0.3496, train_error: 0.2165
class 0: acc 0.8588235294117647, correct 73/85
class 1: acc 0.6511627906976745, correct 56/86
class 2: acc 0.6979166666666666, correct 67/96
class 3: acc 0.875, correct 77/88
class 4: acc 0.8571428571428571, correct 60/70

Val Set, val_loss: 1.1025, val_error: 0.4200, auc: 0.8635
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.1675: correct 67/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.4444444444444444, correct 12/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0230, instance_loss: 0.1632, weighted_loss: 0.0651, label: 3, bag_size: 729
batch 39, loss: 0.2002, instance_loss: 0.3171, weighted_loss: 0.2353, label: 3, bag_size: 230
batch 59, loss: 0.5354, instance_loss: 0.3854, weighted_loss: 0.4904, label: 2, bag_size: 357
batch 79, loss: 0.0130, instance_loss: 0.1176, weighted_loss: 0.0444, label: 4, bag_size: 729
batch 99, loss: 0.0407, instance_loss: 0.1444, weighted_loss: 0.0718, label: 3, bag_size: 729
batch 119, loss: 0.2417, instance_loss: 0.2243, weighted_loss: 0.2365, label: 0, bag_size: 736
batch 139, loss: 1.7318, instance_loss: 0.5995, weighted_loss: 1.3921, label: 1, bag_size: 269
batch 159, loss: 0.4593, instance_loss: 0.3514, weighted_loss: 0.4269, label: 2, bag_size: 913
batch 179, loss: 0.9235, instance_loss: 0.3322, weighted_loss: 0.7461, label: 2, bag_size: 1200
batch 199, loss: 0.2023, instance_loss: 0.1511, weighted_loss: 0.1869, label: 0, bag_size: 1133
batch 219, loss: 0.4814, instance_loss: 0.3471, weighted_loss: 0.4411, label: 4, bag_size: 928
batch 239, loss: 0.0011, instance_loss: 0.0870, weighted_loss: 0.0268, label: 4, bag_size: 729
batch 259, loss: 0.6333, instance_loss: 0.4171, weighted_loss: 0.5685, label: 2, bag_size: 1024
batch 279, loss: 0.0533, instance_loss: 0.0829, weighted_loss: 0.0622, label: 3, bag_size: 729
batch 299, loss: 0.1335, instance_loss: 0.1040, weighted_loss: 0.1247, label: 0, bag_size: 760
batch 319, loss: 0.6502, instance_loss: 0.4050, weighted_loss: 0.5766, label: 0, bag_size: 736
batch 339, loss: 0.9745, instance_loss: 0.3927, weighted_loss: 0.7999, label: 3, bag_size: 200
batch 359, loss: 1.3372, instance_loss: 0.5857, weighted_loss: 1.1118, label: 2, bag_size: 1052
batch 379, loss: 0.0071, instance_loss: 0.4551, weighted_loss: 0.1415, label: 4, bag_size: 974
batch 399, loss: 1.2275, instance_loss: 0.5375, weighted_loss: 1.0205, label: 1, bag_size: 269
batch 419, loss: 0.2402, instance_loss: 0.1397, weighted_loss: 0.2101, label: 0, bag_size: 246


class 0 clustering acc 0.9922352941176471: correct 16868/17000
class 1 clustering acc 0.36558823529411766: correct 1243/3400
Epoch: 13, train_loss: 0.5200, train_clustering_loss:  0.3233, train_error: 0.1765
class 0: acc 0.8846153846153846, correct 69/78
class 1: acc 0.7341772151898734, correct 58/79
class 2: acc 0.6923076923076923, correct 63/91
class 3: acc 0.8901098901098901, correct 81/91
class 4: acc 0.9186046511627907, correct 79/86

Val Set, val_loss: 0.9947, val_error: 0.4000, auc: 0.8649
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.175: correct 70/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4444444444444444, correct 12/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.078351 --> 0.994733).  Saving model ...


batch 19, loss: 0.1573, instance_loss: 0.1703, weighted_loss: 0.1612, label: 0, bag_size: 542
batch 39, loss: 0.0337, instance_loss: 0.2370, weighted_loss: 0.0947, label: 4, bag_size: 1474
batch 59, loss: 0.4039, instance_loss: 0.3645, weighted_loss: 0.3921, label: 2, bag_size: 312
batch 79, loss: 1.3143, instance_loss: 0.5487, weighted_loss: 1.0846, label: 2, bag_size: 373
batch 99, loss: 0.3826, instance_loss: 0.4868, weighted_loss: 0.4138, label: 1, bag_size: 860
batch 119, loss: 0.0139, instance_loss: 0.0955, weighted_loss: 0.0383, label: 4, bag_size: 729
batch 139, loss: 0.0124, instance_loss: 0.2673, weighted_loss: 0.0888, label: 4, bag_size: 729
batch 159, loss: 0.2053, instance_loss: 0.2932, weighted_loss: 0.2317, label: 3, bag_size: 230
batch 179, loss: 1.3771, instance_loss: 0.5703, weighted_loss: 1.1350, label: 0, bag_size: 423
batch 199, loss: 0.4231, instance_loss: 0.4074, weighted_loss: 0.4184, label: 2, bag_size: 1289
batch 219, loss: 0.0260, instance_loss: 0.2408, weighted_loss: 0.0904, label: 3, bag_size: 936
batch 239, loss: 0.2604, instance_loss: 0.2628, weighted_loss: 0.2611, label: 1, bag_size: 614
batch 259, loss: 0.9908, instance_loss: 0.4470, weighted_loss: 0.8277, label: 2, bag_size: 1139
batch 279, loss: 1.7119, instance_loss: 0.6728, weighted_loss: 1.4002, label: 3, bag_size: 281
batch 299, loss: 0.0497, instance_loss: 0.0643, weighted_loss: 0.0541, label: 3, bag_size: 729
batch 319, loss: 0.1520, instance_loss: 0.3194, weighted_loss: 0.2022, label: 0, bag_size: 729
batch 339, loss: 0.0987, instance_loss: 0.1775, weighted_loss: 0.1223, label: 0, bag_size: 807
batch 359, loss: 0.1388, instance_loss: 0.2456, weighted_loss: 0.1709, label: 1, bag_size: 636
batch 379, loss: 0.7676, instance_loss: 0.7866, weighted_loss: 0.7733, label: 2, bag_size: 474
batch 399, loss: 0.5819, instance_loss: 0.3044, weighted_loss: 0.4987, label: 1, bag_size: 474
batch 419, loss: 0.3215, instance_loss: 0.1630, weighted_loss: 0.2740, label: 3, bag_size: 729


class 0 clustering acc 0.9922352941176471: correct 16868/17000
class 1 clustering acc 0.3467647058823529: correct 1179/3400
Epoch: 14, train_loss: 0.4856, train_clustering_loss:  0.3315, train_error: 0.1694
class 0: acc 0.8735632183908046, correct 76/87
class 1: acc 0.7654320987654321, correct 62/81
class 2: acc 0.6219512195121951, correct 51/82
class 3: acc 0.9176470588235294, correct 78/85
class 4: acc 0.9555555555555556, correct 86/90

Val Set, val_loss: 0.9966, val_error: 0.3400, auc: 0.8508
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.2: correct 80/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5925925925925926, correct 16/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2610, instance_loss: 0.5049, weighted_loss: 1.0342, label: 1, bag_size: 1273
batch 39, loss: 0.2209, instance_loss: 0.2954, weighted_loss: 0.2433, label: 4, bag_size: 1357
batch 59, loss: 0.5077, instance_loss: 0.3348, weighted_loss: 0.4558, label: 2, bag_size: 1050
batch 79, loss: 0.6521, instance_loss: 0.3290, weighted_loss: 0.5552, label: 2, bag_size: 404
batch 99, loss: 0.0820, instance_loss: 0.3323, weighted_loss: 0.1571, label: 2, bag_size: 421
batch 119, loss: 1.9617, instance_loss: 0.5995, weighted_loss: 1.5531, label: 1, bag_size: 448
batch 139, loss: 0.3966, instance_loss: 0.3703, weighted_loss: 0.3888, label: 4, bag_size: 533
batch 159, loss: 0.3790, instance_loss: 0.1446, weighted_loss: 0.3087, label: 3, bag_size: 1019
batch 179, loss: 0.0289, instance_loss: 0.0876, weighted_loss: 0.0465, label: 0, bag_size: 239
batch 199, loss: 0.8253, instance_loss: 0.4124, weighted_loss: 0.7014, label: 0, bag_size: 545
batch 219, loss: 0.0466, instance_loss: 0.0805, weighted_loss: 0.0568, label: 0, bag_size: 898
batch 239, loss: 0.2950, instance_loss: 0.3068, weighted_loss: 0.2985, label: 1, bag_size: 530
batch 259, loss: 0.0085, instance_loss: 0.1528, weighted_loss: 0.0518, label: 4, bag_size: 1176
batch 279, loss: 0.0985, instance_loss: 0.1011, weighted_loss: 0.0993, label: 0, bag_size: 616
batch 299, loss: 0.0432, instance_loss: 0.2675, weighted_loss: 0.1105, label: 4, bag_size: 823
batch 319, loss: 0.0140, instance_loss: 0.0814, weighted_loss: 0.0342, label: 3, bag_size: 729
batch 339, loss: 1.1313, instance_loss: 0.4506, weighted_loss: 0.9271, label: 0, bag_size: 1065
batch 359, loss: 0.0470, instance_loss: 0.0706, weighted_loss: 0.0541, label: 3, bag_size: 1177
batch 379, loss: 0.0255, instance_loss: 0.0461, weighted_loss: 0.0316, label: 3, bag_size: 729
batch 399, loss: 0.0954, instance_loss: 0.1489, weighted_loss: 0.1114, label: 0, bag_size: 630
batch 419, loss: 0.0679, instance_loss: 0.2784, weighted_loss: 0.1310, label: 4, bag_size: 542


class 0 clustering acc 0.9912941176470588: correct 16852/17000
class 1 clustering acc 0.3547058823529412: correct 1206/3400
Epoch: 15, train_loss: 0.5227, train_clustering_loss:  0.3344, train_error: 0.2000
class 0: acc 0.8450704225352113, correct 60/71
class 1: acc 0.6941176470588235, correct 59/85
class 2: acc 0.6746987951807228, correct 56/83
class 3: acc 0.8953488372093024, correct 77/86
class 4: acc 0.88, correct 88/100

Val Set, val_loss: 1.1888, val_error: 0.3800, auc: 0.8490
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.1925: correct 77/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4444444444444444, correct 12/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6519, instance_loss: 0.6374, weighted_loss: 1.3475, label: 0, bag_size: 1289
batch 39, loss: 0.1656, instance_loss: 0.3022, weighted_loss: 0.2066, label: 1, bag_size: 925
batch 59, loss: 0.0024, instance_loss: 0.4431, weighted_loss: 0.1346, label: 4, bag_size: 711
batch 79, loss: 0.0344, instance_loss: 0.1251, weighted_loss: 0.0616, label: 4, bag_size: 729
batch 99, loss: 0.0266, instance_loss: 0.0582, weighted_loss: 0.0361, label: 0, bag_size: 1599
batch 119, loss: 0.7113, instance_loss: 0.4066, weighted_loss: 0.6199, label: 2, bag_size: 1053
batch 139, loss: 0.3313, instance_loss: 0.4694, weighted_loss: 0.3727, label: 2, bag_size: 358
batch 159, loss: 0.1188, instance_loss: 0.4096, weighted_loss: 0.2060, label: 1, bag_size: 890
batch 179, loss: 0.0146, instance_loss: 0.6818, weighted_loss: 0.2147, label: 4, bag_size: 882
batch 199, loss: 1.6150, instance_loss: 0.5819, weighted_loss: 1.3051, label: 1, bag_size: 1144
batch 219, loss: 0.0560, instance_loss: 0.0861, weighted_loss: 0.0651, label: 3, bag_size: 729
batch 239, loss: 0.0115, instance_loss: 0.1161, weighted_loss: 0.0429, label: 4, bag_size: 729
batch 259, loss: 0.0254, instance_loss: 0.0459, weighted_loss: 0.0315, label: 3, bag_size: 556
batch 279, loss: 0.3364, instance_loss: 0.3025, weighted_loss: 0.3262, label: 1, bag_size: 846
batch 299, loss: 0.0074, instance_loss: 0.0557, weighted_loss: 0.0219, label: 3, bag_size: 1172
batch 319, loss: 0.2024, instance_loss: 0.2048, weighted_loss: 0.2032, label: 1, bag_size: 746
batch 339, loss: 0.0418, instance_loss: 0.2331, weighted_loss: 0.0992, label: 4, bag_size: 1278
batch 359, loss: 0.2006, instance_loss: 0.2002, weighted_loss: 0.2005, label: 0, bag_size: 476
batch 379, loss: 2.0716, instance_loss: 0.8884, weighted_loss: 1.7166, label: 2, bag_size: 1043
batch 399, loss: 0.0065, instance_loss: 0.0257, weighted_loss: 0.0123, label: 3, bag_size: 1069
batch 419, loss: 0.0563, instance_loss: 0.2867, weighted_loss: 0.1254, label: 0, bag_size: 729


class 0 clustering acc 0.9904705882352941: correct 16838/17000
class 1 clustering acc 0.40441176470588236: correct 1375/3400
Epoch: 16, train_loss: 0.4192, train_clustering_loss:  0.3139, train_error: 0.1341
class 0: acc 0.9565217391304348, correct 88/92
class 1: acc 0.7802197802197802, correct 71/91
class 2: acc 0.7564102564102564, correct 59/78
class 3: acc 0.8913043478260869, correct 82/92
class 4: acc 0.9444444444444444, correct 68/72

Val Set, val_loss: 1.3210, val_error: 0.5200, auc: 0.8594
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.25925925925925924, correct 7/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8056, instance_loss: 0.4425, weighted_loss: 0.6967, label: 4, bag_size: 1360
batch 39, loss: 3.4100, instance_loss: 0.4988, weighted_loss: 2.5366, label: 0, bag_size: 1247
batch 59, loss: 0.5714, instance_loss: 0.3399, weighted_loss: 0.5020, label: 3, bag_size: 1118
batch 79, loss: 0.4316, instance_loss: 0.4432, weighted_loss: 0.4351, label: 3, bag_size: 706
batch 99, loss: 0.3500, instance_loss: 0.3505, weighted_loss: 0.3502, label: 1, bag_size: 897
batch 119, loss: 0.4071, instance_loss: 0.4834, weighted_loss: 0.4300, label: 2, bag_size: 2703
batch 139, loss: 2.8167, instance_loss: 0.9394, weighted_loss: 2.2535, label: 1, bag_size: 1409
batch 159, loss: 0.0013, instance_loss: 0.0525, weighted_loss: 0.0166, label: 4, bag_size: 729
batch 179, loss: 0.5800, instance_loss: 0.2945, weighted_loss: 0.4944, label: 0, bag_size: 545
batch 199, loss: 0.4859, instance_loss: 0.3929, weighted_loss: 0.4580, label: 0, bag_size: 759
batch 219, loss: 0.0379, instance_loss: 0.3440, weighted_loss: 0.1297, label: 3, bag_size: 936
batch 239, loss: 0.4692, instance_loss: 0.4492, weighted_loss: 0.4632, label: 1, bag_size: 1144
batch 259, loss: 0.1990, instance_loss: 0.5036, weighted_loss: 0.2904, label: 4, bag_size: 366
batch 279, loss: 0.0075, instance_loss: 0.0820, weighted_loss: 0.0299, label: 4, bag_size: 1176
batch 299, loss: 0.1247, instance_loss: 0.2520, weighted_loss: 0.1629, label: 2, bag_size: 469
batch 319, loss: 0.0162, instance_loss: 0.7435, weighted_loss: 0.2344, label: 4, bag_size: 882
batch 339, loss: 0.0022, instance_loss: 0.1338, weighted_loss: 0.0417, label: 4, bag_size: 729
batch 359, loss: 0.4368, instance_loss: 0.3807, weighted_loss: 0.4200, label: 2, bag_size: 358
batch 379, loss: 0.3092, instance_loss: 0.2510, weighted_loss: 0.2918, label: 0, bag_size: 476
batch 399, loss: 0.1232, instance_loss: 0.2195, weighted_loss: 0.1521, label: 3, bag_size: 1118
batch 419, loss: 0.0060, instance_loss: 0.3220, weighted_loss: 0.1008, label: 4, bag_size: 1002


class 0 clustering acc 0.9903529411764705: correct 16836/17000
class 1 clustering acc 0.39: correct 1326/3400
Epoch: 17, train_loss: 0.4301, train_clustering_loss:  0.3173, train_error: 0.1294
class 0: acc 0.9393939393939394, correct 93/99
class 1: acc 0.8095238095238095, correct 68/84
class 2: acc 0.684931506849315, correct 50/73
class 3: acc 0.9767441860465116, correct 84/86
class 4: acc 0.9036144578313253, correct 75/83

Val Set, val_loss: 1.3782, val_error: 0.5000, auc: 0.8770
class 0 clustering acc 0.967: correct 1934/2000
class 1 clustering acc 0.2525: correct 101/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.25925925925925924, correct 7/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0441, instance_loss: 0.0617, weighted_loss: 0.0494, label: 3, bag_size: 729
batch 39, loss: 0.8540, instance_loss: 0.4134, weighted_loss: 0.7218, label: 2, bag_size: 861
batch 59, loss: 0.0454, instance_loss: 0.0455, weighted_loss: 0.0455, label: 3, bag_size: 1069
batch 79, loss: 0.1305, instance_loss: 0.2548, weighted_loss: 0.1678, label: 2, bag_size: 632
batch 99, loss: 0.8515, instance_loss: 0.4496, weighted_loss: 0.7309, label: 1, bag_size: 968
batch 119, loss: 0.0027, instance_loss: 0.2130, weighted_loss: 0.0658, label: 4, bag_size: 729
batch 139, loss: 0.0498, instance_loss: 0.1459, weighted_loss: 0.0786, label: 0, bag_size: 246
batch 159, loss: 0.0488, instance_loss: 0.1169, weighted_loss: 0.0692, label: 3, bag_size: 791
batch 179, loss: 0.0686, instance_loss: 0.1952, weighted_loss: 0.1066, label: 2, bag_size: 935
batch 199, loss: 0.1537, instance_loss: 0.2495, weighted_loss: 0.1824, label: 2, bag_size: 1039
batch 219, loss: 0.0001, instance_loss: 0.3213, weighted_loss: 0.0964, label: 4, bag_size: 1002
batch 239, loss: 0.0019, instance_loss: 0.0924, weighted_loss: 0.0291, label: 4, bag_size: 729
batch 259, loss: 1.6550, instance_loss: 0.8132, weighted_loss: 1.4025, label: 2, bag_size: 967
batch 279, loss: 0.0000, instance_loss: 0.1492, weighted_loss: 0.0448, label: 4, bag_size: 1002
batch 299, loss: 0.1249, instance_loss: 0.2703, weighted_loss: 0.1685, label: 0, bag_size: 1034
batch 319, loss: 0.1033, instance_loss: 0.2613, weighted_loss: 0.1507, label: 2, bag_size: 323
batch 339, loss: 0.3515, instance_loss: 0.3823, weighted_loss: 0.3607, label: 4, bag_size: 533
batch 359, loss: 0.4035, instance_loss: 0.3639, weighted_loss: 0.3916, label: 2, bag_size: 632
batch 379, loss: 0.1010, instance_loss: 0.1880, weighted_loss: 0.1271, label: 0, bag_size: 371
batch 399, loss: 0.1400, instance_loss: 0.1420, weighted_loss: 0.1406, label: 0, bag_size: 1190
batch 419, loss: 0.4031, instance_loss: 0.3516, weighted_loss: 0.3877, label: 2, bag_size: 358


class 0 clustering acc 0.9871764705882353: correct 16782/17000
class 1 clustering acc 0.3926470588235294: correct 1335/3400
Epoch: 18, train_loss: 0.3938, train_clustering_loss:  0.3271, train_error: 0.1294
class 0: acc 0.9130434782608695, correct 84/92
class 1: acc 0.7536231884057971, correct 52/69
class 2: acc 0.75, correct 66/88
class 3: acc 0.9787234042553191, correct 92/94
class 4: acc 0.926829268292683, correct 76/82

Val Set, val_loss: 1.3248, val_error: 0.4800, auc: 0.8719
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.2475: correct 99/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.2962962962962963, correct 8/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0745, instance_loss: 0.2224, weighted_loss: 0.1189, label: 1, bag_size: 945
batch 39, loss: 1.2949, instance_loss: 0.6513, weighted_loss: 1.1018, label: 4, bag_size: 436
batch 59, loss: 0.1415, instance_loss: 0.2217, weighted_loss: 0.1656, label: 0, bag_size: 607
batch 79, loss: 4.2275, instance_loss: 1.2367, weighted_loss: 3.3303, label: 1, bag_size: 1799
batch 99, loss: 0.0971, instance_loss: 0.1623, weighted_loss: 0.1167, label: 0, bag_size: 410
batch 119, loss: 0.0415, instance_loss: 0.1020, weighted_loss: 0.0596, label: 0, bag_size: 246
batch 139, loss: 0.4169, instance_loss: 0.5184, weighted_loss: 0.4474, label: 2, bag_size: 358
batch 159, loss: 0.0595, instance_loss: 0.3643, weighted_loss: 0.1509, label: 3, bag_size: 706
batch 179, loss: 1.9083, instance_loss: 0.6095, weighted_loss: 1.5187, label: 2, bag_size: 411
batch 199, loss: 0.2543, instance_loss: 0.4108, weighted_loss: 0.3012, label: 3, bag_size: 305
batch 219, loss: 0.2253, instance_loss: 0.3867, weighted_loss: 0.2737, label: 4, bag_size: 1337
batch 239, loss: 0.1510, instance_loss: 0.2410, weighted_loss: 0.1780, label: 0, bag_size: 1190
batch 259, loss: 0.0237, instance_loss: 0.0686, weighted_loss: 0.0372, label: 0, bag_size: 521
batch 279, loss: 0.0360, instance_loss: 0.0682, weighted_loss: 0.0456, label: 0, bag_size: 472
batch 299, loss: 0.2985, instance_loss: 0.3734, weighted_loss: 0.3210, label: 2, bag_size: 357
batch 319, loss: 0.0014, instance_loss: 0.3882, weighted_loss: 0.1175, label: 4, bag_size: 711
batch 339, loss: 0.0053, instance_loss: 0.1922, weighted_loss: 0.0614, label: 3, bag_size: 1253
batch 359, loss: 0.5916, instance_loss: 0.4873, weighted_loss: 0.5603, label: 2, bag_size: 861
batch 379, loss: 0.0220, instance_loss: 0.2911, weighted_loss: 0.1027, label: 3, bag_size: 706
batch 399, loss: 0.7401, instance_loss: 0.3693, weighted_loss: 0.6289, label: 1, bag_size: 1014
batch 419, loss: 0.1907, instance_loss: 0.5737, weighted_loss: 0.3056, label: 4, bag_size: 675


class 0 clustering acc 0.9910588235294118: correct 16848/17000
class 1 clustering acc 0.39441176470588235: correct 1341/3400
Epoch: 19, train_loss: 0.4293, train_clustering_loss:  0.3235, train_error: 0.1529
class 0: acc 0.9263157894736842, correct 88/95
class 1: acc 0.6555555555555556, correct 59/90
class 2: acc 0.775, correct 62/80
class 3: acc 0.9540229885057471, correct 83/87
class 4: acc 0.9315068493150684, correct 68/73

Val Set, val_loss: 1.5280, val_error: 0.5200, auc: 0.8635
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.2222222222222222, correct 6/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0306, instance_loss: 0.1269, weighted_loss: 0.0595, label: 0, bag_size: 729
batch 39, loss: 0.0833, instance_loss: 0.2254, weighted_loss: 0.1259, label: 1, bag_size: 846
batch 59, loss: 0.0120, instance_loss: 0.0785, weighted_loss: 0.0320, label: 3, bag_size: 729
batch 79, loss: 0.9470, instance_loss: 0.5057, weighted_loss: 0.8146, label: 0, bag_size: 542
batch 99, loss: 0.3826, instance_loss: 0.7072, weighted_loss: 0.4800, label: 2, bag_size: 803
batch 119, loss: 0.1308, instance_loss: 0.2878, weighted_loss: 0.1779, label: 3, bag_size: 360
batch 139, loss: 0.0518, instance_loss: 0.0814, weighted_loss: 0.0607, label: 0, bag_size: 1174
batch 159, loss: 0.0970, instance_loss: 0.0828, weighted_loss: 0.0928, label: 3, bag_size: 1177
batch 179, loss: 1.1861, instance_loss: 0.5964, weighted_loss: 1.0092, label: 4, bag_size: 436
batch 199, loss: 0.1424, instance_loss: 0.1783, weighted_loss: 0.1532, label: 3, bag_size: 533
batch 219, loss: 1.8637, instance_loss: 0.6361, weighted_loss: 1.4955, label: 1, bag_size: 535
batch 239, loss: 0.2527, instance_loss: 0.3983, weighted_loss: 0.2964, label: 4, bag_size: 1474
batch 259, loss: 1.2126, instance_loss: 0.5191, weighted_loss: 1.0045, label: 0, bag_size: 245
batch 279, loss: 0.0506, instance_loss: 0.1993, weighted_loss: 0.0952, label: 1, bag_size: 1261
batch 299, loss: 0.0884, instance_loss: 0.0595, weighted_loss: 0.0797, label: 3, bag_size: 556
batch 319, loss: 1.4308, instance_loss: 0.6094, weighted_loss: 1.1844, label: 1, bag_size: 487
batch 339, loss: 1.3003, instance_loss: 0.4103, weighted_loss: 1.0333, label: 4, bag_size: 1337
batch 359, loss: 0.1151, instance_loss: 0.2530, weighted_loss: 0.1564, label: 4, bag_size: 1357
batch 379, loss: 0.3938, instance_loss: 0.3571, weighted_loss: 0.3828, label: 2, bag_size: 1200
batch 399, loss: 0.0155, instance_loss: 0.1680, weighted_loss: 0.0612, label: 4, bag_size: 1278
batch 419, loss: 0.1454, instance_loss: 0.2441, weighted_loss: 0.1750, label: 2, bag_size: 347


class 0 clustering acc 0.9898235294117647: correct 16827/17000
class 1 clustering acc 0.4023529411764706: correct 1368/3400
Epoch: 20, train_loss: 0.3652, train_clustering_loss:  0.3103, train_error: 0.1247
class 0: acc 0.9213483146067416, correct 82/89
class 1: acc 0.8076923076923077, correct 63/78
class 2: acc 0.7346938775510204, correct 72/98
class 3: acc 0.9882352941176471, correct 84/85
class 4: acc 0.9466666666666667, correct 71/75

Val Set, val_loss: 0.9574, val_error: 0.3400, auc: 0.8564
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.4, correct 2/5
class 2: acc 0.6296296296296297, correct 17/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
Validation loss decreased (0.994733 --> 0.957369).  Saving model ...


batch 19, loss: 0.1258, instance_loss: 0.2365, weighted_loss: 0.1590, label: 0, bag_size: 432
batch 39, loss: 0.0008, instance_loss: 0.1249, weighted_loss: 0.0380, label: 4, bag_size: 729
batch 59, loss: 0.0299, instance_loss: 0.0589, weighted_loss: 0.0386, label: 0, bag_size: 1174
batch 79, loss: 1.5287, instance_loss: 0.5621, weighted_loss: 1.2387, label: 1, bag_size: 377
batch 99, loss: 0.3517, instance_loss: 0.4605, weighted_loss: 0.3843, label: 4, bag_size: 366
batch 119, loss: 1.5287, instance_loss: 0.4933, weighted_loss: 1.2181, label: 2, bag_size: 500
batch 139, loss: 0.0187, instance_loss: 0.1198, weighted_loss: 0.0491, label: 1, bag_size: 847
batch 159, loss: 0.0587, instance_loss: 0.1073, weighted_loss: 0.0733, label: 0, bag_size: 410
batch 179, loss: 1.0942, instance_loss: 0.6651, weighted_loss: 0.9655, label: 0, bag_size: 1065
batch 199, loss: 0.5931, instance_loss: 0.4748, weighted_loss: 0.5576, label: 1, bag_size: 319
batch 219, loss: 0.1787, instance_loss: 0.2942, weighted_loss: 0.2133, label: 2, bag_size: 846
batch 239, loss: 0.0226, instance_loss: 0.1045, weighted_loss: 0.0472, label: 3, bag_size: 729
batch 259, loss: 0.0073, instance_loss: 0.0674, weighted_loss: 0.0254, label: 4, bag_size: 1121
batch 279, loss: 0.6023, instance_loss: 0.5305, weighted_loss: 0.5808, label: 1, bag_size: 1273
batch 299, loss: 0.8992, instance_loss: 0.6994, weighted_loss: 0.8393, label: 3, bag_size: 281
batch 319, loss: 0.1664, instance_loss: 0.2098, weighted_loss: 0.1794, label: 2, bag_size: 525
batch 339, loss: 1.6304, instance_loss: 0.5756, weighted_loss: 1.3139, label: 0, bag_size: 868
batch 359, loss: 0.0816, instance_loss: 0.1312, weighted_loss: 0.0965, label: 3, bag_size: 729
batch 379, loss: 0.1271, instance_loss: 0.2268, weighted_loss: 0.1570, label: 1, bag_size: 846
batch 399, loss: 0.0197, instance_loss: 0.1954, weighted_loss: 0.0724, label: 3, bag_size: 1253
batch 419, loss: 0.0719, instance_loss: 0.2232, weighted_loss: 0.1173, label: 4, bag_size: 817


class 0 clustering acc 0.9908823529411764: correct 16845/17000
class 1 clustering acc 0.4067647058823529: correct 1383/3400
Epoch: 21, train_loss: 0.3403, train_clustering_loss:  0.3108, train_error: 0.1271
class 0: acc 0.9047619047619048, correct 76/84
class 1: acc 0.7526881720430108, correct 70/93
class 2: acc 0.8292682926829268, correct 68/82
class 3: acc 0.9506172839506173, correct 77/81
class 4: acc 0.9411764705882353, correct 80/85

Val Set, val_loss: 1.2589, val_error: 0.4000, auc: 0.8568
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4074074074074074, correct 11/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1554, instance_loss: 0.4512, weighted_loss: 0.2442, label: 1, bag_size: 319
batch 39, loss: 0.0639, instance_loss: 0.1336, weighted_loss: 0.0848, label: 3, bag_size: 729
batch 59, loss: 0.1000, instance_loss: 0.2125, weighted_loss: 0.1337, label: 0, bag_size: 1579
batch 79, loss: 0.0114, instance_loss: 0.0469, weighted_loss: 0.0220, label: 0, bag_size: 1599
batch 99, loss: 0.1023, instance_loss: 0.3491, weighted_loss: 0.1763, label: 1, bag_size: 700
batch 119, loss: 0.0105, instance_loss: 0.1654, weighted_loss: 0.0570, label: 3, bag_size: 729
batch 139, loss: 0.2687, instance_loss: 0.3391, weighted_loss: 0.2898, label: 2, bag_size: 399
batch 159, loss: 0.0226, instance_loss: 0.1197, weighted_loss: 0.0517, label: 0, bag_size: 729
batch 179, loss: 0.1224, instance_loss: 0.2530, weighted_loss: 0.1616, label: 1, bag_size: 925
batch 199, loss: 0.0039, instance_loss: 0.0809, weighted_loss: 0.0270, label: 4, bag_size: 729
batch 219, loss: 0.0015, instance_loss: 0.0613, weighted_loss: 0.0194, label: 4, bag_size: 388
batch 239, loss: 0.8483, instance_loss: 0.4394, weighted_loss: 0.7256, label: 2, bag_size: 1006
batch 259, loss: 0.0399, instance_loss: 0.2218, weighted_loss: 0.0945, label: 4, bag_size: 1357
batch 279, loss: 0.4659, instance_loss: 0.5465, weighted_loss: 0.4900, label: 1, bag_size: 1559
batch 299, loss: 0.0096, instance_loss: 0.2056, weighted_loss: 0.0684, label: 1, bag_size: 890
batch 319, loss: 0.3880, instance_loss: 0.5470, weighted_loss: 0.4357, label: 4, bag_size: 436
batch 339, loss: 0.0625, instance_loss: 0.1704, weighted_loss: 0.0948, label: 0, bag_size: 478
batch 359, loss: 0.3878, instance_loss: 0.4709, weighted_loss: 0.4127, label: 2, bag_size: 1617
batch 379, loss: 0.2015, instance_loss: 0.3112, weighted_loss: 0.2344, label: 1, bag_size: 1144
batch 399, loss: 2.0781, instance_loss: 0.7432, weighted_loss: 1.6777, label: 1, bag_size: 535
batch 419, loss: 0.7011, instance_loss: 0.4470, weighted_loss: 0.6249, label: 4, bag_size: 590


class 0 clustering acc 0.9895294117647059: correct 16822/17000
class 1 clustering acc 0.4273529411764706: correct 1453/3400
Epoch: 22, train_loss: 0.3169, train_clustering_loss:  0.2982, train_error: 0.0941
class 0: acc 0.9340659340659341, correct 85/91
class 1: acc 0.8021978021978022, correct 73/91
class 2: acc 0.8133333333333334, correct 61/75
class 3: acc 1.0, correct 80/80
class 4: acc 0.9772727272727273, correct 86/88

Val Set, val_loss: 1.3171, val_error: 0.4000, auc: 0.8574
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4074074074074074, correct 11/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0931, instance_loss: 0.3549, weighted_loss: 0.1717, label: 1, bag_size: 754
batch 39, loss: 1.9933, instance_loss: 0.8136, weighted_loss: 1.6394, label: 0, bag_size: 282
batch 59, loss: 0.0963, instance_loss: 0.4845, weighted_loss: 0.2128, label: 3, bag_size: 1380
batch 79, loss: 1.3748, instance_loss: 0.6655, weighted_loss: 1.1620, label: 4, bag_size: 436
batch 99, loss: 0.0235, instance_loss: 0.0989, weighted_loss: 0.0461, label: 3, bag_size: 729
batch 119, loss: 0.0028, instance_loss: 0.0708, weighted_loss: 0.0232, label: 4, bag_size: 764
batch 139, loss: 1.4240, instance_loss: 0.6219, weighted_loss: 1.1833, label: 1, bag_size: 470
batch 159, loss: 1.1878, instance_loss: 0.5652, weighted_loss: 1.0010, label: 2, bag_size: 1416
batch 179, loss: 1.0328, instance_loss: 0.5268, weighted_loss: 0.8810, label: 1, bag_size: 139
batch 199, loss: 0.0972, instance_loss: 0.6879, weighted_loss: 0.2744, label: 4, bag_size: 663
batch 219, loss: 0.0010, instance_loss: 0.4055, weighted_loss: 0.1224, label: 4, bag_size: 974
batch 239, loss: 0.8466, instance_loss: 0.4575, weighted_loss: 0.7299, label: 0, bag_size: 1527
batch 259, loss: 0.0407, instance_loss: 0.1158, weighted_loss: 0.0632, label: 0, bag_size: 413
batch 279, loss: 0.0892, instance_loss: 0.2840, weighted_loss: 0.1476, label: 1, bag_size: 1402
batch 299, loss: 0.5887, instance_loss: 0.8411, weighted_loss: 0.6644, label: 1, bag_size: 700
batch 319, loss: 0.1068, instance_loss: 0.2615, weighted_loss: 0.1532, label: 0, bag_size: 1046
batch 339, loss: 0.1991, instance_loss: 0.3076, weighted_loss: 0.2316, label: 2, bag_size: 1119
batch 359, loss: 0.0283, instance_loss: 0.1164, weighted_loss: 0.0547, label: 3, bag_size: 729
batch 379, loss: 0.1333, instance_loss: 0.0543, weighted_loss: 0.1096, label: 3, bag_size: 556
batch 399, loss: 0.0001, instance_loss: 0.2375, weighted_loss: 0.0713, label: 4, bag_size: 729
batch 419, loss: 0.0458, instance_loss: 0.1775, weighted_loss: 0.0853, label: 4, bag_size: 1278


class 0 clustering acc 0.9881176470588235: correct 16798/17000
class 1 clustering acc 0.40147058823529413: correct 1365/3400
Epoch: 23, train_loss: 0.3495, train_clustering_loss:  0.3190, train_error: 0.1341
class 0: acc 0.896551724137931, correct 78/87
class 1: acc 0.7733333333333333, correct 58/75
class 2: acc 0.7346938775510204, correct 72/98
class 3: acc 0.9876543209876543, correct 80/81
class 4: acc 0.9523809523809523, correct 80/84

Val Set, val_loss: 1.1083, val_error: 0.3800, auc: 0.8463
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5185185185185185, correct 14/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8063, instance_loss: 0.4856, weighted_loss: 0.7101, label: 2, bag_size: 1180
batch 39, loss: 0.0367, instance_loss: 0.0669, weighted_loss: 0.0458, label: 3, bag_size: 1291
batch 59, loss: 0.0276, instance_loss: 0.3288, weighted_loss: 0.1179, label: 4, bag_size: 1474
batch 79, loss: 0.0675, instance_loss: 0.1426, weighted_loss: 0.0901, label: 0, bag_size: 381
batch 99, loss: 0.0298, instance_loss: 0.1024, weighted_loss: 0.0516, label: 0, bag_size: 1235
batch 119, loss: 0.3616, instance_loss: 0.3752, weighted_loss: 0.3657, label: 1, bag_size: 1651
batch 139, loss: 0.0888, instance_loss: 0.3078, weighted_loss: 0.1545, label: 2, bag_size: 314
batch 159, loss: 0.2578, instance_loss: 0.3040, weighted_loss: 0.2717, label: 1, bag_size: 818
batch 179, loss: 1.2983, instance_loss: 0.6097, weighted_loss: 1.0917, label: 2, bag_size: 1231
batch 199, loss: 0.0120, instance_loss: 0.6693, weighted_loss: 0.2092, label: 4, bag_size: 882
batch 219, loss: 0.0001, instance_loss: 0.1361, weighted_loss: 0.0409, label: 4, bag_size: 729
batch 239, loss: 0.1237, instance_loss: 0.3035, weighted_loss: 0.1776, label: 0, bag_size: 800
batch 259, loss: 0.0176, instance_loss: 0.0639, weighted_loss: 0.0315, label: 4, bag_size: 1121
batch 279, loss: 2.3956, instance_loss: 0.7077, weighted_loss: 1.8892, label: 1, bag_size: 1172
batch 299, loss: 0.6091, instance_loss: 0.5550, weighted_loss: 0.5929, label: 1, bag_size: 598
batch 319, loss: 0.0302, instance_loss: 0.1457, weighted_loss: 0.0648, label: 0, bag_size: 1018
batch 339, loss: 0.0002, instance_loss: 0.0376, weighted_loss: 0.0114, label: 4, bag_size: 729
batch 359, loss: 0.0476, instance_loss: 0.0724, weighted_loss: 0.0550, label: 3, bag_size: 729
batch 379, loss: 1.0027, instance_loss: 0.5802, weighted_loss: 0.8760, label: 1, bag_size: 1273
batch 399, loss: 0.3547, instance_loss: 0.5245, weighted_loss: 0.4057, label: 3, bag_size: 1380
batch 419, loss: 0.9127, instance_loss: 0.4819, weighted_loss: 0.7835, label: 2, bag_size: 357


class 0 clustering acc 0.9889411764705882: correct 16812/17000
class 1 clustering acc 0.4273529411764706: correct 1453/3400
Epoch: 24, train_loss: 0.2994, train_clustering_loss:  0.3058, train_error: 0.1059
class 0: acc 0.9418604651162791, correct 81/86
class 1: acc 0.7435897435897436, correct 58/78
class 2: acc 0.7948717948717948, correct 62/78
class 3: acc 0.9642857142857143, correct 81/84
class 4: acc 0.98989898989899, correct 98/99

Val Set, val_loss: 1.4389, val_error: 0.5200, auc: 0.8716
class 0 clustering acc 0.9615: correct 1923/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.25925925925925924, correct 7/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3861, instance_loss: 0.3394, weighted_loss: 0.3721, label: 2, bag_size: 357
batch 39, loss: 0.2342, instance_loss: 0.3490, weighted_loss: 0.2687, label: 2, bag_size: 307
batch 59, loss: 0.0432, instance_loss: 0.3115, weighted_loss: 0.1237, label: 3, bag_size: 317
batch 79, loss: 2.6160, instance_loss: 0.9112, weighted_loss: 2.1046, label: 3, bag_size: 200
batch 99, loss: 0.5356, instance_loss: 0.6249, weighted_loss: 0.5624, label: 2, bag_size: 3236
batch 119, loss: 0.0094, instance_loss: 0.1539, weighted_loss: 0.0528, label: 4, bag_size: 656
batch 139, loss: 0.0081, instance_loss: 0.0440, weighted_loss: 0.0188, label: 0, bag_size: 385
batch 159, loss: 0.6567, instance_loss: 0.5196, weighted_loss: 0.6156, label: 3, bag_size: 283
batch 179, loss: 0.0203, instance_loss: 0.1871, weighted_loss: 0.0703, label: 1, bag_size: 834
batch 199, loss: 0.0614, instance_loss: 0.2063, weighted_loss: 0.1049, label: 0, bag_size: 1018
batch 219, loss: 0.0217, instance_loss: 0.5374, weighted_loss: 0.1764, label: 3, bag_size: 1380
batch 239, loss: 1.6254, instance_loss: 0.1088, weighted_loss: 1.1704, label: 3, bag_size: 1069
batch 259, loss: 0.2658, instance_loss: 0.6061, weighted_loss: 0.3679, label: 2, bag_size: 1069
batch 279, loss: 0.6714, instance_loss: 0.2878, weighted_loss: 0.5563, label: 0, bag_size: 423
batch 299, loss: 0.0050, instance_loss: 0.0555, weighted_loss: 0.0202, label: 3, bag_size: 729
batch 319, loss: 0.0361, instance_loss: 0.2330, weighted_loss: 0.0952, label: 0, bag_size: 729
batch 339, loss: 0.0420, instance_loss: 0.3053, weighted_loss: 0.1210, label: 3, bag_size: 936
batch 359, loss: 0.0132, instance_loss: 0.0391, weighted_loss: 0.0209, label: 0, bag_size: 402
batch 379, loss: 0.0287, instance_loss: 0.0767, weighted_loss: 0.0431, label: 0, bag_size: 729
batch 399, loss: 0.2186, instance_loss: 0.3353, weighted_loss: 0.2536, label: 2, bag_size: 986
batch 419, loss: 0.4108, instance_loss: 0.4449, weighted_loss: 0.4210, label: 3, bag_size: 281


class 0 clustering acc 0.987: correct 16779/17000
class 1 clustering acc 0.41147058823529414: correct 1399/3400
Epoch: 25, train_loss: 0.3751, train_clustering_loss:  0.3219, train_error: 0.1412
class 0: acc 0.8809523809523809, correct 74/84
class 1: acc 0.7894736842105263, correct 75/95
class 2: acc 0.7444444444444445, correct 67/90
class 3: acc 0.9444444444444444, correct 85/90
class 4: acc 0.9696969696969697, correct 64/66

Val Set, val_loss: 1.2364, val_error: 0.4400, auc: 0.8646
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.2675: correct 107/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.4074074074074074, correct 11/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1854, instance_loss: 0.4098, weighted_loss: 0.2527, label: 3, bag_size: 283
batch 39, loss: 0.0053, instance_loss: 0.1534, weighted_loss: 0.0497, label: 4, bag_size: 711
batch 59, loss: 0.0585, instance_loss: 0.3295, weighted_loss: 0.1398, label: 2, bag_size: 1514
batch 79, loss: 0.2834, instance_loss: 0.4981, weighted_loss: 0.3478, label: 1, bag_size: 242
batch 99, loss: 0.0462, instance_loss: 0.2528, weighted_loss: 0.1082, label: 2, bag_size: 986
batch 119, loss: 0.0755, instance_loss: 0.2298, weighted_loss: 0.1218, label: 4, bag_size: 928
batch 139, loss: 0.9550, instance_loss: 0.6740, weighted_loss: 0.8707, label: 2, bag_size: 319
batch 159, loss: 0.0087, instance_loss: 0.0459, weighted_loss: 0.0198, label: 0, bag_size: 521
batch 179, loss: 0.7434, instance_loss: 0.4566, weighted_loss: 0.6574, label: 2, bag_size: 345
batch 199, loss: 0.4668, instance_loss: 0.3359, weighted_loss: 0.4276, label: 1, bag_size: 858
batch 219, loss: 0.0126, instance_loss: 0.1184, weighted_loss: 0.0444, label: 3, bag_size: 729
batch 239, loss: 0.0125, instance_loss: 0.2125, weighted_loss: 0.0725, label: 4, bag_size: 1474
batch 259, loss: 0.0365, instance_loss: 0.1533, weighted_loss: 0.0716, label: 3, bag_size: 230
batch 279, loss: 0.1680, instance_loss: 0.4907, weighted_loss: 0.2648, label: 3, bag_size: 283
batch 299, loss: 0.0340, instance_loss: 0.2091, weighted_loss: 0.0865, label: 4, bag_size: 625
batch 319, loss: 0.0155, instance_loss: 0.2913, weighted_loss: 0.0982, label: 3, bag_size: 936
batch 339, loss: 0.0332, instance_loss: 0.0582, weighted_loss: 0.0407, label: 3, bag_size: 556
batch 359, loss: 2.1805, instance_loss: 0.5383, weighted_loss: 1.6878, label: 0, bag_size: 1257
batch 379, loss: 0.2568, instance_loss: 0.3349, weighted_loss: 0.2803, label: 2, bag_size: 868
batch 399, loss: 1.1424, instance_loss: 0.5366, weighted_loss: 0.9606, label: 1, bag_size: 377
batch 419, loss: 0.0385, instance_loss: 0.2010, weighted_loss: 0.0873, label: 1, bag_size: 847


class 0 clustering acc 0.9887058823529412: correct 16808/17000
class 1 clustering acc 0.43323529411764705: correct 1473/3400
Epoch: 26, train_loss: 0.2467, train_clustering_loss:  0.3079, train_error: 0.0706
class 0: acc 0.9375, correct 60/64
class 1: acc 0.8552631578947368, correct 65/76
class 2: acc 0.8494623655913979, correct 79/93
class 3: acc 1.0, correct 102/102
class 4: acc 0.9888888888888889, correct 89/90

Val Set, val_loss: 1.1054, val_error: 0.3600, auc: 0.8506
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.5555555555555556, correct 15/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0398, instance_loss: 0.2381, weighted_loss: 0.0993, label: 0, bag_size: 729
batch 39, loss: 0.0720, instance_loss: 0.2772, weighted_loss: 0.1335, label: 3, bag_size: 533
batch 59, loss: 0.2059, instance_loss: 0.3022, weighted_loss: 0.2348, label: 1, bag_size: 1651
batch 79, loss: 0.0075, instance_loss: 0.1146, weighted_loss: 0.0396, label: 3, bag_size: 1291
batch 99, loss: 0.3373, instance_loss: 0.7666, weighted_loss: 0.4661, label: 4, bag_size: 210
batch 119, loss: 0.1056, instance_loss: 0.0840, weighted_loss: 0.0991, label: 3, bag_size: 1177
batch 139, loss: 0.6066, instance_loss: 0.3330, weighted_loss: 0.5245, label: 2, bag_size: 777
batch 159, loss: 0.4435, instance_loss: 0.6036, weighted_loss: 0.4915, label: 1, bag_size: 1197
batch 179, loss: 0.0146, instance_loss: 0.2257, weighted_loss: 0.0779, label: 4, bag_size: 1002
batch 199, loss: 0.3103, instance_loss: 0.2910, weighted_loss: 0.3045, label: 2, bag_size: 1200
batch 219, loss: 0.0386, instance_loss: 0.3270, weighted_loss: 0.1251, label: 2, bag_size: 1047
batch 239, loss: 0.4157, instance_loss: 0.5141, weighted_loss: 0.4452, label: 3, bag_size: 283
batch 259, loss: 0.5025, instance_loss: 0.3751, weighted_loss: 0.4643, label: 0, bag_size: 424
batch 279, loss: 0.0146, instance_loss: 0.4894, weighted_loss: 0.1570, label: 3, bag_size: 305
batch 299, loss: 0.3585, instance_loss: 0.4562, weighted_loss: 0.3878, label: 2, bag_size: 861
batch 319, loss: 0.0146, instance_loss: 0.1097, weighted_loss: 0.0432, label: 0, bag_size: 729
batch 339, loss: 0.0109, instance_loss: 0.1285, weighted_loss: 0.0462, label: 4, bag_size: 764
batch 359, loss: 0.0299, instance_loss: 0.0709, weighted_loss: 0.0422, label: 3, bag_size: 729
batch 379, loss: 0.0044, instance_loss: 0.2726, weighted_loss: 0.0849, label: 3, bag_size: 936
batch 399, loss: 0.0536, instance_loss: 0.0936, weighted_loss: 0.0656, label: 0, bag_size: 340
batch 419, loss: 0.3819, instance_loss: 0.5536, weighted_loss: 0.4334, label: 2, bag_size: 730


class 0 clustering acc 0.989: correct 16813/17000
class 1 clustering acc 0.4641176470588235: correct 1578/3400
Epoch: 27, train_loss: 0.2489, train_clustering_loss:  0.2940, train_error: 0.0635
class 0: acc 0.9647058823529412, correct 82/85
class 1: acc 0.8588235294117647, correct 73/85
class 2: acc 0.8651685393258427, correct 77/89
class 3: acc 1.0, correct 86/86
class 4: acc 1.0, correct 80/80

Val Set, val_loss: 1.5639, val_error: 0.4800, auc: 0.8560
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.2962962962962963, correct 8/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0754, instance_loss: 0.1773, weighted_loss: 0.1060, label: 0, bag_size: 375
batch 39, loss: 0.0464, instance_loss: 0.3994, weighted_loss: 0.1523, label: 4, bag_size: 590
batch 59, loss: 0.0744, instance_loss: 0.2865, weighted_loss: 0.1380, label: 2, bag_size: 986
batch 79, loss: 0.1569, instance_loss: 0.2350, weighted_loss: 0.1804, label: 3, bag_size: 849
batch 99, loss: 0.0402, instance_loss: 0.1743, weighted_loss: 0.0805, label: 0, bag_size: 729
batch 119, loss: 0.1314, instance_loss: 0.1389, weighted_loss: 0.1337, label: 3, bag_size: 1177
batch 139, loss: 0.5210, instance_loss: 0.7729, weighted_loss: 0.5966, label: 1, bag_size: 1409
batch 159, loss: 0.2054, instance_loss: 0.8128, weighted_loss: 0.3876, label: 1, bag_size: 1409
batch 179, loss: 0.0289, instance_loss: 0.5124, weighted_loss: 0.1740, label: 3, bag_size: 1380
batch 199, loss: 0.0301, instance_loss: 0.0912, weighted_loss: 0.0484, label: 0, bag_size: 729
batch 219, loss: 0.3550, instance_loss: 0.4126, weighted_loss: 0.3723, label: 1, bag_size: 1096
batch 239, loss: 1.3536, instance_loss: 0.7818, weighted_loss: 1.1821, label: 0, bag_size: 282
batch 259, loss: 0.0151, instance_loss: 0.0793, weighted_loss: 0.0343, label: 0, bag_size: 933
batch 279, loss: 0.0320, instance_loss: 0.0872, weighted_loss: 0.0485, label: 3, bag_size: 1253
batch 299, loss: 0.1392, instance_loss: 0.2417, weighted_loss: 0.1700, label: 2, bag_size: 910
batch 319, loss: 0.1159, instance_loss: 0.4289, weighted_loss: 0.2098, label: 3, bag_size: 317
batch 339, loss: 0.0826, instance_loss: 0.2102, weighted_loss: 0.1208, label: 0, bag_size: 371
batch 359, loss: 0.0177, instance_loss: 0.1099, weighted_loss: 0.0453, label: 1, bag_size: 369
batch 379, loss: 0.1840, instance_loss: 0.4104, weighted_loss: 0.2519, label: 0, bag_size: 1065
batch 399, loss: 0.1769, instance_loss: 0.3766, weighted_loss: 0.2368, label: 0, bag_size: 759
batch 419, loss: 0.0028, instance_loss: 0.0614, weighted_loss: 0.0204, label: 3, bag_size: 729


class 0 clustering acc 0.9885882352941177: correct 16806/17000
class 1 clustering acc 0.45705882352941174: correct 1554/3400
Epoch: 28, train_loss: 0.2270, train_clustering_loss:  0.2905, train_error: 0.0729
class 0: acc 0.967391304347826, correct 89/92
class 1: acc 0.8658536585365854, correct 71/82
class 2: acc 0.8414634146341463, correct 69/82
class 3: acc 0.9876543209876543, correct 80/81
class 4: acc 0.9659090909090909, correct 85/88

Val Set, val_loss: 1.2196, val_error: 0.3400, auc: 0.8591
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.2675: correct 107/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5185185185185185, correct 14/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0320, instance_loss: 0.2469, weighted_loss: 0.0965, label: 3, bag_size: 360
batch 39, loss: 0.0127, instance_loss: 0.3291, weighted_loss: 0.1076, label: 4, bag_size: 1357
batch 59, loss: 0.0009, instance_loss: 0.3401, weighted_loss: 0.1026, label: 4, bag_size: 1235
batch 79, loss: 0.4613, instance_loss: 0.3590, weighted_loss: 0.4306, label: 1, bag_size: 399
batch 99, loss: 0.8031, instance_loss: 0.4237, weighted_loss: 0.6893, label: 2, bag_size: 373
batch 119, loss: 0.2701, instance_loss: 0.3552, weighted_loss: 0.2956, label: 0, bag_size: 759
batch 139, loss: 0.0136, instance_loss: 0.3713, weighted_loss: 0.1209, label: 1, bag_size: 700
batch 159, loss: 0.0819, instance_loss: 0.2018, weighted_loss: 0.1179, label: 1, bag_size: 697
batch 179, loss: 0.0021, instance_loss: 0.1613, weighted_loss: 0.0498, label: 4, bag_size: 1002
batch 199, loss: 0.2839, instance_loss: 0.4278, weighted_loss: 0.3271, label: 1, bag_size: 682
batch 219, loss: 0.0556, instance_loss: 0.3787, weighted_loss: 0.1525, label: 4, bag_size: 675
batch 239, loss: 0.0263, instance_loss: 0.0342, weighted_loss: 0.0287, label: 3, bag_size: 556
batch 259, loss: 0.4411, instance_loss: 0.3420, weighted_loss: 0.4114, label: 2, bag_size: 222
batch 279, loss: 2.9949, instance_loss: 0.7377, weighted_loss: 2.3177, label: 1, bag_size: 446
batch 299, loss: 0.0764, instance_loss: 0.2722, weighted_loss: 0.1351, label: 4, bag_size: 817
batch 319, loss: 0.1024, instance_loss: 0.3053, weighted_loss: 0.1633, label: 1, bag_size: 504
batch 339, loss: 0.0233, instance_loss: 0.2176, weighted_loss: 0.0816, label: 4, bag_size: 1278
batch 359, loss: 2.2477, instance_loss: 0.7630, weighted_loss: 1.8023, label: 1, bag_size: 308
batch 379, loss: 0.0005, instance_loss: 0.1407, weighted_loss: 0.0426, label: 4, bag_size: 823
batch 399, loss: 0.0773, instance_loss: 0.3228, weighted_loss: 0.1510, label: 2, bag_size: 2703
batch 419, loss: 0.2467, instance_loss: 0.5382, weighted_loss: 0.3342, label: 1, bag_size: 319


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.45: correct 1530/3400
Epoch: 29, train_loss: 0.2522, train_clustering_loss:  0.3046, train_error: 0.0847
class 0: acc 0.9230769230769231, correct 72/78
class 1: acc 0.8426966292134831, correct 75/89
class 2: acc 0.8214285714285714, correct 69/84
class 3: acc 1.0, correct 88/88
class 4: acc 0.9883720930232558, correct 85/86

Val Set, val_loss: 1.1359, val_error: 0.3800, auc: 0.8578
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.245: correct 98/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.48148148148148145, correct 13/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1348, instance_loss: 0.2057, weighted_loss: 0.1561, label: 1, bag_size: 903
batch 39, loss: 0.0258, instance_loss: 0.1883, weighted_loss: 0.0745, label: 1, bag_size: 504
batch 59, loss: 0.0055, instance_loss: 0.1015, weighted_loss: 0.0343, label: 1, bag_size: 834
batch 79, loss: 1.5788, instance_loss: 0.4617, weighted_loss: 1.2437, label: 1, bag_size: 1724
batch 99, loss: 1.0514, instance_loss: 0.5283, weighted_loss: 0.8945, label: 2, bag_size: 967
batch 119, loss: 0.0506, instance_loss: 0.1427, weighted_loss: 0.0782, label: 0, bag_size: 1255
batch 139, loss: 0.0012, instance_loss: 0.1974, weighted_loss: 0.0600, label: 3, bag_size: 791
batch 159, loss: 0.0001, instance_loss: 0.2557, weighted_loss: 0.0768, label: 4, bag_size: 729
batch 179, loss: 0.1691, instance_loss: 0.3790, weighted_loss: 0.2321, label: 2, bag_size: 461
batch 199, loss: 0.0662, instance_loss: 0.4238, weighted_loss: 0.1735, label: 2, bag_size: 1024
batch 219, loss: 0.2156, instance_loss: 0.3909, weighted_loss: 0.2682, label: 2, bag_size: 373
batch 239, loss: 0.0114, instance_loss: 0.2071, weighted_loss: 0.0701, label: 3, bag_size: 821
batch 259, loss: 0.0060, instance_loss: 0.0518, weighted_loss: 0.0197, label: 0, bag_size: 1466
batch 279, loss: 0.0318, instance_loss: 0.1331, weighted_loss: 0.0622, label: 0, bag_size: 616
batch 299, loss: 0.0033, instance_loss: 0.3917, weighted_loss: 0.1198, label: 4, bag_size: 974
batch 319, loss: 1.4654, instance_loss: 0.5953, weighted_loss: 1.2043, label: 2, bag_size: 1231
batch 339, loss: 0.0005, instance_loss: 0.0531, weighted_loss: 0.0162, label: 4, bag_size: 729
batch 359, loss: 0.0322, instance_loss: 0.1364, weighted_loss: 0.0634, label: 1, bag_size: 994
batch 379, loss: 0.2283, instance_loss: 0.5093, weighted_loss: 0.3126, label: 4, bag_size: 436
batch 399, loss: 0.1954, instance_loss: 0.2903, weighted_loss: 0.2239, label: 2, bag_size: 1242
batch 419, loss: 0.0090, instance_loss: 0.2418, weighted_loss: 0.0789, label: 1, bag_size: 318


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.41558823529411765: correct 1413/3400
Epoch: 30, train_loss: 0.3165, train_clustering_loss:  0.3114, train_error: 0.1388
class 0: acc 0.8604651162790697, correct 74/86
class 1: acc 0.7857142857142857, correct 77/98
class 2: acc 0.7619047619047619, correct 64/84
class 3: acc 0.9647058823529412, correct 82/85
class 4: acc 0.9583333333333334, correct 69/72

Val Set, val_loss: 1.1589, val_error: 0.3200, auc: 0.8149
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5925925925925926, correct 16/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0067, instance_loss: 0.0546, weighted_loss: 0.0211, label: 0, bag_size: 729
batch 39, loss: 0.3977, instance_loss: 0.3583, weighted_loss: 0.3859, label: 3, bag_size: 849
batch 59, loss: 0.0007, instance_loss: 0.1774, weighted_loss: 0.0537, label: 4, bag_size: 729
batch 79, loss: 0.1153, instance_loss: 0.2849, weighted_loss: 0.1662, label: 2, bag_size: 1039
batch 99, loss: 0.0449, instance_loss: 0.1132, weighted_loss: 0.0654, label: 0, bag_size: 410
batch 119, loss: 0.0001, instance_loss: 0.1481, weighted_loss: 0.0445, label: 4, bag_size: 1235
batch 139, loss: 0.0447, instance_loss: 0.5725, weighted_loss: 0.2031, label: 3, bag_size: 305
batch 159, loss: 1.4304, instance_loss: 0.6070, weighted_loss: 1.1834, label: 2, bag_size: 3236
batch 179, loss: 1.3514, instance_loss: 0.9054, weighted_loss: 1.2176, label: 2, bag_size: 319
batch 199, loss: 1.4759, instance_loss: 0.5909, weighted_loss: 1.2104, label: 2, bag_size: 373
batch 219, loss: 0.0047, instance_loss: 0.0829, weighted_loss: 0.0282, label: 3, bag_size: 729
batch 239, loss: 0.0237, instance_loss: 0.4338, weighted_loss: 0.1467, label: 3, bag_size: 706
batch 259, loss: 0.2257, instance_loss: 0.3056, weighted_loss: 0.2497, label: 1, bag_size: 1651
batch 279, loss: 0.0895, instance_loss: 0.0949, weighted_loss: 0.0911, label: 3, bag_size: 821
batch 299, loss: 0.0813, instance_loss: 0.1874, weighted_loss: 0.1131, label: 0, bag_size: 350
batch 319, loss: 0.2809, instance_loss: 0.4537, weighted_loss: 0.3327, label: 2, bag_size: 307
batch 339, loss: 0.2527, instance_loss: 0.5318, weighted_loss: 0.3364, label: 2, bag_size: 248
batch 359, loss: 0.0255, instance_loss: 0.2040, weighted_loss: 0.0791, label: 0, bag_size: 338
batch 379, loss: 0.3243, instance_loss: 0.3248, weighted_loss: 0.3245, label: 2, bag_size: 395
batch 399, loss: 0.0001, instance_loss: 0.1047, weighted_loss: 0.0315, label: 4, bag_size: 823
batch 419, loss: 0.0011, instance_loss: 0.0769, weighted_loss: 0.0238, label: 3, bag_size: 791


class 0 clustering acc 0.9879411764705882: correct 16795/17000
class 1 clustering acc 0.4320588235294118: correct 1469/3400
Epoch: 31, train_loss: 0.2401, train_clustering_loss:  0.3032, train_error: 0.0753
class 0: acc 0.9404761904761905, correct 79/84
class 1: acc 0.8837209302325582, correct 76/86
class 2: acc 0.8372093023255814, correct 72/86
class 3: acc 1.0, correct 81/81
class 4: acc 0.9659090909090909, correct 85/88

Val Set, val_loss: 1.1793, val_error: 0.4000, auc: 0.8410
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.4, correct 2/5
class 2: acc 0.5185185185185185, correct 14/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1534, instance_loss: 0.3281, weighted_loss: 0.2058, label: 0, bag_size: 868
batch 39, loss: 1.0988, instance_loss: 0.5359, weighted_loss: 0.9299, label: 1, bag_size: 1144
batch 59, loss: 0.0151, instance_loss: 0.5190, weighted_loss: 0.1663, label: 3, bag_size: 1380
batch 79, loss: 0.0002, instance_loss: 0.1639, weighted_loss: 0.0493, label: 4, bag_size: 729
batch 99, loss: 0.0184, instance_loss: 0.1072, weighted_loss: 0.0450, label: 3, bag_size: 316
batch 119, loss: 0.1502, instance_loss: 0.2498, weighted_loss: 0.1801, label: 1, bag_size: 682
batch 139, loss: 0.0269, instance_loss: 0.1765, weighted_loss: 0.0718, label: 0, bag_size: 729
batch 159, loss: 0.0009, instance_loss: 0.0503, weighted_loss: 0.0157, label: 3, bag_size: 729
batch 179, loss: 0.0298, instance_loss: 0.2844, weighted_loss: 0.1062, label: 2, bag_size: 863
batch 199, loss: 0.0406, instance_loss: 0.4221, weighted_loss: 0.1550, label: 4, bag_size: 590
batch 219, loss: 0.0079, instance_loss: 0.5113, weighted_loss: 0.1589, label: 1, bag_size: 700
batch 239, loss: 1.0139, instance_loss: 0.5525, weighted_loss: 0.8755, label: 1, bag_size: 470
batch 259, loss: 0.6923, instance_loss: 0.4719, weighted_loss: 0.6262, label: 2, bag_size: 1006
batch 279, loss: 0.0259, instance_loss: 0.1565, weighted_loss: 0.0651, label: 0, bag_size: 1018
batch 299, loss: 0.2057, instance_loss: 0.2672, weighted_loss: 0.2242, label: 0, bag_size: 542
batch 319, loss: 0.0014, instance_loss: 0.1944, weighted_loss: 0.0593, label: 4, bag_size: 823
batch 339, loss: 0.0544, instance_loss: 0.1655, weighted_loss: 0.0877, label: 0, bag_size: 338
batch 359, loss: 0.0319, instance_loss: 0.3793, weighted_loss: 0.1361, label: 1, bag_size: 474
batch 379, loss: 0.0011, instance_loss: 0.2050, weighted_loss: 0.0623, label: 4, bag_size: 656
batch 399, loss: 0.0099, instance_loss: 0.5094, weighted_loss: 0.1597, label: 4, bag_size: 974
batch 419, loss: 0.0015, instance_loss: 0.5752, weighted_loss: 0.1736, label: 4, bag_size: 882


class 0 clustering acc 0.9868235294117647: correct 16776/17000
class 1 clustering acc 0.4547058823529412: correct 1546/3400
Epoch: 32, train_loss: 0.2235, train_clustering_loss:  0.2986, train_error: 0.0682
class 0: acc 0.967391304347826, correct 89/92
class 1: acc 0.8125, correct 65/80
class 2: acc 0.9069767441860465, correct 78/86
class 3: acc 0.975609756097561, correct 80/82
class 4: acc 0.9882352941176471, correct 84/85

Val Set, val_loss: 1.2402, val_error: 0.3800, auc: 0.8320
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.2775: correct 111/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.48148148148148145, correct 13/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0090, instance_loss: 0.1780, weighted_loss: 0.0597, label: 1, bag_size: 847
batch 39, loss: 0.0875, instance_loss: 0.2013, weighted_loss: 0.1216, label: 2, bag_size: 1569
batch 59, loss: 0.0906, instance_loss: 0.1842, weighted_loss: 0.1187, label: 2, bag_size: 614
batch 79, loss: 0.2024, instance_loss: 0.4389, weighted_loss: 0.2734, label: 3, bag_size: 283
batch 99, loss: 0.0021, instance_loss: 0.0662, weighted_loss: 0.0214, label: 4, bag_size: 764
batch 119, loss: 0.1650, instance_loss: 0.4245, weighted_loss: 0.2428, label: 0, bag_size: 759
batch 139, loss: 0.7298, instance_loss: 0.4952, weighted_loss: 0.6594, label: 1, bag_size: 861
batch 159, loss: 0.6473, instance_loss: 0.4703, weighted_loss: 0.5942, label: 0, bag_size: 1257
batch 179, loss: 0.0122, instance_loss: 0.0985, weighted_loss: 0.0381, label: 0, bag_size: 1046
batch 199, loss: 0.1934, instance_loss: 0.4175, weighted_loss: 0.2606, label: 2, bag_size: 932
batch 219, loss: 0.0702, instance_loss: 0.3141, weighted_loss: 0.1434, label: 0, bag_size: 1332
batch 239, loss: 0.1521, instance_loss: 0.2697, weighted_loss: 0.1874, label: 2, bag_size: 461
batch 259, loss: 0.0506, instance_loss: 0.3273, weighted_loss: 0.1336, label: 1, bag_size: 598
batch 279, loss: 0.9162, instance_loss: 0.5335, weighted_loss: 0.8014, label: 2, bag_size: 355
batch 299, loss: 0.0001, instance_loss: 0.0702, weighted_loss: 0.0211, label: 4, bag_size: 729
batch 319, loss: 0.3080, instance_loss: 0.7426, weighted_loss: 0.4384, label: 1, bag_size: 651
batch 339, loss: 0.0044, instance_loss: 0.0470, weighted_loss: 0.0171, label: 0, bag_size: 729
batch 359, loss: 0.0135, instance_loss: 0.0534, weighted_loss: 0.0255, label: 0, bag_size: 1190
batch 379, loss: 0.0051, instance_loss: 0.3654, weighted_loss: 0.1132, label: 4, bag_size: 524
batch 399, loss: 0.0216, instance_loss: 0.0986, weighted_loss: 0.0447, label: 0, bag_size: 476
batch 419, loss: 0.0671, instance_loss: 0.4771, weighted_loss: 0.1901, label: 4, bag_size: 366


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.4879411764705882: correct 1659/3400
Epoch: 33, train_loss: 0.1731, train_clustering_loss:  0.2816, train_error: 0.0518
class 0: acc 0.967741935483871, correct 90/93
class 1: acc 0.8857142857142857, correct 62/70
class 2: acc 0.863013698630137, correct 63/73
class 3: acc 0.9882352941176471, correct 84/85
class 4: acc 1.0, correct 104/104

Val Set, val_loss: 1.4692, val_error: 0.4000, auc: 0.8379
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4074074074074074, correct 11/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0309, instance_loss: 0.0437, weighted_loss: 0.0347, label: 3, bag_size: 729
batch 39, loss: 0.3271, instance_loss: 0.4326, weighted_loss: 0.3587, label: 1, bag_size: 343
batch 59, loss: 0.1658, instance_loss: 0.5802, weighted_loss: 0.2902, label: 2, bag_size: 323
batch 79, loss: 0.1524, instance_loss: 0.4202, weighted_loss: 0.2327, label: 4, bag_size: 436
batch 99, loss: 0.6971, instance_loss: 0.5807, weighted_loss: 0.6622, label: 3, bag_size: 283
batch 119, loss: 0.0003, instance_loss: 0.1883, weighted_loss: 0.0567, label: 4, bag_size: 711
batch 139, loss: 0.0867, instance_loss: 0.4760, weighted_loss: 0.2035, label: 3, bag_size: 305
batch 159, loss: 0.0459, instance_loss: 0.3479, weighted_loss: 0.1365, label: 1, bag_size: 887
batch 179, loss: 0.0030, instance_loss: 0.0587, weighted_loss: 0.0197, label: 3, bag_size: 729
batch 199, loss: 0.0779, instance_loss: 0.2857, weighted_loss: 0.1403, label: 1, bag_size: 838
batch 219, loss: 0.0731, instance_loss: 0.2002, weighted_loss: 0.1112, label: 0, bag_size: 1034
batch 239, loss: 0.4650, instance_loss: 0.7690, weighted_loss: 0.5562, label: 4, bag_size: 210
batch 259, loss: 0.0317, instance_loss: 0.5950, weighted_loss: 0.2007, label: 1, bag_size: 1255
batch 279, loss: 0.1849, instance_loss: 0.3411, weighted_loss: 0.2318, label: 0, bag_size: 756
batch 299, loss: 0.2802, instance_loss: 0.2942, weighted_loss: 0.2844, label: 2, bag_size: 1385
batch 319, loss: 0.0063, instance_loss: 0.1751, weighted_loss: 0.0570, label: 4, bag_size: 1474
batch 339, loss: 0.0156, instance_loss: 0.0776, weighted_loss: 0.0342, label: 0, bag_size: 729
batch 359, loss: 0.0920, instance_loss: 0.3591, weighted_loss: 0.1721, label: 3, bag_size: 360
batch 379, loss: 0.0367, instance_loss: 0.3263, weighted_loss: 0.1236, label: 4, bag_size: 663
batch 399, loss: 0.0106, instance_loss: 0.1284, weighted_loss: 0.0459, label: 0, bag_size: 729
batch 419, loss: 0.0047, instance_loss: 0.0407, weighted_loss: 0.0155, label: 3, bag_size: 729


class 0 clustering acc 0.9877058823529412: correct 16791/17000
class 1 clustering acc 0.4588235294117647: correct 1560/3400
Epoch: 34, train_loss: 0.2337, train_clustering_loss:  0.2973, train_error: 0.0871
class 0: acc 0.946236559139785, correct 88/93
class 1: acc 0.8539325842696629, correct 76/89
class 2: acc 0.7954545454545454, correct 70/88
class 3: acc 0.9873417721518988, correct 78/79
class 4: acc 1.0, correct 76/76

Val Set, val_loss: 1.3307, val_error: 0.3800, auc: 0.8115
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.2275: correct 91/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5185185185185185, correct 14/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0048, instance_loss: 0.0395, weighted_loss: 0.0152, label: 3, bag_size: 729
batch 39, loss: 0.0037, instance_loss: 0.0325, weighted_loss: 0.0123, label: 3, bag_size: 729
batch 59, loss: 0.0323, instance_loss: 0.5707, weighted_loss: 0.1938, label: 4, bag_size: 542
batch 79, loss: 0.0039, instance_loss: 0.0274, weighted_loss: 0.0109, label: 3, bag_size: 729
batch 99, loss: 0.0352, instance_loss: 0.1002, weighted_loss: 0.0547, label: 4, bag_size: 625
batch 119, loss: 1.3388, instance_loss: 0.5670, weighted_loss: 1.1073, label: 1, bag_size: 1799
batch 139, loss: 0.4061, instance_loss: 0.3231, weighted_loss: 0.3812, label: 4, bag_size: 928
batch 159, loss: 0.3972, instance_loss: 0.3924, weighted_loss: 0.3957, label: 2, bag_size: 395
batch 179, loss: 0.1250, instance_loss: 0.5721, weighted_loss: 0.2591, label: 3, bag_size: 281
batch 199, loss: 0.0017, instance_loss: 0.9425, weighted_loss: 0.2839, label: 4, bag_size: 711
batch 219, loss: 0.0000, instance_loss: 0.2266, weighted_loss: 0.0680, label: 4, bag_size: 729
batch 239, loss: 0.4742, instance_loss: 0.2552, weighted_loss: 0.4085, label: 2, bag_size: 1289
batch 259, loss: 0.0470, instance_loss: 0.6029, weighted_loss: 0.2138, label: 1, bag_size: 1390
batch 279, loss: 0.4747, instance_loss: 0.3116, weighted_loss: 0.4258, label: 2, bag_size: 806
batch 299, loss: 0.0154, instance_loss: 0.0544, weighted_loss: 0.0271, label: 3, bag_size: 729
batch 319, loss: 0.0002, instance_loss: 0.0552, weighted_loss: 0.0167, label: 4, bag_size: 729
batch 339, loss: 0.0373, instance_loss: 0.3544, weighted_loss: 0.1324, label: 1, bag_size: 1651
batch 359, loss: 0.0015, instance_loss: 0.2794, weighted_loss: 0.0849, label: 4, bag_size: 524
batch 379, loss: 0.0011, instance_loss: 0.0260, weighted_loss: 0.0086, label: 3, bag_size: 1172
batch 399, loss: 0.0067, instance_loss: 0.3515, weighted_loss: 0.1102, label: 3, bag_size: 305
batch 419, loss: 0.0658, instance_loss: 0.2804, weighted_loss: 0.1301, label: 2, bag_size: 469


class 0 clustering acc 0.9869411764705882: correct 16778/17000
class 1 clustering acc 0.46441176470588236: correct 1579/3400
Epoch: 35, train_loss: 0.1977, train_clustering_loss:  0.3014, train_error: 0.0659
class 0: acc 0.9076923076923077, correct 59/65
class 1: acc 0.8390804597701149, correct 73/87
class 2: acc 0.9078947368421053, correct 69/76
class 3: acc 1.0, correct 93/93
class 4: acc 0.9903846153846154, correct 103/104

Val Set, val_loss: 1.4950, val_error: 0.4000, auc: 0.8476
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.2875: correct 115/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4074074074074074, correct 11/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2260, instance_loss: 0.4621, weighted_loss: 0.2969, label: 1, bag_size: 868
batch 39, loss: 0.1437, instance_loss: 0.5868, weighted_loss: 0.2766, label: 1, bag_size: 487
batch 59, loss: 0.0337, instance_loss: 0.3376, weighted_loss: 0.1249, label: 1, bag_size: 1724
batch 79, loss: 0.0133, instance_loss: 0.1184, weighted_loss: 0.0448, label: 0, bag_size: 731
batch 99, loss: 0.1813, instance_loss: 0.3719, weighted_loss: 0.2385, label: 1, bag_size: 1080
batch 119, loss: 0.1536, instance_loss: 0.3712, weighted_loss: 0.2189, label: 2, bag_size: 1164
batch 139, loss: 0.1383, instance_loss: 0.3563, weighted_loss: 0.2037, label: 2, bag_size: 1133
batch 159, loss: 0.0351, instance_loss: 0.2877, weighted_loss: 0.1109, label: 1, bag_size: 697
batch 179, loss: 0.0204, instance_loss: 0.1106, weighted_loss: 0.0474, label: 4, bag_size: 1002
batch 199, loss: 0.0008, instance_loss: 0.3028, weighted_loss: 0.0914, label: 4, bag_size: 524
batch 219, loss: 0.0069, instance_loss: 0.1069, weighted_loss: 0.0369, label: 3, bag_size: 316
batch 239, loss: 0.3408, instance_loss: 0.5085, weighted_loss: 0.3911, label: 2, bag_size: 1150
batch 259, loss: 0.0035, instance_loss: 0.0743, weighted_loss: 0.0247, label: 1, bag_size: 1277
batch 279, loss: 0.0602, instance_loss: 0.1217, weighted_loss: 0.0786, label: 1, bag_size: 1191
batch 299, loss: 0.0098, instance_loss: 0.0610, weighted_loss: 0.0251, label: 0, bag_size: 731
batch 319, loss: 0.0023, instance_loss: 0.0443, weighted_loss: 0.0149, label: 1, bag_size: 1277
batch 339, loss: 0.1755, instance_loss: 0.3717, weighted_loss: 0.2344, label: 2, bag_size: 910
batch 359, loss: 0.1417, instance_loss: 0.6658, weighted_loss: 0.2989, label: 2, bag_size: 323
batch 379, loss: 0.0049, instance_loss: 0.0365, weighted_loss: 0.0144, label: 1, bag_size: 1277
batch 399, loss: 0.0013, instance_loss: 0.3185, weighted_loss: 0.0964, label: 4, bag_size: 729
batch 419, loss: 0.1111, instance_loss: 0.4201, weighted_loss: 0.2038, label: 1, bag_size: 754


class 0 clustering acc 0.9869411764705882: correct 16778/17000
class 1 clustering acc 0.4585294117647059: correct 1559/3400
Epoch: 36, train_loss: 0.1990, train_clustering_loss:  0.3016, train_error: 0.0729
class 0: acc 0.9367088607594937, correct 74/79
class 1: acc 0.8214285714285714, correct 69/84
class 2: acc 0.8765432098765432, correct 71/81
class 3: acc 1.0, correct 92/92
class 4: acc 0.9887640449438202, correct 88/89

Val Set, val_loss: 1.5821, val_error: 0.4400, auc: 0.8658
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.2775: correct 111/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.37037037037037035, correct 10/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1397, instance_loss: 0.2839, weighted_loss: 0.1830, label: 1, bag_size: 1651
batch 39, loss: 0.0587, instance_loss: 0.2477, weighted_loss: 0.1154, label: 1, bag_size: 1651
batch 59, loss: 0.1118, instance_loss: 0.4052, weighted_loss: 0.1998, label: 2, bag_size: 1148
batch 79, loss: 0.0622, instance_loss: 0.2919, weighted_loss: 0.1311, label: 2, bag_size: 262
batch 99, loss: 0.5431, instance_loss: 0.4301, weighted_loss: 0.5092, label: 2, bag_size: 1148
batch 119, loss: 0.0030, instance_loss: 0.0586, weighted_loss: 0.0197, label: 3, bag_size: 729
batch 139, loss: 0.1031, instance_loss: 0.0701, weighted_loss: 0.0932, label: 3, bag_size: 1177
batch 159, loss: 0.6915, instance_loss: 0.3576, weighted_loss: 0.5914, label: 2, bag_size: 355
batch 179, loss: 0.0037, instance_loss: 0.0727, weighted_loss: 0.0244, label: 3, bag_size: 729
batch 199, loss: 0.0902, instance_loss: 0.4710, weighted_loss: 0.2044, label: 4, bag_size: 675
batch 219, loss: 0.0425, instance_loss: 0.1979, weighted_loss: 0.0891, label: 1, bag_size: 504
batch 239, loss: 0.0723, instance_loss: 0.0747, weighted_loss: 0.0730, label: 3, bag_size: 556
batch 259, loss: 0.0207, instance_loss: 0.0797, weighted_loss: 0.0384, label: 0, bag_size: 616
batch 279, loss: 0.0372, instance_loss: 0.5205, weighted_loss: 0.1822, label: 4, bag_size: 663
batch 299, loss: 0.1627, instance_loss: 0.5935, weighted_loss: 0.2920, label: 2, bag_size: 1069
batch 319, loss: 0.0163, instance_loss: 0.2248, weighted_loss: 0.0789, label: 1, bag_size: 847
batch 339, loss: 0.0293, instance_loss: 0.3323, weighted_loss: 0.1202, label: 0, bag_size: 729
batch 359, loss: 0.0748, instance_loss: 0.4444, weighted_loss: 0.1857, label: 2, bag_size: 248
batch 379, loss: 0.1051, instance_loss: 0.3817, weighted_loss: 0.1881, label: 2, bag_size: 725
batch 399, loss: 0.0245, instance_loss: 0.2416, weighted_loss: 0.0897, label: 4, bag_size: 533
batch 419, loss: 2.1967, instance_loss: 0.6579, weighted_loss: 1.7351, label: 1, bag_size: 446


class 0 clustering acc 0.9882941176470589: correct 16801/17000
class 1 clustering acc 0.4476470588235294: correct 1522/3400
Epoch: 37, train_loss: 0.2137, train_clustering_loss:  0.3071, train_error: 0.0635
class 0: acc 0.9722222222222222, correct 70/72
class 1: acc 0.8541666666666666, correct 82/96
class 2: acc 0.90625, correct 87/96
class 3: acc 0.9875, correct 79/80
class 4: acc 0.9876543209876543, correct 80/81

Val Set, val_loss: 1.2612, val_error: 0.3800, auc: 0.8507
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.2275: correct 91/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.48148148148148145, correct 13/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0057, instance_loss: 0.2268, weighted_loss: 0.0720, label: 1, bag_size: 890
batch 39, loss: 0.0066, instance_loss: 0.1843, weighted_loss: 0.0599, label: 4, bag_size: 1474
batch 59, loss: 0.1139, instance_loss: 0.2696, weighted_loss: 0.1606, label: 2, bag_size: 1133
batch 79, loss: 0.0036, instance_loss: 0.0398, weighted_loss: 0.0144, label: 3, bag_size: 729
batch 99, loss: 0.0924, instance_loss: 0.2484, weighted_loss: 0.1392, label: 2, bag_size: 1123
batch 119, loss: 0.0153, instance_loss: 0.1786, weighted_loss: 0.0643, label: 2, bag_size: 1289
batch 139, loss: 0.1222, instance_loss: 0.3129, weighted_loss: 0.1794, label: 0, bag_size: 200
batch 159, loss: 0.0006, instance_loss: 0.1004, weighted_loss: 0.0305, label: 3, bag_size: 729
batch 179, loss: 0.0639, instance_loss: 0.2052, weighted_loss: 0.1063, label: 2, bag_size: 1289
batch 199, loss: 0.1512, instance_loss: 0.4743, weighted_loss: 0.2481, label: 0, bag_size: 1065
batch 219, loss: 0.0125, instance_loss: 0.1448, weighted_loss: 0.0522, label: 1, bag_size: 405
batch 239, loss: 0.2426, instance_loss: 0.6816, weighted_loss: 0.3743, label: 3, bag_size: 281
batch 259, loss: 0.2601, instance_loss: 0.6040, weighted_loss: 0.3633, label: 1, bag_size: 1273
batch 279, loss: 0.0005, instance_loss: 0.1184, weighted_loss: 0.0359, label: 4, bag_size: 729
batch 299, loss: 0.3009, instance_loss: 0.5008, weighted_loss: 0.3609, label: 1, bag_size: 968
batch 319, loss: 0.0494, instance_loss: 0.4121, weighted_loss: 0.1582, label: 3, bag_size: 706
batch 339, loss: 0.0431, instance_loss: 0.3067, weighted_loss: 0.1221, label: 2, bag_size: 373
batch 359, loss: 0.0867, instance_loss: 0.3119, weighted_loss: 0.1543, label: 0, bag_size: 1332
batch 379, loss: 0.0339, instance_loss: 0.2528, weighted_loss: 0.0996, label: 1, bag_size: 369
batch 399, loss: 0.0330, instance_loss: 0.1040, weighted_loss: 0.0543, label: 3, bag_size: 316
batch 419, loss: 0.8557, instance_loss: 0.3630, weighted_loss: 0.7079, label: 4, bag_size: 1337


class 0 clustering acc 0.9897058823529412: correct 16825/17000
class 1 clustering acc 0.4773529411764706: correct 1623/3400
Epoch: 38, train_loss: 0.1836, train_clustering_loss:  0.2827, train_error: 0.0541
class 0: acc 0.975609756097561, correct 80/82
class 1: acc 0.8518518518518519, correct 69/81
class 2: acc 0.891566265060241, correct 74/83
class 3: acc 1.0, correct 78/78
class 4: acc 1.0, correct 101/101

Val Set, val_loss: 1.3523, val_error: 0.4000, auc: 0.8552
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5185185185185185, correct 14/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0110, instance_loss: 0.0228, weighted_loss: 0.0145, label: 3, bag_size: 556
batch 39, loss: 0.0986, instance_loss: 0.3217, weighted_loss: 0.1656, label: 1, bag_size: 1080
batch 59, loss: 0.0466, instance_loss: 0.2035, weighted_loss: 0.0937, label: 0, bag_size: 375
batch 79, loss: 0.2411, instance_loss: 0.3315, weighted_loss: 0.2682, label: 0, bag_size: 990
batch 99, loss: 0.3965, instance_loss: 0.3936, weighted_loss: 0.3956, label: 0, bag_size: 437
batch 119, loss: 0.1099, instance_loss: 0.2449, weighted_loss: 0.1504, label: 0, bag_size: 423
batch 139, loss: 0.0067, instance_loss: 0.0350, weighted_loss: 0.0152, label: 0, bag_size: 360
batch 159, loss: 0.0095, instance_loss: 0.0750, weighted_loss: 0.0292, label: 0, bag_size: 607
batch 179, loss: 0.0067, instance_loss: 0.4636, weighted_loss: 0.1438, label: 3, bag_size: 706
batch 199, loss: 0.0018, instance_loss: 0.5625, weighted_loss: 0.1700, label: 3, bag_size: 1167
batch 219, loss: 0.0233, instance_loss: 0.2568, weighted_loss: 0.0933, label: 1, bag_size: 754
batch 239, loss: 0.0020, instance_loss: 0.0796, weighted_loss: 0.0253, label: 3, bag_size: 729
batch 259, loss: 0.0015, instance_loss: 0.0567, weighted_loss: 0.0181, label: 3, bag_size: 729
batch 279, loss: 0.3041, instance_loss: 0.2865, weighted_loss: 0.2988, label: 1, bag_size: 1049
batch 299, loss: 0.0416, instance_loss: 0.1567, weighted_loss: 0.0761, label: 0, bag_size: 1579
batch 319, loss: 0.0003, instance_loss: 0.0333, weighted_loss: 0.0102, label: 4, bag_size: 729
batch 339, loss: 0.0054, instance_loss: 0.1013, weighted_loss: 0.0342, label: 3, bag_size: 316
batch 359, loss: 0.0246, instance_loss: 0.3366, weighted_loss: 0.1182, label: 3, bag_size: 1380
batch 379, loss: 0.0175, instance_loss: 0.0731, weighted_loss: 0.0342, label: 3, bag_size: 1019
batch 399, loss: 0.0283, instance_loss: 0.0771, weighted_loss: 0.0429, label: 1, bag_size: 286
batch 419, loss: 0.0074, instance_loss: 0.0262, weighted_loss: 0.0130, label: 3, bag_size: 1291


class 0 clustering acc 0.9886470588235294: correct 16807/17000
class 1 clustering acc 0.5102941176470588: correct 1735/3400
Epoch: 39, train_loss: 0.1367, train_clustering_loss:  0.2785, train_error: 0.0447
class 0: acc 0.9801980198019802, correct 99/101
class 1: acc 0.9, correct 72/80
class 2: acc 0.875, correct 63/72
class 3: acc 1.0, correct 87/87
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.4335, val_error: 0.3800, auc: 0.8729
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.4444444444444444, correct 12/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0702, instance_loss: 0.0942, weighted_loss: 0.0774, label: 3, bag_size: 1019
batch 39, loss: 0.3152, instance_loss: 0.7057, weighted_loss: 0.4323, label: 2, bag_size: 911
batch 59, loss: 0.0177, instance_loss: 0.3127, weighted_loss: 0.1062, label: 2, bag_size: 358
batch 79, loss: 0.7922, instance_loss: 0.3696, weighted_loss: 0.6654, label: 2, bag_size: 774
batch 99, loss: 0.0076, instance_loss: 0.0518, weighted_loss: 0.0208, label: 3, bag_size: 729
batch 119, loss: 0.8832, instance_loss: 0.5818, weighted_loss: 0.7928, label: 1, bag_size: 308
batch 139, loss: 0.0016, instance_loss: 0.0392, weighted_loss: 0.0129, label: 3, bag_size: 729
batch 159, loss: 0.2072, instance_loss: 0.4397, weighted_loss: 0.2769, label: 1, bag_size: 319
batch 179, loss: 0.0474, instance_loss: 0.1570, weighted_loss: 0.0803, label: 0, bag_size: 1517
batch 199, loss: 0.6705, instance_loss: 0.4167, weighted_loss: 0.5943, label: 1, bag_size: 377
batch 219, loss: 0.0086, instance_loss: 0.1023, weighted_loss: 0.0367, label: 0, bag_size: 239
batch 239, loss: 0.0068, instance_loss: 0.3794, weighted_loss: 0.1186, label: 3, bag_size: 1380
batch 259, loss: 0.0087, instance_loss: 0.0627, weighted_loss: 0.0249, label: 0, bag_size: 729
batch 279, loss: 0.3639, instance_loss: 0.6601, weighted_loss: 0.4528, label: 1, bag_size: 648
batch 299, loss: 0.0086, instance_loss: 0.3097, weighted_loss: 0.0989, label: 4, bag_size: 590
batch 319, loss: 0.1462, instance_loss: 0.2961, weighted_loss: 0.1912, label: 3, bag_size: 1118
batch 339, loss: 0.0457, instance_loss: 0.1739, weighted_loss: 0.0842, label: 2, bag_size: 400
batch 359, loss: 0.0080, instance_loss: 0.0698, weighted_loss: 0.0266, label: 0, bag_size: 1196
batch 379, loss: 0.0000, instance_loss: 0.3840, weighted_loss: 0.1152, label: 4, bag_size: 729
batch 399, loss: 1.2301, instance_loss: 0.6225, weighted_loss: 1.0478, label: 1, bag_size: 487
batch 419, loss: 0.1831, instance_loss: 0.2909, weighted_loss: 0.2154, label: 0, bag_size: 545


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.47852941176470587: correct 1627/3400
Epoch: 40, train_loss: 0.2118, train_clustering_loss:  0.2826, train_error: 0.0776
class 0: acc 0.9772727272727273, correct 86/88
class 1: acc 0.8313253012048193, correct 69/83
class 2: acc 0.8048780487804879, correct 66/82
class 3: acc 1.0, correct 93/93
class 4: acc 0.9873417721518988, correct 78/79

Val Set, val_loss: 1.2962, val_error: 0.3600, auc: 0.8551
class 0 clustering acc 0.969: correct 1938/2000
class 1 clustering acc 0.2675: correct 107/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.5185185185185185, correct 14/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.2699, instance_loss: 0.5027, weighted_loss: 0.3398, label: 1, bag_size: 1144
batch 39, loss: 0.1058, instance_loss: 0.2661, weighted_loss: 0.1539, label: 2, bag_size: 1123
batch 59, loss: 0.0030, instance_loss: 0.1551, weighted_loss: 0.0486, label: 3, bag_size: 343
batch 79, loss: 0.1008, instance_loss: 0.2866, weighted_loss: 0.1566, label: 0, bag_size: 413
batch 99, loss: 0.1186, instance_loss: 0.0614, weighted_loss: 0.1014, label: 3, bag_size: 1177
batch 119, loss: 1.2323, instance_loss: 0.5661, weighted_loss: 1.0325, label: 1, bag_size: 535
batch 139, loss: 0.0008, instance_loss: 0.0891, weighted_loss: 0.0273, label: 3, bag_size: 729
batch 159, loss: 0.0005, instance_loss: 0.5108, weighted_loss: 0.1536, label: 4, bag_size: 974
batch 179, loss: 0.0328, instance_loss: 0.1477, weighted_loss: 0.0673, label: 3, bag_size: 533
batch 199, loss: 1.3287, instance_loss: 0.5532, weighted_loss: 1.0960, label: 1, bag_size: 308
batch 219, loss: 0.0148, instance_loss: 0.0855, weighted_loss: 0.0360, label: 0, bag_size: 1174
batch 239, loss: 0.0007, instance_loss: 0.1768, weighted_loss: 0.0535, label: 4, bag_size: 823
batch 259, loss: 0.0138, instance_loss: 0.1970, weighted_loss: 0.0687, label: 1, bag_size: 858
batch 279, loss: 0.1095, instance_loss: 0.2939, weighted_loss: 0.1648, label: 0, bag_size: 759
batch 299, loss: 0.0527, instance_loss: 0.4590, weighted_loss: 0.1746, label: 4, bag_size: 675
batch 319, loss: 0.0927, instance_loss: 0.3454, weighted_loss: 0.1685, label: 1, bag_size: 846
batch 339, loss: 0.0753, instance_loss: 0.1712, weighted_loss: 0.1041, label: 0, bag_size: 200
batch 359, loss: 0.0265, instance_loss: 0.2811, weighted_loss: 0.1029, label: 0, bag_size: 371
batch 379, loss: 0.1107, instance_loss: 0.2743, weighted_loss: 0.1598, label: 2, bag_size: 621
batch 399, loss: 0.0477, instance_loss: 0.2720, weighted_loss: 0.1150, label: 3, bag_size: 360
batch 419, loss: 0.2404, instance_loss: 0.5724, weighted_loss: 0.3400, label: 2, bag_size: 323


class 0 clustering acc 0.9872352941176471: correct 16783/17000
class 1 clustering acc 0.4835294117647059: correct 1644/3400
Epoch: 41, train_loss: 0.1687, train_clustering_loss:  0.2869, train_error: 0.0541
class 0: acc 0.975609756097561, correct 80/82
class 1: acc 0.8791208791208791, correct 80/91
class 2: acc 0.8860759493670886, correct 70/79
class 3: acc 0.9868421052631579, correct 75/76
class 4: acc 1.0, correct 97/97

Val Set, val_loss: 1.1094, val_error: 0.3000, auc: 0.8573
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.2875: correct 115/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.4, correct 2/5
class 2: acc 0.7037037037037037, correct 19/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.1240, instance_loss: 0.3998, weighted_loss: 0.2068, label: 2, bag_size: 687
batch 39, loss: 0.0227, instance_loss: 0.3714, weighted_loss: 0.1273, label: 1, bag_size: 818
batch 59, loss: 0.0644, instance_loss: 0.5865, weighted_loss: 0.2210, label: 3, bag_size: 200
batch 79, loss: 0.0105, instance_loss: 0.1612, weighted_loss: 0.0557, label: 4, bag_size: 625
batch 99, loss: 0.0076, instance_loss: 0.2419, weighted_loss: 0.0779, label: 4, bag_size: 1474
batch 119, loss: 2.6286, instance_loss: 0.7976, weighted_loss: 2.0793, label: 1, bag_size: 308
batch 139, loss: 0.0548, instance_loss: 0.3664, weighted_loss: 0.1483, label: 3, bag_size: 936
batch 159, loss: 0.0026, instance_loss: 0.0387, weighted_loss: 0.0134, label: 0, bag_size: 933
batch 179, loss: 0.0171, instance_loss: 0.0553, weighted_loss: 0.0286, label: 3, bag_size: 729
batch 199, loss: 0.3123, instance_loss: 0.2994, weighted_loss: 0.3084, label: 1, bag_size: 533
batch 219, loss: 0.4435, instance_loss: 0.7980, weighted_loss: 0.5498, label: 2, bag_size: 758
batch 239, loss: 0.1020, instance_loss: 0.3422, weighted_loss: 0.1741, label: 3, bag_size: 200
batch 259, loss: 0.0000, instance_loss: 0.0276, weighted_loss: 0.0083, label: 4, bag_size: 729
batch 279, loss: 0.0562, instance_loss: 0.2334, weighted_loss: 0.1094, label: 0, bag_size: 759
batch 299, loss: 0.0098, instance_loss: 0.3874, weighted_loss: 0.1231, label: 3, bag_size: 1253
batch 319, loss: 0.0755, instance_loss: 0.2555, weighted_loss: 0.1295, label: 0, bag_size: 1190
batch 339, loss: 0.1439, instance_loss: 0.4040, weighted_loss: 0.2219, label: 4, bag_size: 675
batch 359, loss: 0.0121, instance_loss: 0.0897, weighted_loss: 0.0354, label: 4, bag_size: 1121
batch 379, loss: 0.0318, instance_loss: 0.3536, weighted_loss: 0.1284, label: 3, bag_size: 360
batch 399, loss: 0.0012, instance_loss: 0.0783, weighted_loss: 0.0243, label: 3, bag_size: 1253
batch 419, loss: 0.0003, instance_loss: 0.1183, weighted_loss: 0.0357, label: 4, bag_size: 729


class 0 clustering acc 0.985764705882353: correct 16758/17000
class 1 clustering acc 0.47705882352941176: correct 1622/3400
Epoch: 42, train_loss: 0.1404, train_clustering_loss:  0.2953, train_error: 0.0353
class 0: acc 0.9885057471264368, correct 86/87
class 1: acc 0.9130434782608695, correct 84/92
class 2: acc 0.922077922077922, correct 71/77
class 3: acc 1.0, correct 86/86
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.3448, val_error: 0.3400, auc: 0.8354
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.275: correct 110/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5185185185185185, correct 14/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0017, instance_loss: 0.0435, weighted_loss: 0.0142, label: 3, bag_size: 729
batch 39, loss: 0.4435, instance_loss: 0.4969, weighted_loss: 0.4595, label: 0, bag_size: 1332
batch 59, loss: 0.0000, instance_loss: 0.0470, weighted_loss: 0.0141, label: 4, bag_size: 729
batch 79, loss: 0.0041, instance_loss: 0.0762, weighted_loss: 0.0257, label: 3, bag_size: 1019
batch 99, loss: 0.1216, instance_loss: 0.2522, weighted_loss: 0.1608, label: 0, bag_size: 424
batch 119, loss: 0.1486, instance_loss: 0.5304, weighted_loss: 0.2632, label: 3, bag_size: 283
batch 139, loss: 0.0072, instance_loss: 0.2359, weighted_loss: 0.0758, label: 4, bag_size: 297
batch 159, loss: 0.0011, instance_loss: 0.0545, weighted_loss: 0.0171, label: 0, bag_size: 385
batch 179, loss: 0.0962, instance_loss: 0.2164, weighted_loss: 0.1322, label: 4, bag_size: 1357
batch 199, loss: 0.0036, instance_loss: 0.1667, weighted_loss: 0.0525, label: 3, bag_size: 1399
batch 219, loss: 0.6909, instance_loss: 0.5042, weighted_loss: 0.6349, label: 0, bag_size: 423
batch 239, loss: 0.5546, instance_loss: 0.4014, weighted_loss: 0.5087, label: 2, bag_size: 482
batch 259, loss: 0.0158, instance_loss: 0.2034, weighted_loss: 0.0721, label: 1, bag_size: 790
batch 279, loss: 0.0016, instance_loss: 0.0264, weighted_loss: 0.0091, label: 3, bag_size: 1172
batch 299, loss: 0.8651, instance_loss: 0.4062, weighted_loss: 0.7274, label: 2, bag_size: 411
batch 319, loss: 2.0663, instance_loss: 0.5940, weighted_loss: 1.6246, label: 1, bag_size: 1799
batch 339, loss: 0.1771, instance_loss: 0.7761, weighted_loss: 0.3568, label: 2, bag_size: 679
batch 359, loss: 0.0037, instance_loss: 0.0851, weighted_loss: 0.0281, label: 0, bag_size: 1196
batch 379, loss: 0.0027, instance_loss: 0.0512, weighted_loss: 0.0173, label: 0, bag_size: 1235
batch 399, loss: 0.0000, instance_loss: 0.0988, weighted_loss: 0.0296, label: 4, bag_size: 729
batch 419, loss: 0.0117, instance_loss: 0.0705, weighted_loss: 0.0293, label: 3, bag_size: 729


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.4914705882352941: correct 1671/3400
Epoch: 43, train_loss: 0.1475, train_clustering_loss:  0.2806, train_error: 0.0447
class 0: acc 0.9523809523809523, correct 80/84
class 1: acc 0.9090909090909091, correct 90/99
class 2: acc 0.9240506329113924, correct 73/79
class 3: acc 1.0, correct 83/83
class 4: acc 1.0, correct 80/80

Val Set, val_loss: 1.2772, val_error: 0.3400, auc: 0.8478
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.29: correct 116/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5925925925925926, correct 16/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.7960, instance_loss: 0.8031, weighted_loss: 0.7982, label: 2, bag_size: 934
batch 39, loss: 0.0005, instance_loss: 0.3281, weighted_loss: 0.0988, label: 4, bag_size: 823
batch 59, loss: 0.0001, instance_loss: 0.0601, weighted_loss: 0.0181, label: 4, bag_size: 729
batch 79, loss: 0.0071, instance_loss: 0.2234, weighted_loss: 0.0720, label: 4, bag_size: 297
batch 99, loss: 2.1177, instance_loss: 0.5381, weighted_loss: 1.6438, label: 2, bag_size: 358
batch 119, loss: 0.0546, instance_loss: 0.2973, weighted_loss: 0.1274, label: 2, bag_size: 245
batch 139, loss: 0.7550, instance_loss: 0.4444, weighted_loss: 0.6618, label: 2, bag_size: 542
batch 159, loss: 0.1200, instance_loss: 0.4596, weighted_loss: 0.2219, label: 2, bag_size: 204
batch 179, loss: 0.0115, instance_loss: 0.1764, weighted_loss: 0.0610, label: 0, bag_size: 371
batch 199, loss: 0.6449, instance_loss: 0.4311, weighted_loss: 0.5808, label: 2, bag_size: 259
batch 219, loss: 1.1095, instance_loss: 0.4145, weighted_loss: 0.9010, label: 0, bag_size: 1034
batch 239, loss: 0.1669, instance_loss: 0.0650, weighted_loss: 0.1363, label: 3, bag_size: 556
batch 259, loss: 0.0823, instance_loss: 0.1603, weighted_loss: 0.1057, label: 0, bag_size: 410
batch 279, loss: 0.0005, instance_loss: 0.2106, weighted_loss: 0.0635, label: 4, bag_size: 729
batch 299, loss: 0.0000, instance_loss: 0.0373, weighted_loss: 0.0112, label: 4, bag_size: 729
batch 319, loss: 0.0533, instance_loss: 0.2311, weighted_loss: 0.1067, label: 0, bag_size: 542
batch 339, loss: 4.7024, instance_loss: 1.7135, weighted_loss: 3.8058, label: 2, bag_size: 1108
batch 359, loss: 0.4192, instance_loss: 0.5993, weighted_loss: 0.4733, label: 3, bag_size: 283
batch 379, loss: 0.0054, instance_loss: 0.0640, weighted_loss: 0.0230, label: 3, bag_size: 1172
batch 399, loss: 0.0156, instance_loss: 0.1132, weighted_loss: 0.0449, label: 3, bag_size: 729
batch 419, loss: 0.0741, instance_loss: 0.4303, weighted_loss: 0.1809, label: 1, bag_size: 442


class 0 clustering acc 0.9861764705882353: correct 16765/17000
class 1 clustering acc 0.4811764705882353: correct 1636/3400
Epoch: 44, train_loss: 0.2666, train_clustering_loss:  0.3026, train_error: 0.0894
class 0: acc 0.9444444444444444, correct 68/72
class 1: acc 0.8666666666666667, correct 78/90
class 2: acc 0.7894736842105263, correct 75/95
class 3: acc 0.9891304347826086, correct 91/92
class 4: acc 0.9868421052631579, correct 75/76

Val Set, val_loss: 1.3214, val_error: 0.3600, auc: 0.8675
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.5555555555555556, correct 15/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0000, instance_loss: 0.1033, weighted_loss: 0.0310, label: 4, bag_size: 729
batch 39, loss: 0.0980, instance_loss: 0.4375, weighted_loss: 0.1999, label: 3, bag_size: 305
batch 59, loss: 0.5172, instance_loss: 0.6198, weighted_loss: 0.5480, label: 2, bag_size: 1400
batch 79, loss: 0.0113, instance_loss: 0.0869, weighted_loss: 0.0340, label: 0, bag_size: 478
batch 99, loss: 0.1193, instance_loss: 0.4847, weighted_loss: 0.2289, label: 2, bag_size: 307
batch 119, loss: 0.2883, instance_loss: 0.4412, weighted_loss: 0.3342, label: 2, bag_size: 621
batch 139, loss: 0.1257, instance_loss: 0.5575, weighted_loss: 0.2553, label: 1, bag_size: 487
batch 159, loss: 0.0132, instance_loss: 0.1019, weighted_loss: 0.0398, label: 0, bag_size: 630
batch 179, loss: 0.0044, instance_loss: 0.0714, weighted_loss: 0.0245, label: 0, bag_size: 729
batch 199, loss: 0.0016, instance_loss: 0.0346, weighted_loss: 0.0115, label: 0, bag_size: 385
batch 219, loss: 0.0239, instance_loss: 0.2701, weighted_loss: 0.0978, label: 1, bag_size: 474
batch 239, loss: 0.0053, instance_loss: 0.5098, weighted_loss: 0.1566, label: 3, bag_size: 1167
batch 259, loss: 0.2143, instance_loss: 0.2127, weighted_loss: 0.2138, label: 2, bag_size: 480
batch 279, loss: 0.0623, instance_loss: 0.2707, weighted_loss: 0.1248, label: 3, bag_size: 360
batch 299, loss: 0.1147, instance_loss: 0.1396, weighted_loss: 0.1222, label: 1, bag_size: 1191
batch 319, loss: 0.0512, instance_loss: 0.2063, weighted_loss: 0.0977, label: 2, bag_size: 1123
batch 339, loss: 0.5113, instance_loss: 0.2864, weighted_loss: 0.4439, label: 2, bag_size: 278
batch 359, loss: 0.1761, instance_loss: 0.2766, weighted_loss: 0.2063, label: 2, bag_size: 1569
batch 379, loss: 0.8285, instance_loss: 0.5413, weighted_loss: 0.7424, label: 1, bag_size: 448
batch 399, loss: 0.0003, instance_loss: 0.0943, weighted_loss: 0.0285, label: 1, bag_size: 847
batch 419, loss: 0.0200, instance_loss: 0.1739, weighted_loss: 0.0661, label: 1, bag_size: 858


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.49264705882352944: correct 1675/3400
Epoch: 45, train_loss: 0.1962, train_clustering_loss:  0.2855, train_error: 0.0706
class 0: acc 0.9540229885057471, correct 83/87
class 1: acc 0.8260869565217391, correct 76/92
class 2: acc 0.8831168831168831, correct 68/77
class 3: acc 1.0, correct 84/84
class 4: acc 0.9882352941176471, correct 84/85

Val Set, val_loss: 1.3348, val_error: 0.3200, auc: 0.8408
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.26: correct 104/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 3/5
class 2: acc 0.5925925925925926, correct 16/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.5678, instance_loss: 0.8975, weighted_loss: 0.6667, label: 1, bag_size: 660
batch 39, loss: 0.0779, instance_loss: 0.6420, weighted_loss: 0.2471, label: 1, bag_size: 868
batch 59, loss: 2.1122, instance_loss: 0.7207, weighted_loss: 1.6947, label: 1, bag_size: 1799
batch 79, loss: 0.0101, instance_loss: 0.5148, weighted_loss: 0.1615, label: 1, bag_size: 700
batch 99, loss: 0.0097, instance_loss: 0.1093, weighted_loss: 0.0396, label: 1, bag_size: 994
batch 119, loss: 0.0008, instance_loss: 0.1331, weighted_loss: 0.0405, label: 3, bag_size: 729
batch 139, loss: 0.0274, instance_loss: 0.2980, weighted_loss: 0.1086, label: 3, bag_size: 360
batch 159, loss: 0.0194, instance_loss: 0.1954, weighted_loss: 0.0722, label: 0, bag_size: 729
batch 179, loss: 0.0098, instance_loss: 0.4617, weighted_loss: 0.1454, label: 1, bag_size: 442
batch 199, loss: 0.0059, instance_loss: 0.1046, weighted_loss: 0.0355, label: 3, bag_size: 729
batch 219, loss: 0.0059, instance_loss: 0.0990, weighted_loss: 0.0338, label: 1, bag_size: 847
batch 239, loss: 0.0042, instance_loss: 0.0456, weighted_loss: 0.0166, label: 3, bag_size: 1291
batch 259, loss: 0.0006, instance_loss: 0.7665, weighted_loss: 0.2304, label: 4, bag_size: 882
batch 279, loss: 0.0368, instance_loss: 0.7824, weighted_loss: 0.2605, label: 4, bag_size: 210
batch 299, loss: 0.0153, instance_loss: 0.3108, weighted_loss: 0.1040, label: 2, bag_size: 312
batch 319, loss: 0.0034, instance_loss: 0.1427, weighted_loss: 0.0452, label: 1, bag_size: 369
batch 339, loss: 0.0020, instance_loss: 0.6023, weighted_loss: 0.1821, label: 3, bag_size: 1167
batch 359, loss: 0.0031, instance_loss: 0.0416, weighted_loss: 0.0147, label: 0, bag_size: 521
batch 379, loss: 0.0414, instance_loss: 0.7973, weighted_loss: 0.2682, label: 4, bag_size: 210
batch 399, loss: 0.0207, instance_loss: 0.6149, weighted_loss: 0.1989, label: 1, bag_size: 1390
batch 419, loss: 0.8052, instance_loss: 0.4578, weighted_loss: 0.7010, label: 2, bag_size: 806


class 0 clustering acc 0.9877058823529412: correct 16791/17000
class 1 clustering acc 0.5035294117647059: correct 1712/3400
Epoch: 46, train_loss: 0.1109, train_clustering_loss:  0.2815, train_error: 0.0306
class 0: acc 0.9722222222222222, correct 70/72
class 1: acc 0.9036144578313253, correct 75/83
class 2: acc 0.9651162790697675, correct 83/86
class 3: acc 1.0, correct 100/100
class 4: acc 1.0, correct 84/84

Val Set, val_loss: 1.4054, val_error: 0.3600, auc: 0.8429
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.25: correct 100/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5925925925925926, correct 16/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0002, instance_loss: 0.0958, weighted_loss: 0.0289, label: 4, bag_size: 729
batch 39, loss: 0.0775, instance_loss: 0.1861, weighted_loss: 0.1101, label: 4, bag_size: 1002
batch 59, loss: 0.0273, instance_loss: 0.8327, weighted_loss: 0.2689, label: 4, bag_size: 542
batch 79, loss: 0.0007, instance_loss: 0.0267, weighted_loss: 0.0085, label: 0, bag_size: 1466
batch 99, loss: 0.0090, instance_loss: 0.0806, weighted_loss: 0.0305, label: 0, bag_size: 375
batch 119, loss: 0.0226, instance_loss: 0.1278, weighted_loss: 0.0542, label: 3, bag_size: 729
batch 139, loss: 0.0048, instance_loss: 0.0897, weighted_loss: 0.0302, label: 0, bag_size: 1255
batch 159, loss: 0.1531, instance_loss: 0.2508, weighted_loss: 0.1824, label: 0, bag_size: 1527
batch 179, loss: 0.0010, instance_loss: 0.1415, weighted_loss: 0.0432, label: 4, bag_size: 1176
batch 199, loss: 0.0991, instance_loss: 0.2929, weighted_loss: 0.1573, label: 0, bag_size: 1527
batch 219, loss: 0.0019, instance_loss: 0.1275, weighted_loss: 0.0396, label: 3, bag_size: 729
batch 239, loss: 0.1115, instance_loss: 0.4459, weighted_loss: 0.2119, label: 1, bag_size: 968
batch 259, loss: 0.0075, instance_loss: 0.7540, weighted_loss: 0.2314, label: 4, bag_size: 542
batch 279, loss: 0.0037, instance_loss: 0.0593, weighted_loss: 0.0204, label: 0, bag_size: 1143
batch 299, loss: 0.1058, instance_loss: 0.5274, weighted_loss: 0.2323, label: 3, bag_size: 283
batch 319, loss: 0.0026, instance_loss: 0.5434, weighted_loss: 0.1648, label: 3, bag_size: 1167
batch 339, loss: 0.0087, instance_loss: 0.2601, weighted_loss: 0.0841, label: 2, bag_size: 1164
batch 359, loss: 0.0116, instance_loss: 0.0230, weighted_loss: 0.0150, label: 4, bag_size: 764
batch 379, loss: 0.0485, instance_loss: 0.2395, weighted_loss: 0.1058, label: 2, bag_size: 286
batch 399, loss: 0.0009, instance_loss: 0.1505, weighted_loss: 0.0458, label: 1, bag_size: 834
batch 419, loss: 0.0001, instance_loss: 0.0592, weighted_loss: 0.0178, label: 4, bag_size: 729


class 0 clustering acc 0.9855294117647059: correct 16754/17000
class 1 clustering acc 0.4861764705882353: correct 1653/3400
Epoch: 47, train_loss: 0.1554, train_clustering_loss:  0.2949, train_error: 0.0376
class 0: acc 0.9883720930232558, correct 85/86
class 1: acc 0.9052631578947369, correct 86/95
class 2: acc 0.9310344827586207, correct 81/87
class 3: acc 1.0, correct 68/68
class 4: acc 1.0, correct 89/89

Val Set, val_loss: 1.4267, val_error: 0.3400, auc: 0.8561
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.265: correct 106/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5925925925925926, correct 16/27
class 3: acc 0.0, correct 0/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0068, instance_loss: 0.1318, weighted_loss: 0.0443, label: 0, bag_size: 338
batch 39, loss: 0.5014, instance_loss: 0.5242, weighted_loss: 0.5083, label: 3, bag_size: 305
batch 59, loss: 0.2060, instance_loss: 0.2659, weighted_loss: 0.2240, label: 0, bag_size: 424
batch 79, loss: 0.0274, instance_loss: 0.1196, weighted_loss: 0.0551, label: 3, bag_size: 729
batch 99, loss: 0.0013, instance_loss: 0.0337, weighted_loss: 0.0110, label: 0, bag_size: 1174
batch 119, loss: 0.0019, instance_loss: 0.0757, weighted_loss: 0.0240, label: 0, bag_size: 729
batch 139, loss: 0.0000, instance_loss: 0.0936, weighted_loss: 0.0281, label: 4, bag_size: 729
batch 159, loss: 0.0034, instance_loss: 0.1950, weighted_loss: 0.0609, label: 1, bag_size: 847
batch 179, loss: 0.0187, instance_loss: 0.0992, weighted_loss: 0.0429, label: 3, bag_size: 729
batch 199, loss: 0.0135, instance_loss: 0.3844, weighted_loss: 0.1247, label: 3, bag_size: 317
batch 219, loss: 0.1678, instance_loss: 0.2573, weighted_loss: 0.1947, label: 2, bag_size: 202
batch 239, loss: 0.2529, instance_loss: 0.2940, weighted_loss: 0.2652, label: 2, bag_size: 1653
batch 259, loss: 0.0211, instance_loss: 0.6485, weighted_loss: 0.2093, label: 1, bag_size: 778
batch 279, loss: 0.0034, instance_loss: 0.4381, weighted_loss: 0.1338, label: 1, bag_size: 700
batch 299, loss: 0.5505, instance_loss: 0.7034, weighted_loss: 0.5963, label: 2, bag_size: 405
batch 319, loss: 0.1085, instance_loss: 0.4236, weighted_loss: 0.2030, label: 2, bag_size: 272
batch 339, loss: 0.6567, instance_loss: 0.4385, weighted_loss: 0.5912, label: 1, bag_size: 868
batch 359, loss: 0.1763, instance_loss: 0.5804, weighted_loss: 0.2975, label: 1, bag_size: 648
batch 379, loss: 0.0093, instance_loss: 0.0622, weighted_loss: 0.0251, label: 0, bag_size: 340
batch 399, loss: 0.0186, instance_loss: 0.1571, weighted_loss: 0.0601, label: 1, bag_size: 697
batch 419, loss: 0.0032, instance_loss: 0.1958, weighted_loss: 0.0610, label: 4, bag_size: 1357


class 0 clustering acc 0.9861764705882353: correct 16765/17000
class 1 clustering acc 0.5114705882352941: correct 1739/3400
Epoch: 48, train_loss: 0.1068, train_clustering_loss:  0.2847, train_error: 0.0282
class 0: acc 0.9782608695652174, correct 90/92
class 1: acc 0.9550561797752809, correct 85/89
class 2: acc 0.918918918918919, correct 68/74
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 90/90

Val Set, val_loss: 1.5345, val_error: 0.3800, auc: 0.8712
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.305: correct 122/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.48148148148148145, correct 13/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.3393, instance_loss: 0.2003, weighted_loss: 0.2976, label: 3, bag_size: 1177
batch 39, loss: 0.0442, instance_loss: 0.3636, weighted_loss: 0.1400, label: 0, bag_size: 1527
batch 59, loss: 0.0971, instance_loss: 0.4490, weighted_loss: 0.2027, label: 2, bag_size: 272
batch 79, loss: 0.0212, instance_loss: 0.4262, weighted_loss: 0.1427, label: 2, bag_size: 1119
batch 99, loss: 0.0045, instance_loss: 0.2622, weighted_loss: 0.0818, label: 4, bag_size: 354
batch 119, loss: 0.0055, instance_loss: 0.0361, weighted_loss: 0.0147, label: 3, bag_size: 729
batch 139, loss: 0.0116, instance_loss: 0.2578, weighted_loss: 0.0854, label: 4, bag_size: 354
batch 159, loss: 0.0275, instance_loss: 0.7126, weighted_loss: 0.2331, label: 2, bag_size: 803
batch 179, loss: 0.0077, instance_loss: 0.1600, weighted_loss: 0.0534, label: 0, bag_size: 338
batch 199, loss: 0.0025, instance_loss: 0.2481, weighted_loss: 0.0762, label: 4, bag_size: 1278
batch 219, loss: 0.2729, instance_loss: 0.3229, weighted_loss: 0.2879, label: 2, bag_size: 345
batch 239, loss: 0.0046, instance_loss: 0.3079, weighted_loss: 0.0956, label: 2, bag_size: 1128
batch 259, loss: 0.0000, instance_loss: 0.2095, weighted_loss: 0.0629, label: 4, bag_size: 823
batch 279, loss: 0.0094, instance_loss: 0.0767, weighted_loss: 0.0296, label: 0, bag_size: 1466
batch 299, loss: 0.0336, instance_loss: 0.2160, weighted_loss: 0.0884, label: 1, bag_size: 925
batch 319, loss: 0.0106, instance_loss: 0.1855, weighted_loss: 0.0631, label: 3, bag_size: 1118
batch 339, loss: 0.0006, instance_loss: 0.0529, weighted_loss: 0.0163, label: 4, bag_size: 1176
batch 359, loss: 0.0035, instance_loss: 0.0775, weighted_loss: 0.0257, label: 0, bag_size: 246
batch 379, loss: 0.0959, instance_loss: 0.4034, weighted_loss: 0.1882, label: 2, bag_size: 774
batch 399, loss: 0.0009, instance_loss: 0.0614, weighted_loss: 0.0191, label: 1, bag_size: 1277
batch 419, loss: 0.0564, instance_loss: 0.3907, weighted_loss: 0.1567, label: 2, bag_size: 725


class 0 clustering acc 0.989: correct 16813/17000
class 1 clustering acc 0.48970588235294116: correct 1665/3400
Epoch: 49, train_loss: 0.1000, train_clustering_loss:  0.2752, train_error: 0.0212
class 0: acc 1.0, correct 103/103
class 1: acc 0.9459459459459459, correct 70/74
class 2: acc 0.9550561797752809, correct 85/89
class 3: acc 0.9876543209876543, correct 80/81
class 4: acc 1.0, correct 78/78

Val Set, val_loss: 1.3920, val_error: 0.3000, auc: 0.8418
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.27: correct 108/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.6666666666666666, correct 18/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0104, instance_loss: 0.1126, weighted_loss: 0.0411, label: 0, bag_size: 413
batch 39, loss: 0.0195, instance_loss: 0.1633, weighted_loss: 0.0627, label: 0, bag_size: 1061
batch 59, loss: 0.0044, instance_loss: 0.1485, weighted_loss: 0.0476, label: 0, bag_size: 1143
batch 79, loss: 0.0188, instance_loss: 0.6193, weighted_loss: 0.1989, label: 3, bag_size: 281
batch 99, loss: 2.9568, instance_loss: 0.7067, weighted_loss: 2.2818, label: 1, bag_size: 1172
batch 119, loss: 0.0557, instance_loss: 0.0356, weighted_loss: 0.0497, label: 3, bag_size: 556
batch 139, loss: 0.0057, instance_loss: 0.1074, weighted_loss: 0.0362, label: 3, bag_size: 1291
batch 159, loss: 0.1809, instance_loss: 0.4968, weighted_loss: 0.2757, label: 2, bag_size: 1167
batch 179, loss: 0.0289, instance_loss: 0.1259, weighted_loss: 0.0580, label: 3, bag_size: 729
batch 199, loss: 0.0305, instance_loss: 0.4862, weighted_loss: 0.1672, label: 2, bag_size: 766
batch 219, loss: 0.0088, instance_loss: 0.6435, weighted_loss: 0.1992, label: 4, bag_size: 210
batch 239, loss: 0.0006, instance_loss: 0.0190, weighted_loss: 0.0061, label: 0, bag_size: 521
batch 259, loss: 0.0007, instance_loss: 0.0328, weighted_loss: 0.0103, label: 4, bag_size: 764
batch 279, loss: 0.2922, instance_loss: 0.1576, weighted_loss: 0.2518, label: 1, bag_size: 405
batch 299, loss: 0.1303, instance_loss: 0.3503, weighted_loss: 0.1963, label: 0, bag_size: 200
batch 319, loss: 0.3536, instance_loss: 0.2812, weighted_loss: 0.3319, label: 2, bag_size: 1289
batch 339, loss: 0.0413, instance_loss: 0.4381, weighted_loss: 0.1604, label: 3, bag_size: 360
batch 359, loss: 0.0414, instance_loss: 0.0613, weighted_loss: 0.0473, label: 3, bag_size: 729
batch 379, loss: 0.0417, instance_loss: 0.4503, weighted_loss: 0.1643, label: 2, bag_size: 471
batch 399, loss: 0.0011, instance_loss: 0.0600, weighted_loss: 0.0188, label: 0, bag_size: 1466
batch 419, loss: 0.0284, instance_loss: 0.1062, weighted_loss: 0.0518, label: 0, bag_size: 410


class 0 clustering acc 0.9888823529411764: correct 16811/17000
class 1 clustering acc 0.5014705882352941: correct 1705/3400
Epoch: 50, train_loss: 0.1392, train_clustering_loss:  0.2761, train_error: 0.0329
class 0: acc 0.9894736842105263, correct 94/95
class 1: acc 0.9176470588235294, correct 78/85
class 2: acc 0.9342105263157895, correct 71/76
class 3: acc 0.9893617021276596, correct 93/94
class 4: acc 1.0, correct 75/75

Val Set, val_loss: 1.5482, val_error: 0.3800, auc: 0.8687
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.3175: correct 127/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5185185185185185, correct 14/27
class 3: acc 0.25, correct 1/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0004, instance_loss: 0.1040, weighted_loss: 0.0315, label: 4, bag_size: 388
batch 39, loss: 0.0021, instance_loss: 0.0443, weighted_loss: 0.0148, label: 0, bag_size: 729
batch 59, loss: 0.0000, instance_loss: 0.1736, weighted_loss: 0.0521, label: 4, bag_size: 1002
batch 79, loss: 0.0105, instance_loss: 0.5907, weighted_loss: 0.1846, label: 4, bag_size: 542
batch 99, loss: 0.0009, instance_loss: 0.0873, weighted_loss: 0.0268, label: 0, bag_size: 729
batch 119, loss: 0.0069, instance_loss: 0.2387, weighted_loss: 0.0764, label: 4, bag_size: 817
batch 139, loss: 0.2116, instance_loss: 0.4954, weighted_loss: 0.2967, label: 2, bag_size: 373
batch 159, loss: 0.0041, instance_loss: 0.1047, weighted_loss: 0.0343, label: 3, bag_size: 1019
batch 179, loss: 0.0937, instance_loss: 0.2938, weighted_loss: 0.1537, label: 2, bag_size: 202
batch 199, loss: 0.2459, instance_loss: 0.3101, weighted_loss: 0.2652, label: 0, bag_size: 432
batch 219, loss: 0.0043, instance_loss: 0.0775, weighted_loss: 0.0262, label: 0, bag_size: 729
batch 239, loss: 0.0326, instance_loss: 0.0914, weighted_loss: 0.0502, label: 3, bag_size: 1399
batch 259, loss: 0.0233, instance_loss: 0.5211, weighted_loss: 0.1727, label: 4, bag_size: 436
batch 279, loss: 1.7212, instance_loss: 0.6995, weighted_loss: 1.4147, label: 1, bag_size: 448
batch 299, loss: 1.1710, instance_loss: 0.7359, weighted_loss: 1.0404, label: 1, bag_size: 1799
batch 319, loss: 0.0006, instance_loss: 0.0677, weighted_loss: 0.0207, label: 3, bag_size: 729
batch 339, loss: 0.0276, instance_loss: 0.1052, weighted_loss: 0.0509, label: 3, bag_size: 729
batch 359, loss: 0.0222, instance_loss: 0.1402, weighted_loss: 0.0576, label: 2, bag_size: 1039
batch 379, loss: 0.3728, instance_loss: 0.2543, weighted_loss: 0.3373, label: 3, bag_size: 230
batch 399, loss: 0.0535, instance_loss: 0.1995, weighted_loss: 0.0973, label: 1, bag_size: 288
batch 419, loss: 0.0100, instance_loss: 0.3057, weighted_loss: 0.0987, label: 4, bag_size: 1357


class 0 clustering acc 0.9872941176470589: correct 16784/17000
class 1 clustering acc 0.48058823529411765: correct 1634/3400
Epoch: 51, train_loss: 0.1052, train_clustering_loss:  0.2833, train_error: 0.0306
class 0: acc 0.9885057471264368, correct 86/87
class 1: acc 0.927710843373494, correct 77/83
class 2: acc 0.9439252336448598, correct 101/107
class 3: acc 1.0, correct 77/77
class 4: acc 1.0, correct 71/71

Val Set, val_loss: 1.6000, val_error: 0.3200, auc: 0.8616
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.34: correct 136/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.5925925925925926, correct 16/27
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 31 out of 20
Early stopping
Val error: 0.3400, ROC AUC: 0.8564
Test error: 0.3400, ROC AUC: 0.8701
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.8, correct 4/5

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6758, instance_loss: 1.2068, weighted_loss: 1.5351, label: 1, bag_size: 346
batch 39, loss: 1.6491, instance_loss: 1.1086, weighted_loss: 1.4869, label: 3, bag_size: 729
batch 59, loss: 1.6039, instance_loss: 0.9621, weighted_loss: 1.4113, label: 0, bag_size: 729
batch 79, loss: 1.7642, instance_loss: 0.7637, weighted_loss: 1.4641, label: 1, bag_size: 838
batch 99, loss: 1.6468, instance_loss: 0.6110, weighted_loss: 1.3361, label: 4, bag_size: 675
batch 119, loss: 1.5202, instance_loss: 0.5553, weighted_loss: 1.2308, label: 3, bag_size: 729
batch 139, loss: 1.7082, instance_loss: 0.5415, weighted_loss: 1.3582, label: 2, bag_size: 684
batch 159, loss: 1.4682, instance_loss: 0.5021, weighted_loss: 1.1784, label: 3, bag_size: 729
batch 179, loss: 1.8074, instance_loss: 0.5337, weighted_loss: 1.4253, label: 2, bag_size: 474
batch 199, loss: 1.6791, instance_loss: 0.5260, weighted_loss: 1.3332, label: 2, bag_size: 1178
batch 219, loss: 1.3779, instance_loss: 0.4854, weighted_loss: 1.1101, label: 1, bag_size: 866
batch 239, loss: 1.5158, instance_loss: 0.4861, weighted_loss: 1.2069, label: 3, bag_size: 706
batch 259, loss: 1.3084, instance_loss: 0.4751, weighted_loss: 1.0584, label: 3, bag_size: 936
batch 279, loss: 1.5753, instance_loss: 0.5353, weighted_loss: 1.2633, label: 0, bag_size: 729
batch 299, loss: 1.3737, instance_loss: 0.4871, weighted_loss: 1.1077, label: 1, bag_size: 442
batch 319, loss: 1.3110, instance_loss: 0.4843, weighted_loss: 1.0630, label: 1, bag_size: 838
batch 339, loss: 1.6701, instance_loss: 0.5230, weighted_loss: 1.3259, label: 2, bag_size: 758
batch 359, loss: 1.5799, instance_loss: 0.5059, weighted_loss: 1.2577, label: 1, bag_size: 470
batch 379, loss: 1.2792, instance_loss: 0.4746, weighted_loss: 1.0378, label: 4, bag_size: 1337
batch 399, loss: 1.4187, instance_loss: 0.5165, weighted_loss: 1.1480, label: 2, bag_size: 2081
batch 419, loss: 1.9879, instance_loss: 0.5493, weighted_loss: 1.5563, label: 3, bag_size: 281


class 0 clustering acc 0.9940588235294118: correct 16899/17000
class 1 clustering acc 0.005294117647058823: correct 18/3400
Epoch: 0, train_loss: 1.5727, train_clustering_loss:  0.6292, train_error: 0.7388
class 0: acc 0.04, correct 3/75
class 1: acc 0.3176470588235294, correct 27/85
class 2: acc 0.14942528735632185, correct 13/87
class 3: acc 0.32558139534883723, correct 28/86
class 4: acc 0.43478260869565216, correct 40/92

Val Set, val_loss: 1.4837, val_error: 0.5000, auc: 0.8311
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/6
class 1: acc 0.0, correct 0/13
class 2: acc 0.92, correct 23/25
class 3: acc 0.0, correct 0/4
class 4: acc 1.0, correct 2/2
Validation loss decreased (inf --> 1.483741).  Saving model ...


batch 19, loss: 1.6838, instance_loss: 0.5187, weighted_loss: 1.3343, label: 2, bag_size: 600
batch 39, loss: 1.7955, instance_loss: 0.5338, weighted_loss: 1.4170, label: 3, bag_size: 1177
batch 59, loss: 1.6127, instance_loss: 0.5250, weighted_loss: 1.2864, label: 0, bag_size: 933
batch 79, loss: 1.3907, instance_loss: 0.4609, weighted_loss: 1.1118, label: 4, bag_size: 436
batch 99, loss: 1.3590, instance_loss: 0.4950, weighted_loss: 1.0998, label: 0, bag_size: 729
batch 119, loss: 1.4697, instance_loss: 0.4973, weighted_loss: 1.1780, label: 2, bag_size: 400
batch 139, loss: 1.8005, instance_loss: 0.5231, weighted_loss: 1.4173, label: 1, bag_size: 386
batch 159, loss: 1.6064, instance_loss: 0.4999, weighted_loss: 1.2745, label: 2, bag_size: 629
batch 179, loss: 1.3117, instance_loss: 0.4941, weighted_loss: 1.0664, label: 3, bag_size: 556
batch 199, loss: 1.4474, instance_loss: 0.5079, weighted_loss: 1.1655, label: 1, bag_size: 598
batch 219, loss: 1.2788, instance_loss: 0.4700, weighted_loss: 1.0362, label: 4, bag_size: 436
batch 239, loss: 1.6285, instance_loss: 0.5118, weighted_loss: 1.2935, label: 2, bag_size: 469
batch 259, loss: 1.4366, instance_loss: 0.4914, weighted_loss: 1.1530, label: 2, bag_size: 295
batch 279, loss: 1.0993, instance_loss: 0.4669, weighted_loss: 0.9096, label: 2, bag_size: 632
batch 299, loss: 1.1318, instance_loss: 0.4620, weighted_loss: 0.9309, label: 3, bag_size: 1291
batch 319, loss: 1.1420, instance_loss: 0.4527, weighted_loss: 0.9352, label: 3, bag_size: 729
batch 339, loss: 1.4901, instance_loss: 0.5141, weighted_loss: 1.1973, label: 0, bag_size: 607
batch 359, loss: 1.8768, instance_loss: 0.5053, weighted_loss: 1.4653, label: 2, bag_size: 518
batch 379, loss: 1.4090, instance_loss: 0.5148, weighted_loss: 1.1407, label: 4, bag_size: 1357
batch 399, loss: 1.1275, instance_loss: 0.4803, weighted_loss: 0.9334, label: 4, bag_size: 790
batch 419, loss: 1.3898, instance_loss: 0.4783, weighted_loss: 1.1163, label: 3, bag_size: 697


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4759, train_clustering_loss:  0.4988, train_error: 0.6212
class 0: acc 0.26436781609195403, correct 23/87
class 1: acc 0.28378378378378377, correct 21/74
class 2: acc 0.4148936170212766, correct 39/94
class 3: acc 0.42168674698795183, correct 35/83
class 4: acc 0.4942528735632184, correct 43/87

Val Set, val_loss: 1.4883, val_error: 0.5800, auc: 0.8590
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.24, correct 6/25
class 3: acc 0.75, correct 3/4
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3204, instance_loss: 0.4638, weighted_loss: 1.0635, label: 2, bag_size: 846
batch 39, loss: 0.6612, instance_loss: 0.4254, weighted_loss: 0.5904, label: 4, bag_size: 729
batch 59, loss: 1.1179, instance_loss: 0.4489, weighted_loss: 0.9172, label: 1, bag_size: 890
batch 79, loss: 1.1265, instance_loss: 0.4612, weighted_loss: 0.9269, label: 3, bag_size: 729
batch 99, loss: 1.7619, instance_loss: 0.5273, weighted_loss: 1.3915, label: 4, bag_size: 625
batch 119, loss: 1.0578, instance_loss: 0.4335, weighted_loss: 0.8705, label: 1, bag_size: 858
batch 139, loss: 0.9495, instance_loss: 0.4219, weighted_loss: 0.7912, label: 3, bag_size: 729
batch 159, loss: 2.0522, instance_loss: 0.5584, weighted_loss: 1.6040, label: 3, bag_size: 317
batch 179, loss: 1.4981, instance_loss: 0.5301, weighted_loss: 1.2077, label: 2, bag_size: 1123
batch 199, loss: 0.9182, instance_loss: 0.4071, weighted_loss: 0.7648, label: 4, bag_size: 646
batch 219, loss: 0.7864, instance_loss: 0.4200, weighted_loss: 0.6765, label: 3, bag_size: 1291
batch 239, loss: 1.3312, instance_loss: 0.5206, weighted_loss: 1.0880, label: 0, bag_size: 1579
batch 259, loss: 0.9804, instance_loss: 0.3992, weighted_loss: 0.8060, label: 4, bag_size: 1278
batch 279, loss: 1.1063, instance_loss: 0.4674, weighted_loss: 0.9146, label: 2, bag_size: 1200
batch 299, loss: 1.0648, instance_loss: 0.4593, weighted_loss: 0.8831, label: 2, bag_size: 399
batch 319, loss: 1.3161, instance_loss: 0.4539, weighted_loss: 1.0574, label: 1, bag_size: 747
batch 339, loss: 1.2495, instance_loss: 0.4458, weighted_loss: 1.0084, label: 2, bag_size: 272
batch 359, loss: 0.9507, instance_loss: 0.4646, weighted_loss: 0.8049, label: 3, bag_size: 821
batch 379, loss: 1.0132, instance_loss: 0.4451, weighted_loss: 0.8428, label: 2, bag_size: 259
batch 399, loss: 1.8915, instance_loss: 0.5323, weighted_loss: 1.4837, label: 1, bag_size: 660
batch 419, loss: 1.9718, instance_loss: 0.5445, weighted_loss: 1.5436, label: 3, bag_size: 281


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.2826, train_clustering_loss:  0.4739, train_error: 0.4706
class 0: acc 0.30120481927710846, correct 25/83
class 1: acc 0.5934065934065934, correct 54/91
class 2: acc 0.5666666666666667, correct 51/90
class 3: acc 0.5540540540540541, correct 41/74
class 4: acc 0.6206896551724138, correct 54/87

Val Set, val_loss: 1.3010, val_error: 0.5400, auc: 0.8681
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.2, correct 5/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.5, correct 1/2
Validation loss decreased (1.483741 --> 1.300954).  Saving model ...


batch 19, loss: 1.4551, instance_loss: 0.5035, weighted_loss: 1.1696, label: 4, bag_size: 656
batch 39, loss: 1.3563, instance_loss: 0.4748, weighted_loss: 1.0919, label: 1, bag_size: 487
batch 59, loss: 0.6313, instance_loss: 0.3531, weighted_loss: 0.5478, label: 1, bag_size: 369
batch 79, loss: 1.3246, instance_loss: 0.4667, weighted_loss: 1.0673, label: 1, bag_size: 847
batch 99, loss: 0.9388, instance_loss: 0.4046, weighted_loss: 0.7785, label: 4, bag_size: 1235
batch 119, loss: 1.0671, instance_loss: 0.4766, weighted_loss: 0.8899, label: 2, bag_size: 1289
batch 139, loss: 2.1126, instance_loss: 0.5395, weighted_loss: 1.6407, label: 4, bag_size: 511
batch 159, loss: 0.7015, instance_loss: 0.3343, weighted_loss: 0.5914, label: 3, bag_size: 729
batch 179, loss: 0.1996, instance_loss: 0.1993, weighted_loss: 0.1995, label: 3, bag_size: 1559
batch 199, loss: 1.1641, instance_loss: 0.4932, weighted_loss: 0.9628, label: 0, bag_size: 552
batch 219, loss: 1.2828, instance_loss: 0.4776, weighted_loss: 1.0413, label: 2, bag_size: 986
batch 239, loss: 1.7371, instance_loss: 0.4473, weighted_loss: 1.3502, label: 1, bag_size: 936
batch 259, loss: 1.2900, instance_loss: 0.4765, weighted_loss: 1.0460, label: 2, bag_size: 839
batch 279, loss: 1.3070, instance_loss: 0.5274, weighted_loss: 1.0731, label: 2, bag_size: 1404
batch 299, loss: 1.1992, instance_loss: 0.5031, weighted_loss: 0.9904, label: 2, bag_size: 1439
batch 319, loss: 2.6655, instance_loss: 0.6570, weighted_loss: 2.0630, label: 1, bag_size: 293
batch 339, loss: 0.9784, instance_loss: 0.4446, weighted_loss: 0.8182, label: 0, bag_size: 413
batch 359, loss: 0.3781, instance_loss: 0.4156, weighted_loss: 0.3894, label: 4, bag_size: 729
batch 379, loss: 1.6018, instance_loss: 0.5548, weighted_loss: 1.2877, label: 1, bag_size: 1724
batch 399, loss: 0.4159, instance_loss: 0.3083, weighted_loss: 0.3836, label: 1, bag_size: 1277
batch 419, loss: 0.8376, instance_loss: 0.3691, weighted_loss: 0.6971, label: 2, bag_size: 1385


class 0 clustering acc 0.9994117647058823: correct 16990/17000
class 1 clustering acc 0.016764705882352942: correct 57/3400
Epoch: 3, train_loss: 1.0756, train_clustering_loss:  0.4388, train_error: 0.3718
class 0: acc 0.6292134831460674, correct 56/89
class 1: acc 0.5, correct 36/72
class 2: acc 0.5652173913043478, correct 52/92
class 3: acc 0.7551020408163265, correct 74/98
class 4: acc 0.6621621621621622, correct 49/74

Val Set, val_loss: 1.1016, val_error: 0.3600, auc: 0.8677
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0075: correct 3/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.6, correct 15/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.300954 --> 1.101640).  Saving model ...


batch 19, loss: 0.8650, instance_loss: 0.4693, weighted_loss: 0.7463, label: 0, bag_size: 1579
batch 39, loss: 1.1926, instance_loss: 0.4413, weighted_loss: 0.9672, label: 1, bag_size: 754
batch 59, loss: 1.0946, instance_loss: 0.4844, weighted_loss: 0.9115, label: 0, bag_size: 255
batch 79, loss: 0.2828, instance_loss: 0.4407, weighted_loss: 0.3302, label: 3, bag_size: 791
batch 99, loss: 0.6563, instance_loss: 0.3999, weighted_loss: 0.5794, label: 2, bag_size: 1533
batch 119, loss: 0.7887, instance_loss: 0.3029, weighted_loss: 0.6430, label: 3, bag_size: 729
batch 139, loss: 1.1460, instance_loss: 0.4941, weighted_loss: 0.9505, label: 0, bag_size: 759
batch 159, loss: 1.8805, instance_loss: 0.6804, weighted_loss: 1.5205, label: 4, bag_size: 882
batch 179, loss: 0.9688, instance_loss: 0.4168, weighted_loss: 0.8032, label: 2, bag_size: 409
batch 199, loss: 1.8665, instance_loss: 0.5645, weighted_loss: 1.4759, label: 2, bag_size: 1180
batch 219, loss: 1.0794, instance_loss: 0.4838, weighted_loss: 0.9007, label: 0, bag_size: 1174
batch 239, loss: 0.7000, instance_loss: 0.4369, weighted_loss: 0.6211, label: 0, bag_size: 921
batch 259, loss: 0.3418, instance_loss: 0.2892, weighted_loss: 0.3260, label: 1, bag_size: 1277
batch 279, loss: 0.7284, instance_loss: 0.3580, weighted_loss: 0.6173, label: 2, bag_size: 1050
batch 299, loss: 0.6105, instance_loss: 0.3999, weighted_loss: 0.5474, label: 0, bag_size: 542
batch 319, loss: 1.2317, instance_loss: 0.4779, weighted_loss: 1.0055, label: 2, bag_size: 482
batch 339, loss: 2.9681, instance_loss: 0.5826, weighted_loss: 2.2524, label: 0, bag_size: 818
batch 359, loss: 0.8752, instance_loss: 0.4250, weighted_loss: 0.7401, label: 2, bag_size: 1006
batch 379, loss: 0.2436, instance_loss: 0.1816, weighted_loss: 0.2250, label: 3, bag_size: 1399
batch 399, loss: 0.1249, instance_loss: 0.1977, weighted_loss: 0.1468, label: 4, bag_size: 711
batch 419, loss: 0.8607, instance_loss: 0.4428, weighted_loss: 0.7353, label: 4, bag_size: 754


class 0 clustering acc 0.9981764705882353: correct 16969/17000
class 1 clustering acc 0.04764705882352941: correct 162/3400
Epoch: 4, train_loss: 0.9640, train_clustering_loss:  0.4205, train_error: 0.3294
class 0: acc 0.6875, correct 66/96
class 1: acc 0.5131578947368421, correct 39/76
class 2: acc 0.6372549019607843, correct 65/102
class 3: acc 0.7121212121212122, correct 47/66
class 4: acc 0.8, correct 68/85

Val Set, val_loss: 1.1220, val_error: 0.4400, auc: 0.8807
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.0225: correct 9/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.44, correct 11/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 3.2322, instance_loss: 0.8099, weighted_loss: 2.5055, label: 3, bag_size: 281
batch 39, loss: 1.0236, instance_loss: 0.4227, weighted_loss: 0.8433, label: 2, bag_size: 1197
batch 59, loss: 1.9813, instance_loss: 0.5119, weighted_loss: 1.5405, label: 1, bag_size: 1273
batch 79, loss: 0.5985, instance_loss: 0.3694, weighted_loss: 0.5298, label: 2, bag_size: 863
batch 99, loss: 0.7549, instance_loss: 0.4340, weighted_loss: 0.6586, label: 0, bag_size: 413
batch 119, loss: 0.4954, instance_loss: 0.3488, weighted_loss: 0.4514, label: 0, bag_size: 446
batch 139, loss: 1.4083, instance_loss: 0.5103, weighted_loss: 1.1389, label: 2, bag_size: 405
batch 159, loss: 1.1999, instance_loss: 0.5220, weighted_loss: 0.9966, label: 0, bag_size: 413
batch 179, loss: 0.7456, instance_loss: 0.4960, weighted_loss: 0.6707, label: 0, bag_size: 729
batch 199, loss: 1.4255, instance_loss: 0.5406, weighted_loss: 1.1600, label: 2, bag_size: 474
batch 219, loss: 0.3223, instance_loss: 0.4103, weighted_loss: 0.3487, label: 0, bag_size: 729
batch 239, loss: 0.4772, instance_loss: 0.2237, weighted_loss: 0.4012, label: 3, bag_size: 729
batch 259, loss: 1.6638, instance_loss: 0.4703, weighted_loss: 1.3057, label: 4, bag_size: 436
batch 279, loss: 0.6945, instance_loss: 0.3850, weighted_loss: 0.6016, label: 2, bag_size: 1155
batch 299, loss: 0.0820, instance_loss: 0.1134, weighted_loss: 0.0914, label: 3, bag_size: 729
batch 319, loss: 0.3439, instance_loss: 0.2962, weighted_loss: 0.3296, label: 4, bag_size: 729
batch 339, loss: 2.3068, instance_loss: 0.5831, weighted_loss: 1.7897, label: 1, bag_size: 786
batch 359, loss: 0.5434, instance_loss: 0.4692, weighted_loss: 0.5211, label: 0, bag_size: 1466
batch 379, loss: 0.5618, instance_loss: 0.2566, weighted_loss: 0.4703, label: 4, bag_size: 1121
batch 399, loss: 0.2607, instance_loss: 0.1781, weighted_loss: 0.2359, label: 3, bag_size: 729
batch 419, loss: 0.4452, instance_loss: 0.3003, weighted_loss: 0.4017, label: 4, bag_size: 817


class 0 clustering acc 0.9971764705882353: correct 16952/17000
class 1 clustering acc 0.12088235294117647: correct 411/3400
Epoch: 5, train_loss: 0.8823, train_clustering_loss:  0.3955, train_error: 0.2824
class 0: acc 0.7294117647058823, correct 62/85
class 1: acc 0.6493506493506493, correct 50/77
class 2: acc 0.6666666666666666, correct 60/90
class 3: acc 0.7619047619047619, correct 64/84
class 4: acc 0.7752808988764045, correct 69/89

Val Set, val_loss: 1.3409, val_error: 0.5400, auc: 0.8806
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.0575: correct 23/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.28, correct 7/25
class 3: acc 0.75, correct 3/4
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0635, instance_loss: 0.1212, weighted_loss: 0.0808, label: 3, bag_size: 451
batch 39, loss: 0.1442, instance_loss: 0.2994, weighted_loss: 0.1908, label: 1, bag_size: 1127
batch 59, loss: 0.1382, instance_loss: 0.1235, weighted_loss: 0.1338, label: 3, bag_size: 729
batch 79, loss: 0.6230, instance_loss: 0.4132, weighted_loss: 0.5601, label: 2, bag_size: 614
batch 99, loss: 0.1694, instance_loss: 0.1234, weighted_loss: 0.1556, label: 3, bag_size: 556
batch 119, loss: 0.5131, instance_loss: 0.2602, weighted_loss: 0.4372, label: 4, bag_size: 625
batch 139, loss: 0.5751, instance_loss: 0.3742, weighted_loss: 0.5148, label: 2, bag_size: 499
batch 159, loss: 0.6858, instance_loss: 0.4039, weighted_loss: 0.6012, label: 4, bag_size: 297
batch 179, loss: 0.7858, instance_loss: 0.4315, weighted_loss: 0.6795, label: 2, bag_size: 687
batch 199, loss: 0.1539, instance_loss: 0.1427, weighted_loss: 0.1505, label: 4, bag_size: 729
batch 219, loss: 0.4504, instance_loss: 0.3984, weighted_loss: 0.4348, label: 4, bag_size: 656
batch 239, loss: 0.1268, instance_loss: 0.1010, weighted_loss: 0.1190, label: 3, bag_size: 729
batch 259, loss: 2.1766, instance_loss: 0.7201, weighted_loss: 1.7396, label: 2, bag_size: 1439
batch 279, loss: 0.5020, instance_loss: 0.3017, weighted_loss: 0.4419, label: 2, bag_size: 247
batch 299, loss: 0.8657, instance_loss: 0.4326, weighted_loss: 0.7358, label: 0, bag_size: 294
batch 319, loss: 0.4826, instance_loss: 0.3188, weighted_loss: 0.4334, label: 2, bag_size: 935
batch 339, loss: 0.2146, instance_loss: 0.2141, weighted_loss: 0.2144, label: 4, bag_size: 729
batch 359, loss: 1.1514, instance_loss: 0.4992, weighted_loss: 0.9558, label: 2, bag_size: 1006
batch 379, loss: 0.5698, instance_loss: 0.3658, weighted_loss: 0.5086, label: 4, bag_size: 297
batch 399, loss: 0.7393, instance_loss: 0.4673, weighted_loss: 0.6577, label: 0, bag_size: 1196
batch 419, loss: 0.2025, instance_loss: 0.1217, weighted_loss: 0.1783, label: 3, bag_size: 729


class 0 clustering acc 0.9960588235294118: correct 16933/17000
class 1 clustering acc 0.215: correct 731/3400
Epoch: 6, train_loss: 0.7204, train_clustering_loss:  0.3651, train_error: 0.2541
class 0: acc 0.8309859154929577, correct 59/71
class 1: acc 0.5308641975308642, correct 43/81
class 2: acc 0.6395348837209303, correct 55/86
class 3: acc 0.7912087912087912, correct 72/91
class 4: acc 0.9166666666666666, correct 88/96

Val Set, val_loss: 1.0230, val_error: 0.4000, auc: 0.8607
class 0 clustering acc 0.9935: correct 1987/2000
class 1 clustering acc 0.0475: correct 19/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.56, correct 14/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.101640 --> 1.023038).  Saving model ...


batch 19, loss: 1.0546, instance_loss: 0.5039, weighted_loss: 0.8894, label: 2, bag_size: 317
batch 39, loss: 0.1322, instance_loss: 0.1493, weighted_loss: 0.1373, label: 3, bag_size: 729
batch 59, loss: 0.2529, instance_loss: 0.2964, weighted_loss: 0.2659, label: 0, bag_size: 933
batch 79, loss: 1.0608, instance_loss: 0.5409, weighted_loss: 0.9048, label: 1, bag_size: 293
batch 99, loss: 0.6569, instance_loss: 0.4691, weighted_loss: 0.6006, label: 0, bag_size: 524
batch 119, loss: 1.3098, instance_loss: 0.6104, weighted_loss: 1.1000, label: 2, bag_size: 358
batch 139, loss: 0.4204, instance_loss: 0.1414, weighted_loss: 0.3367, label: 3, bag_size: 729
batch 159, loss: 0.3663, instance_loss: 0.3174, weighted_loss: 0.3516, label: 2, bag_size: 270
batch 179, loss: 0.1169, instance_loss: 0.1765, weighted_loss: 0.1348, label: 4, bag_size: 974
batch 199, loss: 0.7445, instance_loss: 0.4582, weighted_loss: 0.6586, label: 2, bag_size: 638
batch 219, loss: 1.3551, instance_loss: 0.5304, weighted_loss: 1.1077, label: 3, bag_size: 706
batch 239, loss: 0.5913, instance_loss: 0.3776, weighted_loss: 0.5272, label: 0, bag_size: 476
batch 259, loss: 0.0884, instance_loss: 0.0534, weighted_loss: 0.0779, label: 3, bag_size: 405
batch 279, loss: 0.8619, instance_loss: 0.4161, weighted_loss: 0.7282, label: 1, bag_size: 860
batch 299, loss: 0.6089, instance_loss: 0.3746, weighted_loss: 0.5386, label: 4, bag_size: 773
batch 319, loss: 0.8795, instance_loss: 0.4292, weighted_loss: 0.7444, label: 4, bag_size: 1360
batch 339, loss: 1.7870, instance_loss: 0.5307, weighted_loss: 1.4101, label: 1, bag_size: 1273
batch 359, loss: 0.0813, instance_loss: 0.1580, weighted_loss: 0.1043, label: 4, bag_size: 1002
batch 379, loss: 0.2291, instance_loss: 0.2231, weighted_loss: 0.2273, label: 4, bag_size: 297
batch 399, loss: 0.0460, instance_loss: 0.1283, weighted_loss: 0.0707, label: 4, bag_size: 388
batch 419, loss: 0.4008, instance_loss: 0.2815, weighted_loss: 0.3650, label: 1, bag_size: 847


class 0 clustering acc 0.9972352941176471: correct 16953/17000
class 1 clustering acc 0.19588235294117648: correct 666/3400
Epoch: 7, train_loss: 0.7178, train_clustering_loss:  0.3645, train_error: 0.2494
class 0: acc 0.7710843373493976, correct 64/83
class 1: acc 0.6363636363636364, correct 56/88
class 2: acc 0.7029702970297029, correct 71/101
class 3: acc 0.8873239436619719, correct 63/71
class 4: acc 0.7926829268292683, correct 65/82

Val Set, val_loss: 0.8671, val_error: 0.2600, auc: 0.8809
class 0 clustering acc 0.997: correct 1994/2000
class 1 clustering acc 0.0575: correct 23/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.8, correct 20/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.023038 --> 0.867109).  Saving model ...


batch 19, loss: 0.1862, instance_loss: 0.3697, weighted_loss: 0.2412, label: 4, bag_size: 656
batch 39, loss: 0.2572, instance_loss: 0.2232, weighted_loss: 0.2470, label: 2, bag_size: 935
batch 59, loss: 1.3475, instance_loss: 0.5375, weighted_loss: 1.1045, label: 2, bag_size: 307
batch 79, loss: 0.3337, instance_loss: 0.5985, weighted_loss: 0.4131, label: 4, bag_size: 663
batch 99, loss: 0.1092, instance_loss: 0.0987, weighted_loss: 0.1060, label: 3, bag_size: 729
batch 119, loss: 0.7478, instance_loss: 0.4077, weighted_loss: 0.6458, label: 2, bag_size: 878
batch 139, loss: 0.5127, instance_loss: 0.3998, weighted_loss: 0.4788, label: 1, bag_size: 913
batch 159, loss: 0.0655, instance_loss: 0.0483, weighted_loss: 0.0604, label: 3, bag_size: 556
batch 179, loss: 1.6133, instance_loss: 0.4774, weighted_loss: 1.2725, label: 4, bag_size: 436
batch 199, loss: 0.7721, instance_loss: 0.4277, weighted_loss: 0.6688, label: 2, bag_size: 204
batch 219, loss: 0.6602, instance_loss: 0.3679, weighted_loss: 0.5725, label: 1, bag_size: 614
batch 239, loss: 0.0166, instance_loss: 0.0411, weighted_loss: 0.0239, label: 3, bag_size: 1291
batch 259, loss: 0.1396, instance_loss: 0.2581, weighted_loss: 0.1751, label: 4, bag_size: 729
batch 279, loss: 0.2823, instance_loss: 0.3110, weighted_loss: 0.2909, label: 1, bag_size: 828
batch 299, loss: 0.2374, instance_loss: 0.3047, weighted_loss: 0.2576, label: 4, bag_size: 773
batch 319, loss: 1.3869, instance_loss: 0.5016, weighted_loss: 1.1213, label: 2, bag_size: 474
batch 339, loss: 0.9065, instance_loss: 0.4778, weighted_loss: 0.7779, label: 3, bag_size: 706
batch 359, loss: 0.0390, instance_loss: 0.0449, weighted_loss: 0.0408, label: 3, bag_size: 405
batch 379, loss: 2.3351, instance_loss: 0.6787, weighted_loss: 1.8382, label: 1, bag_size: 446
batch 399, loss: 2.5548, instance_loss: 0.7634, weighted_loss: 2.0174, label: 1, bag_size: 700
batch 419, loss: 2.3109, instance_loss: 0.5855, weighted_loss: 1.7933, label: 2, bag_size: 511


class 0 clustering acc 0.9951764705882353: correct 16918/17000
class 1 clustering acc 0.22970588235294118: correct 781/3400
Epoch: 8, train_loss: 0.6519, train_clustering_loss:  0.3594, train_error: 0.2541
class 0: acc 0.7894736842105263, correct 75/95
class 1: acc 0.5694444444444444, correct 41/72
class 2: acc 0.65, correct 52/80
class 3: acc 0.8315789473684211, correct 79/95
class 4: acc 0.8433734939759037, correct 70/83

Val Set, val_loss: 1.0940, val_error: 0.4400, auc: 0.8624
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.075: correct 30/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.44, correct 11/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1651, instance_loss: 0.3478, weighted_loss: 0.2199, label: 4, bag_size: 1474
batch 39, loss: 0.0911, instance_loss: 0.2353, weighted_loss: 0.1343, label: 0, bag_size: 385
batch 59, loss: 0.1747, instance_loss: 0.4142, weighted_loss: 0.2466, label: 3, bag_size: 230
batch 79, loss: 0.4239, instance_loss: 0.4046, weighted_loss: 0.4181, label: 2, bag_size: 405
batch 99, loss: 0.6439, instance_loss: 0.4378, weighted_loss: 0.5821, label: 4, bag_size: 675
batch 119, loss: 0.6389, instance_loss: 0.4404, weighted_loss: 0.5793, label: 3, bag_size: 200
batch 139, loss: 0.4692, instance_loss: 0.3318, weighted_loss: 0.4280, label: 2, bag_size: 455
batch 159, loss: 0.5222, instance_loss: 0.2923, weighted_loss: 0.4532, label: 3, bag_size: 305
batch 179, loss: 0.6115, instance_loss: 0.3960, weighted_loss: 0.5468, label: 2, bag_size: 247
batch 199, loss: 0.8761, instance_loss: 0.5554, weighted_loss: 0.7799, label: 2, bag_size: 2703
batch 219, loss: 0.1347, instance_loss: 0.1639, weighted_loss: 0.1434, label: 4, bag_size: 729
batch 239, loss: 0.0658, instance_loss: 0.1776, weighted_loss: 0.0993, label: 4, bag_size: 1278
batch 259, loss: 0.7962, instance_loss: 0.5600, weighted_loss: 0.7254, label: 1, bag_size: 319
batch 279, loss: 1.3655, instance_loss: 0.5151, weighted_loss: 1.1104, label: 1, bag_size: 308
batch 299, loss: 0.0150, instance_loss: 0.0929, weighted_loss: 0.0384, label: 4, bag_size: 729
batch 319, loss: 1.9315, instance_loss: 0.6716, weighted_loss: 1.5535, label: 1, bag_size: 386
batch 339, loss: 4.5595, instance_loss: 0.9164, weighted_loss: 3.4666, label: 0, bag_size: 818
batch 359, loss: 1.7370, instance_loss: 0.5687, weighted_loss: 1.3865, label: 2, bag_size: 1006
batch 379, loss: 0.1400, instance_loss: 0.2463, weighted_loss: 0.1719, label: 0, bag_size: 524
batch 399, loss: 0.0476, instance_loss: 0.2218, weighted_loss: 0.0999, label: 3, bag_size: 729
batch 419, loss: 0.9611, instance_loss: 0.4105, weighted_loss: 0.7959, label: 2, bag_size: 684


class 0 clustering acc 0.9948823529411764: correct 16913/17000
class 1 clustering acc 0.21470588235294116: correct 730/3400
Epoch: 9, train_loss: 0.6520, train_clustering_loss:  0.3627, train_error: 0.2259
class 0: acc 0.8, correct 64/80
class 1: acc 0.6808510638297872, correct 64/94
class 2: acc 0.6781609195402298, correct 59/87
class 3: acc 0.8311688311688312, correct 64/77
class 4: acc 0.896551724137931, correct 78/87

Val Set, val_loss: 1.1283, val_error: 0.4800, auc: 0.8543
class 0 clustering acc 0.9905: correct 1981/2000
class 1 clustering acc 0.085: correct 34/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.36, correct 9/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.8269, instance_loss: 0.6524, weighted_loss: 1.4745, label: 1, bag_size: 269
batch 39, loss: 0.5586, instance_loss: 0.3964, weighted_loss: 0.5100, label: 2, bag_size: 774
batch 59, loss: 0.0412, instance_loss: 0.0395, weighted_loss: 0.0407, label: 3, bag_size: 405
batch 79, loss: 0.0562, instance_loss: 0.1351, weighted_loss: 0.0799, label: 4, bag_size: 729
batch 99, loss: 0.0488, instance_loss: 0.2219, weighted_loss: 0.1007, label: 0, bag_size: 729
batch 119, loss: 0.1513, instance_loss: 0.1517, weighted_loss: 0.1514, label: 3, bag_size: 821
batch 139, loss: 0.2645, instance_loss: 0.2733, weighted_loss: 0.2671, label: 1, bag_size: 913
batch 159, loss: 0.3423, instance_loss: 0.5310, weighted_loss: 0.3989, label: 1, bag_size: 1172
batch 179, loss: 0.4665, instance_loss: 0.2106, weighted_loss: 0.3897, label: 4, bag_size: 1121
batch 199, loss: 0.4829, instance_loss: 0.6163, weighted_loss: 0.5229, label: 3, bag_size: 1167
batch 219, loss: 2.8183, instance_loss: 0.7069, weighted_loss: 2.1849, label: 3, bag_size: 281
batch 239, loss: 0.1192, instance_loss: 0.1320, weighted_loss: 0.1230, label: 1, bag_size: 286
batch 259, loss: 0.8095, instance_loss: 0.4445, weighted_loss: 0.7000, label: 2, bag_size: 986
batch 279, loss: 0.0491, instance_loss: 0.0971, weighted_loss: 0.0635, label: 3, bag_size: 729
batch 299, loss: 0.6448, instance_loss: 0.4619, weighted_loss: 0.5900, label: 2, bag_size: 1617
batch 319, loss: 0.1892, instance_loss: 0.2135, weighted_loss: 0.1965, label: 0, bag_size: 602
batch 339, loss: 0.7451, instance_loss: 0.4391, weighted_loss: 0.6533, label: 2, bag_size: 1653
batch 359, loss: 0.3356, instance_loss: 0.3526, weighted_loss: 0.3407, label: 1, bag_size: 1255
batch 379, loss: 0.3155, instance_loss: 0.4665, weighted_loss: 0.3608, label: 3, bag_size: 1167
batch 399, loss: 0.2962, instance_loss: 0.3028, weighted_loss: 0.2982, label: 2, bag_size: 1053
batch 419, loss: 0.3011, instance_loss: 0.3283, weighted_loss: 0.3093, label: 1, bag_size: 696


class 0 clustering acc 0.9937058823529412: correct 16893/17000
class 1 clustering acc 0.2626470588235294: correct 893/3400
Epoch: 10, train_loss: 0.5571, train_clustering_loss:  0.3428, train_error: 0.1906
class 0: acc 0.9120879120879121, correct 83/91
class 1: acc 0.6808510638297872, correct 64/94
class 2: acc 0.7011494252873564, correct 61/87
class 3: acc 0.8717948717948718, correct 68/78
class 4: acc 0.9066666666666666, correct 68/75

Val Set, val_loss: 1.2047, val_error: 0.4600, auc: 0.8504
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.0875: correct 35/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.44, correct 11/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0315, instance_loss: 0.1148, weighted_loss: 0.0565, label: 4, bag_size: 524
batch 39, loss: 0.0182, instance_loss: 0.0791, weighted_loss: 0.0364, label: 4, bag_size: 764
batch 59, loss: 0.1552, instance_loss: 0.1533, weighted_loss: 0.1546, label: 0, bag_size: 446
batch 79, loss: 0.0822, instance_loss: 0.1149, weighted_loss: 0.0920, label: 0, bag_size: 518
batch 99, loss: 2.4248, instance_loss: 0.4972, weighted_loss: 1.8465, label: 3, bag_size: 1380
batch 119, loss: 0.4436, instance_loss: 0.3690, weighted_loss: 0.4212, label: 1, bag_size: 690
batch 139, loss: 0.6238, instance_loss: 0.3402, weighted_loss: 0.5387, label: 1, bag_size: 598
batch 159, loss: 0.3560, instance_loss: 0.3289, weighted_loss: 0.3479, label: 2, bag_size: 499
batch 179, loss: 0.0642, instance_loss: 0.2129, weighted_loss: 0.1088, label: 4, bag_size: 1002
batch 199, loss: 0.0321, instance_loss: 0.3254, weighted_loss: 0.1201, label: 4, bag_size: 1357
batch 219, loss: 3.2292, instance_loss: 0.8606, weighted_loss: 2.5186, label: 2, bag_size: 511
batch 239, loss: 0.1747, instance_loss: 0.1896, weighted_loss: 0.1792, label: 1, bag_size: 1086
batch 259, loss: 3.4040, instance_loss: 0.6616, weighted_loss: 2.5813, label: 0, bag_size: 282
batch 279, loss: 0.2783, instance_loss: 0.3222, weighted_loss: 0.2914, label: 2, bag_size: 400
batch 299, loss: 0.6264, instance_loss: 0.6256, weighted_loss: 0.6262, label: 3, bag_size: 630
batch 319, loss: 0.0076, instance_loss: 0.1315, weighted_loss: 0.0448, label: 4, bag_size: 729
batch 339, loss: 0.3273, instance_loss: 0.4803, weighted_loss: 0.3732, label: 4, bag_size: 754
batch 359, loss: 0.4845, instance_loss: 0.3408, weighted_loss: 0.4414, label: 2, bag_size: 525
batch 379, loss: 0.7955, instance_loss: 0.3296, weighted_loss: 0.6557, label: 0, bag_size: 1190
batch 399, loss: 0.0483, instance_loss: 0.1053, weighted_loss: 0.0654, label: 0, bag_size: 402
batch 419, loss: 0.5633, instance_loss: 0.3471, weighted_loss: 0.4984, label: 0, bag_size: 759


class 0 clustering acc 0.9897058823529412: correct 16825/17000
class 1 clustering acc 0.3185294117647059: correct 1083/3400
Epoch: 11, train_loss: 0.5960, train_clustering_loss:  0.3506, train_error: 0.2000
class 0: acc 0.8952380952380953, correct 94/105
class 1: acc 0.6976744186046512, correct 60/86
class 2: acc 0.6351351351351351, correct 47/74
class 3: acc 0.8243243243243243, correct 61/74
class 4: acc 0.9069767441860465, correct 78/86

Val Set, val_loss: 1.0380, val_error: 0.3800, auc: 0.8652
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.12: correct 48/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8974, instance_loss: 0.5017, weighted_loss: 0.7787, label: 2, bag_size: 307
batch 39, loss: 2.6042, instance_loss: 0.6649, weighted_loss: 2.0224, label: 3, bag_size: 281
batch 59, loss: 0.5788, instance_loss: 0.3329, weighted_loss: 0.5050, label: 1, bag_size: 598
batch 79, loss: 0.7608, instance_loss: 0.5675, weighted_loss: 0.7028, label: 2, bag_size: 537
batch 99, loss: 0.4331, instance_loss: 0.3552, weighted_loss: 0.4097, label: 1, bag_size: 1096
batch 119, loss: 0.0633, instance_loss: 0.2168, weighted_loss: 0.1094, label: 3, bag_size: 936
batch 139, loss: 2.4685, instance_loss: 0.6665, weighted_loss: 1.9279, label: 1, bag_size: 386
batch 159, loss: 0.1684, instance_loss: 0.1447, weighted_loss: 0.1613, label: 3, bag_size: 729
batch 179, loss: 0.0631, instance_loss: 0.1292, weighted_loss: 0.0829, label: 0, bag_size: 382
batch 199, loss: 0.3415, instance_loss: 0.2758, weighted_loss: 0.3218, label: 1, bag_size: 897
batch 219, loss: 1.6864, instance_loss: 0.4055, weighted_loss: 1.3021, label: 0, bag_size: 410
batch 239, loss: 0.4206, instance_loss: 0.4406, weighted_loss: 0.4266, label: 2, bag_size: 324
batch 259, loss: 0.8948, instance_loss: 0.6946, weighted_loss: 0.8348, label: 3, bag_size: 607
batch 279, loss: 0.0124, instance_loss: 0.2293, weighted_loss: 0.0775, label: 3, bag_size: 791
batch 299, loss: 0.3657, instance_loss: 0.3631, weighted_loss: 0.3649, label: 3, bag_size: 200
batch 319, loss: 1.2738, instance_loss: 0.6058, weighted_loss: 1.0734, label: 2, bag_size: 471
batch 339, loss: 0.0406, instance_loss: 0.0715, weighted_loss: 0.0499, label: 3, bag_size: 729
batch 359, loss: 0.3154, instance_loss: 0.3479, weighted_loss: 0.3251, label: 0, bag_size: 371
batch 379, loss: 0.2421, instance_loss: 0.2881, weighted_loss: 0.2559, label: 2, bag_size: 913
batch 399, loss: 0.2333, instance_loss: 0.2276, weighted_loss: 0.2316, label: 0, bag_size: 371
batch 419, loss: 0.5090, instance_loss: 0.3460, weighted_loss: 0.4601, label: 2, bag_size: 614


class 0 clustering acc 0.9937058823529412: correct 16893/17000
class 1 clustering acc 0.33441176470588235: correct 1137/3400
Epoch: 12, train_loss: 0.5180, train_clustering_loss:  0.3323, train_error: 0.1859
class 0: acc 0.8736842105263158, correct 83/95
class 1: acc 0.7254901960784313, correct 74/102
class 2: acc 0.6111111111111112, correct 44/72
class 3: acc 0.9302325581395349, correct 80/86
class 4: acc 0.9285714285714286, correct 65/70

Val Set, val_loss: 1.2388, val_error: 0.4600, auc: 0.8467
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.1375: correct 55/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.36, correct 9/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0176, instance_loss: 0.1063, weighted_loss: 0.0442, label: 3, bag_size: 729
batch 39, loss: 0.4734, instance_loss: 0.4979, weighted_loss: 0.4807, label: 2, bag_size: 391
batch 59, loss: 0.4466, instance_loss: 0.2671, weighted_loss: 0.3928, label: 1, bag_size: 1402
batch 79, loss: 0.0035, instance_loss: 0.1225, weighted_loss: 0.0392, label: 4, bag_size: 729
batch 99, loss: 0.0398, instance_loss: 0.1436, weighted_loss: 0.0709, label: 3, bag_size: 729
batch 119, loss: 0.1061, instance_loss: 0.3072, weighted_loss: 0.1665, label: 4, bag_size: 675
batch 139, loss: 0.6024, instance_loss: 0.3891, weighted_loss: 0.5384, label: 2, bag_size: 408
batch 159, loss: 0.0081, instance_loss: 0.2567, weighted_loss: 0.0827, label: 4, bag_size: 1357
batch 179, loss: 0.0063, instance_loss: 0.0584, weighted_loss: 0.0219, label: 4, bag_size: 646
batch 199, loss: 0.2397, instance_loss: 0.5086, weighted_loss: 0.3204, label: 3, bag_size: 1167
batch 219, loss: 0.2247, instance_loss: 0.1858, weighted_loss: 0.2130, label: 1, bag_size: 369
batch 239, loss: 0.0065, instance_loss: 0.0570, weighted_loss: 0.0216, label: 4, bag_size: 729
batch 259, loss: 0.7254, instance_loss: 0.4686, weighted_loss: 0.6483, label: 0, bag_size: 1061
batch 279, loss: 0.0155, instance_loss: 0.0488, weighted_loss: 0.0255, label: 3, bag_size: 729
batch 299, loss: 0.0311, instance_loss: 0.5667, weighted_loss: 0.1918, label: 4, bag_size: 882
batch 319, loss: 0.0691, instance_loss: 0.2702, weighted_loss: 0.1294, label: 4, bag_size: 675
batch 339, loss: 0.2412, instance_loss: 0.3704, weighted_loss: 0.2799, label: 3, bag_size: 200
batch 359, loss: 0.0457, instance_loss: 0.5466, weighted_loss: 0.1960, label: 1, bag_size: 1152
batch 379, loss: 0.0016, instance_loss: 0.0671, weighted_loss: 0.0213, label: 4, bag_size: 1235
batch 399, loss: 0.1519, instance_loss: 0.2274, weighted_loss: 0.1746, label: 2, bag_size: 323
batch 419, loss: 0.8933, instance_loss: 0.4634, weighted_loss: 0.7643, label: 2, bag_size: 869


class 0 clustering acc 0.9920588235294118: correct 16865/17000
class 1 clustering acc 0.32088235294117645: correct 1091/3400
Epoch: 13, train_loss: 0.5186, train_clustering_loss:  0.3349, train_error: 0.1788
class 0: acc 0.8421052631578947, correct 64/76
class 1: acc 0.7160493827160493, correct 58/81
class 2: acc 0.7368421052631579, correct 70/95
class 3: acc 0.9102564102564102, correct 71/78
class 4: acc 0.9052631578947369, correct 86/95

Val Set, val_loss: 1.0034, val_error: 0.4400, auc: 0.8421
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.135: correct 54/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8528, instance_loss: 0.4183, weighted_loss: 0.7225, label: 3, bag_size: 305
batch 39, loss: 0.3999, instance_loss: 0.4519, weighted_loss: 0.4155, label: 3, bag_size: 706
batch 59, loss: 0.2597, instance_loss: 0.2557, weighted_loss: 0.2585, label: 1, bag_size: 288
batch 79, loss: 0.2485, instance_loss: 0.3188, weighted_loss: 0.2696, label: 1, bag_size: 405
batch 99, loss: 0.1208, instance_loss: 0.1793, weighted_loss: 0.1384, label: 1, bag_size: 1191
batch 119, loss: 0.0159, instance_loss: 0.1586, weighted_loss: 0.0587, label: 4, bag_size: 729
batch 139, loss: 0.0826, instance_loss: 0.0940, weighted_loss: 0.0860, label: 4, bag_size: 729
batch 159, loss: 0.1423, instance_loss: 0.2393, weighted_loss: 0.1714, label: 3, bag_size: 230
batch 179, loss: 0.0457, instance_loss: 0.5448, weighted_loss: 0.1954, label: 4, bag_size: 754
batch 199, loss: 1.2974, instance_loss: 0.6304, weighted_loss: 1.0973, label: 3, bag_size: 281
batch 219, loss: 0.8528, instance_loss: 0.4461, weighted_loss: 0.7308, label: 2, bag_size: 1197
batch 239, loss: 0.0699, instance_loss: 0.1985, weighted_loss: 0.1085, label: 0, bag_size: 976
batch 259, loss: 0.3906, instance_loss: 0.3115, weighted_loss: 0.3669, label: 0, bag_size: 1332
batch 279, loss: 0.1494, instance_loss: 0.2134, weighted_loss: 0.1686, label: 0, bag_size: 371
batch 299, loss: 0.3308, instance_loss: 0.1944, weighted_loss: 0.2899, label: 3, bag_size: 729
batch 319, loss: 0.0299, instance_loss: 0.0709, weighted_loss: 0.0422, label: 3, bag_size: 729
batch 339, loss: 1.8777, instance_loss: 0.5783, weighted_loss: 1.4879, label: 2, bag_size: 629
batch 359, loss: 1.4013, instance_loss: 0.6081, weighted_loss: 1.1634, label: 2, bag_size: 959
batch 379, loss: 0.4665, instance_loss: 0.2867, weighted_loss: 0.4125, label: 1, bag_size: 869
batch 399, loss: 1.1324, instance_loss: 0.4962, weighted_loss: 0.9415, label: 1, bag_size: 535
batch 419, loss: 0.0868, instance_loss: 0.1777, weighted_loss: 0.1141, label: 3, bag_size: 729


class 0 clustering acc 0.9936470588235294: correct 16892/17000
class 1 clustering acc 0.3432352941176471: correct 1167/3400
Epoch: 14, train_loss: 0.4595, train_clustering_loss:  0.3223, train_error: 0.1600
class 0: acc 0.8518518518518519, correct 69/81
class 1: acc 0.7261904761904762, correct 61/84
class 2: acc 0.7558139534883721, correct 65/86
class 3: acc 0.9066666666666666, correct 68/75
class 4: acc 0.9494949494949495, correct 94/99

Val Set, val_loss: 1.0813, val_error: 0.4200, auc: 0.8431
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.155: correct 62/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0277, instance_loss: 0.0771, weighted_loss: 0.0425, label: 0, bag_size: 1466
batch 39, loss: 0.5598, instance_loss: 0.3403, weighted_loss: 0.4940, label: 4, bag_size: 817
batch 59, loss: 0.1547, instance_loss: 0.1975, weighted_loss: 0.1675, label: 1, bag_size: 886
batch 79, loss: 0.5740, instance_loss: 0.3399, weighted_loss: 0.5037, label: 0, bag_size: 437
batch 99, loss: 0.4444, instance_loss: 0.3319, weighted_loss: 0.4106, label: 1, bag_size: 847
batch 119, loss: 0.2738, instance_loss: 0.3725, weighted_loss: 0.3034, label: 1, bag_size: 1014
batch 139, loss: 0.1309, instance_loss: 0.2663, weighted_loss: 0.1715, label: 1, bag_size: 614
batch 159, loss: 0.1087, instance_loss: 0.2179, weighted_loss: 0.1414, label: 0, bag_size: 1101
batch 179, loss: 0.0457, instance_loss: 0.2384, weighted_loss: 0.1035, label: 1, bag_size: 318
batch 199, loss: 1.1712, instance_loss: 0.5039, weighted_loss: 0.9710, label: 2, bag_size: 1006
batch 219, loss: 0.0117, instance_loss: 0.0465, weighted_loss: 0.0222, label: 0, bag_size: 898
batch 239, loss: 0.0275, instance_loss: 0.0823, weighted_loss: 0.0440, label: 1, bag_size: 1239
batch 259, loss: 0.1232, instance_loss: 0.6088, weighted_loss: 0.2689, label: 4, bag_size: 663
batch 279, loss: 2.5821, instance_loss: 0.6981, weighted_loss: 2.0169, label: 2, bag_size: 732
batch 299, loss: 0.8268, instance_loss: 0.5472, weighted_loss: 0.7429, label: 3, bag_size: 671
batch 319, loss: 0.0160, instance_loss: 0.1847, weighted_loss: 0.0666, label: 4, bag_size: 729
batch 339, loss: 0.0332, instance_loss: 0.1080, weighted_loss: 0.0557, label: 0, bag_size: 239
batch 359, loss: 0.0076, instance_loss: 0.1066, weighted_loss: 0.0373, label: 4, bag_size: 636
batch 379, loss: 0.0508, instance_loss: 0.0724, weighted_loss: 0.0573, label: 3, bag_size: 729
batch 399, loss: 0.1760, instance_loss: 0.3169, weighted_loss: 0.2183, label: 2, bag_size: 461
batch 419, loss: 0.0654, instance_loss: 0.0417, weighted_loss: 0.0583, label: 3, bag_size: 405


class 0 clustering acc 0.9906470588235294: correct 16841/17000
class 1 clustering acc 0.3876470588235294: correct 1318/3400
Epoch: 15, train_loss: 0.4739, train_clustering_loss:  0.3170, train_error: 0.1671
class 0: acc 0.9404761904761905, correct 79/84
class 1: acc 0.7159090909090909, correct 63/88
class 2: acc 0.6625, correct 53/80
class 3: acc 0.8941176470588236, correct 76/85
class 4: acc 0.9431818181818182, correct 83/88

Val Set, val_loss: 1.0242, val_error: 0.3800, auc: 0.8515
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.1575: correct 63/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.56, correct 14/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.8740, instance_loss: 0.4076, weighted_loss: 0.7341, label: 0, bag_size: 545
batch 39, loss: 0.2709, instance_loss: 0.4708, weighted_loss: 0.3309, label: 1, bag_size: 648
batch 59, loss: 1.4326, instance_loss: 0.6322, weighted_loss: 1.1925, label: 2, bag_size: 1348
batch 79, loss: 0.0059, instance_loss: 0.0999, weighted_loss: 0.0341, label: 4, bag_size: 729
batch 99, loss: 0.5791, instance_loss: 0.3641, weighted_loss: 0.5146, label: 0, bag_size: 200
batch 119, loss: 0.1645, instance_loss: 0.2604, weighted_loss: 0.1933, label: 2, bag_size: 682
batch 139, loss: 0.1100, instance_loss: 0.2134, weighted_loss: 0.1410, label: 2, bag_size: 400
batch 159, loss: 0.5556, instance_loss: 0.3910, weighted_loss: 0.5062, label: 2, bag_size: 204
batch 179, loss: 0.1132, instance_loss: 0.1729, weighted_loss: 0.1311, label: 1, bag_size: 944
batch 199, loss: 1.5692, instance_loss: 0.5264, weighted_loss: 1.2563, label: 1, bag_size: 1144
batch 219, loss: 0.1513, instance_loss: 0.1243, weighted_loss: 0.1432, label: 3, bag_size: 729
batch 239, loss: 0.0258, instance_loss: 0.1686, weighted_loss: 0.0686, label: 4, bag_size: 729
batch 259, loss: 0.1298, instance_loss: 0.0749, weighted_loss: 0.1133, label: 3, bag_size: 556
batch 279, loss: 0.0561, instance_loss: 0.1414, weighted_loss: 0.0817, label: 0, bag_size: 524
batch 299, loss: 0.2589, instance_loss: 0.4850, weighted_loss: 0.3267, label: 1, bag_size: 442
batch 319, loss: 0.7931, instance_loss: 0.4801, weighted_loss: 0.6992, label: 4, bag_size: 1360
batch 339, loss: 1.8464, instance_loss: 0.5824, weighted_loss: 1.4672, label: 4, bag_size: 436
batch 359, loss: 1.9220, instance_loss: 0.6220, weighted_loss: 1.5320, label: 4, bag_size: 511
batch 379, loss: 0.2501, instance_loss: 0.2270, weighted_loss: 0.2432, label: 0, bag_size: 367
batch 399, loss: 0.2370, instance_loss: 0.2586, weighted_loss: 0.2435, label: 1, bag_size: 346
batch 419, loss: 0.0709, instance_loss: 0.0843, weighted_loss: 0.0749, label: 3, bag_size: 729


class 0 clustering acc 0.9915294117647059: correct 16856/17000
class 1 clustering acc 0.33676470588235297: correct 1145/3400
Epoch: 16, train_loss: 0.4643, train_clustering_loss:  0.3287, train_error: 0.1624
class 0: acc 0.8433734939759037, correct 70/83
class 1: acc 0.6867469879518072, correct 57/83
class 2: acc 0.8137254901960784, correct 83/102
class 3: acc 0.9402985074626866, correct 63/67
class 4: acc 0.9222222222222223, correct 83/90

Val Set, val_loss: 1.1712, val_error: 0.4600, auc: 0.8318
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.16: correct 64/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.4, correct 10/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1001, instance_loss: 0.1475, weighted_loss: 0.1143, label: 0, bag_size: 476
batch 39, loss: 0.0433, instance_loss: 0.2245, weighted_loss: 0.0976, label: 3, bag_size: 936
batch 59, loss: 0.5316, instance_loss: 0.3926, weighted_loss: 0.4899, label: 2, bag_size: 1306
batch 79, loss: 0.4633, instance_loss: 0.3803, weighted_loss: 0.4384, label: 2, bag_size: 409
batch 99, loss: 0.3398, instance_loss: 0.3217, weighted_loss: 0.3343, label: 0, bag_size: 1174
batch 119, loss: 1.0443, instance_loss: 0.5304, weighted_loss: 0.8902, label: 0, bag_size: 1065
batch 139, loss: 0.4398, instance_loss: 0.4804, weighted_loss: 0.4520, label: 2, bag_size: 1215
batch 159, loss: 0.0164, instance_loss: 0.1209, weighted_loss: 0.0477, label: 4, bag_size: 729
batch 179, loss: 2.3066, instance_loss: 0.6096, weighted_loss: 1.7975, label: 2, bag_size: 1006
batch 199, loss: 0.0652, instance_loss: 0.2454, weighted_loss: 0.1192, label: 1, bag_size: 1086
batch 219, loss: 1.3086, instance_loss: 0.5012, weighted_loss: 1.0664, label: 2, bag_size: 684
batch 239, loss: 0.5200, instance_loss: 0.4235, weighted_loss: 0.4910, label: 2, bag_size: 1024
batch 259, loss: 1.2941, instance_loss: 0.4183, weighted_loss: 1.0313, label: 4, bag_size: 297
batch 279, loss: 1.0008, instance_loss: 0.5878, weighted_loss: 0.8769, label: 2, bag_size: 1259
batch 299, loss: 0.4230, instance_loss: 0.3602, weighted_loss: 0.4041, label: 2, bag_size: 469
batch 319, loss: 0.1294, instance_loss: 0.1497, weighted_loss: 0.1355, label: 0, bag_size: 385
batch 339, loss: 0.2818, instance_loss: 0.2665, weighted_loss: 0.2772, label: 0, bag_size: 729
batch 359, loss: 1.0844, instance_loss: 0.3616, weighted_loss: 0.8675, label: 2, bag_size: 701
batch 379, loss: 1.0913, instance_loss: 0.5194, weighted_loss: 0.9197, label: 4, bag_size: 511
batch 399, loss: 0.3581, instance_loss: 0.3794, weighted_loss: 0.3644, label: 2, bag_size: 1306
batch 419, loss: 0.2618, instance_loss: 0.4368, weighted_loss: 0.3143, label: 2, bag_size: 600


class 0 clustering acc 0.9912352941176471: correct 16851/17000
class 1 clustering acc 0.37588235294117645: correct 1278/3400
Epoch: 17, train_loss: 0.4364, train_clustering_loss:  0.3185, train_error: 0.1624
class 0: acc 0.8695652173913043, correct 60/69
class 1: acc 0.7523809523809524, correct 79/105
class 2: acc 0.6666666666666666, correct 48/72
class 3: acc 0.9411764705882353, correct 80/85
class 4: acc 0.9468085106382979, correct 89/94

Val Set, val_loss: 1.2868, val_error: 0.4400, auc: 0.8082
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.155: correct 62/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.44, correct 11/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0046, instance_loss: 0.0292, weighted_loss: 0.0120, label: 3, bag_size: 729
batch 39, loss: 0.7784, instance_loss: 0.4008, weighted_loss: 0.6651, label: 2, bag_size: 471
batch 59, loss: 0.1933, instance_loss: 0.2575, weighted_loss: 0.2126, label: 1, bag_size: 346
batch 79, loss: 0.2333, instance_loss: 0.2760, weighted_loss: 0.2461, label: 2, bag_size: 480
batch 99, loss: 0.0046, instance_loss: 0.2213, weighted_loss: 0.0696, label: 3, bag_size: 791
batch 119, loss: 0.0309, instance_loss: 0.0456, weighted_loss: 0.0353, label: 3, bag_size: 729
batch 139, loss: 0.8838, instance_loss: 0.4772, weighted_loss: 0.7618, label: 2, bag_size: 869
batch 159, loss: 0.8641, instance_loss: 0.4381, weighted_loss: 0.7363, label: 0, bag_size: 1289
batch 179, loss: 1.1348, instance_loss: 0.4559, weighted_loss: 0.9311, label: 2, bag_size: 943
batch 199, loss: 1.1602, instance_loss: 0.4460, weighted_loss: 0.9460, label: 4, bag_size: 436
batch 219, loss: 0.3118, instance_loss: 0.5132, weighted_loss: 0.3722, label: 2, bag_size: 1069
batch 239, loss: 0.0012, instance_loss: 0.0602, weighted_loss: 0.0189, label: 4, bag_size: 729
batch 259, loss: 0.8475, instance_loss: 0.4645, weighted_loss: 0.7326, label: 2, bag_size: 237
batch 279, loss: 0.4517, instance_loss: 0.5714, weighted_loss: 0.4876, label: 2, bag_size: 1069
batch 299, loss: 0.3139, instance_loss: 0.2103, weighted_loss: 0.2828, label: 0, bag_size: 367
batch 319, loss: 0.6310, instance_loss: 0.4102, weighted_loss: 0.5647, label: 2, bag_size: 986
batch 339, loss: 1.0223, instance_loss: 0.6060, weighted_loss: 0.8974, label: 2, bag_size: 878
batch 359, loss: 0.1863, instance_loss: 0.2507, weighted_loss: 0.2056, label: 2, bag_size: 480
batch 379, loss: 0.9884, instance_loss: 0.6821, weighted_loss: 0.8965, label: 2, bag_size: 934
batch 399, loss: 0.0482, instance_loss: 0.1414, weighted_loss: 0.0761, label: 0, bag_size: 1599
batch 419, loss: 0.5917, instance_loss: 0.4258, weighted_loss: 0.5420, label: 2, bag_size: 701


class 0 clustering acc 0.9894705882352941: correct 16821/17000
class 1 clustering acc 0.4061764705882353: correct 1381/3400
Epoch: 18, train_loss: 0.3957, train_clustering_loss:  0.3120, train_error: 0.1388
class 0: acc 0.963855421686747, correct 80/83
class 1: acc 0.7553191489361702, correct 71/94
class 2: acc 0.6986301369863014, correct 51/73
class 3: acc 0.9111111111111111, correct 82/90
class 4: acc 0.9647058823529412, correct 82/85

Val Set, val_loss: 1.5036, val_error: 0.4600, auc: 0.8221
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.1775: correct 71/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.36, correct 9/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0222, instance_loss: 0.1963, weighted_loss: 0.0744, label: 1, bag_size: 945
batch 39, loss: 0.2241, instance_loss: 0.5661, weighted_loss: 0.3267, label: 1, bag_size: 860
batch 59, loss: 0.0487, instance_loss: 0.2566, weighted_loss: 0.1110, label: 0, bag_size: 653
batch 79, loss: 0.0629, instance_loss: 0.1571, weighted_loss: 0.0912, label: 4, bag_size: 1002
batch 99, loss: 2.1973, instance_loss: 0.6611, weighted_loss: 1.7365, label: 3, bag_size: 281
batch 119, loss: 0.3984, instance_loss: 0.2263, weighted_loss: 0.3468, label: 0, bag_size: 424
batch 139, loss: 0.2677, instance_loss: 0.3806, weighted_loss: 0.3015, label: 2, bag_size: 324
batch 159, loss: 0.3818, instance_loss: 0.3857, weighted_loss: 0.3829, label: 2, bag_size: 409
batch 179, loss: 0.1440, instance_loss: 0.3192, weighted_loss: 0.1965, label: 1, bag_size: 242
batch 199, loss: 0.5222, instance_loss: 0.3801, weighted_loss: 0.4795, label: 3, bag_size: 305
batch 219, loss: 0.0043, instance_loss: 0.0491, weighted_loss: 0.0178, label: 4, bag_size: 711
batch 239, loss: 0.0106, instance_loss: 0.1026, weighted_loss: 0.0382, label: 3, bag_size: 821
batch 259, loss: 0.0171, instance_loss: 0.1457, weighted_loss: 0.0557, label: 3, bag_size: 952
batch 279, loss: 0.6069, instance_loss: 0.6941, weighted_loss: 0.6330, label: 3, bag_size: 607
batch 299, loss: 0.6239, instance_loss: 0.2062, weighted_loss: 0.4986, label: 1, bag_size: 1402
batch 319, loss: 0.1659, instance_loss: 0.2438, weighted_loss: 0.1893, label: 2, bag_size: 247
batch 339, loss: 0.0633, instance_loss: 0.0999, weighted_loss: 0.0742, label: 0, bag_size: 921
batch 359, loss: 0.1099, instance_loss: 0.1157, weighted_loss: 0.1116, label: 0, bag_size: 1235
batch 379, loss: 0.5175, instance_loss: 0.2031, weighted_loss: 0.4232, label: 0, bag_size: 1247
batch 399, loss: 0.5290, instance_loss: 0.4794, weighted_loss: 0.5141, label: 1, bag_size: 1273
batch 419, loss: 1.4767, instance_loss: 0.5705, weighted_loss: 1.2048, label: 3, bag_size: 281


class 0 clustering acc 0.9915294117647059: correct 16856/17000
class 1 clustering acc 0.40176470588235297: correct 1366/3400
Epoch: 19, train_loss: 0.4102, train_clustering_loss:  0.3117, train_error: 0.1224
class 0: acc 0.9120879120879121, correct 83/91
class 1: acc 0.8333333333333334, correct 75/90
class 2: acc 0.7162162162162162, correct 53/74
class 3: acc 0.967391304347826, correct 89/92
class 4: acc 0.9358974358974359, correct 73/78

Val Set, val_loss: 1.3656, val_error: 0.5000, auc: 0.8324
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.19: correct 76/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.32, correct 8/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0176, instance_loss: 0.1723, weighted_loss: 0.0640, label: 0, bag_size: 729
batch 39, loss: 0.0234, instance_loss: 0.1385, weighted_loss: 0.0579, label: 0, bag_size: 524
batch 59, loss: 0.0215, instance_loss: 0.1295, weighted_loss: 0.0539, label: 3, bag_size: 729
batch 79, loss: 0.1961, instance_loss: 0.3943, weighted_loss: 0.2556, label: 3, bag_size: 305
batch 99, loss: 0.2954, instance_loss: 0.3544, weighted_loss: 0.3131, label: 2, bag_size: 1019
batch 119, loss: 2.7559, instance_loss: 0.7899, weighted_loss: 2.1661, label: 0, bag_size: 818
batch 139, loss: 0.0430, instance_loss: 0.0853, weighted_loss: 0.0557, label: 0, bag_size: 1190
batch 159, loss: 0.0162, instance_loss: 0.0492, weighted_loss: 0.0261, label: 0, bag_size: 382
batch 179, loss: 0.4317, instance_loss: 0.6059, weighted_loss: 0.4840, label: 1, bag_size: 860
batch 199, loss: 0.4501, instance_loss: 0.3603, weighted_loss: 0.4232, label: 2, bag_size: 357
batch 219, loss: 0.2286, instance_loss: 0.4479, weighted_loss: 0.2944, label: 3, bag_size: 630
batch 239, loss: 0.0045, instance_loss: 0.0175, weighted_loss: 0.0084, label: 3, bag_size: 1069
batch 259, loss: 0.6865, instance_loss: 0.4068, weighted_loss: 0.6026, label: 1, bag_size: 343
batch 279, loss: 0.0843, instance_loss: 0.1874, weighted_loss: 0.1152, label: 1, bag_size: 1261
batch 299, loss: 0.0185, instance_loss: 0.0545, weighted_loss: 0.0293, label: 3, bag_size: 556
batch 319, loss: 0.0029, instance_loss: 0.0419, weighted_loss: 0.0146, label: 4, bag_size: 636
batch 339, loss: 0.0041, instance_loss: 0.1549, weighted_loss: 0.0494, label: 4, bag_size: 711
batch 359, loss: 0.1275, instance_loss: 0.3107, weighted_loss: 0.1824, label: 4, bag_size: 817
batch 379, loss: 0.0011, instance_loss: 0.1916, weighted_loss: 0.0582, label: 4, bag_size: 646
batch 399, loss: 0.4828, instance_loss: 0.5963, weighted_loss: 0.5169, label: 1, bag_size: 1724
batch 419, loss: 0.1947, instance_loss: 0.2320, weighted_loss: 0.2059, label: 2, bag_size: 347


class 0 clustering acc 0.99: correct 16830/17000
class 1 clustering acc 0.3941176470588235: correct 1340/3400
Epoch: 20, train_loss: 0.4035, train_clustering_loss:  0.3106, train_error: 0.1388
class 0: acc 0.9148936170212766, correct 86/94
class 1: acc 0.7349397590361446, correct 61/83
class 2: acc 0.7647058823529411, correct 65/85
class 3: acc 0.8983050847457628, correct 53/59
class 4: acc 0.9711538461538461, correct 101/104

Val Set, val_loss: 1.1296, val_error: 0.3800, auc: 0.8266
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.135: correct 54/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.6, correct 15/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 2.1652, instance_loss: 0.6787, weighted_loss: 1.7192, label: 2, bag_size: 194
batch 39, loss: 0.0124, instance_loss: 0.1951, weighted_loss: 0.0672, label: 4, bag_size: 729
batch 59, loss: 0.0788, instance_loss: 0.1165, weighted_loss: 0.0901, label: 0, bag_size: 1190
batch 79, loss: 0.0807, instance_loss: 0.0679, weighted_loss: 0.0768, label: 0, bag_size: 552
batch 99, loss: 1.2510, instance_loss: 0.5664, weighted_loss: 1.0456, label: 1, bag_size: 887
batch 119, loss: 0.3077, instance_loss: 0.2095, weighted_loss: 0.2782, label: 3, bag_size: 849
batch 139, loss: 0.0799, instance_loss: 0.1459, weighted_loss: 0.0997, label: 0, bag_size: 933
batch 159, loss: 1.8604, instance_loss: 0.6165, weighted_loss: 1.4872, label: 3, bag_size: 281
batch 179, loss: 0.0202, instance_loss: 0.0728, weighted_loss: 0.0359, label: 0, bag_size: 239
batch 199, loss: 0.7029, instance_loss: 0.4402, weighted_loss: 0.6241, label: 1, bag_size: 102
batch 219, loss: 0.0121, instance_loss: 0.2517, weighted_loss: 0.0840, label: 4, bag_size: 773
batch 239, loss: 0.0346, instance_loss: 0.2220, weighted_loss: 0.0908, label: 0, bag_size: 729
batch 259, loss: 0.5411, instance_loss: 0.4047, weighted_loss: 0.5002, label: 2, bag_size: 795
batch 279, loss: 0.2365, instance_loss: 0.3039, weighted_loss: 0.2567, label: 1, bag_size: 697
batch 299, loss: 0.4676, instance_loss: 0.4004, weighted_loss: 0.4474, label: 1, bag_size: 838
batch 319, loss: 0.0537, instance_loss: 0.1567, weighted_loss: 0.0846, label: 1, bag_size: 636
batch 339, loss: 1.1356, instance_loss: 0.4478, weighted_loss: 0.9293, label: 2, bag_size: 1653
batch 359, loss: 0.0068, instance_loss: 0.1210, weighted_loss: 0.0410, label: 4, bag_size: 729
batch 379, loss: 0.0308, instance_loss: 0.1298, weighted_loss: 0.0605, label: 0, bag_size: 524
batch 399, loss: 0.0929, instance_loss: 0.2475, weighted_loss: 0.1393, label: 0, bag_size: 921
batch 419, loss: 0.2608, instance_loss: 0.3557, weighted_loss: 0.2893, label: 2, bag_size: 262


class 0 clustering acc 0.9912941176470588: correct 16852/17000
class 1 clustering acc 0.40441176470588236: correct 1375/3400
Epoch: 21, train_loss: 0.3356, train_clustering_loss:  0.3054, train_error: 0.1082
class 0: acc 0.9764705882352941, correct 83/85
class 1: acc 0.8089887640449438, correct 72/89
class 2: acc 0.7894736842105263, correct 60/76
class 3: acc 0.9347826086956522, correct 86/92
class 4: acc 0.9397590361445783, correct 78/83

Val Set, val_loss: 1.2654, val_error: 0.4400, auc: 0.8207
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.1975: correct 79/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.44, correct 11/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.8525, instance_loss: 0.5165, weighted_loss: 0.7517, label: 1, bag_size: 102
batch 39, loss: 0.0137, instance_loss: 0.0819, weighted_loss: 0.0342, label: 3, bag_size: 729
batch 59, loss: 0.1563, instance_loss: 0.2080, weighted_loss: 0.1718, label: 0, bag_size: 1872
batch 79, loss: 0.3909, instance_loss: 0.2543, weighted_loss: 0.3499, label: 0, bag_size: 200
batch 99, loss: 0.3332, instance_loss: 0.2830, weighted_loss: 0.3181, label: 0, bag_size: 736
batch 119, loss: 0.0550, instance_loss: 0.0568, weighted_loss: 0.0555, label: 3, bag_size: 729
batch 139, loss: 0.3261, instance_loss: 0.4021, weighted_loss: 0.3489, label: 2, bag_size: 1150
batch 159, loss: 0.0056, instance_loss: 0.0504, weighted_loss: 0.0190, label: 3, bag_size: 729
batch 179, loss: 0.0933, instance_loss: 0.3242, weighted_loss: 0.1626, label: 1, bag_size: 925
batch 199, loss: 0.0117, instance_loss: 0.2256, weighted_loss: 0.0758, label: 4, bag_size: 729
batch 219, loss: 0.3611, instance_loss: 0.3369, weighted_loss: 0.3538, label: 2, bag_size: 839
batch 239, loss: 0.0119, instance_loss: 0.3001, weighted_loss: 0.0984, label: 1, bag_size: 318
batch 259, loss: 0.1580, instance_loss: 0.1332, weighted_loss: 0.1505, label: 4, bag_size: 817
batch 279, loss: 0.0818, instance_loss: 0.1433, weighted_loss: 0.1002, label: 3, bag_size: 849
batch 299, loss: 0.0184, instance_loss: 0.0722, weighted_loss: 0.0346, label: 0, bag_size: 1012
batch 319, loss: 0.1266, instance_loss: 0.4489, weighted_loss: 0.2233, label: 1, bag_size: 860
batch 339, loss: 0.7110, instance_loss: 0.5394, weighted_loss: 0.6595, label: 0, bag_size: 718
batch 359, loss: 0.0069, instance_loss: 0.0577, weighted_loss: 0.0221, label: 0, bag_size: 239
batch 379, loss: 0.0641, instance_loss: 0.0939, weighted_loss: 0.0730, label: 0, bag_size: 1061
batch 399, loss: 0.0367, instance_loss: 0.5844, weighted_loss: 0.2010, label: 3, bag_size: 630
batch 419, loss: 0.0250, instance_loss: 0.0747, weighted_loss: 0.0399, label: 4, bag_size: 1121


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.4364705882352941: correct 1484/3400
Epoch: 22, train_loss: 0.3184, train_clustering_loss:  0.3003, train_error: 0.1012
class 0: acc 0.9411764705882353, correct 80/85
class 1: acc 0.8351648351648352, correct 76/91
class 2: acc 0.7714285714285715, correct 54/70
class 3: acc 0.9292929292929293, correct 92/99
class 4: acc 1.0, correct 80/80

Val Set, val_loss: 1.3689, val_error: 0.4600, auc: 0.8181
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.44, correct 11/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0403, instance_loss: 0.5040, weighted_loss: 0.1795, label: 3, bag_size: 630
batch 39, loss: 0.0198, instance_loss: 0.2281, weighted_loss: 0.0823, label: 4, bag_size: 656
batch 59, loss: 0.0415, instance_loss: 0.0744, weighted_loss: 0.0513, label: 3, bag_size: 1177
batch 79, loss: 1.6265, instance_loss: 0.8538, weighted_loss: 1.3947, label: 1, bag_size: 386
batch 99, loss: 0.0102, instance_loss: 0.0723, weighted_loss: 0.0288, label: 3, bag_size: 729
batch 119, loss: 0.0160, instance_loss: 0.0331, weighted_loss: 0.0211, label: 3, bag_size: 556
batch 139, loss: 0.0335, instance_loss: 0.1563, weighted_loss: 0.0703, label: 1, bag_size: 945
batch 159, loss: 0.0443, instance_loss: 0.1806, weighted_loss: 0.0852, label: 4, bag_size: 354
batch 179, loss: 0.8111, instance_loss: 0.5359, weighted_loss: 0.7286, label: 2, bag_size: 649
batch 199, loss: 0.1153, instance_loss: 0.2645, weighted_loss: 0.1601, label: 2, bag_size: 1200
batch 219, loss: 0.0075, instance_loss: 0.3627, weighted_loss: 0.1141, label: 4, bag_size: 974
batch 239, loss: 0.0027, instance_loss: 0.1126, weighted_loss: 0.0357, label: 4, bag_size: 1278
batch 259, loss: 1.8833, instance_loss: 0.6001, weighted_loss: 1.4983, label: 1, bag_size: 308
batch 279, loss: 0.0837, instance_loss: 0.1693, weighted_loss: 0.1094, label: 0, bag_size: 518
batch 299, loss: 0.3089, instance_loss: 0.4097, weighted_loss: 0.3392, label: 0, bag_size: 801
batch 319, loss: 0.2309, instance_loss: 0.1365, weighted_loss: 0.2026, label: 0, bag_size: 338
batch 339, loss: 1.2417, instance_loss: 0.4300, weighted_loss: 0.9982, label: 2, bag_size: 748
batch 359, loss: 0.0216, instance_loss: 0.1864, weighted_loss: 0.0710, label: 3, bag_size: 729
batch 379, loss: 0.1498, instance_loss: 0.3901, weighted_loss: 0.2219, label: 1, bag_size: 1014
batch 399, loss: 0.0017, instance_loss: 0.1212, weighted_loss: 0.0376, label: 4, bag_size: 729
batch 419, loss: 0.2779, instance_loss: 0.5048, weighted_loss: 0.3460, label: 1, bag_size: 1724


class 0 clustering acc 0.9879411764705882: correct 16795/17000
class 1 clustering acc 0.4047058823529412: correct 1376/3400
Epoch: 23, train_loss: 0.3356, train_clustering_loss:  0.3135, train_error: 0.1129
class 0: acc 0.8941176470588236, correct 76/85
class 1: acc 0.7662337662337663, correct 59/77
class 2: acc 0.8068181818181818, correct 71/88
class 3: acc 0.9753086419753086, correct 79/81
class 4: acc 0.9787234042553191, correct 92/94

Val Set, val_loss: 1.5496, val_error: 0.4800, auc: 0.8250
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.36, correct 9/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2446, instance_loss: 0.3503, weighted_loss: 0.2763, label: 1, bag_size: 898
batch 39, loss: 0.0601, instance_loss: 0.2007, weighted_loss: 0.1023, label: 2, bag_size: 404
batch 59, loss: 0.0639, instance_loss: 0.2568, weighted_loss: 0.1218, label: 3, bag_size: 706
batch 79, loss: 0.3052, instance_loss: 0.3376, weighted_loss: 0.3149, label: 1, bag_size: 754
batch 99, loss: 0.0528, instance_loss: 0.2868, weighted_loss: 0.1230, label: 1, bag_size: 534
batch 119, loss: 0.0059, instance_loss: 0.0417, weighted_loss: 0.0167, label: 0, bag_size: 616
batch 139, loss: 0.2181, instance_loss: 0.4320, weighted_loss: 0.2823, label: 2, bag_size: 259
batch 159, loss: 0.0116, instance_loss: 0.2721, weighted_loss: 0.0898, label: 3, bag_size: 791
batch 179, loss: 0.0044, instance_loss: 0.0245, weighted_loss: 0.0104, label: 3, bag_size: 1069
batch 199, loss: 0.0142, instance_loss: 0.0765, weighted_loss: 0.0329, label: 0, bag_size: 385
batch 219, loss: 0.0038, instance_loss: 0.0561, weighted_loss: 0.0195, label: 4, bag_size: 729
batch 239, loss: 0.1511, instance_loss: 0.7263, weighted_loss: 0.3237, label: 3, bag_size: 607
batch 259, loss: 0.0384, instance_loss: 0.1238, weighted_loss: 0.0641, label: 3, bag_size: 952
batch 279, loss: 0.0870, instance_loss: 0.2173, weighted_loss: 0.1260, label: 2, bag_size: 1155
batch 299, loss: 0.4976, instance_loss: 0.4571, weighted_loss: 0.4854, label: 1, bag_size: 959
batch 319, loss: 0.1173, instance_loss: 0.1071, weighted_loss: 0.1143, label: 3, bag_size: 1399
batch 339, loss: 0.0001, instance_loss: 0.0265, weighted_loss: 0.0080, label: 4, bag_size: 729
batch 359, loss: 0.0206, instance_loss: 0.1426, weighted_loss: 0.0572, label: 0, bag_size: 729
batch 379, loss: 0.0044, instance_loss: 0.0508, weighted_loss: 0.0183, label: 0, bag_size: 1466
batch 399, loss: 0.0754, instance_loss: 0.1523, weighted_loss: 0.0984, label: 3, bag_size: 1177
batch 419, loss: 0.2168, instance_loss: 0.2432, weighted_loss: 0.2247, label: 1, bag_size: 1402


class 0 clustering acc 0.9892352941176471: correct 16817/17000
class 1 clustering acc 0.43117647058823527: correct 1466/3400
Epoch: 24, train_loss: 0.3332, train_clustering_loss:  0.3061, train_error: 0.1247
class 0: acc 0.8947368421052632, correct 68/76
class 1: acc 0.8409090909090909, correct 74/88
class 2: acc 0.7126436781609196, correct 62/87
class 3: acc 0.9518072289156626, correct 79/83
class 4: acc 0.978021978021978, correct 89/91

Val Set, val_loss: 1.1753, val_error: 0.3800, auc: 0.8275
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.1675: correct 67/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.6, correct 15/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1323, instance_loss: 0.2958, weighted_loss: 0.1814, label: 1, bag_size: 1402
batch 39, loss: 0.0184, instance_loss: 0.1050, weighted_loss: 0.0444, label: 0, bag_size: 446
batch 59, loss: 0.2696, instance_loss: 0.3375, weighted_loss: 0.2900, label: 3, bag_size: 317
batch 79, loss: 0.4670, instance_loss: 0.4666, weighted_loss: 0.4669, label: 3, bag_size: 200
batch 99, loss: 0.0408, instance_loss: 0.1677, weighted_loss: 0.0788, label: 0, bag_size: 1046
batch 119, loss: 0.1519, instance_loss: 0.2487, weighted_loss: 0.1809, label: 2, bag_size: 1006
batch 139, loss: 0.1011, instance_loss: 0.1813, weighted_loss: 0.1252, label: 0, bag_size: 552
batch 159, loss: 0.0476, instance_loss: 0.0989, weighted_loss: 0.0630, label: 0, bag_size: 515
batch 179, loss: 0.0349, instance_loss: 0.1404, weighted_loss: 0.0665, label: 0, bag_size: 756
batch 199, loss: 0.0856, instance_loss: 0.0709, weighted_loss: 0.0812, label: 3, bag_size: 1399
batch 219, loss: 0.4943, instance_loss: 0.5206, weighted_loss: 0.5022, label: 2, bag_size: 384
batch 239, loss: 0.0101, instance_loss: 0.0585, weighted_loss: 0.0246, label: 4, bag_size: 524
batch 259, loss: 0.1253, instance_loss: 0.2340, weighted_loss: 0.1579, label: 4, bag_size: 826
batch 279, loss: 0.8942, instance_loss: 0.4915, weighted_loss: 0.7734, label: 4, bag_size: 754
batch 299, loss: 0.0031, instance_loss: 0.1120, weighted_loss: 0.0358, label: 3, bag_size: 729
batch 319, loss: 0.0192, instance_loss: 0.2689, weighted_loss: 0.0941, label: 0, bag_size: 729
batch 339, loss: 0.3347, instance_loss: 0.4915, weighted_loss: 0.3818, label: 2, bag_size: 1197
batch 359, loss: 0.0111, instance_loss: 0.0489, weighted_loss: 0.0224, label: 0, bag_size: 402
batch 379, loss: 0.0278, instance_loss: 0.0625, weighted_loss: 0.0382, label: 3, bag_size: 729
batch 399, loss: 0.0998, instance_loss: 0.3238, weighted_loss: 0.1670, label: 3, bag_size: 697
batch 419, loss: 0.0244, instance_loss: 0.0590, weighted_loss: 0.0347, label: 3, bag_size: 305


class 0 clustering acc 0.992: correct 16864/17000
class 1 clustering acc 0.4073529411764706: correct 1385/3400
Epoch: 25, train_loss: 0.2873, train_clustering_loss:  0.2982, train_error: 0.0965
class 0: acc 0.9090909090909091, correct 80/88
class 1: acc 0.8809523809523809, correct 74/84
class 2: acc 0.7934782608695652, correct 73/92
class 3: acc 0.9791666666666666, correct 94/96
class 4: acc 0.9692307692307692, correct 63/65

Val Set, val_loss: 1.2794, val_error: 0.4200, auc: 0.8269
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.165: correct 66/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.56, correct 14/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.7506, instance_loss: 0.6256, weighted_loss: 0.7131, label: 0, bag_size: 515
batch 39, loss: 0.1070, instance_loss: 0.2555, weighted_loss: 0.1515, label: 2, bag_size: 247
batch 59, loss: 0.0346, instance_loss: 0.2932, weighted_loss: 0.1122, label: 0, bag_size: 472
batch 79, loss: 0.0338, instance_loss: 0.1992, weighted_loss: 0.0834, label: 2, bag_size: 1053
batch 99, loss: 0.0443, instance_loss: 0.4429, weighted_loss: 0.1639, label: 3, bag_size: 697
batch 119, loss: 0.0729, instance_loss: 0.1467, weighted_loss: 0.0951, label: 1, bag_size: 369
batch 139, loss: 0.2861, instance_loss: 0.3803, weighted_loss: 0.3144, label: 2, bag_size: 1533
batch 159, loss: 0.0043, instance_loss: 0.1042, weighted_loss: 0.0343, label: 3, bag_size: 952
batch 179, loss: 0.1176, instance_loss: 0.2926, weighted_loss: 0.1701, label: 4, bag_size: 773
batch 199, loss: 2.2225, instance_loss: 0.6795, weighted_loss: 1.7596, label: 2, bag_size: 358
batch 219, loss: 0.0482, instance_loss: 0.1997, weighted_loss: 0.0937, label: 0, bag_size: 729
batch 239, loss: 0.0008, instance_loss: 0.0129, weighted_loss: 0.0045, label: 3, bag_size: 1069
batch 259, loss: 0.0654, instance_loss: 0.4031, weighted_loss: 0.1667, label: 3, bag_size: 230
batch 279, loss: 0.0444, instance_loss: 0.3606, weighted_loss: 0.1393, label: 2, bag_size: 1410
batch 299, loss: 0.0031, instance_loss: 0.2615, weighted_loss: 0.0806, label: 4, bag_size: 625
batch 319, loss: 0.0651, instance_loss: 0.2446, weighted_loss: 0.1189, label: 1, bag_size: 1646
batch 339, loss: 0.0244, instance_loss: 0.0300, weighted_loss: 0.0261, label: 3, bag_size: 556
batch 359, loss: 0.5995, instance_loss: 0.4223, weighted_loss: 0.5464, label: 3, bag_size: 706
batch 379, loss: 0.1275, instance_loss: 0.2686, weighted_loss: 0.1698, label: 2, bag_size: 868
batch 399, loss: 0.0115, instance_loss: 0.0439, weighted_loss: 0.0212, label: 0, bag_size: 552
batch 419, loss: 0.0112, instance_loss: 0.0501, weighted_loss: 0.0229, label: 0, bag_size: 933


class 0 clustering acc 0.9888235294117647: correct 16810/17000
class 1 clustering acc 0.46: correct 1564/3400
Epoch: 26, train_loss: 0.2669, train_clustering_loss:  0.2838, train_error: 0.0965
class 0: acc 0.9642857142857143, correct 81/84
class 1: acc 0.7931034482758621, correct 69/87
class 2: acc 0.7901234567901234, correct 64/81
class 3: acc 0.9791666666666666, correct 94/96
class 4: acc 0.987012987012987, correct 76/77

Val Set, val_loss: 1.1695, val_error: 0.3600, auc: 0.8294
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.1725: correct 69/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.68, correct 17/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0290, instance_loss: 0.0443, weighted_loss: 0.0336, label: 3, bag_size: 729
batch 39, loss: 0.1816, instance_loss: 0.2769, weighted_loss: 0.2102, label: 1, bag_size: 504
batch 59, loss: 0.0471, instance_loss: 0.2685, weighted_loss: 0.1135, label: 0, bag_size: 756
batch 79, loss: 0.3334, instance_loss: 0.3779, weighted_loss: 0.3467, label: 1, bag_size: 598
batch 99, loss: 0.0289, instance_loss: 0.2227, weighted_loss: 0.0870, label: 0, bag_size: 1301
batch 119, loss: 0.0100, instance_loss: 0.0643, weighted_loss: 0.0263, label: 4, bag_size: 636
batch 139, loss: 0.0512, instance_loss: 0.0916, weighted_loss: 0.0633, label: 0, bag_size: 1012
batch 159, loss: 0.0637, instance_loss: 0.5244, weighted_loss: 0.2019, label: 3, bag_size: 230
batch 179, loss: 0.3418, instance_loss: 0.2796, weighted_loss: 0.3231, label: 2, bag_size: 600
batch 199, loss: 0.0009, instance_loss: 0.1071, weighted_loss: 0.0327, label: 4, bag_size: 646
batch 219, loss: 0.0123, instance_loss: 0.1464, weighted_loss: 0.0525, label: 3, bag_size: 952
batch 239, loss: 0.1372, instance_loss: 0.3605, weighted_loss: 0.2042, label: 2, bag_size: 1410
batch 259, loss: 0.0712, instance_loss: 0.2695, weighted_loss: 0.1307, label: 1, bag_size: 690
batch 279, loss: 0.2246, instance_loss: 0.2754, weighted_loss: 0.2398, label: 3, bag_size: 343
batch 299, loss: 0.0457, instance_loss: 0.0841, weighted_loss: 0.0572, label: 0, bag_size: 1235
batch 319, loss: 0.0052, instance_loss: 0.2340, weighted_loss: 0.0738, label: 0, bag_size: 729
batch 339, loss: 0.0313, instance_loss: 0.0367, weighted_loss: 0.0329, label: 3, bag_size: 556
batch 359, loss: 0.0021, instance_loss: 0.1033, weighted_loss: 0.0324, label: 0, bag_size: 729
batch 379, loss: 0.3203, instance_loss: 0.6017, weighted_loss: 0.4047, label: 2, bag_size: 1197
batch 399, loss: 0.3391, instance_loss: 0.4382, weighted_loss: 0.3688, label: 3, bag_size: 317
batch 419, loss: 0.1178, instance_loss: 0.4415, weighted_loss: 0.2149, label: 3, bag_size: 697


class 0 clustering acc 0.9895882352941177: correct 16823/17000
class 1 clustering acc 0.44823529411764707: correct 1524/3400
Epoch: 27, train_loss: 0.2744, train_clustering_loss:  0.2905, train_error: 0.0776
class 0: acc 0.9629629629629629, correct 78/81
class 1: acc 0.8589743589743589, correct 67/78
class 2: acc 0.8157894736842105, correct 62/76
class 3: acc 0.9791666666666666, correct 94/96
class 4: acc 0.9680851063829787, correct 91/94

Val Set, val_loss: 1.0929, val_error: 0.3400, auc: 0.8314
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.165: correct 66/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.64, correct 16/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.2788, instance_loss: 0.3271, weighted_loss: 0.2933, label: 4, bag_size: 1360
batch 39, loss: 0.0280, instance_loss: 0.0509, weighted_loss: 0.0349, label: 4, bag_size: 1121
batch 59, loss: 0.0611, instance_loss: 0.2571, weighted_loss: 0.1199, label: 3, bag_size: 697
batch 79, loss: 0.0075, instance_loss: 0.0292, weighted_loss: 0.0140, label: 3, bag_size: 1291
batch 99, loss: 0.0745, instance_loss: 0.0852, weighted_loss: 0.0777, label: 3, bag_size: 729
batch 119, loss: 0.0068, instance_loss: 0.0812, weighted_loss: 0.0291, label: 4, bag_size: 636
batch 139, loss: 0.7655, instance_loss: 1.0123, weighted_loss: 0.8395, label: 2, bag_size: 1677
batch 159, loss: 0.8959, instance_loss: 0.9350, weighted_loss: 0.9076, label: 2, bag_size: 1677
batch 179, loss: 0.0764, instance_loss: 0.1495, weighted_loss: 0.0984, label: 3, bag_size: 1177
batch 199, loss: 0.0538, instance_loss: 0.0467, weighted_loss: 0.0517, label: 3, bag_size: 729
batch 219, loss: 0.0902, instance_loss: 0.5047, weighted_loss: 0.2146, label: 3, bag_size: 1167
batch 239, loss: 0.0004, instance_loss: 0.2165, weighted_loss: 0.0652, label: 4, bag_size: 656
batch 259, loss: 0.0597, instance_loss: 0.3763, weighted_loss: 0.1547, label: 4, bag_size: 1337
batch 279, loss: 0.0223, instance_loss: 0.1168, weighted_loss: 0.0507, label: 0, bag_size: 921
batch 299, loss: 0.2427, instance_loss: 0.2748, weighted_loss: 0.2523, label: 2, bag_size: 1700
batch 319, loss: 0.0400, instance_loss: 0.1408, weighted_loss: 0.0702, label: 1, bag_size: 1277
batch 339, loss: 1.7341, instance_loss: 0.7406, weighted_loss: 1.4360, label: 0, bag_size: 818
batch 359, loss: 0.0080, instance_loss: 0.0650, weighted_loss: 0.0251, label: 1, bag_size: 286
batch 379, loss: 0.0138, instance_loss: 0.1801, weighted_loss: 0.0637, label: 2, bag_size: 421
batch 399, loss: 0.1108, instance_loss: 0.3674, weighted_loss: 0.1878, label: 1, bag_size: 1086
batch 419, loss: 0.0032, instance_loss: 0.0632, weighted_loss: 0.0212, label: 3, bag_size: 729


class 0 clustering acc 0.987764705882353: correct 16792/17000
class 1 clustering acc 0.4023529411764706: correct 1368/3400
Epoch: 28, train_loss: 0.2745, train_clustering_loss:  0.3132, train_error: 0.1106
class 0: acc 0.8857142857142857, correct 62/70
class 1: acc 0.8764044943820225, correct 78/89
class 2: acc 0.7843137254901961, correct 80/102
class 3: acc 0.9605263157894737, correct 73/76
class 4: acc 0.9659090909090909, correct 85/88

Val Set, val_loss: 1.3078, val_error: 0.4400, auc: 0.8042
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.18: correct 72/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.6558, instance_loss: 0.8357, weighted_loss: 1.4098, label: 0, bag_size: 818
batch 39, loss: 0.0122, instance_loss: 0.1306, weighted_loss: 0.0477, label: 4, bag_size: 817
batch 59, loss: 0.1418, instance_loss: 0.2883, weighted_loss: 0.1857, label: 0, bag_size: 542
batch 79, loss: 0.3911, instance_loss: 0.3336, weighted_loss: 0.3739, label: 1, bag_size: 913
batch 99, loss: 0.0781, instance_loss: 0.0747, weighted_loss: 0.0771, label: 3, bag_size: 1399
batch 119, loss: 0.4890, instance_loss: 0.5654, weighted_loss: 0.5119, label: 4, bag_size: 511
batch 139, loss: 0.1022, instance_loss: 0.2560, weighted_loss: 0.1483, label: 0, bag_size: 736
batch 159, loss: 0.0050, instance_loss: 0.1667, weighted_loss: 0.0535, label: 0, bag_size: 1466
batch 179, loss: 0.0443, instance_loss: 0.2552, weighted_loss: 0.1076, label: 2, bag_size: 600
batch 199, loss: 0.0016, instance_loss: 0.1461, weighted_loss: 0.0449, label: 4, bag_size: 823
batch 219, loss: 0.3472, instance_loss: 0.4076, weighted_loss: 0.3653, label: 3, bag_size: 281
batch 239, loss: 0.0152, instance_loss: 0.0687, weighted_loss: 0.0312, label: 3, bag_size: 556
batch 259, loss: 0.1274, instance_loss: 0.2629, weighted_loss: 0.1681, label: 2, bag_size: 222
batch 279, loss: 0.3443, instance_loss: 0.3754, weighted_loss: 0.3536, label: 2, bag_size: 967
batch 299, loss: 0.0888, instance_loss: 0.2050, weighted_loss: 0.1237, label: 2, bag_size: 262
batch 319, loss: 0.0715, instance_loss: 0.1331, weighted_loss: 0.0900, label: 0, bag_size: 413
batch 339, loss: 0.1403, instance_loss: 0.6302, weighted_loss: 0.2872, label: 1, bag_size: 1724
batch 359, loss: 0.0335, instance_loss: 0.1907, weighted_loss: 0.0807, label: 0, bag_size: 1046
batch 379, loss: 0.0804, instance_loss: 0.1150, weighted_loss: 0.0908, label: 3, bag_size: 1177
batch 399, loss: 0.7098, instance_loss: 0.4331, weighted_loss: 0.6268, label: 0, bag_size: 1065
batch 419, loss: 0.4787, instance_loss: 0.6223, weighted_loss: 0.5217, label: 1, bag_size: 102


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.45294117647058824: correct 1540/3400
Epoch: 29, train_loss: 0.2159, train_clustering_loss:  0.2883, train_error: 0.0659
class 0: acc 0.9651162790697675, correct 83/86
class 1: acc 0.8709677419354839, correct 54/62
class 2: acc 0.8369565217391305, correct 77/92
class 3: acc 0.9809523809523809, correct 103/105
class 4: acc 1.0, correct 80/80

Val Set, val_loss: 1.2214, val_error: 0.3600, auc: 0.8004
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.17: correct 68/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.64, correct 16/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.3172, instance_loss: 0.2629, weighted_loss: 0.3009, label: 2, bag_size: 395
batch 39, loss: 0.0791, instance_loss: 0.3380, weighted_loss: 0.1568, label: 1, bag_size: 1402
batch 59, loss: 0.0486, instance_loss: 0.1497, weighted_loss: 0.0789, label: 0, bag_size: 756
batch 79, loss: 0.1598, instance_loss: 0.4342, weighted_loss: 0.2421, label: 2, bag_size: 1404
batch 99, loss: 0.7529, instance_loss: 0.5841, weighted_loss: 0.7023, label: 2, bag_size: 237
batch 119, loss: 0.6544, instance_loss: 0.5060, weighted_loss: 0.6099, label: 2, bag_size: 508
batch 139, loss: 1.3262, instance_loss: 0.5181, weighted_loss: 1.0838, label: 1, bag_size: 868
batch 159, loss: 0.0001, instance_loss: 0.0991, weighted_loss: 0.0298, label: 4, bag_size: 729
batch 179, loss: 0.0011, instance_loss: 0.0168, weighted_loss: 0.0058, label: 3, bag_size: 1069
batch 199, loss: 0.2237, instance_loss: 0.2528, weighted_loss: 0.2324, label: 0, bag_size: 1061
batch 219, loss: 0.0203, instance_loss: 0.0732, weighted_loss: 0.0361, label: 3, bag_size: 1399
batch 239, loss: 0.0092, instance_loss: 0.4634, weighted_loss: 0.1454, label: 4, bag_size: 663
batch 259, loss: 0.2785, instance_loss: 0.6173, weighted_loss: 0.3801, label: 1, bag_size: 778
batch 279, loss: 0.9822, instance_loss: 0.9105, weighted_loss: 0.9607, label: 2, bag_size: 732
batch 299, loss: 0.0052, instance_loss: 0.1159, weighted_loss: 0.0384, label: 4, bag_size: 974
batch 319, loss: 2.1829, instance_loss: 0.7295, weighted_loss: 1.7469, label: 1, bag_size: 446
batch 339, loss: 0.0001, instance_loss: 0.0271, weighted_loss: 0.0082, label: 4, bag_size: 729
batch 359, loss: 0.0126, instance_loss: 0.3541, weighted_loss: 0.1150, label: 3, bag_size: 697
batch 379, loss: 0.6759, instance_loss: 0.8331, weighted_loss: 0.7231, label: 1, bag_size: 386
batch 399, loss: 0.1162, instance_loss: 0.3286, weighted_loss: 0.1799, label: 2, bag_size: 1164
batch 419, loss: 0.0836, instance_loss: 0.1510, weighted_loss: 0.1038, label: 4, bag_size: 817


class 0 clustering acc 0.9893529411764705: correct 16819/17000
class 1 clustering acc 0.46441176470588236: correct 1579/3400
Epoch: 30, train_loss: 0.1972, train_clustering_loss:  0.2836, train_error: 0.0588
class 0: acc 0.9759036144578314, correct 81/83
class 1: acc 0.8701298701298701, correct 67/77
class 2: acc 0.8493150684931506, correct 62/73
class 3: acc 0.9787234042553191, correct 92/94
class 4: acc 1.0, correct 98/98

Val Set, val_loss: 1.1662, val_error: 0.3400, auc: 0.8195
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.1675: correct 67/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.68, correct 17/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0621, weighted_loss: 0.0188, label: 4, bag_size: 729
batch 39, loss: 0.0202, instance_loss: 0.1070, weighted_loss: 0.0462, label: 3, bag_size: 1291
batch 59, loss: 0.0040, instance_loss: 0.1453, weighted_loss: 0.0464, label: 0, bag_size: 729
batch 79, loss: 0.3135, instance_loss: 0.6114, weighted_loss: 0.4029, label: 4, bag_size: 436
batch 99, loss: 0.3332, instance_loss: 0.6071, weighted_loss: 0.4154, label: 3, bag_size: 281
batch 119, loss: 0.0013, instance_loss: 0.0646, weighted_loss: 0.0203, label: 4, bag_size: 1235
batch 139, loss: 0.1970, instance_loss: 0.5041, weighted_loss: 0.2891, label: 2, bag_size: 1439
batch 159, loss: 0.0563, instance_loss: 0.2044, weighted_loss: 0.1007, label: 0, bag_size: 1046
batch 179, loss: 0.0603, instance_loss: 0.2745, weighted_loss: 0.1246, label: 2, bag_size: 1533
batch 199, loss: 1.2329, instance_loss: 0.4303, weighted_loss: 0.9922, label: 2, bag_size: 1164
batch 219, loss: 0.2249, instance_loss: 0.0639, weighted_loss: 0.1766, label: 3, bag_size: 729
batch 239, loss: 0.0752, instance_loss: 0.1009, weighted_loss: 0.0829, label: 0, bag_size: 1247
batch 259, loss: 0.0137, instance_loss: 0.0846, weighted_loss: 0.0350, label: 0, bag_size: 756
batch 279, loss: 0.0217, instance_loss: 0.5232, weighted_loss: 0.1721, label: 4, bag_size: 663
batch 299, loss: 0.2701, instance_loss: 0.4539, weighted_loss: 0.3252, label: 1, bag_size: 1096
batch 319, loss: 0.0244, instance_loss: 0.1068, weighted_loss: 0.0491, label: 0, bag_size: 446
batch 339, loss: 0.0003, instance_loss: 0.0655, weighted_loss: 0.0199, label: 4, bag_size: 646
batch 359, loss: 0.0233, instance_loss: 0.1147, weighted_loss: 0.0507, label: 0, bag_size: 602
batch 379, loss: 2.2230, instance_loss: 0.6554, weighted_loss: 1.7527, label: 2, bag_size: 959
batch 399, loss: 0.1240, instance_loss: 0.1083, weighted_loss: 0.1193, label: 3, bag_size: 1177
batch 419, loss: 0.7502, instance_loss: 0.3472, weighted_loss: 0.6293, label: 0, bag_size: 1289


class 0 clustering acc 0.9862352941176471: correct 16766/17000
class 1 clustering acc 0.45529411764705885: correct 1548/3400
Epoch: 31, train_loss: 0.2109, train_clustering_loss:  0.2920, train_error: 0.0729
class 0: acc 0.9555555555555556, correct 86/90
class 1: acc 0.8863636363636364, correct 78/88
class 2: acc 0.7875, correct 63/80
class 3: acc 1.0, correct 75/75
class 4: acc 1.0, correct 92/92

Val Set, val_loss: 1.2317, val_error: 0.4200, auc: 0.8427
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.56, correct 14/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1365, instance_loss: 0.2738, weighted_loss: 0.1777, label: 0, bag_size: 1257
batch 39, loss: 0.2628, instance_loss: 0.4520, weighted_loss: 0.3196, label: 2, bag_size: 707
batch 59, loss: 0.1208, instance_loss: 0.4103, weighted_loss: 0.2076, label: 1, bag_size: 487
batch 79, loss: 0.0001, instance_loss: 0.0249, weighted_loss: 0.0076, label: 4, bag_size: 729
batch 99, loss: 0.1535, instance_loss: 0.4069, weighted_loss: 0.2295, label: 2, bag_size: 312
batch 119, loss: 0.0012, instance_loss: 0.2458, weighted_loss: 0.0746, label: 4, bag_size: 823
batch 139, loss: 0.0003, instance_loss: 0.1045, weighted_loss: 0.0316, label: 0, bag_size: 729
batch 159, loss: 0.0052, instance_loss: 0.0964, weighted_loss: 0.0326, label: 3, bag_size: 729
batch 179, loss: 0.1965, instance_loss: 0.2848, weighted_loss: 0.2230, label: 2, bag_size: 863
batch 199, loss: 0.1831, instance_loss: 0.2984, weighted_loss: 0.2177, label: 2, bag_size: 1047
batch 219, loss: 0.2024, instance_loss: 0.2353, weighted_loss: 0.2123, label: 0, bag_size: 736
batch 239, loss: 0.0005, instance_loss: 0.2805, weighted_loss: 0.0845, label: 4, bag_size: 882
batch 259, loss: 0.0100, instance_loss: 0.0431, weighted_loss: 0.0199, label: 0, bag_size: 616
batch 279, loss: 0.0177, instance_loss: 0.0576, weighted_loss: 0.0297, label: 3, bag_size: 1399
batch 299, loss: 0.0335, instance_loss: 0.3444, weighted_loss: 0.1268, label: 3, bag_size: 305
batch 319, loss: 0.0136, instance_loss: 0.0578, weighted_loss: 0.0269, label: 3, bag_size: 1177
batch 339, loss: 0.4189, instance_loss: 0.3704, weighted_loss: 0.4044, label: 2, bag_size: 738
batch 359, loss: 0.0020, instance_loss: 0.0688, weighted_loss: 0.0220, label: 3, bag_size: 821
batch 379, loss: 0.0313, instance_loss: 0.0530, weighted_loss: 0.0378, label: 0, bag_size: 1235
batch 399, loss: 0.0089, instance_loss: 0.3186, weighted_loss: 0.1018, label: 4, bag_size: 974
batch 419, loss: 0.0079, instance_loss: 0.0516, weighted_loss: 0.0210, label: 0, bag_size: 385


class 0 clustering acc 0.990764705882353: correct 16843/17000
class 1 clustering acc 0.5323529411764706: correct 1810/3400
Epoch: 32, train_loss: 0.1624, train_clustering_loss:  0.2543, train_error: 0.0494
class 0: acc 0.9891304347826086, correct 91/92
class 1: acc 0.855072463768116, correct 59/69
class 2: acc 0.9146341463414634, correct 75/82
class 3: acc 0.9787234042553191, correct 92/94
class 4: acc 0.9886363636363636, correct 87/88

Val Set, val_loss: 1.1443, val_error: 0.3200, auc: 0.8147
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.2525: correct 101/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.72, correct 18/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0826, instance_loss: 0.2346, weighted_loss: 0.1282, label: 0, bag_size: 446
batch 39, loss: 1.2268, instance_loss: 0.7461, weighted_loss: 1.0826, label: 2, bag_size: 295
batch 59, loss: 0.0149, instance_loss: 0.4715, weighted_loss: 0.1519, label: 4, bag_size: 675
batch 79, loss: 0.1787, instance_loss: 0.4367, weighted_loss: 0.2561, label: 1, bag_size: 818
batch 99, loss: 0.0080, instance_loss: 0.0376, weighted_loss: 0.0169, label: 4, bag_size: 764
batch 119, loss: 0.0353, instance_loss: 0.1579, weighted_loss: 0.0721, label: 1, bag_size: 1086
batch 139, loss: 0.5878, instance_loss: 0.4929, weighted_loss: 0.5593, label: 1, bag_size: 875
batch 159, loss: 0.0327, instance_loss: 0.3950, weighted_loss: 0.1414, label: 3, bag_size: 706
batch 179, loss: 0.0057, instance_loss: 0.5942, weighted_loss: 0.1822, label: 2, bag_size: 358
batch 199, loss: 0.2218, instance_loss: 0.4265, weighted_loss: 0.2832, label: 2, bag_size: 3236
batch 219, loss: 0.0627, instance_loss: 0.2183, weighted_loss: 0.1094, label: 4, bag_size: 826
batch 239, loss: 0.0011, instance_loss: 0.0210, weighted_loss: 0.0071, label: 3, bag_size: 1069
batch 259, loss: 0.0260, instance_loss: 0.2337, weighted_loss: 0.0883, label: 2, bag_size: 1242
batch 279, loss: 0.2913, instance_loss: 0.3611, weighted_loss: 0.3123, label: 1, bag_size: 1080
batch 299, loss: 0.0010, instance_loss: 0.1292, weighted_loss: 0.0394, label: 4, bag_size: 729
batch 319, loss: 0.2948, instance_loss: 0.3015, weighted_loss: 0.2968, label: 4, bag_size: 1360
batch 339, loss: 0.0015, instance_loss: 0.1634, weighted_loss: 0.0501, label: 3, bag_size: 729
batch 359, loss: 1.5392, instance_loss: 0.7086, weighted_loss: 1.2900, label: 1, bag_size: 786
batch 379, loss: 0.0001, instance_loss: 0.4138, weighted_loss: 0.1242, label: 4, bag_size: 663
batch 399, loss: 0.0596, instance_loss: 0.6355, weighted_loss: 0.2324, label: 4, bag_size: 511
batch 419, loss: 0.0512, instance_loss: 0.2067, weighted_loss: 0.0979, label: 4, bag_size: 297


class 0 clustering acc 0.9879411764705882: correct 16795/17000
class 1 clustering acc 0.47205882352941175: correct 1605/3400
Epoch: 33, train_loss: 0.1909, train_clustering_loss:  0.2843, train_error: 0.0635
class 0: acc 0.9518072289156626, correct 79/83
class 1: acc 0.8888888888888888, correct 72/81
class 2: acc 0.8764044943820225, correct 78/89
class 3: acc 0.9625, correct 77/80
class 4: acc 1.0, correct 92/92

Val Set, val_loss: 1.3119, val_error: 0.4000, auc: 0.8247
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.56, correct 14/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0260, instance_loss: 0.1185, weighted_loss: 0.0538, label: 3, bag_size: 729
batch 39, loss: 0.0060, instance_loss: 0.3648, weighted_loss: 0.1136, label: 4, bag_size: 823
batch 59, loss: 0.0123, instance_loss: 0.2675, weighted_loss: 0.0888, label: 2, bag_size: 317
batch 79, loss: 0.0265, instance_loss: 0.4680, weighted_loss: 0.1589, label: 1, bag_size: 860
batch 99, loss: 0.0158, instance_loss: 0.0981, weighted_loss: 0.0405, label: 0, bag_size: 515
batch 119, loss: 0.0638, instance_loss: 0.1858, weighted_loss: 0.1004, label: 2, bag_size: 247
batch 139, loss: 0.1242, instance_loss: 0.5463, weighted_loss: 0.2508, label: 2, bag_size: 1439
batch 159, loss: 0.1206, instance_loss: 0.3124, weighted_loss: 0.1781, label: 2, bag_size: 537
batch 179, loss: 0.0350, instance_loss: 0.1197, weighted_loss: 0.0604, label: 3, bag_size: 729
batch 199, loss: 0.2348, instance_loss: 0.6403, weighted_loss: 0.3565, label: 2, bag_size: 405
batch 219, loss: 0.0062, instance_loss: 0.0765, weighted_loss: 0.0273, label: 0, bag_size: 367
batch 239, loss: 0.0023, instance_loss: 0.0458, weighted_loss: 0.0153, label: 0, bag_size: 1301
batch 259, loss: 0.0013, instance_loss: 0.2376, weighted_loss: 0.0722, label: 1, bag_size: 1376
batch 279, loss: 0.1562, instance_loss: 0.4969, weighted_loss: 0.2584, label: 2, bag_size: 720
batch 299, loss: 0.2875, instance_loss: 0.2330, weighted_loss: 0.2712, label: 2, bag_size: 482
batch 319, loss: 0.0116, instance_loss: 0.0335, weighted_loss: 0.0182, label: 3, bag_size: 1069
batch 339, loss: 0.0265, instance_loss: 0.0526, weighted_loss: 0.0343, label: 3, bag_size: 729
batch 359, loss: 0.0146, instance_loss: 0.1664, weighted_loss: 0.0602, label: 1, bag_size: 696
batch 379, loss: 0.1612, instance_loss: 0.4164, weighted_loss: 0.2378, label: 2, bag_size: 248
batch 399, loss: 0.0029, instance_loss: 0.2002, weighted_loss: 0.0621, label: 0, bag_size: 729
batch 419, loss: 0.0057, instance_loss: 0.0233, weighted_loss: 0.0110, label: 3, bag_size: 729


class 0 clustering acc 0.9858823529411764: correct 16760/17000
class 1 clustering acc 0.47441176470588237: correct 1613/3400
Epoch: 34, train_loss: 0.2945, train_clustering_loss:  0.3074, train_error: 0.0941
class 0: acc 0.91, correct 91/100
class 1: acc 0.7761194029850746, correct 52/67
class 2: acc 0.8617021276595744, correct 81/94
class 3: acc 0.9647058823529412, correct 82/85
class 4: acc 1.0, correct 79/79

Val Set, val_loss: 1.4788, val_error: 0.3600, auc: 0.7685
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.56, correct 14/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0564, instance_loss: 0.0361, weighted_loss: 0.0503, label: 3, bag_size: 729
batch 39, loss: 0.0356, instance_loss: 0.0349, weighted_loss: 0.0354, label: 3, bag_size: 729
batch 59, loss: 0.0435, instance_loss: 0.0255, weighted_loss: 0.0381, label: 3, bag_size: 405
batch 79, loss: 0.0019, instance_loss: 0.0428, weighted_loss: 0.0142, label: 3, bag_size: 729
batch 99, loss: 0.0021, instance_loss: 0.2165, weighted_loss: 0.0664, label: 4, bag_size: 974
batch 119, loss: 0.0082, instance_loss: 0.1706, weighted_loss: 0.0569, label: 4, bag_size: 1002
batch 139, loss: 0.0640, instance_loss: 0.1948, weighted_loss: 0.1032, label: 1, bag_size: 369
batch 159, loss: 0.6830, instance_loss: 0.7129, weighted_loss: 0.6920, label: 2, bag_size: 959
batch 179, loss: 0.0523, instance_loss: 0.1686, weighted_loss: 0.0871, label: 0, bag_size: 371
batch 199, loss: 0.6187, instance_loss: 0.3524, weighted_loss: 0.5388, label: 2, bag_size: 1348
batch 219, loss: 0.0025, instance_loss: 0.0998, weighted_loss: 0.0317, label: 4, bag_size: 729
batch 239, loss: 0.3579, instance_loss: 0.5364, weighted_loss: 0.4115, label: 3, bag_size: 281
batch 259, loss: 0.1459, instance_loss: 0.5347, weighted_loss: 0.2626, label: 2, bag_size: 679
batch 279, loss: 0.0784, instance_loss: 0.2187, weighted_loss: 0.1205, label: 4, bag_size: 1002
batch 299, loss: 0.0110, instance_loss: 0.0896, weighted_loss: 0.0346, label: 3, bag_size: 729
batch 319, loss: 0.0062, instance_loss: 0.2198, weighted_loss: 0.0703, label: 0, bag_size: 729
batch 339, loss: 0.0071, instance_loss: 0.0525, weighted_loss: 0.0207, label: 0, bag_size: 616
batch 359, loss: 0.0011, instance_loss: 0.6338, weighted_loss: 0.1909, label: 4, bag_size: 663
batch 379, loss: 0.1117, instance_loss: 0.5531, weighted_loss: 0.2442, label: 1, bag_size: 319
batch 399, loss: 0.2223, instance_loss: 0.5734, weighted_loss: 0.3276, label: 2, bag_size: 1439
batch 419, loss: 0.0200, instance_loss: 0.1451, weighted_loss: 0.0575, label: 2, bag_size: 469


class 0 clustering acc 0.9881176470588235: correct 16798/17000
class 1 clustering acc 0.4555882352941176: correct 1549/3400
Epoch: 35, train_loss: 0.1665, train_clustering_loss:  0.2915, train_error: 0.0494
class 0: acc 0.974025974025974, correct 75/77
class 1: acc 0.9157894736842105, correct 87/95
class 2: acc 0.875, correct 77/88
class 3: acc 1.0, correct 71/71
class 4: acc 1.0, correct 94/94

Val Set, val_loss: 1.4386, val_error: 0.4000, auc: 0.8393
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.6, correct 15/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.7170, instance_loss: 0.5557, weighted_loss: 0.6686, label: 0, bag_size: 1065
batch 39, loss: 0.0224, instance_loss: 0.0671, weighted_loss: 0.0358, label: 1, bag_size: 937
batch 59, loss: 0.0437, instance_loss: 0.2063, weighted_loss: 0.0925, label: 0, bag_size: 990
batch 79, loss: 0.3362, instance_loss: 0.4155, weighted_loss: 0.3600, label: 2, bag_size: 471
batch 99, loss: 1.4140, instance_loss: 0.4825, weighted_loss: 1.1345, label: 1, bag_size: 1197
batch 119, loss: 0.0490, instance_loss: 0.2528, weighted_loss: 0.1101, label: 4, bag_size: 826
batch 139, loss: 0.7997, instance_loss: 0.4690, weighted_loss: 0.7005, label: 1, bag_size: 1197
batch 159, loss: 0.0029, instance_loss: 0.0668, weighted_loss: 0.0221, label: 0, bag_size: 1466
batch 179, loss: 0.1329, instance_loss: 0.4317, weighted_loss: 0.2225, label: 2, bag_size: 600
batch 199, loss: 0.0008, instance_loss: 0.3945, weighted_loss: 0.1189, label: 4, bag_size: 663
batch 219, loss: 0.0002, instance_loss: 0.3262, weighted_loss: 0.0980, label: 4, bag_size: 1357
batch 239, loss: 0.0500, instance_loss: 0.3850, weighted_loss: 0.1505, label: 1, bag_size: 897
batch 259, loss: 0.0439, instance_loss: 0.2451, weighted_loss: 0.1043, label: 1, bag_size: 1277
batch 279, loss: 0.0083, instance_loss: 0.2018, weighted_loss: 0.0663, label: 3, bag_size: 821
batch 299, loss: 0.0787, instance_loss: 0.3810, weighted_loss: 0.1694, label: 4, bag_size: 533
batch 319, loss: 0.0438, instance_loss: 0.3231, weighted_loss: 0.1276, label: 1, bag_size: 1127
batch 339, loss: 0.1019, instance_loss: 0.2780, weighted_loss: 0.1547, label: 2, bag_size: 1700
batch 359, loss: 0.0896, instance_loss: 0.3881, weighted_loss: 0.1791, label: 2, bag_size: 317
batch 379, loss: 0.0017, instance_loss: 0.0872, weighted_loss: 0.0274, label: 1, bag_size: 1277
batch 399, loss: 0.0009, instance_loss: 0.2823, weighted_loss: 0.0853, label: 4, bag_size: 729
batch 419, loss: 0.0220, instance_loss: 0.4200, weighted_loss: 0.1414, label: 3, bag_size: 630


class 0 clustering acc 0.9874705882352941: correct 16787/17000
class 1 clustering acc 0.44588235294117645: correct 1516/3400
Epoch: 36, train_loss: 0.1888, train_clustering_loss:  0.2958, train_error: 0.0494
class 0: acc 0.9594594594594594, correct 71/74
class 1: acc 0.9195402298850575, correct 80/87
class 2: acc 0.8705882352941177, correct 74/85
class 3: acc 1.0, correct 84/84
class 4: acc 1.0, correct 95/95

Val Set, val_loss: 1.4680, val_error: 0.4600, auc: 0.8101
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.215: correct 86/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0115, instance_loss: 0.1000, weighted_loss: 0.0380, label: 0, bag_size: 756
batch 39, loss: 0.0133, instance_loss: 0.0684, weighted_loss: 0.0298, label: 0, bag_size: 616
batch 59, loss: 0.3503, instance_loss: 0.3479, weighted_loss: 0.3496, label: 0, bag_size: 423
batch 79, loss: 0.1313, instance_loss: 0.4224, weighted_loss: 0.2186, label: 1, bag_size: 1049
batch 99, loss: 0.8469, instance_loss: 0.5448, weighted_loss: 0.7562, label: 0, bag_size: 423
batch 119, loss: 0.0036, instance_loss: 0.0583, weighted_loss: 0.0200, label: 3, bag_size: 729
batch 139, loss: 0.0795, instance_loss: 0.2623, weighted_loss: 0.1343, label: 4, bag_size: 636
batch 159, loss: 0.0663, instance_loss: 0.2564, weighted_loss: 0.1233, label: 1, bag_size: 1080
batch 179, loss: 0.0007, instance_loss: 0.1056, weighted_loss: 0.0322, label: 4, bag_size: 729
batch 199, loss: 0.2719, instance_loss: 0.4013, weighted_loss: 0.3107, label: 1, bag_size: 846
batch 219, loss: 0.0277, instance_loss: 0.2071, weighted_loss: 0.0815, label: 0, bag_size: 413
batch 239, loss: 0.0185, instance_loss: 0.0618, weighted_loss: 0.0315, label: 3, bag_size: 556
batch 259, loss: 0.4042, instance_loss: 0.6918, weighted_loss: 0.4905, label: 1, bag_size: 293
batch 279, loss: 2.9190, instance_loss: 0.6727, weighted_loss: 2.2451, label: 0, bag_size: 245
batch 299, loss: 0.2329, instance_loss: 0.2697, weighted_loss: 0.2440, label: 4, bag_size: 826
batch 319, loss: 0.0020, instance_loss: 0.0284, weighted_loss: 0.0099, label: 0, bag_size: 933
batch 339, loss: 0.0016, instance_loss: 0.1622, weighted_loss: 0.0498, label: 0, bag_size: 729
batch 359, loss: 0.0006, instance_loss: 0.0431, weighted_loss: 0.0133, label: 4, bag_size: 646
batch 379, loss: 0.0353, instance_loss: 0.2441, weighted_loss: 0.0979, label: 0, bag_size: 1086
batch 399, loss: 0.8117, instance_loss: 0.9605, weighted_loss: 0.8564, label: 2, bag_size: 878
batch 419, loss: 0.1227, instance_loss: 0.3102, weighted_loss: 0.1790, label: 4, bag_size: 436


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.45676470588235296: correct 1553/3400
Epoch: 37, train_loss: 0.2234, train_clustering_loss:  0.2980, train_error: 0.0612
class 0: acc 0.9306930693069307, correct 94/101
class 1: acc 0.8846153846153846, correct 69/78
class 2: acc 0.8941176470588236, correct 76/85
class 3: acc 1.0, correct 84/84
class 4: acc 0.987012987012987, correct 76/77

Val Set, val_loss: 1.2728, val_error: 0.3800, auc: 0.7867
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.68, correct 17/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0442, instance_loss: 0.1162, weighted_loss: 0.0658, label: 0, bag_size: 1012
batch 39, loss: 0.0145, instance_loss: 0.2838, weighted_loss: 0.0953, label: 3, bag_size: 706
batch 59, loss: 1.5576, instance_loss: 0.5530, weighted_loss: 1.2562, label: 1, bag_size: 1197
batch 79, loss: 0.0089, instance_loss: 0.2613, weighted_loss: 0.0846, label: 0, bag_size: 729
batch 99, loss: 0.1501, instance_loss: 0.3927, weighted_loss: 0.2229, label: 2, bag_size: 806
batch 119, loss: 0.0203, instance_loss: 0.2582, weighted_loss: 0.0917, label: 4, bag_size: 773
batch 139, loss: 0.4854, instance_loss: 0.7945, weighted_loss: 0.5781, label: 1, bag_size: 770
batch 159, loss: 0.0007, instance_loss: 0.0591, weighted_loss: 0.0182, label: 0, bag_size: 729
batch 179, loss: 0.0014, instance_loss: 0.2722, weighted_loss: 0.0826, label: 4, bag_size: 773
batch 199, loss: 0.0032, instance_loss: 0.0371, weighted_loss: 0.0134, label: 0, bag_size: 239
batch 219, loss: 0.0625, instance_loss: 0.2827, weighted_loss: 0.1286, label: 1, bag_size: 405
batch 239, loss: 0.0590, instance_loss: 0.2431, weighted_loss: 0.1142, label: 2, bag_size: 621
batch 259, loss: 0.0113, instance_loss: 0.2010, weighted_loss: 0.0682, label: 0, bag_size: 1466
batch 279, loss: 0.0211, instance_loss: 0.0830, weighted_loss: 0.0397, label: 4, bag_size: 729
batch 299, loss: 0.0020, instance_loss: 0.2641, weighted_loss: 0.0807, label: 3, bag_size: 791
batch 319, loss: 0.1858, instance_loss: 0.3911, weighted_loss: 0.2474, label: 2, bag_size: 409
batch 339, loss: 0.1464, instance_loss: 0.6624, weighted_loss: 0.3012, label: 2, bag_size: 679
batch 359, loss: 0.0219, instance_loss: 0.1980, weighted_loss: 0.0747, label: 4, bag_size: 826
batch 379, loss: 0.0107, instance_loss: 0.0970, weighted_loss: 0.0366, label: 1, bag_size: 286
batch 399, loss: 0.0236, instance_loss: 0.3022, weighted_loss: 0.1072, label: 2, bag_size: 312
batch 419, loss: 0.0044, instance_loss: 0.0691, weighted_loss: 0.0238, label: 4, bag_size: 711


class 0 clustering acc 0.988: correct 16796/17000
class 1 clustering acc 0.49941176470588233: correct 1698/3400
Epoch: 38, train_loss: 0.1630, train_clustering_loss:  0.2775, train_error: 0.0424
class 0: acc 0.9819819819819819, correct 109/111
class 1: acc 0.8904109589041096, correct 65/73
class 2: acc 0.8933333333333333, correct 67/75
class 3: acc 1.0, correct 92/92
class 4: acc 1.0, correct 74/74

Val Set, val_loss: 1.4567, val_error: 0.3800, auc: 0.7839
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.22: correct 88/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.52, correct 13/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0956, instance_loss: 0.5169, weighted_loss: 0.2220, label: 1, bag_size: 1014
batch 39, loss: 0.7743, instance_loss: 0.4839, weighted_loss: 0.6872, label: 1, bag_size: 1197
batch 59, loss: 0.3973, instance_loss: 0.5416, weighted_loss: 0.4405, label: 4, bag_size: 1360
batch 79, loss: 0.0291, instance_loss: 0.2778, weighted_loss: 0.1037, label: 1, bag_size: 754
batch 99, loss: 0.0632, instance_loss: 0.1183, weighted_loss: 0.0798, label: 3, bag_size: 1019
batch 119, loss: 0.0100, instance_loss: 0.3762, weighted_loss: 0.1198, label: 4, bag_size: 754
batch 139, loss: 0.0184, instance_loss: 0.0594, weighted_loss: 0.0307, label: 4, bag_size: 1176
batch 159, loss: 0.1503, instance_loss: 0.1750, weighted_loss: 0.1577, label: 0, bag_size: 653
batch 179, loss: 0.1629, instance_loss: 0.2793, weighted_loss: 0.1978, label: 2, bag_size: 1235
batch 199, loss: 0.0032, instance_loss: 0.0857, weighted_loss: 0.0280, label: 4, bag_size: 711
batch 219, loss: 0.0109, instance_loss: 0.4917, weighted_loss: 0.1551, label: 3, bag_size: 630
batch 239, loss: 0.0101, instance_loss: 0.0383, weighted_loss: 0.0186, label: 3, bag_size: 729
batch 259, loss: 0.0037, instance_loss: 0.1384, weighted_loss: 0.0441, label: 0, bag_size: 729
batch 279, loss: 0.0358, instance_loss: 0.4645, weighted_loss: 0.1644, label: 4, bag_size: 754
batch 299, loss: 0.6545, instance_loss: 0.5185, weighted_loss: 0.6137, label: 1, bag_size: 1376
batch 319, loss: 0.0006, instance_loss: 0.1096, weighted_loss: 0.0333, label: 4, bag_size: 729
batch 339, loss: 0.0003, instance_loss: 0.3212, weighted_loss: 0.0966, label: 4, bag_size: 1357
batch 359, loss: 0.1795, instance_loss: 0.5420, weighted_loss: 0.2883, label: 1, bag_size: 487
batch 379, loss: 0.0004, instance_loss: 0.2799, weighted_loss: 0.0843, label: 4, bag_size: 388
batch 399, loss: 0.3925, instance_loss: 0.3403, weighted_loss: 0.3769, label: 2, bag_size: 1052
batch 419, loss: 0.2120, instance_loss: 0.3069, weighted_loss: 0.2405, label: 1, bag_size: 598


class 0 clustering acc 0.9870588235294118: correct 16780/17000
class 1 clustering acc 0.44735294117647056: correct 1521/3400
Epoch: 39, train_loss: 0.2015, train_clustering_loss:  0.2987, train_error: 0.0635
class 0: acc 0.9555555555555556, correct 86/90
class 1: acc 0.8888888888888888, correct 80/90
class 2: acc 0.8522727272727273, correct 75/88
class 3: acc 1.0, correct 84/84
class 4: acc 1.0, correct 73/73

Val Set, val_loss: 1.4840, val_error: 0.4000, auc: 0.7965
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.2275: correct 91/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.52, correct 13/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0639, instance_loss: 0.2267, weighted_loss: 0.1128, label: 0, bag_size: 1101
batch 39, loss: 0.0928, instance_loss: 0.2546, weighted_loss: 0.1413, label: 1, bag_size: 533
batch 59, loss: 0.0196, instance_loss: 0.2047, weighted_loss: 0.0752, label: 2, bag_size: 400
batch 79, loss: 0.2611, instance_loss: 0.3842, weighted_loss: 0.2980, label: 2, bag_size: 1385
batch 99, loss: 0.0061, instance_loss: 0.0355, weighted_loss: 0.0149, label: 3, bag_size: 729
batch 119, loss: 0.0352, instance_loss: 0.4005, weighted_loss: 0.1448, label: 1, bag_size: 1255
batch 139, loss: 0.0032, instance_loss: 0.0215, weighted_loss: 0.0087, label: 3, bag_size: 729
batch 159, loss: 0.4995, instance_loss: 0.4916, weighted_loss: 0.4971, label: 1, bag_size: 102
batch 179, loss: 0.4329, instance_loss: 0.1436, weighted_loss: 0.3461, label: 0, bag_size: 410
batch 199, loss: 0.0055, instance_loss: 0.0407, weighted_loss: 0.0161, label: 0, bag_size: 552
batch 219, loss: 0.0993, instance_loss: 0.3146, weighted_loss: 0.1639, label: 1, bag_size: 847
batch 239, loss: 0.1384, instance_loss: 0.5268, weighted_loss: 0.2549, label: 1, bag_size: 487
batch 259, loss: 0.0442, instance_loss: 0.1046, weighted_loss: 0.0624, label: 3, bag_size: 729
batch 279, loss: 0.0100, instance_loss: 0.5411, weighted_loss: 0.1693, label: 1, bag_size: 648
batch 299, loss: 0.0035, instance_loss: 0.0485, weighted_loss: 0.0170, label: 4, bag_size: 1121
batch 319, loss: 0.5560, instance_loss: 0.4062, weighted_loss: 0.5110, label: 0, bag_size: 437
batch 339, loss: 0.0031, instance_loss: 0.2388, weighted_loss: 0.0738, label: 1, bag_size: 636
batch 359, loss: 0.0133, instance_loss: 0.2345, weighted_loss: 0.0797, label: 4, bag_size: 533
batch 379, loss: 0.0002, instance_loss: 0.0132, weighted_loss: 0.0041, label: 4, bag_size: 729
batch 399, loss: 0.0026, instance_loss: 0.1222, weighted_loss: 0.0385, label: 4, bag_size: 636
batch 419, loss: 0.3327, instance_loss: 0.3686, weighted_loss: 0.3434, label: 2, bag_size: 1006


class 0 clustering acc 0.9879411764705882: correct 16795/17000
class 1 clustering acc 0.4961764705882353: correct 1687/3400
Epoch: 40, train_loss: 0.1446, train_clustering_loss:  0.2725, train_error: 0.0471
class 0: acc 0.9642857142857143, correct 81/84
class 1: acc 0.926829268292683, correct 76/82
class 2: acc 0.8823529411764706, correct 75/85
class 3: acc 0.9878048780487805, correct 81/82
class 4: acc 1.0, correct 92/92

Val Set, val_loss: 1.3904, val_error: 0.4000, auc: 0.8012
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.56, correct 14/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0163, instance_loss: 0.4547, weighted_loss: 0.1478, label: 2, bag_size: 707
batch 39, loss: 0.1916, instance_loss: 0.3473, weighted_loss: 0.2383, label: 2, bag_size: 806
batch 59, loss: 0.0220, instance_loss: 0.2479, weighted_loss: 0.0898, label: 3, bag_size: 343
batch 79, loss: 0.7584, instance_loss: 0.6624, weighted_loss: 0.7296, label: 1, bag_size: 308
batch 99, loss: 0.0014, instance_loss: 0.0652, weighted_loss: 0.0205, label: 4, bag_size: 636
batch 119, loss: 0.0112, instance_loss: 0.5415, weighted_loss: 0.1703, label: 3, bag_size: 630
batch 139, loss: 0.0006, instance_loss: 0.0783, weighted_loss: 0.0239, label: 3, bag_size: 729
batch 159, loss: 0.0004, instance_loss: 0.0744, weighted_loss: 0.0226, label: 4, bag_size: 1235
batch 179, loss: 0.0406, instance_loss: 0.3273, weighted_loss: 0.1266, label: 1, bag_size: 504
batch 199, loss: 0.0084, instance_loss: 0.0967, weighted_loss: 0.0349, label: 0, bag_size: 1046
batch 219, loss: 0.0274, instance_loss: 0.1343, weighted_loss: 0.0595, label: 2, bag_size: 846
batch 239, loss: 0.1261, instance_loss: 0.1380, weighted_loss: 0.1297, label: 3, bag_size: 1177
batch 259, loss: 0.5934, instance_loss: 0.4846, weighted_loss: 0.5608, label: 2, bag_size: 676
batch 279, loss: 0.0189, instance_loss: 0.1498, weighted_loss: 0.0582, label: 1, bag_size: 1086
batch 299, loss: 0.1753, instance_loss: 0.3879, weighted_loss: 0.2391, label: 1, bag_size: 846
batch 319, loss: 0.0068, instance_loss: 0.1773, weighted_loss: 0.0579, label: 0, bag_size: 524
batch 339, loss: 0.2491, instance_loss: 0.7218, weighted_loss: 0.3909, label: 1, bag_size: 770
batch 359, loss: 0.2545, instance_loss: 0.6424, weighted_loss: 0.3709, label: 2, bag_size: 934
batch 379, loss: 1.3366, instance_loss: 0.4345, weighted_loss: 1.0659, label: 1, bag_size: 711
batch 399, loss: 0.3953, instance_loss: 0.4278, weighted_loss: 0.4050, label: 2, bag_size: 1231
batch 419, loss: 0.0006, instance_loss: 0.3870, weighted_loss: 0.1165, label: 1, bag_size: 1152


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.5176470588235295: correct 1760/3400
Epoch: 41, train_loss: 0.1408, train_clustering_loss:  0.2707, train_error: 0.0329
class 0: acc 0.9797979797979798, correct 97/99
class 1: acc 0.9512195121951219, correct 78/82
class 2: acc 0.9, correct 72/80
class 3: acc 1.0, correct 79/79
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.1943, val_error: 0.3000, auc: 0.8154
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.25: correct 100/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.72, correct 18/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0382, instance_loss: 0.1774, weighted_loss: 0.0799, label: 2, bag_size: 614
batch 39, loss: 0.0046, instance_loss: 0.4078, weighted_loss: 0.1256, label: 3, bag_size: 791
batch 59, loss: 0.2834, instance_loss: 0.4863, weighted_loss: 0.3443, label: 3, bag_size: 200
batch 79, loss: 0.0076, instance_loss: 0.1940, weighted_loss: 0.0635, label: 4, bag_size: 625
batch 99, loss: 0.0529, instance_loss: 0.0714, weighted_loss: 0.0585, label: 3, bag_size: 1069
batch 119, loss: 1.8514, instance_loss: 0.5274, weighted_loss: 1.4542, label: 1, bag_size: 1255
batch 139, loss: 0.1006, instance_loss: 0.4103, weighted_loss: 0.1935, label: 1, bag_size: 1646
batch 159, loss: 0.0995, instance_loss: 0.4745, weighted_loss: 0.2120, label: 4, bag_size: 1337
batch 179, loss: 0.0006, instance_loss: 0.1667, weighted_loss: 0.0504, label: 0, bag_size: 729
batch 199, loss: 0.0619, instance_loss: 0.1413, weighted_loss: 0.0857, label: 4, bag_size: 790
batch 219, loss: 0.0967, instance_loss: 0.6894, weighted_loss: 0.2745, label: 2, bag_size: 758
batch 239, loss: 0.0214, instance_loss: 0.3523, weighted_loss: 0.1206, label: 2, bag_size: 1180
batch 259, loss: 0.0976, instance_loss: 0.0447, weighted_loss: 0.0817, label: 4, bag_size: 729
batch 279, loss: 0.0059, instance_loss: 0.2470, weighted_loss: 0.0783, label: 1, bag_size: 1086
batch 299, loss: 0.0260, instance_loss: 0.0613, weighted_loss: 0.0366, label: 0, bag_size: 1579
batch 319, loss: 0.6848, instance_loss: 0.5443, weighted_loss: 0.6427, label: 1, bag_size: 786
batch 339, loss: 0.0153, instance_loss: 0.2661, weighted_loss: 0.0906, label: 2, bag_size: 499
batch 359, loss: 0.0028, instance_loss: 0.0512, weighted_loss: 0.0174, label: 3, bag_size: 952
batch 379, loss: 0.0052, instance_loss: 0.2407, weighted_loss: 0.0759, label: 1, bag_size: 696
batch 399, loss: 0.0045, instance_loss: 0.0426, weighted_loss: 0.0159, label: 0, bag_size: 921
batch 419, loss: 0.1479, instance_loss: 0.1030, weighted_loss: 0.1344, label: 4, bag_size: 729


class 0 clustering acc 0.989: correct 16813/17000
class 1 clustering acc 0.49470588235294116: correct 1682/3400
Epoch: 42, train_loss: 0.1279, train_clustering_loss:  0.2776, train_error: 0.0424
class 0: acc 0.9868421052631579, correct 75/76
class 1: acc 0.9125, correct 73/80
class 2: acc 0.8888888888888888, correct 72/81
class 3: acc 1.0, correct 90/90
class 4: acc 0.9897959183673469, correct 97/98

Val Set, val_loss: 1.5552, val_error: 0.4000, auc: 0.8013
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.52, correct 13/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0045, instance_loss: 0.0836, weighted_loss: 0.0282, label: 3, bag_size: 729
batch 39, loss: 0.0390, instance_loss: 0.2233, weighted_loss: 0.0943, label: 4, bag_size: 826
batch 59, loss: 0.0001, instance_loss: 0.1051, weighted_loss: 0.0316, label: 4, bag_size: 729
batch 79, loss: 0.0077, instance_loss: 0.0333, weighted_loss: 0.0154, label: 0, bag_size: 1101
batch 99, loss: 0.0359, instance_loss: 0.2318, weighted_loss: 0.0947, label: 1, bag_size: 690
batch 119, loss: 0.0124, instance_loss: 0.1166, weighted_loss: 0.0437, label: 0, bag_size: 515
batch 139, loss: 0.0225, instance_loss: 0.1164, weighted_loss: 0.0507, label: 0, bag_size: 1196
batch 159, loss: 0.3200, instance_loss: 0.2865, weighted_loss: 0.3099, label: 0, bag_size: 552
batch 179, loss: 0.0042, instance_loss: 0.1147, weighted_loss: 0.0373, label: 4, bag_size: 817
batch 199, loss: 3.7014, instance_loss: 0.8041, weighted_loss: 2.8322, label: 3, bag_size: 281
batch 219, loss: 0.0080, instance_loss: 0.3355, weighted_loss: 0.1062, label: 4, bag_size: 754
batch 239, loss: 0.0010, instance_loss: 0.1280, weighted_loss: 0.0391, label: 4, bag_size: 524
batch 259, loss: 0.0832, instance_loss: 0.5887, weighted_loss: 0.2348, label: 2, bag_size: 518
batch 279, loss: 0.0268, instance_loss: 0.5355, weighted_loss: 0.1794, label: 1, bag_size: 442
batch 299, loss: 0.0074, instance_loss: 0.3931, weighted_loss: 0.1231, label: 1, bag_size: 242
batch 319, loss: 0.0055, instance_loss: 0.0840, weighted_loss: 0.0290, label: 4, bag_size: 1002
batch 339, loss: 0.0082, instance_loss: 0.0796, weighted_loss: 0.0297, label: 0, bag_size: 1101
batch 359, loss: 0.0095, instance_loss: 0.3492, weighted_loss: 0.1114, label: 4, bag_size: 533
batch 379, loss: 0.0076, instance_loss: 0.2112, weighted_loss: 0.0687, label: 1, bag_size: 534
batch 399, loss: 0.0042, instance_loss: 0.0829, weighted_loss: 0.0278, label: 4, bag_size: 729
batch 419, loss: 0.0234, instance_loss: 0.0842, weighted_loss: 0.0416, label: 3, bag_size: 729


class 0 clustering acc 0.9881176470588235: correct 16798/17000
class 1 clustering acc 0.5055882352941177: correct 1719/3400
Epoch: 43, train_loss: 0.1325, train_clustering_loss:  0.2715, train_error: 0.0376
class 0: acc 0.9523809523809523, correct 100/105
class 1: acc 0.9411764705882353, correct 64/68
class 2: acc 0.9230769230769231, correct 72/78
class 3: acc 0.9885057471264368, correct 86/87
class 4: acc 1.0, correct 87/87

Val Set, val_loss: 1.4848, val_error: 0.4200, auc: 0.8236
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.22: correct 88/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.8056, instance_loss: 0.6457, weighted_loss: 0.7576, label: 1, bag_size: 446
batch 39, loss: 0.0109, instance_loss: 0.0707, weighted_loss: 0.0289, label: 3, bag_size: 1177
batch 59, loss: 0.0002, instance_loss: 0.0711, weighted_loss: 0.0214, label: 4, bag_size: 729
batch 79, loss: 0.0597, instance_loss: 0.2349, weighted_loss: 0.1122, label: 0, bag_size: 807
batch 99, loss: 0.1348, instance_loss: 0.2946, weighted_loss: 0.1827, label: 2, bag_size: 701
batch 119, loss: 0.0006, instance_loss: 0.0149, weighted_loss: 0.0049, label: 0, bag_size: 616
batch 139, loss: 0.4531, instance_loss: 0.3633, weighted_loss: 0.4262, label: 2, bag_size: 828
batch 159, loss: 0.0044, instance_loss: 0.1472, weighted_loss: 0.0472, label: 1, bag_size: 1261
batch 179, loss: 1.4728, instance_loss: 0.6933, weighted_loss: 1.2389, label: 0, bag_size: 818
batch 199, loss: 0.0016, instance_loss: 0.2942, weighted_loss: 0.0893, label: 1, bag_size: 866
batch 219, loss: 0.0043, instance_loss: 0.6821, weighted_loss: 0.2076, label: 1, bag_size: 1127
batch 239, loss: 0.0439, instance_loss: 0.4168, weighted_loss: 0.1557, label: 1, bag_size: 1014
batch 259, loss: 0.1039, instance_loss: 0.6318, weighted_loss: 0.2623, label: 3, bag_size: 281
batch 279, loss: 0.0073, instance_loss: 0.2879, weighted_loss: 0.0915, label: 1, bag_size: 890
batch 299, loss: 0.0000, instance_loss: 0.0215, weighted_loss: 0.0065, label: 4, bag_size: 729
batch 319, loss: 0.0107, instance_loss: 0.3573, weighted_loss: 0.1146, label: 3, bag_size: 305
batch 339, loss: 0.0044, instance_loss: 0.1010, weighted_loss: 0.0334, label: 1, bag_size: 886
batch 359, loss: 0.0170, instance_loss: 0.2966, weighted_loss: 0.1009, label: 0, bag_size: 515
batch 379, loss: 0.0996, instance_loss: 0.5063, weighted_loss: 0.2216, label: 1, bag_size: 319
batch 399, loss: 0.0015, instance_loss: 0.0514, weighted_loss: 0.0164, label: 3, bag_size: 729
batch 419, loss: 0.0726, instance_loss: 0.4730, weighted_loss: 0.1927, label: 4, bag_size: 1337


class 0 clustering acc 0.9875294117647059: correct 16788/17000
class 1 clustering acc 0.5158823529411765: correct 1754/3400
Epoch: 44, train_loss: 0.1051, train_clustering_loss:  0.2716, train_error: 0.0329
class 0: acc 0.9662921348314607, correct 86/89
class 1: acc 0.9560439560439561, correct 87/91
class 2: acc 0.9078947368421053, correct 69/76
class 3: acc 1.0, correct 86/86
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.7900, val_error: 0.4400, auc: 0.8193
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.26: correct 104/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.52, correct 13/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0767, weighted_loss: 0.0231, label: 0, bag_size: 729
batch 39, loss: 0.1393, instance_loss: 0.5979, weighted_loss: 0.2769, label: 2, bag_size: 1439
batch 59, loss: 0.0035, instance_loss: 0.1055, weighted_loss: 0.0341, label: 0, bag_size: 255
batch 79, loss: 0.2870, instance_loss: 0.5157, weighted_loss: 0.3556, label: 0, bag_size: 718
batch 99, loss: 0.0086, instance_loss: 0.0963, weighted_loss: 0.0349, label: 0, bag_size: 446
batch 119, loss: 0.0164, instance_loss: 0.3722, weighted_loss: 0.1232, label: 1, bag_size: 711
batch 139, loss: 0.0050, instance_loss: 0.0389, weighted_loss: 0.0152, label: 1, bag_size: 937
batch 159, loss: 0.9590, instance_loss: 0.6178, weighted_loss: 0.8566, label: 2, bag_size: 1231
batch 179, loss: 0.0000, instance_loss: 0.0829, weighted_loss: 0.0249, label: 4, bag_size: 729
batch 199, loss: 0.0139, instance_loss: 0.1419, weighted_loss: 0.0523, label: 0, bag_size: 552
batch 219, loss: 0.0005, instance_loss: 0.0683, weighted_loss: 0.0208, label: 3, bag_size: 821
batch 239, loss: 0.0017, instance_loss: 0.2490, weighted_loss: 0.0759, label: 1, bag_size: 834
batch 259, loss: 0.0078, instance_loss: 0.0861, weighted_loss: 0.0313, label: 4, bag_size: 1176
batch 279, loss: 0.0981, instance_loss: 0.3966, weighted_loss: 0.1876, label: 1, bag_size: 711
batch 299, loss: 0.0082, instance_loss: 0.0721, weighted_loss: 0.0274, label: 3, bag_size: 821
batch 319, loss: 0.0356, instance_loss: 0.3700, weighted_loss: 0.1359, label: 2, bag_size: 1232
batch 339, loss: 0.0559, instance_loss: 0.2739, weighted_loss: 0.1213, label: 1, bag_size: 818
batch 359, loss: 0.0277, instance_loss: 0.2399, weighted_loss: 0.0914, label: 0, bag_size: 413
batch 379, loss: 0.0147, instance_loss: 0.3975, weighted_loss: 0.1295, label: 1, bag_size: 1014
batch 399, loss: 0.0010, instance_loss: 0.0274, weighted_loss: 0.0089, label: 0, bag_size: 933
batch 419, loss: 0.0817, instance_loss: 0.3122, weighted_loss: 0.1509, label: 2, bag_size: 676


class 0 clustering acc 0.9877058823529412: correct 16791/17000
class 1 clustering acc 0.5038235294117647: correct 1713/3400
Epoch: 45, train_loss: 0.1364, train_clustering_loss:  0.2804, train_error: 0.0353
class 0: acc 0.9770114942528736, correct 85/87
class 1: acc 0.946236559139785, correct 88/93
class 2: acc 0.9090909090909091, correct 80/88
class 3: acc 1.0, correct 90/90
class 4: acc 1.0, correct 67/67

Val Set, val_loss: 1.4465, val_error: 0.3800, auc: 0.7993
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.6, correct 15/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0023, instance_loss: 0.0588, weighted_loss: 0.0193, label: 0, bag_size: 552
batch 39, loss: 0.0412, instance_loss: 0.1954, weighted_loss: 0.0875, label: 0, bag_size: 1065
batch 59, loss: 0.0031, instance_loss: 0.1899, weighted_loss: 0.0591, label: 4, bag_size: 1002
batch 79, loss: 0.0062, instance_loss: 0.1235, weighted_loss: 0.0414, label: 0, bag_size: 410
batch 99, loss: 0.0563, instance_loss: 0.3845, weighted_loss: 0.1547, label: 3, bag_size: 697
batch 119, loss: 0.0022, instance_loss: 0.0760, weighted_loss: 0.0243, label: 4, bag_size: 729
batch 139, loss: 0.4464, instance_loss: 0.5981, weighted_loss: 0.4919, label: 0, bag_size: 818
batch 159, loss: 0.0005, instance_loss: 0.1175, weighted_loss: 0.0356, label: 0, bag_size: 729
batch 179, loss: 0.0854, instance_loss: 0.4431, weighted_loss: 0.1927, label: 0, bag_size: 282
batch 199, loss: 0.0004, instance_loss: 0.1441, weighted_loss: 0.0435, label: 0, bag_size: 729
batch 219, loss: 0.0053, instance_loss: 0.0542, weighted_loss: 0.0200, label: 0, bag_size: 446
batch 239, loss: 0.0411, instance_loss: 0.3060, weighted_loss: 0.1206, label: 2, bag_size: 1123
batch 259, loss: 0.0051, instance_loss: 0.1784, weighted_loss: 0.0571, label: 1, bag_size: 944
batch 279, loss: 0.0028, instance_loss: 0.0827, weighted_loss: 0.0268, label: 1, bag_size: 1191
batch 299, loss: 0.0071, instance_loss: 0.1155, weighted_loss: 0.0397, label: 1, bag_size: 288
batch 319, loss: 0.0024, instance_loss: 0.0462, weighted_loss: 0.0156, label: 1, bag_size: 286
batch 339, loss: 0.0409, instance_loss: 0.2402, weighted_loss: 0.1007, label: 2, bag_size: 252
batch 359, loss: 0.0039, instance_loss: 0.0702, weighted_loss: 0.0238, label: 3, bag_size: 952
batch 379, loss: 0.0057, instance_loss: 0.2039, weighted_loss: 0.0651, label: 0, bag_size: 1301
batch 399, loss: 0.3502, instance_loss: 0.1975, weighted_loss: 0.3044, label: 3, bag_size: 1019
batch 419, loss: 0.0027, instance_loss: 0.1254, weighted_loss: 0.0395, label: 4, bag_size: 1002


class 0 clustering acc 0.9861764705882353: correct 16765/17000
class 1 clustering acc 0.5423529411764706: correct 1844/3400
Epoch: 46, train_loss: 0.1262, train_clustering_loss:  0.2640, train_error: 0.0376
class 0: acc 0.967391304347826, correct 89/92
class 1: acc 0.9607843137254902, correct 98/102
class 2: acc 0.8656716417910447, correct 58/67
class 3: acc 1.0, correct 86/86
class 4: acc 1.0, correct 78/78

Val Set, val_loss: 1.3900, val_error: 0.3800, auc: 0.7783
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.56, correct 14/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0378, weighted_loss: 0.0113, label: 4, bag_size: 729
batch 39, loss: 0.0000, instance_loss: 0.1903, weighted_loss: 0.0571, label: 4, bag_size: 388
batch 59, loss: 0.0088, instance_loss: 0.0245, weighted_loss: 0.0135, label: 3, bag_size: 405
batch 79, loss: 0.1928, instance_loss: 0.6773, weighted_loss: 0.3382, label: 1, bag_size: 778
batch 99, loss: 0.1623, instance_loss: 0.4521, weighted_loss: 0.2492, label: 4, bag_size: 1360
batch 119, loss: 0.0011, instance_loss: 0.0374, weighted_loss: 0.0120, label: 4, bag_size: 729
batch 139, loss: 0.2146, instance_loss: 0.4383, weighted_loss: 0.2817, label: 2, bag_size: 508
batch 159, loss: 0.0001, instance_loss: 0.0848, weighted_loss: 0.0255, label: 4, bag_size: 1278
batch 179, loss: 0.0009, instance_loss: 0.5478, weighted_loss: 0.1649, label: 4, bag_size: 663
batch 199, loss: 0.0003, instance_loss: 0.1049, weighted_loss: 0.0317, label: 4, bag_size: 1278
batch 219, loss: 0.0082, instance_loss: 0.0844, weighted_loss: 0.0311, label: 3, bag_size: 729
batch 239, loss: 0.0022, instance_loss: 0.2048, weighted_loss: 0.0630, label: 3, bag_size: 791
batch 259, loss: 0.0983, instance_loss: 0.3920, weighted_loss: 0.1864, label: 3, bag_size: 1380
batch 279, loss: 0.0061, instance_loss: 0.0564, weighted_loss: 0.0212, label: 0, bag_size: 1143
batch 299, loss: 0.0255, instance_loss: 0.2126, weighted_loss: 0.0816, label: 1, bag_size: 818
batch 319, loss: 0.0048, instance_loss: 0.3547, weighted_loss: 0.1098, label: 2, bag_size: 245
batch 339, loss: 0.0412, instance_loss: 0.2250, weighted_loss: 0.0963, label: 0, bag_size: 1332
batch 359, loss: 0.0000, instance_loss: 0.0136, weighted_loss: 0.0041, label: 4, bag_size: 764
batch 379, loss: 0.0134, instance_loss: 0.1794, weighted_loss: 0.0632, label: 1, bag_size: 858
batch 399, loss: 0.0053, instance_loss: 0.1724, weighted_loss: 0.0554, label: 0, bag_size: 756
batch 419, loss: 0.0009, instance_loss: 0.0578, weighted_loss: 0.0180, label: 4, bag_size: 729


class 0 clustering acc 0.9896470588235294: correct 16824/17000
class 1 clustering acc 0.49205882352941177: correct 1673/3400
Epoch: 47, train_loss: 0.1082, train_clustering_loss:  0.2717, train_error: 0.0235
class 0: acc 0.9655172413793104, correct 84/87
class 1: acc 0.967032967032967, correct 88/91
class 2: acc 0.9605263157894737, correct 73/76
class 3: acc 1.0, correct 87/87
class 4: acc 0.9880952380952381, correct 83/84

Val Set, val_loss: 1.4770, val_error: 0.4200, auc: 0.8096
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.0008, instance_loss: 0.0163, weighted_loss: 0.0054, label: 0, bag_size: 602
batch 39, loss: 0.0306, instance_loss: 0.3559, weighted_loss: 0.1282, label: 3, bag_size: 305
batch 59, loss: 0.0014, instance_loss: 0.0741, weighted_loss: 0.0232, label: 1, bag_size: 690
batch 79, loss: 0.0031, instance_loss: 0.1018, weighted_loss: 0.0327, label: 3, bag_size: 729
batch 99, loss: 4.9653, instance_loss: 0.3332, weighted_loss: 3.5757, label: 0, bag_size: 1190
batch 119, loss: 0.0000, instance_loss: 0.1823, weighted_loss: 0.0547, label: 0, bag_size: 729
batch 139, loss: 0.0343, instance_loss: 0.2115, weighted_loss: 0.0875, label: 4, bag_size: 729
batch 159, loss: 0.0010, instance_loss: 0.0345, weighted_loss: 0.0111, label: 0, bag_size: 933
batch 179, loss: 0.0009, instance_loss: 0.1244, weighted_loss: 0.0380, label: 0, bag_size: 729
batch 199, loss: 0.1332, instance_loss: 0.5182, weighted_loss: 0.2487, label: 3, bag_size: 317
batch 219, loss: 0.0230, instance_loss: 0.2924, weighted_loss: 0.1038, label: 0, bag_size: 552
batch 239, loss: 0.1795, instance_loss: 0.4414, weighted_loss: 0.2581, label: 2, bag_size: 358
batch 259, loss: 0.0427, instance_loss: 0.2150, weighted_loss: 0.0944, label: 1, bag_size: 886
batch 279, loss: 0.1124, instance_loss: 0.2630, weighted_loss: 0.1576, label: 0, bag_size: 736
batch 299, loss: 0.0005, instance_loss: 0.0957, weighted_loss: 0.0291, label: 4, bag_size: 1278
batch 319, loss: 0.0720, instance_loss: 0.6756, weighted_loss: 0.2531, label: 3, bag_size: 1380
batch 339, loss: 0.1512, instance_loss: 0.5483, weighted_loss: 0.2704, label: 0, bag_size: 1065
batch 359, loss: 0.0080, instance_loss: 0.6642, weighted_loss: 0.2048, label: 1, bag_size: 648
batch 379, loss: 0.0649, instance_loss: 0.2090, weighted_loss: 0.1081, label: 0, bag_size: 340
batch 399, loss: 0.0007, instance_loss: 0.0146, weighted_loss: 0.0049, label: 0, bag_size: 1466
batch 419, loss: 0.0079, instance_loss: 0.2047, weighted_loss: 0.0670, label: 4, bag_size: 817


class 0 clustering acc 0.9882352941176471: correct 16800/17000
class 1 clustering acc 0.5120588235294118: correct 1741/3400
Epoch: 48, train_loss: 0.1503, train_clustering_loss:  0.2768, train_error: 0.0471
class 0: acc 0.9782608695652174, correct 90/92
class 1: acc 0.9146341463414634, correct 75/82
class 2: acc 0.8777777777777778, correct 79/90
class 3: acc 1.0, correct 83/83
class 4: acc 1.0, correct 78/78

Val Set, val_loss: 1.5331, val_error: 0.4000, auc: 0.8150
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.225: correct 90/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.0043, instance_loss: 0.0320, weighted_loss: 0.0126, label: 4, bag_size: 636
batch 39, loss: 0.0018, instance_loss: 0.0602, weighted_loss: 0.0193, label: 4, bag_size: 1278
batch 59, loss: 0.1278, instance_loss: 0.6641, weighted_loss: 0.2887, label: 3, bag_size: 1380
batch 79, loss: 1.8619, instance_loss: 0.4199, weighted_loss: 1.4293, label: 2, bag_size: 748
batch 99, loss: 0.0005, instance_loss: 0.0349, weighted_loss: 0.0108, label: 0, bag_size: 360
batch 119, loss: 0.0007, instance_loss: 0.0189, weighted_loss: 0.0062, label: 3, bag_size: 729
batch 139, loss: 0.0041, instance_loss: 0.1875, weighted_loss: 0.0591, label: 1, bag_size: 828
batch 159, loss: 0.0324, instance_loss: 0.1753, weighted_loss: 0.0753, label: 2, bag_size: 1019
batch 179, loss: 0.0048, instance_loss: 0.0435, weighted_loss: 0.0164, label: 0, bag_size: 602
batch 199, loss: 0.0169, instance_loss: 0.3031, weighted_loss: 0.1028, label: 1, bag_size: 1724
batch 219, loss: 0.1668, instance_loss: 0.3906, weighted_loss: 0.2340, label: 4, bag_size: 773
batch 239, loss: 0.0004, instance_loss: 0.0191, weighted_loss: 0.0060, label: 4, bag_size: 764
batch 259, loss: 0.1891, instance_loss: 0.4467, weighted_loss: 0.2664, label: 3, bag_size: 671
batch 279, loss: 0.0903, instance_loss: 0.6067, weighted_loss: 0.2452, label: 1, bag_size: 778
batch 299, loss: 0.1456, instance_loss: 0.3539, weighted_loss: 0.2081, label: 1, bag_size: 925
batch 319, loss: 0.0417, instance_loss: 0.2480, weighted_loss: 0.1036, label: 0, bag_size: 437
batch 339, loss: 0.0008, instance_loss: 0.4405, weighted_loss: 0.1327, label: 4, bag_size: 663
batch 359, loss: 0.1207, instance_loss: 0.3085, weighted_loss: 0.1770, label: 0, bag_size: 424
batch 379, loss: 0.5663, instance_loss: 0.5578, weighted_loss: 0.5638, label: 2, bag_size: 1385
batch 399, loss: 0.0089, instance_loss: 0.1702, weighted_loss: 0.0573, label: 1, bag_size: 1277
batch 419, loss: 0.0072, instance_loss: 0.1181, weighted_loss: 0.0405, label: 0, bag_size: 1086


class 0 clustering acc 0.9850588235294118: correct 16746/17000
class 1 clustering acc 0.5070588235294118: correct 1724/3400
Epoch: 49, train_loss: 0.1540, train_clustering_loss:  0.2826, train_error: 0.0424
class 0: acc 0.9651162790697675, correct 83/86
class 1: acc 0.9813084112149533, correct 105/107
class 2: acc 0.875, correct 70/80
class 3: acc 0.9746835443037974, correct 77/79
class 4: acc 0.9863013698630136, correct 72/73

Val Set, val_loss: 1.5679, val_error: 0.4400, auc: 0.8138
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.48, correct 12/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.1027, instance_loss: 0.4168, weighted_loss: 0.1969, label: 2, bag_size: 750
batch 39, loss: 0.0109, instance_loss: 0.1265, weighted_loss: 0.0456, label: 1, bag_size: 790
batch 59, loss: 0.0285, instance_loss: 0.2194, weighted_loss: 0.0858, label: 0, bag_size: 1143
batch 79, loss: 0.0110, instance_loss: 0.1400, weighted_loss: 0.0497, label: 0, bag_size: 371
batch 99, loss: 0.0114, instance_loss: 0.2459, weighted_loss: 0.0818, label: 2, bag_size: 1155
batch 119, loss: 0.0111, instance_loss: 0.0208, weighted_loss: 0.0140, label: 3, bag_size: 556
batch 139, loss: 0.1508, instance_loss: 0.2968, weighted_loss: 0.1946, label: 1, bag_size: 598
batch 159, loss: 0.0188, instance_loss: 0.2595, weighted_loss: 0.0910, label: 2, bag_size: 758
batch 179, loss: 0.0000, instance_loss: 0.1003, weighted_loss: 0.0301, label: 0, bag_size: 729
batch 199, loss: 0.0128, instance_loss: 0.2586, weighted_loss: 0.0865, label: 3, bag_size: 1559
batch 219, loss: 0.0012, instance_loss: 0.1117, weighted_loss: 0.0344, label: 0, bag_size: 1301
batch 239, loss: 0.0042, instance_loss: 0.0487, weighted_loss: 0.0176, label: 3, bag_size: 952
batch 259, loss: 0.0106, instance_loss: 0.0452, weighted_loss: 0.0210, label: 3, bag_size: 556
batch 279, loss: 0.0232, instance_loss: 0.4007, weighted_loss: 0.1364, label: 1, bag_size: 405
batch 299, loss: 0.1447, instance_loss: 0.4095, weighted_loss: 0.2241, label: 2, bag_size: 911
batch 319, loss: 0.0469, instance_loss: 0.4600, weighted_loss: 0.1708, label: 3, bag_size: 281
batch 339, loss: 0.0955, instance_loss: 0.4387, weighted_loss: 0.1985, label: 2, bag_size: 1231
batch 359, loss: 0.0753, instance_loss: 0.1685, weighted_loss: 0.1033, label: 3, bag_size: 729
batch 379, loss: 0.0032, instance_loss: 0.1334, weighted_loss: 0.0423, label: 2, bag_size: 1289
batch 399, loss: 0.1140, instance_loss: 0.5022, weighted_loss: 0.2305, label: 1, bag_size: 778
batch 419, loss: 0.0288, instance_loss: 0.5612, weighted_loss: 0.1886, label: 3, bag_size: 281


class 0 clustering acc 0.9893529411764705: correct 16819/17000
class 1 clustering acc 0.49970588235294117: correct 1699/3400
Epoch: 50, train_loss: 0.1027, train_clustering_loss:  0.2703, train_error: 0.0259
class 0: acc 0.9418604651162791, correct 81/86
class 1: acc 0.967391304347826, correct 89/92
class 2: acc 0.9647058823529412, correct 82/85
class 3: acc 1.0, correct 96/96
class 4: acc 1.0, correct 66/66

Val Set, val_loss: 1.5475, val_error: 0.3800, auc: 0.7859
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.52, correct 13/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.0032, instance_loss: 0.1010, weighted_loss: 0.0326, label: 0, bag_size: 375
batch 39, loss: 0.0044, instance_loss: 0.0180, weighted_loss: 0.0085, label: 3, bag_size: 729
batch 59, loss: 0.0288, instance_loss: 0.3499, weighted_loss: 0.1252, label: 2, bag_size: 600
batch 79, loss: 0.0114, instance_loss: 0.0279, weighted_loss: 0.0163, label: 3, bag_size: 405
batch 99, loss: 0.0003, instance_loss: 0.1058, weighted_loss: 0.0319, label: 4, bag_size: 729
batch 119, loss: 0.1045, instance_loss: 0.1714, weighted_loss: 0.1245, label: 0, bag_size: 760
batch 139, loss: 0.0153, instance_loss: 0.5091, weighted_loss: 0.1634, label: 2, bag_size: 679
batch 159, loss: 0.0221, instance_loss: 0.0996, weighted_loss: 0.0454, label: 0, bag_size: 1101
batch 179, loss: 0.0029, instance_loss: 0.0976, weighted_loss: 0.0313, label: 0, bag_size: 552
batch 199, loss: 1.4712, instance_loss: 0.6542, weighted_loss: 1.2261, label: 2, bag_size: 194
batch 219, loss: 0.0005, instance_loss: 0.1627, weighted_loss: 0.0492, label: 0, bag_size: 729
batch 239, loss: 0.2469, instance_loss: 0.4977, weighted_loss: 0.3221, label: 3, bag_size: 281
batch 259, loss: 0.0480, instance_loss: 0.4537, weighted_loss: 0.1697, label: 2, bag_size: 237
batch 279, loss: 0.0506, instance_loss: 0.4052, weighted_loss: 0.1570, label: 1, bag_size: 1273
batch 299, loss: 0.0202, instance_loss: 0.1470, weighted_loss: 0.0582, label: 3, bag_size: 1019
batch 319, loss: 0.0005, instance_loss: 0.0892, weighted_loss: 0.0271, label: 3, bag_size: 729
batch 339, loss: 0.0002, instance_loss: 0.0917, weighted_loss: 0.0276, label: 0, bag_size: 729
batch 359, loss: 0.0869, instance_loss: 0.4438, weighted_loss: 0.1940, label: 4, bag_size: 436
batch 379, loss: 0.2656, instance_loss: 0.2441, weighted_loss: 0.2591, label: 2, bag_size: 391
batch 399, loss: 0.1262, instance_loss: 0.2398, weighted_loss: 0.1603, label: 0, bag_size: 760
batch 419, loss: 0.0064, instance_loss: 0.1540, weighted_loss: 0.0507, label: 4, bag_size: 817


class 0 clustering acc 0.9865882352941177: correct 16772/17000
class 1 clustering acc 0.5052941176470588: correct 1718/3400
Epoch: 51, train_loss: 0.0885, train_clustering_loss:  0.2736, train_error: 0.0259
class 0: acc 0.9885057471264368, correct 86/87
class 1: acc 0.97, correct 97/100
class 2: acc 0.9213483146067416, correct 82/89
class 3: acc 1.0, correct 84/84
class 4: acc 1.0, correct 65/65

Val Set, val_loss: 1.3971, val_error: 0.3400, auc: 0.8203
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.68, correct 17/25
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 44 out of 20
Early stopping
Val error: 0.2600, ROC AUC: 0.8809
Test error: 0.4800, ROC AUC: 0.7940
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.0, correct 0/5

Training Fold 5!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.8922, instance_loss: 1.1869, weighted_loss: 1.6806, label: 2, bag_size: 948
batch 39, loss: 1.2235, instance_loss: 0.9441, weighted_loss: 1.1397, label: 3, bag_size: 729
batch 59, loss: 1.2143, instance_loss: 0.8832, weighted_loss: 1.1150, label: 3, bag_size: 729
batch 79, loss: 1.7064, instance_loss: 0.7563, weighted_loss: 1.4214, label: 1, bag_size: 696
batch 99, loss: 1.9067, instance_loss: 0.6722, weighted_loss: 1.5364, label: 2, bag_size: 499
batch 119, loss: 1.6677, instance_loss: 0.6309, weighted_loss: 1.3567, label: 0, bag_size: 729
batch 139, loss: 1.2876, instance_loss: 0.5162, weighted_loss: 1.0562, label: 4, bag_size: 646
batch 159, loss: 1.5396, instance_loss: 0.5312, weighted_loss: 1.2371, label: 3, bag_size: 729
batch 179, loss: 1.4659, instance_loss: 0.5199, weighted_loss: 1.1821, label: 1, bag_size: 1144
batch 199, loss: 1.7382, instance_loss: 0.5393, weighted_loss: 1.3785, label: 0, bag_size: 1289
batch 219, loss: 1.5723, instance_loss: 0.5249, weighted_loss: 1.2581, label: 0, bag_size: 1143
batch 239, loss: 1.7040, instance_loss: 0.4993, weighted_loss: 1.3426, label: 4, bag_size: 1176
batch 259, loss: 1.6855, instance_loss: 0.5210, weighted_loss: 1.3362, label: 0, bag_size: 245
batch 279, loss: 1.2493, instance_loss: 0.4908, weighted_loss: 1.0217, label: 4, bag_size: 729
batch 299, loss: 1.3438, instance_loss: 0.5105, weighted_loss: 1.0938, label: 0, bag_size: 1133
batch 319, loss: 1.7956, instance_loss: 0.5186, weighted_loss: 1.4125, label: 1, bag_size: 696
batch 339, loss: 1.7523, instance_loss: 0.5218, weighted_loss: 1.3832, label: 1, bag_size: 530
batch 359, loss: 1.4373, instance_loss: 0.5138, weighted_loss: 1.1602, label: 1, bag_size: 318
batch 379, loss: 1.5040, instance_loss: 0.4903, weighted_loss: 1.1999, label: 4, bag_size: 656
batch 399, loss: 1.9931, instance_loss: 0.5487, weighted_loss: 1.5598, label: 0, bag_size: 800
batch 419, loss: 1.5794, instance_loss: 0.5059, weighted_loss: 1.2574, label: 2, bag_size: 649


class 0 clustering acc 0.990764705882353: correct 16843/17000
class 1 clustering acc 0.01588235294117647: correct 54/3400
Epoch: 0, train_loss: 1.5849, train_clustering_loss:  0.6229, train_error: 0.7294
class 0: acc 0.025, correct 2/80
class 1: acc 0.25301204819277107, correct 21/83
class 2: acc 0.0379746835443038, correct 3/79
class 3: acc 0.5119047619047619, correct 43/84
class 4: acc 0.46464646464646464, correct 46/99

Val Set, val_loss: 1.6191, val_error: 0.9000, auc: 0.6862
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 0.0, correct 0/11
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 0.0, correct 0/7
class 4: acc 1.0, correct 2/2
Validation loss decreased (inf --> 1.619086).  Saving model ...


batch 19, loss: 1.9442, instance_loss: 0.5345, weighted_loss: 1.5213, label: 2, bag_size: 679
batch 39, loss: 1.5478, instance_loss: 0.5005, weighted_loss: 1.2336, label: 2, bag_size: 355
batch 59, loss: 2.0590, instance_loss: 0.5540, weighted_loss: 1.6075, label: 3, bag_size: 630
batch 79, loss: 1.4453, instance_loss: 0.4891, weighted_loss: 1.1584, label: 1, bag_size: 386
batch 99, loss: 1.1790, instance_loss: 0.5110, weighted_loss: 0.9786, label: 4, bag_size: 729
batch 119, loss: 1.5044, instance_loss: 0.5257, weighted_loss: 1.2108, label: 0, bag_size: 602
batch 139, loss: 1.6595, instance_loss: 0.5354, weighted_loss: 1.3223, label: 0, bag_size: 1190
batch 159, loss: 1.2198, instance_loss: 0.4908, weighted_loss: 1.0011, label: 4, bag_size: 366
batch 179, loss: 1.4497, instance_loss: 0.4999, weighted_loss: 1.1648, label: 3, bag_size: 556
batch 199, loss: 1.1065, instance_loss: 0.4651, weighted_loss: 0.9141, label: 3, bag_size: 1291
batch 219, loss: 1.4839, instance_loss: 0.5189, weighted_loss: 1.1944, label: 0, bag_size: 990
batch 239, loss: 1.4601, instance_loss: 0.5089, weighted_loss: 1.1747, label: 0, bag_size: 921
batch 259, loss: 1.5021, instance_loss: 0.5172, weighted_loss: 1.2066, label: 2, bag_size: 1569
batch 279, loss: 1.7795, instance_loss: 0.5273, weighted_loss: 1.4038, label: 2, bag_size: 1231
batch 299, loss: 1.1504, instance_loss: 0.4706, weighted_loss: 0.9464, label: 3, bag_size: 849
batch 319, loss: 0.9729, instance_loss: 0.4262, weighted_loss: 0.8089, label: 3, bag_size: 729
batch 339, loss: 1.1199, instance_loss: 0.4647, weighted_loss: 0.9234, label: 0, bag_size: 245
batch 359, loss: 1.9205, instance_loss: 0.5503, weighted_loss: 1.5094, label: 1, bag_size: 1261
batch 379, loss: 1.5340, instance_loss: 0.5507, weighted_loss: 1.2390, label: 4, bag_size: 790
batch 399, loss: 1.3836, instance_loss: 0.5010, weighted_loss: 1.1188, label: 1, bag_size: 533
batch 419, loss: 1.2827, instance_loss: 0.4982, weighted_loss: 1.0474, label: 1, bag_size: 994


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4854, train_clustering_loss:  0.5067, train_error: 0.6165
class 0: acc 0.43010752688172044, correct 40/93
class 1: acc 0.20512820512820512, correct 16/78
class 2: acc 0.20987654320987653, correct 17/81
class 3: acc 0.3563218390804598, correct 31/87
class 4: acc 0.686046511627907, correct 59/86

Val Set, val_loss: 1.5979, val_error: 0.8200, auc: 0.7222
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.0, correct 0/18
class 3: acc 0.14285714285714285, correct 1/7
class 4: acc 1.0, correct 2/2
Validation loss decreased (1.619086 --> 1.597866).  Saving model ...


batch 19, loss: 1.8197, instance_loss: 0.5177, weighted_loss: 1.4291, label: 2, bag_size: 629
batch 39, loss: 1.5219, instance_loss: 0.5273, weighted_loss: 1.2235, label: 0, bag_size: 729
batch 59, loss: 0.6136, instance_loss: 0.4374, weighted_loss: 0.5607, label: 4, bag_size: 729
batch 79, loss: 1.9449, instance_loss: 0.5596, weighted_loss: 1.5293, label: 0, bag_size: 729
batch 99, loss: 1.9777, instance_loss: 0.5432, weighted_loss: 1.5473, label: 4, bag_size: 974
batch 119, loss: 1.5613, instance_loss: 0.4716, weighted_loss: 1.2344, label: 1, bag_size: 648
batch 139, loss: 1.3320, instance_loss: 0.4547, weighted_loss: 1.0689, label: 3, bag_size: 729
batch 159, loss: 1.4510, instance_loss: 0.4977, weighted_loss: 1.1650, label: 3, bag_size: 317
batch 179, loss: 0.9523, instance_loss: 0.4118, weighted_loss: 0.7902, label: 3, bag_size: 1291
batch 199, loss: 1.6313, instance_loss: 0.4668, weighted_loss: 1.2819, label: 3, bag_size: 1380
batch 219, loss: 0.8374, instance_loss: 0.4103, weighted_loss: 0.7093, label: 3, bag_size: 849
batch 239, loss: 0.9447, instance_loss: 0.4318, weighted_loss: 0.7908, label: 3, bag_size: 451
batch 259, loss: 1.8057, instance_loss: 0.5214, weighted_loss: 1.4204, label: 1, bag_size: 860
batch 279, loss: 1.5841, instance_loss: 0.5126, weighted_loss: 1.2627, label: 2, bag_size: 1197
batch 299, loss: 1.2752, instance_loss: 0.4994, weighted_loss: 1.0424, label: 2, bag_size: 419
batch 319, loss: 1.4474, instance_loss: 0.5098, weighted_loss: 1.1662, label: 2, bag_size: 959
batch 339, loss: 1.1827, instance_loss: 0.4525, weighted_loss: 0.9637, label: 2, bag_size: 684
batch 359, loss: 1.1952, instance_loss: 0.4501, weighted_loss: 0.9717, label: 1, bag_size: 1096
batch 379, loss: 1.1677, instance_loss: 0.4364, weighted_loss: 0.9483, label: 1, bag_size: 925
batch 399, loss: 1.1401, instance_loss: 0.4733, weighted_loss: 0.9401, label: 0, bag_size: 1046
batch 419, loss: 1.7729, instance_loss: 0.5332, weighted_loss: 1.4010, label: 2, bag_size: 649


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.3707, train_clustering_loss:  0.4875, train_error: 0.5129
class 0: acc 0.631578947368421, correct 60/95
class 1: acc 0.5232558139534884, correct 45/86
class 2: acc 0.19047619047619047, correct 16/84
class 3: acc 0.5128205128205128, correct 40/78
class 4: acc 0.5609756097560976, correct 46/82

Val Set, val_loss: 1.3581, val_error: 0.6000, auc: 0.7955
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 1.0, correct 12/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.16666666666666666, correct 3/18
class 3: acc 0.2857142857142857, correct 2/7
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.597866 --> 1.358139).  Saving model ...


batch 19, loss: 1.4578, instance_loss: 0.5083, weighted_loss: 1.1729, label: 2, bag_size: 766
batch 39, loss: 1.8060, instance_loss: 0.5676, weighted_loss: 1.4344, label: 3, bag_size: 671
batch 59, loss: 1.4815, instance_loss: 0.5240, weighted_loss: 1.1943, label: 2, bag_size: 278
batch 79, loss: 0.6359, instance_loss: 0.3697, weighted_loss: 0.5560, label: 0, bag_size: 239
batch 99, loss: 2.1285, instance_loss: 0.5415, weighted_loss: 1.6524, label: 2, bag_size: 1439
batch 119, loss: 1.0239, instance_loss: 0.4558, weighted_loss: 0.8535, label: 0, bag_size: 731
batch 139, loss: 1.3387, instance_loss: 0.4895, weighted_loss: 1.0840, label: 1, bag_size: 1409
batch 159, loss: 0.2650, instance_loss: 0.3021, weighted_loss: 0.2761, label: 4, bag_size: 729
batch 179, loss: 1.0538, instance_loss: 0.4538, weighted_loss: 0.8738, label: 0, bag_size: 756
batch 199, loss: 2.3172, instance_loss: 0.6612, weighted_loss: 1.8204, label: 2, bag_size: 358
batch 219, loss: 1.1711, instance_loss: 0.4727, weighted_loss: 0.9616, label: 2, bag_size: 2703
batch 239, loss: 0.2595, instance_loss: 0.2883, weighted_loss: 0.2681, label: 4, bag_size: 729
batch 259, loss: 0.9200, instance_loss: 0.4367, weighted_loss: 0.7750, label: 0, bag_size: 375
batch 279, loss: 0.8088, instance_loss: 0.3853, weighted_loss: 0.6818, label: 1, bag_size: 1191
batch 299, loss: 1.1674, instance_loss: 0.4486, weighted_loss: 0.9517, label: 2, bag_size: 707
batch 319, loss: 1.9027, instance_loss: 0.5383, weighted_loss: 1.4934, label: 3, bag_size: 281
batch 339, loss: 1.4228, instance_loss: 0.5089, weighted_loss: 1.1486, label: 2, bag_size: 1569
batch 359, loss: 0.5537, instance_loss: 0.4461, weighted_loss: 0.5214, label: 4, bag_size: 729
batch 379, loss: 0.7194, instance_loss: 0.3796, weighted_loss: 0.6174, label: 1, bag_size: 474
batch 399, loss: 0.4302, instance_loss: 0.2937, weighted_loss: 0.3893, label: 1, bag_size: 1127
batch 419, loss: 0.4798, instance_loss: 0.3547, weighted_loss: 0.4423, label: 3, bag_size: 841


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0002941176470588235: correct 1/3400
Epoch: 3, train_loss: 1.1660, train_clustering_loss:  0.4545, train_error: 0.4000
class 0: acc 0.7731958762886598, correct 75/97
class 1: acc 0.5747126436781609, correct 50/87
class 2: acc 0.36363636363636365, correct 32/88
class 3: acc 0.5925925925925926, correct 48/81
class 4: acc 0.6944444444444444, correct 50/72

Val Set, val_loss: 1.2084, val_error: 0.5000, auc: 0.8243
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.358139 --> 1.208359).  Saving model ...


batch 19, loss: 0.2090, instance_loss: 0.2549, weighted_loss: 0.2228, label: 3, bag_size: 451
batch 39, loss: 0.9306, instance_loss: 0.4081, weighted_loss: 0.7739, label: 1, bag_size: 965
batch 59, loss: 1.0270, instance_loss: 0.4664, weighted_loss: 0.8589, label: 2, bag_size: 828
batch 79, loss: 0.9218, instance_loss: 0.3872, weighted_loss: 0.7614, label: 0, bag_size: 200
batch 99, loss: 0.5710, instance_loss: 0.3210, weighted_loss: 0.4960, label: 1, bag_size: 356
batch 119, loss: 1.1167, instance_loss: 0.4850, weighted_loss: 0.9272, label: 0, bag_size: 729
batch 139, loss: 0.5086, instance_loss: 0.3563, weighted_loss: 0.4629, label: 0, bag_size: 962
batch 159, loss: 0.8974, instance_loss: 0.4221, weighted_loss: 0.7548, label: 0, bag_size: 294
batch 179, loss: 1.0996, instance_loss: 0.4770, weighted_loss: 0.9128, label: 2, bag_size: 324
batch 199, loss: 1.6623, instance_loss: 0.5133, weighted_loss: 1.3176, label: 3, bag_size: 200
batch 219, loss: 1.2346, instance_loss: 0.4813, weighted_loss: 1.0086, label: 4, bag_size: 297
batch 239, loss: 2.5200, instance_loss: 0.6535, weighted_loss: 1.9600, label: 1, bag_size: 1376
batch 259, loss: 0.7830, instance_loss: 0.3888, weighted_loss: 0.6647, label: 1, bag_size: 1127
batch 279, loss: 1.5732, instance_loss: 0.4825, weighted_loss: 1.2460, label: 1, bag_size: 778
batch 299, loss: 2.1019, instance_loss: 0.5507, weighted_loss: 1.6365, label: 1, bag_size: 657
batch 319, loss: 1.7580, instance_loss: 0.4594, weighted_loss: 1.3684, label: 2, bag_size: 480
batch 339, loss: 1.9761, instance_loss: 0.5222, weighted_loss: 1.5399, label: 4, bag_size: 436
batch 359, loss: 0.6322, instance_loss: 0.3479, weighted_loss: 0.5469, label: 1, bag_size: 1325
batch 379, loss: 1.5576, instance_loss: 0.5123, weighted_loss: 1.2440, label: 1, bag_size: 139
batch 399, loss: 0.9876, instance_loss: 0.4582, weighted_loss: 0.8288, label: 2, bag_size: 245
batch 419, loss: 0.3515, instance_loss: 0.3115, weighted_loss: 0.3395, label: 0, bag_size: 385


class 0 clustering acc 0.9992941176470588: correct 16988/17000
class 1 clustering acc 0.013235294117647059: correct 45/3400
Epoch: 4, train_loss: 1.0276, train_clustering_loss:  0.4276, train_error: 0.3506
class 0: acc 0.8271604938271605, correct 67/81
class 1: acc 0.6195652173913043, correct 57/92
class 2: acc 0.4731182795698925, correct 44/93
class 3: acc 0.7, correct 63/90
class 4: acc 0.6521739130434783, correct 45/69

Val Set, val_loss: 1.1099, val_error: 0.4400, auc: 0.8368
class 0 clustering acc 0.9995: correct 1999/2000
class 1 clustering acc 0.01: correct 4/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5, correct 9/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.208359 --> 1.109900).  Saving model ...


batch 19, loss: 1.6620, instance_loss: 0.5162, weighted_loss: 1.3182, label: 3, bag_size: 360
batch 39, loss: 1.6546, instance_loss: 0.5235, weighted_loss: 1.3153, label: 1, bag_size: 343
batch 59, loss: 1.5813, instance_loss: 0.4835, weighted_loss: 1.2520, label: 1, bag_size: 1273
batch 79, loss: 0.1662, instance_loss: 0.3418, weighted_loss: 0.2189, label: 3, bag_size: 1253
batch 99, loss: 1.2380, instance_loss: 0.4507, weighted_loss: 1.0018, label: 2, bag_size: 357
batch 119, loss: 2.1387, instance_loss: 0.6282, weighted_loss: 1.6855, label: 3, bag_size: 630
batch 139, loss: 0.5551, instance_loss: 0.3642, weighted_loss: 0.4978, label: 2, bag_size: 1218
batch 159, loss: 0.5941, instance_loss: 0.3423, weighted_loss: 0.5185, label: 2, bag_size: 1569
batch 179, loss: 0.6508, instance_loss: 0.3022, weighted_loss: 0.5462, label: 3, bag_size: 729
batch 199, loss: 0.7944, instance_loss: 0.3756, weighted_loss: 0.6687, label: 1, bag_size: 1144
batch 219, loss: 0.4321, instance_loss: 0.2388, weighted_loss: 0.3741, label: 3, bag_size: 729
batch 239, loss: 0.3093, instance_loss: 0.3565, weighted_loss: 0.3234, label: 0, bag_size: 729
batch 259, loss: 0.7332, instance_loss: 0.4278, weighted_loss: 0.6416, label: 0, bag_size: 990
batch 279, loss: 0.5815, instance_loss: 0.3526, weighted_loss: 0.5129, label: 1, bag_size: 1646
batch 299, loss: 0.3173, instance_loss: 0.2022, weighted_loss: 0.2827, label: 3, bag_size: 729
batch 319, loss: 0.2461, instance_loss: 0.1952, weighted_loss: 0.2308, label: 3, bag_size: 729
batch 339, loss: 0.4059, instance_loss: 0.2678, weighted_loss: 0.3645, label: 1, bag_size: 369
batch 359, loss: 0.4410, instance_loss: 0.3689, weighted_loss: 0.4194, label: 0, bag_size: 1466
batch 379, loss: 0.7238, instance_loss: 0.3237, weighted_loss: 0.6038, label: 3, bag_size: 791
batch 399, loss: 1.4313, instance_loss: 0.5970, weighted_loss: 1.1810, label: 0, bag_size: 729
batch 419, loss: 0.1875, instance_loss: 0.2560, weighted_loss: 0.2081, label: 4, bag_size: 1357


class 0 clustering acc 0.9994117647058823: correct 16990/17000
class 1 clustering acc 0.06235294117647059: correct 212/3400
Epoch: 5, train_loss: 0.9854, train_clustering_loss:  0.4170, train_error: 0.3741
class 0: acc 0.7066666666666667, correct 53/75
class 1: acc 0.5604395604395604, correct 51/91
class 2: acc 0.4782608695652174, correct 44/92
class 3: acc 0.6896551724137931, correct 60/87
class 4: acc 0.725, correct 58/80

Val Set, val_loss: 1.2675, val_error: 0.5600, auc: 0.8096
class 0 clustering acc 0.9945: correct 1989/2000
class 1 clustering acc 0.02: correct 8/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0611, instance_loss: 0.2618, weighted_loss: 0.1213, label: 4, bag_size: 675
batch 39, loss: 0.4009, instance_loss: 0.3248, weighted_loss: 0.3781, label: 0, bag_size: 367
batch 59, loss: 0.4781, instance_loss: 0.4989, weighted_loss: 0.4844, label: 0, bag_size: 729
batch 79, loss: 0.1198, instance_loss: 0.2144, weighted_loss: 0.1482, label: 3, bag_size: 451
batch 99, loss: 0.4452, instance_loss: 0.1715, weighted_loss: 0.3631, label: 3, bag_size: 556
batch 119, loss: 1.0525, instance_loss: 0.2939, weighted_loss: 0.8249, label: 4, bag_size: 974
batch 139, loss: 1.6374, instance_loss: 0.5046, weighted_loss: 1.2976, label: 3, bag_size: 360
batch 159, loss: 0.8883, instance_loss: 0.4199, weighted_loss: 0.7477, label: 2, bag_size: 347
batch 179, loss: 0.9017, instance_loss: 0.4284, weighted_loss: 0.7597, label: 2, bag_size: 614
batch 199, loss: 0.2620, instance_loss: 0.2927, weighted_loss: 0.2712, label: 0, bag_size: 729
batch 219, loss: 1.6380, instance_loss: 0.5548, weighted_loss: 1.3130, label: 2, bag_size: 766
batch 239, loss: 0.1021, instance_loss: 0.1497, weighted_loss: 0.1164, label: 3, bag_size: 729
batch 259, loss: 1.1310, instance_loss: 0.4856, weighted_loss: 0.9374, label: 2, bag_size: 707
batch 279, loss: 0.5532, instance_loss: 0.3489, weighted_loss: 0.4919, label: 0, bag_size: 756
batch 299, loss: 0.7554, instance_loss: 0.4211, weighted_loss: 0.6551, label: 1, bag_size: 847
batch 319, loss: 0.0522, instance_loss: 0.1900, weighted_loss: 0.0936, label: 3, bag_size: 936
batch 339, loss: 0.5744, instance_loss: 0.5221, weighted_loss: 0.5587, label: 0, bag_size: 729
batch 359, loss: 1.7538, instance_loss: 0.5259, weighted_loss: 1.3854, label: 0, bag_size: 545
batch 379, loss: 0.5348, instance_loss: 0.3508, weighted_loss: 0.4796, label: 2, bag_size: 347
batch 399, loss: 1.0594, instance_loss: 0.4524, weighted_loss: 0.8773, label: 2, bag_size: 676
batch 419, loss: 0.1941, instance_loss: 0.1300, weighted_loss: 0.1749, label: 3, bag_size: 729


class 0 clustering acc 0.9969411764705882: correct 16948/17000
class 1 clustering acc 0.15823529411764706: correct 538/3400
Epoch: 6, train_loss: 0.8523, train_clustering_loss:  0.3898, train_error: 0.3012
class 0: acc 0.782608695652174, correct 54/69
class 1: acc 0.5375, correct 43/80
class 2: acc 0.525, correct 42/80
class 3: acc 0.7924528301886793, correct 84/106
class 4: acc 0.8222222222222222, correct 74/90

Val Set, val_loss: 1.1081, val_error: 0.4800, auc: 0.8369
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.0575: correct 23/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.109900 --> 1.108061).  Saving model ...


batch 19, loss: 0.0977, instance_loss: 0.2677, weighted_loss: 0.1487, label: 3, bag_size: 952
batch 39, loss: 0.1603, instance_loss: 0.1583, weighted_loss: 0.1597, label: 3, bag_size: 729
batch 59, loss: 1.5665, instance_loss: 0.5045, weighted_loss: 1.2479, label: 3, bag_size: 630
batch 79, loss: 0.6645, instance_loss: 0.4807, weighted_loss: 0.6094, label: 3, bag_size: 281
batch 99, loss: 0.4684, instance_loss: 0.3190, weighted_loss: 0.4236, label: 1, bag_size: 696
batch 119, loss: 2.2357, instance_loss: 0.6317, weighted_loss: 1.7545, label: 1, bag_size: 660
batch 139, loss: 0.2260, instance_loss: 0.1433, weighted_loss: 0.2012, label: 3, bag_size: 729
batch 159, loss: 0.2252, instance_loss: 0.2162, weighted_loss: 0.2225, label: 0, bag_size: 360
batch 179, loss: 0.0280, instance_loss: 0.2141, weighted_loss: 0.0838, label: 4, bag_size: 1235
batch 199, loss: 1.3892, instance_loss: 0.4870, weighted_loss: 1.1185, label: 1, bag_size: 648
batch 219, loss: 0.4071, instance_loss: 0.3033, weighted_loss: 0.3759, label: 4, bag_size: 1176
batch 239, loss: 0.4012, instance_loss: 0.3164, weighted_loss: 0.3758, label: 0, bag_size: 476
batch 259, loss: 0.7143, instance_loss: 0.3528, weighted_loss: 0.6058, label: 4, bag_size: 947
batch 279, loss: 0.7511, instance_loss: 0.3708, weighted_loss: 0.6370, label: 0, bag_size: 1190
batch 299, loss: 1.0043, instance_loss: 0.4053, weighted_loss: 0.8246, label: 2, bag_size: 846
batch 319, loss: 1.5880, instance_loss: 0.3678, weighted_loss: 1.2220, label: 4, bag_size: 1360
batch 339, loss: 0.5846, instance_loss: 0.3703, weighted_loss: 0.5203, label: 1, bag_size: 1014
batch 359, loss: 1.1016, instance_loss: 0.5862, weighted_loss: 0.9470, label: 1, bag_size: 1390
batch 379, loss: 0.6205, instance_loss: 0.3756, weighted_loss: 0.5470, label: 2, bag_size: 347
batch 399, loss: 0.3475, instance_loss: 0.3061, weighted_loss: 0.3351, label: 0, bag_size: 1332
batch 419, loss: 0.1528, instance_loss: 0.1720, weighted_loss: 0.1585, label: 0, bag_size: 239


class 0 clustering acc 0.9966470588235294: correct 16943/17000
class 1 clustering acc 0.19029411764705884: correct 647/3400
Epoch: 7, train_loss: 0.7969, train_clustering_loss:  0.3747, train_error: 0.2776
class 0: acc 0.8076923076923077, correct 63/78
class 1: acc 0.6222222222222222, correct 56/90
class 2: acc 0.5952380952380952, correct 50/84
class 3: acc 0.7906976744186046, correct 68/86
class 4: acc 0.8045977011494253, correct 70/87

Val Set, val_loss: 1.0252, val_error: 0.4800, auc: 0.8474
class 0 clustering acc 0.9965: correct 1993/2000
class 1 clustering acc 0.0425: correct 17/400
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.4444444444444444, correct 8/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.108061 --> 1.025201).  Saving model ...


batch 19, loss: 0.1258, instance_loss: 0.3684, weighted_loss: 0.1986, label: 4, bag_size: 711
batch 39, loss: 0.0860, instance_loss: 0.2495, weighted_loss: 0.1351, label: 3, bag_size: 936
batch 59, loss: 1.6516, instance_loss: 0.5042, weighted_loss: 1.3073, label: 1, bag_size: 535
batch 79, loss: 2.4069, instance_loss: 0.6597, weighted_loss: 1.8827, label: 4, bag_size: 1337
batch 99, loss: 0.0619, instance_loss: 0.1267, weighted_loss: 0.0813, label: 3, bag_size: 729
batch 119, loss: 1.2707, instance_loss: 0.5111, weighted_loss: 1.0428, label: 2, bag_size: 537
batch 139, loss: 0.3935, instance_loss: 0.3383, weighted_loss: 0.3769, label: 2, bag_size: 1200
batch 159, loss: 0.1635, instance_loss: 0.0957, weighted_loss: 0.1432, label: 3, bag_size: 556
batch 179, loss: 0.7669, instance_loss: 0.3507, weighted_loss: 0.6421, label: 0, bag_size: 990
batch 199, loss: 1.3043, instance_loss: 0.4693, weighted_loss: 1.0538, label: 4, bag_size: 1331
batch 219, loss: 0.6465, instance_loss: 0.4646, weighted_loss: 0.5919, label: 2, bag_size: 1150
batch 239, loss: 0.1843, instance_loss: 0.1704, weighted_loss: 0.1801, label: 3, bag_size: 849
batch 259, loss: 0.0355, instance_loss: 0.1378, weighted_loss: 0.0662, label: 4, bag_size: 729
batch 279, loss: 0.2624, instance_loss: 0.2881, weighted_loss: 0.2701, label: 1, bag_size: 828
batch 299, loss: 1.5817, instance_loss: 0.6036, weighted_loss: 1.2882, label: 2, bag_size: 878
batch 319, loss: 0.5922, instance_loss: 0.3976, weighted_loss: 0.5338, label: 1, bag_size: 1144
batch 339, loss: 0.2445, instance_loss: 0.3369, weighted_loss: 0.2722, label: 4, bag_size: 1176
batch 359, loss: 0.2549, instance_loss: 0.3128, weighted_loss: 0.2723, label: 4, bag_size: 947
batch 379, loss: 1.4631, instance_loss: 0.5385, weighted_loss: 1.1857, label: 1, bag_size: 1724
batch 399, loss: 0.6822, instance_loss: 0.5543, weighted_loss: 0.6438, label: 2, bag_size: 518
batch 419, loss: 0.2662, instance_loss: 0.2006, weighted_loss: 0.2465, label: 0, bag_size: 1579


class 0 clustering acc 0.995764705882353: correct 16928/17000
class 1 clustering acc 0.2: correct 680/3400
Epoch: 8, train_loss: 0.7269, train_clustering_loss:  0.3733, train_error: 0.2306
class 0: acc 0.8795180722891566, correct 73/83
class 1: acc 0.6853932584269663, correct 61/89
class 2: acc 0.6463414634146342, correct 53/82
class 3: acc 0.8152173913043478, correct 75/92
class 4: acc 0.8227848101265823, correct 65/79

Val Set, val_loss: 1.0242, val_error: 0.4400, auc: 0.8474
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.0625: correct 25/400
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.5, correct 1/2
Validation loss decreased (1.025201 --> 1.024196).  Saving model ...


batch 19, loss: 0.0406, instance_loss: 0.1989, weighted_loss: 0.0881, label: 4, bag_size: 1474
batch 39, loss: 0.1058, instance_loss: 0.1365, weighted_loss: 0.1150, label: 0, bag_size: 385
batch 59, loss: 1.4907, instance_loss: 0.5332, weighted_loss: 1.2035, label: 1, bag_size: 861
batch 79, loss: 2.5133, instance_loss: 0.7012, weighted_loss: 1.9697, label: 4, bag_size: 436
batch 99, loss: 0.5703, instance_loss: 0.3371, weighted_loss: 0.5003, label: 2, bag_size: 470
batch 119, loss: 0.9328, instance_loss: 0.4279, weighted_loss: 0.7813, label: 3, bag_size: 200
batch 139, loss: 0.3830, instance_loss: 0.2599, weighted_loss: 0.3461, label: 1, bag_size: 890
batch 159, loss: 1.5546, instance_loss: 0.4987, weighted_loss: 1.2378, label: 1, bag_size: 657
batch 179, loss: 0.1483, instance_loss: 0.1714, weighted_loss: 0.1552, label: 0, bag_size: 756
batch 199, loss: 0.0859, instance_loss: 0.1200, weighted_loss: 0.0961, label: 0, bag_size: 982
batch 219, loss: 0.1879, instance_loss: 0.2759, weighted_loss: 0.2143, label: 0, bag_size: 729
batch 239, loss: 0.3416, instance_loss: 0.3617, weighted_loss: 0.3476, label: 1, bag_size: 860
batch 259, loss: 0.4784, instance_loss: 0.4394, weighted_loss: 0.4667, label: 1, bag_size: 1096
batch 279, loss: 2.8602, instance_loss: 0.5233, weighted_loss: 2.1591, label: 2, bag_size: 1167
batch 299, loss: 0.0177, instance_loss: 0.0862, weighted_loss: 0.0383, label: 4, bag_size: 729
batch 319, loss: 0.4355, instance_loss: 0.4393, weighted_loss: 0.4367, label: 0, bag_size: 1301
batch 339, loss: 2.2320, instance_loss: 0.6103, weighted_loss: 1.7455, label: 4, bag_size: 436
batch 359, loss: 0.5165, instance_loss: 0.3281, weighted_loss: 0.4600, label: 0, bag_size: 545
batch 379, loss: 3.1542, instance_loss: 0.6475, weighted_loss: 2.4022, label: 0, bag_size: 818
batch 399, loss: 0.1352, instance_loss: 0.1905, weighted_loss: 0.1518, label: 0, bag_size: 729
batch 419, loss: 0.0414, instance_loss: 0.0917, weighted_loss: 0.0565, label: 4, bag_size: 646


class 0 clustering acc 0.994764705882353: correct 16911/17000
class 1 clustering acc 0.26323529411764707: correct 895/3400
Epoch: 9, train_loss: 0.6860, train_clustering_loss:  0.3538, train_error: 0.2400
class 0: acc 0.8444444444444444, correct 76/90
class 1: acc 0.6236559139784946, correct 58/93
class 2: acc 0.6666666666666666, correct 56/84
class 3: acc 0.9078947368421053, correct 69/76
class 4: acc 0.7804878048780488, correct 64/82

Val Set, val_loss: 1.0278, val_error: 0.4200, auc: 0.8457
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.0975: correct 39/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6298, instance_loss: 0.3605, weighted_loss: 0.5490, label: 4, bag_size: 590
batch 39, loss: 1.6085, instance_loss: 0.5468, weighted_loss: 1.2900, label: 0, bag_size: 868
batch 59, loss: 1.0885, instance_loss: 0.5168, weighted_loss: 0.9170, label: 2, bag_size: 384
batch 79, loss: 0.0184, instance_loss: 0.1411, weighted_loss: 0.0552, label: 4, bag_size: 729
batch 99, loss: 0.0066, instance_loss: 0.1138, weighted_loss: 0.0388, label: 4, bag_size: 729
batch 119, loss: 0.1607, instance_loss: 0.2001, weighted_loss: 0.1725, label: 0, bag_size: 933
batch 139, loss: 0.4631, instance_loss: 0.3570, weighted_loss: 0.4313, label: 2, bag_size: 1200
batch 159, loss: 0.0570, instance_loss: 0.2094, weighted_loss: 0.1028, label: 3, bag_size: 936
batch 179, loss: 0.1715, instance_loss: 0.3792, weighted_loss: 0.2338, label: 3, bag_size: 791
batch 199, loss: 0.0684, instance_loss: 0.2759, weighted_loss: 0.1307, label: 4, bag_size: 711
batch 219, loss: 0.1419, instance_loss: 0.5049, weighted_loss: 0.2508, label: 3, bag_size: 360
batch 239, loss: 1.0144, instance_loss: 0.5504, weighted_loss: 0.8752, label: 2, bag_size: 1410
batch 259, loss: 0.5414, instance_loss: 0.3538, weighted_loss: 0.4851, label: 2, bag_size: 2703
batch 279, loss: 0.1334, instance_loss: 0.0965, weighted_loss: 0.1223, label: 3, bag_size: 729
batch 299, loss: 2.5111, instance_loss: 0.7553, weighted_loss: 1.9844, label: 2, bag_size: 1178
batch 319, loss: 0.3151, instance_loss: 0.2508, weighted_loss: 0.2958, label: 0, bag_size: 602
batch 339, loss: 2.1883, instance_loss: 0.6517, weighted_loss: 1.7273, label: 0, bag_size: 1257
batch 359, loss: 0.5536, instance_loss: 0.3531, weighted_loss: 0.4935, label: 2, bag_size: 758
batch 379, loss: 0.4195, instance_loss: 0.2846, weighted_loss: 0.3790, label: 2, bag_size: 1448
batch 399, loss: 0.3363, instance_loss: 0.3174, weighted_loss: 0.3306, label: 1, bag_size: 1144
batch 419, loss: 2.8061, instance_loss: 0.6830, weighted_loss: 2.1692, label: 4, bag_size: 436


class 0 clustering acc 0.9940588235294118: correct 16899/17000
class 1 clustering acc 0.27558823529411763: correct 937/3400
Epoch: 10, train_loss: 0.6379, train_clustering_loss:  0.3509, train_error: 0.2353
class 0: acc 0.8414634146341463, correct 69/82
class 1: acc 0.5888888888888889, correct 53/90
class 2: acc 0.6966292134831461, correct 62/89
class 3: acc 0.898876404494382, correct 80/89
class 4: acc 0.8133333333333334, correct 61/75

Val Set, val_loss: 1.1055, val_error: 0.4800, auc: 0.8393
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.095: correct 38/400
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4196, instance_loss: 0.3396, weighted_loss: 0.3956, label: 2, bag_size: 409
batch 39, loss: 0.0137, instance_loss: 0.0922, weighted_loss: 0.0373, label: 4, bag_size: 764
batch 59, loss: 1.1559, instance_loss: 0.6627, weighted_loss: 1.0079, label: 3, bag_size: 630
batch 79, loss: 1.2960, instance_loss: 0.6597, weighted_loss: 1.1051, label: 2, bag_size: 3236
batch 99, loss: 1.9915, instance_loss: 0.7038, weighted_loss: 1.6052, label: 4, bag_size: 823
batch 119, loss: 1.6345, instance_loss: 0.5719, weighted_loss: 1.3157, label: 0, bag_size: 868
batch 139, loss: 0.0563, instance_loss: 0.0857, weighted_loss: 0.0651, label: 3, bag_size: 1291
batch 159, loss: 2.0269, instance_loss: 0.6085, weighted_loss: 1.6014, label: 1, bag_size: 838
batch 179, loss: 2.3664, instance_loss: 0.6363, weighted_loss: 1.8474, label: 1, bag_size: 1799
batch 199, loss: 0.1105, instance_loss: 0.1905, weighted_loss: 0.1345, label: 4, bag_size: 790
batch 219, loss: 0.1650, instance_loss: 0.1282, weighted_loss: 0.1540, label: 0, bag_size: 1579
batch 239, loss: 0.1081, instance_loss: 0.1854, weighted_loss: 0.1313, label: 1, bag_size: 1086
batch 259, loss: 0.0895, instance_loss: 0.5702, weighted_loss: 0.2337, label: 3, bag_size: 1167
batch 279, loss: 0.1248, instance_loss: 0.1188, weighted_loss: 0.1230, label: 0, bag_size: 602
batch 299, loss: 0.6368, instance_loss: 0.4140, weighted_loss: 0.5700, label: 1, bag_size: 102
batch 319, loss: 0.0030, instance_loss: 0.1233, weighted_loss: 0.0391, label: 4, bag_size: 729
batch 339, loss: 0.2726, instance_loss: 0.4151, weighted_loss: 0.3153, label: 4, bag_size: 754
batch 359, loss: 0.2849, instance_loss: 0.1923, weighted_loss: 0.2571, label: 0, bag_size: 338
batch 379, loss: 0.1724, instance_loss: 0.1520, weighted_loss: 0.1663, label: 1, bag_size: 847
batch 399, loss: 0.1689, instance_loss: 0.3047, weighted_loss: 0.2097, label: 2, bag_size: 1215
batch 419, loss: 0.3769, instance_loss: 0.2149, weighted_loss: 0.3283, label: 0, bag_size: 962


class 0 clustering acc 0.9911176470588235: correct 16849/17000
class 1 clustering acc 0.2873529411764706: correct 977/3400
Epoch: 11, train_loss: 0.6462, train_clustering_loss:  0.3598, train_error: 0.2424
class 0: acc 0.8333333333333334, correct 75/90
class 1: acc 0.5777777777777777, correct 52/90
class 2: acc 0.7096774193548387, correct 66/93
class 3: acc 0.8571428571428571, correct 60/70
class 4: acc 0.8414634146341463, correct 69/82

Val Set, val_loss: 0.9568, val_error: 0.4000, auc: 0.8582
class 0 clustering acc 0.994: correct 1988/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
Validation loss decreased (1.024196 --> 0.956835).  Saving model ...


batch 19, loss: 1.2103, instance_loss: 0.5198, weighted_loss: 1.0032, label: 1, bag_size: 535
batch 39, loss: 0.4851, instance_loss: 0.3749, weighted_loss: 0.4520, label: 2, bag_size: 621
batch 59, loss: 0.0443, instance_loss: 0.0863, weighted_loss: 0.0569, label: 3, bag_size: 1291
batch 79, loss: 0.2482, instance_loss: 0.2150, weighted_loss: 0.2382, label: 0, bag_size: 478
batch 99, loss: 0.2166, instance_loss: 0.5747, weighted_loss: 0.3240, label: 4, bag_size: 663
batch 119, loss: 0.8801, instance_loss: 0.5574, weighted_loss: 0.7832, label: 0, bag_size: 607
batch 139, loss: 0.2266, instance_loss: 0.2391, weighted_loss: 0.2304, label: 0, bag_size: 1190
batch 159, loss: 0.2297, instance_loss: 0.1935, weighted_loss: 0.2188, label: 0, bag_size: 729
batch 179, loss: 0.1503, instance_loss: 0.2292, weighted_loss: 0.1740, label: 3, bag_size: 230
batch 199, loss: 0.8416, instance_loss: 0.4696, weighted_loss: 0.7300, label: 4, bag_size: 366
batch 219, loss: 0.2713, instance_loss: 0.7292, weighted_loss: 0.4087, label: 3, bag_size: 281
batch 239, loss: 0.0716, instance_loss: 0.3775, weighted_loss: 0.1634, label: 4, bag_size: 663
batch 259, loss: 1.9998, instance_loss: 0.5778, weighted_loss: 1.5732, label: 3, bag_size: 607
batch 279, loss: 0.3021, instance_loss: 0.1790, weighted_loss: 0.2652, label: 0, bag_size: 200
batch 299, loss: 0.8340, instance_loss: 0.4405, weighted_loss: 0.7160, label: 3, bag_size: 200
batch 319, loss: 1.2872, instance_loss: 0.5677, weighted_loss: 1.0713, label: 2, bag_size: 373
batch 339, loss: 0.1174, instance_loss: 0.1073, weighted_loss: 0.1144, label: 3, bag_size: 729
batch 359, loss: 1.3193, instance_loss: 0.6195, weighted_loss: 1.1094, label: 2, bag_size: 1231
batch 379, loss: 0.4386, instance_loss: 0.2898, weighted_loss: 0.3939, label: 1, bag_size: 533
batch 399, loss: 1.0965, instance_loss: 0.7016, weighted_loss: 0.9781, label: 2, bag_size: 1119
batch 419, loss: 0.0712, instance_loss: 0.0811, weighted_loss: 0.0742, label: 3, bag_size: 451


class 0 clustering acc 0.9929411764705882: correct 16880/17000
class 1 clustering acc 0.3029411764705882: correct 1030/3400
Epoch: 12, train_loss: 0.6135, train_clustering_loss:  0.3473, train_error: 0.2235
class 0: acc 0.8625, correct 69/80
class 1: acc 0.7128712871287128, correct 72/101
class 2: acc 0.5694444444444444, correct 41/72
class 3: acc 0.9278350515463918, correct 90/97
class 4: acc 0.7733333333333333, correct 58/75

Val Set, val_loss: 1.0066, val_error: 0.3800, auc: 0.8568
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.135: correct 54/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0533, instance_loss: 0.1502, weighted_loss: 0.0824, label: 3, bag_size: 729
batch 39, loss: 0.4526, instance_loss: 0.3852, weighted_loss: 0.4324, label: 2, bag_size: 907
batch 59, loss: 0.5965, instance_loss: 0.4401, weighted_loss: 0.5496, label: 2, bag_size: 932
batch 79, loss: 0.1283, instance_loss: 0.1675, weighted_loss: 0.1400, label: 0, bag_size: 729
batch 99, loss: 0.0461, instance_loss: 0.1405, weighted_loss: 0.0744, label: 3, bag_size: 729
batch 119, loss: 0.2562, instance_loss: 0.3196, weighted_loss: 0.2752, label: 1, bag_size: 846
batch 139, loss: 0.0785, instance_loss: 0.0714, weighted_loss: 0.0764, label: 0, bag_size: 521
batch 159, loss: 0.0033, instance_loss: 0.1198, weighted_loss: 0.0383, label: 4, bag_size: 790
batch 179, loss: 0.8313, instance_loss: 0.3983, weighted_loss: 0.7014, label: 3, bag_size: 1380
batch 199, loss: 0.1462, instance_loss: 0.5945, weighted_loss: 0.2807, label: 4, bag_size: 711
batch 219, loss: 0.3282, instance_loss: 0.3314, weighted_loss: 0.3291, label: 2, bag_size: 278
batch 239, loss: 0.0121, instance_loss: 0.1356, weighted_loss: 0.0492, label: 4, bag_size: 729
batch 259, loss: 0.2225, instance_loss: 0.2288, weighted_loss: 0.2243, label: 0, bag_size: 1012
batch 279, loss: 0.0731, instance_loss: 0.0842, weighted_loss: 0.0764, label: 3, bag_size: 729
batch 299, loss: 2.6203, instance_loss: 0.7661, weighted_loss: 2.0640, label: 1, bag_size: 917
batch 319, loss: 0.3952, instance_loss: 0.4197, weighted_loss: 0.4025, label: 1, bag_size: 846
batch 339, loss: 0.8516, instance_loss: 0.4420, weighted_loss: 0.7288, label: 3, bag_size: 200
batch 359, loss: 0.0471, instance_loss: 0.1061, weighted_loss: 0.0648, label: 3, bag_size: 952
batch 379, loss: 1.0946, instance_loss: 0.6881, weighted_loss: 0.9727, label: 2, bag_size: 1439
batch 399, loss: 0.0548, instance_loss: 0.0750, weighted_loss: 0.0608, label: 0, bag_size: 521
batch 419, loss: 0.2929, instance_loss: 0.2056, weighted_loss: 0.2667, label: 0, bag_size: 255


class 0 clustering acc 0.991764705882353: correct 16860/17000
class 1 clustering acc 0.36176470588235293: correct 1230/3400
Epoch: 13, train_loss: 0.5254, train_clustering_loss:  0.3202, train_error: 0.1647
class 0: acc 0.9066666666666666, correct 68/75
class 1: acc 0.6933333333333334, correct 52/75
class 2: acc 0.7307692307692307, correct 57/78
class 3: acc 0.9425287356321839, correct 82/87
class 4: acc 0.8727272727272727, correct 96/110

Val Set, val_loss: 1.0155, val_error: 0.4600, auc: 0.8763
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.2125: correct 85/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6827, instance_loss: 0.5727, weighted_loss: 1.3497, label: 1, bag_size: 657
batch 39, loss: 0.0785, instance_loss: 0.1520, weighted_loss: 0.1006, label: 4, bag_size: 1176
batch 59, loss: 0.1220, instance_loss: 0.3809, weighted_loss: 0.1997, label: 2, bag_size: 421
batch 79, loss: 0.4395, instance_loss: 0.3451, weighted_loss: 0.4112, label: 2, bag_size: 682
batch 99, loss: 0.4204, instance_loss: 0.3520, weighted_loss: 0.3999, label: 1, bag_size: 754
batch 119, loss: 0.0120, instance_loss: 0.1629, weighted_loss: 0.0573, label: 4, bag_size: 729
batch 139, loss: 0.0198, instance_loss: 0.1907, weighted_loss: 0.0711, label: 4, bag_size: 729
batch 159, loss: 2.4016, instance_loss: 0.6916, weighted_loss: 1.8886, label: 1, bag_size: 875
batch 179, loss: 0.0326, instance_loss: 0.1908, weighted_loss: 0.0801, label: 4, bag_size: 754
batch 199, loss: 0.3131, instance_loss: 0.5488, weighted_loss: 0.3838, label: 3, bag_size: 360
batch 219, loss: 0.6177, instance_loss: 0.3539, weighted_loss: 0.5385, label: 1, bag_size: 343
batch 239, loss: 0.6483, instance_loss: 0.4234, weighted_loss: 0.5808, label: 4, bag_size: 533
batch 259, loss: 0.1048, instance_loss: 0.0876, weighted_loss: 0.0996, label: 3, bag_size: 1019
batch 279, loss: 0.9350, instance_loss: 0.6399, weighted_loss: 0.8465, label: 2, bag_size: 1119
batch 299, loss: 0.1139, instance_loss: 0.0904, weighted_loss: 0.1068, label: 3, bag_size: 729
batch 319, loss: 0.0830, instance_loss: 0.1534, weighted_loss: 0.1041, label: 0, bag_size: 729
batch 339, loss: 0.2047, instance_loss: 0.5637, weighted_loss: 0.3124, label: 4, bag_size: 366
batch 359, loss: 0.0454, instance_loss: 0.1074, weighted_loss: 0.0640, label: 1, bag_size: 636
batch 379, loss: 0.2148, instance_loss: 0.2831, weighted_loss: 0.2353, label: 0, bag_size: 1061
batch 399, loss: 0.2412, instance_loss: 0.3282, weighted_loss: 0.2673, label: 1, bag_size: 442
batch 419, loss: 0.1592, instance_loss: 0.0845, weighted_loss: 0.1368, label: 3, bag_size: 729


class 0 clustering acc 0.9919411764705882: correct 16863/17000
class 1 clustering acc 0.3338235294117647: correct 1135/3400
Epoch: 14, train_loss: 0.5241, train_clustering_loss:  0.3373, train_error: 0.1788
class 0: acc 0.868421052631579, correct 66/76
class 1: acc 0.6987951807228916, correct 58/83
class 2: acc 0.7586206896551724, correct 66/87
class 3: acc 0.9195402298850575, correct 80/87
class 4: acc 0.8586956521739131, correct 79/92

Val Set, val_loss: 0.9519, val_error: 0.3800, auc: 0.8743
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.5, correct 1/2
Validation loss decreased (0.956835 --> 0.951915).  Saving model ...


batch 19, loss: 0.0440, instance_loss: 0.0673, weighted_loss: 0.0510, label: 0, bag_size: 1466
batch 39, loss: 0.0749, instance_loss: 0.2002, weighted_loss: 0.1125, label: 4, bag_size: 1357
batch 59, loss: 0.3137, instance_loss: 0.2461, weighted_loss: 0.2934, label: 1, bag_size: 886
batch 79, loss: 0.1008, instance_loss: 0.2033, weighted_loss: 0.1315, label: 3, bag_size: 1118
batch 99, loss: 0.0821, instance_loss: 0.2006, weighted_loss: 0.1177, label: 0, bag_size: 239
batch 119, loss: 0.5038, instance_loss: 0.2918, weighted_loss: 0.4402, label: 1, bag_size: 1014
batch 139, loss: 0.0251, instance_loss: 0.3226, weighted_loss: 0.1144, label: 4, bag_size: 297
batch 159, loss: 0.0065, instance_loss: 0.1285, weighted_loss: 0.0431, label: 4, bag_size: 388
batch 179, loss: 0.0435, instance_loss: 0.0633, weighted_loss: 0.0494, label: 0, bag_size: 239
batch 199, loss: 0.3517, instance_loss: 0.2687, weighted_loss: 0.3268, label: 0, bag_size: 545
batch 219, loss: 0.1136, instance_loss: 0.1842, weighted_loss: 0.1348, label: 1, bag_size: 1239
batch 239, loss: 1.5630, instance_loss: 0.5626, weighted_loss: 1.2629, label: 1, bag_size: 700
batch 259, loss: 0.0601, instance_loss: 0.4390, weighted_loss: 0.1738, label: 4, bag_size: 663
batch 279, loss: 0.0488, instance_loss: 0.1067, weighted_loss: 0.0662, label: 0, bag_size: 255
batch 299, loss: 0.0263, instance_loss: 0.1491, weighted_loss: 0.0632, label: 4, bag_size: 636
batch 319, loss: 0.0073, instance_loss: 0.1002, weighted_loss: 0.0351, label: 3, bag_size: 729
batch 339, loss: 0.7439, instance_loss: 0.5403, weighted_loss: 0.6828, label: 2, bag_size: 1617
batch 359, loss: 1.8490, instance_loss: 0.5477, weighted_loss: 1.4586, label: 1, bag_size: 1197
batch 379, loss: 0.0304, instance_loss: 0.0713, weighted_loss: 0.0427, label: 3, bag_size: 729
batch 399, loss: 0.1138, instance_loss: 0.2332, weighted_loss: 0.1496, label: 3, bag_size: 841
batch 419, loss: 0.4701, instance_loss: 0.2254, weighted_loss: 0.3967, label: 4, bag_size: 947


class 0 clustering acc 0.9901176470588235: correct 16832/17000
class 1 clustering acc 0.40705882352941175: correct 1384/3400
Epoch: 15, train_loss: 0.4760, train_clustering_loss:  0.3181, train_error: 0.1647
class 0: acc 0.9080459770114943, correct 79/87
class 1: acc 0.7191011235955056, correct 64/89
class 2: acc 0.6865671641791045, correct 46/67
class 3: acc 0.9659090909090909, correct 85/88
class 4: acc 0.8617021276595744, correct 81/94

Val Set, val_loss: 1.1167, val_error: 0.4200, auc: 0.8449
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.1975: correct 79/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2732, instance_loss: 0.3207, weighted_loss: 0.2875, label: 2, bag_size: 910
batch 39, loss: 0.0571, instance_loss: 0.2827, weighted_loss: 0.1248, label: 3, bag_size: 1250
batch 59, loss: 0.1321, instance_loss: 0.1412, weighted_loss: 0.1349, label: 0, bag_size: 756
batch 79, loss: 0.1855, instance_loss: 0.1565, weighted_loss: 0.1768, label: 0, bag_size: 729
batch 99, loss: 1.6618, instance_loss: 0.3265, weighted_loss: 1.2612, label: 1, bag_size: 356
batch 119, loss: 0.2156, instance_loss: 0.1331, weighted_loss: 0.1909, label: 0, bag_size: 1061
batch 139, loss: 0.0310, instance_loss: 0.0319, weighted_loss: 0.0312, label: 0, bag_size: 602
batch 159, loss: 1.9839, instance_loss: 0.5556, weighted_loss: 1.5554, label: 4, bag_size: 1331
batch 179, loss: 0.1896, instance_loss: 0.2471, weighted_loss: 0.2069, label: 1, bag_size: 944
batch 199, loss: 0.0841, instance_loss: 0.2817, weighted_loss: 0.1434, label: 2, bag_size: 1788
batch 219, loss: 0.3573, instance_loss: 0.2135, weighted_loss: 0.3141, label: 3, bag_size: 729
batch 239, loss: 0.0125, instance_loss: 0.0905, weighted_loss: 0.0359, label: 4, bag_size: 729
batch 259, loss: 0.0585, instance_loss: 0.0723, weighted_loss: 0.0626, label: 3, bag_size: 556
batch 279, loss: 3.4739, instance_loss: 0.7138, weighted_loss: 2.6458, label: 0, bag_size: 818
batch 299, loss: 0.1476, instance_loss: 0.1481, weighted_loss: 0.1478, label: 0, bag_size: 1133
batch 319, loss: 0.3516, instance_loss: 0.4029, weighted_loss: 0.3670, label: 2, bag_size: 571
batch 339, loss: 0.2967, instance_loss: 0.1939, weighted_loss: 0.2659, label: 0, bag_size: 990
batch 359, loss: 3.3686, instance_loss: 0.9797, weighted_loss: 2.6519, label: 1, bag_size: 1409
batch 379, loss: 2.6570, instance_loss: 0.9423, weighted_loss: 2.1426, label: 2, bag_size: 1043
batch 399, loss: 0.1668, instance_loss: 0.1506, weighted_loss: 0.1619, label: 0, bag_size: 1247
batch 419, loss: 0.0949, instance_loss: 0.1777, weighted_loss: 0.1197, label: 0, bag_size: 729


class 0 clustering acc 0.9871764705882353: correct 16782/17000
class 1 clustering acc 0.34705882352941175: correct 1180/3400
Epoch: 16, train_loss: 0.5312, train_clustering_loss:  0.3396, train_error: 0.2047
class 0: acc 0.9156626506024096, correct 76/83
class 1: acc 0.632183908045977, correct 55/87
class 2: acc 0.7386363636363636, correct 65/88
class 3: acc 0.9041095890410958, correct 66/73
class 4: acc 0.8085106382978723, correct 76/94

Val Set, val_loss: 1.0433, val_error: 0.3400, auc: 0.8614
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3258, instance_loss: 0.2429, weighted_loss: 0.3009, label: 0, bag_size: 476
batch 39, loss: 0.1383, instance_loss: 0.1391, weighted_loss: 0.1385, label: 0, bag_size: 607
batch 59, loss: 0.1392, instance_loss: 0.3308, weighted_loss: 0.1967, label: 3, bag_size: 1118
batch 79, loss: 0.1921, instance_loss: 0.3299, weighted_loss: 0.2334, label: 2, bag_size: 324
batch 99, loss: 0.0100, instance_loss: 0.2580, weighted_loss: 0.0844, label: 4, bag_size: 297
batch 119, loss: 2.4467, instance_loss: 0.6916, weighted_loss: 1.9202, label: 2, bag_size: 248
batch 139, loss: 0.2252, instance_loss: 0.3742, weighted_loss: 0.2699, label: 4, bag_size: 625
batch 159, loss: 0.1978, instance_loss: 0.1016, weighted_loss: 0.1689, label: 3, bag_size: 729
batch 179, loss: 0.2798, instance_loss: 0.2450, weighted_loss: 0.2694, label: 0, bag_size: 545
batch 199, loss: 1.1018, instance_loss: 0.6556, weighted_loss: 0.9679, label: 1, bag_size: 1409
batch 219, loss: 0.0153, instance_loss: 0.0972, weighted_loss: 0.0399, label: 4, bag_size: 646
batch 239, loss: 0.0818, instance_loss: 0.2795, weighted_loss: 0.1411, label: 1, bag_size: 890
batch 259, loss: 0.1847, instance_loss: 0.3319, weighted_loss: 0.2289, label: 2, bag_size: 863
batch 279, loss: 0.0437, instance_loss: 0.3029, weighted_loss: 0.1214, label: 4, bag_size: 663
batch 299, loss: 0.0702, instance_loss: 0.1032, weighted_loss: 0.0801, label: 0, bag_size: 921
batch 319, loss: 0.4810, instance_loss: 0.1712, weighted_loss: 0.3881, label: 1, bag_size: 944
batch 339, loss: 0.0015, instance_loss: 0.1502, weighted_loss: 0.0461, label: 4, bag_size: 729
batch 359, loss: 0.0303, instance_loss: 0.0437, weighted_loss: 0.0343, label: 0, bag_size: 898
batch 379, loss: 0.8001, instance_loss: 0.6328, weighted_loss: 0.7499, label: 2, bag_size: 1677
batch 399, loss: 0.4012, instance_loss: 0.2571, weighted_loss: 0.3580, label: 3, bag_size: 1118
batch 419, loss: 0.8141, instance_loss: 0.4196, weighted_loss: 0.6957, label: 2, bag_size: 1164


class 0 clustering acc 0.9885882352941177: correct 16806/17000
class 1 clustering acc 0.35970588235294115: correct 1223/3400
Epoch: 17, train_loss: 0.4363, train_clustering_loss:  0.3308, train_error: 0.1553
class 0: acc 0.9662921348314607, correct 86/89
class 1: acc 0.6956521739130435, correct 64/92
class 2: acc 0.7058823529411765, correct 60/85
class 3: acc 0.9466666666666667, correct 71/75
class 4: acc 0.9285714285714286, correct 78/84

Val Set, val_loss: 1.0040, val_error: 0.4000, auc: 0.8589
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1187, instance_loss: 0.1701, weighted_loss: 0.1341, label: 3, bag_size: 729
batch 39, loss: 0.0358, instance_loss: 0.0818, weighted_loss: 0.0496, label: 0, bag_size: 1018
batch 59, loss: 0.0594, instance_loss: 0.0845, weighted_loss: 0.0669, label: 0, bag_size: 1247
batch 79, loss: 0.2214, instance_loss: 0.2870, weighted_loss: 0.2410, label: 2, bag_size: 480
batch 99, loss: 0.5109, instance_loss: 0.3180, weighted_loss: 0.4530, label: 0, bag_size: 200
batch 119, loss: 0.0425, instance_loss: 0.0863, weighted_loss: 0.0556, label: 4, bag_size: 729
batch 139, loss: 0.1711, instance_loss: 0.2686, weighted_loss: 0.2004, label: 0, bag_size: 255
batch 159, loss: 1.7842, instance_loss: 0.7171, weighted_loss: 1.4640, label: 2, bag_size: 408
batch 179, loss: 0.6349, instance_loss: 0.4805, weighted_loss: 0.5886, label: 1, bag_size: 343
batch 199, loss: 1.7558, instance_loss: 0.6738, weighted_loss: 1.4312, label: 1, bag_size: 386
batch 219, loss: 0.8147, instance_loss: 0.6317, weighted_loss: 0.7598, label: 2, bag_size: 679
batch 239, loss: 0.0993, instance_loss: 0.0852, weighted_loss: 0.0951, label: 3, bag_size: 729
batch 259, loss: 0.2542, instance_loss: 0.4182, weighted_loss: 0.3034, label: 1, bag_size: 474
batch 279, loss: 0.5773, instance_loss: 0.2113, weighted_loss: 0.4675, label: 3, bag_size: 1019
batch 299, loss: 0.1217, instance_loss: 0.1807, weighted_loss: 0.1394, label: 0, bag_size: 367
batch 319, loss: 0.5788, instance_loss: 0.3835, weighted_loss: 0.5202, label: 2, bag_size: 883
batch 339, loss: 0.5030, instance_loss: 0.5067, weighted_loss: 0.5041, label: 2, bag_size: 537
batch 359, loss: 0.2470, instance_loss: 0.3119, weighted_loss: 0.2665, label: 2, bag_size: 480
batch 379, loss: 1.1511, instance_loss: 0.4865, weighted_loss: 0.9517, label: 4, bag_size: 436
batch 399, loss: 0.0269, instance_loss: 0.2985, weighted_loss: 0.1084, label: 4, bag_size: 773
batch 419, loss: 0.3337, instance_loss: 0.3139, weighted_loss: 0.3278, label: 2, bag_size: 419


class 0 clustering acc 0.9913529411764705: correct 16853/17000
class 1 clustering acc 0.4194117647058824: correct 1426/3400
Epoch: 18, train_loss: 0.4097, train_clustering_loss:  0.3037, train_error: 0.1553
class 0: acc 0.967032967032967, correct 88/91
class 1: acc 0.6375, correct 51/80
class 2: acc 0.7272727272727273, correct 64/88
class 3: acc 0.974025974025974, correct 75/77
class 4: acc 0.9101123595505618, correct 81/89

Val Set, val_loss: 1.0339, val_error: 0.4200, auc: 0.8479
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.2225: correct 89/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.42857142857142855, correct 3/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3520, instance_loss: 0.4537, weighted_loss: 0.3825, label: 2, bag_size: 1128
batch 39, loss: 0.1125, instance_loss: 0.1574, weighted_loss: 0.1259, label: 0, bag_size: 1190
batch 59, loss: 0.0149, instance_loss: 0.1636, weighted_loss: 0.0595, label: 4, bag_size: 646
batch 79, loss: 0.3162, instance_loss: 0.6456, weighted_loss: 0.4150, label: 1, bag_size: 1390
batch 99, loss: 0.3930, instance_loss: 0.4089, weighted_loss: 0.3978, label: 2, bag_size: 621
batch 119, loss: 0.2228, instance_loss: 0.4175, weighted_loss: 0.2812, label: 2, bag_size: 1416
batch 139, loss: 0.1391, instance_loss: 0.4571, weighted_loss: 0.2345, label: 4, bag_size: 663
batch 159, loss: 0.3314, instance_loss: 0.3420, weighted_loss: 0.3346, label: 2, bag_size: 324
batch 179, loss: 0.2428, instance_loss: 0.4287, weighted_loss: 0.2985, label: 1, bag_size: 1144
batch 199, loss: 0.9005, instance_loss: 0.4916, weighted_loss: 0.7778, label: 1, bag_size: 1144
batch 219, loss: 0.4446, instance_loss: 0.3290, weighted_loss: 0.4099, label: 1, bag_size: 1651
batch 239, loss: 0.0765, instance_loss: 0.1276, weighted_loss: 0.0918, label: 0, bag_size: 933
batch 259, loss: 0.8934, instance_loss: 0.4546, weighted_loss: 0.7617, label: 2, bag_size: 911
batch 279, loss: 0.5787, instance_loss: 0.7840, weighted_loss: 0.6403, label: 3, bag_size: 211
batch 299, loss: 0.1859, instance_loss: 0.2647, weighted_loss: 0.2095, label: 2, bag_size: 932
batch 319, loss: 0.3084, instance_loss: 0.2601, weighted_loss: 0.2939, label: 0, bag_size: 756
batch 339, loss: 1.8085, instance_loss: 0.6527, weighted_loss: 1.4618, label: 1, bag_size: 1376
batch 359, loss: 0.0548, instance_loss: 0.1231, weighted_loss: 0.0753, label: 0, bag_size: 1018
batch 379, loss: 1.3399, instance_loss: 0.5584, weighted_loss: 1.1054, label: 1, bag_size: 399
batch 399, loss: 1.3107, instance_loss: 0.5501, weighted_loss: 1.0825, label: 1, bag_size: 1273
batch 419, loss: 0.1020, instance_loss: 0.4037, weighted_loss: 0.1925, label: 3, bag_size: 360


class 0 clustering acc 0.9906470588235294: correct 16841/17000
class 1 clustering acc 0.38529411764705884: correct 1310/3400
Epoch: 19, train_loss: 0.4465, train_clustering_loss:  0.3200, train_error: 0.1671
class 0: acc 0.9078947368421053, correct 69/76
class 1: acc 0.711340206185567, correct 69/97
class 2: acc 0.6987951807228916, correct 58/83
class 3: acc 0.9642857142857143, correct 81/84
class 4: acc 0.9058823529411765, correct 77/85

Val Set, val_loss: 1.2106, val_error: 0.4600, auc: 0.8384
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.195: correct 78/400
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0380, instance_loss: 0.1000, weighted_loss: 0.0566, label: 3, bag_size: 729
batch 39, loss: 2.2467, instance_loss: 0.7354, weighted_loss: 1.7933, label: 0, bag_size: 818
batch 59, loss: 0.0256, instance_loss: 0.0589, weighted_loss: 0.0356, label: 3, bag_size: 729
batch 79, loss: 0.5210, instance_loss: 0.4361, weighted_loss: 0.4955, label: 1, bag_size: 1144
batch 99, loss: 0.2353, instance_loss: 0.2454, weighted_loss: 0.2383, label: 1, bag_size: 690
batch 119, loss: 1.1651, instance_loss: 0.4853, weighted_loss: 0.9612, label: 4, bag_size: 436
batch 139, loss: 0.1996, instance_loss: 0.3223, weighted_loss: 0.2364, label: 4, bag_size: 533
batch 159, loss: 0.0745, instance_loss: 0.1350, weighted_loss: 0.0926, label: 3, bag_size: 230
batch 179, loss: 0.1448, instance_loss: 0.1671, weighted_loss: 0.1515, label: 0, bag_size: 1190
batch 199, loss: 0.2223, instance_loss: 0.3373, weighted_loss: 0.2568, label: 3, bag_size: 533
batch 219, loss: 0.9847, instance_loss: 0.4707, weighted_loss: 0.8305, label: 1, bag_size: 102
batch 239, loss: 0.8120, instance_loss: 0.6289, weighted_loss: 0.7570, label: 3, bag_size: 706
batch 259, loss: 0.0087, instance_loss: 0.0596, weighted_loss: 0.0239, label: 4, bag_size: 646
batch 279, loss: 2.0627, instance_loss: 0.4803, weighted_loss: 1.5880, label: 4, bag_size: 1331
batch 299, loss: 0.0296, instance_loss: 0.0737, weighted_loss: 0.0429, label: 3, bag_size: 556
batch 319, loss: 0.0378, instance_loss: 0.0794, weighted_loss: 0.0503, label: 0, bag_size: 382
batch 339, loss: 0.2639, instance_loss: 0.2224, weighted_loss: 0.2514, label: 2, bag_size: 252
batch 359, loss: 0.5147, instance_loss: 0.3569, weighted_loss: 0.4674, label: 4, bag_size: 1357
batch 379, loss: 0.6651, instance_loss: 0.4626, weighted_loss: 0.6043, label: 3, bag_size: 1380
batch 399, loss: 0.7607, instance_loss: 0.3683, weighted_loss: 0.6430, label: 2, bag_size: 1404
batch 419, loss: 0.0189, instance_loss: 0.1476, weighted_loss: 0.0575, label: 3, bag_size: 1253


class 0 clustering acc 0.9901764705882353: correct 16833/17000
class 1 clustering acc 0.4082352941176471: correct 1388/3400
Epoch: 20, train_loss: 0.4544, train_clustering_loss:  0.3183, train_error: 0.1576
class 0: acc 0.9012345679012346, correct 73/81
class 1: acc 0.6588235294117647, correct 56/85
class 2: acc 0.7875, correct 63/80
class 3: acc 0.9555555555555556, correct 86/90
class 4: acc 0.898876404494382, correct 80/89

Val Set, val_loss: 1.0365, val_error: 0.3400, auc: 0.8621
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.2075: correct 83/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.9174, instance_loss: 0.4817, weighted_loss: 0.7867, label: 1, bag_size: 470
batch 39, loss: 0.0006, instance_loss: 0.1420, weighted_loss: 0.0430, label: 4, bag_size: 729
batch 59, loss: 0.1191, instance_loss: 0.2347, weighted_loss: 0.1538, label: 4, bag_size: 533
batch 79, loss: 0.0255, instance_loss: 0.3010, weighted_loss: 0.1081, label: 1, bag_size: 1376
batch 99, loss: 0.1235, instance_loss: 0.3246, weighted_loss: 0.1839, label: 2, bag_size: 863
batch 119, loss: 0.1514, instance_loss: 0.2247, weighted_loss: 0.1734, label: 0, bag_size: 1086
batch 139, loss: 0.4410, instance_loss: 0.5908, weighted_loss: 0.4860, label: 3, bag_size: 630
batch 159, loss: 1.5793, instance_loss: 0.4812, weighted_loss: 1.2499, label: 3, bag_size: 360
batch 179, loss: 0.7428, instance_loss: 0.5614, weighted_loss: 0.6884, label: 2, bag_size: 1617
batch 199, loss: 0.0223, instance_loss: 0.4705, weighted_loss: 0.1567, label: 3, bag_size: 1167
batch 219, loss: 0.5922, instance_loss: 0.4040, weighted_loss: 0.5358, label: 2, bag_size: 345
batch 239, loss: 0.0182, instance_loss: 0.0882, weighted_loss: 0.0392, label: 3, bag_size: 729
batch 259, loss: 0.7316, instance_loss: 0.5983, weighted_loss: 0.6916, label: 1, bag_size: 868
batch 279, loss: 0.2786, instance_loss: 0.2650, weighted_loss: 0.2745, label: 1, bag_size: 697
batch 299, loss: 0.9831, instance_loss: 0.5195, weighted_loss: 0.8441, label: 2, bag_size: 1231
batch 319, loss: 0.1068, instance_loss: 0.1235, weighted_loss: 0.1118, label: 0, bag_size: 602
batch 339, loss: 2.2272, instance_loss: 0.5574, weighted_loss: 1.7263, label: 0, bag_size: 1257
batch 359, loss: 0.0019, instance_loss: 0.0317, weighted_loss: 0.0108, label: 3, bag_size: 729
batch 379, loss: 3.1369, instance_loss: 0.8656, weighted_loss: 2.4555, label: 0, bag_size: 818
batch 399, loss: 0.2559, instance_loss: 0.3349, weighted_loss: 0.2796, label: 2, bag_size: 614
batch 419, loss: 0.2112, instance_loss: 0.2982, weighted_loss: 0.2373, label: 1, bag_size: 320


class 0 clustering acc 0.9909411764705882: correct 16846/17000
class 1 clustering acc 0.40088235294117647: correct 1363/3400
Epoch: 21, train_loss: 0.3644, train_clustering_loss:  0.3103, train_error: 0.1435
class 0: acc 0.9027777777777778, correct 65/72
class 1: acc 0.6666666666666666, correct 58/87
class 2: acc 0.7469879518072289, correct 62/83
class 3: acc 0.9777777777777777, correct 88/90
class 4: acc 0.978494623655914, correct 91/93

Val Set, val_loss: 0.9068, val_error: 0.3600, auc: 0.8839
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
Validation loss decreased (0.951915 --> 0.906757).  Saving model ...


batch 19, loss: 0.0401, instance_loss: 0.5382, weighted_loss: 0.1895, label: 3, bag_size: 1167
batch 39, loss: 0.0249, instance_loss: 0.1113, weighted_loss: 0.0509, label: 3, bag_size: 729
batch 59, loss: 0.1971, instance_loss: 0.3081, weighted_loss: 0.2304, label: 2, bag_size: 271
batch 79, loss: 1.3212, instance_loss: 0.6255, weighted_loss: 1.1125, label: 1, bag_size: 269
batch 99, loss: 0.0191, instance_loss: 0.6356, weighted_loss: 0.2040, label: 3, bag_size: 281
batch 119, loss: 1.6403, instance_loss: 0.3099, weighted_loss: 1.2412, label: 0, bag_size: 729
batch 139, loss: 0.0905, instance_loss: 0.1202, weighted_loss: 0.0994, label: 0, bag_size: 478
batch 159, loss: 0.0312, instance_loss: 0.0653, weighted_loss: 0.0415, label: 0, bag_size: 729
batch 179, loss: 0.0679, instance_loss: 0.5050, weighted_loss: 0.1990, label: 3, bag_size: 1250
batch 199, loss: 0.0029, instance_loss: 0.1301, weighted_loss: 0.0410, label: 4, bag_size: 729
batch 219, loss: 2.1072, instance_loss: 0.9832, weighted_loss: 1.7700, label: 1, bag_size: 651
batch 239, loss: 0.8477, instance_loss: 0.5250, weighted_loss: 0.7509, label: 2, bag_size: 1006
batch 259, loss: 0.0777, instance_loss: 0.2725, weighted_loss: 0.1361, label: 4, bag_size: 1357
batch 279, loss: 0.1695, instance_loss: 0.2539, weighted_loss: 0.1948, label: 0, bag_size: 1086
batch 299, loss: 0.0019, instance_loss: 0.1742, weighted_loss: 0.0536, label: 4, bag_size: 729
batch 319, loss: 0.0527, instance_loss: 0.1270, weighted_loss: 0.0749, label: 0, bag_size: 1190
batch 339, loss: 0.0302, instance_loss: 0.0599, weighted_loss: 0.0391, label: 0, bag_size: 402
batch 359, loss: 0.2639, instance_loss: 0.2845, weighted_loss: 0.2701, label: 0, bag_size: 545
batch 379, loss: 2.0698, instance_loss: 0.5959, weighted_loss: 1.6276, label: 1, bag_size: 936
batch 399, loss: 0.2385, instance_loss: 0.4624, weighted_loss: 0.3056, label: 1, bag_size: 102
batch 419, loss: 0.0084, instance_loss: 0.3012, weighted_loss: 0.0962, label: 3, bag_size: 791


class 0 clustering acc 0.988764705882353: correct 16809/17000
class 1 clustering acc 0.41294117647058826: correct 1404/3400
Epoch: 22, train_loss: 0.3557, train_clustering_loss:  0.3118, train_error: 0.1294
class 0: acc 0.9390243902439024, correct 77/82
class 1: acc 0.6794871794871795, correct 53/78
class 2: acc 0.8, correct 64/80
class 3: acc 0.9393939393939394, correct 93/99
class 4: acc 0.9651162790697675, correct 83/86

Val Set, val_loss: 0.9312, val_error: 0.3800, auc: 0.8786
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0279, instance_loss: 0.4876, weighted_loss: 0.1658, label: 4, bag_size: 663
batch 39, loss: 0.3944, instance_loss: 0.4947, weighted_loss: 0.4245, label: 2, bag_size: 766
batch 59, loss: 0.0384, instance_loss: 0.1470, weighted_loss: 0.0710, label: 1, bag_size: 937
batch 79, loss: 0.0337, instance_loss: 0.0725, weighted_loss: 0.0454, label: 0, bag_size: 1190
batch 99, loss: 0.0100, instance_loss: 0.0694, weighted_loss: 0.0278, label: 3, bag_size: 729
batch 119, loss: 0.1227, instance_loss: 0.0680, weighted_loss: 0.1063, label: 3, bag_size: 556
batch 139, loss: 0.0258, instance_loss: 0.1913, weighted_loss: 0.0755, label: 1, bag_size: 945
batch 159, loss: 0.2268, instance_loss: 0.3022, weighted_loss: 0.2494, label: 2, bag_size: 1385
batch 179, loss: 0.3485, instance_loss: 0.2741, weighted_loss: 0.3262, label: 4, bag_size: 354
batch 199, loss: 1.3975, instance_loss: 0.4220, weighted_loss: 1.1049, label: 1, bag_size: 1646
batch 219, loss: 0.0081, instance_loss: 0.4526, weighted_loss: 0.1415, label: 4, bag_size: 1235
batch 239, loss: 3.1879, instance_loss: 0.6846, weighted_loss: 2.4369, label: 4, bag_size: 210
batch 259, loss: 0.0892, instance_loss: 0.1388, weighted_loss: 0.1041, label: 0, bag_size: 413
batch 279, loss: 1.0690, instance_loss: 0.5355, weighted_loss: 0.9089, label: 1, bag_size: 308
batch 299, loss: 0.1347, instance_loss: 0.2915, weighted_loss: 0.1817, label: 2, bag_size: 1053
batch 319, loss: 1.1230, instance_loss: 0.6873, weighted_loss: 0.9923, label: 1, bag_size: 1255
batch 339, loss: 1.2231, instance_loss: 0.4575, weighted_loss: 0.9934, label: 1, bag_size: 1724
batch 359, loss: 0.0500, instance_loss: 0.1453, weighted_loss: 0.0786, label: 0, bag_size: 729
batch 379, loss: 0.0406, instance_loss: 0.2366, weighted_loss: 0.0994, label: 1, bag_size: 1014
batch 399, loss: 0.0005, instance_loss: 0.0889, weighted_loss: 0.0270, label: 4, bag_size: 729
batch 419, loss: 0.3204, instance_loss: 0.3289, weighted_loss: 0.3230, label: 2, bag_size: 1404


class 0 clustering acc 0.9869411764705882: correct 16778/17000
class 1 clustering acc 0.4052941176470588: correct 1378/3400
Epoch: 23, train_loss: 0.4094, train_clustering_loss:  0.3219, train_error: 0.1482
class 0: acc 0.9529411764705882, correct 81/85
class 1: acc 0.6627906976744186, correct 57/86
class 2: acc 0.7865168539325843, correct 70/89
class 3: acc 0.963855421686747, correct 80/83
class 4: acc 0.9024390243902439, correct 74/82

Val Set, val_loss: 1.2134, val_error: 0.4800, auc: 0.8386
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.1775: correct 71/400
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.2857142857142857, correct 2/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7606, instance_loss: 0.4326, weighted_loss: 0.6622, label: 2, bag_size: 1180
batch 39, loss: 0.0064, instance_loss: 0.0837, weighted_loss: 0.0296, label: 3, bag_size: 1291
batch 59, loss: 0.0407, instance_loss: 0.1234, weighted_loss: 0.0655, label: 4, bag_size: 1176
batch 79, loss: 0.3549, instance_loss: 0.4193, weighted_loss: 0.3742, label: 1, bag_size: 965
batch 99, loss: 0.7478, instance_loss: 0.5774, weighted_loss: 0.6967, label: 2, bag_size: 732
batch 119, loss: 0.1366, instance_loss: 0.3551, weighted_loss: 0.2022, label: 2, bag_size: 2826
batch 139, loss: 0.0619, instance_loss: 0.2906, weighted_loss: 0.1305, label: 1, bag_size: 925
batch 159, loss: 0.6562, instance_loss: 0.2373, weighted_loss: 0.5305, label: 0, bag_size: 200
batch 179, loss: 0.0187, instance_loss: 0.3760, weighted_loss: 0.1259, label: 3, bag_size: 706
batch 199, loss: 0.0435, instance_loss: 0.1796, weighted_loss: 0.0843, label: 1, bag_size: 944
batch 219, loss: 0.0032, instance_loss: 0.1780, weighted_loss: 0.0556, label: 4, bag_size: 729
batch 239, loss: 0.0672, instance_loss: 0.5873, weighted_loss: 0.2232, label: 3, bag_size: 607
batch 259, loss: 1.7330, instance_loss: 0.6471, weighted_loss: 1.4072, label: 1, bag_size: 770
batch 279, loss: 0.8197, instance_loss: 0.3571, weighted_loss: 0.6809, label: 1, bag_size: 1646
batch 299, loss: 0.4199, instance_loss: 0.4119, weighted_loss: 0.4175, label: 2, bag_size: 1123
batch 319, loss: 0.1150, instance_loss: 0.2298, weighted_loss: 0.1494, label: 2, bag_size: 1019
batch 339, loss: 0.0009, instance_loss: 0.0613, weighted_loss: 0.0190, label: 4, bag_size: 729
batch 359, loss: 0.0378, instance_loss: 0.0863, weighted_loss: 0.0523, label: 3, bag_size: 729
batch 379, loss: 0.0982, instance_loss: 0.1994, weighted_loss: 0.1286, label: 1, bag_size: 697
batch 399, loss: 0.0942, instance_loss: 0.2488, weighted_loss: 0.1406, label: 3, bag_size: 671
batch 419, loss: 0.6617, instance_loss: 0.6185, weighted_loss: 0.6488, label: 2, bag_size: 295


class 0 clustering acc 0.9905882352941177: correct 16840/17000
class 1 clustering acc 0.42323529411764704: correct 1439/3400
Epoch: 24, train_loss: 0.3494, train_clustering_loss:  0.3037, train_error: 0.1082
class 0: acc 0.9305555555555556, correct 67/72
class 1: acc 0.7802197802197802, correct 71/91
class 2: acc 0.782051282051282, correct 61/78
class 3: acc 0.9882352941176471, correct 84/85
class 4: acc 0.9696969696969697, correct 96/99

Val Set, val_loss: 1.0524, val_error: 0.3800, auc: 0.8603
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.2425: correct 97/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1087, instance_loss: 0.2806, weighted_loss: 0.1602, label: 2, bag_size: 932
batch 39, loss: 0.1463, instance_loss: 0.6241, weighted_loss: 0.2897, label: 3, bag_size: 630
batch 59, loss: 0.0299, instance_loss: 0.2270, weighted_loss: 0.0891, label: 3, bag_size: 317
batch 79, loss: 0.9494, instance_loss: 0.4895, weighted_loss: 0.8114, label: 2, bag_size: 194
batch 99, loss: 0.0130, instance_loss: 0.0340, weighted_loss: 0.0193, label: 0, bag_size: 518
batch 119, loss: 0.0955, instance_loss: 0.2532, weighted_loss: 0.1428, label: 1, bag_size: 1325
batch 139, loss: 0.0478, instance_loss: 0.1301, weighted_loss: 0.0725, label: 0, bag_size: 552
batch 159, loss: 0.0121, instance_loss: 0.0978, weighted_loss: 0.0378, label: 0, bag_size: 1599
batch 179, loss: 1.8334, instance_loss: 0.6336, weighted_loss: 1.4735, label: 2, bag_size: 803
batch 199, loss: 0.0443, instance_loss: 0.1921, weighted_loss: 0.0886, label: 2, bag_size: 1019
batch 219, loss: 0.2723, instance_loss: 0.4168, weighted_loss: 0.3157, label: 3, bag_size: 671
batch 239, loss: 0.0403, instance_loss: 0.2087, weighted_loss: 0.0908, label: 2, bag_size: 1235
batch 259, loss: 0.2797, instance_loss: 0.2474, weighted_loss: 0.2700, label: 4, bag_size: 826
batch 279, loss: 0.0253, instance_loss: 0.2889, weighted_loss: 0.1044, label: 4, bag_size: 754
batch 299, loss: 0.0226, instance_loss: 0.1351, weighted_loss: 0.0563, label: 3, bag_size: 729
batch 319, loss: 0.0581, instance_loss: 0.1960, weighted_loss: 0.0994, label: 0, bag_size: 729
batch 339, loss: 0.6264, instance_loss: 0.4355, weighted_loss: 0.5691, label: 1, bag_size: 343
batch 359, loss: 0.0236, instance_loss: 0.2691, weighted_loss: 0.0972, label: 3, bag_size: 1250
batch 379, loss: 0.0307, instance_loss: 0.0980, weighted_loss: 0.0508, label: 0, bag_size: 729
batch 399, loss: 0.0801, instance_loss: 0.2931, weighted_loss: 0.1440, label: 2, bag_size: 317
batch 419, loss: 0.4328, instance_loss: 0.2907, weighted_loss: 0.3902, label: 0, bag_size: 570


class 0 clustering acc 0.9877058823529412: correct 16791/17000
class 1 clustering acc 0.4164705882352941: correct 1416/3400
Epoch: 25, train_loss: 0.3554, train_clustering_loss:  0.3119, train_error: 0.1200
class 0: acc 0.9222222222222223, correct 83/90
class 1: acc 0.6666666666666666, correct 52/78
class 2: acc 0.8461538461538461, correct 77/91
class 3: acc 0.9900990099009901, correct 100/101
class 4: acc 0.9538461538461539, correct 62/65

Val Set, val_loss: 1.0380, val_error: 0.4000, auc: 0.8722
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.2525: correct 101/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0249, instance_loss: 0.0435, weighted_loss: 0.0305, label: 0, bag_size: 1599
batch 39, loss: 0.0476, instance_loss: 0.1460, weighted_loss: 0.0771, label: 0, bag_size: 756
batch 59, loss: 0.1942, instance_loss: 0.6840, weighted_loss: 0.3411, label: 3, bag_size: 211
batch 79, loss: 0.0783, instance_loss: 0.2660, weighted_loss: 0.1346, label: 1, bag_size: 1144
batch 99, loss: 0.0074, instance_loss: 0.4060, weighted_loss: 0.1270, label: 1, bag_size: 1152
batch 119, loss: 0.0172, instance_loss: 0.1243, weighted_loss: 0.0494, label: 4, bag_size: 773
batch 139, loss: 0.0232, instance_loss: 0.0644, weighted_loss: 0.0356, label: 1, bag_size: 286
batch 159, loss: 1.5727, instance_loss: 0.5891, weighted_loss: 1.2776, label: 1, bag_size: 770
batch 179, loss: 0.1664, instance_loss: 0.4055, weighted_loss: 0.2381, label: 1, bag_size: 614
batch 199, loss: 0.0161, instance_loss: 0.0454, weighted_loss: 0.0249, label: 0, bag_size: 1143
batch 219, loss: 0.0109, instance_loss: 0.0687, weighted_loss: 0.0282, label: 3, bag_size: 729
batch 239, loss: 0.6512, instance_loss: 0.4577, weighted_loss: 0.5931, label: 2, bag_size: 358
batch 259, loss: 0.2675, instance_loss: 0.2745, weighted_loss: 0.2696, label: 2, bag_size: 2081
batch 279, loss: 0.2968, instance_loss: 0.3705, weighted_loss: 0.3189, label: 1, bag_size: 818
batch 299, loss: 0.0069, instance_loss: 0.9777, weighted_loss: 0.2982, label: 4, bag_size: 974
batch 319, loss: 0.0296, instance_loss: 0.2306, weighted_loss: 0.0899, label: 1, bag_size: 682
batch 339, loss: 0.0448, instance_loss: 0.0784, weighted_loss: 0.0549, label: 3, bag_size: 556
batch 359, loss: 0.0662, instance_loss: 0.2272, weighted_loss: 0.1145, label: 4, bag_size: 1176
batch 379, loss: 0.0413, instance_loss: 0.2428, weighted_loss: 0.1018, label: 3, bag_size: 1253
batch 399, loss: 0.0066, instance_loss: 0.2131, weighted_loss: 0.0685, label: 1, bag_size: 1376
batch 419, loss: 0.1363, instance_loss: 0.6066, weighted_loss: 0.2774, label: 3, bag_size: 630


class 0 clustering acc 0.9898823529411764: correct 16828/17000
class 1 clustering acc 0.40647058823529414: correct 1382/3400
Epoch: 26, train_loss: 0.3745, train_clustering_loss:  0.3150, train_error: 0.1412
class 0: acc 0.8765432098765432, correct 71/81
class 1: acc 0.6404494382022472, correct 57/89
class 2: acc 0.8395061728395061, correct 68/81
class 3: acc 1.0, correct 97/97
class 4: acc 0.935064935064935, correct 72/77

Val Set, val_loss: 1.0337, val_error: 0.3600, auc: 0.8584
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.2425: correct 97/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1224, instance_loss: 0.2009, weighted_loss: 0.1460, label: 0, bag_size: 729
batch 39, loss: 0.6154, instance_loss: 0.3496, weighted_loss: 0.5357, label: 3, bag_size: 533
batch 59, loss: 1.4720, instance_loss: 0.6381, weighted_loss: 1.2218, label: 2, bag_size: 803
batch 79, loss: 0.0895, instance_loss: 0.1230, weighted_loss: 0.0996, label: 3, bag_size: 1291
batch 99, loss: 0.3448, instance_loss: 0.3548, weighted_loss: 0.3478, label: 0, bag_size: 350
batch 119, loss: 0.0128, instance_loss: 0.1201, weighted_loss: 0.0450, label: 3, bag_size: 230
batch 139, loss: 0.0015, instance_loss: 0.3250, weighted_loss: 0.0985, label: 4, bag_size: 729
batch 159, loss: 0.2572, instance_loss: 0.3131, weighted_loss: 0.2740, label: 2, bag_size: 1514
batch 179, loss: 0.9274, instance_loss: 0.9507, weighted_loss: 0.9344, label: 2, bag_size: 679
batch 199, loss: 0.0745, instance_loss: 0.5566, weighted_loss: 0.2191, label: 3, bag_size: 1380
batch 219, loss: 1.2520, instance_loss: 0.5277, weighted_loss: 1.0347, label: 1, bag_size: 770
batch 239, loss: 0.3727, instance_loss: 0.3716, weighted_loss: 0.3724, label: 1, bag_size: 818
batch 259, loss: 0.6953, instance_loss: 0.5515, weighted_loss: 0.6522, label: 0, bag_size: 868
batch 279, loss: 0.4388, instance_loss: 0.4249, weighted_loss: 0.4346, label: 2, bag_size: 222
batch 299, loss: 0.0186, instance_loss: 0.0464, weighted_loss: 0.0269, label: 0, bag_size: 1018
batch 319, loss: 0.0127, instance_loss: 0.0512, weighted_loss: 0.0242, label: 3, bag_size: 729
batch 339, loss: 0.0917, instance_loss: 0.0497, weighted_loss: 0.0791, label: 3, bag_size: 556
batch 359, loss: 0.0153, instance_loss: 0.0484, weighted_loss: 0.0252, label: 3, bag_size: 729
batch 379, loss: 0.1691, instance_loss: 0.2731, weighted_loss: 0.2003, label: 1, bag_size: 343
batch 399, loss: 0.0893, instance_loss: 0.1237, weighted_loss: 0.0996, label: 0, bag_size: 340
batch 419, loss: 0.0421, instance_loss: 0.1737, weighted_loss: 0.0815, label: 1, bag_size: 994


class 0 clustering acc 0.9911176470588235: correct 16849/17000
class 1 clustering acc 0.4370588235294118: correct 1486/3400
Epoch: 27, train_loss: 0.3130, train_clustering_loss:  0.2979, train_error: 0.1176
class 0: acc 0.9459459459459459, correct 70/74
class 1: acc 0.686046511627907, correct 59/86
class 2: acc 0.7910447761194029, correct 53/67
class 3: acc 0.9803921568627451, correct 100/102
class 4: acc 0.96875, correct 93/96

Val Set, val_loss: 1.1608, val_error: 0.4200, auc: 0.8574
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1279, instance_loss: 0.4488, weighted_loss: 0.2242, label: 4, bag_size: 1360
batch 39, loss: 0.3915, instance_loss: 0.2763, weighted_loss: 0.3569, label: 3, bag_size: 791
batch 59, loss: 0.0235, instance_loss: 0.3472, weighted_loss: 0.1206, label: 1, bag_size: 1152
batch 79, loss: 0.1029, instance_loss: 0.1051, weighted_loss: 0.1035, label: 3, bag_size: 849
batch 99, loss: 0.4131, instance_loss: 0.2247, weighted_loss: 0.3566, label: 0, bag_size: 729
batch 119, loss: 0.0040, instance_loss: 0.1276, weighted_loss: 0.0411, label: 3, bag_size: 230
batch 139, loss: 0.0212, instance_loss: 0.2980, weighted_loss: 0.1042, label: 4, bag_size: 625
batch 159, loss: 0.0872, instance_loss: 0.2565, weighted_loss: 0.1380, label: 4, bag_size: 625
batch 179, loss: 0.0481, instance_loss: 0.1678, weighted_loss: 0.0840, label: 1, bag_size: 937
batch 199, loss: 0.1137, instance_loss: 0.1590, weighted_loss: 0.1273, label: 0, bag_size: 729
batch 219, loss: 0.0853, instance_loss: 0.1862, weighted_loss: 0.1156, label: 2, bag_size: 1448
batch 239, loss: 0.0505, instance_loss: 0.2261, weighted_loss: 0.1032, label: 1, bag_size: 834
batch 259, loss: 0.0264, instance_loss: 0.2783, weighted_loss: 0.1020, label: 4, bag_size: 656
batch 279, loss: 0.8979, instance_loss: 0.5334, weighted_loss: 0.7885, label: 1, bag_size: 1376
batch 299, loss: 0.0231, instance_loss: 0.1026, weighted_loss: 0.0469, label: 1, bag_size: 994
batch 319, loss: 0.0243, instance_loss: 0.3709, weighted_loss: 0.1283, label: 3, bag_size: 317
batch 339, loss: 1.8668, instance_loss: 0.6119, weighted_loss: 1.4903, label: 4, bag_size: 436
batch 359, loss: 1.2499, instance_loss: 0.8239, weighted_loss: 1.1221, label: 1, bag_size: 269
batch 379, loss: 0.9829, instance_loss: 0.5375, weighted_loss: 0.8493, label: 0, bag_size: 1065
batch 399, loss: 0.0221, instance_loss: 0.2304, weighted_loss: 0.0846, label: 1, bag_size: 1086
batch 419, loss: 0.0025, instance_loss: 0.0653, weighted_loss: 0.0213, label: 3, bag_size: 729


class 0 clustering acc 0.988764705882353: correct 16809/17000
class 1 clustering acc 0.42058823529411765: correct 1430/3400
Epoch: 28, train_loss: 0.2648, train_clustering_loss:  0.2960, train_error: 0.0824
class 0: acc 0.9295774647887324, correct 66/71
class 1: acc 0.8048780487804879, correct 66/82
class 2: acc 0.8888888888888888, correct 80/90
class 3: acc 0.9882352941176471, correct 84/85
class 4: acc 0.9690721649484536, correct 94/97

Val Set, val_loss: 1.0213, val_error: 0.3400, auc: 0.8721
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.5292, instance_loss: 0.4233, weighted_loss: 0.4975, label: 4, bag_size: 436
batch 39, loss: 0.0129, instance_loss: 0.1365, weighted_loss: 0.0500, label: 4, bag_size: 1357
batch 59, loss: 0.0043, instance_loss: 0.1523, weighted_loss: 0.0487, label: 3, bag_size: 343
batch 79, loss: 0.0369, instance_loss: 0.2339, weighted_loss: 0.0960, label: 2, bag_size: 1200
batch 99, loss: 0.0711, instance_loss: 0.5325, weighted_loss: 0.2095, label: 3, bag_size: 281
batch 119, loss: 1.8451, instance_loss: 1.0524, weighted_loss: 1.6073, label: 1, bag_size: 1409
batch 139, loss: 0.0308, instance_loss: 0.7575, weighted_loss: 0.2488, label: 3, bag_size: 281
batch 159, loss: 0.0065, instance_loss: 0.0603, weighted_loss: 0.0226, label: 0, bag_size: 1466
batch 179, loss: 0.3662, instance_loss: 0.3861, weighted_loss: 0.3722, label: 2, bag_size: 1164
batch 199, loss: 2.2200, instance_loss: 0.5319, weighted_loss: 1.7136, label: 1, bag_size: 487
batch 219, loss: 0.0949, instance_loss: 0.3314, weighted_loss: 0.1659, label: 3, bag_size: 360
batch 239, loss: 0.0268, instance_loss: 0.0457, weighted_loss: 0.0325, label: 3, bag_size: 556
batch 259, loss: 0.1361, instance_loss: 0.3325, weighted_loss: 0.1950, label: 1, bag_size: 869
batch 279, loss: 0.1754, instance_loss: 0.6996, weighted_loss: 0.3327, label: 1, bag_size: 860
batch 299, loss: 0.1201, instance_loss: 0.2711, weighted_loss: 0.1654, label: 1, bag_size: 320
batch 319, loss: 0.0755, instance_loss: 0.2018, weighted_loss: 0.1134, label: 2, bag_size: 357
batch 339, loss: 0.1815, instance_loss: 0.5041, weighted_loss: 0.2783, label: 1, bag_size: 474
batch 359, loss: 0.0197, instance_loss: 0.0982, weighted_loss: 0.0433, label: 0, bag_size: 518
batch 379, loss: 0.0022, instance_loss: 0.0474, weighted_loss: 0.0158, label: 1, bag_size: 937
batch 399, loss: 1.4939, instance_loss: 0.6943, weighted_loss: 1.2540, label: 2, bag_size: 248
batch 419, loss: 0.0050, instance_loss: 0.6330, weighted_loss: 0.1934, label: 3, bag_size: 1167


class 0 clustering acc 0.9878823529411764: correct 16794/17000
class 1 clustering acc 0.4335294117647059: correct 1474/3400
Epoch: 29, train_loss: 0.2911, train_clustering_loss:  0.3046, train_error: 0.0871
class 0: acc 0.9358974358974359, correct 73/78
class 1: acc 0.7666666666666667, correct 69/90
class 2: acc 0.8863636363636364, correct 78/88
class 3: acc 1.0, correct 87/87
class 4: acc 0.9878048780487805, correct 81/82

Val Set, val_loss: 1.0889, val_error: 0.3800, auc: 0.8625
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.25: correct 100/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0776, instance_loss: 0.2233, weighted_loss: 0.1213, label: 1, bag_size: 903
batch 39, loss: 0.5142, instance_loss: 0.3700, weighted_loss: 0.4709, label: 2, bag_size: 932
batch 59, loss: 0.4339, instance_loss: 0.3129, weighted_loss: 0.3976, label: 2, bag_size: 265
batch 79, loss: 0.0018, instance_loss: 0.0517, weighted_loss: 0.0168, label: 1, bag_size: 847
batch 99, loss: 0.2531, instance_loss: 0.5437, weighted_loss: 0.3403, label: 1, bag_size: 474
batch 119, loss: 0.1377, instance_loss: 0.2959, weighted_loss: 0.1852, label: 2, bag_size: 1533
batch 139, loss: 0.0106, instance_loss: 0.0501, weighted_loss: 0.0224, label: 0, bag_size: 982
batch 159, loss: 0.0029, instance_loss: 0.0681, weighted_loss: 0.0225, label: 4, bag_size: 729
batch 179, loss: 0.1439, instance_loss: 0.3975, weighted_loss: 0.2200, label: 3, bag_size: 706
batch 199, loss: 1.9889, instance_loss: 0.6073, weighted_loss: 1.5744, label: 1, bag_size: 936
batch 219, loss: 0.1283, instance_loss: 0.5868, weighted_loss: 0.2658, label: 3, bag_size: 281
batch 239, loss: 0.2672, instance_loss: 0.5015, weighted_loss: 0.3375, label: 4, bag_size: 1337
batch 259, loss: 0.5208, instance_loss: 0.5546, weighted_loss: 0.5310, label: 1, bag_size: 778
batch 279, loss: 0.0193, instance_loss: 0.0997, weighted_loss: 0.0434, label: 0, bag_size: 255
batch 299, loss: 0.0030, instance_loss: 0.1632, weighted_loss: 0.0511, label: 4, bag_size: 1235
batch 319, loss: 1.5371, instance_loss: 0.6541, weighted_loss: 1.2722, label: 4, bag_size: 210
batch 339, loss: 0.0006, instance_loss: 0.0415, weighted_loss: 0.0129, label: 4, bag_size: 729
batch 359, loss: 0.0122, instance_loss: 0.3153, weighted_loss: 0.1032, label: 1, bag_size: 1152
batch 379, loss: 0.3872, instance_loss: 0.3607, weighted_loss: 0.3792, label: 0, bag_size: 1301
batch 399, loss: 0.4793, instance_loss: 0.4865, weighted_loss: 0.4814, label: 2, bag_size: 1232
batch 419, loss: 0.0311, instance_loss: 0.2685, weighted_loss: 0.1023, label: 2, bag_size: 292


class 0 clustering acc 0.990764705882353: correct 16843/17000
class 1 clustering acc 0.4476470588235294: correct 1522/3400
Epoch: 30, train_loss: 0.3281, train_clustering_loss:  0.2918, train_error: 0.1176
class 0: acc 0.9642857142857143, correct 81/84
class 1: acc 0.7472527472527473, correct 68/91
class 2: acc 0.8125, correct 65/80
class 3: acc 0.9882352941176471, correct 84/85
class 4: acc 0.9058823529411765, correct 77/85

Val Set, val_loss: 1.2800, val_error: 0.4200, auc: 0.8439
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.5, correct 6/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0534, instance_loss: 0.1177, weighted_loss: 0.0727, label: 0, bag_size: 729
batch 39, loss: 0.3466, instance_loss: 0.4694, weighted_loss: 0.3835, label: 1, bag_size: 747
batch 59, loss: 0.0001, instance_loss: 0.0479, weighted_loss: 0.0144, label: 4, bag_size: 729
batch 79, loss: 1.3218, instance_loss: 0.6544, weighted_loss: 1.1216, label: 1, bag_size: 386
batch 99, loss: 0.0236, instance_loss: 0.4946, weighted_loss: 0.1649, label: 3, bag_size: 360
batch 119, loss: 0.0038, instance_loss: 0.1589, weighted_loss: 0.0503, label: 3, bag_size: 343
batch 139, loss: 0.3283, instance_loss: 0.4662, weighted_loss: 0.3697, label: 2, bag_size: 222
batch 159, loss: 0.0251, instance_loss: 0.1050, weighted_loss: 0.0491, label: 0, bag_size: 518
batch 179, loss: 0.7015, instance_loss: 0.4275, weighted_loss: 0.6193, label: 1, bag_size: 356
batch 199, loss: 0.1216, instance_loss: 0.0855, weighted_loss: 0.1108, label: 3, bag_size: 1019
batch 219, loss: 0.0211, instance_loss: 0.2032, weighted_loss: 0.0758, label: 0, bag_size: 729
batch 239, loss: 0.3903, instance_loss: 0.5224, weighted_loss: 0.4299, label: 1, bag_size: 399
batch 259, loss: 1.2750, instance_loss: 0.6740, weighted_loss: 1.0947, label: 2, bag_size: 803
batch 279, loss: 0.1693, instance_loss: 0.4134, weighted_loss: 0.2426, label: 4, bag_size: 1337
batch 299, loss: 0.0161, instance_loss: 0.5872, weighted_loss: 0.1875, label: 4, bag_size: 663
batch 319, loss: 0.2801, instance_loss: 0.6096, weighted_loss: 0.3790, label: 3, bag_size: 630
batch 339, loss: 0.0725, instance_loss: 0.6081, weighted_loss: 0.2332, label: 3, bag_size: 1380
batch 359, loss: 0.4513, instance_loss: 0.6184, weighted_loss: 0.5014, label: 2, bag_size: 738
batch 379, loss: 0.1497, instance_loss: 0.3207, weighted_loss: 0.2010, label: 2, bag_size: 395
batch 399, loss: 0.0070, instance_loss: 0.1130, weighted_loss: 0.0388, label: 1, bag_size: 937
batch 419, loss: 0.2745, instance_loss: 0.4034, weighted_loss: 0.3131, label: 2, bag_size: 408


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.4526470588235294: correct 1539/3400
Epoch: 31, train_loss: 0.2616, train_clustering_loss:  0.2940, train_error: 0.0800
class 0: acc 0.8933333333333333, correct 67/75
class 1: acc 0.8505747126436781, correct 74/87
class 2: acc 0.8987341772151899, correct 71/79
class 3: acc 0.9761904761904762, correct 82/84
class 4: acc 0.97, correct 97/100

Val Set, val_loss: 1.0974, val_error: 0.3800, auc: 0.8748
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.8571428571428571, correct 6/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.5803, instance_loss: 0.3035, weighted_loss: 0.4973, label: 0, bag_size: 1257
batch 39, loss: 0.7748, instance_loss: 0.5748, weighted_loss: 0.7148, label: 2, bag_size: 356
batch 59, loss: 0.0791, instance_loss: 0.3068, weighted_loss: 0.1474, label: 3, bag_size: 671
batch 79, loss: 0.0002, instance_loss: 0.0305, weighted_loss: 0.0093, label: 4, bag_size: 729
batch 99, loss: 0.2713, instance_loss: 0.4403, weighted_loss: 0.3220, label: 0, bag_size: 1065
batch 119, loss: 0.9879, instance_loss: 0.4554, weighted_loss: 0.8282, label: 1, bag_size: 487
batch 139, loss: 0.0350, instance_loss: 0.1510, weighted_loss: 0.0698, label: 0, bag_size: 729
batch 159, loss: 0.0009, instance_loss: 0.0334, weighted_loss: 0.0106, label: 3, bag_size: 729
batch 179, loss: 0.0055, instance_loss: 0.2266, weighted_loss: 0.0719, label: 3, bag_size: 1253
batch 199, loss: 0.0048, instance_loss: 0.2517, weighted_loss: 0.0788, label: 3, bag_size: 791
batch 219, loss: 0.0145, instance_loss: 0.6910, weighted_loss: 0.2174, label: 3, bag_size: 281
batch 239, loss: 0.3592, instance_loss: 0.2692, weighted_loss: 0.3322, label: 0, bag_size: 294
batch 259, loss: 0.4519, instance_loss: 0.5032, weighted_loss: 0.4673, label: 2, bag_size: 720
batch 279, loss: 0.7950, instance_loss: 0.5973, weighted_loss: 0.7357, label: 2, bag_size: 542
batch 299, loss: 1.3712, instance_loss: 0.6325, weighted_loss: 1.1496, label: 1, bag_size: 657
batch 319, loss: 0.2354, instance_loss: 0.2886, weighted_loss: 0.2514, label: 2, bag_size: 355
batch 339, loss: 0.1042, instance_loss: 0.2410, weighted_loss: 0.1452, label: 2, bag_size: 525
batch 359, loss: 0.0243, instance_loss: 0.0654, weighted_loss: 0.0366, label: 0, bag_size: 933
batch 379, loss: 0.0330, instance_loss: 0.0806, weighted_loss: 0.0473, label: 0, bag_size: 1018
batch 399, loss: 0.0049, instance_loss: 0.1471, weighted_loss: 0.0476, label: 4, bag_size: 1235
batch 419, loss: 0.0754, instance_loss: 0.1676, weighted_loss: 0.1031, label: 1, bag_size: 944


class 0 clustering acc 0.9885882352941177: correct 16806/17000
class 1 clustering acc 0.48470588235294115: correct 1648/3400
Epoch: 32, train_loss: 0.2461, train_clustering_loss:  0.2845, train_error: 0.0800
class 0: acc 0.9782608695652174, correct 90/92
class 1: acc 0.7792207792207793, correct 60/77
class 2: acc 0.863013698630137, correct 63/73
class 3: acc 0.99, correct 99/100
class 4: acc 0.9518072289156626, correct 79/83

Val Set, val_loss: 1.1576, val_error: 0.3600, auc: 0.8598
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0706, instance_loss: 0.6180, weighted_loss: 0.2348, label: 3, bag_size: 630
batch 39, loss: 0.0855, instance_loss: 0.2236, weighted_loss: 0.1269, label: 2, bag_size: 1569
batch 59, loss: 0.1488, instance_loss: 0.3688, weighted_loss: 0.2148, label: 1, bag_size: 846
batch 79, loss: 0.0116, instance_loss: 0.0972, weighted_loss: 0.0373, label: 1, bag_size: 369
batch 99, loss: 0.0095, instance_loss: 0.0452, weighted_loss: 0.0202, label: 4, bag_size: 764
batch 119, loss: 0.0142, instance_loss: 0.1134, weighted_loss: 0.0439, label: 1, bag_size: 1086
batch 139, loss: 0.0832, instance_loss: 0.1608, weighted_loss: 0.1065, label: 0, bag_size: 800
batch 159, loss: 0.0461, instance_loss: 0.1628, weighted_loss: 0.0811, label: 4, bag_size: 1176
batch 179, loss: 0.3591, instance_loss: 0.6971, weighted_loss: 0.4605, label: 1, bag_size: 660
batch 199, loss: 0.5044, instance_loss: 0.2261, weighted_loss: 0.4209, label: 0, bag_size: 413
batch 219, loss: 0.0331, instance_loss: 0.5835, weighted_loss: 0.1982, label: 1, bag_size: 746
batch 239, loss: 0.0044, instance_loss: 0.1870, weighted_loss: 0.0592, label: 3, bag_size: 706
batch 259, loss: 0.0089, instance_loss: 0.0488, weighted_loss: 0.0209, label: 3, bag_size: 1291
batch 279, loss: 0.1270, instance_loss: 0.2202, weighted_loss: 0.1550, label: 2, bag_size: 391
batch 299, loss: 0.0012, instance_loss: 0.0509, weighted_loss: 0.0161, label: 4, bag_size: 729
batch 319, loss: 0.0846, instance_loss: 0.4398, weighted_loss: 0.1911, label: 4, bag_size: 1360
batch 339, loss: 0.0126, instance_loss: 0.0483, weighted_loss: 0.0233, label: 0, bag_size: 729
batch 359, loss: 0.0213, instance_loss: 0.1426, weighted_loss: 0.0577, label: 4, bag_size: 773
batch 379, loss: 0.0342, instance_loss: 0.2077, weighted_loss: 0.0862, label: 2, bag_size: 935
batch 399, loss: 0.1321, instance_loss: 0.7769, weighted_loss: 0.3255, label: 1, bag_size: 1409
batch 419, loss: 0.4192, instance_loss: 0.4021, weighted_loss: 0.4140, label: 2, bag_size: 868


class 0 clustering acc 0.9884705882352941: correct 16804/17000
class 1 clustering acc 0.4702941176470588: correct 1599/3400
Epoch: 33, train_loss: 0.2570, train_clustering_loss:  0.2859, train_error: 0.0753
class 0: acc 0.9659090909090909, correct 85/88
class 1: acc 0.8205128205128205, correct 64/78
class 2: acc 0.8850574712643678, correct 77/87
class 3: acc 0.987012987012987, correct 76/77
class 4: acc 0.9578947368421052, correct 91/95

Val Set, val_loss: 1.1157, val_error: 0.3600, auc: 0.8657
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.295: correct 118/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0115, instance_loss: 0.1759, weighted_loss: 0.0608, label: 3, bag_size: 729
batch 39, loss: 1.6213, instance_loss: 0.5743, weighted_loss: 1.3072, label: 1, bag_size: 487
batch 59, loss: 0.0487, instance_loss: 0.2683, weighted_loss: 0.1146, label: 3, bag_size: 952
batch 79, loss: 0.0479, instance_loss: 0.1106, weighted_loss: 0.0668, label: 0, bag_size: 1190
batch 99, loss: 0.0071, instance_loss: 0.0277, weighted_loss: 0.0133, label: 0, bag_size: 1599
batch 119, loss: 0.2336, instance_loss: 0.2426, weighted_loss: 0.2363, label: 0, bag_size: 756
batch 139, loss: 0.1665, instance_loss: 0.3965, weighted_loss: 0.2355, label: 2, bag_size: 222
batch 159, loss: 0.0514, instance_loss: 0.2774, weighted_loss: 0.1192, label: 2, bag_size: 314
batch 179, loss: 0.0280, instance_loss: 0.0529, weighted_loss: 0.0355, label: 3, bag_size: 729
batch 199, loss: 1.0535, instance_loss: 0.4299, weighted_loss: 0.8664, label: 4, bag_size: 436
batch 219, loss: 0.2048, instance_loss: 0.1914, weighted_loss: 0.2007, label: 0, bag_size: 367
batch 239, loss: 0.1978, instance_loss: 0.2171, weighted_loss: 0.2036, label: 0, bag_size: 350
batch 259, loss: 0.0442, instance_loss: 0.1331, weighted_loss: 0.0708, label: 0, bag_size: 338
batch 279, loss: 0.1051, instance_loss: 0.6971, weighted_loss: 0.2827, label: 3, bag_size: 281
batch 299, loss: 0.0181, instance_loss: 0.3303, weighted_loss: 0.1118, label: 3, bag_size: 706
batch 319, loss: 0.0677, instance_loss: 0.2510, weighted_loss: 0.1227, label: 2, bag_size: 358
batch 339, loss: 0.0126, instance_loss: 0.0675, weighted_loss: 0.0291, label: 0, bag_size: 729
batch 359, loss: 0.1553, instance_loss: 0.2598, weighted_loss: 0.1866, label: 2, bag_size: 1039
batch 379, loss: 0.1526, instance_loss: 0.3014, weighted_loss: 0.1972, label: 2, bag_size: 943
batch 399, loss: 0.1704, instance_loss: 0.1439, weighted_loss: 0.1624, label: 3, bag_size: 729
batch 419, loss: 0.0043, instance_loss: 0.0543, weighted_loss: 0.0193, label: 3, bag_size: 729


class 0 clustering acc 0.9863529411764705: correct 16768/17000
class 1 clustering acc 0.44382352941176473: correct 1509/3400
Epoch: 34, train_loss: 0.3068, train_clustering_loss:  0.3140, train_error: 0.1035
class 0: acc 0.9629629629629629, correct 78/81
class 1: acc 0.7555555555555555, correct 68/90
class 2: acc 0.8571428571428571, correct 78/91
class 3: acc 0.9764705882352941, correct 83/85
class 4: acc 0.9487179487179487, correct 74/78

Val Set, val_loss: 1.1366, val_error: 0.4000, auc: 0.8597
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.26: correct 104/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0171, instance_loss: 0.0403, weighted_loss: 0.0240, label: 3, bag_size: 729
batch 39, loss: 0.0235, instance_loss: 0.0633, weighted_loss: 0.0354, label: 3, bag_size: 729
batch 59, loss: 0.4685, instance_loss: 0.2791, weighted_loss: 0.4117, label: 4, bag_size: 947
batch 79, loss: 0.0217, instance_loss: 0.0589, weighted_loss: 0.0329, label: 3, bag_size: 729
batch 99, loss: 0.0052, instance_loss: 0.0520, weighted_loss: 0.0192, label: 4, bag_size: 1235
batch 119, loss: 0.8685, instance_loss: 0.6970, weighted_loss: 0.8171, label: 1, bag_size: 1390
batch 139, loss: 0.1357, instance_loss: 0.2528, weighted_loss: 0.1708, label: 4, bag_size: 773
batch 159, loss: 0.1829, instance_loss: 0.2964, weighted_loss: 0.2170, label: 2, bag_size: 395
batch 179, loss: 0.3756, instance_loss: 0.6890, weighted_loss: 0.4696, label: 2, bag_size: 1119
batch 199, loss: 0.4057, instance_loss: 0.6690, weighted_loss: 0.4847, label: 2, bag_size: 373
batch 219, loss: 0.0006, instance_loss: 0.0349, weighted_loss: 0.0109, label: 3, bag_size: 729
batch 239, loss: 0.0133, instance_loss: 0.2940, weighted_loss: 0.0975, label: 3, bag_size: 360
batch 259, loss: 0.6642, instance_loss: 0.4443, weighted_loss: 0.5982, label: 2, bag_size: 1133
batch 279, loss: 0.2900, instance_loss: 0.3612, weighted_loss: 0.3114, label: 2, bag_size: 1306
batch 299, loss: 0.0145, instance_loss: 0.0643, weighted_loss: 0.0294, label: 3, bag_size: 729
batch 319, loss: 0.0001, instance_loss: 0.0393, weighted_loss: 0.0119, label: 4, bag_size: 729
batch 339, loss: 0.1344, instance_loss: 0.4261, weighted_loss: 0.2219, label: 2, bag_size: 2826
batch 359, loss: 0.0563, instance_loss: 0.7739, weighted_loss: 0.2716, label: 1, bag_size: 1172
batch 379, loss: 0.1360, instance_loss: 0.1592, weighted_loss: 0.1430, label: 0, bag_size: 1133
batch 399, loss: 0.0927, instance_loss: 0.2918, weighted_loss: 0.1524, label: 2, bag_size: 222
batch 419, loss: 0.0166, instance_loss: 0.1009, weighted_loss: 0.0419, label: 0, bag_size: 921


class 0 clustering acc 0.9878823529411764: correct 16794/17000
class 1 clustering acc 0.45676470588235296: correct 1553/3400
Epoch: 35, train_loss: 0.2574, train_clustering_loss:  0.2933, train_error: 0.0824
class 0: acc 0.9876543209876543, correct 80/81
class 1: acc 0.8170731707317073, correct 67/82
class 2: acc 0.8354430379746836, correct 66/79
class 3: acc 0.9655172413793104, correct 84/87
class 4: acc 0.96875, correct 93/96

Val Set, val_loss: 1.1652, val_error: 0.4200, auc: 0.8464
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.2275: correct 91/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.42857142857142855, correct 3/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.2524, instance_loss: 0.3258, weighted_loss: 0.2744, label: 2, bag_size: 795
batch 39, loss: 0.0118, instance_loss: 0.0720, weighted_loss: 0.0299, label: 0, bag_size: 382
batch 59, loss: 0.0216, instance_loss: 0.1251, weighted_loss: 0.0527, label: 1, bag_size: 1191
batch 79, loss: 0.3110, instance_loss: 0.3073, weighted_loss: 0.3099, label: 4, bag_size: 297
batch 99, loss: 0.6195, instance_loss: 0.5849, weighted_loss: 0.6091, label: 1, bag_size: 861
batch 119, loss: 0.1790, instance_loss: 0.4230, weighted_loss: 0.2522, label: 1, bag_size: 746
batch 139, loss: 0.0622, instance_loss: 0.3334, weighted_loss: 0.1436, label: 2, bag_size: 391
batch 159, loss: 0.0077, instance_loss: 0.0733, weighted_loss: 0.0273, label: 0, bag_size: 1466
batch 179, loss: 0.5316, instance_loss: 0.4057, weighted_loss: 0.4939, label: 2, bag_size: 1164
batch 199, loss: 0.0316, instance_loss: 0.7288, weighted_loss: 0.2408, label: 1, bag_size: 1172
batch 219, loss: 0.0057, instance_loss: 0.0899, weighted_loss: 0.0310, label: 4, bag_size: 790
batch 239, loss: 0.1526, instance_loss: 0.5406, weighted_loss: 0.2690, label: 4, bag_size: 366
batch 259, loss: 0.0026, instance_loss: 0.1188, weighted_loss: 0.0375, label: 1, bag_size: 1127
batch 279, loss: 0.0627, instance_loss: 0.1535, weighted_loss: 0.0900, label: 0, bag_size: 446
batch 299, loss: 0.2219, instance_loss: 0.4346, weighted_loss: 0.2857, label: 1, bag_size: 887
batch 319, loss: 0.0124, instance_loss: 0.1106, weighted_loss: 0.0419, label: 1, bag_size: 1127
batch 339, loss: 0.0291, instance_loss: 0.1567, weighted_loss: 0.0674, label: 1, bag_size: 994
batch 359, loss: 0.0098, instance_loss: 0.1895, weighted_loss: 0.0637, label: 3, bag_size: 952
batch 379, loss: 0.0139, instance_loss: 0.0816, weighted_loss: 0.0342, label: 1, bag_size: 1127
batch 399, loss: 0.0052, instance_loss: 0.0249, weighted_loss: 0.0111, label: 3, bag_size: 729
batch 419, loss: 0.0061, instance_loss: 0.5905, weighted_loss: 0.1814, label: 4, bag_size: 663


class 0 clustering acc 0.9882941176470589: correct 16801/17000
class 1 clustering acc 0.4364705882352941: correct 1484/3400
Epoch: 36, train_loss: 0.2406, train_clustering_loss:  0.3020, train_error: 0.0729
class 0: acc 0.9428571428571428, correct 66/70
class 1: acc 0.8404255319148937, correct 79/94
class 2: acc 0.9080459770114943, correct 79/87
class 3: acc 1.0, correct 89/89
class 4: acc 0.9529411764705882, correct 81/85

Val Set, val_loss: 1.1407, val_error: 0.4000, auc: 0.8560
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.27: correct 108/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0477, instance_loss: 0.5003, weighted_loss: 0.1835, label: 2, bag_size: 803
batch 39, loss: 0.1260, instance_loss: 0.3845, weighted_loss: 0.2035, label: 2, bag_size: 2826
batch 59, loss: 0.1194, instance_loss: 0.3935, weighted_loss: 0.2016, label: 1, bag_size: 1049
batch 79, loss: 0.1108, instance_loss: 0.3601, weighted_loss: 0.1856, label: 1, bag_size: 1049
batch 99, loss: 0.6908, instance_loss: 0.6051, weighted_loss: 0.6651, label: 0, bag_size: 423
batch 119, loss: 0.0228, instance_loss: 0.1887, weighted_loss: 0.0725, label: 0, bag_size: 729
batch 139, loss: 1.2284, instance_loss: 0.4679, weighted_loss: 1.0003, label: 1, bag_size: 1197
batch 159, loss: 0.0578, instance_loss: 0.1788, weighted_loss: 0.0941, label: 3, bag_size: 230
batch 179, loss: 0.0028, instance_loss: 0.0869, weighted_loss: 0.0280, label: 3, bag_size: 729
batch 199, loss: 0.5467, instance_loss: 0.4797, weighted_loss: 0.5266, label: 1, bag_size: 838
batch 219, loss: 0.2431, instance_loss: 0.3044, weighted_loss: 0.2615, label: 2, bag_size: 357
batch 239, loss: 0.0329, instance_loss: 0.0953, weighted_loss: 0.0516, label: 3, bag_size: 556
batch 259, loss: 0.0338, instance_loss: 0.2512, weighted_loss: 0.0990, label: 0, bag_size: 255
batch 279, loss: 0.3673, instance_loss: 0.4174, weighted_loss: 0.3824, label: 2, bag_size: 272
batch 299, loss: 0.2738, instance_loss: 0.2229, weighted_loss: 0.2586, label: 4, bag_size: 826
batch 319, loss: 0.0667, instance_loss: 0.5433, weighted_loss: 0.2097, label: 3, bag_size: 630
batch 339, loss: 0.0708, instance_loss: 0.0932, weighted_loss: 0.0776, label: 0, bag_size: 729
batch 359, loss: 0.0256, instance_loss: 0.4557, weighted_loss: 0.1546, label: 3, bag_size: 1380
batch 379, loss: 0.0758, instance_loss: 0.2045, weighted_loss: 0.1144, label: 0, bag_size: 1135
batch 399, loss: 0.0476, instance_loss: 0.2926, weighted_loss: 0.1211, label: 2, bag_size: 537
batch 419, loss: 0.3164, instance_loss: 0.3740, weighted_loss: 0.3337, label: 1, bag_size: 860


class 0 clustering acc 0.9864117647058823: correct 16769/17000
class 1 clustering acc 0.4076470588235294: correct 1386/3400
Epoch: 37, train_loss: 0.2922, train_clustering_loss:  0.3172, train_error: 0.1035
class 0: acc 0.9240506329113924, correct 73/79
class 1: acc 0.776595744680851, correct 73/94
class 2: acc 0.8787878787878788, correct 87/99
class 3: acc 0.9871794871794872, correct 77/78
class 4: acc 0.9466666666666667, correct 71/75

Val Set, val_loss: 1.0964, val_error: 0.4200, auc: 0.8655
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.4784, instance_loss: 0.3069, weighted_loss: 0.4269, label: 4, bag_size: 1331
batch 39, loss: 0.0106, instance_loss: 0.0989, weighted_loss: 0.0371, label: 4, bag_size: 1176
batch 59, loss: 0.0510, instance_loss: 0.1882, weighted_loss: 0.0921, label: 2, bag_size: 391
batch 79, loss: 0.0087, instance_loss: 0.0664, weighted_loss: 0.0260, label: 3, bag_size: 729
batch 99, loss: 0.0791, instance_loss: 0.1717, weighted_loss: 0.1069, label: 3, bag_size: 1118
batch 119, loss: 0.9778, instance_loss: 0.6179, weighted_loss: 0.8699, label: 2, bag_size: 878
batch 139, loss: 0.0088, instance_loss: 0.0541, weighted_loss: 0.0224, label: 4, bag_size: 1121
batch 159, loss: 0.0063, instance_loss: 0.1077, weighted_loss: 0.0367, label: 3, bag_size: 729
batch 179, loss: 0.4934, instance_loss: 0.4268, weighted_loss: 0.4734, label: 2, bag_size: 878
batch 199, loss: 0.0986, instance_loss: 0.3307, weighted_loss: 0.1682, label: 2, bag_size: 1617
batch 219, loss: 0.2400, instance_loss: 0.2688, weighted_loss: 0.2486, label: 2, bag_size: 682
batch 239, loss: 1.1137, instance_loss: 0.4232, weighted_loss: 0.9065, label: 1, bag_size: 711
batch 259, loss: 0.0088, instance_loss: 0.1118, weighted_loss: 0.0397, label: 1, bag_size: 697
batch 279, loss: 0.0088, instance_loss: 0.2789, weighted_loss: 0.0899, label: 4, bag_size: 729
batch 299, loss: 0.0108, instance_loss: 0.0750, weighted_loss: 0.0301, label: 1, bag_size: 286
batch 319, loss: 0.0323, instance_loss: 0.2558, weighted_loss: 0.0993, label: 2, bag_size: 324
batch 339, loss: 0.0175, instance_loss: 0.0603, weighted_loss: 0.0303, label: 3, bag_size: 1019
batch 359, loss: 0.0973, instance_loss: 0.3447, weighted_loss: 0.1715, label: 1, bag_size: 746
batch 379, loss: 0.2167, instance_loss: 0.3368, weighted_loss: 0.2527, label: 2, bag_size: 1410
batch 399, loss: 0.7011, instance_loss: 0.7505, weighted_loss: 0.7159, label: 0, bag_size: 1065
batch 419, loss: 0.1253, instance_loss: 0.2909, weighted_loss: 0.1750, label: 2, bag_size: 245


class 0 clustering acc 0.9892941176470588: correct 16818/17000
class 1 clustering acc 0.4455882352941177: correct 1515/3400
Epoch: 38, train_loss: 0.2094, train_clustering_loss:  0.2931, train_error: 0.0659
class 0: acc 0.9876543209876543, correct 80/81
class 1: acc 0.8378378378378378, correct 62/74
class 2: acc 0.8829787234042553, correct 83/94
class 3: acc 0.989247311827957, correct 92/93
class 4: acc 0.963855421686747, correct 80/83

Val Set, val_loss: 1.0263, val_error: 0.3800, auc: 0.8773
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0477, instance_loss: 0.4625, weighted_loss: 0.1721, label: 1, bag_size: 1014
batch 39, loss: 0.3126, instance_loss: 0.4807, weighted_loss: 0.3630, label: 1, bag_size: 861
batch 59, loss: 0.4787, instance_loss: 0.4194, weighted_loss: 0.4610, label: 4, bag_size: 1360
batch 79, loss: 0.1221, instance_loss: 0.3665, weighted_loss: 0.1954, label: 1, bag_size: 442
batch 99, loss: 0.3821, instance_loss: 0.5224, weighted_loss: 0.4242, label: 2, bag_size: 1139
batch 119, loss: 0.0159, instance_loss: 0.5055, weighted_loss: 0.1628, label: 4, bag_size: 754
batch 139, loss: 0.0018, instance_loss: 0.1699, weighted_loss: 0.0522, label: 4, bag_size: 524
batch 159, loss: 0.0081, instance_loss: 0.2695, weighted_loss: 0.0865, label: 4, bag_size: 646
batch 179, loss: 0.4372, instance_loss: 0.4414, weighted_loss: 0.4384, label: 1, bag_size: 399
batch 199, loss: 0.0433, instance_loss: 0.3816, weighted_loss: 0.1448, label: 2, bag_size: 1006
batch 219, loss: 0.0033, instance_loss: 0.5124, weighted_loss: 0.1560, label: 4, bag_size: 663
batch 239, loss: 0.0043, instance_loss: 0.0606, weighted_loss: 0.0212, label: 3, bag_size: 729
batch 259, loss: 0.0182, instance_loss: 0.1081, weighted_loss: 0.0452, label: 3, bag_size: 729
batch 279, loss: 0.0213, instance_loss: 0.2377, weighted_loss: 0.0862, label: 0, bag_size: 385
batch 299, loss: 0.0513, instance_loss: 0.2358, weighted_loss: 0.1066, label: 0, bag_size: 736
batch 319, loss: 0.0001, instance_loss: 0.1527, weighted_loss: 0.0459, label: 4, bag_size: 729
batch 339, loss: 0.0005, instance_loss: 0.0639, weighted_loss: 0.0195, label: 4, bag_size: 790
batch 359, loss: 0.3616, instance_loss: 0.5723, weighted_loss: 0.4248, label: 3, bag_size: 671
batch 379, loss: 0.0256, instance_loss: 0.3410, weighted_loss: 0.1203, label: 2, bag_size: 600
batch 399, loss: 0.0538, instance_loss: 0.2835, weighted_loss: 0.1227, label: 2, bag_size: 1047
batch 419, loss: 0.0592, instance_loss: 0.1028, weighted_loss: 0.0723, label: 3, bag_size: 849


class 0 clustering acc 0.9905882352941177: correct 16840/17000
class 1 clustering acc 0.46911764705882353: correct 1595/3400
Epoch: 39, train_loss: 0.2152, train_clustering_loss:  0.2865, train_error: 0.0776
class 0: acc 0.9662921348314607, correct 86/89
class 1: acc 0.8260869565217391, correct 76/92
class 2: acc 0.8260869565217391, correct 57/69
class 3: acc 1.0, correct 86/86
class 4: acc 0.9775280898876404, correct 87/89

Val Set, val_loss: 1.2297, val_error: 0.4600, auc: 0.8600
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0002, instance_loss: 0.1221, weighted_loss: 0.0368, label: 4, bag_size: 388
batch 39, loss: 0.0454, instance_loss: 0.0877, weighted_loss: 0.0581, label: 3, bag_size: 952
batch 59, loss: 0.0125, instance_loss: 0.1598, weighted_loss: 0.0567, label: 0, bag_size: 602
batch 79, loss: 0.0355, instance_loss: 0.2719, weighted_loss: 0.1065, label: 3, bag_size: 841
batch 99, loss: 0.0177, instance_loss: 0.0922, weighted_loss: 0.0401, label: 3, bag_size: 729
batch 119, loss: 0.0058, instance_loss: 0.0677, weighted_loss: 0.0244, label: 0, bag_size: 518
batch 139, loss: 0.0083, instance_loss: 0.0247, weighted_loss: 0.0132, label: 3, bag_size: 729
batch 159, loss: 0.0038, instance_loss: 0.3875, weighted_loss: 0.1189, label: 3, bag_size: 1167
batch 179, loss: 0.0128, instance_loss: 0.6644, weighted_loss: 0.2083, label: 3, bag_size: 281
batch 199, loss: 0.0004, instance_loss: 0.1204, weighted_loss: 0.0364, label: 1, bag_size: 1376
batch 219, loss: 0.0046, instance_loss: 0.1269, weighted_loss: 0.0413, label: 0, bag_size: 239
batch 239, loss: 0.0502, instance_loss: 0.2479, weighted_loss: 0.1095, label: 3, bag_size: 671
batch 259, loss: 0.0001, instance_loss: 0.1407, weighted_loss: 0.0423, label: 4, bag_size: 729
batch 279, loss: 0.0877, instance_loss: 0.2880, weighted_loss: 0.1478, label: 3, bag_size: 1250
batch 299, loss: 0.0060, instance_loss: 0.1849, weighted_loss: 0.0597, label: 3, bag_size: 791
batch 319, loss: 0.0101, instance_loss: 0.2839, weighted_loss: 0.0922, label: 3, bag_size: 1118
batch 339, loss: 0.0143, instance_loss: 0.2306, weighted_loss: 0.0792, label: 2, bag_size: 400
batch 359, loss: 0.0323, instance_loss: 0.4847, weighted_loss: 0.1680, label: 4, bag_size: 366
batch 379, loss: 0.0006, instance_loss: 0.0311, weighted_loss: 0.0097, label: 4, bag_size: 729
batch 399, loss: 0.0078, instance_loss: 0.0262, weighted_loss: 0.0133, label: 0, bag_size: 382
batch 419, loss: 0.0411, instance_loss: 0.1671, weighted_loss: 0.0789, label: 0, bag_size: 545


class 0 clustering acc 0.9882941176470589: correct 16801/17000
class 1 clustering acc 0.4873529411764706: correct 1657/3400
Epoch: 40, train_loss: 0.1988, train_clustering_loss:  0.2753, train_error: 0.0659
class 0: acc 0.9883720930232558, correct 85/86
class 1: acc 0.7974683544303798, correct 63/79
class 2: acc 0.898876404494382, correct 80/89
class 3: acc 0.9891304347826086, correct 91/92
class 4: acc 0.9873417721518988, correct 78/79

Val Set, val_loss: 1.1327, val_error: 0.4400, auc: 0.8740
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.8744, instance_loss: 0.6588, weighted_loss: 0.8097, label: 2, bag_size: 356
batch 39, loss: 0.0571, instance_loss: 0.3058, weighted_loss: 0.1317, label: 3, bag_size: 1118
batch 59, loss: 0.0469, instance_loss: 0.3962, weighted_loss: 0.1517, label: 1, bag_size: 405
batch 79, loss: 0.1373, instance_loss: 0.0829, weighted_loss: 0.1210, label: 0, bag_size: 413
batch 99, loss: 2.1834, instance_loss: 0.5882, weighted_loss: 1.7048, label: 1, bag_size: 1197
batch 119, loss: 0.0074, instance_loss: 0.6379, weighted_loss: 0.1966, label: 4, bag_size: 663
batch 139, loss: 0.0069, instance_loss: 0.0485, weighted_loss: 0.0194, label: 3, bag_size: 729
batch 159, loss: 0.1850, instance_loss: 0.6803, weighted_loss: 0.3336, label: 2, bag_size: 1439
batch 179, loss: 0.0770, instance_loss: 0.3084, weighted_loss: 0.1464, label: 3, bag_size: 533
batch 199, loss: 0.0023, instance_loss: 0.0319, weighted_loss: 0.0112, label: 0, bag_size: 518
batch 219, loss: 0.6447, instance_loss: 0.5340, weighted_loss: 0.6115, label: 2, bag_size: 629
batch 239, loss: 0.0023, instance_loss: 0.0681, weighted_loss: 0.0220, label: 1, bag_size: 937
batch 259, loss: 0.0683, instance_loss: 0.3149, weighted_loss: 0.1423, label: 1, bag_size: 925
batch 279, loss: 0.0020, instance_loss: 0.0813, weighted_loss: 0.0258, label: 1, bag_size: 1086
batch 299, loss: 0.8501, instance_loss: 0.4648, weighted_loss: 0.7345, label: 1, bag_size: 838
batch 319, loss: 0.2701, instance_loss: 0.8225, weighted_loss: 0.4358, label: 0, bag_size: 818
batch 339, loss: 0.0133, instance_loss: 0.0506, weighted_loss: 0.0245, label: 4, bag_size: 1121
batch 359, loss: 0.5027, instance_loss: 0.4652, weighted_loss: 0.4914, label: 4, bag_size: 436
batch 379, loss: 0.2055, instance_loss: 0.4389, weighted_loss: 0.2756, label: 2, bag_size: 748
batch 399, loss: 0.0659, instance_loss: 0.1916, weighted_loss: 0.1036, label: 2, bag_size: 1281
batch 419, loss: 0.0158, instance_loss: 0.1941, weighted_loss: 0.0693, label: 3, bag_size: 952


class 0 clustering acc 0.9861176470588235: correct 16764/17000
class 1 clustering acc 0.4811764705882353: correct 1636/3400
Epoch: 41, train_loss: 0.1841, train_clustering_loss:  0.2849, train_error: 0.0565
class 0: acc 0.9479166666666666, correct 91/96
class 1: acc 0.8795180722891566, correct 73/83
class 2: acc 0.9069767441860465, correct 78/86
class 3: acc 1.0, correct 77/77
class 4: acc 0.9879518072289156, correct 82/83

Val Set, val_loss: 1.2380, val_error: 0.3600, auc: 0.8662
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.3225: correct 129/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0603, instance_loss: 0.1289, weighted_loss: 0.0809, label: 3, bag_size: 451
batch 39, loss: 0.1282, instance_loss: 0.1966, weighted_loss: 0.1488, label: 0, bag_size: 200
batch 59, loss: 0.1072, instance_loss: 0.2153, weighted_loss: 0.1396, label: 3, bag_size: 200
batch 79, loss: 0.0020, instance_loss: 0.4751, weighted_loss: 0.1439, label: 4, bag_size: 974
batch 99, loss: 0.0628, instance_loss: 0.2233, weighted_loss: 0.1110, label: 3, bag_size: 706
batch 119, loss: 0.0049, instance_loss: 0.0440, weighted_loss: 0.0166, label: 0, bag_size: 518
batch 139, loss: 0.6717, instance_loss: 0.3593, weighted_loss: 0.5779, label: 2, bag_size: 636
batch 159, loss: 0.0023, instance_loss: 0.1948, weighted_loss: 0.0600, label: 4, bag_size: 656
batch 179, loss: 0.0179, instance_loss: 0.0592, weighted_loss: 0.0303, label: 3, bag_size: 729
batch 199, loss: 0.6456, instance_loss: 0.3491, weighted_loss: 0.5567, label: 1, bag_size: 533
batch 219, loss: 1.0066, instance_loss: 0.3908, weighted_loss: 0.8219, label: 1, bag_size: 530
batch 239, loss: 0.0594, instance_loss: 0.4218, weighted_loss: 0.1681, label: 3, bag_size: 200
batch 259, loss: 0.0001, instance_loss: 0.0328, weighted_loss: 0.0099, label: 4, bag_size: 729
batch 279, loss: 0.0030, instance_loss: 0.0872, weighted_loss: 0.0283, label: 1, bag_size: 1086
batch 299, loss: 0.0255, instance_loss: 0.0892, weighted_loss: 0.0446, label: 3, bag_size: 451
batch 319, loss: 0.0218, instance_loss: 0.1460, weighted_loss: 0.0590, label: 4, bag_size: 773
batch 339, loss: 0.0152, instance_loss: 0.4111, weighted_loss: 0.1339, label: 3, bag_size: 360
batch 359, loss: 1.5657, instance_loss: 0.5695, weighted_loss: 1.2668, label: 1, bag_size: 770
batch 379, loss: 0.0553, instance_loss: 0.3629, weighted_loss: 0.1476, label: 4, bag_size: 436
batch 399, loss: 0.8006, instance_loss: 0.4848, weighted_loss: 0.7058, label: 1, bag_size: 1376
batch 419, loss: 0.0000, instance_loss: 0.0317, weighted_loss: 0.0095, label: 4, bag_size: 729


class 0 clustering acc 0.9858235294117647: correct 16759/17000
class 1 clustering acc 0.45441176470588235: correct 1545/3400
Epoch: 42, train_loss: 0.2278, train_clustering_loss:  0.2995, train_error: 0.0824
class 0: acc 0.9615384615384616, correct 75/78
class 1: acc 0.8, correct 68/85
class 2: acc 0.8585858585858586, correct 85/99
class 3: acc 1.0, correct 80/80
class 4: acc 0.9879518072289156, correct 82/83

Val Set, val_loss: 1.4512, val_error: 0.4200, auc: 0.8535
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 0.5, correct 6/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.42857142857142855, correct 3/7
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.1615, instance_loss: 0.1536, weighted_loss: 0.1591, label: 3, bag_size: 729
batch 39, loss: 0.1542, instance_loss: 0.4172, weighted_loss: 0.2331, label: 1, bag_size: 746
batch 59, loss: 0.0000, instance_loss: 0.0403, weighted_loss: 0.0121, label: 4, bag_size: 729
batch 79, loss: 0.0006, instance_loss: 0.1071, weighted_loss: 0.0326, label: 4, bag_size: 388
batch 99, loss: 0.3597, instance_loss: 0.4816, weighted_loss: 0.3963, label: 0, bag_size: 868
batch 119, loss: 0.0180, instance_loss: 0.1608, weighted_loss: 0.0608, label: 0, bag_size: 1599
batch 139, loss: 0.6366, instance_loss: 0.3142, weighted_loss: 0.5399, label: 2, bag_size: 676
batch 159, loss: 0.0124, instance_loss: 0.3075, weighted_loss: 0.1009, label: 2, bag_size: 324
batch 179, loss: 0.0081, instance_loss: 0.1822, weighted_loss: 0.0604, label: 4, bag_size: 1357
batch 199, loss: 0.0965, instance_loss: 0.1706, weighted_loss: 0.1187, label: 0, bag_size: 630
batch 219, loss: 0.0216, instance_loss: 0.2763, weighted_loss: 0.0980, label: 4, bag_size: 754
batch 239, loss: 0.0991, instance_loss: 0.2470, weighted_loss: 0.1435, label: 1, bag_size: 346
batch 259, loss: 0.0070, instance_loss: 0.1342, weighted_loss: 0.0452, label: 1, bag_size: 1261
batch 279, loss: 0.0365, instance_loss: 0.1454, weighted_loss: 0.0692, label: 0, bag_size: 1133
batch 299, loss: 0.0278, instance_loss: 0.1532, weighted_loss: 0.0654, label: 2, bag_size: 455
batch 319, loss: 0.1077, instance_loss: 0.6854, weighted_loss: 0.2810, label: 1, bag_size: 1390
batch 339, loss: 0.0004, instance_loss: 0.1366, weighted_loss: 0.0412, label: 4, bag_size: 388
batch 359, loss: 0.0966, instance_loss: 0.2334, weighted_loss: 0.1376, label: 2, bag_size: 399
batch 379, loss: 0.2836, instance_loss: 0.6267, weighted_loss: 0.3865, label: 1, bag_size: 293
batch 399, loss: 0.0020, instance_loss: 0.0272, weighted_loss: 0.0096, label: 3, bag_size: 729
batch 419, loss: 0.0090, instance_loss: 0.0431, weighted_loss: 0.0192, label: 3, bag_size: 729


class 0 clustering acc 0.9878823529411764: correct 16794/17000
class 1 clustering acc 0.4858823529411765: correct 1652/3400
Epoch: 43, train_loss: 0.1553, train_clustering_loss:  0.2804, train_error: 0.0400
class 0: acc 0.9880952380952381, correct 83/84
class 1: acc 0.8641975308641975, correct 70/81
class 2: acc 0.9534883720930233, correct 82/86
class 3: acc 1.0, correct 96/96
class 4: acc 0.9871794871794872, correct 77/78

Val Set, val_loss: 1.2898, val_error: 0.4200, auc: 0.8567
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 22 out of 20


batch 19, loss: 2.5318, instance_loss: 0.7731, weighted_loss: 2.0042, label: 4, bag_size: 210
batch 39, loss: 0.0024, instance_loss: 0.0517, weighted_loss: 0.0172, label: 1, bag_size: 937
batch 59, loss: 0.0000, instance_loss: 0.0525, weighted_loss: 0.0158, label: 4, bag_size: 729
batch 79, loss: 0.3664, instance_loss: 0.4295, weighted_loss: 0.3853, label: 2, bag_size: 259
batch 99, loss: 0.1129, instance_loss: 0.2023, weighted_loss: 0.1397, label: 2, bag_size: 419
batch 119, loss: 0.0383, instance_loss: 0.3691, weighted_loss: 0.1375, label: 2, bag_size: 2826
batch 139, loss: 0.0577, instance_loss: 0.2215, weighted_loss: 0.1068, label: 4, bag_size: 354
batch 159, loss: 0.1164, instance_loss: 0.4764, weighted_loss: 0.2244, label: 4, bag_size: 1331
batch 179, loss: 0.4696, instance_loss: 0.3668, weighted_loss: 0.4388, label: 4, bag_size: 436
batch 199, loss: 0.0046, instance_loss: 0.0474, weighted_loss: 0.0175, label: 0, bag_size: 1143
batch 219, loss: 0.0471, instance_loss: 0.1686, weighted_loss: 0.0835, label: 0, bag_size: 367
batch 239, loss: 0.0163, instance_loss: 0.4434, weighted_loss: 0.1445, label: 1, bag_size: 1014
batch 259, loss: 0.0077, instance_loss: 0.4833, weighted_loss: 0.1504, label: 3, bag_size: 360
batch 279, loss: 0.0001, instance_loss: 0.0508, weighted_loss: 0.0154, label: 4, bag_size: 729
batch 299, loss: 0.0000, instance_loss: 0.0343, weighted_loss: 0.0103, label: 4, bag_size: 729
batch 319, loss: 0.5637, instance_loss: 0.3978, weighted_loss: 0.5139, label: 1, bag_size: 1144
batch 339, loss: 0.0463, instance_loss: 0.0946, weighted_loss: 0.0608, label: 1, bag_size: 886
batch 359, loss: 0.0027, instance_loss: 0.0178, weighted_loss: 0.0072, label: 0, bag_size: 1599
batch 379, loss: 0.1996, instance_loss: 0.4233, weighted_loss: 0.2667, label: 1, bag_size: 1096
batch 399, loss: 0.0263, instance_loss: 0.0767, weighted_loss: 0.0414, label: 3, bag_size: 729
batch 419, loss: 0.0328, instance_loss: 0.3651, weighted_loss: 0.1325, label: 4, bag_size: 656


class 0 clustering acc 0.9890588235294118: correct 16814/17000
class 1 clustering acc 0.47705882352941176: correct 1622/3400
Epoch: 44, train_loss: 0.1955, train_clustering_loss:  0.2813, train_error: 0.0706
class 0: acc 0.9791666666666666, correct 94/96
class 1: acc 0.8514851485148515, correct 86/101
class 2: acc 0.891566265060241, correct 74/83
class 3: acc 1.0, correct 76/76
class 4: acc 0.9420289855072463, correct 65/69

Val Set, val_loss: 1.1697, val_error: 0.4200, auc: 0.8694
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.7142857142857143, correct 5/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0000, instance_loss: 0.2172, weighted_loss: 0.0652, label: 4, bag_size: 729
batch 39, loss: 0.1138, instance_loss: 0.3675, weighted_loss: 0.1899, label: 2, bag_size: 222
batch 59, loss: 0.4135, instance_loss: 0.4184, weighted_loss: 0.4150, label: 2, bag_size: 828
batch 79, loss: 0.0087, instance_loss: 0.0503, weighted_loss: 0.0212, label: 0, bag_size: 402
batch 99, loss: 0.0292, instance_loss: 0.5818, weighted_loss: 0.1949, label: 3, bag_size: 630
batch 119, loss: 0.2031, instance_loss: 0.3722, weighted_loss: 0.2538, label: 2, bag_size: 748
batch 139, loss: 0.0033, instance_loss: 0.0387, weighted_loss: 0.0139, label: 0, bag_size: 382
batch 159, loss: 0.0217, instance_loss: 0.4014, weighted_loss: 0.1356, label: 3, bag_size: 841
batch 179, loss: 0.0381, instance_loss: 0.1882, weighted_loss: 0.0832, label: 3, bag_size: 729
batch 199, loss: 0.0720, instance_loss: 0.3491, weighted_loss: 0.1551, label: 2, bag_size: 324
batch 219, loss: 0.0025, instance_loss: 0.0312, weighted_loss: 0.0111, label: 0, bag_size: 933
batch 239, loss: 0.0153, instance_loss: 0.0530, weighted_loss: 0.0266, label: 0, bag_size: 1235
batch 259, loss: 0.0315, instance_loss: 0.1936, weighted_loss: 0.0801, label: 1, bag_size: 346
batch 279, loss: 0.2523, instance_loss: 0.3896, weighted_loss: 0.2935, label: 2, bag_size: 748
batch 299, loss: 0.0076, instance_loss: 0.0495, weighted_loss: 0.0202, label: 0, bag_size: 446
batch 319, loss: 0.0084, instance_loss: 0.1817, weighted_loss: 0.0604, label: 3, bag_size: 1118
batch 339, loss: 0.0473, instance_loss: 0.1604, weighted_loss: 0.0812, label: 1, bag_size: 369
batch 359, loss: 0.0326, instance_loss: 0.1944, weighted_loss: 0.0812, label: 2, bag_size: 1569
batch 379, loss: 0.0455, instance_loss: 0.5029, weighted_loss: 0.1828, label: 1, bag_size: 1014
batch 399, loss: 0.0511, instance_loss: 0.5833, weighted_loss: 0.2108, label: 3, bag_size: 630
batch 419, loss: 0.0991, instance_loss: 0.2591, weighted_loss: 0.1471, label: 2, bag_size: 636


class 0 clustering acc 0.9898235294117647: correct 16827/17000
class 1 clustering acc 0.48764705882352943: correct 1658/3400
Epoch: 45, train_loss: 0.1051, train_clustering_loss:  0.2744, train_error: 0.0212
class 0: acc 0.9770114942528736, correct 85/87
class 1: acc 0.9767441860465116, correct 84/86
class 2: acc 0.9651162790697675, correct 83/86
class 3: acc 1.0, correct 93/93
class 4: acc 0.9726027397260274, correct 71/73

Val Set, val_loss: 1.2562, val_error: 0.4000, auc: 0.8730
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.3575: correct 143/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0329, instance_loss: 0.3797, weighted_loss: 0.1370, label: 2, bag_size: 358
batch 39, loss: 0.0219, instance_loss: 0.2453, weighted_loss: 0.0890, label: 2, bag_size: 795
batch 59, loss: 0.0120, instance_loss: 0.4922, weighted_loss: 0.1561, label: 1, bag_size: 1390
batch 79, loss: 0.0302, instance_loss: 0.8637, weighted_loss: 0.2803, label: 3, bag_size: 281
batch 99, loss: 0.1215, instance_loss: 0.3691, weighted_loss: 0.1958, label: 2, bag_size: 1378
batch 119, loss: 0.0095, instance_loss: 0.1384, weighted_loss: 0.0482, label: 3, bag_size: 729
batch 139, loss: 0.1954, instance_loss: 0.4163, weighted_loss: 0.2617, label: 4, bag_size: 436
batch 159, loss: 0.0023, instance_loss: 0.0761, weighted_loss: 0.0245, label: 3, bag_size: 729
batch 179, loss: 0.0037, instance_loss: 0.6349, weighted_loss: 0.1930, label: 3, bag_size: 1167
batch 199, loss: 0.0034, instance_loss: 0.0613, weighted_loss: 0.0208, label: 3, bag_size: 729
batch 219, loss: 0.0597, instance_loss: 0.5685, weighted_loss: 0.2123, label: 3, bag_size: 630
batch 239, loss: 0.0221, instance_loss: 0.1248, weighted_loss: 0.0529, label: 3, bag_size: 1291
batch 259, loss: 0.0917, instance_loss: 0.2687, weighted_loss: 0.1448, label: 1, bag_size: 944
batch 279, loss: 0.0370, instance_loss: 0.2078, weighted_loss: 0.0882, label: 0, bag_size: 350
batch 299, loss: 0.0032, instance_loss: 0.3189, weighted_loss: 0.0980, label: 2, bag_size: 421
batch 319, loss: 0.0424, instance_loss: 0.3831, weighted_loss: 0.1446, label: 2, bag_size: 1410
batch 339, loss: 0.0321, instance_loss: 0.1138, weighted_loss: 0.0566, label: 1, bag_size: 1325
batch 359, loss: 1.1569, instance_loss: 0.5945, weighted_loss: 0.9882, label: 1, bag_size: 770
batch 379, loss: 0.0152, instance_loss: 0.1077, weighted_loss: 0.0429, label: 0, bag_size: 350
batch 399, loss: 0.0926, instance_loss: 0.4614, weighted_loss: 0.2032, label: 2, bag_size: 1133
batch 419, loss: 0.0775, instance_loss: 0.3416, weighted_loss: 0.1567, label: 2, bag_size: 1306


class 0 clustering acc 0.9863529411764705: correct 16768/17000
class 1 clustering acc 0.49176470588235294: correct 1672/3400
Epoch: 46, train_loss: 0.1499, train_clustering_loss:  0.2848, train_error: 0.0400
class 0: acc 0.9846153846153847, correct 64/65
class 1: acc 0.9072164948453608, correct 88/97
class 2: acc 0.9146341463414634, correct 75/82
class 3: acc 1.0, correct 97/97
class 4: acc 1.0, correct 84/84

Val Set, val_loss: 1.2825, val_error: 0.4400, auc: 0.8675
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.29: correct 116/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0374, weighted_loss: 0.0113, label: 4, bag_size: 729
batch 39, loss: 0.1115, instance_loss: 0.2609, weighted_loss: 0.1563, label: 2, bag_size: 1164
batch 59, loss: 0.0029, instance_loss: 0.2367, weighted_loss: 0.0730, label: 4, bag_size: 947
batch 79, loss: 2.2103, instance_loss: 0.7973, weighted_loss: 1.7864, label: 1, bag_size: 778
batch 99, loss: 0.6669, instance_loss: 0.5166, weighted_loss: 0.6218, label: 4, bag_size: 1360
batch 119, loss: 0.0043, instance_loss: 0.0714, weighted_loss: 0.0244, label: 3, bag_size: 729
batch 139, loss: 0.0003, instance_loss: 0.2283, weighted_loss: 0.0687, label: 3, bag_size: 791
batch 159, loss: 0.4567, instance_loss: 0.6540, weighted_loss: 0.5159, label: 4, bag_size: 210
batch 179, loss: 0.0039, instance_loss: 0.4922, weighted_loss: 0.1504, label: 4, bag_size: 663
batch 199, loss: 0.0691, instance_loss: 0.3182, weighted_loss: 0.1439, label: 2, bag_size: 237
batch 219, loss: 0.0220, instance_loss: 0.0428, weighted_loss: 0.0282, label: 3, bag_size: 729
batch 239, loss: 0.0020, instance_loss: 0.0512, weighted_loss: 0.0168, label: 1, bag_size: 286
batch 259, loss: 0.1751, instance_loss: 0.5782, weighted_loss: 0.2960, label: 4, bag_size: 823
batch 279, loss: 0.0120, instance_loss: 0.1953, weighted_loss: 0.0670, label: 2, bag_size: 848
batch 299, loss: 0.0045, instance_loss: 0.1214, weighted_loss: 0.0396, label: 0, bag_size: 1599
batch 319, loss: 0.0309, instance_loss: 0.1850, weighted_loss: 0.0771, label: 1, bag_size: 1325
batch 339, loss: 0.0141, instance_loss: 0.1066, weighted_loss: 0.0419, label: 3, bag_size: 1019
batch 359, loss: 0.0009, instance_loss: 0.0521, weighted_loss: 0.0163, label: 4, bag_size: 764
batch 379, loss: 0.0041, instance_loss: 0.0378, weighted_loss: 0.0142, label: 0, bag_size: 402
batch 399, loss: 2.2807, instance_loss: 0.4487, weighted_loss: 1.7311, label: 2, bag_size: 265
batch 419, loss: 0.0045, instance_loss: 0.0588, weighted_loss: 0.0208, label: 0, bag_size: 729


class 0 clustering acc 0.9866470588235294: correct 16773/17000
class 1 clustering acc 0.49529411764705883: correct 1684/3400
Epoch: 47, train_loss: 0.2080, train_clustering_loss:  0.2864, train_error: 0.0706
class 0: acc 0.9518072289156626, correct 79/83
class 1: acc 0.8433734939759037, correct 70/83
class 2: acc 0.9111111111111111, correct 82/90
class 3: acc 1.0, correct 85/85
class 4: acc 0.9404761904761905, correct 79/84

Val Set, val_loss: 1.2266, val_error: 0.4400, auc: 0.8646
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.5302, instance_loss: 0.5242, weighted_loss: 0.5284, label: 2, bag_size: 738
batch 39, loss: 0.4628, instance_loss: 0.5532, weighted_loss: 0.4899, label: 1, bag_size: 1144
batch 59, loss: 0.0838, instance_loss: 0.3105, weighted_loss: 0.1518, label: 0, bag_size: 868
batch 79, loss: 0.0089, instance_loss: 0.0667, weighted_loss: 0.0262, label: 3, bag_size: 729
batch 99, loss: 0.0026, instance_loss: 0.3240, weighted_loss: 0.0990, label: 4, bag_size: 533
batch 119, loss: 0.0076, instance_loss: 0.0662, weighted_loss: 0.0252, label: 0, bag_size: 729
batch 139, loss: 0.0000, instance_loss: 0.0167, weighted_loss: 0.0050, label: 4, bag_size: 729
batch 159, loss: 0.0402, instance_loss: 0.4930, weighted_loss: 0.1760, label: 3, bag_size: 630
batch 179, loss: 0.0028, instance_loss: 0.0280, weighted_loss: 0.0103, label: 3, bag_size: 729
batch 199, loss: 0.0021, instance_loss: 0.4169, weighted_loss: 0.1266, label: 3, bag_size: 317
batch 219, loss: 0.1267, instance_loss: 0.2982, weighted_loss: 0.1781, label: 0, bag_size: 552
batch 239, loss: 0.0055, instance_loss: 0.1332, weighted_loss: 0.0438, label: 4, bag_size: 524
batch 259, loss: 5.4894, instance_loss: 1.8105, weighted_loss: 4.3857, label: 2, bag_size: 1108
batch 279, loss: 0.0503, instance_loss: 0.6453, weighted_loss: 0.2288, label: 3, bag_size: 281
batch 299, loss: 0.3650, instance_loss: 0.6808, weighted_loss: 0.4597, label: 4, bag_size: 210
batch 319, loss: 0.0042, instance_loss: 0.1527, weighted_loss: 0.0487, label: 4, bag_size: 823
batch 339, loss: 0.0326, instance_loss: 0.2333, weighted_loss: 0.0929, label: 2, bag_size: 795
batch 359, loss: 0.0244, instance_loss: 0.3542, weighted_loss: 0.1233, label: 3, bag_size: 1250
batch 379, loss: 0.0670, instance_loss: 0.1538, weighted_loss: 0.0930, label: 0, bag_size: 340
batch 399, loss: 0.0015, instance_loss: 0.0220, weighted_loss: 0.0077, label: 0, bag_size: 1466
batch 419, loss: 0.0016, instance_loss: 0.1239, weighted_loss: 0.0383, label: 4, bag_size: 1357


class 0 clustering acc 0.9885294117647059: correct 16805/17000
class 1 clustering acc 0.4761764705882353: correct 1619/3400
Epoch: 48, train_loss: 0.1852, train_clustering_loss:  0.2889, train_error: 0.0612
class 0: acc 0.9615384615384616, correct 75/78
class 1: acc 0.8666666666666667, correct 78/90
class 2: acc 0.8823529411764706, correct 75/85
class 3: acc 1.0, correct 87/87
class 4: acc 0.9882352941176471, correct 84/85

Val Set, val_loss: 1.4653, val_error: 0.4600, auc: 0.8419
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.2775: correct 111/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0035, instance_loss: 0.1362, weighted_loss: 0.0433, label: 3, bag_size: 230
batch 39, loss: 0.2701, instance_loss: 0.3616, weighted_loss: 0.2975, label: 2, bag_size: 237
batch 59, loss: 0.0650, instance_loss: 0.5431, weighted_loss: 0.2084, label: 3, bag_size: 1380
batch 79, loss: 0.2266, instance_loss: 0.5122, weighted_loss: 0.3123, label: 1, bag_size: 1724
batch 99, loss: 0.0012, instance_loss: 0.0196, weighted_loss: 0.0067, label: 0, bag_size: 360
batch 119, loss: 0.0037, instance_loss: 0.0403, weighted_loss: 0.0147, label: 3, bag_size: 729
batch 139, loss: 0.6412, instance_loss: 0.4478, weighted_loss: 0.5832, label: 0, bag_size: 1257
batch 159, loss: 0.0076, instance_loss: 0.1453, weighted_loss: 0.0489, label: 1, bag_size: 690
batch 179, loss: 0.6157, instance_loss: 0.7002, weighted_loss: 0.6410, label: 2, bag_size: 738
batch 199, loss: 0.0327, instance_loss: 0.5037, weighted_loss: 0.1740, label: 1, bag_size: 474
batch 219, loss: 0.1717, instance_loss: 0.3182, weighted_loss: 0.2156, label: 1, bag_size: 614
batch 239, loss: 0.0125, instance_loss: 0.0396, weighted_loss: 0.0206, label: 4, bag_size: 764
batch 259, loss: 0.0053, instance_loss: 0.0688, weighted_loss: 0.0244, label: 4, bag_size: 636
batch 279, loss: 0.0832, instance_loss: 0.5401, weighted_loss: 0.2203, label: 1, bag_size: 778
batch 299, loss: 0.0119, instance_loss: 0.2901, weighted_loss: 0.0954, label: 3, bag_size: 1250
batch 319, loss: 0.0160, instance_loss: 0.1820, weighted_loss: 0.0658, label: 3, bag_size: 1118
batch 339, loss: 0.0007, instance_loss: 0.3733, weighted_loss: 0.1125, label: 4, bag_size: 663
batch 359, loss: 0.3105, instance_loss: 0.2708, weighted_loss: 0.2986, label: 0, bag_size: 912
batch 379, loss: 0.0282, instance_loss: 0.2290, weighted_loss: 0.0884, label: 3, bag_size: 841
batch 399, loss: 0.0254, instance_loss: 0.1541, weighted_loss: 0.0640, label: 1, bag_size: 1127
batch 419, loss: 0.0231, instance_loss: 0.1496, weighted_loss: 0.0611, label: 0, bag_size: 1135


class 0 clustering acc 0.9877058823529412: correct 16791/17000
class 1 clustering acc 0.47911764705882354: correct 1629/3400
Epoch: 49, train_loss: 0.1381, train_clustering_loss:  0.2870, train_error: 0.0424
class 0: acc 0.9746835443037974, correct 77/79
class 1: acc 0.8829787234042553, correct 83/94
class 2: acc 0.9397590361445783, correct 78/83
class 3: acc 1.0, correct 79/79
class 4: acc 1.0, correct 90/90

Val Set, val_loss: 1.3790, val_error: 0.4000, auc: 0.8622
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.3025: correct 121/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.1279, instance_loss: 0.3712, weighted_loss: 0.2009, label: 2, bag_size: 3236
batch 39, loss: 0.0067, instance_loss: 0.1151, weighted_loss: 0.0393, label: 0, bag_size: 1012
batch 59, loss: 0.0664, instance_loss: 0.2625, weighted_loss: 0.1252, label: 2, bag_size: 848
batch 79, loss: 0.2151, instance_loss: 0.4866, weighted_loss: 0.2966, label: 2, bag_size: 1119
batch 99, loss: 0.1930, instance_loss: 0.3954, weighted_loss: 0.2538, label: 1, bag_size: 1646
batch 119, loss: 0.1099, instance_loss: 0.0544, weighted_loss: 0.0932, label: 3, bag_size: 556
batch 139, loss: 0.0056, instance_loss: 0.0806, weighted_loss: 0.0281, label: 3, bag_size: 1291
batch 159, loss: 0.1225, instance_loss: 0.4288, weighted_loss: 0.2144, label: 2, bag_size: 750
batch 179, loss: 0.0181, instance_loss: 0.0528, weighted_loss: 0.0285, label: 3, bag_size: 729
batch 199, loss: 0.0200, instance_loss: 0.2414, weighted_loss: 0.0864, label: 1, bag_size: 534
batch 219, loss: 0.0375, instance_loss: 0.1203, weighted_loss: 0.0623, label: 0, bag_size: 350
batch 239, loss: 0.3866, instance_loss: 0.3441, weighted_loss: 0.3739, label: 2, bag_size: 911
batch 259, loss: 0.0730, instance_loss: 0.0756, weighted_loss: 0.0737, label: 3, bag_size: 556
batch 279, loss: 1.0680, instance_loss: 0.5035, weighted_loss: 0.8986, label: 2, bag_size: 682
batch 299, loss: 0.0525, instance_loss: 0.1282, weighted_loss: 0.0752, label: 4, bag_size: 1121
batch 319, loss: 0.0021, instance_loss: 0.4507, weighted_loss: 0.1367, label: 3, bag_size: 360
batch 339, loss: 0.1357, instance_loss: 0.2968, weighted_loss: 0.1841, label: 2, bag_size: 1281
batch 359, loss: 0.0588, instance_loss: 0.0960, weighted_loss: 0.0700, label: 3, bag_size: 729
batch 379, loss: 0.0020, instance_loss: 0.0306, weighted_loss: 0.0106, label: 0, bag_size: 731
batch 399, loss: 0.1030, instance_loss: 0.6127, weighted_loss: 0.2559, label: 1, bag_size: 778
batch 419, loss: 0.0063, instance_loss: 0.4228, weighted_loss: 0.1313, label: 3, bag_size: 360


class 0 clustering acc 0.988764705882353: correct 16809/17000
class 1 clustering acc 0.49823529411764705: correct 1694/3400
Epoch: 50, train_loss: 0.1357, train_clustering_loss:  0.2799, train_error: 0.0494
class 0: acc 0.9770114942528736, correct 85/87
class 1: acc 0.8292682926829268, correct 68/82
class 2: acc 0.9523809523809523, correct 80/84
class 3: acc 1.0, correct 97/97
class 4: acc 0.9866666666666667, correct 74/75

Val Set, val_loss: 1.3335, val_error: 0.4200, auc: 0.8615
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.31: correct 124/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0404, instance_loss: 0.2263, weighted_loss: 0.0961, label: 4, bag_size: 826
batch 39, loss: 0.0029, instance_loss: 0.0366, weighted_loss: 0.0130, label: 0, bag_size: 729
batch 59, loss: 0.0482, instance_loss: 0.7912, weighted_loss: 0.2711, label: 2, bag_size: 679
batch 79, loss: 0.0141, instance_loss: 0.4338, weighted_loss: 0.1400, label: 2, bag_size: 384
batch 99, loss: 0.0013, instance_loss: 0.0269, weighted_loss: 0.0090, label: 0, bag_size: 729
batch 119, loss: 0.0142, instance_loss: 0.1222, weighted_loss: 0.0466, label: 1, bag_size: 288
batch 139, loss: 0.0767, instance_loss: 0.1933, weighted_loss: 0.1117, label: 3, bag_size: 1019
batch 159, loss: 0.0004, instance_loss: 0.0939, weighted_loss: 0.0285, label: 4, bag_size: 388
batch 179, loss: 0.0353, instance_loss: 0.1598, weighted_loss: 0.0727, label: 0, bag_size: 552
batch 199, loss: 0.0977, instance_loss: 0.3983, weighted_loss: 0.1879, label: 1, bag_size: 470
batch 219, loss: 0.0027, instance_loss: 0.0609, weighted_loss: 0.0202, label: 3, bag_size: 729
batch 239, loss: 0.0083, instance_loss: 0.0433, weighted_loss: 0.0188, label: 0, bag_size: 630
batch 259, loss: 0.0898, instance_loss: 0.5938, weighted_loss: 0.2410, label: 1, bag_size: 474
batch 279, loss: 0.8545, instance_loss: 0.4531, weighted_loss: 0.7341, label: 1, bag_size: 1014
batch 299, loss: 0.2048, instance_loss: 0.6550, weighted_loss: 0.3398, label: 1, bag_size: 1390
batch 319, loss: 0.0112, instance_loss: 0.0755, weighted_loss: 0.0304, label: 3, bag_size: 729
batch 339, loss: 0.0740, instance_loss: 0.0676, weighted_loss: 0.0721, label: 3, bag_size: 729
batch 359, loss: 2.2350, instance_loss: 0.7726, weighted_loss: 1.7963, label: 1, bag_size: 386
batch 379, loss: 0.3225, instance_loss: 0.2720, weighted_loss: 0.3074, label: 2, bag_size: 907
batch 399, loss: 0.0034, instance_loss: 0.1235, weighted_loss: 0.0394, label: 1, bag_size: 288
batch 419, loss: 0.0002, instance_loss: 0.3138, weighted_loss: 0.0943, label: 4, bag_size: 1357


class 0 clustering acc 0.986: correct 16762/17000
class 1 clustering acc 0.4788235294117647: correct 1628/3400
Epoch: 51, train_loss: 0.1648, train_clustering_loss:  0.2937, train_error: 0.0612
class 0: acc 0.9789473684210527, correct 93/95
class 1: acc 0.8409090909090909, correct 74/88
class 2: acc 0.9090909090909091, correct 80/88
class 3: acc 1.0, correct 79/79
class 4: acc 0.9733333333333334, correct 73/75

Val Set, val_loss: 1.2622, val_error: 0.4800, auc: 0.8632
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.305: correct 122/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.5714285714285714, correct 4/7
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 30 out of 20
Early stopping
Val error: 0.3600, ROC AUC: 0.8839
Test error: 0.3200, ROC AUC: 0.8596
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7, correct 7/10
class 2: acc 0.5294117647058824, correct 9/17
class 3: acc 0.75, correct 3/4
class 4: acc 0.6, correct 3/5

Training Fold 6!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.5460, instance_loss: 1.1797, weighted_loss: 1.4361, label: 3, bag_size: 706
batch 39, loss: 1.3175, instance_loss: 0.9948, weighted_loss: 1.2207, label: 3, bag_size: 729
batch 59, loss: 1.2358, instance_loss: 0.8063, weighted_loss: 1.1070, label: 3, bag_size: 729
batch 79, loss: 1.1948, instance_loss: 0.6216, weighted_loss: 1.0228, label: 3, bag_size: 281
batch 99, loss: 1.8325, instance_loss: 0.6741, weighted_loss: 1.4850, label: 2, bag_size: 614
batch 119, loss: 1.4148, instance_loss: 0.5987, weighted_loss: 1.1699, label: 3, bag_size: 729
batch 139, loss: 1.5899, instance_loss: 0.5469, weighted_loss: 1.2770, label: 0, bag_size: 245
batch 159, loss: 1.6428, instance_loss: 0.5472, weighted_loss: 1.3141, label: 0, bag_size: 729
batch 179, loss: 1.6012, instance_loss: 0.5032, weighted_loss: 1.2718, label: 1, bag_size: 242
batch 199, loss: 1.7003, instance_loss: 0.5293, weighted_loss: 1.3490, label: 2, bag_size: 2703
batch 219, loss: 1.3320, instance_loss: 0.4825, weighted_loss: 1.0771, label: 4, bag_size: 366
batch 239, loss: 1.5127, instance_loss: 0.5047, weighted_loss: 1.2103, label: 3, bag_size: 841
batch 259, loss: 1.9299, instance_loss: 0.5445, weighted_loss: 1.5143, label: 2, bag_size: 1259
batch 279, loss: 1.3375, instance_loss: 0.5022, weighted_loss: 1.0869, label: 0, bag_size: 729
batch 299, loss: 1.4541, instance_loss: 0.4990, weighted_loss: 1.1676, label: 1, bag_size: 1191
batch 319, loss: 1.5058, instance_loss: 0.4928, weighted_loss: 1.2019, label: 3, bag_size: 281
batch 339, loss: 1.7271, instance_loss: 0.5319, weighted_loss: 1.3685, label: 2, bag_size: 314
batch 359, loss: 1.7320, instance_loss: 0.5279, weighted_loss: 1.3708, label: 2, bag_size: 312
batch 379, loss: 1.9288, instance_loss: 0.5452, weighted_loss: 1.5137, label: 0, bag_size: 933
batch 399, loss: 1.4463, instance_loss: 0.5056, weighted_loss: 1.1641, label: 1, bag_size: 861
batch 419, loss: 1.6076, instance_loss: 0.5089, weighted_loss: 1.2780, label: 3, bag_size: 1399


class 0 clustering acc 0.9921764705882353: correct 16867/17000
class 1 clustering acc 0.009117647058823529: correct 31/3400
Epoch: 0, train_loss: 1.5882, train_clustering_loss:  0.6155, train_error: 0.7365
class 0: acc 0.21686746987951808, correct 18/83
class 1: acc 0.12941176470588237, correct 11/85
class 2: acc 0.014285714285714285, correct 1/70
class 3: acc 0.425531914893617, correct 40/94
class 4: acc 0.45161290322580644, correct 42/93

Val Set, val_loss: 1.6152, val_error: 0.8200, auc: 0.6523
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.0, correct 0/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.0, correct 0/5
Validation loss decreased (inf --> 1.615173).  Saving model ...


batch 19, loss: 1.5377, instance_loss: 0.4962, weighted_loss: 1.2252, label: 1, bag_size: 1390
batch 39, loss: 1.4947, instance_loss: 0.5001, weighted_loss: 1.1963, label: 4, bag_size: 947
batch 59, loss: 1.4789, instance_loss: 0.5013, weighted_loss: 1.1856, label: 3, bag_size: 1172
batch 79, loss: 1.6294, instance_loss: 0.5212, weighted_loss: 1.2969, label: 2, bag_size: 405
batch 99, loss: 1.0865, instance_loss: 0.4919, weighted_loss: 0.9081, label: 4, bag_size: 729
batch 119, loss: 1.8874, instance_loss: 0.5452, weighted_loss: 1.4848, label: 0, bag_size: 552
batch 139, loss: 1.4870, instance_loss: 0.4880, weighted_loss: 1.1873, label: 4, bag_size: 1278
batch 159, loss: 1.4972, instance_loss: 0.5028, weighted_loss: 1.1989, label: 1, bag_size: 897
batch 179, loss: 1.1543, instance_loss: 0.4752, weighted_loss: 0.9506, label: 4, bag_size: 764
batch 199, loss: 1.2407, instance_loss: 0.4581, weighted_loss: 1.0060, label: 3, bag_size: 849
batch 219, loss: 2.1032, instance_loss: 0.5621, weighted_loss: 1.6409, label: 2, bag_size: 748
batch 239, loss: 1.6851, instance_loss: 0.5365, weighted_loss: 1.3405, label: 2, bag_size: 469
batch 259, loss: 1.4844, instance_loss: 0.5208, weighted_loss: 1.1954, label: 0, bag_size: 385
batch 279, loss: 1.6686, instance_loss: 0.5530, weighted_loss: 1.3339, label: 0, bag_size: 912
batch 299, loss: 1.1545, instance_loss: 0.4342, weighted_loss: 0.9384, label: 3, bag_size: 849
batch 319, loss: 1.1693, instance_loss: 0.4340, weighted_loss: 0.9487, label: 3, bag_size: 729
batch 339, loss: 1.1078, instance_loss: 0.4627, weighted_loss: 0.9143, label: 2, bag_size: 1259
batch 359, loss: 1.4430, instance_loss: 0.4939, weighted_loss: 1.1583, label: 2, bag_size: 809
batch 379, loss: 1.2474, instance_loss: 0.4397, weighted_loss: 1.0051, label: 3, bag_size: 697
batch 399, loss: 1.2363, instance_loss: 0.4896, weighted_loss: 1.0123, label: 0, bag_size: 545
batch 419, loss: 1.7158, instance_loss: 0.5268, weighted_loss: 1.3591, label: 1, bag_size: 1152


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4858, train_clustering_loss:  0.5021, train_error: 0.6094
class 0: acc 0.15789473684210525, correct 12/76
class 1: acc 0.4069767441860465, correct 35/86
class 2: acc 0.3068181818181818, correct 27/88
class 3: acc 0.63, correct 63/100
class 4: acc 0.38666666666666666, correct 29/75

Val Set, val_loss: 1.4686, val_error: 0.5400, auc: 0.6981
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.0, correct 0/7
class 2: acc 0.5238095238095238, correct 11/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.2, correct 1/5
Validation loss decreased (1.615173 --> 1.468585).  Saving model ...


batch 19, loss: 1.2329, instance_loss: 0.5120, weighted_loss: 1.0166, label: 2, bag_size: 846
batch 39, loss: 1.1658, instance_loss: 0.4520, weighted_loss: 0.9517, label: 0, bag_size: 729
batch 59, loss: 0.6273, instance_loss: 0.4167, weighted_loss: 0.5641, label: 4, bag_size: 729
batch 79, loss: 1.3860, instance_loss: 0.4804, weighted_loss: 1.1143, label: 3, bag_size: 729
batch 99, loss: 1.7626, instance_loss: 0.5073, weighted_loss: 1.3860, label: 4, bag_size: 511
batch 119, loss: 1.4202, instance_loss: 0.4997, weighted_loss: 1.1440, label: 2, bag_size: 259
batch 139, loss: 1.2300, instance_loss: 0.4494, weighted_loss: 0.9958, label: 3, bag_size: 729
batch 159, loss: 1.3362, instance_loss: 0.4757, weighted_loss: 1.0780, label: 0, bag_size: 340
batch 179, loss: 1.4129, instance_loss: 0.4828, weighted_loss: 1.1339, label: 3, bag_size: 849
batch 199, loss: 1.1834, instance_loss: 0.4706, weighted_loss: 0.9696, label: 0, bag_size: 653
batch 219, loss: 1.6307, instance_loss: 0.5196, weighted_loss: 1.2974, label: 3, bag_size: 849
batch 239, loss: 1.8038, instance_loss: 0.5096, weighted_loss: 1.4156, label: 3, bag_size: 1253
batch 259, loss: 1.0844, instance_loss: 0.4502, weighted_loss: 0.8941, label: 1, bag_size: 696
batch 279, loss: 1.6500, instance_loss: 0.5054, weighted_loss: 1.3066, label: 2, bag_size: 935
batch 299, loss: 1.8400, instance_loss: 0.5270, weighted_loss: 1.4461, label: 4, bag_size: 366
batch 319, loss: 1.6397, instance_loss: 0.5435, weighted_loss: 1.3109, label: 2, bag_size: 959
batch 339, loss: 0.9831, instance_loss: 0.5192, weighted_loss: 0.8439, label: 3, bag_size: 936
batch 359, loss: 1.2744, instance_loss: 0.4981, weighted_loss: 1.0415, label: 0, bag_size: 1190
batch 379, loss: 1.7063, instance_loss: 0.4916, weighted_loss: 1.3419, label: 2, bag_size: 676
batch 399, loss: 1.0347, instance_loss: 0.4523, weighted_loss: 0.8600, label: 0, bag_size: 518
batch 419, loss: 0.6959, instance_loss: 0.3695, weighted_loss: 0.5980, label: 3, bag_size: 1399


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.3384, train_clustering_loss:  0.4822, train_error: 0.5059
class 0: acc 0.5918367346938775, correct 58/98
class 1: acc 0.5172413793103449, correct 45/87
class 2: acc 0.3372093023255814, correct 29/86
class 3: acc 0.49333333333333335, correct 37/75
class 4: acc 0.5189873417721519, correct 41/79

Val Set, val_loss: 1.3598, val_error: 0.4200, auc: 0.7438
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/5
Validation loss decreased (1.468585 --> 1.359763).  Saving model ...


batch 19, loss: 1.3914, instance_loss: 0.4760, weighted_loss: 1.1168, label: 3, bag_size: 630
batch 39, loss: 0.4337, instance_loss: 0.3182, weighted_loss: 0.3991, label: 3, bag_size: 405
batch 59, loss: 1.0440, instance_loss: 0.4506, weighted_loss: 0.8659, label: 3, bag_size: 283
batch 79, loss: 1.1902, instance_loss: 0.5009, weighted_loss: 0.9834, label: 4, bag_size: 790
batch 99, loss: 1.5042, instance_loss: 0.5124, weighted_loss: 1.2066, label: 4, bag_size: 625
batch 119, loss: 1.0391, instance_loss: 0.4733, weighted_loss: 0.8693, label: 2, bag_size: 1289
batch 139, loss: 1.8521, instance_loss: 0.5529, weighted_loss: 1.4624, label: 4, bag_size: 1360
batch 159, loss: 0.6190, instance_loss: 0.3122, weighted_loss: 0.5269, label: 3, bag_size: 729
batch 179, loss: 1.6887, instance_loss: 0.5608, weighted_loss: 1.3503, label: 2, bag_size: 861
batch 199, loss: 0.8809, instance_loss: 0.4399, weighted_loss: 0.7486, label: 0, bag_size: 338
batch 219, loss: 0.2948, instance_loss: 0.3691, weighted_loss: 0.3171, label: 3, bag_size: 952
batch 239, loss: 0.2223, instance_loss: 0.2301, weighted_loss: 0.2247, label: 4, bag_size: 729
batch 259, loss: 1.0796, instance_loss: 0.4343, weighted_loss: 0.8860, label: 1, bag_size: 746
batch 279, loss: 1.7031, instance_loss: 0.4922, weighted_loss: 1.3398, label: 4, bag_size: 436
batch 299, loss: 1.4328, instance_loss: 0.4668, weighted_loss: 1.1430, label: 4, bag_size: 1235
batch 319, loss: 0.8370, instance_loss: 0.4570, weighted_loss: 0.7230, label: 0, bag_size: 756
batch 339, loss: 0.8541, instance_loss: 0.4505, weighted_loss: 0.7330, label: 0, bag_size: 385
batch 359, loss: 0.3571, instance_loss: 0.3666, weighted_loss: 0.3600, label: 4, bag_size: 729
batch 379, loss: 1.8972, instance_loss: 0.5035, weighted_loss: 1.4791, label: 1, bag_size: 446
batch 399, loss: 0.3307, instance_loss: 0.3107, weighted_loss: 0.3247, label: 1, bag_size: 1127
batch 419, loss: 1.0083, instance_loss: 0.4369, weighted_loss: 0.8369, label: 1, bag_size: 690


class 0 clustering acc 0.9997647058823529: correct 16996/17000
class 1 clustering acc 0.00823529411764706: correct 28/3400
Epoch: 3, train_loss: 1.1507, train_clustering_loss:  0.4488, train_error: 0.4329
class 0: acc 0.6162790697674418, correct 53/86
class 1: acc 0.5204081632653061, correct 51/98
class 2: acc 0.2857142857142857, correct 20/70
class 3: acc 0.8351648351648352, correct 76/91
class 4: acc 0.5125, correct 41/80

Val Set, val_loss: 1.3798, val_error: 0.5400, auc: 0.7400
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.02: correct 8/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.47619047619047616, correct 10/21
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.0, correct 0/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1220, instance_loss: 0.2509, weighted_loss: 0.1607, label: 3, bag_size: 1253
batch 39, loss: 1.0208, instance_loss: 0.4252, weighted_loss: 0.8422, label: 0, bag_size: 381
batch 59, loss: 0.2844, instance_loss: 0.2367, weighted_loss: 0.2701, label: 3, bag_size: 1399
batch 79, loss: 1.7595, instance_loss: 0.5026, weighted_loss: 1.3824, label: 1, bag_size: 435
batch 99, loss: 1.0387, instance_loss: 0.4352, weighted_loss: 0.8577, label: 1, bag_size: 269
batch 119, loss: 0.6146, instance_loss: 0.2427, weighted_loss: 0.5030, label: 3, bag_size: 729
batch 139, loss: 0.7310, instance_loss: 0.3904, weighted_loss: 0.6288, label: 0, bag_size: 375
batch 159, loss: 1.0259, instance_loss: 0.4190, weighted_loss: 0.8438, label: 1, bag_size: 847
batch 179, loss: 2.2223, instance_loss: 0.6160, weighted_loss: 1.7404, label: 3, bag_size: 706
batch 199, loss: 1.1350, instance_loss: 0.4800, weighted_loss: 0.9385, label: 1, bag_size: 898
batch 219, loss: 0.9864, instance_loss: 0.4614, weighted_loss: 0.8289, label: 1, bag_size: 1426
batch 239, loss: 0.0480, instance_loss: 0.1469, weighted_loss: 0.0777, label: 3, bag_size: 1253
batch 259, loss: 0.6281, instance_loss: 0.3422, weighted_loss: 0.5423, label: 1, bag_size: 1127
batch 279, loss: 0.3882, instance_loss: 0.2856, weighted_loss: 0.3574, label: 1, bag_size: 697
batch 299, loss: 2.1956, instance_loss: 0.5781, weighted_loss: 1.7103, label: 4, bag_size: 974
batch 319, loss: 0.8931, instance_loss: 0.3887, weighted_loss: 0.7418, label: 1, bag_size: 348
batch 339, loss: 1.4559, instance_loss: 0.5249, weighted_loss: 1.1766, label: 3, bag_size: 360
batch 359, loss: 0.7052, instance_loss: 0.5498, weighted_loss: 0.6586, label: 3, bag_size: 1167
batch 379, loss: 2.0607, instance_loss: 0.6540, weighted_loss: 1.6387, label: 2, bag_size: 1348
batch 399, loss: 1.6182, instance_loss: 0.5939, weighted_loss: 1.3109, label: 4, bag_size: 663
batch 419, loss: 1.1531, instance_loss: 0.5468, weighted_loss: 0.9712, label: 0, bag_size: 760


class 0 clustering acc 0.9981764705882353: correct 16969/17000
class 1 clustering acc 0.08647058823529412: correct 294/3400
Epoch: 4, train_loss: 0.9967, train_clustering_loss:  0.4182, train_error: 0.3788
class 0: acc 0.7777777777777778, correct 63/81
class 1: acc 0.5113636363636364, correct 45/88
class 2: acc 0.35, correct 28/80
class 3: acc 0.8058252427184466, correct 83/103
class 4: acc 0.6164383561643836, correct 45/73

Val Set, val_loss: 1.3254, val_error: 0.4800, auc: 0.7562
class 0 clustering acc 0.9985: correct 1997/2000
class 1 clustering acc 0.0225: correct 9/400
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.5, correct 3/6
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.359763 --> 1.325394).  Saving model ...


batch 19, loss: 1.4718, instance_loss: 0.5344, weighted_loss: 1.1906, label: 0, bag_size: 410
batch 39, loss: 0.0905, instance_loss: 0.2494, weighted_loss: 0.1382, label: 3, bag_size: 936
batch 59, loss: 0.2753, instance_loss: 0.1459, weighted_loss: 0.2365, label: 3, bag_size: 556
batch 79, loss: 1.1023, instance_loss: 0.4655, weighted_loss: 0.9112, label: 2, bag_size: 351
batch 99, loss: 0.3685, instance_loss: 0.3578, weighted_loss: 0.3653, label: 4, bag_size: 754
batch 119, loss: 0.1345, instance_loss: 0.1286, weighted_loss: 0.1327, label: 3, bag_size: 1172
batch 139, loss: 0.8219, instance_loss: 0.4351, weighted_loss: 0.7059, label: 0, bag_size: 371
batch 159, loss: 0.3498, instance_loss: 0.3629, weighted_loss: 0.3537, label: 0, bag_size: 385
batch 179, loss: 0.4015, instance_loss: 0.4187, weighted_loss: 0.4066, label: 0, bag_size: 729
batch 199, loss: 0.5446, instance_loss: 0.4003, weighted_loss: 0.5013, label: 1, bag_size: 242
batch 219, loss: 0.3617, instance_loss: 0.1911, weighted_loss: 0.3105, label: 3, bag_size: 729
batch 239, loss: 0.3739, instance_loss: 0.4103, weighted_loss: 0.3848, label: 0, bag_size: 729
batch 259, loss: 1.7892, instance_loss: 0.5347, weighted_loss: 1.4128, label: 2, bag_size: 748
batch 279, loss: 0.0360, instance_loss: 0.1924, weighted_loss: 0.0829, label: 3, bag_size: 936
batch 299, loss: 0.3572, instance_loss: 0.1805, weighted_loss: 0.3042, label: 3, bag_size: 729
batch 319, loss: 0.2959, instance_loss: 0.1639, weighted_loss: 0.2563, label: 3, bag_size: 729
batch 339, loss: 0.3280, instance_loss: 0.2646, weighted_loss: 0.3090, label: 1, bag_size: 369
batch 359, loss: 1.0243, instance_loss: 0.4169, weighted_loss: 0.8421, label: 1, bag_size: 1014
batch 379, loss: 1.1131, instance_loss: 0.5126, weighted_loss: 0.9330, label: 2, bag_size: 1533
batch 399, loss: 0.3603, instance_loss: 0.1346, weighted_loss: 0.2926, label: 3, bag_size: 729
batch 419, loss: 0.9286, instance_loss: 0.4552, weighted_loss: 0.7866, label: 2, bag_size: 913


class 0 clustering acc 0.9972941176470588: correct 16954/17000
class 1 clustering acc 0.10852941176470589: correct 369/3400
Epoch: 5, train_loss: 0.8986, train_clustering_loss:  0.4041, train_error: 0.3341
class 0: acc 0.84375, correct 81/96
class 1: acc 0.49411764705882355, correct 42/85
class 2: acc 0.36231884057971014, correct 25/69
class 3: acc 0.8125, correct 65/80
class 4: acc 0.7368421052631579, correct 70/95

Val Set, val_loss: 1.3363, val_error: 0.5600, auc: 0.7689
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.02: correct 8/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.3333333333333333, correct 7/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3755, instance_loss: 0.4886, weighted_loss: 0.4094, label: 3, bag_size: 1250
batch 39, loss: 1.1553, instance_loss: 0.5094, weighted_loss: 0.9616, label: 0, bag_size: 1034
batch 59, loss: 0.5601, instance_loss: 0.6312, weighted_loss: 0.5814, label: 0, bag_size: 729
batch 79, loss: 0.7539, instance_loss: 0.4447, weighted_loss: 0.6611, label: 0, bag_size: 921
batch 99, loss: 0.0656, instance_loss: 0.1595, weighted_loss: 0.0937, label: 4, bag_size: 764
batch 119, loss: 2.9733, instance_loss: 0.7038, weighted_loss: 2.2925, label: 4, bag_size: 511
batch 139, loss: 1.6598, instance_loss: 0.4340, weighted_loss: 1.2920, label: 4, bag_size: 675
batch 159, loss: 0.6169, instance_loss: 0.3384, weighted_loss: 0.5333, label: 4, bag_size: 297
batch 179, loss: 1.1534, instance_loss: 0.5411, weighted_loss: 0.9697, label: 1, bag_size: 530
batch 199, loss: 0.4405, instance_loss: 0.5111, weighted_loss: 0.4617, label: 0, bag_size: 729
batch 219, loss: 1.9891, instance_loss: 0.5156, weighted_loss: 1.5470, label: 3, bag_size: 630
batch 239, loss: 0.1556, instance_loss: 0.1537, weighted_loss: 0.1551, label: 3, bag_size: 729
batch 259, loss: 0.0734, instance_loss: 0.1601, weighted_loss: 0.0994, label: 4, bag_size: 1235
batch 279, loss: 0.4267, instance_loss: 0.2988, weighted_loss: 0.3883, label: 4, bag_size: 656
batch 299, loss: 0.3484, instance_loss: 0.2790, weighted_loss: 0.3276, label: 4, bag_size: 1357
batch 319, loss: 1.1410, instance_loss: 0.4527, weighted_loss: 0.9345, label: 2, bag_size: 409
batch 339, loss: 0.1108, instance_loss: 0.1643, weighted_loss: 0.1269, label: 4, bag_size: 729
batch 359, loss: 2.0208, instance_loss: 0.5869, weighted_loss: 1.5906, label: 0, bag_size: 1065
batch 379, loss: 1.5012, instance_loss: 0.5402, weighted_loss: 1.2129, label: 4, bag_size: 297
batch 399, loss: 0.7100, instance_loss: 0.4758, weighted_loss: 0.6398, label: 0, bag_size: 1196
batch 419, loss: 0.2295, instance_loss: 0.1474, weighted_loss: 0.2049, label: 3, bag_size: 729


class 0 clustering acc 0.9955882352941177: correct 16925/17000
class 1 clustering acc 0.17352941176470588: correct 590/3400
Epoch: 6, train_loss: 0.8171, train_clustering_loss:  0.3921, train_error: 0.2753
class 0: acc 0.8571428571428571, correct 72/84
class 1: acc 0.6385542168674698, correct 53/83
class 2: acc 0.46835443037974683, correct 37/79
class 3: acc 0.7934782608695652, correct 73/92
class 4: acc 0.8390804597701149, correct 73/87

Val Set, val_loss: 1.2083, val_error: 0.4800, auc: 0.7971
class 0 clustering acc 0.9985: correct 1997/2000
class 1 clustering acc 0.03: correct 12/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.42857142857142855, correct 9/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.325394 --> 1.208297).  Saving model ...


batch 19, loss: 0.1062, instance_loss: 0.1823, weighted_loss: 0.1290, label: 3, bag_size: 952
batch 39, loss: 0.1370, instance_loss: 0.1455, weighted_loss: 0.1396, label: 3, bag_size: 729
batch 59, loss: 0.1097, instance_loss: 0.1077, weighted_loss: 0.1091, label: 3, bag_size: 1172
batch 79, loss: 0.3082, instance_loss: 0.2839, weighted_loss: 0.3009, label: 0, bag_size: 756
batch 99, loss: 1.3953, instance_loss: 0.6850, weighted_loss: 1.1822, label: 3, bag_size: 281
batch 119, loss: 1.2199, instance_loss: 0.4522, weighted_loss: 0.9896, label: 1, bag_size: 1255
batch 139, loss: 0.2136, instance_loss: 0.1237, weighted_loss: 0.1866, label: 3, bag_size: 729
batch 159, loss: 0.6357, instance_loss: 0.3779, weighted_loss: 0.5584, label: 2, bag_size: 499
batch 179, loss: 2.1851, instance_loss: 0.5084, weighted_loss: 1.6821, label: 2, bag_size: 1215
batch 199, loss: 0.9556, instance_loss: 0.4483, weighted_loss: 0.8034, label: 2, bag_size: 676
batch 219, loss: 0.2071, instance_loss: 0.3023, weighted_loss: 0.2356, label: 4, bag_size: 1474
batch 239, loss: 0.8689, instance_loss: 0.4595, weighted_loss: 0.7461, label: 2, bag_size: 839
batch 259, loss: 0.1965, instance_loss: 0.4138, weighted_loss: 0.2617, label: 4, bag_size: 646
batch 279, loss: 0.1022, instance_loss: 0.2234, weighted_loss: 0.1386, label: 4, bag_size: 1278
batch 299, loss: 0.9415, instance_loss: 0.5074, weighted_loss: 0.8113, label: 2, bag_size: 278
batch 319, loss: 0.4390, instance_loss: 0.3182, weighted_loss: 0.4028, label: 4, bag_size: 826
batch 339, loss: 0.1645, instance_loss: 0.1162, weighted_loss: 0.1500, label: 3, bag_size: 556
batch 359, loss: 0.9365, instance_loss: 0.4670, weighted_loss: 0.7957, label: 2, bag_size: 1242
batch 379, loss: 0.3052, instance_loss: 0.3589, weighted_loss: 0.3213, label: 4, bag_size: 297
batch 399, loss: 0.9777, instance_loss: 0.4785, weighted_loss: 0.8279, label: 2, bag_size: 1139
batch 419, loss: 0.1275, instance_loss: 0.1667, weighted_loss: 0.1392, label: 4, bag_size: 790


class 0 clustering acc 0.9965294117647059: correct 16941/17000
class 1 clustering acc 0.2161764705882353: correct 735/3400
Epoch: 7, train_loss: 0.7069, train_clustering_loss:  0.3728, train_error: 0.2659
class 0: acc 0.8311688311688312, correct 64/77
class 1: acc 0.4861111111111111, correct 35/72
class 2: acc 0.5357142857142857, correct 45/84
class 3: acc 0.8725490196078431, correct 89/102
class 4: acc 0.8777777777777778, correct 79/90

Val Set, val_loss: 1.2278, val_error: 0.4000, auc: 0.7980
class 0 clustering acc 0.9935: correct 1987/2000
class 1 clustering acc 0.0575: correct 23/400
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7061, instance_loss: 0.4789, weighted_loss: 0.6379, label: 3, bag_size: 630
batch 39, loss: 1.0766, instance_loss: 0.4898, weighted_loss: 0.9006, label: 2, bag_size: 409
batch 59, loss: 0.7705, instance_loss: 0.7154, weighted_loss: 0.7539, label: 1, bag_size: 860
batch 79, loss: 2.0050, instance_loss: 0.5797, weighted_loss: 1.5774, label: 1, bag_size: 535
batch 99, loss: 0.0663, instance_loss: 0.1204, weighted_loss: 0.0825, label: 3, bag_size: 729
batch 119, loss: 0.8981, instance_loss: 0.4686, weighted_loss: 0.7692, label: 2, bag_size: 345
batch 139, loss: 1.0318, instance_loss: 0.7428, weighted_loss: 0.9451, label: 4, bag_size: 663
batch 159, loss: 0.4161, instance_loss: 0.1763, weighted_loss: 0.3441, label: 4, bag_size: 764
batch 179, loss: 0.5699, instance_loss: 0.3888, weighted_loss: 0.5156, label: 2, bag_size: 748
batch 199, loss: 3.0474, instance_loss: 0.5047, weighted_loss: 2.2846, label: 4, bag_size: 1331
batch 219, loss: 0.8067, instance_loss: 0.4534, weighted_loss: 0.7008, label: 1, bag_size: 614
batch 239, loss: 1.5425, instance_loss: 0.5326, weighted_loss: 1.2395, label: 1, bag_size: 747
batch 259, loss: 0.1030, instance_loss: 0.1776, weighted_loss: 0.1254, label: 4, bag_size: 729
batch 279, loss: 0.6794, instance_loss: 0.3059, weighted_loss: 0.5674, label: 4, bag_size: 354
batch 299, loss: 0.3070, instance_loss: 0.4038, weighted_loss: 0.3360, label: 0, bag_size: 976
batch 319, loss: 0.3520, instance_loss: 0.3118, weighted_loss: 0.3399, label: 1, bag_size: 242
batch 339, loss: 0.3191, instance_loss: 0.3866, weighted_loss: 0.3394, label: 4, bag_size: 1474
batch 359, loss: 0.0980, instance_loss: 0.1697, weighted_loss: 0.1195, label: 4, bag_size: 646
batch 379, loss: 0.2582, instance_loss: 0.4192, weighted_loss: 0.3065, label: 0, bag_size: 524
batch 399, loss: 0.4143, instance_loss: 0.3577, weighted_loss: 0.3973, label: 2, bag_size: 1788
batch 419, loss: 0.4494, instance_loss: 0.3366, weighted_loss: 0.4155, label: 2, bag_size: 636


class 0 clustering acc 0.9943529411764706: correct 16904/17000
class 1 clustering acc 0.1864705882352941: correct 634/3400
Epoch: 8, train_loss: 0.6997, train_clustering_loss:  0.3834, train_error: 0.2400
class 0: acc 0.9130434782608695, correct 84/92
class 1: acc 0.6770833333333334, correct 65/96
class 2: acc 0.5795454545454546, correct 51/88
class 3: acc 0.8148148148148148, correct 66/81
class 4: acc 0.8382352941176471, correct 57/68

Val Set, val_loss: 1.1338, val_error: 0.4000, auc: 0.8142
class 0 clustering acc 0.998: correct 1996/2000
class 1 clustering acc 0.0575: correct 23/400
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.6, correct 3/5
Validation loss decreased (1.208297 --> 1.133762).  Saving model ...


batch 19, loss: 0.0655, instance_loss: 0.0885, weighted_loss: 0.0724, label: 3, bag_size: 305
batch 39, loss: 1.1327, instance_loss: 0.5343, weighted_loss: 0.9531, label: 2, bag_size: 784
batch 59, loss: 0.6788, instance_loss: 0.4209, weighted_loss: 0.6014, label: 2, bag_size: 1133
batch 79, loss: 0.4038, instance_loss: 0.4296, weighted_loss: 0.4115, label: 0, bag_size: 371
batch 99, loss: 0.1137, instance_loss: 0.1834, weighted_loss: 0.1346, label: 0, bag_size: 1872
batch 119, loss: 0.9631, instance_loss: 0.4741, weighted_loss: 0.8164, label: 3, bag_size: 200
batch 139, loss: 1.9010, instance_loss: 0.5997, weighted_loss: 1.5106, label: 1, bag_size: 936
batch 159, loss: 0.2462, instance_loss: 0.3627, weighted_loss: 0.2812, label: 4, bag_size: 974
batch 179, loss: 0.1824, instance_loss: 0.3203, weighted_loss: 0.2238, label: 4, bag_size: 656
batch 199, loss: 1.9149, instance_loss: 0.5304, weighted_loss: 1.4996, label: 2, bag_size: 911
batch 219, loss: 1.0150, instance_loss: 0.5232, weighted_loss: 0.8675, label: 0, bag_size: 729
batch 239, loss: 0.2607, instance_loss: 0.2816, weighted_loss: 0.2669, label: 1, bag_size: 696
batch 259, loss: 0.2369, instance_loss: 0.2744, weighted_loss: 0.2482, label: 0, bag_size: 1190
batch 279, loss: 0.6414, instance_loss: 0.4058, weighted_loss: 0.5707, label: 2, bag_size: 1569
batch 299, loss: 0.0114, instance_loss: 0.0911, weighted_loss: 0.0353, label: 4, bag_size: 729
batch 319, loss: 0.1407, instance_loss: 0.2768, weighted_loss: 0.1815, label: 4, bag_size: 1278
batch 339, loss: 1.2766, instance_loss: 0.5517, weighted_loss: 1.0591, label: 3, bag_size: 360
batch 359, loss: 1.4495, instance_loss: 0.5996, weighted_loss: 1.1945, label: 0, bag_size: 1065
batch 379, loss: 0.4778, instance_loss: 0.3629, weighted_loss: 0.4433, label: 1, bag_size: 846
batch 399, loss: 0.3917, instance_loss: 0.5547, weighted_loss: 0.4406, label: 0, bag_size: 729
batch 419, loss: 1.2617, instance_loss: 0.4160, weighted_loss: 1.0080, label: 0, bag_size: 245


class 0 clustering acc 0.9946470588235294: correct 16909/17000
class 1 clustering acc 0.22: correct 748/3400
Epoch: 9, train_loss: 0.7114, train_clustering_loss:  0.3734, train_error: 0.2518
class 0: acc 0.8, correct 72/90
class 1: acc 0.5714285714285714, correct 52/91
class 2: acc 0.5569620253164557, correct 44/79
class 3: acc 0.9135802469135802, correct 74/81
class 4: acc 0.9047619047619048, correct 76/84

Val Set, val_loss: 1.0686, val_error: 0.3200, auc: 0.8354
class 0 clustering acc 0.9985: correct 1997/2000
class 1 clustering acc 0.0825: correct 33/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
Validation loss decreased (1.133762 --> 1.068555).  Saving model ...


batch 19, loss: 0.2282, instance_loss: 0.1780, weighted_loss: 0.2131, label: 0, bag_size: 515
batch 39, loss: 1.7801, instance_loss: 0.6391, weighted_loss: 1.4378, label: 2, bag_size: 542
batch 59, loss: 0.0449, instance_loss: 0.1395, weighted_loss: 0.0733, label: 4, bag_size: 646
batch 79, loss: 0.0154, instance_loss: 0.0722, weighted_loss: 0.0324, label: 4, bag_size: 729
batch 99, loss: 0.0255, instance_loss: 0.0833, weighted_loss: 0.0428, label: 4, bag_size: 729
batch 119, loss: 0.5115, instance_loss: 0.4359, weighted_loss: 0.4888, label: 0, bag_size: 990
batch 139, loss: 0.0270, instance_loss: 0.5529, weighted_loss: 0.1847, label: 4, bag_size: 663
batch 159, loss: 0.2874, instance_loss: 0.3053, weighted_loss: 0.2928, label: 1, bag_size: 346
batch 179, loss: 0.0488, instance_loss: 0.3610, weighted_loss: 0.1425, label: 3, bag_size: 791
batch 199, loss: 0.2361, instance_loss: 0.2431, weighted_loss: 0.2382, label: 0, bag_size: 1133
batch 219, loss: 0.3321, instance_loss: 0.2744, weighted_loss: 0.3148, label: 0, bag_size: 410
batch 239, loss: 1.1275, instance_loss: 0.4226, weighted_loss: 0.9160, label: 4, bag_size: 590
batch 259, loss: 0.0208, instance_loss: 0.1226, weighted_loss: 0.0513, label: 3, bag_size: 952
batch 279, loss: 0.0885, instance_loss: 0.1182, weighted_loss: 0.0974, label: 3, bag_size: 729
batch 299, loss: 0.4007, instance_loss: 0.3289, weighted_loss: 0.3792, label: 1, bag_size: 994
batch 319, loss: 0.3444, instance_loss: 0.2473, weighted_loss: 0.3153, label: 2, bag_size: 525
batch 339, loss: 0.1793, instance_loss: 0.3608, weighted_loss: 0.2338, label: 4, bag_size: 354
batch 359, loss: 2.2286, instance_loss: 0.6260, weighted_loss: 1.7479, label: 1, bag_size: 308
batch 379, loss: 1.0958, instance_loss: 0.4930, weighted_loss: 0.9150, label: 1, bag_size: 1096
batch 399, loss: 1.0419, instance_loss: 0.5174, weighted_loss: 0.8845, label: 2, bag_size: 518
batch 419, loss: 1.2099, instance_loss: 0.6081, weighted_loss: 1.0294, label: 3, bag_size: 360


class 0 clustering acc 0.9939411764705882: correct 16897/17000
class 1 clustering acc 0.265: correct 901/3400
Epoch: 10, train_loss: 0.5487, train_clustering_loss:  0.3479, train_error: 0.1788
class 0: acc 0.881578947368421, correct 67/76
class 1: acc 0.631578947368421, correct 48/76
class 2: acc 0.7448979591836735, correct 73/98
class 3: acc 0.9240506329113924, correct 73/79
class 4: acc 0.9166666666666666, correct 88/96

Val Set, val_loss: 1.3582, val_error: 0.4200, auc: 0.8050
class 0 clustering acc 0.995: correct 1990/2000
class 1 clustering acc 0.07: correct 28/400
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0898, instance_loss: 0.1505, weighted_loss: 0.1080, label: 0, bag_size: 360
batch 39, loss: 1.2800, instance_loss: 0.4811, weighted_loss: 1.0403, label: 1, bag_size: 470
batch 59, loss: 0.0299, instance_loss: 0.0772, weighted_loss: 0.0441, label: 3, bag_size: 1172
batch 79, loss: 1.6829, instance_loss: 0.4054, weighted_loss: 1.2996, label: 1, bag_size: 504
batch 99, loss: 0.2201, instance_loss: 0.2164, weighted_loss: 0.2190, label: 0, bag_size: 653
batch 119, loss: 0.4634, instance_loss: 0.4720, weighted_loss: 0.4660, label: 1, bag_size: 139
batch 139, loss: 0.0895, instance_loss: 0.1933, weighted_loss: 0.1206, label: 3, bag_size: 849
batch 159, loss: 0.2008, instance_loss: 0.4735, weighted_loss: 0.2826, label: 4, bag_size: 675
batch 179, loss: 0.0717, instance_loss: 0.1483, weighted_loss: 0.0947, label: 3, bag_size: 1118
batch 199, loss: 0.1206, instance_loss: 0.1263, weighted_loss: 0.1223, label: 3, bag_size: 316
batch 219, loss: 0.4394, instance_loss: 0.4195, weighted_loss: 0.4334, label: 2, bag_size: 636
batch 239, loss: 0.5512, instance_loss: 0.3564, weighted_loss: 0.4928, label: 4, bag_size: 1360
batch 259, loss: 0.1821, instance_loss: 0.1552, weighted_loss: 0.1741, label: 3, bag_size: 821
batch 279, loss: 0.4648, instance_loss: 0.3482, weighted_loss: 0.4298, label: 2, bag_size: 525
batch 299, loss: 0.3744, instance_loss: 0.3314, weighted_loss: 0.3615, label: 1, bag_size: 754
batch 319, loss: 0.0330, instance_loss: 0.2151, weighted_loss: 0.0876, label: 4, bag_size: 729
batch 339, loss: 0.3481, instance_loss: 0.3558, weighted_loss: 0.3504, label: 0, bag_size: 760
batch 359, loss: 0.5371, instance_loss: 0.4714, weighted_loss: 0.5174, label: 0, bag_size: 338
batch 379, loss: 0.3195, instance_loss: 0.3969, weighted_loss: 0.3428, label: 4, bag_size: 436
batch 399, loss: 0.0539, instance_loss: 0.0975, weighted_loss: 0.0670, label: 0, bag_size: 402
batch 419, loss: 0.0582, instance_loss: 0.1252, weighted_loss: 0.0783, label: 0, bag_size: 375


class 0 clustering acc 0.9931176470588235: correct 16883/17000
class 1 clustering acc 0.3079411764705882: correct 1047/3400
Epoch: 11, train_loss: 0.5613, train_clustering_loss:  0.3457, train_error: 0.2094
class 0: acc 0.8725490196078431, correct 89/102
class 1: acc 0.6024096385542169, correct 50/83
class 2: acc 0.5942028985507246, correct 41/69
class 3: acc 0.9, correct 72/80
class 4: acc 0.9230769230769231, correct 84/91

Val Set, val_loss: 1.2644, val_error: 0.5000, auc: 0.8397
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.1675: correct 67/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.3333333333333333, correct 7/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5085, instance_loss: 0.6711, weighted_loss: 0.5573, label: 1, bag_size: 860
batch 39, loss: 0.7922, instance_loss: 0.4065, weighted_loss: 0.6765, label: 0, bag_size: 736
batch 59, loss: 0.3594, instance_loss: 0.3893, weighted_loss: 0.3683, label: 3, bag_size: 849
batch 79, loss: 0.6531, instance_loss: 0.4740, weighted_loss: 0.5994, label: 2, bag_size: 537
batch 99, loss: 0.0823, instance_loss: 0.1675, weighted_loss: 0.1078, label: 1, bag_size: 847
batch 119, loss: 0.6422, instance_loss: 0.3597, weighted_loss: 0.5574, label: 1, bag_size: 399
batch 139, loss: 0.2520, instance_loss: 0.3070, weighted_loss: 0.2685, label: 4, bag_size: 1278
batch 159, loss: 0.0666, instance_loss: 0.2541, weighted_loss: 0.1229, label: 0, bag_size: 729
batch 179, loss: 0.4287, instance_loss: 0.3678, weighted_loss: 0.4104, label: 2, bag_size: 355
batch 199, loss: 0.1285, instance_loss: 0.2204, weighted_loss: 0.1561, label: 0, bag_size: 731
batch 219, loss: 0.1023, instance_loss: 0.1732, weighted_loss: 0.1236, label: 0, bag_size: 1517
batch 239, loss: 0.0918, instance_loss: 0.2712, weighted_loss: 0.1456, label: 4, bag_size: 1176
batch 259, loss: 0.6468, instance_loss: 0.6419, weighted_loss: 0.6453, label: 3, bag_size: 211
batch 279, loss: 0.2889, instance_loss: 0.2305, weighted_loss: 0.2714, label: 1, bag_size: 356
batch 299, loss: 0.5224, instance_loss: 0.4257, weighted_loss: 0.4934, label: 3, bag_size: 200
batch 319, loss: 0.1658, instance_loss: 0.3039, weighted_loss: 0.2072, label: 4, bag_size: 656
batch 339, loss: 0.0317, instance_loss: 0.0901, weighted_loss: 0.0492, label: 3, bag_size: 729
batch 359, loss: 1.5097, instance_loss: 0.5354, weighted_loss: 1.2174, label: 3, bag_size: 281
batch 379, loss: 0.6449, instance_loss: 0.4022, weighted_loss: 0.5721, label: 2, bag_size: 1617
batch 399, loss: 0.7282, instance_loss: 0.6249, weighted_loss: 0.6972, label: 3, bag_size: 281
batch 419, loss: 0.0919, instance_loss: 0.2503, weighted_loss: 0.1394, label: 0, bag_size: 921


class 0 clustering acc 0.9925882352941177: correct 16874/17000
class 1 clustering acc 0.25882352941176473: correct 880/3400
Epoch: 12, train_loss: 0.6062, train_clustering_loss:  0.3647, train_error: 0.2306
class 0: acc 0.8666666666666667, correct 65/75
class 1: acc 0.6292134831460674, correct 56/89
class 2: acc 0.6224489795918368, correct 61/98
class 3: acc 0.8953488372093024, correct 77/86
class 4: acc 0.8831168831168831, correct 68/77

Val Set, val_loss: 1.1436, val_error: 0.3800, auc: 0.8219
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.5, correct 3/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0294, instance_loss: 0.0831, weighted_loss: 0.0455, label: 3, bag_size: 729
batch 39, loss: 1.3399, instance_loss: 0.5134, weighted_loss: 1.0920, label: 1, bag_size: 1197
batch 59, loss: 0.0532, instance_loss: 0.4266, weighted_loss: 0.1652, label: 4, bag_size: 754
batch 79, loss: 0.0074, instance_loss: 0.1215, weighted_loss: 0.0416, label: 4, bag_size: 729
batch 99, loss: 0.1726, instance_loss: 0.1103, weighted_loss: 0.1539, label: 3, bag_size: 729
batch 119, loss: 0.0946, instance_loss: 0.1361, weighted_loss: 0.1070, label: 0, bag_size: 1872
batch 139, loss: 0.0127, instance_loss: 0.4657, weighted_loss: 0.1486, label: 3, bag_size: 791
batch 159, loss: 0.0861, instance_loss: 0.1218, weighted_loss: 0.0968, label: 3, bag_size: 316
batch 179, loss: 0.4688, instance_loss: 0.2899, weighted_loss: 0.4151, label: 0, bag_size: 653
batch 199, loss: 0.1228, instance_loss: 0.1029, weighted_loss: 0.1168, label: 0, bag_size: 1133
batch 219, loss: 1.2746, instance_loss: 0.5781, weighted_loss: 1.0656, label: 3, bag_size: 283
batch 239, loss: 0.0020, instance_loss: 0.0836, weighted_loss: 0.0265, label: 4, bag_size: 729
batch 259, loss: 0.5916, instance_loss: 0.4336, weighted_loss: 0.5442, label: 2, bag_size: 204
batch 279, loss: 0.0381, instance_loss: 0.0562, weighted_loss: 0.0435, label: 3, bag_size: 729
batch 299, loss: 0.5873, instance_loss: 0.2562, weighted_loss: 0.4880, label: 4, bag_size: 817
batch 319, loss: 0.0914, instance_loss: 0.1106, weighted_loss: 0.0972, label: 0, bag_size: 1872
batch 339, loss: 0.3611, instance_loss: 0.3530, weighted_loss: 0.3587, label: 1, bag_size: 898
batch 359, loss: 0.0156, instance_loss: 0.0741, weighted_loss: 0.0332, label: 3, bag_size: 952
batch 379, loss: 0.1700, instance_loss: 0.3803, weighted_loss: 0.2331, label: 4, bag_size: 625
batch 399, loss: 0.5336, instance_loss: 0.4140, weighted_loss: 0.4977, label: 2, bag_size: 508
batch 419, loss: 0.3277, instance_loss: 0.2306, weighted_loss: 0.2986, label: 0, bag_size: 616


class 0 clustering acc 0.9915294117647059: correct 16856/17000
class 1 clustering acc 0.3467647058823529: correct 1179/3400
Epoch: 13, train_loss: 0.4391, train_clustering_loss:  0.3251, train_error: 0.1553
class 0: acc 0.9066666666666666, correct 68/75
class 1: acc 0.6790123456790124, correct 55/81
class 2: acc 0.6785714285714286, correct 57/84
class 3: acc 0.9397590361445783, correct 78/83
class 4: acc 0.9901960784313726, correct 101/102

Val Set, val_loss: 1.1205, val_error: 0.3000, auc: 0.8537
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.105: correct 42/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.9523809523809523, correct 20/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1647, instance_loss: 0.6428, weighted_loss: 0.3081, label: 4, bag_size: 974
batch 39, loss: 0.0163, instance_loss: 0.3383, weighted_loss: 0.1129, label: 3, bag_size: 841
batch 59, loss: 0.1580, instance_loss: 0.1333, weighted_loss: 0.1506, label: 4, bag_size: 790
batch 79, loss: 0.2448, instance_loss: 0.4921, weighted_loss: 0.3190, label: 2, bag_size: 373
batch 99, loss: 0.2439, instance_loss: 0.9089, weighted_loss: 0.4434, label: 1, bag_size: 860
batch 119, loss: 0.0068, instance_loss: 0.0986, weighted_loss: 0.0343, label: 4, bag_size: 729
batch 139, loss: 0.0052, instance_loss: 0.0712, weighted_loss: 0.0250, label: 4, bag_size: 729
batch 159, loss: 0.4147, instance_loss: 0.4375, weighted_loss: 0.4216, label: 1, bag_size: 1080
batch 179, loss: 0.7462, instance_loss: 0.3611, weighted_loss: 0.6307, label: 2, bag_size: 262
batch 199, loss: 0.3629, instance_loss: 0.3192, weighted_loss: 0.3498, label: 0, bag_size: 410
batch 219, loss: 0.0712, instance_loss: 0.2232, weighted_loss: 0.1168, label: 3, bag_size: 936
batch 239, loss: 0.1916, instance_loss: 0.2617, weighted_loss: 0.2126, label: 4, bag_size: 928
batch 259, loss: 0.5823, instance_loss: 0.4797, weighted_loss: 0.5515, label: 0, bag_size: 437
batch 279, loss: 0.2316, instance_loss: 0.5491, weighted_loss: 0.3268, label: 3, bag_size: 281
batch 299, loss: 0.0926, instance_loss: 0.1124, weighted_loss: 0.0985, label: 3, bag_size: 729
batch 319, loss: 0.0299, instance_loss: 0.3706, weighted_loss: 0.1321, label: 0, bag_size: 729
batch 339, loss: 1.0045, instance_loss: 0.4831, weighted_loss: 0.8481, label: 2, bag_size: 629
batch 359, loss: 0.3763, instance_loss: 0.3719, weighted_loss: 0.3750, label: 1, bag_size: 903
batch 379, loss: 0.5989, instance_loss: 0.3817, weighted_loss: 0.5337, label: 2, bag_size: 682
batch 399, loss: 0.2573, instance_loss: 0.1988, weighted_loss: 0.2397, label: 0, bag_size: 990
batch 419, loss: 0.0629, instance_loss: 0.0982, weighted_loss: 0.0735, label: 3, bag_size: 729


class 0 clustering acc 0.9909411764705882: correct 16846/17000
class 1 clustering acc 0.3452941176470588: correct 1174/3400
Epoch: 14, train_loss: 0.4754, train_clustering_loss:  0.3392, train_error: 0.1576
class 0: acc 0.9431818181818182, correct 83/88
class 1: acc 0.5797101449275363, correct 40/69
class 2: acc 0.7528089887640449, correct 67/89
class 3: acc 0.9381443298969072, correct 91/97
class 4: acc 0.9390243902439024, correct 77/82

Val Set, val_loss: 1.0921, val_error: 0.4000, auc: 0.8485
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.17: correct 68/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.5337, instance_loss: 0.3456, weighted_loss: 0.4773, label: 1, bag_size: 1014
batch 39, loss: 2.0711, instance_loss: 0.7038, weighted_loss: 1.6609, label: 2, bag_size: 1006
batch 59, loss: 0.0704, instance_loss: 0.0816, weighted_loss: 0.0738, label: 0, bag_size: 1466
batch 79, loss: 0.3807, instance_loss: 0.3624, weighted_loss: 0.3752, label: 1, bag_size: 598
batch 99, loss: 0.1081, instance_loss: 0.1485, weighted_loss: 0.1202, label: 4, bag_size: 790
batch 119, loss: 0.0429, instance_loss: 0.0550, weighted_loss: 0.0466, label: 3, bag_size: 556
batch 139, loss: 0.6300, instance_loss: 0.3893, weighted_loss: 0.5578, label: 1, bag_size: 614
batch 159, loss: 0.0245, instance_loss: 0.2597, weighted_loss: 0.0950, label: 4, bag_size: 1002
batch 179, loss: 0.0900, instance_loss: 0.1018, weighted_loss: 0.0936, label: 3, bag_size: 316
batch 199, loss: 0.6839, instance_loss: 0.4168, weighted_loss: 0.6038, label: 0, bag_size: 1065
batch 219, loss: 0.3656, instance_loss: 0.3136, weighted_loss: 0.3500, label: 2, bag_size: 347
batch 239, loss: 0.3073, instance_loss: 0.3488, weighted_loss: 0.3198, label: 1, bag_size: 530
batch 259, loss: 0.0675, instance_loss: 0.2312, weighted_loss: 0.1166, label: 4, bag_size: 1176
batch 279, loss: 0.0492, instance_loss: 0.0745, weighted_loss: 0.0568, label: 0, bag_size: 616
batch 299, loss: 0.2979, instance_loss: 0.3254, weighted_loss: 0.3062, label: 2, bag_size: 330
batch 319, loss: 0.0106, instance_loss: 0.0678, weighted_loss: 0.0278, label: 3, bag_size: 729
batch 339, loss: 0.9985, instance_loss: 0.5284, weighted_loss: 0.8575, label: 2, bag_size: 1700
batch 359, loss: 0.1815, instance_loss: 0.6904, weighted_loss: 0.3341, label: 3, bag_size: 671
batch 379, loss: 0.0215, instance_loss: 0.1382, weighted_loss: 0.0565, label: 3, bag_size: 729
batch 399, loss: 0.2541, instance_loss: 0.3437, weighted_loss: 0.2810, label: 1, bag_size: 690
batch 419, loss: 0.0189, instance_loss: 0.1193, weighted_loss: 0.0490, label: 4, bag_size: 646


class 0 clustering acc 0.9906470588235294: correct 16841/17000
class 1 clustering acc 0.3711764705882353: correct 1262/3400
Epoch: 15, train_loss: 0.4672, train_clustering_loss:  0.3245, train_error: 0.1694
class 0: acc 0.9390243902439024, correct 77/82
class 1: acc 0.6867469879518072, correct 57/83
class 2: acc 0.6511627906976745, correct 56/86
class 3: acc 0.9629629629629629, correct 78/81
class 4: acc 0.9139784946236559, correct 85/93

Val Set, val_loss: 1.1399, val_error: 0.3400, auc: 0.8293
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.9957, instance_loss: 0.4613, weighted_loss: 0.8354, label: 2, bag_size: 795
batch 39, loss: 0.1406, instance_loss: 0.4181, weighted_loss: 0.2239, label: 1, bag_size: 925
batch 59, loss: 0.2771, instance_loss: 0.3635, weighted_loss: 0.3030, label: 4, bag_size: 656
batch 79, loss: 0.0088, instance_loss: 0.0836, weighted_loss: 0.0313, label: 4, bag_size: 729
batch 99, loss: 0.2843, instance_loss: 0.3137, weighted_loss: 0.2931, label: 2, bag_size: 1410
batch 119, loss: 0.9706, instance_loss: 0.5618, weighted_loss: 0.8480, label: 2, bag_size: 474
batch 139, loss: 0.1060, instance_loss: 0.1375, weighted_loss: 0.1155, label: 0, bag_size: 552
batch 159, loss: 0.4030, instance_loss: 0.4282, weighted_loss: 0.4106, label: 4, bag_size: 1331
batch 179, loss: 0.3924, instance_loss: 0.2188, weighted_loss: 0.3403, label: 0, bag_size: 294
batch 199, loss: 0.7056, instance_loss: 0.4188, weighted_loss: 0.6196, label: 2, bag_size: 707
batch 219, loss: 0.0755, instance_loss: 0.0942, weighted_loss: 0.0811, label: 3, bag_size: 729
batch 239, loss: 0.0052, instance_loss: 0.2892, weighted_loss: 0.0904, label: 4, bag_size: 729
batch 259, loss: 0.0182, instance_loss: 0.1026, weighted_loss: 0.0435, label: 4, bag_size: 764
batch 279, loss: 0.3208, instance_loss: 0.3144, weighted_loss: 0.3189, label: 2, bag_size: 499
batch 299, loss: 0.0417, instance_loss: 0.0287, weighted_loss: 0.0378, label: 3, bag_size: 1172
batch 319, loss: 0.3273, instance_loss: 0.3177, weighted_loss: 0.3245, label: 0, bag_size: 1101
batch 339, loss: 0.8339, instance_loss: 0.4709, weighted_loss: 0.7250, label: 0, bag_size: 1527
batch 359, loss: 0.2846, instance_loss: 0.3878, weighted_loss: 0.3155, label: 4, bag_size: 1360
batch 379, loss: 2.4049, instance_loss: 0.8279, weighted_loss: 1.9318, label: 2, bag_size: 1043
batch 399, loss: 0.0584, instance_loss: 0.4186, weighted_loss: 0.1665, label: 3, bag_size: 706
batch 419, loss: 0.0357, instance_loss: 0.0886, weighted_loss: 0.0516, label: 0, bag_size: 729


class 0 clustering acc 0.9926470588235294: correct 16875/17000
class 1 clustering acc 0.3458823529411765: correct 1176/3400
Epoch: 16, train_loss: 0.4438, train_clustering_loss:  0.3247, train_error: 0.1576
class 0: acc 0.8974358974358975, correct 70/78
class 1: acc 0.6777777777777778, correct 61/90
class 2: acc 0.7586206896551724, correct 66/87
class 3: acc 0.9642857142857143, correct 81/84
class 4: acc 0.9302325581395349, correct 80/86

Val Set, val_loss: 1.0251, val_error: 0.3400, auc: 0.8515
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
Validation loss decreased (1.068555 --> 1.025139).  Saving model ...


batch 19, loss: 4.7801, instance_loss: 0.9273, weighted_loss: 3.6242, label: 1, bag_size: 651
batch 39, loss: 0.4150, instance_loss: 0.3617, weighted_loss: 0.3990, label: 1, bag_size: 399
batch 59, loss: 0.0933, instance_loss: 0.2445, weighted_loss: 0.1387, label: 1, bag_size: 938
batch 79, loss: 0.0197, instance_loss: 0.3514, weighted_loss: 0.1192, label: 3, bag_size: 706
batch 99, loss: 0.0661, instance_loss: 0.3091, weighted_loss: 0.1390, label: 1, bag_size: 1426
batch 119, loss: 0.1274, instance_loss: 0.5041, weighted_loss: 0.2404, label: 1, bag_size: 1152
batch 139, loss: 0.7812, instance_loss: 0.5713, weighted_loss: 0.7182, label: 4, bag_size: 511
batch 159, loss: 0.0015, instance_loss: 0.0579, weighted_loss: 0.0184, label: 4, bag_size: 729
batch 179, loss: 1.4229, instance_loss: 0.7130, weighted_loss: 1.2100, label: 0, bag_size: 1065
batch 199, loss: 0.2703, instance_loss: 0.4035, weighted_loss: 0.3102, label: 4, bag_size: 1360
batch 219, loss: 1.3333, instance_loss: 0.3879, weighted_loss: 1.0497, label: 0, bag_size: 245
batch 239, loss: 0.0496, instance_loss: 0.0993, weighted_loss: 0.0645, label: 0, bag_size: 1012
batch 259, loss: 1.0317, instance_loss: 0.4802, weighted_loss: 0.8662, label: 1, bag_size: 887
batch 279, loss: 0.0496, instance_loss: 0.3266, weighted_loss: 0.1327, label: 4, bag_size: 1176
batch 299, loss: 0.0136, instance_loss: 0.0371, weighted_loss: 0.0206, label: 0, bag_size: 898
batch 319, loss: 0.5972, instance_loss: 0.2889, weighted_loss: 0.5047, label: 0, bag_size: 294
batch 339, loss: 0.0043, instance_loss: 0.2851, weighted_loss: 0.0886, label: 4, bag_size: 729
batch 359, loss: 0.1504, instance_loss: 0.5556, weighted_loss: 0.2720, label: 4, bag_size: 366
batch 379, loss: 0.1091, instance_loss: 0.2879, weighted_loss: 0.1628, label: 4, bag_size: 1360
batch 399, loss: 0.0589, instance_loss: 0.2261, weighted_loss: 0.1091, label: 1, bag_size: 938
batch 419, loss: 0.7686, instance_loss: 0.4346, weighted_loss: 0.6684, label: 2, bag_size: 373


class 0 clustering acc 0.9885294117647059: correct 16805/17000
class 1 clustering acc 0.3761764705882353: correct 1279/3400
Epoch: 17, train_loss: 0.4596, train_clustering_loss:  0.3282, train_error: 0.1529
class 0: acc 0.9024390243902439, correct 74/82
class 1: acc 0.654320987654321, correct 53/81
class 2: acc 0.7263157894736842, correct 69/95
class 3: acc 0.9753086419753086, correct 79/81
class 4: acc 0.9883720930232558, correct 85/86

Val Set, val_loss: 1.0807, val_error: 0.3000, auc: 0.8522
class 0 clustering acc 0.9905: correct 1981/2000
class 1 clustering acc 0.1675: correct 67/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.9047619047619048, correct 19/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0263, instance_loss: 0.1192, weighted_loss: 0.0542, label: 3, bag_size: 729
batch 39, loss: 0.1468, instance_loss: 0.3143, weighted_loss: 0.1971, label: 4, bag_size: 656
batch 59, loss: 0.0607, instance_loss: 0.4629, weighted_loss: 0.1814, label: 3, bag_size: 706
batch 79, loss: 0.3934, instance_loss: 0.3168, weighted_loss: 0.3704, label: 2, bag_size: 632
batch 99, loss: 1.7253, instance_loss: 0.5658, weighted_loss: 1.3774, label: 1, bag_size: 435
batch 119, loss: 0.0203, instance_loss: 0.0804, weighted_loss: 0.0383, label: 4, bag_size: 729
batch 139, loss: 0.0532, instance_loss: 0.0650, weighted_loss: 0.0567, label: 0, bag_size: 616
batch 159, loss: 0.2454, instance_loss: 0.2145, weighted_loss: 0.2361, label: 2, bag_size: 323
batch 179, loss: 0.5272, instance_loss: 0.4621, weighted_loss: 0.5076, label: 3, bag_size: 936
batch 199, loss: 0.5700, instance_loss: 0.3282, weighted_loss: 0.4975, label: 0, bag_size: 1527
batch 219, loss: 1.3846, instance_loss: 0.7199, weighted_loss: 1.1852, label: 1, bag_size: 1390
batch 239, loss: 0.0009, instance_loss: 0.0658, weighted_loss: 0.0203, label: 4, bag_size: 729
batch 259, loss: 0.3497, instance_loss: 0.3054, weighted_loss: 0.3364, label: 2, bag_size: 1281
batch 279, loss: 0.1426, instance_loss: 0.5077, weighted_loss: 0.2522, label: 1, bag_size: 1390
batch 299, loss: 0.0932, instance_loss: 0.0866, weighted_loss: 0.0912, label: 0, bag_size: 1034
batch 319, loss: 0.1807, instance_loss: 0.1045, weighted_loss: 0.1578, label: 3, bag_size: 952
batch 339, loss: 0.7764, instance_loss: 0.5816, weighted_loss: 0.7180, label: 2, bag_size: 878
batch 359, loss: 0.4299, instance_loss: 0.3613, weighted_loss: 0.4093, label: 2, bag_size: 632
batch 379, loss: 0.3881, instance_loss: 0.5103, weighted_loss: 0.4248, label: 3, bag_size: 360
batch 399, loss: 0.6844, instance_loss: 0.5579, weighted_loss: 0.6465, label: 3, bag_size: 283
batch 419, loss: 0.3406, instance_loss: 0.4487, weighted_loss: 0.3731, label: 4, bag_size: 366


class 0 clustering acc 0.987: correct 16779/17000
class 1 clustering acc 0.38323529411764706: correct 1303/3400
Epoch: 18, train_loss: 0.4776, train_clustering_loss:  0.3385, train_error: 0.1671
class 0: acc 0.9113924050632911, correct 72/79
class 1: acc 0.6292134831460674, correct 56/89
class 2: acc 0.6951219512195121, correct 57/82
class 3: acc 0.9431818181818182, correct 83/88
class 4: acc 0.9885057471264368, correct 86/87

Val Set, val_loss: 1.1127, val_error: 0.3400, auc: 0.8553
class 0 clustering acc 0.9915: correct 1983/2000
class 1 clustering acc 0.1475: correct 59/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7154, instance_loss: 0.4130, weighted_loss: 0.6247, label: 0, bag_size: 432
batch 39, loss: 0.4826, instance_loss: 0.3462, weighted_loss: 0.4417, label: 2, bag_size: 1039
batch 59, loss: 1.0019, instance_loss: 0.4162, weighted_loss: 0.8262, label: 0, bag_size: 245
batch 79, loss: 0.3478, instance_loss: 0.3930, weighted_loss: 0.3614, label: 2, bag_size: 1242
batch 99, loss: 0.4057, instance_loss: 0.2938, weighted_loss: 0.3721, label: 0, bag_size: 736
batch 119, loss: 0.0161, instance_loss: 0.0315, weighted_loss: 0.0207, label: 0, bag_size: 616
batch 139, loss: 0.0483, instance_loss: 0.2187, weighted_loss: 0.0994, label: 4, bag_size: 1176
batch 159, loss: 0.0176, instance_loss: 0.4033, weighted_loss: 0.1333, label: 3, bag_size: 706
batch 179, loss: 0.7311, instance_loss: 0.6824, weighted_loss: 0.7165, label: 2, bag_size: 518
batch 199, loss: 0.0167, instance_loss: 0.1364, weighted_loss: 0.0526, label: 4, bag_size: 1235
batch 219, loss: 0.0323, instance_loss: 0.5083, weighted_loss: 0.1751, label: 4, bag_size: 663
batch 239, loss: 0.4996, instance_loss: 0.3129, weighted_loss: 0.4436, label: 2, bag_size: 1404
batch 259, loss: 1.1472, instance_loss: 0.4092, weighted_loss: 0.9258, label: 0, bag_size: 1289
batch 279, loss: 0.4214, instance_loss: 0.2893, weighted_loss: 0.3818, label: 2, bag_size: 907
batch 299, loss: 0.0102, instance_loss: 0.4061, weighted_loss: 0.1289, label: 4, bag_size: 754
batch 319, loss: 0.0484, instance_loss: 0.2402, weighted_loss: 0.1059, label: 4, bag_size: 656
batch 339, loss: 0.0458, instance_loss: 0.1676, weighted_loss: 0.0823, label: 3, bag_size: 1253
batch 359, loss: 0.1541, instance_loss: 0.3223, weighted_loss: 0.2046, label: 4, bag_size: 656
batch 379, loss: 0.0318, instance_loss: 0.4515, weighted_loss: 0.1577, label: 3, bag_size: 706
batch 399, loss: 0.1062, instance_loss: 0.1205, weighted_loss: 0.1105, label: 3, bag_size: 556
batch 419, loss: 0.9380, instance_loss: 0.4808, weighted_loss: 0.8009, label: 2, bag_size: 1289


class 0 clustering acc 0.9904117647058823: correct 16837/17000
class 1 clustering acc 0.37411764705882355: correct 1272/3400
Epoch: 19, train_loss: 0.4441, train_clustering_loss:  0.3276, train_error: 0.1788
class 0: acc 0.9333333333333333, correct 84/90
class 1: acc 0.6764705882352942, correct 69/102
class 2: acc 0.691358024691358, correct 56/81
class 3: acc 0.8875, correct 71/80
class 4: acc 0.9583333333333334, correct 69/72

Val Set, val_loss: 1.1140, val_error: 0.3400, auc: 0.8642
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.18: correct 72/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4246, instance_loss: 0.2469, weighted_loss: 1.0713, label: 0, bag_size: 729
batch 39, loss: 0.2799, instance_loss: 0.3125, weighted_loss: 0.2897, label: 2, bag_size: 499
batch 59, loss: 0.0199, instance_loss: 0.0922, weighted_loss: 0.0416, label: 3, bag_size: 729
batch 79, loss: 0.0097, instance_loss: 0.3714, weighted_loss: 0.1182, label: 4, bag_size: 1235
batch 99, loss: 0.4168, instance_loss: 0.7741, weighted_loss: 0.5240, label: 1, bag_size: 867
batch 119, loss: 0.0993, instance_loss: 0.5259, weighted_loss: 0.2273, label: 3, bag_size: 360
batch 139, loss: 0.0828, instance_loss: 0.3114, weighted_loss: 0.1514, label: 4, bag_size: 928
batch 159, loss: 0.2397, instance_loss: 0.2314, weighted_loss: 0.2372, label: 2, bag_size: 355
batch 179, loss: 0.4170, instance_loss: 0.2940, weighted_loss: 0.3801, label: 2, bag_size: 1039
batch 199, loss: 0.4822, instance_loss: 0.3130, weighted_loss: 0.4314, label: 1, bag_size: 1049
batch 219, loss: 0.2733, instance_loss: 0.3133, weighted_loss: 0.2853, label: 0, bag_size: 350
batch 239, loss: 0.3469, instance_loss: 0.4569, weighted_loss: 0.3799, label: 3, bag_size: 841
batch 259, loss: 0.6278, instance_loss: 0.4950, weighted_loss: 0.5879, label: 2, bag_size: 943
batch 279, loss: 0.4267, instance_loss: 0.5839, weighted_loss: 0.4739, label: 4, bag_size: 1331
batch 299, loss: 1.2534, instance_loss: 0.1083, weighted_loss: 0.9099, label: 4, bag_size: 764
batch 319, loss: 0.2494, instance_loss: 0.5403, weighted_loss: 0.3366, label: 3, bag_size: 671
batch 339, loss: 1.4647, instance_loss: 0.5309, weighted_loss: 1.1845, label: 4, bag_size: 663
batch 359, loss: 2.0164, instance_loss: 0.5633, weighted_loss: 1.5805, label: 2, bag_size: 1006
batch 379, loss: 0.2479, instance_loss: 0.3528, weighted_loss: 0.2794, label: 0, bag_size: 653
batch 399, loss: 1.9200, instance_loss: 0.7546, weighted_loss: 1.5703, label: 1, bag_size: 446
batch 419, loss: 0.1215, instance_loss: 0.2274, weighted_loss: 0.1533, label: 2, bag_size: 286


class 0 clustering acc 0.9902941176470588: correct 16835/17000
class 1 clustering acc 0.3885294117647059: correct 1321/3400
Epoch: 20, train_loss: 0.3699, train_clustering_loss:  0.3127, train_error: 0.1082
class 0: acc 0.9368421052631579, correct 89/95
class 1: acc 0.76, correct 57/75
class 2: acc 0.8021978021978022, correct 73/91
class 3: acc 0.9868421052631579, correct 75/76
class 4: acc 0.9659090909090909, correct 85/88

Val Set, val_loss: 1.1203, val_error: 0.3200, auc: 0.8430
class 0 clustering acc 0.9945: correct 1989/2000
class 1 clustering acc 0.1925: correct 77/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.9047619047619048, correct 19/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2524, instance_loss: 0.5723, weighted_loss: 0.3484, label: 3, bag_size: 200
batch 39, loss: 0.0600, instance_loss: 0.1053, weighted_loss: 0.0736, label: 4, bag_size: 729
batch 59, loss: 0.1833, instance_loss: 0.2843, weighted_loss: 0.2136, label: 4, bag_size: 928
batch 79, loss: 0.0475, instance_loss: 0.0951, weighted_loss: 0.0618, label: 0, bag_size: 338
batch 99, loss: 1.6157, instance_loss: 0.5824, weighted_loss: 1.3057, label: 1, bag_size: 887
batch 119, loss: 0.2431, instance_loss: 0.3691, weighted_loss: 0.2809, label: 0, bag_size: 1086
batch 139, loss: 0.0177, instance_loss: 0.0912, weighted_loss: 0.0398, label: 3, bag_size: 1172
batch 159, loss: 0.3844, instance_loss: 0.2762, weighted_loss: 0.3520, label: 0, bag_size: 410
batch 179, loss: 0.3270, instance_loss: 0.3728, weighted_loss: 0.3407, label: 2, bag_size: 1700
batch 199, loss: 0.0429, instance_loss: 0.2092, weighted_loss: 0.0928, label: 3, bag_size: 821
batch 219, loss: 0.0195, instance_loss: 0.1412, weighted_loss: 0.0560, label: 0, bag_size: 976
batch 239, loss: 0.0283, instance_loss: 0.0828, weighted_loss: 0.0446, label: 3, bag_size: 729
batch 259, loss: 0.5058, instance_loss: 0.3764, weighted_loss: 0.4670, label: 2, bag_size: 883
batch 279, loss: 1.7554, instance_loss: 0.5350, weighted_loss: 1.3893, label: 1, bag_size: 1014
batch 299, loss: 0.0628, instance_loss: 0.5744, weighted_loss: 0.2163, label: 3, bag_size: 281
batch 319, loss: 0.0405, instance_loss: 0.0773, weighted_loss: 0.0515, label: 0, bag_size: 552
batch 339, loss: 0.0225, instance_loss: 0.2622, weighted_loss: 0.0944, label: 4, bag_size: 354
batch 359, loss: 0.0186, instance_loss: 0.0430, weighted_loss: 0.0259, label: 3, bag_size: 729
batch 379, loss: 0.2503, instance_loss: 0.2874, weighted_loss: 0.2614, label: 2, bag_size: 499
batch 399, loss: 0.0138, instance_loss: 0.1377, weighted_loss: 0.0510, label: 3, bag_size: 1253
batch 419, loss: 0.0370, instance_loss: 0.3300, weighted_loss: 0.1249, label: 1, bag_size: 318


class 0 clustering acc 0.9914705882352941: correct 16855/17000
class 1 clustering acc 0.415: correct 1411/3400
Epoch: 21, train_loss: 0.3378, train_clustering_loss:  0.3000, train_error: 0.1247
class 0: acc 0.9625, correct 77/80
class 1: acc 0.7126436781609196, correct 62/87
class 2: acc 0.75, correct 60/80
class 3: acc 0.9583333333333334, correct 92/96
class 4: acc 0.9878048780487805, correct 81/82

Val Set, val_loss: 1.1297, val_error: 0.3000, auc: 0.8558
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0206, instance_loss: 0.1599, weighted_loss: 0.0624, label: 3, bag_size: 821
batch 39, loss: 0.0043, instance_loss: 0.1690, weighted_loss: 0.0537, label: 3, bag_size: 729
batch 59, loss: 0.0873, instance_loss: 0.4951, weighted_loss: 0.2096, label: 3, bag_size: 1250
batch 79, loss: 0.3357, instance_loss: 0.6217, weighted_loss: 0.4215, label: 2, bag_size: 1410
batch 99, loss: 0.6821, instance_loss: 0.5504, weighted_loss: 0.6426, label: 1, bag_size: 700
batch 119, loss: 0.0492, instance_loss: 0.1967, weighted_loss: 0.0934, label: 3, bag_size: 729
batch 139, loss: 0.0069, instance_loss: 0.2916, weighted_loss: 0.0923, label: 4, bag_size: 297
batch 159, loss: 0.0271, instance_loss: 0.1398, weighted_loss: 0.0609, label: 0, bag_size: 729
batch 179, loss: 0.2716, instance_loss: 0.4658, weighted_loss: 0.3298, label: 1, bag_size: 925
batch 199, loss: 0.0009, instance_loss: 0.0537, weighted_loss: 0.0167, label: 4, bag_size: 729
batch 219, loss: 0.0314, instance_loss: 0.1805, weighted_loss: 0.0761, label: 0, bag_size: 1101
batch 239, loss: 0.0779, instance_loss: 0.1337, weighted_loss: 0.0946, label: 3, bag_size: 316
batch 259, loss: 0.1680, instance_loss: 0.2435, weighted_loss: 0.1906, label: 2, bag_size: 913
batch 279, loss: 0.3013, instance_loss: 0.3861, weighted_loss: 0.3267, label: 0, bag_size: 1086
batch 299, loss: 0.0903, instance_loss: 0.3618, weighted_loss: 0.1718, label: 4, bag_size: 1331
batch 319, loss: 0.0363, instance_loss: 0.1769, weighted_loss: 0.0785, label: 4, bag_size: 1278
batch 339, loss: 0.2156, instance_loss: 0.2389, weighted_loss: 0.2226, label: 2, bag_size: 314
batch 359, loss: 0.1820, instance_loss: 0.1908, weighted_loss: 0.1847, label: 0, bag_size: 1065
batch 379, loss: 0.0426, instance_loss: 0.0642, weighted_loss: 0.0491, label: 0, bag_size: 1012
batch 399, loss: 0.4261, instance_loss: 0.3534, weighted_loss: 0.4043, label: 0, bag_size: 350
batch 419, loss: 0.0073, instance_loss: 0.4195, weighted_loss: 0.1310, label: 3, bag_size: 791


class 0 clustering acc 0.9876470588235294: correct 16790/17000
class 1 clustering acc 0.4626470588235294: correct 1573/3400
Epoch: 22, train_loss: 0.3776, train_clustering_loss:  0.2946, train_error: 0.1271
class 0: acc 0.9238095238095239, correct 97/105
class 1: acc 0.71875, correct 46/64
class 2: acc 0.7303370786516854, correct 65/89
class 3: acc 0.9726027397260274, correct 71/73
class 4: acc 0.9787234042553191, correct 92/94

Val Set, val_loss: 1.1845, val_error: 0.3400, auc: 0.8300
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.2425: correct 97/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.9047619047619048, correct 19/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8040, instance_loss: 0.3847, weighted_loss: 0.6782, label: 0, bag_size: 350
batch 39, loss: 0.0646, instance_loss: 0.5267, weighted_loss: 0.2032, label: 3, bag_size: 630
batch 59, loss: 0.0064, instance_loss: 0.2688, weighted_loss: 0.0851, label: 4, bag_size: 947
batch 79, loss: 0.0323, instance_loss: 0.2628, weighted_loss: 0.1014, label: 4, bag_size: 1278
batch 99, loss: 0.0124, instance_loss: 0.0427, weighted_loss: 0.0215, label: 3, bag_size: 729
batch 119, loss: 0.0055, instance_loss: 0.0298, weighted_loss: 0.0128, label: 4, bag_size: 764
batch 139, loss: 2.5154, instance_loss: 0.7399, weighted_loss: 1.9827, label: 2, bag_size: 194
batch 159, loss: 0.6623, instance_loss: 0.3543, weighted_loss: 0.5699, label: 0, bag_size: 912
batch 179, loss: 0.1502, instance_loss: 0.1971, weighted_loss: 0.1643, label: 2, bag_size: 1019
batch 199, loss: 0.3676, instance_loss: 0.2504, weighted_loss: 0.3324, label: 2, bag_size: 935
batch 219, loss: 0.2162, instance_loss: 0.3249, weighted_loss: 0.2488, label: 2, bag_size: 567
batch 239, loss: 0.8052, instance_loss: 0.4060, weighted_loss: 0.6855, label: 1, bag_size: 711
batch 259, loss: 1.6974, instance_loss: 0.6821, weighted_loss: 1.3928, label: 2, bag_size: 324
batch 279, loss: 0.1238, instance_loss: 0.2956, weighted_loss: 0.1753, label: 1, bag_size: 504
batch 299, loss: 0.1877, instance_loss: 0.2785, weighted_loss: 0.2150, label: 0, bag_size: 801
batch 319, loss: 0.1713, instance_loss: 0.2564, weighted_loss: 0.1969, label: 2, bag_size: 758
batch 339, loss: 1.4278, instance_loss: 0.6343, weighted_loss: 1.1897, label: 1, bag_size: 838
batch 359, loss: 0.0512, instance_loss: 0.1183, weighted_loss: 0.0713, label: 3, bag_size: 729
batch 379, loss: 0.0286, instance_loss: 0.0603, weighted_loss: 0.0381, label: 3, bag_size: 556
batch 399, loss: 0.0001, instance_loss: 0.0328, weighted_loss: 0.0099, label: 4, bag_size: 729
batch 419, loss: 1.2447, instance_loss: 0.5900, weighted_loss: 1.0483, label: 1, bag_size: 446


class 0 clustering acc 0.9899411764705882: correct 16829/17000
class 1 clustering acc 0.4026470588235294: correct 1369/3400
Epoch: 23, train_loss: 0.3352, train_clustering_loss:  0.3189, train_error: 0.1176
class 0: acc 0.9358974358974359, correct 73/78
class 1: acc 0.7282608695652174, correct 67/92
class 2: acc 0.8125, correct 65/80
class 3: acc 0.9574468085106383, correct 90/94
class 4: acc 0.9876543209876543, correct 80/81

Val Set, val_loss: 1.2369, val_error: 0.3400, auc: 0.8327
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.175: correct 70/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2415, instance_loss: 0.7000, weighted_loss: 0.3790, label: 3, bag_size: 211
batch 39, loss: 0.0190, instance_loss: 0.1490, weighted_loss: 0.0580, label: 3, bag_size: 1291
batch 59, loss: 0.0087, instance_loss: 0.3232, weighted_loss: 0.1030, label: 3, bag_size: 841
batch 79, loss: 0.1601, instance_loss: 0.2879, weighted_loss: 0.1984, label: 0, bag_size: 381
batch 99, loss: 0.7324, instance_loss: 0.6050, weighted_loss: 0.6942, label: 2, bag_size: 741
batch 119, loss: 0.2250, instance_loss: 0.2268, weighted_loss: 0.2255, label: 1, bag_size: 834
batch 139, loss: 0.1498, instance_loss: 0.2860, weighted_loss: 0.1907, label: 2, bag_size: 358
batch 159, loss: 3.2062, instance_loss: 0.8123, weighted_loss: 2.4880, label: 1, bag_size: 435
batch 179, loss: 0.0075, instance_loss: 0.4154, weighted_loss: 0.1299, label: 3, bag_size: 841
batch 199, loss: 0.3025, instance_loss: 0.2503, weighted_loss: 0.2868, label: 0, bag_size: 294
batch 219, loss: 0.0011, instance_loss: 0.1404, weighted_loss: 0.0429, label: 4, bag_size: 729
batch 239, loss: 0.1331, instance_loss: 0.6587, weighted_loss: 0.2908, label: 3, bag_size: 211
batch 259, loss: 0.5207, instance_loss: 0.4164, weighted_loss: 0.4894, label: 1, bag_size: 868
batch 279, loss: 0.1116, instance_loss: 0.2317, weighted_loss: 0.1476, label: 3, bag_size: 936
batch 299, loss: 0.0227, instance_loss: 0.1649, weighted_loss: 0.0654, label: 3, bag_size: 1291
batch 319, loss: 0.0240, instance_loss: 0.0722, weighted_loss: 0.0384, label: 0, bag_size: 1018
batch 339, loss: 0.0040, instance_loss: 0.1513, weighted_loss: 0.0482, label: 4, bag_size: 729
batch 359, loss: 0.0425, instance_loss: 0.1103, weighted_loss: 0.0628, label: 3, bag_size: 729
batch 379, loss: 1.3747, instance_loss: 0.4641, weighted_loss: 1.1015, label: 1, bag_size: 1014
batch 399, loss: 0.8234, instance_loss: 0.4977, weighted_loss: 0.7257, label: 2, bag_size: 384
batch 419, loss: 0.0139, instance_loss: 0.3272, weighted_loss: 0.1079, label: 4, bag_size: 754


class 0 clustering acc 0.9907058823529412: correct 16842/17000
class 1 clustering acc 0.40794117647058825: correct 1387/3400
Epoch: 24, train_loss: 0.3711, train_clustering_loss:  0.3101, train_error: 0.1318
class 0: acc 0.927710843373494, correct 77/83
class 1: acc 0.7435897435897436, correct 58/78
class 2: acc 0.7241379310344828, correct 63/87
class 3: acc 0.9534883720930233, correct 82/86
class 4: acc 0.978021978021978, correct 89/91

Val Set, val_loss: 1.1383, val_error: 0.3400, auc: 0.8386
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.2075: correct 83/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0213, instance_loss: 0.3572, weighted_loss: 0.1221, label: 4, bag_size: 754
batch 39, loss: 0.0117, instance_loss: 0.0510, weighted_loss: 0.0235, label: 3, bag_size: 1172
batch 59, loss: 0.1800, instance_loss: 0.1543, weighted_loss: 0.1722, label: 0, bag_size: 340
batch 79, loss: 0.2507, instance_loss: 0.5145, weighted_loss: 0.3298, label: 3, bag_size: 200
batch 99, loss: 0.4556, instance_loss: 0.2492, weighted_loss: 0.3937, label: 1, bag_size: 1402
batch 119, loss: 0.0106, instance_loss: 0.5808, weighted_loss: 0.1816, label: 3, bag_size: 1167
batch 139, loss: 0.0366, instance_loss: 0.2172, weighted_loss: 0.0908, label: 4, bag_size: 882
batch 159, loss: 0.5841, instance_loss: 0.6193, weighted_loss: 0.5946, label: 1, bag_size: 968
batch 179, loss: 0.0092, instance_loss: 0.2123, weighted_loss: 0.0701, label: 4, bag_size: 711
batch 199, loss: 0.0196, instance_loss: 0.1069, weighted_loss: 0.0458, label: 0, bag_size: 1018
batch 219, loss: 0.0035, instance_loss: 0.0411, weighted_loss: 0.0148, label: 3, bag_size: 405
batch 239, loss: 0.0060, instance_loss: 0.0374, weighted_loss: 0.0154, label: 0, bag_size: 360
batch 259, loss: 0.2405, instance_loss: 0.2966, weighted_loss: 0.2573, label: 0, bag_size: 1332
batch 279, loss: 0.0218, instance_loss: 0.0671, weighted_loss: 0.0354, label: 0, bag_size: 760
batch 299, loss: 0.0011, instance_loss: 0.0692, weighted_loss: 0.0215, label: 3, bag_size: 729
batch 319, loss: 0.0164, instance_loss: 0.3201, weighted_loss: 0.1075, label: 0, bag_size: 729
batch 339, loss: 0.0512, instance_loss: 0.1983, weighted_loss: 0.0953, label: 3, bag_size: 936
batch 359, loss: 0.0116, instance_loss: 0.0529, weighted_loss: 0.0240, label: 0, bag_size: 402
batch 379, loss: 0.0174, instance_loss: 0.2002, weighted_loss: 0.0722, label: 0, bag_size: 729
batch 399, loss: 0.3449, instance_loss: 0.3500, weighted_loss: 0.3464, label: 1, bag_size: 533
batch 419, loss: 0.5256, instance_loss: 0.3791, weighted_loss: 0.4817, label: 3, bag_size: 281


class 0 clustering acc 0.9888235294117647: correct 16810/17000
class 1 clustering acc 0.3714705882352941: correct 1263/3400
Epoch: 25, train_loss: 0.3482, train_clustering_loss:  0.3336, train_error: 0.1388
class 0: acc 0.9540229885057471, correct 83/87
class 1: acc 0.7608695652173914, correct 70/92
class 2: acc 0.6538461538461539, correct 51/78
class 3: acc 0.9375, correct 90/96
class 4: acc 1.0, correct 72/72

Val Set, val_loss: 1.1409, val_error: 0.2800, auc: 0.8374
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.19: correct 76/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.9047619047619048, correct 19/21
class 3: acc 0.5, correct 3/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.4988, instance_loss: 0.5104, weighted_loss: 0.5023, label: 1, bag_size: 968
batch 39, loss: 0.0700, instance_loss: 0.3042, weighted_loss: 0.1403, label: 4, bag_size: 656
batch 59, loss: 0.3274, instance_loss: 0.4735, weighted_loss: 0.3712, label: 1, bag_size: 875
batch 79, loss: 0.2055, instance_loss: 0.4666, weighted_loss: 0.2839, label: 2, bag_size: 518
batch 99, loss: 4.3973, instance_loss: 0.9371, weighted_loss: 3.3592, label: 0, bag_size: 466
batch 119, loss: 0.6590, instance_loss: 0.4445, weighted_loss: 0.5946, label: 3, bag_size: 283
batch 139, loss: 3.2395, instance_loss: 0.8044, weighted_loss: 2.5090, label: 1, bag_size: 269
batch 159, loss: 0.4824, instance_loss: 0.4610, weighted_loss: 0.4760, label: 0, bag_size: 1289
batch 179, loss: 0.6845, instance_loss: 0.5074, weighted_loss: 0.6314, label: 0, bag_size: 1190
batch 199, loss: 0.0587, instance_loss: 0.2131, weighted_loss: 0.1050, label: 1, bag_size: 866
batch 219, loss: 0.0016, instance_loss: 0.0477, weighted_loss: 0.0154, label: 3, bag_size: 729
batch 239, loss: 0.0023, instance_loss: 0.2717, weighted_loss: 0.0831, label: 3, bag_size: 841
batch 259, loss: 0.1725, instance_loss: 0.3348, weighted_loss: 0.2212, label: 1, bag_size: 1080
batch 279, loss: 0.1121, instance_loss: 0.1693, weighted_loss: 0.1292, label: 0, bag_size: 515
batch 299, loss: 0.9514, instance_loss: 0.5534, weighted_loss: 0.8320, label: 4, bag_size: 511
batch 319, loss: 0.1929, instance_loss: 0.3306, weighted_loss: 0.2342, label: 1, bag_size: 913
batch 339, loss: 0.0043, instance_loss: 0.0626, weighted_loss: 0.0218, label: 4, bag_size: 764
batch 359, loss: 0.0202, instance_loss: 0.1523, weighted_loss: 0.0599, label: 4, bag_size: 1474
batch 379, loss: 0.2051, instance_loss: 0.2408, weighted_loss: 0.2158, label: 2, bag_size: 286
batch 399, loss: 0.0476, instance_loss: 0.1321, weighted_loss: 0.0729, label: 0, bag_size: 338
batch 419, loss: 0.0234, instance_loss: 0.0533, weighted_loss: 0.0323, label: 3, bag_size: 1172


class 0 clustering acc 0.9895294117647059: correct 16822/17000
class 1 clustering acc 0.40705882352941175: correct 1384/3400
Epoch: 26, train_loss: 0.3508, train_clustering_loss:  0.3106, train_error: 0.1153
class 0: acc 0.9404761904761905, correct 79/84
class 1: acc 0.7195121951219512, correct 59/82
class 2: acc 0.7840909090909091, correct 69/88
class 3: acc 0.9787234042553191, correct 92/94
class 4: acc 1.0, correct 77/77

Val Set, val_loss: 1.0840, val_error: 0.3800, auc: 0.8469
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0266, instance_loss: 0.0891, weighted_loss: 0.0454, label: 0, bag_size: 729
batch 39, loss: 1.0129, instance_loss: 0.4001, weighted_loss: 0.8290, label: 1, bag_size: 1049
batch 59, loss: 0.1794, instance_loss: 0.3978, weighted_loss: 0.2449, label: 2, bag_size: 766
batch 79, loss: 0.0920, instance_loss: 0.4431, weighted_loss: 0.1973, label: 3, bag_size: 849
batch 99, loss: 0.1682, instance_loss: 0.3688, weighted_loss: 0.2284, label: 4, bag_size: 436
batch 119, loss: 0.0517, instance_loss: 0.1195, weighted_loss: 0.0721, label: 1, bag_size: 937
batch 139, loss: 0.0630, instance_loss: 0.3009, weighted_loss: 0.1344, label: 4, bag_size: 1331
batch 159, loss: 0.0088, instance_loss: 0.0359, weighted_loss: 0.0169, label: 0, bag_size: 382
batch 179, loss: 0.1897, instance_loss: 0.6037, weighted_loss: 0.3139, label: 1, bag_size: 1390
batch 199, loss: 0.6711, instance_loss: 0.4089, weighted_loss: 0.5924, label: 0, bag_size: 653
batch 219, loss: 0.3526, instance_loss: 0.2549, weighted_loss: 0.3233, label: 0, bag_size: 1289
batch 239, loss: 0.0163, instance_loss: 0.0619, weighted_loss: 0.0300, label: 0, bag_size: 515
batch 259, loss: 0.5446, instance_loss: 0.5190, weighted_loss: 0.5369, label: 1, bag_size: 139
batch 279, loss: 0.0095, instance_loss: 0.0972, weighted_loss: 0.0358, label: 4, bag_size: 1235
batch 299, loss: 0.0330, instance_loss: 0.7771, weighted_loss: 0.2562, label: 3, bag_size: 1167
batch 319, loss: 0.0175, instance_loss: 0.1697, weighted_loss: 0.0632, label: 0, bag_size: 729
batch 339, loss: 0.0453, instance_loss: 0.0421, weighted_loss: 0.0443, label: 4, bag_size: 764
batch 359, loss: 0.0404, instance_loss: 0.1526, weighted_loss: 0.0741, label: 3, bag_size: 729
batch 379, loss: 0.0394, instance_loss: 0.2903, weighted_loss: 0.1147, label: 3, bag_size: 936
batch 399, loss: 5.8649, instance_loss: 1.8658, weighted_loss: 4.6652, label: 2, bag_size: 1108
batch 419, loss: 0.2638, instance_loss: 0.4451, weighted_loss: 0.3182, label: 1, bag_size: 1152


class 0 clustering acc 0.9891764705882353: correct 16816/17000
class 1 clustering acc 0.40205882352941175: correct 1367/3400
Epoch: 27, train_loss: 0.3052, train_clustering_loss:  0.3144, train_error: 0.0941
class 0: acc 0.9655172413793104, correct 84/87
class 1: acc 0.7662337662337663, correct 59/77
class 2: acc 0.8, correct 68/85
class 3: acc 0.9885057471264368, correct 86/87
class 4: acc 0.9887640449438202, correct 88/89

Val Set, val_loss: 1.2654, val_error: 0.3200, auc: 0.8437
class 0 clustering acc 0.9915: correct 1983/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.9047619047619048, correct 19/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2598, instance_loss: 0.2122, weighted_loss: 0.2455, label: 4, bag_size: 826
batch 39, loss: 0.0103, instance_loss: 0.3660, weighted_loss: 0.1170, label: 3, bag_size: 791
batch 59, loss: 2.1538, instance_loss: 0.4967, weighted_loss: 1.6567, label: 0, bag_size: 466
batch 79, loss: 0.2131, instance_loss: 0.7591, weighted_loss: 0.3769, label: 1, bag_size: 747
batch 99, loss: 1.0352, instance_loss: 0.3551, weighted_loss: 0.8312, label: 0, bag_size: 729
batch 119, loss: 0.0793, instance_loss: 0.1315, weighted_loss: 0.0950, label: 1, bag_size: 937
batch 139, loss: 0.7086, instance_loss: 0.5517, weighted_loss: 0.6615, label: 4, bag_size: 511
batch 159, loss: 0.0594, instance_loss: 0.0915, weighted_loss: 0.0691, label: 0, bag_size: 476
batch 179, loss: 0.0018, instance_loss: 0.2305, weighted_loss: 0.0705, label: 4, bag_size: 947
batch 199, loss: 0.0157, instance_loss: 0.0614, weighted_loss: 0.0294, label: 0, bag_size: 729
batch 219, loss: 0.5236, instance_loss: 0.3687, weighted_loss: 0.4771, label: 1, bag_size: 1096
batch 239, loss: 0.1438, instance_loss: 0.4560, weighted_loss: 0.2375, label: 3, bag_size: 630
batch 259, loss: 0.0195, instance_loss: 0.0916, weighted_loss: 0.0412, label: 0, bag_size: 933
batch 279, loss: 0.0110, instance_loss: 0.0862, weighted_loss: 0.0336, label: 3, bag_size: 1253
batch 299, loss: 0.0244, instance_loss: 0.4331, weighted_loss: 0.1470, label: 1, bag_size: 1152
batch 319, loss: 0.1984, instance_loss: 0.2424, weighted_loss: 0.2116, label: 0, bag_size: 340
batch 339, loss: 0.1058, instance_loss: 0.4291, weighted_loss: 0.2028, label: 3, bag_size: 360
batch 359, loss: 0.0111, instance_loss: 0.3497, weighted_loss: 0.1127, label: 4, bag_size: 590
batch 379, loss: 0.0304, instance_loss: 0.4603, weighted_loss: 0.1593, label: 3, bag_size: 697
batch 399, loss: 0.1116, instance_loss: 0.2926, weighted_loss: 0.1659, label: 4, bag_size: 1360
batch 419, loss: 0.0016, instance_loss: 0.1235, weighted_loss: 0.0382, label: 3, bag_size: 729


class 0 clustering acc 0.9881176470588235: correct 16798/17000
class 1 clustering acc 0.40176470588235297: correct 1366/3400
Epoch: 28, train_loss: 0.3002, train_clustering_loss:  0.3165, train_error: 0.0894
class 0: acc 0.9418604651162791, correct 81/86
class 1: acc 0.8235294117647058, correct 70/85
class 2: acc 0.8255813953488372, correct 71/86
class 3: acc 0.96, correct 72/75
class 4: acc 1.0, correct 93/93

Val Set, val_loss: 1.2062, val_error: 0.3200, auc: 0.8544
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.1825: correct 73/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2211, instance_loss: 0.4502, weighted_loss: 0.2898, label: 3, bag_size: 360
batch 39, loss: 0.0076, instance_loss: 0.0425, weighted_loss: 0.0181, label: 0, bag_size: 239
batch 59, loss: 0.0481, instance_loss: 0.5460, weighted_loss: 0.1975, label: 4, bag_size: 974
batch 79, loss: 0.0011, instance_loss: 0.5719, weighted_loss: 0.1724, label: 4, bag_size: 663
batch 99, loss: 0.0101, instance_loss: 0.0389, weighted_loss: 0.0187, label: 0, bag_size: 1018
batch 119, loss: 0.1425, instance_loss: 0.3544, weighted_loss: 0.2060, label: 4, bag_size: 1360
batch 139, loss: 0.3866, instance_loss: 0.5390, weighted_loss: 0.4323, label: 1, bag_size: 700
batch 159, loss: 0.5053, instance_loss: 0.3014, weighted_loss: 0.4441, label: 1, bag_size: 1014
batch 179, loss: 0.6127, instance_loss: 0.6216, weighted_loss: 0.6154, label: 2, bag_size: 373
batch 199, loss: 0.0073, instance_loss: 0.0694, weighted_loss: 0.0260, label: 3, bag_size: 405
batch 219, loss: 1.4336, instance_loss: 0.5255, weighted_loss: 1.1612, label: 2, bag_size: 1289
batch 239, loss: 0.0072, instance_loss: 0.0571, weighted_loss: 0.0222, label: 4, bag_size: 764
batch 259, loss: 0.6338, instance_loss: 0.5786, weighted_loss: 0.6172, label: 1, bag_size: 405
batch 279, loss: 0.2338, instance_loss: 0.3329, weighted_loss: 0.2635, label: 2, bag_size: 405
batch 299, loss: 0.0067, instance_loss: 0.3942, weighted_loss: 0.1230, label: 1, bag_size: 318
batch 319, loss: 0.0038, instance_loss: 0.3082, weighted_loss: 0.0951, label: 4, bag_size: 754
batch 339, loss: 0.9889, instance_loss: 0.5708, weighted_loss: 0.8635, label: 1, bag_size: 446
batch 359, loss: 0.1033, instance_loss: 0.1910, weighted_loss: 0.1296, label: 1, bag_size: 1402
batch 379, loss: 0.0159, instance_loss: 0.3774, weighted_loss: 0.1243, label: 4, bag_size: 947
batch 399, loss: 1.7165, instance_loss: 0.4769, weighted_loss: 1.3446, label: 2, bag_size: 986
batch 419, loss: 0.0623, instance_loss: 0.2020, weighted_loss: 0.1042, label: 3, bag_size: 821


class 0 clustering acc 0.9894117647058823: correct 16820/17000
class 1 clustering acc 0.3708823529411765: correct 1261/3400
Epoch: 29, train_loss: 0.2686, train_clustering_loss:  0.3283, train_error: 0.0824
class 0: acc 0.9866666666666667, correct 74/75
class 1: acc 0.8315789473684211, correct 79/95
class 2: acc 0.8255813953488372, correct 71/86
class 3: acc 0.978494623655914, correct 91/93
class 4: acc 0.9868421052631579, correct 75/76

Val Set, val_loss: 1.2239, val_error: 0.3600, auc: 0.8567
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.1725: correct 69/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.8942, instance_loss: 0.6676, weighted_loss: 0.8262, label: 2, bag_size: 738
batch 39, loss: 0.0057, instance_loss: 0.3719, weighted_loss: 0.1156, label: 4, bag_size: 754
batch 59, loss: 0.0035, instance_loss: 0.1152, weighted_loss: 0.0370, label: 4, bag_size: 711
batch 79, loss: 0.5115, instance_loss: 0.5056, weighted_loss: 0.5097, label: 4, bag_size: 436
batch 99, loss: 0.1136, instance_loss: 0.2549, weighted_loss: 0.1560, label: 2, bag_size: 1281
batch 119, loss: 0.0153, instance_loss: 0.0716, weighted_loss: 0.0322, label: 1, bag_size: 286
batch 139, loss: 0.8943, instance_loss: 0.4936, weighted_loss: 0.7741, label: 2, bag_size: 323
batch 159, loss: 0.0002, instance_loss: 0.1047, weighted_loss: 0.0316, label: 4, bag_size: 729
batch 179, loss: 0.4047, instance_loss: 0.3726, weighted_loss: 0.3951, label: 1, bag_size: 348
batch 199, loss: 0.5705, instance_loss: 0.4011, weighted_loss: 0.5197, label: 2, bag_size: 204
batch 219, loss: 0.0098, instance_loss: 0.0646, weighted_loss: 0.0262, label: 0, bag_size: 1018
batch 239, loss: 0.0385, instance_loss: 0.2735, weighted_loss: 0.1090, label: 3, bag_size: 821
batch 259, loss: 0.0671, instance_loss: 0.2795, weighted_loss: 0.1308, label: 1, bag_size: 697
batch 279, loss: 0.0065, instance_loss: 0.0295, weighted_loss: 0.0134, label: 0, bag_size: 616
batch 299, loss: 0.1660, instance_loss: 0.3395, weighted_loss: 0.2180, label: 2, bag_size: 1215
batch 319, loss: 0.0127, instance_loss: 0.1220, weighted_loss: 0.0455, label: 0, bag_size: 524
batch 339, loss: 0.0001, instance_loss: 0.0226, weighted_loss: 0.0069, label: 4, bag_size: 729
batch 359, loss: 0.8349, instance_loss: 0.3822, weighted_loss: 0.6991, label: 0, bag_size: 466
batch 379, loss: 0.0406, instance_loss: 0.1574, weighted_loss: 0.0756, label: 4, bag_size: 1278
batch 399, loss: 0.0233, instance_loss: 0.2464, weighted_loss: 0.0902, label: 3, bag_size: 1118
batch 419, loss: 0.0043, instance_loss: 0.0327, weighted_loss: 0.0128, label: 0, bag_size: 239


class 0 clustering acc 0.9903529411764705: correct 16836/17000
class 1 clustering acc 0.46088235294117647: correct 1567/3400
Epoch: 30, train_loss: 0.2527, train_clustering_loss:  0.2850, train_error: 0.0918
class 0: acc 0.979381443298969, correct 95/97
class 1: acc 0.7710843373493976, correct 64/83
class 2: acc 0.76, correct 57/75
class 3: acc 1.0, correct 89/89
class 4: acc 1.0, correct 81/81

Val Set, val_loss: 1.3963, val_error: 0.4600, auc: 0.8176
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.17: correct 68/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0390, instance_loss: 0.1675, weighted_loss: 0.0775, label: 0, bag_size: 729
batch 39, loss: 0.1629, instance_loss: 0.2925, weighted_loss: 0.2018, label: 2, bag_size: 941
batch 59, loss: 0.0000, instance_loss: 0.0274, weighted_loss: 0.0082, label: 4, bag_size: 729
batch 79, loss: 0.3325, instance_loss: 0.4698, weighted_loss: 0.3737, label: 0, bag_size: 1527
batch 99, loss: 0.2660, instance_loss: 0.2808, weighted_loss: 0.2704, label: 0, bag_size: 736
batch 119, loss: 0.0145, instance_loss: 0.3660, weighted_loss: 0.1199, label: 4, bag_size: 625
batch 139, loss: 0.0102, instance_loss: 0.2273, weighted_loss: 0.0753, label: 4, bag_size: 1235
batch 159, loss: 0.6904, instance_loss: 0.3086, weighted_loss: 0.5759, label: 1, bag_size: 1402
batch 179, loss: 0.1540, instance_loss: 0.6918, weighted_loss: 0.3153, label: 1, bag_size: 269
batch 199, loss: 0.0443, instance_loss: 0.1511, weighted_loss: 0.0763, label: 0, bag_size: 437
batch 219, loss: 0.0212, instance_loss: 0.1051, weighted_loss: 0.0463, label: 3, bag_size: 729
batch 239, loss: 0.0046, instance_loss: 0.3530, weighted_loss: 0.1091, label: 3, bag_size: 706
batch 259, loss: 0.1494, instance_loss: 0.4441, weighted_loss: 0.2378, label: 2, bag_size: 766
batch 279, loss: 0.0223, instance_loss: 0.1311, weighted_loss: 0.0549, label: 3, bag_size: 821
batch 299, loss: 0.0030, instance_loss: 0.1453, weighted_loss: 0.0457, label: 1, bag_size: 847
batch 319, loss: 0.0173, instance_loss: 0.0342, weighted_loss: 0.0224, label: 3, bag_size: 1172
batch 339, loss: 0.2480, instance_loss: 0.3540, weighted_loss: 0.2798, label: 2, bag_size: 684
batch 359, loss: 0.0007, instance_loss: 0.2159, weighted_loss: 0.0653, label: 1, bag_size: 1376
batch 379, loss: 0.1764, instance_loss: 0.3371, weighted_loss: 0.2246, label: 2, bag_size: 395
batch 399, loss: 0.0013, instance_loss: 0.2918, weighted_loss: 0.0884, label: 4, bag_size: 947
batch 419, loss: 0.1387, instance_loss: 0.2440, weighted_loss: 0.1703, label: 2, bag_size: 323


class 0 clustering acc 0.9875294117647059: correct 16788/17000
class 1 clustering acc 0.4011764705882353: correct 1364/3400
Epoch: 31, train_loss: 0.2642, train_clustering_loss:  0.3171, train_error: 0.0894
class 0: acc 0.9534883720930233, correct 82/86
class 1: acc 0.7738095238095238, correct 65/84
class 2: acc 0.8470588235294118, correct 72/85
class 3: acc 0.9880952380952381, correct 83/84
class 4: acc 0.9883720930232558, correct 85/86

Val Set, val_loss: 1.2289, val_error: 0.3400, auc: 0.8460
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.9047619047619048, correct 19/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0003, instance_loss: 0.2125, weighted_loss: 0.0640, label: 4, bag_size: 354
batch 39, loss: 0.0278, instance_loss: 0.1866, weighted_loss: 0.0754, label: 2, bag_size: 222
batch 59, loss: 0.0047, instance_loss: 0.0929, weighted_loss: 0.0312, label: 3, bag_size: 405
batch 79, loss: 0.0000, instance_loss: 0.0678, weighted_loss: 0.0204, label: 4, bag_size: 729
batch 99, loss: 0.0112, instance_loss: 0.3614, weighted_loss: 0.1163, label: 3, bag_size: 697
batch 119, loss: 0.0027, instance_loss: 0.0368, weighted_loss: 0.0129, label: 3, bag_size: 405
batch 139, loss: 0.0239, instance_loss: 0.2617, weighted_loss: 0.0952, label: 0, bag_size: 729
batch 159, loss: 0.0004, instance_loss: 0.0443, weighted_loss: 0.0136, label: 3, bag_size: 729
batch 179, loss: 0.2359, instance_loss: 0.2910, weighted_loss: 0.2524, label: 2, bag_size: 351
batch 199, loss: 0.0220, instance_loss: 0.1176, weighted_loss: 0.0507, label: 1, bag_size: 286
batch 219, loss: 0.5476, instance_loss: 0.5604, weighted_loss: 0.5514, label: 2, bag_size: 1058
batch 239, loss: 0.1837, instance_loss: 0.3640, weighted_loss: 0.2378, label: 1, bag_size: 847
batch 259, loss: 0.1070, instance_loss: 0.2496, weighted_loss: 0.1498, label: 2, bag_size: 252
batch 279, loss: 0.1726, instance_loss: 0.3639, weighted_loss: 0.2300, label: 2, bag_size: 247
batch 299, loss: 0.0670, instance_loss: 0.3129, weighted_loss: 0.1407, label: 4, bag_size: 974
batch 319, loss: 0.0430, instance_loss: 0.3384, weighted_loss: 0.1316, label: 4, bag_size: 947
batch 339, loss: 0.0029, instance_loss: 0.3031, weighted_loss: 0.0930, label: 1, bag_size: 1376
batch 359, loss: 0.0204, instance_loss: 0.0987, weighted_loss: 0.0439, label: 0, bag_size: 990
batch 379, loss: 0.0128, instance_loss: 0.5744, weighted_loss: 0.1813, label: 3, bag_size: 1167
batch 399, loss: 0.1607, instance_loss: 0.3185, weighted_loss: 0.2080, label: 2, bag_size: 567
batch 419, loss: 0.1476, instance_loss: 0.1818, weighted_loss: 0.1579, label: 0, bag_size: 294


class 0 clustering acc 0.9868235294117647: correct 16776/17000
class 1 clustering acc 0.45529411764705885: correct 1548/3400
Epoch: 32, train_loss: 0.2271, train_clustering_loss:  0.3002, train_error: 0.0588
class 0: acc 0.9696969696969697, correct 96/99
class 1: acc 0.7758620689655172, correct 45/58
class 2: acc 0.9294117647058824, correct 79/85
class 3: acc 0.9787234042553191, correct 92/94
class 4: acc 0.9887640449438202, correct 88/89

Val Set, val_loss: 1.2547, val_error: 0.3400, auc: 0.8396
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.9523809523809523, correct 20/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0039, instance_loss: 0.0784, weighted_loss: 0.0262, label: 3, bag_size: 1172
batch 39, loss: 0.0114, instance_loss: 0.0690, weighted_loss: 0.0287, label: 0, bag_size: 385
batch 59, loss: 0.0736, instance_loss: 0.1657, weighted_loss: 0.1013, label: 0, bag_size: 1872
batch 79, loss: 0.0244, instance_loss: 0.1858, weighted_loss: 0.0728, label: 1, bag_size: 369
batch 99, loss: 0.5056, instance_loss: 0.4885, weighted_loss: 0.5004, label: 1, bag_size: 470
batch 119, loss: 0.0938, instance_loss: 0.3704, weighted_loss: 0.1767, label: 4, bag_size: 1360
batch 139, loss: 0.9379, instance_loss: 0.6557, weighted_loss: 0.8532, label: 1, bag_size: 861
batch 159, loss: 0.0230, instance_loss: 0.1235, weighted_loss: 0.0532, label: 4, bag_size: 1474
batch 179, loss: 0.8302, instance_loss: 0.6789, weighted_loss: 0.7848, label: 1, bag_size: 1255
batch 199, loss: 0.0769, instance_loss: 0.4831, weighted_loss: 0.1987, label: 4, bag_size: 754
batch 219, loss: 0.9615, instance_loss: 0.7041, weighted_loss: 0.8843, label: 2, bag_size: 679
batch 239, loss: 0.1060, instance_loss: 0.3437, weighted_loss: 0.1773, label: 1, bag_size: 348
batch 259, loss: 0.0524, instance_loss: 0.1437, weighted_loss: 0.0798, label: 3, bag_size: 1291
batch 279, loss: 0.0012, instance_loss: 0.0781, weighted_loss: 0.0243, label: 4, bag_size: 636
batch 299, loss: 0.0000, instance_loss: 0.0654, weighted_loss: 0.0197, label: 4, bag_size: 729
batch 319, loss: 0.0095, instance_loss: 0.0968, weighted_loss: 0.0357, label: 4, bag_size: 826
batch 339, loss: 0.0173, instance_loss: 0.0620, weighted_loss: 0.0307, label: 0, bag_size: 729
batch 359, loss: 0.6718, instance_loss: 0.5169, weighted_loss: 0.6253, label: 3, bag_size: 283
batch 379, loss: 0.0057, instance_loss: 0.0483, weighted_loss: 0.0185, label: 4, bag_size: 524
batch 399, loss: 0.0653, instance_loss: 0.3155, weighted_loss: 0.1403, label: 4, bag_size: 1360
batch 419, loss: 0.0413, instance_loss: 0.2703, weighted_loss: 0.1100, label: 4, bag_size: 297


class 0 clustering acc 0.9884117647058823: correct 16803/17000
class 1 clustering acc 0.4497058823529412: correct 1529/3400
Epoch: 33, train_loss: 0.2145, train_clustering_loss:  0.2886, train_error: 0.0753
class 0: acc 0.9746835443037974, correct 77/79
class 1: acc 0.782051282051282, correct 61/78
class 2: acc 0.8636363636363636, correct 76/88
class 3: acc 0.9878048780487805, correct 81/82
class 4: acc 1.0, correct 98/98

Val Set, val_loss: 1.2303, val_error: 0.3800, auc: 0.8399
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.1925: correct 77/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0007, instance_loss: 0.1480, weighted_loss: 0.0449, label: 3, bag_size: 729
batch 39, loss: 0.1609, instance_loss: 0.5421, weighted_loss: 0.2752, label: 3, bag_size: 1380
batch 59, loss: 0.0134, instance_loss: 0.0350, weighted_loss: 0.0199, label: 3, bag_size: 952
batch 79, loss: 0.4454, instance_loss: 0.2991, weighted_loss: 0.4015, label: 2, bag_size: 1039
batch 99, loss: 0.3758, instance_loss: 0.5186, weighted_loss: 0.4186, label: 1, bag_size: 968
batch 119, loss: 0.1182, instance_loss: 0.3682, weighted_loss: 0.1932, label: 4, bag_size: 656
batch 139, loss: 0.0046, instance_loss: 0.0827, weighted_loss: 0.0280, label: 4, bag_size: 1235
batch 159, loss: 0.0439, instance_loss: 0.2021, weighted_loss: 0.0914, label: 0, bag_size: 807
batch 179, loss: 0.0570, instance_loss: 0.1599, weighted_loss: 0.0879, label: 3, bag_size: 729
batch 199, loss: 0.0652, instance_loss: 0.2966, weighted_loss: 0.1346, label: 0, bag_size: 371
batch 219, loss: 0.0286, instance_loss: 0.1059, weighted_loss: 0.0518, label: 0, bag_size: 1034
batch 239, loss: 0.1216, instance_loss: 0.4759, weighted_loss: 0.2279, label: 4, bag_size: 436
batch 259, loss: 0.1183, instance_loss: 0.6137, weighted_loss: 0.2669, label: 1, bag_size: 660
batch 279, loss: 1.8557, instance_loss: 0.6112, weighted_loss: 1.4823, label: 2, bag_size: 373
batch 299, loss: 0.1774, instance_loss: 0.3180, weighted_loss: 0.2196, label: 1, bag_size: 348
batch 319, loss: 0.0043, instance_loss: 0.5063, weighted_loss: 0.1549, label: 3, bag_size: 841
batch 339, loss: 0.0124, instance_loss: 0.1161, weighted_loss: 0.0435, label: 0, bag_size: 729
batch 359, loss: 0.0493, instance_loss: 0.4821, weighted_loss: 0.1791, label: 3, bag_size: 360
batch 379, loss: 1.9310, instance_loss: 0.7331, weighted_loss: 1.5716, label: 1, bag_size: 1172
batch 399, loss: 0.0143, instance_loss: 0.0946, weighted_loss: 0.0384, label: 0, bag_size: 729
batch 419, loss: 0.0051, instance_loss: 0.0452, weighted_loss: 0.0171, label: 3, bag_size: 729


class 0 clustering acc 0.9865294117647059: correct 16771/17000
class 1 clustering acc 0.4385294117647059: correct 1491/3400
Epoch: 34, train_loss: 0.2353, train_clustering_loss:  0.3090, train_error: 0.0706
class 0: acc 0.9550561797752809, correct 85/89
class 1: acc 0.8095238095238095, correct 68/84
class 2: acc 0.8850574712643678, correct 77/87
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.2163, val_error: 0.3600, auc: 0.8432
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0064, instance_loss: 0.0339, weighted_loss: 0.0146, label: 3, bag_size: 729
batch 39, loss: 0.0117, instance_loss: 0.0627, weighted_loss: 0.0270, label: 3, bag_size: 729
batch 59, loss: 0.0102, instance_loss: 0.1352, weighted_loss: 0.0477, label: 4, bag_size: 646
batch 79, loss: 0.0021, instance_loss: 0.1306, weighted_loss: 0.0406, label: 3, bag_size: 729
batch 99, loss: 0.8360, instance_loss: 0.7894, weighted_loss: 0.8220, label: 2, bag_size: 1677
batch 119, loss: 0.0442, instance_loss: 0.2479, weighted_loss: 0.1053, label: 2, bag_size: 1242
batch 139, loss: 0.4130, instance_loss: 0.5480, weighted_loss: 0.4535, label: 3, bag_size: 283
batch 159, loss: 0.1931, instance_loss: 0.3169, weighted_loss: 0.2303, label: 2, bag_size: 395
batch 179, loss: 0.1340, instance_loss: 0.4958, weighted_loss: 0.2425, label: 3, bag_size: 281
batch 199, loss: 0.0228, instance_loss: 0.2058, weighted_loss: 0.0777, label: 4, bag_size: 656
batch 219, loss: 0.0000, instance_loss: 0.0588, weighted_loss: 0.0177, label: 4, bag_size: 729
batch 239, loss: 0.0996, instance_loss: 0.1925, weighted_loss: 0.1274, label: 0, bag_size: 410
batch 259, loss: 1.5355, instance_loss: 1.0568, weighted_loss: 1.3919, label: 1, bag_size: 1799
batch 279, loss: 0.0057, instance_loss: 0.2432, weighted_loss: 0.0770, label: 3, bag_size: 1118
batch 299, loss: 0.0059, instance_loss: 0.0380, weighted_loss: 0.0155, label: 3, bag_size: 729
batch 319, loss: 0.0000, instance_loss: 0.0286, weighted_loss: 0.0086, label: 4, bag_size: 729
batch 339, loss: 0.0194, instance_loss: 0.4714, weighted_loss: 0.1550, label: 1, bag_size: 834
batch 359, loss: 0.0011, instance_loss: 0.0367, weighted_loss: 0.0118, label: 4, bag_size: 524
batch 379, loss: 0.0340, instance_loss: 0.2229, weighted_loss: 0.0907, label: 1, bag_size: 1191
batch 399, loss: 0.0130, instance_loss: 0.1507, weighted_loss: 0.0543, label: 4, bag_size: 1235
batch 419, loss: 0.1263, instance_loss: 0.2595, weighted_loss: 0.1663, label: 2, bag_size: 469


class 0 clustering acc 0.9887058823529412: correct 16808/17000
class 1 clustering acc 0.42911764705882355: correct 1459/3400
Epoch: 35, train_loss: 0.2041, train_clustering_loss:  0.3029, train_error: 0.0682
class 0: acc 0.9871794871794872, correct 77/78
class 1: acc 0.8205128205128205, correct 64/78
class 2: acc 0.8333333333333334, correct 70/84
class 3: acc 1.0, correct 92/92
class 4: acc 1.0, correct 93/93

Val Set, val_loss: 1.3214, val_error: 0.4000, auc: 0.8309
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.3153, instance_loss: 0.4222, weighted_loss: 1.0474, label: 2, bag_size: 986
batch 39, loss: 0.1161, instance_loss: 0.6407, weighted_loss: 0.2735, label: 3, bag_size: 671
batch 59, loss: 7.1475, instance_loss: 0.7385, weighted_loss: 5.2248, label: 4, bag_size: 436
batch 79, loss: 0.0041, instance_loss: 0.3013, weighted_loss: 0.0933, label: 4, bag_size: 533
batch 99, loss: 0.0009, instance_loss: 0.0875, weighted_loss: 0.0269, label: 4, bag_size: 636
batch 119, loss: 0.8358, instance_loss: 0.7432, weighted_loss: 0.8080, label: 2, bag_size: 679
batch 139, loss: 0.0049, instance_loss: 0.0840, weighted_loss: 0.0287, label: 4, bag_size: 636
batch 159, loss: 1.6579, instance_loss: 0.6420, weighted_loss: 1.3532, label: 1, bag_size: 1273
batch 179, loss: 0.1988, instance_loss: 0.4978, weighted_loss: 0.2885, label: 2, bag_size: 373
batch 199, loss: 0.0031, instance_loss: 0.0458, weighted_loss: 0.0159, label: 4, bag_size: 524
batch 219, loss: 0.0755, instance_loss: 0.4867, weighted_loss: 0.1989, label: 3, bag_size: 697
batch 239, loss: 0.0083, instance_loss: 0.0547, weighted_loss: 0.0222, label: 0, bag_size: 731
batch 259, loss: 0.0050, instance_loss: 0.2605, weighted_loss: 0.0816, label: 1, bag_size: 1127
batch 279, loss: 0.0833, instance_loss: 0.4540, weighted_loss: 0.1945, label: 1, bag_size: 474
batch 299, loss: 0.0044, instance_loss: 0.2541, weighted_loss: 0.0793, label: 4, bag_size: 533
batch 319, loss: 0.0025, instance_loss: 0.2050, weighted_loss: 0.0633, label: 1, bag_size: 1127
batch 339, loss: 0.0023, instance_loss: 0.2689, weighted_loss: 0.0823, label: 1, bag_size: 1152
batch 359, loss: 0.0442, instance_loss: 0.0519, weighted_loss: 0.0465, label: 3, bag_size: 952
batch 379, loss: 0.0104, instance_loss: 0.1996, weighted_loss: 0.0671, label: 1, bag_size: 1127
batch 399, loss: 0.0000, instance_loss: 0.0618, weighted_loss: 0.0185, label: 4, bag_size: 729
batch 419, loss: 0.2341, instance_loss: 0.2651, weighted_loss: 0.2434, label: 0, bag_size: 350


class 0 clustering acc 0.9858235294117647: correct 16759/17000
class 1 clustering acc 0.43911764705882356: correct 1493/3400
Epoch: 36, train_loss: 0.2283, train_clustering_loss:  0.3099, train_error: 0.0706
class 0: acc 0.9859154929577465, correct 70/71
class 1: acc 0.8387096774193549, correct 78/93
class 2: acc 0.8625, correct 69/80
class 3: acc 0.9885057471264368, correct 86/87
class 4: acc 0.9787234042553191, correct 92/94

Val Set, val_loss: 1.3068, val_error: 0.4400, auc: 0.8393
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.1825: correct 73/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0012, instance_loss: 0.1023, weighted_loss: 0.0315, label: 4, bag_size: 711
batch 39, loss: 0.0073, instance_loss: 0.4091, weighted_loss: 0.1279, label: 1, bag_size: 834
batch 59, loss: 0.2037, instance_loss: 0.3527, weighted_loss: 0.2484, label: 4, bag_size: 817
batch 79, loss: 0.1187, instance_loss: 0.2550, weighted_loss: 0.1596, label: 4, bag_size: 817
batch 99, loss: 0.0143, instance_loss: 0.2196, weighted_loss: 0.0759, label: 4, bag_size: 817
batch 119, loss: 0.0011, instance_loss: 0.0462, weighted_loss: 0.0146, label: 3, bag_size: 729
batch 139, loss: 0.1373, instance_loss: 0.6461, weighted_loss: 0.2900, label: 3, bag_size: 671
batch 159, loss: 0.0014, instance_loss: 0.0951, weighted_loss: 0.0295, label: 4, bag_size: 636
batch 179, loss: 0.0003, instance_loss: 0.0793, weighted_loss: 0.0240, label: 3, bag_size: 729
batch 199, loss: 0.0010, instance_loss: 0.2583, weighted_loss: 0.0782, label: 4, bag_size: 675
batch 219, loss: 0.0021, instance_loss: 0.0310, weighted_loss: 0.0108, label: 0, bag_size: 385
batch 239, loss: 0.0002, instance_loss: 0.0556, weighted_loss: 0.0168, label: 4, bag_size: 764
batch 259, loss: 0.0213, instance_loss: 0.1470, weighted_loss: 0.0590, label: 0, bag_size: 756
batch 279, loss: 0.5062, instance_loss: 0.3202, weighted_loss: 0.4504, label: 2, bag_size: 271
batch 299, loss: 0.0127, instance_loss: 0.0948, weighted_loss: 0.0373, label: 0, bag_size: 1332
batch 319, loss: 0.0180, instance_loss: 0.0309, weighted_loss: 0.0219, label: 3, bag_size: 1172
batch 339, loss: 0.0170, instance_loss: 0.2511, weighted_loss: 0.0872, label: 0, bag_size: 729
batch 359, loss: 0.2271, instance_loss: 0.3499, weighted_loss: 0.2639, label: 2, bag_size: 684
batch 379, loss: 0.0031, instance_loss: 0.0365, weighted_loss: 0.0131, label: 0, bag_size: 1135
batch 399, loss: 0.4035, instance_loss: 0.5596, weighted_loss: 0.4503, label: 2, bag_size: 878
batch 419, loss: 0.0608, instance_loss: 0.2719, weighted_loss: 0.1241, label: 2, bag_size: 405


class 0 clustering acc 0.9887058823529412: correct 16808/17000
class 1 clustering acc 0.4338235294117647: correct 1475/3400
Epoch: 37, train_loss: 0.2016, train_clustering_loss:  0.2954, train_error: 0.0635
class 0: acc 0.9797979797979798, correct 97/99
class 1: acc 0.8214285714285714, correct 69/84
class 2: acc 0.8701298701298701, correct 67/77
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.4405, val_error: 0.3800, auc: 0.8216
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.2768, instance_loss: 0.5334, weighted_loss: 0.3538, label: 4, bag_size: 1331
batch 39, loss: 0.0034, instance_loss: 0.5567, weighted_loss: 0.1694, label: 3, bag_size: 841
batch 59, loss: 0.0042, instance_loss: 0.0810, weighted_loss: 0.0272, label: 4, bag_size: 636
batch 79, loss: 0.0068, instance_loss: 0.1215, weighted_loss: 0.0412, label: 3, bag_size: 729
batch 99, loss: 2.0595, instance_loss: 0.6658, weighted_loss: 1.6414, label: 2, bag_size: 120
batch 119, loss: 0.0023, instance_loss: 0.0675, weighted_loss: 0.0219, label: 0, bag_size: 976
batch 139, loss: 0.2096, instance_loss: 0.3260, weighted_loss: 0.2445, label: 2, bag_size: 408
batch 159, loss: 0.0022, instance_loss: 0.0451, weighted_loss: 0.0151, label: 3, bag_size: 729
batch 179, loss: 0.0190, instance_loss: 0.1427, weighted_loss: 0.0561, label: 0, bag_size: 976
batch 199, loss: 0.2330, instance_loss: 0.2678, weighted_loss: 0.2435, label: 2, bag_size: 1700
batch 219, loss: 0.0189, instance_loss: 0.4476, weighted_loss: 0.1475, label: 2, bag_size: 373
batch 239, loss: 0.0175, instance_loss: 0.6520, weighted_loss: 0.2079, label: 4, bag_size: 675
batch 259, loss: 0.3997, instance_loss: 0.3583, weighted_loss: 0.3873, label: 1, bag_size: 1014
batch 279, loss: 0.0003, instance_loss: 0.1382, weighted_loss: 0.0416, label: 4, bag_size: 729
batch 299, loss: 1.3789, instance_loss: 0.5541, weighted_loss: 1.1315, label: 1, bag_size: 435
batch 319, loss: 0.0172, instance_loss: 0.3979, weighted_loss: 0.1314, label: 3, bag_size: 706
batch 339, loss: 1.4734, instance_loss: 1.0118, weighted_loss: 1.3349, label: 1, bag_size: 1799
batch 359, loss: 0.8827, instance_loss: 0.3225, weighted_loss: 0.7146, label: 2, bag_size: 1164
batch 379, loss: 0.0242, instance_loss: 0.4106, weighted_loss: 0.1401, label: 4, bag_size: 590
batch 399, loss: 0.0152, instance_loss: 0.4736, weighted_loss: 0.1527, label: 3, bag_size: 697
batch 419, loss: 0.0143, instance_loss: 0.5942, weighted_loss: 0.1883, label: 4, bag_size: 663


class 0 clustering acc 0.9875294117647059: correct 16788/17000
class 1 clustering acc 0.3926470588235294: correct 1335/3400
Epoch: 38, train_loss: 0.2787, train_clustering_loss:  0.3162, train_error: 0.0918
class 0: acc 0.9466666666666667, correct 71/75
class 1: acc 0.845360824742268, correct 82/97
class 2: acc 0.8415841584158416, correct 85/101
class 3: acc 0.9861111111111112, correct 71/72
class 4: acc 0.9625, correct 77/80

Val Set, val_loss: 1.3260, val_error: 0.3600, auc: 0.8471
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.2225: correct 89/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0058, instance_loss: 0.0352, weighted_loss: 0.0146, label: 3, bag_size: 556
batch 39, loss: 0.0039, instance_loss: 0.0876, weighted_loss: 0.0290, label: 4, bag_size: 636
batch 59, loss: 0.0087, instance_loss: 0.1162, weighted_loss: 0.0410, label: 4, bag_size: 826
batch 79, loss: 0.9854, instance_loss: 0.6927, weighted_loss: 0.8976, label: 1, bag_size: 386
batch 99, loss: 0.6747, instance_loss: 0.5683, weighted_loss: 0.6428, label: 2, bag_size: 1232
batch 119, loss: 0.1594, instance_loss: 0.2926, weighted_loss: 0.1993, label: 2, bag_size: 262
batch 139, loss: 1.0125, instance_loss: 0.3542, weighted_loss: 0.8150, label: 0, bag_size: 1257
batch 159, loss: 1.0617, instance_loss: 0.6755, weighted_loss: 0.9458, label: 0, bag_size: 245
batch 179, loss: 0.0090, instance_loss: 0.3144, weighted_loss: 0.1006, label: 3, bag_size: 706
batch 199, loss: 2.1397, instance_loss: 0.7411, weighted_loss: 1.7201, label: 1, bag_size: 102
batch 219, loss: 0.1342, instance_loss: 0.2725, weighted_loss: 0.1757, label: 0, bag_size: 350
batch 239, loss: 0.0013, instance_loss: 0.1404, weighted_loss: 0.0430, label: 3, bag_size: 729
batch 259, loss: 0.0014, instance_loss: 0.0539, weighted_loss: 0.0171, label: 3, bag_size: 729
batch 279, loss: 0.0601, instance_loss: 0.1461, weighted_loss: 0.0859, label: 0, bag_size: 760
batch 299, loss: 0.1051, instance_loss: 0.2613, weighted_loss: 0.1520, label: 2, bag_size: 848
batch 319, loss: 0.0002, instance_loss: 0.1314, weighted_loss: 0.0395, label: 4, bag_size: 729
batch 339, loss: 0.0148, instance_loss: 0.4651, weighted_loss: 0.1499, label: 3, bag_size: 697
batch 359, loss: 0.0016, instance_loss: 0.0338, weighted_loss: 0.0113, label: 3, bag_size: 405
batch 379, loss: 0.1497, instance_loss: 0.2867, weighted_loss: 0.1908, label: 2, bag_size: 1133
batch 399, loss: 0.0025, instance_loss: 0.1355, weighted_loss: 0.0424, label: 4, bag_size: 1121
batch 419, loss: 0.0242, instance_loss: 0.4377, weighted_loss: 0.1483, label: 3, bag_size: 849


class 0 clustering acc 0.9882352941176471: correct 16800/17000
class 1 clustering acc 0.46294117647058824: correct 1574/3400
Epoch: 39, train_loss: 0.1863, train_clustering_loss:  0.2896, train_error: 0.0518
class 0: acc 0.9629629629629629, correct 78/81
class 1: acc 0.7903225806451613, correct 49/62
class 2: acc 0.9393939393939394, correct 93/99
class 3: acc 1.0, correct 99/99
class 4: acc 1.0, correct 84/84

Val Set, val_loss: 1.2899, val_error: 0.3400, auc: 0.8464
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0848, instance_loss: 0.1094, weighted_loss: 0.0922, label: 4, bag_size: 1002
batch 39, loss: 0.0554, instance_loss: 0.2199, weighted_loss: 0.1048, label: 2, bag_size: 910
batch 59, loss: 0.0053, instance_loss: 0.0653, weighted_loss: 0.0233, label: 0, bag_size: 552
batch 79, loss: 0.0530, instance_loss: 0.2712, weighted_loss: 0.1185, label: 1, bag_size: 690
batch 99, loss: 0.0003, instance_loss: 0.1284, weighted_loss: 0.0387, label: 3, bag_size: 729
batch 119, loss: 1.7318, instance_loss: 0.7166, weighted_loss: 1.4272, label: 2, bag_size: 1167
batch 139, loss: 0.0009, instance_loss: 0.0339, weighted_loss: 0.0108, label: 3, bag_size: 729
batch 159, loss: 0.0163, instance_loss: 0.2794, weighted_loss: 0.0952, label: 3, bag_size: 821
batch 179, loss: 0.0539, instance_loss: 0.0985, weighted_loss: 0.0673, label: 0, bag_size: 1517
batch 199, loss: 0.4670, instance_loss: 0.5817, weighted_loss: 0.5014, label: 2, bag_size: 358
batch 219, loss: 0.0028, instance_loss: 0.1284, weighted_loss: 0.0405, label: 4, bag_size: 790
batch 239, loss: 0.0112, instance_loss: 0.0274, weighted_loss: 0.0160, label: 3, bag_size: 405
batch 259, loss: 0.0177, instance_loss: 0.1775, weighted_loss: 0.0656, label: 0, bag_size: 729
batch 279, loss: 0.2222, instance_loss: 0.5708, weighted_loss: 0.3268, label: 1, bag_size: 648
batch 299, loss: 0.0016, instance_loss: 0.3480, weighted_loss: 0.1055, label: 3, bag_size: 791
batch 319, loss: 0.0413, instance_loss: 0.4732, weighted_loss: 0.1709, label: 1, bag_size: 598
batch 339, loss: 0.8873, instance_loss: 0.5662, weighted_loss: 0.7910, label: 2, bag_size: 738
batch 359, loss: 0.0054, instance_loss: 0.2861, weighted_loss: 0.0896, label: 4, bag_size: 533
batch 379, loss: 0.0002, instance_loss: 0.0510, weighted_loss: 0.0155, label: 4, bag_size: 729
batch 399, loss: 1.4419, instance_loss: 0.6680, weighted_loss: 1.2097, label: 3, bag_size: 671
batch 419, loss: 0.0892, instance_loss: 0.2426, weighted_loss: 0.1352, label: 0, bag_size: 1065


class 0 clustering acc 0.9871764705882353: correct 16782/17000
class 1 clustering acc 0.4426470588235294: correct 1505/3400
Epoch: 40, train_loss: 0.1894, train_clustering_loss:  0.3023, train_error: 0.0565
class 0: acc 0.9864864864864865, correct 73/74
class 1: acc 0.9010989010989011, correct 82/91
class 2: acc 0.8354430379746836, correct 66/79
class 3: acc 0.9901960784313726, correct 101/102
class 4: acc 1.0, correct 79/79

Val Set, val_loss: 1.4466, val_error: 0.4400, auc: 0.8286
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0200, instance_loss: 0.2139, weighted_loss: 0.0782, label: 2, bag_size: 222
batch 39, loss: 0.7362, instance_loss: 0.4499, weighted_loss: 0.6503, label: 2, bag_size: 120
batch 59, loss: 0.0934, instance_loss: 0.2494, weighted_loss: 0.1402, label: 0, bag_size: 542
batch 79, loss: 0.0477, instance_loss: 0.2452, weighted_loss: 0.1069, label: 2, bag_size: 1569
batch 99, loss: 0.1196, instance_loss: 0.4640, weighted_loss: 0.2229, label: 3, bag_size: 671
batch 119, loss: 0.0773, instance_loss: 0.2977, weighted_loss: 0.1435, label: 0, bag_size: 350
batch 139, loss: 0.0046, instance_loss: 0.1453, weighted_loss: 0.0468, label: 3, bag_size: 729
batch 159, loss: 0.0360, instance_loss: 0.3485, weighted_loss: 0.1298, label: 4, bag_size: 625
batch 179, loss: 0.0026, instance_loss: 0.3118, weighted_loss: 0.0954, label: 4, bag_size: 882
batch 199, loss: 0.2076, instance_loss: 0.2793, weighted_loss: 0.2291, label: 1, bag_size: 1402
batch 219, loss: 0.0380, instance_loss: 0.1427, weighted_loss: 0.0694, label: 2, bag_size: 846
batch 239, loss: 0.0001, instance_loss: 0.2939, weighted_loss: 0.0882, label: 4, bag_size: 947
batch 259, loss: 0.0764, instance_loss: 0.3686, weighted_loss: 0.1641, label: 2, bag_size: 358
batch 279, loss: 0.0890, instance_loss: 0.5039, weighted_loss: 0.2135, label: 4, bag_size: 1360
batch 299, loss: 0.0080, instance_loss: 0.3748, weighted_loss: 0.1181, label: 4, bag_size: 675
batch 319, loss: 0.0562, instance_loss: 0.4907, weighted_loss: 0.1865, label: 1, bag_size: 846
batch 339, loss: 0.0029, instance_loss: 0.1033, weighted_loss: 0.0330, label: 4, bag_size: 1121
batch 359, loss: 0.0510, instance_loss: 0.3257, weighted_loss: 0.1334, label: 3, bag_size: 360
batch 379, loss: 0.0075, instance_loss: 0.3877, weighted_loss: 0.1216, label: 1, bag_size: 846
batch 399, loss: 0.1633, instance_loss: 0.3145, weighted_loss: 0.2087, label: 2, bag_size: 470
batch 419, loss: 0.0102, instance_loss: 0.0299, weighted_loss: 0.0161, label: 3, bag_size: 952


class 0 clustering acc 0.9878235294117647: correct 16793/17000
class 1 clustering acc 0.44941176470588234: correct 1528/3400
Epoch: 41, train_loss: 0.1830, train_clustering_loss:  0.3010, train_error: 0.0659
class 0: acc 0.9746835443037974, correct 77/79
class 1: acc 0.8194444444444444, correct 59/72
class 2: acc 0.8589743589743589, correct 67/78
class 3: acc 0.9770114942528736, correct 85/87
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 1.2214, val_error: 0.3400, auc: 0.8502
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.225: correct 90/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0024, instance_loss: 0.0433, weighted_loss: 0.0147, label: 0, bag_size: 921
batch 39, loss: 0.0078, instance_loss: 0.4589, weighted_loss: 0.1431, label: 1, bag_size: 356
batch 59, loss: 0.3833, instance_loss: 0.3831, weighted_loss: 0.3832, label: 1, bag_size: 898
batch 79, loss: 0.0510, instance_loss: 0.4870, weighted_loss: 0.1818, label: 4, bag_size: 511
batch 99, loss: 0.0034, instance_loss: 0.3188, weighted_loss: 0.0980, label: 3, bag_size: 841
batch 119, loss: 0.6679, instance_loss: 0.6539, weighted_loss: 0.6637, label: 2, bag_size: 1167
batch 139, loss: 0.1419, instance_loss: 0.3048, weighted_loss: 0.1908, label: 1, bag_size: 913
batch 159, loss: 0.0039, instance_loss: 0.0577, weighted_loss: 0.0201, label: 0, bag_size: 933
batch 179, loss: 0.0061, instance_loss: 0.0507, weighted_loss: 0.0195, label: 0, bag_size: 729
batch 199, loss: 0.1583, instance_loss: 0.2437, weighted_loss: 0.1839, label: 0, bag_size: 545
batch 219, loss: 0.6377, instance_loss: 0.2962, weighted_loss: 0.5353, label: 0, bag_size: 718
batch 239, loss: 0.0556, instance_loss: 0.3242, weighted_loss: 0.1362, label: 1, bag_size: 898
batch 259, loss: 0.0001, instance_loss: 0.0476, weighted_loss: 0.0143, label: 4, bag_size: 729
batch 279, loss: 0.2127, instance_loss: 0.3618, weighted_loss: 0.2574, label: 2, bag_size: 571
batch 299, loss: 0.0025, instance_loss: 0.2294, weighted_loss: 0.0706, label: 3, bag_size: 1253
batch 319, loss: 0.1675, instance_loss: 0.4812, weighted_loss: 0.2616, label: 3, bag_size: 283
batch 339, loss: 0.0110, instance_loss: 0.5387, weighted_loss: 0.1693, label: 4, bag_size: 675
batch 359, loss: 0.1866, instance_loss: 0.2462, weighted_loss: 0.2045, label: 0, bag_size: 1289
batch 379, loss: 0.0706, instance_loss: 0.4357, weighted_loss: 0.1801, label: 3, bag_size: 360
batch 399, loss: 0.0324, instance_loss: 0.2026, weighted_loss: 0.0835, label: 3, bag_size: 1253
batch 419, loss: 0.0000, instance_loss: 0.0583, weighted_loss: 0.0175, label: 4, bag_size: 729


class 0 clustering acc 0.9861176470588235: correct 16764/17000
class 1 clustering acc 0.42676470588235293: correct 1451/3400
Epoch: 42, train_loss: 0.1834, train_clustering_loss:  0.3082, train_error: 0.0588
class 0: acc 0.9791666666666666, correct 94/96
class 1: acc 0.8589743589743589, correct 67/78
class 2: acc 0.8658536585365854, correct 71/82
class 3: acc 1.0, correct 92/92
class 4: acc 0.987012987012987, correct 76/77

Val Set, val_loss: 1.6312, val_error: 0.4400, auc: 0.8050
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.215: correct 86/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0793, instance_loss: 0.2252, weighted_loss: 0.1230, label: 3, bag_size: 729
batch 39, loss: 0.3825, instance_loss: 0.2856, weighted_loss: 0.3534, label: 2, bag_size: 1164
batch 59, loss: 0.0002, instance_loss: 0.0289, weighted_loss: 0.0088, label: 4, bag_size: 729
batch 79, loss: 0.0066, instance_loss: 0.1452, weighted_loss: 0.0482, label: 4, bag_size: 1002
batch 99, loss: 0.1969, instance_loss: 0.4626, weighted_loss: 0.2766, label: 1, bag_size: 139
batch 119, loss: 1.8623, instance_loss: 0.7828, weighted_loss: 1.5385, label: 1, bag_size: 968
batch 139, loss: 0.0040, instance_loss: 0.0779, weighted_loss: 0.0262, label: 0, bag_size: 1196
batch 159, loss: 0.0900, instance_loss: 0.4374, weighted_loss: 0.1942, label: 1, bag_size: 917
batch 179, loss: 0.9954, instance_loss: 0.5264, weighted_loss: 0.8547, label: 2, bag_size: 1006
batch 199, loss: 0.2074, instance_loss: 0.3940, weighted_loss: 0.2634, label: 2, bag_size: 265
batch 219, loss: 0.0298, instance_loss: 0.2634, weighted_loss: 0.0999, label: 2, bag_size: 262
batch 239, loss: 0.0050, instance_loss: 0.2257, weighted_loss: 0.0713, label: 1, bag_size: 828
batch 259, loss: 0.0599, instance_loss: 0.2606, weighted_loss: 0.1201, label: 2, bag_size: 809
batch 279, loss: 0.0513, instance_loss: 0.0722, weighted_loss: 0.0576, label: 3, bag_size: 1172
batch 299, loss: 0.6022, instance_loss: 0.4521, weighted_loss: 0.5572, label: 2, bag_size: 411
batch 319, loss: 0.1151, instance_loss: 0.2246, weighted_loss: 0.1479, label: 1, bag_size: 959
batch 339, loss: 0.0007, instance_loss: 0.2589, weighted_loss: 0.0782, label: 4, bag_size: 1002
batch 359, loss: 0.0095, instance_loss: 0.3674, weighted_loss: 0.1169, label: 4, bag_size: 533
batch 379, loss: 0.0759, instance_loss: 0.3530, weighted_loss: 0.1590, label: 2, bag_size: 1006
batch 399, loss: 0.0002, instance_loss: 0.0564, weighted_loss: 0.0170, label: 4, bag_size: 729
batch 419, loss: 0.0097, instance_loss: 0.1159, weighted_loss: 0.0416, label: 3, bag_size: 729


class 0 clustering acc 0.9867058823529412: correct 16774/17000
class 1 clustering acc 0.4420588235294118: correct 1503/3400
Epoch: 43, train_loss: 0.2485, train_clustering_loss:  0.3076, train_error: 0.0659
class 0: acc 0.9178082191780822, correct 67/73
class 1: acc 0.912621359223301, correct 94/103
class 2: acc 0.8674698795180723, correct 72/83
class 3: acc 1.0, correct 78/78
class 4: acc 0.9772727272727273, correct 86/88

Val Set, val_loss: 1.3524, val_error: 0.4000, auc: 0.8458
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0121, instance_loss: 0.1644, weighted_loss: 0.0578, label: 0, bag_size: 524
batch 39, loss: 0.0047, instance_loss: 0.3235, weighted_loss: 0.1003, label: 4, bag_size: 947
batch 59, loss: 0.0001, instance_loss: 0.0838, weighted_loss: 0.0252, label: 4, bag_size: 729
batch 79, loss: 0.0200, instance_loss: 0.1636, weighted_loss: 0.0631, label: 0, bag_size: 807
batch 99, loss: 0.0527, instance_loss: 0.5248, weighted_loss: 0.1943, label: 4, bag_size: 366
batch 119, loss: 0.0576, instance_loss: 0.3447, weighted_loss: 0.1438, label: 1, bag_size: 834
batch 139, loss: 0.4259, instance_loss: 0.4917, weighted_loss: 0.4457, label: 3, bag_size: 281
batch 159, loss: 0.0228, instance_loss: 0.2184, weighted_loss: 0.0815, label: 4, bag_size: 1331
batch 179, loss: 0.0156, instance_loss: 0.3997, weighted_loss: 0.1308, label: 3, bag_size: 360
batch 199, loss: 0.1066, instance_loss: 0.5926, weighted_loss: 0.2524, label: 4, bag_size: 366
batch 219, loss: 0.0264, instance_loss: 0.0947, weighted_loss: 0.0469, label: 0, bag_size: 1034
batch 239, loss: 0.0448, instance_loss: 0.0596, weighted_loss: 0.0492, label: 3, bag_size: 556
batch 259, loss: 0.0587, instance_loss: 0.1865, weighted_loss: 0.0970, label: 0, bag_size: 410
batch 279, loss: 0.0003, instance_loss: 0.0635, weighted_loss: 0.0193, label: 4, bag_size: 729
batch 299, loss: 0.0000, instance_loss: 0.0814, weighted_loss: 0.0244, label: 4, bag_size: 729
batch 319, loss: 0.0111, instance_loss: 0.1456, weighted_loss: 0.0515, label: 4, bag_size: 1235
batch 339, loss: 0.0232, instance_loss: 0.3223, weighted_loss: 0.1129, label: 1, bag_size: 778
batch 359, loss: 0.3165, instance_loss: 0.4742, weighted_loss: 0.3638, label: 1, bag_size: 968
batch 379, loss: 0.0064, instance_loss: 0.0846, weighted_loss: 0.0299, label: 0, bag_size: 1190
batch 399, loss: 0.0784, instance_loss: 0.1086, weighted_loss: 0.0875, label: 3, bag_size: 729
batch 419, loss: 0.0284, instance_loss: 0.3742, weighted_loss: 0.1321, label: 1, bag_size: 442


class 0 clustering acc 0.989: correct 16813/17000
class 1 clustering acc 0.42676470588235293: correct 1451/3400
Epoch: 44, train_loss: 0.1679, train_clustering_loss:  0.3002, train_error: 0.0565
class 0: acc 0.9767441860465116, correct 84/86
class 1: acc 0.8854166666666666, correct 85/96
class 2: acc 0.8690476190476191, correct 73/84
class 3: acc 1.0, correct 89/89
class 4: acc 1.0, correct 70/70

Val Set, val_loss: 1.4160, val_error: 0.4400, auc: 0.8324
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0066, instance_loss: 0.0518, weighted_loss: 0.0201, label: 0, bag_size: 729
batch 39, loss: 0.0125, instance_loss: 0.1381, weighted_loss: 0.0501, label: 4, bag_size: 1235
batch 59, loss: 0.0705, instance_loss: 0.0748, weighted_loss: 0.0718, label: 3, bag_size: 1399
batch 79, loss: 0.0812, instance_loss: 0.1820, weighted_loss: 0.1114, label: 1, bag_size: 858
batch 99, loss: 0.0356, instance_loss: 0.0647, weighted_loss: 0.0443, label: 3, bag_size: 1172
batch 119, loss: 0.0060, instance_loss: 0.2468, weighted_loss: 0.0782, label: 1, bag_size: 846
batch 139, loss: 0.0807, instance_loss: 0.5704, weighted_loss: 0.2276, label: 3, bag_size: 671
batch 159, loss: 1.4743, instance_loss: 0.2895, weighted_loss: 1.1188, label: 2, bag_size: 828
batch 179, loss: 0.0276, instance_loss: 0.1546, weighted_loss: 0.0657, label: 0, bag_size: 729
batch 199, loss: 0.0356, instance_loss: 0.4804, weighted_loss: 0.1691, label: 1, bag_size: 917
batch 219, loss: 0.2178, instance_loss: 0.3334, weighted_loss: 0.2525, label: 0, bag_size: 990
batch 239, loss: 0.6321, instance_loss: 0.5895, weighted_loss: 0.6193, label: 0, bag_size: 282
batch 259, loss: 0.4171, instance_loss: 0.4387, weighted_loss: 0.4235, label: 2, bag_size: 1653
batch 279, loss: 0.0293, instance_loss: 0.1697, weighted_loss: 0.0714, label: 2, bag_size: 470
batch 299, loss: 0.0268, instance_loss: 0.3233, weighted_loss: 0.1158, label: 1, bag_size: 474
batch 319, loss: 1.4993, instance_loss: 0.5284, weighted_loss: 1.2080, label: 2, bag_size: 120
batch 339, loss: 0.0031, instance_loss: 0.1420, weighted_loss: 0.0447, label: 1, bag_size: 369
batch 359, loss: 0.0023, instance_loss: 0.0325, weighted_loss: 0.0114, label: 0, bag_size: 385
batch 379, loss: 0.0263, instance_loss: 0.0616, weighted_loss: 0.0369, label: 3, bag_size: 556
batch 399, loss: 0.0062, instance_loss: 0.0455, weighted_loss: 0.0180, label: 3, bag_size: 1172
batch 419, loss: 0.0025, instance_loss: 0.1936, weighted_loss: 0.0599, label: 1, bag_size: 866


class 0 clustering acc 0.986764705882353: correct 16775/17000
class 1 clustering acc 0.41823529411764704: correct 1422/3400
Epoch: 45, train_loss: 0.2110, train_clustering_loss:  0.3065, train_error: 0.0612
class 0: acc 0.9879518072289156, correct 82/83
class 1: acc 0.9080459770114943, correct 79/87
class 2: acc 0.8541666666666666, correct 82/96
class 3: acc 0.9761904761904762, correct 82/84
class 4: acc 0.9866666666666667, correct 74/75

Val Set, val_loss: 1.4422, val_error: 0.4200, auc: 0.8405
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0296, instance_loss: 0.1217, weighted_loss: 0.0572, label: 0, bag_size: 338
batch 39, loss: 0.0392, instance_loss: 0.2302, weighted_loss: 0.0965, label: 1, bag_size: 994
batch 59, loss: 0.0213, instance_loss: 0.2256, weighted_loss: 0.0826, label: 2, bag_size: 1242
batch 79, loss: 0.0703, instance_loss: 0.1299, weighted_loss: 0.0882, label: 0, bag_size: 1517
batch 99, loss: 0.1320, instance_loss: 0.3232, weighted_loss: 0.1893, label: 2, bag_size: 317
batch 119, loss: 0.0007, instance_loss: 0.0976, weighted_loss: 0.0298, label: 3, bag_size: 729
batch 139, loss: 0.0503, instance_loss: 0.4913, weighted_loss: 0.1826, label: 3, bag_size: 360
batch 159, loss: 0.0142, instance_loss: 0.1236, weighted_loss: 0.0470, label: 0, bag_size: 729
batch 179, loss: 0.0027, instance_loss: 0.2717, weighted_loss: 0.0834, label: 1, bag_size: 965
batch 199, loss: 0.0120, instance_loss: 0.1037, weighted_loss: 0.0395, label: 3, bag_size: 729
batch 219, loss: 0.0009, instance_loss: 0.0381, weighted_loss: 0.0121, label: 3, bag_size: 1172
batch 239, loss: 0.1143, instance_loss: 0.3250, weighted_loss: 0.1775, label: 3, bag_size: 849
batch 259, loss: 0.1758, instance_loss: 0.1676, weighted_loss: 0.1733, label: 0, bag_size: 294
batch 279, loss: 0.0041, instance_loss: 0.1983, weighted_loss: 0.0624, label: 1, bag_size: 949
batch 299, loss: 0.0081, instance_loss: 0.0667, weighted_loss: 0.0256, label: 4, bag_size: 790
batch 319, loss: 0.0058, instance_loss: 0.2878, weighted_loss: 0.0904, label: 4, bag_size: 590
batch 339, loss: 1.6010, instance_loss: 0.6515, weighted_loss: 1.3162, label: 0, bag_size: 282
batch 359, loss: 0.0885, instance_loss: 0.2866, weighted_loss: 0.1479, label: 0, bag_size: 1289
batch 379, loss: 0.1363, instance_loss: 0.5451, weighted_loss: 0.2589, label: 4, bag_size: 436
batch 399, loss: 1.4126, instance_loss: 1.1256, weighted_loss: 1.3265, label: 1, bag_size: 1799
batch 419, loss: 0.0097, instance_loss: 0.1930, weighted_loss: 0.0647, label: 2, bag_size: 1242


class 0 clustering acc 0.9882941176470589: correct 16801/17000
class 1 clustering acc 0.45176470588235296: correct 1536/3400
Epoch: 46, train_loss: 0.1639, train_clustering_loss:  0.2916, train_error: 0.0494
class 0: acc 0.9868421052631579, correct 75/76
class 1: acc 0.85, correct 68/80
class 2: acc 0.9024390243902439, correct 74/82
class 3: acc 1.0, correct 101/101
class 4: acc 1.0, correct 86/86

Val Set, val_loss: 1.6532, val_error: 0.4400, auc: 0.8146
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0289, weighted_loss: 0.0087, label: 4, bag_size: 729
batch 39, loss: 0.0485, instance_loss: 0.4417, weighted_loss: 0.1665, label: 2, bag_size: 373
batch 59, loss: 0.0007, instance_loss: 0.0461, weighted_loss: 0.0144, label: 4, bag_size: 646
batch 79, loss: 0.0344, instance_loss: 0.2162, weighted_loss: 0.0889, label: 1, bag_size: 697
batch 99, loss: 0.0035, instance_loss: 0.1076, weighted_loss: 0.0347, label: 4, bag_size: 826
batch 119, loss: 0.0055, instance_loss: 0.1446, weighted_loss: 0.0472, label: 3, bag_size: 729
batch 139, loss: 0.0040, instance_loss: 0.0753, weighted_loss: 0.0254, label: 1, bag_size: 286
batch 159, loss: 0.0846, instance_loss: 0.2741, weighted_loss: 0.1415, label: 2, bag_size: 1119
batch 179, loss: 0.0026, instance_loss: 0.0617, weighted_loss: 0.0203, label: 4, bag_size: 524
batch 199, loss: 0.7458, instance_loss: 0.4156, weighted_loss: 0.6468, label: 2, bag_size: 1231
batch 219, loss: 0.0516, instance_loss: 0.2171, weighted_loss: 0.1013, label: 3, bag_size: 729
batch 239, loss: 4.4244, instance_loss: 0.7523, weighted_loss: 3.3227, label: 1, bag_size: 435
batch 259, loss: 0.0010, instance_loss: 0.0972, weighted_loss: 0.0299, label: 4, bag_size: 646
batch 279, loss: 0.0156, instance_loss: 0.0908, weighted_loss: 0.0382, label: 0, bag_size: 1143
batch 299, loss: 3.1610, instance_loss: 1.0101, weighted_loss: 2.5157, label: 2, bag_size: 319
batch 319, loss: 0.1948, instance_loss: 0.3756, weighted_loss: 0.2490, label: 0, bag_size: 282
batch 339, loss: 0.3913, instance_loss: 0.5992, weighted_loss: 0.4536, label: 2, bag_size: 1306
batch 359, loss: 0.0748, instance_loss: 0.4202, weighted_loss: 0.1784, label: 1, bag_size: 470
batch 379, loss: 0.0499, instance_loss: 0.2837, weighted_loss: 0.1200, label: 1, bag_size: 858
batch 399, loss: 0.0004, instance_loss: 0.3526, weighted_loss: 0.1060, label: 4, bag_size: 711
batch 419, loss: 0.0001, instance_loss: 0.0637, weighted_loss: 0.0192, label: 4, bag_size: 729


class 0 clustering acc 0.9870588235294118: correct 16780/17000
class 1 clustering acc 0.44735294117647056: correct 1521/3400
Epoch: 47, train_loss: 0.1876, train_clustering_loss:  0.3017, train_error: 0.0447
class 0: acc 0.9876543209876543, correct 80/81
class 1: acc 0.891566265060241, correct 74/83
class 2: acc 0.92, correct 92/100
class 3: acc 0.9861111111111112, correct 71/72
class 4: acc 1.0, correct 89/89

Val Set, val_loss: 1.3102, val_error: 0.4000, auc: 0.8442
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0001, instance_loss: 0.1945, weighted_loss: 0.0584, label: 1, bag_size: 1376
batch 39, loss: 0.0073, instance_loss: 0.0694, weighted_loss: 0.0259, label: 4, bag_size: 1235
batch 59, loss: 0.0656, instance_loss: 0.4636, weighted_loss: 0.1850, label: 1, bag_size: 139
batch 79, loss: 0.1116, instance_loss: 0.1804, weighted_loss: 0.1322, label: 3, bag_size: 729
batch 99, loss: 0.0152, instance_loss: 0.2244, weighted_loss: 0.0780, label: 4, bag_size: 928
batch 119, loss: 0.0149, instance_loss: 0.1628, weighted_loss: 0.0593, label: 0, bag_size: 729
batch 139, loss: 0.0000, instance_loss: 0.0560, weighted_loss: 0.0168, label: 4, bag_size: 729
batch 159, loss: 0.0191, instance_loss: 0.0775, weighted_loss: 0.0366, label: 3, bag_size: 1172
batch 179, loss: 0.4789, instance_loss: 0.2535, weighted_loss: 0.4113, label: 0, bag_size: 729
batch 199, loss: 0.0147, instance_loss: 0.0660, weighted_loss: 0.0301, label: 0, bag_size: 340
batch 219, loss: 0.0031, instance_loss: 0.3509, weighted_loss: 0.1075, label: 4, bag_size: 882
batch 239, loss: 0.0010, instance_loss: 0.0913, weighted_loss: 0.0281, label: 4, bag_size: 1474
batch 259, loss: 0.0017, instance_loss: 0.0336, weighted_loss: 0.0113, label: 0, bag_size: 1466
batch 279, loss: 0.0255, instance_loss: 0.2780, weighted_loss: 0.1012, label: 2, bag_size: 1058
batch 299, loss: 0.3844, instance_loss: 0.4632, weighted_loss: 0.4080, label: 1, bag_size: 711
batch 319, loss: 0.2838, instance_loss: 0.3632, weighted_loss: 0.3076, label: 2, bag_size: 636
batch 339, loss: 1.0717, instance_loss: 0.3806, weighted_loss: 0.8644, label: 2, bag_size: 986
batch 359, loss: 0.1684, instance_loss: 0.5470, weighted_loss: 0.2819, label: 1, bag_size: 648
batch 379, loss: 0.0479, instance_loss: 0.1872, weighted_loss: 0.0897, label: 2, bag_size: 1050
batch 399, loss: 0.1934, instance_loss: 0.2818, weighted_loss: 0.2200, label: 1, bag_size: 1014
batch 419, loss: 0.3533, instance_loss: 0.5962, weighted_loss: 0.4262, label: 2, bag_size: 1006


class 0 clustering acc 0.9879411764705882: correct 16795/17000
class 1 clustering acc 0.44794117647058823: correct 1523/3400
Epoch: 48, train_loss: 0.1624, train_clustering_loss:  0.2961, train_error: 0.0588
class 0: acc 0.9529411764705882, correct 81/85
class 1: acc 0.898876404494382, correct 80/89
class 2: acc 0.8518518518518519, correct 69/81
class 3: acc 1.0, correct 85/85
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.3907, val_error: 0.4200, auc: 0.8311
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.22: correct 88/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0251, instance_loss: 0.0935, weighted_loss: 0.0456, label: 1, bag_size: 937
batch 39, loss: 1.6026, instance_loss: 0.5316, weighted_loss: 1.2813, label: 2, bag_size: 1231
batch 59, loss: 0.0221, instance_loss: 0.1446, weighted_loss: 0.0589, label: 0, bag_size: 653
batch 79, loss: 0.0020, instance_loss: 0.0725, weighted_loss: 0.0231, label: 0, bag_size: 524
batch 99, loss: 0.0388, instance_loss: 0.0964, weighted_loss: 0.0561, label: 0, bag_size: 570
batch 119, loss: 0.0011, instance_loss: 0.0357, weighted_loss: 0.0115, label: 3, bag_size: 729
batch 139, loss: 0.0009, instance_loss: 0.1609, weighted_loss: 0.0489, label: 4, bag_size: 354
batch 159, loss: 0.0192, instance_loss: 0.3953, weighted_loss: 0.1320, label: 1, bag_size: 867
batch 179, loss: 0.0000, instance_loss: 0.1612, weighted_loss: 0.0484, label: 1, bag_size: 1376
batch 199, loss: 0.3964, instance_loss: 0.5757, weighted_loss: 0.4502, label: 1, bag_size: 446
batch 219, loss: 0.0346, instance_loss: 0.1439, weighted_loss: 0.0674, label: 0, bag_size: 1190
batch 239, loss: 0.6426, instance_loss: 0.3947, weighted_loss: 0.5683, label: 0, bag_size: 432
batch 259, loss: 0.0012, instance_loss: 0.2700, weighted_loss: 0.0818, label: 4, bag_size: 947
batch 279, loss: 1.4239, instance_loss: 0.5518, weighted_loss: 1.1623, label: 1, bag_size: 1273
batch 299, loss: 0.0151, instance_loss: 0.3616, weighted_loss: 0.1191, label: 1, bag_size: 925
batch 319, loss: 0.0315, instance_loss: 0.5417, weighted_loss: 0.1846, label: 1, bag_size: 598
batch 339, loss: 0.0029, instance_loss: 0.1140, weighted_loss: 0.0362, label: 4, bag_size: 524
batch 359, loss: 0.0053, instance_loss: 0.0921, weighted_loss: 0.0313, label: 0, bag_size: 246
batch 379, loss: 0.0085, instance_loss: 0.2536, weighted_loss: 0.0820, label: 1, bag_size: 690
batch 399, loss: 0.0068, instance_loss: 0.2701, weighted_loss: 0.0858, label: 1, bag_size: 1127
batch 419, loss: 0.0025, instance_loss: 0.0563, weighted_loss: 0.0186, label: 0, bag_size: 1135


class 0 clustering acc 0.9886470588235294: correct 16807/17000
class 1 clustering acc 0.4585294117647059: correct 1559/3400
Epoch: 49, train_loss: 0.1525, train_clustering_loss:  0.2911, train_error: 0.0400
class 0: acc 0.9891304347826086, correct 91/92
class 1: acc 0.9047619047619048, correct 76/84
class 2: acc 0.9175257731958762, correct 89/97
class 3: acc 1.0, correct 71/71
class 4: acc 1.0, correct 81/81

Val Set, val_loss: 1.6885, val_error: 0.4400, auc: 0.8088
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0018, instance_loss: 0.2014, weighted_loss: 0.0617, label: 1, bag_size: 504
batch 39, loss: 0.1457, instance_loss: 0.2409, weighted_loss: 0.1743, label: 1, bag_size: 1144
batch 59, loss: 0.0087, instance_loss: 0.0431, weighted_loss: 0.0190, label: 0, bag_size: 1143
batch 79, loss: 0.0448, instance_loss: 0.5703, weighted_loss: 0.2025, label: 3, bag_size: 281
batch 99, loss: 0.0226, instance_loss: 0.2307, weighted_loss: 0.0850, label: 3, bag_size: 936
batch 119, loss: 0.0084, instance_loss: 0.0654, weighted_loss: 0.0255, label: 4, bag_size: 764
batch 139, loss: 0.0022, instance_loss: 0.3591, weighted_loss: 0.1092, label: 3, bag_size: 849
batch 159, loss: 0.6482, instance_loss: 0.6832, weighted_loss: 0.6587, label: 2, bag_size: 295
batch 179, loss: 0.0159, instance_loss: 0.0991, weighted_loss: 0.0409, label: 3, bag_size: 729
batch 199, loss: 0.0003, instance_loss: 0.4128, weighted_loss: 0.1241, label: 4, bag_size: 711
batch 219, loss: 0.0069, instance_loss: 0.3405, weighted_loss: 0.1070, label: 2, bag_size: 1218
batch 239, loss: 3.8791, instance_loss: 0.8010, weighted_loss: 2.9556, label: 1, bag_size: 770
batch 259, loss: 0.2843, instance_loss: 0.0405, weighted_loss: 0.2112, label: 4, bag_size: 764
batch 279, loss: 0.0094, instance_loss: 0.5303, weighted_loss: 0.1656, label: 2, bag_size: 373
batch 299, loss: 0.0022, instance_loss: 0.1304, weighted_loss: 0.0406, label: 4, bag_size: 1121
batch 319, loss: 0.0236, instance_loss: 0.1630, weighted_loss: 0.0654, label: 0, bag_size: 410
batch 339, loss: 0.0283, instance_loss: 0.2733, weighted_loss: 0.1018, label: 2, bag_size: 470
batch 359, loss: 0.0233, instance_loss: 0.1014, weighted_loss: 0.0467, label: 3, bag_size: 729
batch 379, loss: 0.3342, instance_loss: 0.3423, weighted_loss: 0.3366, label: 2, bag_size: 1289
batch 399, loss: 0.5109, instance_loss: 0.4895, weighted_loss: 0.5045, label: 1, bag_size: 1273
batch 419, loss: 0.1436, instance_loss: 0.3378, weighted_loss: 0.2018, label: 0, bag_size: 736


class 0 clustering acc 0.9882941176470589: correct 16801/17000
class 1 clustering acc 0.46941176470588236: correct 1596/3400
Epoch: 50, train_loss: 0.1291, train_clustering_loss:  0.2944, train_error: 0.0306
class 0: acc 0.9882352941176471, correct 84/85
class 1: acc 0.922077922077922, correct 71/77
class 2: acc 0.9294117647058824, correct 79/85
class 3: acc 1.0, correct 93/93
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.5996, val_error: 0.3800, auc: 0.8397
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0251, instance_loss: 0.2766, weighted_loss: 0.1006, label: 2, bag_size: 600
batch 39, loss: 0.0058, instance_loss: 0.0755, weighted_loss: 0.0267, label: 0, bag_size: 729
batch 59, loss: 0.0048, instance_loss: 0.4870, weighted_loss: 0.1495, label: 1, bag_size: 1390
batch 79, loss: 0.0062, instance_loss: 0.0399, weighted_loss: 0.0163, label: 4, bag_size: 646
batch 99, loss: 0.0078, instance_loss: 0.1032, weighted_loss: 0.0364, label: 0, bag_size: 729
batch 119, loss: 0.0007, instance_loss: 0.2745, weighted_loss: 0.0828, label: 4, bag_size: 1357
batch 139, loss: 0.5055, instance_loss: 1.2251, weighted_loss: 0.7214, label: 1, bag_size: 1799
batch 159, loss: 0.0061, instance_loss: 0.2292, weighted_loss: 0.0730, label: 4, bag_size: 1002
batch 179, loss: 0.0023, instance_loss: 0.1397, weighted_loss: 0.0435, label: 4, bag_size: 882
batch 199, loss: 0.0885, instance_loss: 0.5625, weighted_loss: 0.2307, label: 3, bag_size: 200
batch 219, loss: 0.0058, instance_loss: 0.1054, weighted_loss: 0.0357, label: 0, bag_size: 729
batch 239, loss: 0.0899, instance_loss: 0.2671, weighted_loss: 0.1431, label: 2, bag_size: 265
batch 259, loss: 0.3004, instance_loss: 0.2809, weighted_loss: 0.2945, label: 2, bag_size: 1039
batch 279, loss: 0.0541, instance_loss: 0.0708, weighted_loss: 0.0591, label: 3, bag_size: 556
batch 299, loss: 0.0313, instance_loss: 0.2944, weighted_loss: 0.1102, label: 1, bag_size: 959
batch 319, loss: 0.0004, instance_loss: 0.0464, weighted_loss: 0.0142, label: 3, bag_size: 729
batch 339, loss: 0.0154, instance_loss: 0.0737, weighted_loss: 0.0329, label: 3, bag_size: 729
batch 359, loss: 0.0156, instance_loss: 0.2456, weighted_loss: 0.0846, label: 2, bag_size: 405
batch 379, loss: 0.0147, instance_loss: 0.3198, weighted_loss: 0.1062, label: 1, bag_size: 1080
batch 399, loss: 0.0002, instance_loss: 0.2456, weighted_loss: 0.0738, label: 4, bag_size: 1357
batch 419, loss: 0.0374, instance_loss: 0.2893, weighted_loss: 0.1130, label: 2, bag_size: 913


class 0 clustering acc 0.9871764705882353: correct 16782/17000
class 1 clustering acc 0.4761764705882353: correct 1619/3400
Epoch: 51, train_loss: 0.1440, train_clustering_loss:  0.2893, train_error: 0.0518
class 0: acc 0.9880952380952381, correct 83/84
class 1: acc 0.9393939393939394, correct 93/99
class 2: acc 0.8390804597701149, correct 73/87
class 3: acc 1.0, correct 71/71
class 4: acc 0.9880952380952381, correct 83/84

Val Set, val_loss: 1.6388, val_error: 0.3800, auc: 0.8170
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8571428571428571, correct 18/21
class 3: acc 0.0, correct 0/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 35 out of 20
Early stopping
Val error: 0.3400, ROC AUC: 0.8515
Test error: 0.4000, ROC AUC: 0.8779
class 0: acc 1.0, correct 12/12
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.2857142857142857, correct 6/21
class 3: acc 0.8, correct 4/5
class 4: acc 1.0, correct 1/1

Training Fold 7!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7048, instance_loss: 1.2251, weighted_loss: 1.5609, label: 4, bag_size: 1176
batch 39, loss: 1.5860, instance_loss: 1.1153, weighted_loss: 1.4448, label: 3, bag_size: 729
batch 59, loss: 1.5605, instance_loss: 0.9361, weighted_loss: 1.3732, label: 0, bag_size: 729
batch 79, loss: 1.5016, instance_loss: 0.7341, weighted_loss: 1.2714, label: 0, bag_size: 818
batch 99, loss: 1.6857, instance_loss: 0.6470, weighted_loss: 1.3741, label: 1, bag_size: 846
batch 119, loss: 1.6207, instance_loss: 0.5796, weighted_loss: 1.3084, label: 3, bag_size: 729
batch 139, loss: 1.9933, instance_loss: 0.5637, weighted_loss: 1.5644, label: 2, bag_size: 1197
batch 159, loss: 1.7483, instance_loss: 0.5483, weighted_loss: 1.3883, label: 3, bag_size: 729
batch 179, loss: 1.6258, instance_loss: 0.5177, weighted_loss: 1.2934, label: 2, bag_size: 518
batch 199, loss: 1.8004, instance_loss: 0.5163, weighted_loss: 1.4152, label: 1, bag_size: 435
batch 219, loss: 1.5638, instance_loss: 0.4960, weighted_loss: 1.2435, label: 2, bag_size: 636
batch 239, loss: 1.5477, instance_loss: 0.4924, weighted_loss: 1.2311, label: 2, bag_size: 270
batch 259, loss: 1.6231, instance_loss: 0.4910, weighted_loss: 1.2835, label: 2, bag_size: 271
batch 279, loss: 1.8083, instance_loss: 0.5287, weighted_loss: 1.4244, label: 0, bag_size: 729
batch 299, loss: 1.7650, instance_loss: 0.5186, weighted_loss: 1.3911, label: 0, bag_size: 933
batch 319, loss: 1.4618, instance_loss: 0.4979, weighted_loss: 1.1727, label: 1, bag_size: 696
batch 339, loss: 1.3997, instance_loss: 0.4747, weighted_loss: 1.1222, label: 3, bag_size: 1253
batch 359, loss: 1.4423, instance_loss: 0.4865, weighted_loss: 1.1556, label: 3, bag_size: 316
batch 379, loss: 1.2303, instance_loss: 0.4751, weighted_loss: 1.0038, label: 4, bag_size: 656
batch 399, loss: 1.8673, instance_loss: 0.5289, weighted_loss: 1.4657, label: 1, bag_size: 861
batch 419, loss: 1.5385, instance_loss: 0.5186, weighted_loss: 1.2325, label: 0, bag_size: 912


class 0 clustering acc 0.9922941176470588: correct 16869/17000
class 1 clustering acc 0.007941176470588234: correct 27/3400
Epoch: 0, train_loss: 1.5907, train_clustering_loss:  0.6289, train_error: 0.7576
class 0: acc 0.25882352941176473, correct 22/85
class 1: acc 0.0875, correct 7/80
class 2: acc 0.013888888888888888, correct 1/72
class 3: acc 0.20238095238095238, correct 17/84
class 4: acc 0.5384615384615384, correct 56/104

Val Set, val_loss: 1.6692, val_error: 0.9800, auc: 0.7029
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/4
class 1: acc 0.0, correct 0/15
class 2: acc 0.0, correct 0/24
class 3: acc 0.0, correct 0/6
class 4: acc 1.0, correct 1/1
Validation loss decreased (inf --> 1.669228).  Saving model ...


batch 19, loss: 1.5207, instance_loss: 0.5264, weighted_loss: 1.2224, label: 2, bag_size: 1139
batch 39, loss: 1.5947, instance_loss: 0.5203, weighted_loss: 1.2723, label: 2, bag_size: 330
batch 59, loss: 1.2624, instance_loss: 0.4815, weighted_loss: 1.0281, label: 0, bag_size: 446
batch 79, loss: 1.7013, instance_loss: 0.5154, weighted_loss: 1.3455, label: 1, bag_size: 1724
batch 99, loss: 1.5012, instance_loss: 0.5104, weighted_loss: 1.2040, label: 0, bag_size: 729
batch 119, loss: 1.2487, instance_loss: 0.4739, weighted_loss: 1.0163, label: 0, bag_size: 518
batch 139, loss: 1.1724, instance_loss: 0.4648, weighted_loss: 0.9601, label: 0, bag_size: 990
batch 159, loss: 1.5752, instance_loss: 0.5126, weighted_loss: 1.2564, label: 1, bag_size: 866
batch 179, loss: 1.7458, instance_loss: 0.5181, weighted_loss: 1.3775, label: 3, bag_size: 556
batch 199, loss: 1.3111, instance_loss: 0.5009, weighted_loss: 1.0680, label: 1, bag_size: 636
batch 219, loss: 1.3711, instance_loss: 0.4870, weighted_loss: 1.1058, label: 4, bag_size: 210
batch 239, loss: 1.2318, instance_loss: 0.4815, weighted_loss: 1.0067, label: 0, bag_size: 1579
batch 259, loss: 1.5559, instance_loss: 0.4874, weighted_loss: 1.2354, label: 4, bag_size: 882
batch 279, loss: 1.0797, instance_loss: 0.4586, weighted_loss: 0.8934, label: 0, bag_size: 570
batch 299, loss: 1.5173, instance_loss: 0.5071, weighted_loss: 1.2142, label: 1, bag_size: 903
batch 319, loss: 1.3661, instance_loss: 0.4724, weighted_loss: 1.0980, label: 3, bag_size: 729
batch 339, loss: 1.8391, instance_loss: 0.5318, weighted_loss: 1.4469, label: 1, bag_size: 1172
batch 359, loss: 1.5557, instance_loss: 0.5177, weighted_loss: 1.2443, label: 1, bag_size: 790
batch 379, loss: 1.5699, instance_loss: 0.5321, weighted_loss: 1.2585, label: 1, bag_size: 994
batch 399, loss: 1.5585, instance_loss: 0.4556, weighted_loss: 1.2276, label: 3, bag_size: 952
batch 419, loss: 1.6543, instance_loss: 0.5125, weighted_loss: 1.3118, label: 2, bag_size: 323


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.5019, train_clustering_loss:  0.5021, train_error: 0.6541
class 0: acc 0.6138613861386139, correct 62/101
class 1: acc 0.14473684210526316, correct 11/76
class 2: acc 0.012658227848101266, correct 1/79
class 3: acc 0.367816091954023, correct 32/87
class 4: acc 0.5, correct 41/82

Val Set, val_loss: 1.4721, val_error: 0.6200, auc: 0.7581
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/4
class 1: acc 0.2, correct 3/15
class 2: acc 0.4583333333333333, correct 11/24
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 1.0, correct 1/1
Validation loss decreased (1.669228 --> 1.472056).  Saving model ...


batch 19, loss: 1.4705, instance_loss: 0.4998, weighted_loss: 1.1793, label: 2, bag_size: 1150
batch 39, loss: 0.7096, instance_loss: 0.4457, weighted_loss: 0.6304, label: 4, bag_size: 729
batch 59, loss: 1.2830, instance_loss: 0.4967, weighted_loss: 1.0471, label: 2, bag_size: 777
batch 79, loss: 1.1578, instance_loss: 0.4226, weighted_loss: 0.9372, label: 3, bag_size: 729
batch 99, loss: 1.5526, instance_loss: 0.5176, weighted_loss: 1.2421, label: 1, bag_size: 1086
batch 119, loss: 0.8120, instance_loss: 0.4183, weighted_loss: 0.6939, label: 0, bag_size: 402
batch 139, loss: 0.7283, instance_loss: 0.3590, weighted_loss: 0.6175, label: 3, bag_size: 729
batch 159, loss: 0.9961, instance_loss: 0.4711, weighted_loss: 0.8386, label: 1, bag_size: 1127
batch 179, loss: 0.9366, instance_loss: 0.4664, weighted_loss: 0.7956, label: 0, bag_size: 1086
batch 199, loss: 1.4482, instance_loss: 0.4981, weighted_loss: 1.1632, label: 2, bag_size: 684
batch 219, loss: 0.8569, instance_loss: 0.4181, weighted_loss: 0.7252, label: 1, bag_size: 903
batch 239, loss: 0.7037, instance_loss: 0.3992, weighted_loss: 0.6124, label: 3, bag_size: 451
batch 259, loss: 1.6374, instance_loss: 0.4853, weighted_loss: 1.2918, label: 1, bag_size: 1724
batch 279, loss: 1.3099, instance_loss: 0.4654, weighted_loss: 1.0565, label: 1, bag_size: 913
batch 299, loss: 0.6456, instance_loss: 0.4096, weighted_loss: 0.5748, label: 0, bag_size: 1143
batch 319, loss: 0.8488, instance_loss: 0.4378, weighted_loss: 0.7255, label: 1, bag_size: 1376
batch 339, loss: 1.6001, instance_loss: 0.5404, weighted_loss: 1.2822, label: 2, bag_size: 248
batch 359, loss: 1.1618, instance_loss: 0.4519, weighted_loss: 0.9488, label: 1, bag_size: 965
batch 379, loss: 1.4822, instance_loss: 0.4698, weighted_loss: 1.1784, label: 1, bag_size: 648
batch 399, loss: 1.6329, instance_loss: 0.4308, weighted_loss: 1.2723, label: 3, bag_size: 533
batch 419, loss: 1.3054, instance_loss: 0.5072, weighted_loss: 1.0660, label: 0, bag_size: 912


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0002941176470588235: correct 1/3400
Epoch: 2, train_loss: 1.2982, train_clustering_loss:  0.4742, train_error: 0.4612
class 0: acc 0.6091954022988506, correct 53/87
class 1: acc 0.5662650602409639, correct 47/83
class 2: acc 0.26136363636363635, correct 23/88
class 3: acc 0.7555555555555555, correct 68/90
class 4: acc 0.4935064935064935, correct 38/77

Val Set, val_loss: 1.2765, val_error: 0.5200, auc: 0.8166
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
Validation loss decreased (1.472056 --> 1.276535).  Saving model ...


batch 19, loss: 0.8504, instance_loss: 0.4142, weighted_loss: 0.7195, label: 1, bag_size: 834
batch 39, loss: 1.9120, instance_loss: 0.5409, weighted_loss: 1.5007, label: 4, bag_size: 947
batch 59, loss: 1.7450, instance_loss: 0.5167, weighted_loss: 1.3765, label: 4, bag_size: 533
batch 79, loss: 1.4589, instance_loss: 0.5065, weighted_loss: 1.1732, label: 0, bag_size: 545
batch 99, loss: 2.0798, instance_loss: 0.6247, weighted_loss: 1.6433, label: 1, bag_size: 1409
batch 119, loss: 1.3009, instance_loss: 0.4821, weighted_loss: 1.0553, label: 4, bag_size: 297
batch 139, loss: 2.0691, instance_loss: 0.5610, weighted_loss: 1.6167, label: 2, bag_size: 571
batch 159, loss: 0.8593, instance_loss: 0.2855, weighted_loss: 0.6871, label: 3, bag_size: 729
batch 179, loss: 1.3250, instance_loss: 0.5146, weighted_loss: 1.0819, label: 0, bag_size: 756
batch 199, loss: 1.3578, instance_loss: 0.4997, weighted_loss: 1.1004, label: 0, bag_size: 413
batch 219, loss: 0.4126, instance_loss: 0.2967, weighted_loss: 0.3779, label: 1, bag_size: 286
batch 239, loss: 1.6948, instance_loss: 0.5178, weighted_loss: 1.3417, label: 4, bag_size: 1331
batch 259, loss: 1.1128, instance_loss: 0.4969, weighted_loss: 0.9280, label: 2, bag_size: 1141
batch 279, loss: 1.5279, instance_loss: 0.5451, weighted_loss: 1.2331, label: 0, bag_size: 1190
batch 299, loss: 2.1610, instance_loss: 0.5124, weighted_loss: 1.6664, label: 4, bag_size: 1235
batch 319, loss: 1.1286, instance_loss: 0.4650, weighted_loss: 0.9296, label: 2, bag_size: 869
batch 339, loss: 0.9156, instance_loss: 0.5364, weighted_loss: 0.8018, label: 4, bag_size: 882
batch 359, loss: 0.4581, instance_loss: 0.4113, weighted_loss: 0.4441, label: 4, bag_size: 729
batch 379, loss: 1.0271, instance_loss: 0.4774, weighted_loss: 0.8622, label: 0, bag_size: 381
batch 399, loss: 0.7388, instance_loss: 0.4175, weighted_loss: 0.6425, label: 0, bag_size: 367
batch 419, loss: 0.9056, instance_loss: 0.4447, weighted_loss: 0.7673, label: 2, bag_size: 632


class 0 clustering acc 0.9996470588235294: correct 16994/17000
class 1 clustering acc 0.02176470588235294: correct 74/3400
Epoch: 3, train_loss: 1.1015, train_clustering_loss:  0.4349, train_error: 0.3671
class 0: acc 0.6756756756756757, correct 50/74
class 1: acc 0.6344086021505376, correct 59/93
class 2: acc 0.47191011235955055, correct 42/89
class 3: acc 0.82, correct 82/100
class 4: acc 0.5217391304347826, correct 36/69

Val Set, val_loss: 1.1304, val_error: 0.4200, auc: 0.8243
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.005: correct 2/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.8, correct 12/15
class 2: acc 0.5833333333333334, correct 14/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
Validation loss decreased (1.276535 --> 1.130433).  Saving model ...


batch 19, loss: 0.2225, instance_loss: 0.2249, weighted_loss: 0.2232, label: 3, bag_size: 451
batch 39, loss: 0.3705, instance_loss: 0.2415, weighted_loss: 0.3318, label: 1, bag_size: 847
batch 59, loss: 1.5098, instance_loss: 0.5555, weighted_loss: 1.2235, label: 0, bag_size: 912
batch 79, loss: 1.2633, instance_loss: 0.5263, weighted_loss: 1.0422, label: 3, bag_size: 283
batch 99, loss: 0.9338, instance_loss: 0.4850, weighted_loss: 0.7991, label: 0, bag_size: 976
batch 119, loss: 0.6226, instance_loss: 0.2426, weighted_loss: 0.5086, label: 3, bag_size: 729
batch 139, loss: 0.8017, instance_loss: 0.4557, weighted_loss: 0.6979, label: 4, bag_size: 826
batch 159, loss: 1.2837, instance_loss: 0.4713, weighted_loss: 1.0400, label: 4, bag_size: 1357
batch 179, loss: 0.8098, instance_loss: 0.4451, weighted_loss: 0.7004, label: 4, bag_size: 1176
batch 199, loss: 1.8933, instance_loss: 0.6873, weighted_loss: 1.5315, label: 2, bag_size: 916
batch 219, loss: 1.4905, instance_loss: 0.5461, weighted_loss: 1.2072, label: 2, bag_size: 399
batch 239, loss: 0.3486, instance_loss: 0.3255, weighted_loss: 0.3416, label: 0, bag_size: 1872
batch 259, loss: 0.5165, instance_loss: 0.3707, weighted_loss: 0.4728, label: 0, bag_size: 367
batch 279, loss: 1.2420, instance_loss: 0.4739, weighted_loss: 1.0116, label: 1, bag_size: 778
batch 299, loss: 1.5078, instance_loss: 0.5439, weighted_loss: 1.2186, label: 4, bag_size: 625
batch 319, loss: 2.1475, instance_loss: 0.6252, weighted_loss: 1.6908, label: 0, bag_size: 1257
batch 339, loss: 2.0950, instance_loss: 0.5513, weighted_loss: 1.6319, label: 1, bag_size: 446
batch 359, loss: 0.5942, instance_loss: 0.2862, weighted_loss: 0.5018, label: 1, bag_size: 1325
batch 379, loss: 0.1422, instance_loss: 0.1046, weighted_loss: 0.1309, label: 3, bag_size: 1399
batch 399, loss: 1.6537, instance_loss: 0.5219, weighted_loss: 1.3142, label: 2, bag_size: 1006
batch 419, loss: 0.6177, instance_loss: 0.3914, weighted_loss: 0.5498, label: 4, bag_size: 817


class 0 clustering acc 0.9981176470588236: correct 16968/17000
class 1 clustering acc 0.07794117647058824: correct 265/3400
Epoch: 4, train_loss: 0.9934, train_clustering_loss:  0.4232, train_error: 0.3788
class 0: acc 0.75, correct 57/76
class 1: acc 0.6593406593406593, correct 60/91
class 2: acc 0.3793103448275862, correct 33/87
class 3: acc 0.7415730337078652, correct 66/89
class 4: acc 0.5853658536585366, correct 48/82

Val Set, val_loss: 1.2067, val_error: 0.4800, auc: 0.8202
class 0 clustering acc 0.995: correct 1990/2000
class 1 clustering acc 0.01: correct 4/400
class 0: acc 0.0, correct 0/4
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.75, correct 18/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2971, instance_loss: 0.5013, weighted_loss: 1.0584, label: 0, bag_size: 371
batch 39, loss: 0.4769, instance_loss: 0.3597, weighted_loss: 0.4417, label: 2, bag_size: 1155
batch 59, loss: 0.7152, instance_loss: 0.4233, weighted_loss: 0.6276, label: 2, bag_size: 461
batch 79, loss: 0.8307, instance_loss: 0.3706, weighted_loss: 0.6927, label: 1, bag_size: 1239
batch 99, loss: 0.6331, instance_loss: 0.5367, weighted_loss: 0.6042, label: 4, bag_size: 882
batch 119, loss: 0.2699, instance_loss: 0.3861, weighted_loss: 0.3047, label: 0, bag_size: 1133
batch 139, loss: 0.2801, instance_loss: 0.3543, weighted_loss: 0.3024, label: 4, bag_size: 1278
batch 159, loss: 0.2012, instance_loss: 0.3931, weighted_loss: 0.2588, label: 4, bag_size: 882
batch 179, loss: 0.6176, instance_loss: 0.4835, weighted_loss: 0.5774, label: 0, bag_size: 729
batch 199, loss: 1.4703, instance_loss: 0.5622, weighted_loss: 1.1979, label: 2, bag_size: 518
batch 219, loss: 0.2968, instance_loss: 0.3992, weighted_loss: 0.3275, label: 0, bag_size: 729
batch 239, loss: 0.2600, instance_loss: 0.1463, weighted_loss: 0.2259, label: 3, bag_size: 729
batch 259, loss: 2.8465, instance_loss: 0.6541, weighted_loss: 2.1888, label: 4, bag_size: 210
batch 279, loss: 0.5568, instance_loss: 0.3737, weighted_loss: 0.5019, label: 1, bag_size: 913
batch 299, loss: 0.0951, instance_loss: 0.0890, weighted_loss: 0.0933, label: 3, bag_size: 729
batch 319, loss: 0.2638, instance_loss: 0.2171, weighted_loss: 0.2498, label: 4, bag_size: 729
batch 339, loss: 0.6565, instance_loss: 0.4748, weighted_loss: 0.6020, label: 0, bag_size: 1174
batch 359, loss: 0.3100, instance_loss: 0.3246, weighted_loss: 0.3144, label: 0, bag_size: 1466
batch 379, loss: 0.3777, instance_loss: 0.2721, weighted_loss: 0.3460, label: 1, bag_size: 369
batch 399, loss: 0.2789, instance_loss: 0.1545, weighted_loss: 0.2416, label: 3, bag_size: 729
batch 419, loss: 0.4895, instance_loss: 0.2160, weighted_loss: 0.4075, label: 3, bag_size: 697


class 0 clustering acc 0.9972352941176471: correct 16953/17000
class 1 clustering acc 0.13264705882352942: correct 451/3400
Epoch: 5, train_loss: 0.9135, train_clustering_loss:  0.3999, train_error: 0.3271
class 0: acc 0.8045977011494253, correct 70/87
class 1: acc 0.475, correct 38/80
class 2: acc 0.42028985507246375, correct 29/69
class 3: acc 0.7755102040816326, correct 76/98
class 4: acc 0.8021978021978022, correct 73/91

Val Set, val_loss: 1.2479, val_error: 0.5200, auc: 0.8188
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.0175: correct 7/400
class 0: acc 1.0, correct 4/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.375, correct 9/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9205, instance_loss: 0.4272, weighted_loss: 0.7725, label: 2, bag_size: 1289
batch 39, loss: 0.4806, instance_loss: 0.3745, weighted_loss: 0.4488, label: 0, bag_size: 367
batch 59, loss: 0.1861, instance_loss: 0.1429, weighted_loss: 0.1732, label: 3, bag_size: 729
batch 79, loss: 0.2242, instance_loss: 0.1768, weighted_loss: 0.2100, label: 3, bag_size: 451
batch 99, loss: 0.1878, instance_loss: 0.2550, weighted_loss: 0.2079, label: 4, bag_size: 764
batch 119, loss: 0.5996, instance_loss: 0.3856, weighted_loss: 0.5354, label: 0, bag_size: 476
batch 139, loss: 0.7845, instance_loss: 0.4961, weighted_loss: 0.6980, label: 0, bag_size: 524
batch 159, loss: 0.7294, instance_loss: 0.4294, weighted_loss: 0.6394, label: 2, bag_size: 868
batch 179, loss: 1.0158, instance_loss: 0.5113, weighted_loss: 0.8644, label: 1, bag_size: 1376
batch 199, loss: 0.2920, instance_loss: 0.2746, weighted_loss: 0.2868, label: 4, bag_size: 729
batch 219, loss: 0.7751, instance_loss: 0.3152, weighted_loss: 0.6371, label: 1, bag_size: 834
batch 239, loss: 0.1069, instance_loss: 0.1385, weighted_loss: 0.1164, label: 3, bag_size: 729
batch 259, loss: 0.1494, instance_loss: 0.2034, weighted_loss: 0.1656, label: 4, bag_size: 1235
batch 279, loss: 2.3314, instance_loss: 0.5821, weighted_loss: 1.8066, label: 2, bag_size: 373
batch 299, loss: 0.4165, instance_loss: 0.1792, weighted_loss: 0.3454, label: 3, bag_size: 316
batch 319, loss: 0.2145, instance_loss: 0.3018, weighted_loss: 0.2407, label: 4, bag_size: 663
batch 339, loss: 0.1485, instance_loss: 0.2212, weighted_loss: 0.1703, label: 4, bag_size: 729
batch 359, loss: 0.1818, instance_loss: 0.1772, weighted_loss: 0.1804, label: 3, bag_size: 952
batch 379, loss: 0.6930, instance_loss: 0.4721, weighted_loss: 0.6267, label: 2, bag_size: 868
batch 399, loss: 0.6065, instance_loss: 0.4617, weighted_loss: 0.5631, label: 0, bag_size: 718
batch 419, loss: 0.3433, instance_loss: 0.2018, weighted_loss: 0.3008, label: 3, bag_size: 729


class 0 clustering acc 0.9962941176470588: correct 16937/17000
class 1 clustering acc 0.16176470588235295: correct 550/3400
Epoch: 6, train_loss: 0.8658, train_clustering_loss:  0.3946, train_error: 0.3176
class 0: acc 0.8115942028985508, correct 56/69
class 1: acc 0.5647058823529412, correct 48/85
class 2: acc 0.4578313253012048, correct 38/83
class 3: acc 0.797752808988764, correct 71/89
class 4: acc 0.7777777777777778, correct 77/99

Val Set, val_loss: 1.3529, val_error: 0.6400, auc: 0.8128
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.025: correct 10/400
class 0: acc 1.0, correct 4/4
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.25, correct 6/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2786, instance_loss: 0.3095, weighted_loss: 0.2879, label: 0, bag_size: 521
batch 39, loss: 0.1563, instance_loss: 0.1905, weighted_loss: 0.1665, label: 3, bag_size: 729
batch 59, loss: 0.2977, instance_loss: 0.3623, weighted_loss: 0.3171, label: 0, bag_size: 933
batch 79, loss: 1.4768, instance_loss: 0.5194, weighted_loss: 1.1896, label: 2, bag_size: 869
batch 99, loss: 3.4347, instance_loss: 0.6959, weighted_loss: 2.6131, label: 0, bag_size: 818
batch 119, loss: 1.1095, instance_loss: 0.4256, weighted_loss: 0.9043, label: 2, bag_size: 357
batch 139, loss: 0.3652, instance_loss: 0.2088, weighted_loss: 0.3183, label: 3, bag_size: 729
batch 159, loss: 0.0501, instance_loss: 0.2336, weighted_loss: 0.1051, label: 4, bag_size: 1474
batch 179, loss: 2.6869, instance_loss: 0.6283, weighted_loss: 2.0693, label: 4, bag_size: 511
batch 199, loss: 0.8239, instance_loss: 0.4172, weighted_loss: 0.7019, label: 1, bag_size: 648
batch 219, loss: 0.0424, instance_loss: 0.0407, weighted_loss: 0.0419, label: 3, bag_size: 1069
batch 239, loss: 0.1997, instance_loss: 0.2881, weighted_loss: 0.2263, label: 4, bag_size: 826
batch 259, loss: 0.0342, instance_loss: 0.1327, weighted_loss: 0.0638, label: 4, bag_size: 646
batch 279, loss: 1.7572, instance_loss: 0.5057, weighted_loss: 1.3818, label: 1, bag_size: 386
batch 299, loss: 1.4643, instance_loss: 0.5385, weighted_loss: 1.1866, label: 2, bag_size: 629
batch 319, loss: 0.3718, instance_loss: 0.3058, weighted_loss: 0.3520, label: 1, bag_size: 746
batch 339, loss: 0.4222, instance_loss: 0.3129, weighted_loss: 0.3894, label: 2, bag_size: 461
batch 359, loss: 0.8222, instance_loss: 0.4154, weighted_loss: 0.7002, label: 2, bag_size: 1242
batch 379, loss: 0.6230, instance_loss: 0.4180, weighted_loss: 0.5615, label: 2, bag_size: 868
batch 399, loss: 0.9032, instance_loss: 0.4197, weighted_loss: 0.7582, label: 2, bag_size: 1164
batch 419, loss: 0.5680, instance_loss: 0.3725, weighted_loss: 0.5093, label: 0, bag_size: 545


class 0 clustering acc 0.9966470588235294: correct 16943/17000
class 1 clustering acc 0.19029411764705884: correct 647/3400
Epoch: 7, train_loss: 0.7608, train_clustering_loss:  0.3707, train_error: 0.2753
class 0: acc 0.8645833333333334, correct 83/96
class 1: acc 0.5681818181818182, correct 50/88
class 2: acc 0.4939759036144578, correct 41/83
class 3: acc 0.9027777777777778, correct 65/72
class 4: acc 0.8023255813953488, correct 69/86

Val Set, val_loss: 1.2793, val_error: 0.5400, auc: 0.8141
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.0475: correct 19/400
class 0: acc 1.0, correct 4/4
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.20833333333333334, correct 5/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0784, instance_loss: 0.2960, weighted_loss: 0.1437, label: 4, bag_size: 711
batch 39, loss: 0.3456, instance_loss: 0.5353, weighted_loss: 0.4026, label: 4, bag_size: 663
batch 59, loss: 0.0170, instance_loss: 0.0782, weighted_loss: 0.0354, label: 3, bag_size: 1172
batch 79, loss: 1.5275, instance_loss: 0.5817, weighted_loss: 1.2437, label: 4, bag_size: 1337
batch 99, loss: 0.2213, instance_loss: 0.0987, weighted_loss: 0.1845, label: 3, bag_size: 729
batch 119, loss: 1.0628, instance_loss: 0.4538, weighted_loss: 0.8801, label: 4, bag_size: 297
batch 139, loss: 0.2119, instance_loss: 0.3804, weighted_loss: 0.2624, label: 3, bag_size: 936
batch 159, loss: 0.1531, instance_loss: 0.0877, weighted_loss: 0.1335, label: 3, bag_size: 556
batch 179, loss: 3.3902, instance_loss: 0.7661, weighted_loss: 2.6029, label: 4, bag_size: 210
batch 199, loss: 1.0507, instance_loss: 0.5421, weighted_loss: 0.8981, label: 1, bag_size: 936
batch 219, loss: 1.0094, instance_loss: 0.4275, weighted_loss: 0.8348, label: 1, bag_size: 887
batch 239, loss: 0.3186, instance_loss: 0.2426, weighted_loss: 0.2958, label: 1, bag_size: 903
batch 259, loss: 0.2420, instance_loss: 0.3442, weighted_loss: 0.2726, label: 4, bag_size: 729
batch 279, loss: 0.1008, instance_loss: 0.2531, weighted_loss: 0.1465, label: 3, bag_size: 841
batch 299, loss: 0.3394, instance_loss: 0.3351, weighted_loss: 0.3381, label: 0, bag_size: 731
batch 319, loss: 1.5936, instance_loss: 0.5726, weighted_loss: 1.2873, label: 2, bag_size: 518
batch 339, loss: 0.7252, instance_loss: 0.4229, weighted_loss: 0.6345, label: 2, bag_size: 480
batch 359, loss: 0.0999, instance_loss: 0.0558, weighted_loss: 0.0867, label: 3, bag_size: 405
batch 379, loss: 1.4624, instance_loss: 0.6190, weighted_loss: 1.2093, label: 2, bag_size: 967
batch 399, loss: 0.4235, instance_loss: 0.2731, weighted_loss: 0.3784, label: 1, bag_size: 869
batch 419, loss: 1.2289, instance_loss: 0.4249, weighted_loss: 0.9877, label: 3, bag_size: 1250


class 0 clustering acc 0.9950588235294118: correct 16916/17000
class 1 clustering acc 0.21382352941176472: correct 727/3400
Epoch: 8, train_loss: 0.7578, train_clustering_loss:  0.3753, train_error: 0.2706
class 0: acc 0.8555555555555555, correct 77/90
class 1: acc 0.6666666666666666, correct 58/87
class 2: acc 0.5316455696202531, correct 42/79
class 3: acc 0.7906976744186046, correct 68/86
class 4: acc 0.7831325301204819, correct 65/83

Val Set, val_loss: 1.1630, val_error: 0.4600, auc: 0.8314
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.045: correct 18/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.4282, instance_loss: 0.5208, weighted_loss: 1.1560, label: 2, bag_size: 1231
batch 39, loss: 0.6612, instance_loss: 0.3411, weighted_loss: 0.5651, label: 1, bag_size: 320
batch 59, loss: 1.9573, instance_loss: 0.5837, weighted_loss: 1.5452, label: 1, bag_size: 1197
batch 79, loss: 0.7925, instance_loss: 0.4255, weighted_loss: 0.6824, label: 2, bag_size: 1039
batch 99, loss: 0.8444, instance_loss: 0.4408, weighted_loss: 0.7233, label: 2, bag_size: 470
batch 119, loss: 1.4249, instance_loss: 0.5584, weighted_loss: 1.1649, label: 3, bag_size: 200
batch 139, loss: 0.3034, instance_loss: 0.2332, weighted_loss: 0.2824, label: 1, bag_size: 1261
batch 159, loss: 1.2953, instance_loss: 0.3983, weighted_loss: 1.0262, label: 4, bag_size: 625
batch 179, loss: 1.7388, instance_loss: 0.5530, weighted_loss: 1.3831, label: 2, bag_size: 373
batch 199, loss: 0.5536, instance_loss: 0.4088, weighted_loss: 0.5102, label: 4, bag_size: 590
batch 219, loss: 0.2975, instance_loss: 0.3648, weighted_loss: 0.3177, label: 0, bag_size: 729
batch 239, loss: 0.8485, instance_loss: 0.4109, weighted_loss: 0.7172, label: 2, bag_size: 1218
batch 259, loss: 0.8296, instance_loss: 0.4287, weighted_loss: 0.7093, label: 1, bag_size: 442
batch 279, loss: 1.3831, instance_loss: 0.4754, weighted_loss: 1.1108, label: 4, bag_size: 754
batch 299, loss: 0.0162, instance_loss: 0.1100, weighted_loss: 0.0444, label: 4, bag_size: 729
batch 319, loss: 0.4984, instance_loss: 0.4922, weighted_loss: 0.4965, label: 0, bag_size: 990
batch 339, loss: 0.4973, instance_loss: 0.3284, weighted_loss: 0.4466, label: 2, bag_size: 1281
batch 359, loss: 0.0775, instance_loss: 0.2112, weighted_loss: 0.1176, label: 3, bag_size: 952
batch 379, loss: 1.0543, instance_loss: 0.4984, weighted_loss: 0.8875, label: 2, bag_size: 934
batch 399, loss: 0.1819, instance_loss: 0.1561, weighted_loss: 0.1742, label: 3, bag_size: 729
batch 419, loss: 0.8475, instance_loss: 0.4805, weighted_loss: 0.7374, label: 2, bag_size: 1197


class 0 clustering acc 0.9946470588235294: correct 16909/17000
class 1 clustering acc 0.23911764705882352: correct 813/3400
Epoch: 9, train_loss: 0.7017, train_clustering_loss:  0.3627, train_error: 0.2541
class 0: acc 0.7931034482758621, correct 69/87
class 1: acc 0.6233766233766234, correct 48/77
class 2: acc 0.6236559139784946, correct 58/93
class 3: acc 0.8289473684210527, correct 63/76
class 4: acc 0.8586956521739131, correct 79/92

Val Set, val_loss: 1.1213, val_error: 0.4200, auc: 0.8231
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.0375: correct 15/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
Validation loss decreased (1.130433 --> 1.121284).  Saving model ...


batch 19, loss: 0.9695, instance_loss: 0.4657, weighted_loss: 0.8184, label: 2, bag_size: 345
batch 39, loss: 0.0707, instance_loss: 0.0799, weighted_loss: 0.0735, label: 3, bag_size: 305
batch 59, loss: 0.0570, instance_loss: 0.1732, weighted_loss: 0.0919, label: 4, bag_size: 646
batch 79, loss: 0.0347, instance_loss: 0.1077, weighted_loss: 0.0566, label: 4, bag_size: 729
batch 99, loss: 0.0760, instance_loss: 0.1723, weighted_loss: 0.1049, label: 0, bag_size: 729
batch 119, loss: 0.5909, instance_loss: 0.3395, weighted_loss: 0.5155, label: 1, bag_size: 754
batch 139, loss: 0.3555, instance_loss: 0.3111, weighted_loss: 0.3422, label: 2, bag_size: 935
batch 159, loss: 0.6746, instance_loss: 0.3870, weighted_loss: 0.5883, label: 1, bag_size: 399
batch 179, loss: 0.0805, instance_loss: 0.1575, weighted_loss: 0.1036, label: 0, bag_size: 1599
batch 199, loss: 0.0312, instance_loss: 0.1987, weighted_loss: 0.0814, label: 4, bag_size: 711
batch 219, loss: 0.8030, instance_loss: 0.3966, weighted_loss: 0.6811, label: 0, bag_size: 371
batch 239, loss: 0.3631, instance_loss: 0.3878, weighted_loss: 0.3705, label: 4, bag_size: 928
batch 259, loss: 0.1086, instance_loss: 0.1148, weighted_loss: 0.1105, label: 1, bag_size: 286
batch 279, loss: 0.1081, instance_loss: 0.0718, weighted_loss: 0.0972, label: 3, bag_size: 729
batch 299, loss: 0.2910, instance_loss: 0.1672, weighted_loss: 0.2539, label: 4, bag_size: 1121
batch 319, loss: 0.1398, instance_loss: 0.1284, weighted_loss: 0.1364, label: 0, bag_size: 518
batch 339, loss: 0.0155, instance_loss: 0.3094, weighted_loss: 0.1036, label: 3, bag_size: 841
batch 359, loss: 1.1413, instance_loss: 0.3536, weighted_loss: 0.9050, label: 3, bag_size: 533
batch 379, loss: 0.5048, instance_loss: 0.3612, weighted_loss: 0.4617, label: 2, bag_size: 1448
batch 399, loss: 2.5896, instance_loss: 0.7470, weighted_loss: 2.0368, label: 2, bag_size: 411
batch 419, loss: 1.2150, instance_loss: 0.5275, weighted_loss: 1.0088, label: 2, bag_size: 748


class 0 clustering acc 0.9926470588235294: correct 16875/17000
class 1 clustering acc 0.2988235294117647: correct 1016/3400
Epoch: 10, train_loss: 0.5940, train_clustering_loss:  0.3386, train_error: 0.2094
class 0: acc 0.9393939393939394, correct 93/99
class 1: acc 0.6666666666666666, correct 64/96
class 2: acc 0.5526315789473685, correct 42/76
class 3: acc 0.8840579710144928, correct 61/69
class 4: acc 0.8941176470588236, correct 76/85

Val Set, val_loss: 1.3812, val_error: 0.5800, auc: 0.8030
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.0525: correct 21/400
class 0: acc 0.0, correct 0/4
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5793, instance_loss: 0.6105, weighted_loss: 1.2886, label: 3, bag_size: 706
batch 39, loss: 1.5209, instance_loss: 0.6896, weighted_loss: 1.2715, label: 2, bag_size: 1128
batch 59, loss: 0.1558, instance_loss: 0.1073, weighted_loss: 0.1413, label: 0, bag_size: 446
batch 79, loss: 1.1974, instance_loss: 0.5047, weighted_loss: 0.9896, label: 4, bag_size: 754
batch 99, loss: 0.0981, instance_loss: 0.1365, weighted_loss: 0.1096, label: 0, bag_size: 653
batch 119, loss: 0.5047, instance_loss: 0.3860, weighted_loss: 0.4691, label: 2, bag_size: 828
batch 139, loss: 0.1212, instance_loss: 0.2260, weighted_loss: 0.1526, label: 1, bag_size: 636
batch 159, loss: 0.1882, instance_loss: 0.3578, weighted_loss: 0.2391, label: 0, bag_size: 524
batch 179, loss: 0.1969, instance_loss: 0.3012, weighted_loss: 0.2282, label: 1, bag_size: 938
batch 199, loss: 0.3825, instance_loss: 0.2723, weighted_loss: 0.3494, label: 0, bag_size: 466
batch 219, loss: 0.2102, instance_loss: 0.4612, weighted_loss: 0.2855, label: 3, bag_size: 1250
batch 239, loss: 0.1357, instance_loss: 0.1586, weighted_loss: 0.1425, label: 0, bag_size: 375
batch 259, loss: 0.2933, instance_loss: 0.5197, weighted_loss: 0.3612, label: 3, bag_size: 1167
batch 279, loss: 0.0926, instance_loss: 0.1022, weighted_loss: 0.0955, label: 0, bag_size: 518
batch 299, loss: 2.8276, instance_loss: 0.6926, weighted_loss: 2.1871, label: 0, bag_size: 282
batch 319, loss: 0.0721, instance_loss: 0.2104, weighted_loss: 0.1136, label: 0, bag_size: 729
batch 339, loss: 0.2696, instance_loss: 0.2757, weighted_loss: 0.2714, label: 4, bag_size: 817
batch 359, loss: 0.5729, instance_loss: 0.5630, weighted_loss: 0.5700, label: 0, bag_size: 413
batch 379, loss: 0.1278, instance_loss: 0.1850, weighted_loss: 0.1450, label: 0, bag_size: 1190
batch 399, loss: 0.1453, instance_loss: 0.1283, weighted_loss: 0.1402, label: 0, bag_size: 1517
batch 419, loss: 0.1221, instance_loss: 0.2348, weighted_loss: 0.1559, label: 4, bag_size: 826


class 0 clustering acc 0.9928235294117647: correct 16878/17000
class 1 clustering acc 0.3402941176470588: correct 1157/3400
Epoch: 11, train_loss: 0.5788, train_clustering_loss:  0.3346, train_error: 0.2118
class 0: acc 0.9010989010989011, correct 82/91
class 1: acc 0.5584415584415584, correct 43/77
class 2: acc 0.6578947368421053, correct 50/76
class 3: acc 0.8690476190476191, correct 73/84
class 4: acc 0.8969072164948454, correct 87/97

Val Set, val_loss: 1.1197, val_error: 0.4600, auc: 0.8149
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.07: correct 28/400
class 0: acc 0.0, correct 0/4
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.6666666666666666, correct 16/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
Validation loss decreased (1.121284 --> 1.119697).  Saving model ...


batch 19, loss: 0.0134, instance_loss: 0.0606, weighted_loss: 0.0276, label: 3, bag_size: 1172
batch 39, loss: 0.3596, instance_loss: 0.2828, weighted_loss: 0.3366, label: 2, bag_size: 621
batch 59, loss: 0.1041, instance_loss: 0.2365, weighted_loss: 0.1438, label: 1, bag_size: 636
batch 79, loss: 0.7538, instance_loss: 0.3788, weighted_loss: 0.6413, label: 2, bag_size: 351
batch 99, loss: 3.3687, instance_loss: 0.6198, weighted_loss: 2.5440, label: 4, bag_size: 663
batch 119, loss: 0.1021, instance_loss: 0.4438, weighted_loss: 0.2046, label: 4, bag_size: 663
batch 139, loss: 0.5147, instance_loss: 0.3251, weighted_loss: 0.4578, label: 0, bag_size: 990
batch 159, loss: 0.0915, instance_loss: 0.1154, weighted_loss: 0.0986, label: 3, bag_size: 729
batch 179, loss: 0.0880, instance_loss: 0.2382, weighted_loss: 0.1330, label: 4, bag_size: 636
batch 199, loss: 1.0899, instance_loss: 0.5253, weighted_loss: 0.9205, label: 2, bag_size: 676
batch 219, loss: 1.8167, instance_loss: 0.7449, weighted_loss: 1.4951, label: 3, bag_size: 281
batch 239, loss: 0.0084, instance_loss: 0.1799, weighted_loss: 0.0598, label: 4, bag_size: 524
batch 259, loss: 0.7773, instance_loss: 0.4321, weighted_loss: 0.6737, label: 2, bag_size: 589
batch 279, loss: 0.7191, instance_loss: 0.6394, weighted_loss: 0.6952, label: 3, bag_size: 283
batch 299, loss: 1.4460, instance_loss: 0.5669, weighted_loss: 1.1822, label: 3, bag_size: 200
batch 319, loss: 0.8708, instance_loss: 0.4157, weighted_loss: 0.7343, label: 0, bag_size: 1018
batch 339, loss: 0.0629, instance_loss: 0.0881, weighted_loss: 0.0704, label: 3, bag_size: 729
batch 359, loss: 1.3554, instance_loss: 0.5340, weighted_loss: 1.1090, label: 2, bag_size: 1231
batch 379, loss: 0.0464, instance_loss: 0.2057, weighted_loss: 0.0942, label: 3, bag_size: 952
batch 399, loss: 1.2919, instance_loss: 0.6461, weighted_loss: 1.0982, label: 2, bag_size: 1231
batch 419, loss: 0.0518, instance_loss: 0.0908, weighted_loss: 0.0635, label: 3, bag_size: 451


class 0 clustering acc 0.9942941176470588: correct 16903/17000
class 1 clustering acc 0.30176470588235293: correct 1026/3400
Epoch: 12, train_loss: 0.6139, train_clustering_loss:  0.3382, train_error: 0.2259
class 0: acc 0.8, correct 68/85
class 1: acc 0.6666666666666666, correct 62/93
class 2: acc 0.6979166666666666, correct 67/96
class 3: acc 0.8904109589041096, correct 65/73
class 4: acc 0.8589743589743589, correct 67/78

Val Set, val_loss: 1.1704, val_error: 0.4800, auc: 0.8069
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.0725: correct 29/400
class 0: acc 0.0, correct 0/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.6666666666666666, correct 16/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0796, instance_loss: 0.1227, weighted_loss: 0.0925, label: 3, bag_size: 729
batch 39, loss: 0.0948, instance_loss: 0.4689, weighted_loss: 0.2071, label: 3, bag_size: 230
batch 59, loss: 0.4096, instance_loss: 0.3109, weighted_loss: 0.3800, label: 1, bag_size: 1049
batch 79, loss: 0.0362, instance_loss: 0.1079, weighted_loss: 0.0577, label: 4, bag_size: 729
batch 99, loss: 0.0312, instance_loss: 0.1078, weighted_loss: 0.0542, label: 3, bag_size: 729
batch 119, loss: 0.3598, instance_loss: 0.2895, weighted_loss: 0.3387, label: 2, bag_size: 470
batch 139, loss: 2.7914, instance_loss: 0.7037, weighted_loss: 2.1651, label: 1, bag_size: 786
batch 159, loss: 0.6965, instance_loss: 0.4704, weighted_loss: 0.6287, label: 0, bag_size: 466
batch 179, loss: 0.7759, instance_loss: 0.3851, weighted_loss: 0.6586, label: 2, bag_size: 684
batch 199, loss: 0.0100, instance_loss: 0.2353, weighted_loss: 0.0776, label: 4, bag_size: 711
batch 219, loss: 2.0983, instance_loss: 0.5360, weighted_loss: 1.6296, label: 4, bag_size: 533
batch 239, loss: 0.1704, instance_loss: 0.4674, weighted_loss: 0.2595, label: 0, bag_size: 729
batch 259, loss: 0.4005, instance_loss: 0.3607, weighted_loss: 0.3886, label: 1, bag_size: 1144
batch 279, loss: 0.1484, instance_loss: 0.0729, weighted_loss: 0.1258, label: 3, bag_size: 729
batch 299, loss: 0.2994, instance_loss: 0.2913, weighted_loss: 0.2970, label: 2, bag_size: 292
batch 319, loss: 0.5175, instance_loss: 0.3713, weighted_loss: 0.4736, label: 2, bag_size: 470
batch 339, loss: 0.6865, instance_loss: 0.5255, weighted_loss: 0.6382, label: 3, bag_size: 200
batch 359, loss: 1.0144, instance_loss: 0.4828, weighted_loss: 0.8549, label: 2, bag_size: 508
batch 379, loss: 2.1247, instance_loss: 0.7377, weighted_loss: 1.7086, label: 1, bag_size: 1409
batch 399, loss: 1.7093, instance_loss: 0.6975, weighted_loss: 1.4058, label: 1, bag_size: 786
batch 419, loss: 0.5208, instance_loss: 0.4343, weighted_loss: 0.4948, label: 2, bag_size: 542


class 0 clustering acc 0.9918235294117647: correct 16861/17000
class 1 clustering acc 0.3776470588235294: correct 1284/3400
Epoch: 13, train_loss: 0.5277, train_clustering_loss:  0.3200, train_error: 0.1812
class 0: acc 0.9, correct 81/90
class 1: acc 0.6666666666666666, correct 52/78
class 2: acc 0.7051282051282052, correct 55/78
class 3: acc 0.8974358974358975, correct 70/78
class 4: acc 0.8910891089108911, correct 90/101

Val Set, val_loss: 1.2093, val_error: 0.4600, auc: 0.8277
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.08: correct 32/400
class 0: acc 0.75, correct 3/4
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3499, instance_loss: 0.3202, weighted_loss: 0.3410, label: 4, bag_size: 625
batch 39, loss: 0.2930, instance_loss: 0.2469, weighted_loss: 0.2791, label: 2, bag_size: 480
batch 59, loss: 0.5279, instance_loss: 0.3908, weighted_loss: 0.4868, label: 2, bag_size: 1617
batch 79, loss: 2.0362, instance_loss: 0.7584, weighted_loss: 1.6528, label: 0, bag_size: 801
batch 99, loss: 0.0047, instance_loss: 0.0490, weighted_loss: 0.0180, label: 3, bag_size: 1172
batch 119, loss: 0.0054, instance_loss: 0.1002, weighted_loss: 0.0339, label: 4, bag_size: 729
batch 139, loss: 0.0307, instance_loss: 0.2811, weighted_loss: 0.1059, label: 4, bag_size: 729
batch 159, loss: 0.1096, instance_loss: 0.2950, weighted_loss: 0.1652, label: 3, bag_size: 230
batch 179, loss: 0.1604, instance_loss: 0.3644, weighted_loss: 0.2216, label: 4, bag_size: 817
batch 199, loss: 1.7170, instance_loss: 0.5640, weighted_loss: 1.3711, label: 1, bag_size: 838
batch 219, loss: 0.4470, instance_loss: 0.3238, weighted_loss: 0.4101, label: 2, bag_size: 1155
batch 239, loss: 0.2342, instance_loss: 0.2575, weighted_loss: 0.2412, label: 0, bag_size: 807
batch 259, loss: 0.5329, instance_loss: 0.2124, weighted_loss: 0.4367, label: 0, bag_size: 437
batch 279, loss: 2.7444, instance_loss: 0.8654, weighted_loss: 2.1807, label: 2, bag_size: 1231
batch 299, loss: 0.1324, instance_loss: 0.1444, weighted_loss: 0.1360, label: 3, bag_size: 729
batch 319, loss: 0.0210, instance_loss: 0.1849, weighted_loss: 0.0702, label: 3, bag_size: 729
batch 339, loss: 0.0875, instance_loss: 0.2156, weighted_loss: 0.1259, label: 1, bag_size: 866
batch 359, loss: 1.3466, instance_loss: 0.6340, weighted_loss: 1.1328, label: 1, bag_size: 660
batch 379, loss: 0.1673, instance_loss: 0.3154, weighted_loss: 0.2117, label: 2, bag_size: 1053
batch 399, loss: 0.6458, instance_loss: 0.3584, weighted_loss: 0.5596, label: 0, bag_size: 350
batch 419, loss: 0.1438, instance_loss: 0.1721, weighted_loss: 0.1523, label: 3, bag_size: 729


class 0 clustering acc 0.9924705882352941: correct 16872/17000
class 1 clustering acc 0.38588235294117645: correct 1312/3400
Epoch: 14, train_loss: 0.4684, train_clustering_loss:  0.3134, train_error: 0.1765
class 0: acc 0.8904109589041096, correct 65/73
class 1: acc 0.6708860759493671, correct 53/79
class 2: acc 0.6823529411764706, correct 58/85
class 3: acc 0.967032967032967, correct 88/91
class 4: acc 0.8865979381443299, correct 86/97

Val Set, val_loss: 1.1513, val_error: 0.4600, auc: 0.8293
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.0875: correct 35/400
class 0: acc 0.0, correct 0/4
class 1: acc 0.6, correct 9/15
class 2: acc 0.5833333333333334, correct 14/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8111, instance_loss: 0.4120, weighted_loss: 0.6914, label: 1, bag_size: 1273
batch 39, loss: 0.0785, instance_loss: 0.2524, weighted_loss: 0.1307, label: 3, bag_size: 697
batch 59, loss: 0.3706, instance_loss: 0.2232, weighted_loss: 0.3264, label: 0, bag_size: 340
batch 79, loss: 0.0079, instance_loss: 0.1186, weighted_loss: 0.0411, label: 3, bag_size: 1291
batch 99, loss: 0.6828, instance_loss: 0.3903, weighted_loss: 0.5951, label: 0, bag_size: 545
batch 119, loss: 0.2948, instance_loss: 0.3051, weighted_loss: 0.2979, label: 2, bag_size: 461
batch 139, loss: 0.9020, instance_loss: 0.4642, weighted_loss: 0.7707, label: 1, bag_size: 887
batch 159, loss: 0.1149, instance_loss: 0.2785, weighted_loss: 0.1639, label: 3, bag_size: 1019
batch 179, loss: 1.1110, instance_loss: 0.2792, weighted_loss: 0.8615, label: 0, bag_size: 545
batch 199, loss: 0.0129, instance_loss: 0.1589, weighted_loss: 0.0567, label: 3, bag_size: 952
batch 219, loss: 0.0345, instance_loss: 0.0713, weighted_loss: 0.0456, label: 0, bag_size: 921
batch 239, loss: 0.7701, instance_loss: 0.3718, weighted_loss: 0.6506, label: 2, bag_size: 614
batch 259, loss: 0.4170, instance_loss: 0.4898, weighted_loss: 0.4389, label: 2, bag_size: 409
batch 279, loss: 0.7753, instance_loss: 0.5060, weighted_loss: 0.6945, label: 1, bag_size: 139
batch 299, loss: 1.2464, instance_loss: 0.5280, weighted_loss: 1.0309, label: 1, bag_size: 487
batch 319, loss: 0.0019, instance_loss: 0.0904, weighted_loss: 0.0284, label: 4, bag_size: 729
batch 339, loss: 0.0124, instance_loss: 0.1555, weighted_loss: 0.0553, label: 3, bag_size: 952
batch 359, loss: 0.7949, instance_loss: 0.4716, weighted_loss: 0.6979, label: 2, bag_size: 355
batch 379, loss: 0.0083, instance_loss: 0.0492, weighted_loss: 0.0206, label: 3, bag_size: 729
batch 399, loss: 0.4024, instance_loss: 0.3066, weighted_loss: 0.3737, label: 2, bag_size: 632
batch 419, loss: 0.0399, instance_loss: 0.0378, weighted_loss: 0.0393, label: 3, bag_size: 405


class 0 clustering acc 0.992: correct 16864/17000
class 1 clustering acc 0.39176470588235296: correct 1332/3400
Epoch: 15, train_loss: 0.4333, train_clustering_loss:  0.3086, train_error: 0.1694
class 0: acc 0.9367088607594937, correct 74/79
class 1: acc 0.6590909090909091, correct 58/88
class 2: acc 0.6708860759493671, correct 53/79
class 3: acc 0.95, correct 76/80
class 4: acc 0.9292929292929293, correct 92/99

Val Set, val_loss: 1.2123, val_error: 0.4000, auc: 0.8215
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.0825: correct 33/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1310, instance_loss: 0.1255, weighted_loss: 0.1294, label: 4, bag_size: 1121
batch 39, loss: 0.3721, instance_loss: 0.3598, weighted_loss: 0.3684, label: 2, bag_size: 1215
batch 59, loss: 0.0327, instance_loss: 0.1364, weighted_loss: 0.0638, label: 0, bag_size: 1018
batch 79, loss: 0.0019, instance_loss: 0.1793, weighted_loss: 0.0552, label: 4, bag_size: 729
batch 99, loss: 0.0917, instance_loss: 0.3140, weighted_loss: 0.1584, label: 0, bag_size: 1190
batch 119, loss: 0.5649, instance_loss: 0.3616, weighted_loss: 0.5039, label: 1, bag_size: 242
batch 139, loss: 0.0242, instance_loss: 0.0451, weighted_loss: 0.0305, label: 0, bag_size: 518
batch 159, loss: 0.7693, instance_loss: 0.6112, weighted_loss: 0.7219, label: 1, bag_size: 936
batch 179, loss: 0.1044, instance_loss: 0.1509, weighted_loss: 0.1183, label: 1, bag_size: 288
batch 199, loss: 1.0523, instance_loss: 0.3975, weighted_loss: 0.8559, label: 1, bag_size: 1144
batch 219, loss: 0.2110, instance_loss: 0.1920, weighted_loss: 0.2053, label: 3, bag_size: 729
batch 239, loss: 0.0018, instance_loss: 0.0918, weighted_loss: 0.0288, label: 4, bag_size: 729
batch 259, loss: 0.0946, instance_loss: 0.0696, weighted_loss: 0.0871, label: 3, bag_size: 556
batch 279, loss: 3.6582, instance_loss: 0.8279, weighted_loss: 2.8091, label: 0, bag_size: 818
batch 299, loss: 0.0332, instance_loss: 0.0674, weighted_loss: 0.0434, label: 0, bag_size: 933
batch 319, loss: 0.0039, instance_loss: 0.2207, weighted_loss: 0.0689, label: 4, bag_size: 388
batch 339, loss: 3.1459, instance_loss: 0.7817, weighted_loss: 2.4366, label: 4, bag_size: 210
batch 359, loss: 0.3535, instance_loss: 0.3072, weighted_loss: 0.3396, label: 2, bag_size: 839
batch 379, loss: 2.4689, instance_loss: 0.8778, weighted_loss: 1.9916, label: 2, bag_size: 1043
batch 399, loss: 0.1252, instance_loss: 1.1097, weighted_loss: 0.4205, label: 4, bag_size: 1176
batch 419, loss: 0.2414, instance_loss: 0.1233, weighted_loss: 0.2059, label: 3, bag_size: 729


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.3726470588235294: correct 1267/3400
Epoch: 16, train_loss: 0.5253, train_clustering_loss:  0.3327, train_error: 0.1976
class 0: acc 0.9518072289156626, correct 79/83
class 1: acc 0.7169811320754716, correct 76/106
class 2: acc 0.6666666666666666, correct 62/93
class 3: acc 0.8703703703703703, correct 47/54
class 4: acc 0.8651685393258427, correct 77/89

Val Set, val_loss: 1.1354, val_error: 0.4200, auc: 0.8356
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.1: correct 40/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0270, instance_loss: 0.1880, weighted_loss: 0.0753, label: 4, bag_size: 826
batch 39, loss: 0.0322, instance_loss: 0.3818, weighted_loss: 0.1371, label: 4, bag_size: 663
batch 59, loss: 0.0439, instance_loss: 0.0572, weighted_loss: 0.0479, label: 3, bag_size: 1291
batch 79, loss: 0.0192, instance_loss: 0.2271, weighted_loss: 0.0816, label: 4, bag_size: 1176
batch 99, loss: 0.2018, instance_loss: 0.2610, weighted_loss: 0.2195, label: 2, bag_size: 701
batch 119, loss: 0.0266, instance_loss: 0.0476, weighted_loss: 0.0329, label: 0, bag_size: 982
batch 139, loss: 0.4520, instance_loss: 0.2898, weighted_loss: 0.4033, label: 0, bag_size: 962
batch 159, loss: 0.0035, instance_loss: 0.0814, weighted_loss: 0.0269, label: 4, bag_size: 729
batch 179, loss: 0.0105, instance_loss: 0.2642, weighted_loss: 0.0866, label: 3, bag_size: 952
batch 199, loss: 0.1152, instance_loss: 0.1432, weighted_loss: 0.1236, label: 0, bag_size: 375
batch 219, loss: 0.4380, instance_loss: 0.4838, weighted_loss: 0.4518, label: 2, bag_size: 1197
batch 239, loss: 0.1827, instance_loss: 0.2026, weighted_loss: 0.1886, label: 1, bag_size: 1261
batch 259, loss: 0.0151, instance_loss: 0.0502, weighted_loss: 0.0256, label: 0, bag_size: 898
batch 279, loss: 0.0105, instance_loss: 0.1925, weighted_loss: 0.0651, label: 4, bag_size: 524
batch 299, loss: 0.1376, instance_loss: 0.1608, weighted_loss: 0.1446, label: 0, bag_size: 1579
batch 319, loss: 0.1285, instance_loss: 0.1117, weighted_loss: 0.1235, label: 1, bag_size: 288
batch 339, loss: 0.0742, instance_loss: 0.2718, weighted_loss: 0.1334, label: 0, bag_size: 729
batch 359, loss: 0.0250, instance_loss: 0.0429, weighted_loss: 0.0304, label: 0, bag_size: 1143
batch 379, loss: 0.3733, instance_loss: 0.4698, weighted_loss: 0.4023, label: 2, bag_size: 571
batch 399, loss: 0.0172, instance_loss: 0.1190, weighted_loss: 0.0478, label: 3, bag_size: 1291
batch 419, loss: 0.2553, instance_loss: 0.3238, weighted_loss: 0.2759, label: 2, bag_size: 1139


class 0 clustering acc 0.9908823529411764: correct 16845/17000
class 1 clustering acc 0.36764705882352944: correct 1250/3400
Epoch: 17, train_loss: 0.4839, train_clustering_loss:  0.3194, train_error: 0.1576
class 0: acc 0.9358974358974359, correct 73/78
class 1: acc 0.6666666666666666, correct 56/84
class 2: acc 0.7692307692307693, correct 80/104
class 3: acc 0.9404761904761905, correct 79/84
class 4: acc 0.9333333333333333, correct 70/75

Val Set, val_loss: 1.2446, val_error: 0.4200, auc: 0.8185
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.1025: correct 41/400
class 0: acc 0.75, correct 3/4
class 1: acc 0.4, correct 6/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0404, instance_loss: 0.0574, weighted_loss: 0.0455, label: 3, bag_size: 729
batch 39, loss: 0.0563, instance_loss: 0.2735, weighted_loss: 0.1215, label: 0, bag_size: 1018
batch 59, loss: 0.0091, instance_loss: 0.1825, weighted_loss: 0.0611, label: 4, bag_size: 1176
batch 79, loss: 1.8857, instance_loss: 0.5847, weighted_loss: 1.4954, label: 0, bag_size: 1257
batch 99, loss: 0.9296, instance_loss: 0.5598, weighted_loss: 0.8187, label: 3, bag_size: 283
batch 119, loss: 0.0285, instance_loss: 0.0889, weighted_loss: 0.0466, label: 3, bag_size: 729
batch 139, loss: 1.9153, instance_loss: 0.5786, weighted_loss: 1.5143, label: 2, bag_size: 542
batch 159, loss: 0.1451, instance_loss: 0.1709, weighted_loss: 0.1528, label: 0, bag_size: 1255
batch 179, loss: 0.5256, instance_loss: 0.3119, weighted_loss: 0.4615, label: 2, bag_size: 1200
batch 199, loss: 2.7736, instance_loss: 0.6942, weighted_loss: 2.1497, label: 4, bag_size: 210
batch 219, loss: 0.3046, instance_loss: 0.4750, weighted_loss: 0.3557, label: 2, bag_size: 264
batch 239, loss: 0.0273, instance_loss: 0.1251, weighted_loss: 0.0567, label: 4, bag_size: 729
batch 259, loss: 0.4360, instance_loss: 0.3755, weighted_loss: 0.4178, label: 0, bag_size: 381
batch 279, loss: 0.2203, instance_loss: 0.4454, weighted_loss: 0.2878, label: 1, bag_size: 1390
batch 299, loss: 2.1791, instance_loss: 0.8704, weighted_loss: 1.7865, label: 2, bag_size: 1043
batch 319, loss: 0.0677, instance_loss: 0.0812, weighted_loss: 0.0717, label: 1, bag_size: 286
batch 339, loss: 0.1994, instance_loss: 0.2398, weighted_loss: 0.2116, label: 4, bag_size: 297
batch 359, loss: 2.7968, instance_loss: 0.7205, weighted_loss: 2.1739, label: 0, bag_size: 1257
batch 379, loss: 0.3299, instance_loss: 0.3082, weighted_loss: 0.3234, label: 2, bag_size: 1281
batch 399, loss: 0.4313, instance_loss: 0.3263, weighted_loss: 0.3998, label: 2, bag_size: 471
batch 419, loss: 0.0203, instance_loss: 0.0368, weighted_loss: 0.0252, label: 0, bag_size: 1143


class 0 clustering acc 0.9876470588235294: correct 16790/17000
class 1 clustering acc 0.4264705882352941: correct 1450/3400
Epoch: 18, train_loss: 0.4406, train_clustering_loss:  0.3125, train_error: 0.1576
class 0: acc 0.9240506329113924, correct 73/79
class 1: acc 0.6351351351351351, correct 47/74
class 2: acc 0.6973684210526315, correct 53/76
class 3: acc 0.9222222222222223, correct 83/90
class 4: acc 0.9622641509433962, correct 102/106

Val Set, val_loss: 1.4644, val_error: 0.5000, auc: 0.8021
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.1025: correct 41/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4, correct 6/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.3146, instance_loss: 0.5062, weighted_loss: 1.0720, label: 1, bag_size: 470
batch 39, loss: 1.7858, instance_loss: 0.6345, weighted_loss: 1.4404, label: 1, bag_size: 386
batch 59, loss: 0.1864, instance_loss: 0.9569, weighted_loss: 0.4175, label: 4, bag_size: 542
batch 79, loss: 0.3237, instance_loss: 0.2783, weighted_loss: 0.3101, label: 2, bag_size: 1242
batch 99, loss: 1.2110, instance_loss: 0.5442, weighted_loss: 1.0110, label: 0, bag_size: 371
batch 119, loss: 0.3375, instance_loss: 0.2600, weighted_loss: 0.3142, label: 2, bag_size: 1019
batch 139, loss: 0.0277, instance_loss: 0.0765, weighted_loss: 0.0423, label: 4, bag_size: 524
batch 159, loss: 0.0021, instance_loss: 0.1006, weighted_loss: 0.0317, label: 4, bag_size: 1176
batch 179, loss: 1.5407, instance_loss: 0.6302, weighted_loss: 1.2676, label: 2, bag_size: 411
batch 199, loss: 0.0039, instance_loss: 0.2910, weighted_loss: 0.0900, label: 4, bag_size: 1235
batch 219, loss: 0.5925, instance_loss: 0.4105, weighted_loss: 0.5379, label: 1, bag_size: 1651
batch 239, loss: 0.6580, instance_loss: 0.4904, weighted_loss: 0.6077, label: 1, bag_size: 754
batch 259, loss: 0.9772, instance_loss: 0.5059, weighted_loss: 0.8358, label: 2, bag_size: 1410
batch 279, loss: 0.1240, instance_loss: 0.2076, weighted_loss: 0.1491, label: 0, bag_size: 472
batch 299, loss: 0.7834, instance_loss: 0.2872, weighted_loss: 0.6345, label: 1, bag_size: 1049
batch 319, loss: 0.4026, instance_loss: 0.5015, weighted_loss: 0.4323, label: 2, bag_size: 373
batch 339, loss: 2.0245, instance_loss: 0.6909, weighted_loss: 1.6244, label: 1, bag_size: 1376
batch 359, loss: 0.3287, instance_loss: 0.3042, weighted_loss: 0.3214, label: 2, bag_size: 247
batch 379, loss: 0.0503, instance_loss: 0.0656, weighted_loss: 0.0549, label: 4, bag_size: 524
batch 399, loss: 2.3684, instance_loss: 0.6697, weighted_loss: 1.8588, label: 1, bag_size: 448
batch 419, loss: 0.8666, instance_loss: 0.4073, weighted_loss: 0.7288, label: 1, bag_size: 838


class 0 clustering acc 0.9896470588235294: correct 16824/17000
class 1 clustering acc 0.3952941176470588: correct 1344/3400
Epoch: 19, train_loss: 0.4238, train_clustering_loss:  0.3148, train_error: 0.1482
class 0: acc 0.8918918918918919, correct 66/74
class 1: acc 0.6744186046511628, correct 58/86
class 2: acc 0.78125, correct 75/96
class 3: acc 0.9651162790697675, correct 83/86
class 4: acc 0.963855421686747, correct 80/83

Val Set, val_loss: 1.3354, val_error: 0.4400, auc: 0.8119
class 0 clustering acc 0.969: correct 1938/2000
class 1 clustering acc 0.1125: correct 45/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.6, correct 9/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0511, instance_loss: 0.1696, weighted_loss: 0.0866, label: 0, bag_size: 729
batch 39, loss: 2.8337, instance_loss: 0.7057, weighted_loss: 2.1953, label: 0, bag_size: 818
batch 59, loss: 0.0035, instance_loss: 0.0523, weighted_loss: 0.0182, label: 3, bag_size: 729
batch 79, loss: 0.0267, instance_loss: 0.3888, weighted_loss: 0.1353, label: 4, bag_size: 1235
batch 99, loss: 0.8402, instance_loss: 0.3997, weighted_loss: 0.7081, label: 3, bag_size: 281
batch 119, loss: 2.0492, instance_loss: 0.6945, weighted_loss: 1.6428, label: 1, bag_size: 446
batch 139, loss: 0.1613, instance_loss: 0.4180, weighted_loss: 0.2383, label: 2, bag_size: 537
batch 159, loss: 0.0020, instance_loss: 0.0560, weighted_loss: 0.0182, label: 4, bag_size: 636
batch 179, loss: 2.5120, instance_loss: 0.7648, weighted_loss: 1.9878, label: 1, bag_size: 386
batch 199, loss: 0.4583, instance_loss: 0.5699, weighted_loss: 0.4917, label: 1, bag_size: 917
batch 219, loss: 1.6122, instance_loss: 0.5665, weighted_loss: 1.2985, label: 0, bag_size: 282
batch 239, loss: 0.0067, instance_loss: 0.0351, weighted_loss: 0.0153, label: 0, bag_size: 360
batch 259, loss: 0.0968, instance_loss: 0.8275, weighted_loss: 0.3160, label: 4, bag_size: 542
batch 279, loss: 0.0301, instance_loss: 0.0676, weighted_loss: 0.0414, label: 0, bag_size: 1012
batch 299, loss: 0.0790, instance_loss: 0.0416, weighted_loss: 0.0678, label: 3, bag_size: 556
batch 319, loss: 0.0601, instance_loss: 0.0780, weighted_loss: 0.0655, label: 1, bag_size: 937
batch 339, loss: 0.2268, instance_loss: 0.2956, weighted_loss: 0.2474, label: 2, bag_size: 252
batch 359, loss: 0.5624, instance_loss: 0.2962, weighted_loss: 0.4825, label: 3, bag_size: 697
batch 379, loss: 1.0146, instance_loss: 0.2974, weighted_loss: 0.7994, label: 2, bag_size: 684
batch 399, loss: 0.7410, instance_loss: 0.4093, weighted_loss: 0.6415, label: 2, bag_size: 237
batch 419, loss: 0.0418, instance_loss: 0.1841, weighted_loss: 0.0845, label: 3, bag_size: 1253


class 0 clustering acc 0.991: correct 16847/17000
class 1 clustering acc 0.45941176470588235: correct 1562/3400
Epoch: 20, train_loss: 0.3604, train_clustering_loss:  0.2872, train_error: 0.1153
class 0: acc 0.9213483146067416, correct 82/89
class 1: acc 0.7428571428571429, correct 52/70
class 2: acc 0.7906976744186046, correct 68/86
class 3: acc 0.9879518072289156, correct 82/83
class 4: acc 0.9484536082474226, correct 92/97

Val Set, val_loss: 1.2262, val_error: 0.4200, auc: 0.8212
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.17: correct 68/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.8333333333333334, correct 20/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.4395, instance_loss: 0.2255, weighted_loss: 0.3753, label: 0, bag_size: 432
batch 39, loss: 0.0039, instance_loss: 0.0496, weighted_loss: 0.0176, label: 4, bag_size: 729
batch 59, loss: 0.4134, instance_loss: 0.3771, weighted_loss: 0.4025, label: 2, bag_size: 1150
batch 79, loss: 0.2777, instance_loss: 0.2864, weighted_loss: 0.2803, label: 0, bag_size: 413
batch 99, loss: 0.0154, instance_loss: 0.0548, weighted_loss: 0.0272, label: 0, bag_size: 898
batch 119, loss: 0.2269, instance_loss: 0.2299, weighted_loss: 0.2278, label: 2, bag_size: 525
batch 139, loss: 0.0403, instance_loss: 0.0683, weighted_loss: 0.0487, label: 0, bag_size: 446
batch 159, loss: 0.1237, instance_loss: 0.1946, weighted_loss: 0.1449, label: 0, bag_size: 371
batch 179, loss: 0.4579, instance_loss: 0.3860, weighted_loss: 0.4364, label: 2, bag_size: 730
batch 199, loss: 0.2299, instance_loss: 0.5692, weighted_loss: 0.3317, label: 3, bag_size: 1167
batch 219, loss: 0.0821, instance_loss: 0.1134, weighted_loss: 0.0915, label: 0, bag_size: 731
batch 239, loss: 0.0157, instance_loss: 0.3054, weighted_loss: 0.1026, label: 0, bag_size: 729
batch 259, loss: 0.1385, instance_loss: 0.1485, weighted_loss: 0.1415, label: 1, bag_size: 356
batch 279, loss: 0.6288, instance_loss: 0.4908, weighted_loss: 0.5874, label: 1, bag_size: 1273
batch 299, loss: 0.1299, instance_loss: 0.2060, weighted_loss: 0.1528, label: 1, bag_size: 696
batch 319, loss: 0.2443, instance_loss: 0.2188, weighted_loss: 0.2367, label: 2, bag_size: 758
batch 339, loss: 0.0109, instance_loss: 0.4350, weighted_loss: 0.1381, label: 3, bag_size: 841
batch 359, loss: 0.0005, instance_loss: 0.0271, weighted_loss: 0.0085, label: 4, bag_size: 729
batch 379, loss: 3.7901, instance_loss: 0.7457, weighted_loss: 2.8768, label: 0, bag_size: 818
batch 399, loss: 1.4590, instance_loss: 0.6547, weighted_loss: 1.2177, label: 1, bag_size: 1376
batch 419, loss: 0.0056, instance_loss: 0.0239, weighted_loss: 0.0111, label: 0, bag_size: 239


class 0 clustering acc 0.9904705882352941: correct 16838/17000
class 1 clustering acc 0.43529411764705883: correct 1480/3400
Epoch: 21, train_loss: 0.4032, train_clustering_loss:  0.3067, train_error: 0.1482
class 0: acc 0.9090909090909091, correct 70/77
class 1: acc 0.6172839506172839, correct 50/81
class 2: acc 0.7894736842105263, correct 75/95
class 3: acc 0.9772727272727273, correct 86/88
class 4: acc 0.9642857142857143, correct 81/84

Val Set, val_loss: 1.4452, val_error: 0.4800, auc: 0.8059
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.125: correct 50/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4, correct 6/15
class 2: acc 0.5833333333333334, correct 14/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.7736, instance_loss: 0.6087, weighted_loss: 0.7241, label: 3, bag_size: 1167
batch 39, loss: 0.0508, instance_loss: 0.0700, weighted_loss: 0.0566, label: 3, bag_size: 729
batch 59, loss: 0.1077, instance_loss: 0.1953, weighted_loss: 0.1340, label: 0, bag_size: 736
batch 79, loss: 0.1271, instance_loss: 0.2173, weighted_loss: 0.1542, label: 0, bag_size: 1190
batch 99, loss: 0.3110, instance_loss: 0.5156, weighted_loss: 0.3724, label: 3, bag_size: 281
batch 119, loss: 0.0818, instance_loss: 0.0840, weighted_loss: 0.0825, label: 3, bag_size: 729
batch 139, loss: 0.1986, instance_loss: 0.2082, weighted_loss: 0.2015, label: 2, bag_size: 347
batch 159, loss: 0.0107, instance_loss: 0.0604, weighted_loss: 0.0256, label: 3, bag_size: 729
batch 179, loss: 0.0643, instance_loss: 0.1701, weighted_loss: 0.0961, label: 2, bag_size: 1215
batch 199, loss: 0.6311, instance_loss: 0.4649, weighted_loss: 0.5812, label: 4, bag_size: 729
batch 219, loss: 0.1709, instance_loss: 0.3442, weighted_loss: 0.2229, label: 2, bag_size: 1141
batch 239, loss: 0.8494, instance_loss: 0.4718, weighted_loss: 0.7361, label: 1, bag_size: 533
batch 259, loss: 0.1404, instance_loss: 0.2978, weighted_loss: 0.1877, label: 3, bag_size: 697
batch 279, loss: 0.0147, instance_loss: 0.1953, weighted_loss: 0.0689, label: 1, bag_size: 1376
batch 299, loss: 0.9522, instance_loss: 0.5945, weighted_loss: 0.8449, label: 1, bag_size: 936
batch 319, loss: 2.2940, instance_loss: 0.6433, weighted_loss: 1.7988, label: 1, bag_size: 386
batch 339, loss: 0.0151, instance_loss: 0.1646, weighted_loss: 0.0599, label: 3, bag_size: 1253
batch 359, loss: 0.0218, instance_loss: 0.2340, weighted_loss: 0.0854, label: 3, bag_size: 952
batch 379, loss: 0.1968, instance_loss: 0.1617, weighted_loss: 0.1862, label: 2, bag_size: 455
batch 399, loss: 0.9591, instance_loss: 0.3634, weighted_loss: 0.7804, label: 0, bag_size: 282
batch 419, loss: 0.0550, instance_loss: 0.1038, weighted_loss: 0.0696, label: 1, bag_size: 369


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.47941176470588237: correct 1630/3400
Epoch: 22, train_loss: 0.3311, train_clustering_loss:  0.2892, train_error: 0.1200
class 0: acc 0.9565217391304348, correct 88/92
class 1: acc 0.6129032258064516, correct 38/62
class 2: acc 0.7647058823529411, correct 65/85
class 3: acc 0.9904761904761905, correct 104/105
class 4: acc 0.9753086419753086, correct 79/81

Val Set, val_loss: 1.2617, val_error: 0.3800, auc: 0.8171
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.1575: correct 63/400
class 0: acc 0.75, correct 3/4
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1401, instance_loss: 0.5810, weighted_loss: 0.2724, label: 4, bag_size: 663
batch 39, loss: 0.0223, instance_loss: 0.2283, weighted_loss: 0.0841, label: 1, bag_size: 834
batch 59, loss: 0.0302, instance_loss: 0.1197, weighted_loss: 0.0571, label: 4, bag_size: 947
batch 79, loss: 0.1021, instance_loss: 0.1745, weighted_loss: 0.1239, label: 0, bag_size: 990
batch 99, loss: 0.0030, instance_loss: 0.0793, weighted_loss: 0.0259, label: 3, bag_size: 729
batch 119, loss: 0.1131, instance_loss: 0.0712, weighted_loss: 0.1005, label: 4, bag_size: 764
batch 139, loss: 1.0774, instance_loss: 0.4720, weighted_loss: 0.8958, label: 1, bag_size: 470
batch 159, loss: 0.0486, instance_loss: 0.1026, weighted_loss: 0.0648, label: 4, bag_size: 354
batch 179, loss: 0.0043, instance_loss: 0.0352, weighted_loss: 0.0136, label: 3, bag_size: 305
batch 199, loss: 0.2512, instance_loss: 0.3553, weighted_loss: 0.2825, label: 1, bag_size: 913
batch 219, loss: 0.5001, instance_loss: 0.4998, weighted_loss: 0.5000, label: 4, bag_size: 511
batch 239, loss: 1.3366, instance_loss: 0.4641, weighted_loss: 1.0749, label: 4, bag_size: 436
batch 259, loss: 0.0144, instance_loss: 0.0603, weighted_loss: 0.0282, label: 0, bag_size: 385
batch 279, loss: 0.0489, instance_loss: 0.3198, weighted_loss: 0.1302, label: 4, bag_size: 754
batch 299, loss: 0.1732, instance_loss: 0.2266, weighted_loss: 0.1892, label: 2, bag_size: 977
batch 319, loss: 0.1068, instance_loss: 0.2054, weighted_loss: 0.1364, label: 2, bag_size: 1569
batch 339, loss: 0.0246, instance_loss: 0.2090, weighted_loss: 0.0799, label: 4, bag_size: 1278
batch 359, loss: 0.1047, instance_loss: 0.1407, weighted_loss: 0.1155, label: 3, bag_size: 729
batch 379, loss: 0.1661, instance_loss: 0.0700, weighted_loss: 0.1372, label: 3, bag_size: 556
batch 399, loss: 0.0000, instance_loss: 0.0992, weighted_loss: 0.0298, label: 4, bag_size: 729
batch 419, loss: 0.8251, instance_loss: 0.4926, weighted_loss: 0.7253, label: 2, bag_size: 237


class 0 clustering acc 0.9879411764705882: correct 16795/17000
class 1 clustering acc 0.43117647058823527: correct 1466/3400
Epoch: 23, train_loss: 0.3539, train_clustering_loss:  0.3120, train_error: 0.1176
class 0: acc 0.9761904761904762, correct 82/84
class 1: acc 0.7023809523809523, correct 59/84
class 2: acc 0.7777777777777778, correct 63/81
class 3: acc 0.9859154929577465, correct 70/71
class 4: acc 0.9619047619047619, correct 101/105

Val Set, val_loss: 1.4254, val_error: 0.4600, auc: 0.8103
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.095: correct 38/400
class 0: acc 0.75, correct 3/4
class 1: acc 0.4, correct 6/15
class 2: acc 0.625, correct 15/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2156, instance_loss: 0.2242, weighted_loss: 0.2182, label: 2, bag_size: 1180
batch 39, loss: 0.9008, instance_loss: 0.6370, weighted_loss: 0.8216, label: 0, bag_size: 1086
batch 59, loss: 0.4130, instance_loss: 0.2748, weighted_loss: 0.3715, label: 2, bag_size: 270
batch 79, loss: 0.0270, instance_loss: 0.0968, weighted_loss: 0.0479, label: 1, bag_size: 847
batch 99, loss: 0.2830, instance_loss: 0.2348, weighted_loss: 0.2686, label: 2, bag_size: 2826
batch 119, loss: 0.1020, instance_loss: 0.5959, weighted_loss: 0.2502, label: 1, bag_size: 867
batch 139, loss: 0.3394, instance_loss: 0.4616, weighted_loss: 0.3760, label: 1, bag_size: 648
batch 159, loss: 0.5544, instance_loss: 0.5634, weighted_loss: 0.5571, label: 3, bag_size: 283
batch 179, loss: 1.1146, instance_loss: 0.3327, weighted_loss: 0.8800, label: 1, bag_size: 828
batch 199, loss: 0.1408, instance_loss: 0.3013, weighted_loss: 0.1890, label: 1, bag_size: 288
batch 219, loss: 0.0004, instance_loss: 0.0562, weighted_loss: 0.0171, label: 4, bag_size: 729
batch 239, loss: 0.4388, instance_loss: 0.3547, weighted_loss: 0.4136, label: 1, bag_size: 898
batch 259, loss: 0.2393, instance_loss: 0.5706, weighted_loss: 0.3387, label: 1, bag_size: 269
batch 279, loss: 0.1361, instance_loss: 0.2605, weighted_loss: 0.1734, label: 1, bag_size: 913
batch 299, loss: 4.7405, instance_loss: 0.5175, weighted_loss: 3.4736, label: 1, bag_size: 1559
batch 319, loss: 1.1978, instance_loss: 0.6080, weighted_loss: 1.0209, label: 2, bag_size: 720
batch 339, loss: 0.0012, instance_loss: 0.0632, weighted_loss: 0.0198, label: 4, bag_size: 729
batch 359, loss: 0.0238, instance_loss: 0.0687, weighted_loss: 0.0373, label: 0, bag_size: 729
batch 379, loss: 0.5354, instance_loss: 0.4723, weighted_loss: 0.5165, label: 1, bag_size: 1273
batch 399, loss: 0.0068, instance_loss: 0.0936, weighted_loss: 0.0328, label: 4, bag_size: 947
batch 419, loss: 0.3299, instance_loss: 0.2209, weighted_loss: 0.2972, label: 1, bag_size: 1049


class 0 clustering acc 0.9889411764705882: correct 16812/17000
class 1 clustering acc 0.4491176470588235: correct 1527/3400
Epoch: 24, train_loss: 0.3670, train_clustering_loss:  0.2960, train_error: 0.1435
class 0: acc 0.9574468085106383, correct 90/94
class 1: acc 0.7019230769230769, correct 73/104
class 2: acc 0.6842105263157895, correct 52/76
class 3: acc 1.0, correct 67/67
class 4: acc 0.9761904761904762, correct 82/84

Val Set, val_loss: 1.4331, val_error: 0.4800, auc: 0.7996
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.11: correct 44/400
class 0: acc 0.0, correct 0/4
class 1: acc 0.6, correct 9/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3561, instance_loss: 0.2175, weighted_loss: 0.3145, label: 1, bag_size: 1049
batch 39, loss: 0.0452, instance_loss: 0.0602, weighted_loss: 0.0497, label: 0, bag_size: 1133
batch 59, loss: 0.0720, instance_loss: 0.1540, weighted_loss: 0.0966, label: 1, bag_size: 1127
batch 79, loss: 1.8528, instance_loss: 0.7627, weighted_loss: 1.5258, label: 3, bag_size: 200
batch 99, loss: 0.0353, instance_loss: 0.1830, weighted_loss: 0.0796, label: 0, bag_size: 552
batch 119, loss: 0.1587, instance_loss: 0.2214, weighted_loss: 0.1775, label: 1, bag_size: 1325
batch 139, loss: 0.0613, instance_loss: 0.2268, weighted_loss: 0.1110, label: 0, bag_size: 760
batch 159, loss: 0.2667, instance_loss: 0.3415, weighted_loss: 0.2891, label: 1, bag_size: 614
batch 179, loss: 0.1728, instance_loss: 0.2360, weighted_loss: 0.1918, label: 1, bag_size: 534
batch 199, loss: 0.9768, instance_loss: 0.5423, weighted_loss: 0.8465, label: 2, bag_size: 720
batch 219, loss: 0.0061, instance_loss: 0.3057, weighted_loss: 0.0960, label: 4, bag_size: 823
batch 239, loss: 0.0589, instance_loss: 0.4326, weighted_loss: 0.1710, label: 3, bag_size: 706
batch 259, loss: 0.1065, instance_loss: 0.4617, weighted_loss: 0.2131, label: 3, bag_size: 1019
batch 279, loss: 0.8078, instance_loss: 0.3342, weighted_loss: 0.6657, label: 4, bag_size: 817
batch 299, loss: 0.0056, instance_loss: 0.1727, weighted_loss: 0.0557, label: 3, bag_size: 729
batch 319, loss: 0.0080, instance_loss: 0.0699, weighted_loss: 0.0265, label: 0, bag_size: 729
batch 339, loss: 0.4297, instance_loss: 0.2858, weighted_loss: 0.3866, label: 2, bag_size: 1155
batch 359, loss: 0.1983, instance_loss: 0.3449, weighted_loss: 0.2423, label: 2, bag_size: 1058
batch 379, loss: 0.0121, instance_loss: 0.0987, weighted_loss: 0.0380, label: 3, bag_size: 729
batch 399, loss: 2.8200, instance_loss: 0.5349, weighted_loss: 2.1344, label: 0, bag_size: 1289
batch 419, loss: 0.3099, instance_loss: 0.2467, weighted_loss: 0.2909, label: 0, bag_size: 868


class 0 clustering acc 0.9891764705882353: correct 16816/17000
class 1 clustering acc 0.4152941176470588: correct 1412/3400
Epoch: 25, train_loss: 0.3513, train_clustering_loss:  0.3116, train_error: 0.1153
class 0: acc 0.9318181818181818, correct 82/88
class 1: acc 0.8043478260869565, correct 74/92
class 2: acc 0.7906976744186046, correct 68/86
class 3: acc 0.975609756097561, correct 80/82
class 4: acc 0.935064935064935, correct 72/77

Val Set, val_loss: 1.2700, val_error: 0.4200, auc: 0.8043
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.75, correct 3/4
class 1: acc 0.6, correct 9/15
class 2: acc 0.5833333333333334, correct 14/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0275, instance_loss: 0.2660, weighted_loss: 0.0991, label: 1, bag_size: 614
batch 39, loss: 0.0115, instance_loss: 0.1173, weighted_loss: 0.0432, label: 0, bag_size: 756
batch 59, loss: 0.3537, instance_loss: 0.4491, weighted_loss: 0.3823, label: 1, bag_size: 875
batch 79, loss: 0.9586, instance_loss: 0.6070, weighted_loss: 0.8531, label: 2, bag_size: 411
batch 99, loss: 3.0389, instance_loss: 0.7938, weighted_loss: 2.3654, label: 0, bag_size: 1289
batch 119, loss: 0.3204, instance_loss: 0.3837, weighted_loss: 0.3394, label: 4, bag_size: 533
batch 139, loss: 0.0104, instance_loss: 0.0411, weighted_loss: 0.0196, label: 0, bag_size: 976
batch 159, loss: 0.1811, instance_loss: 0.3042, weighted_loss: 0.2180, label: 2, bag_size: 1410
batch 179, loss: 0.0622, instance_loss: 0.1724, weighted_loss: 0.0952, label: 0, bag_size: 731
batch 199, loss: 0.1058, instance_loss: 0.3119, weighted_loss: 0.1676, label: 1, bag_size: 925
batch 219, loss: 0.0290, instance_loss: 0.2039, weighted_loss: 0.0815, label: 0, bag_size: 729
batch 239, loss: 0.0092, instance_loss: 0.0360, weighted_loss: 0.0172, label: 0, bag_size: 360
batch 259, loss: 0.0474, instance_loss: 0.3598, weighted_loss: 0.1411, label: 3, bag_size: 230
batch 279, loss: 0.6438, instance_loss: 0.3936, weighted_loss: 0.5687, label: 2, bag_size: 345
batch 299, loss: 0.0203, instance_loss: 0.1079, weighted_loss: 0.0466, label: 1, bag_size: 1086
batch 319, loss: 1.5161, instance_loss: 0.6350, weighted_loss: 1.2518, label: 2, bag_size: 272
batch 339, loss: 0.0017, instance_loss: 0.0791, weighted_loss: 0.0249, label: 4, bag_size: 764
batch 359, loss: 0.3421, instance_loss: 0.2259, weighted_loss: 0.3072, label: 2, bag_size: 480
batch 379, loss: 0.0545, instance_loss: 0.2845, weighted_loss: 0.1235, label: 3, bag_size: 1253
batch 399, loss: 0.3064, instance_loss: 0.2107, weighted_loss: 0.2777, label: 0, bag_size: 413
batch 419, loss: 0.0346, instance_loss: 0.0641, weighted_loss: 0.0435, label: 0, bag_size: 446


class 0 clustering acc 0.9903529411764705: correct 16836/17000
class 1 clustering acc 0.46294117647058824: correct 1574/3400
Epoch: 26, train_loss: 0.3122, train_clustering_loss:  0.2836, train_error: 0.1106
class 0: acc 0.9047619047619048, correct 76/84
class 1: acc 0.735632183908046, correct 64/87
class 2: acc 0.8133333333333334, correct 61/75
class 3: acc 0.9893617021276596, correct 93/94
class 4: acc 0.9882352941176471, correct 84/85

Val Set, val_loss: 1.4326, val_error: 0.4800, auc: 0.7990
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0149, instance_loss: 0.0530, weighted_loss: 0.0264, label: 3, bag_size: 729
batch 39, loss: 0.4458, instance_loss: 0.5542, weighted_loss: 0.4783, label: 1, bag_size: 917
batch 59, loss: 0.0512, instance_loss: 0.2223, weighted_loss: 0.1025, label: 1, bag_size: 534
batch 79, loss: 0.0508, instance_loss: 0.2106, weighted_loss: 0.0988, label: 1, bag_size: 636
batch 99, loss: 0.1162, instance_loss: 0.5313, weighted_loss: 0.2408, label: 0, bag_size: 1301
batch 119, loss: 0.0027, instance_loss: 0.0755, weighted_loss: 0.0245, label: 4, bag_size: 636
batch 139, loss: 0.0051, instance_loss: 0.2467, weighted_loss: 0.0776, label: 4, bag_size: 1331
batch 159, loss: 1.4002, instance_loss: 0.5275, weighted_loss: 1.1384, label: 1, bag_size: 1197
batch 179, loss: 0.1495, instance_loss: 0.3192, weighted_loss: 0.2004, label: 2, bag_size: 1139
batch 199, loss: 0.8052, instance_loss: 0.3997, weighted_loss: 0.6836, label: 2, bag_size: 684
batch 219, loss: 0.9714, instance_loss: 0.7194, weighted_loss: 0.8958, label: 1, bag_size: 269
batch 239, loss: 0.7245, instance_loss: 0.4218, weighted_loss: 0.6337, label: 2, bag_size: 345
batch 259, loss: 0.4106, instance_loss: 0.3740, weighted_loss: 0.3996, label: 2, bag_size: 828
batch 279, loss: 0.5994, instance_loss: 0.6054, weighted_loss: 0.6012, label: 2, bag_size: 1439
batch 299, loss: 0.2394, instance_loss: 0.3136, weighted_loss: 0.2617, label: 2, bag_size: 247
batch 319, loss: 0.0072, instance_loss: 0.0881, weighted_loss: 0.0315, label: 0, bag_size: 729
batch 339, loss: 0.0004, instance_loss: 0.0285, weighted_loss: 0.0088, label: 4, bag_size: 764
batch 359, loss: 0.0109, instance_loss: 0.0426, weighted_loss: 0.0204, label: 0, bag_size: 729
batch 379, loss: 0.2578, instance_loss: 0.2816, weighted_loss: 0.2649, label: 2, bag_size: 1155
batch 399, loss: 0.0872, instance_loss: 0.2865, weighted_loss: 0.1470, label: 3, bag_size: 317
batch 419, loss: 1.1115, instance_loss: 0.5153, weighted_loss: 0.9326, label: 2, bag_size: 323


class 0 clustering acc 0.9914117647058823: correct 16854/17000
class 1 clustering acc 0.4485294117647059: correct 1525/3400
Epoch: 27, train_loss: 0.3188, train_clustering_loss:  0.2904, train_error: 0.1176
class 0: acc 0.9571428571428572, correct 67/70
class 1: acc 0.7708333333333334, correct 74/96
class 2: acc 0.7333333333333333, correct 55/75
class 3: acc 0.9879518072289156, correct 82/83
class 4: acc 0.9603960396039604, correct 97/101

Val Set, val_loss: 1.6187, val_error: 0.4800, auc: 0.7951
class 0 clustering acc 0.965: correct 1930/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4, correct 6/15
class 2: acc 0.625, correct 15/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0004, instance_loss: 0.1457, weighted_loss: 0.0440, label: 4, bag_size: 388
batch 39, loss: 0.0036, instance_loss: 0.0233, weighted_loss: 0.0095, label: 0, bag_size: 1599
batch 59, loss: 1.4374, instance_loss: 0.7440, weighted_loss: 1.2294, label: 0, bag_size: 1289
batch 79, loss: 0.0551, instance_loss: 0.1230, weighted_loss: 0.0755, label: 1, bag_size: 903
batch 99, loss: 0.0134, instance_loss: 0.0293, weighted_loss: 0.0181, label: 3, bag_size: 729
batch 119, loss: 0.0024, instance_loss: 0.0820, weighted_loss: 0.0263, label: 4, bag_size: 636
batch 139, loss: 0.3268, instance_loss: 0.1378, weighted_loss: 0.2701, label: 0, bag_size: 962
batch 159, loss: 0.1088, instance_loss: 0.1941, weighted_loss: 0.1344, label: 0, bag_size: 962
batch 179, loss: 0.0819, instance_loss: 0.3950, weighted_loss: 0.1758, label: 4, bag_size: 947
batch 199, loss: 0.0134, instance_loss: 0.0430, weighted_loss: 0.0223, label: 3, bag_size: 729
batch 219, loss: 0.1421, instance_loss: 0.2132, weighted_loss: 0.1634, label: 2, bag_size: 1448
batch 239, loss: 0.0214, instance_loss: 0.1343, weighted_loss: 0.0552, label: 1, bag_size: 834
batch 259, loss: 0.0111, instance_loss: 0.1454, weighted_loss: 0.0514, label: 4, bag_size: 656
batch 279, loss: 0.9561, instance_loss: 0.6197, weighted_loss: 0.8552, label: 1, bag_size: 1376
batch 299, loss: 0.0033, instance_loss: 0.0250, weighted_loss: 0.0098, label: 0, bag_size: 982
batch 319, loss: 0.0885, instance_loss: 0.2799, weighted_loss: 0.1459, label: 1, bag_size: 1127
batch 339, loss: 1.4470, instance_loss: 0.5890, weighted_loss: 1.1896, label: 1, bag_size: 446
batch 359, loss: 0.0090, instance_loss: 0.1602, weighted_loss: 0.0544, label: 4, bag_size: 928
batch 379, loss: 1.5642, instance_loss: 0.5814, weighted_loss: 1.2694, label: 2, bag_size: 730
batch 399, loss: 0.0302, instance_loss: 0.0916, weighted_loss: 0.0486, label: 0, bag_size: 375
batch 419, loss: 0.0126, instance_loss: 0.0869, weighted_loss: 0.0349, label: 3, bag_size: 729


class 0 clustering acc 0.9914705882352941: correct 16855/17000
class 1 clustering acc 0.5135294117647059: correct 1746/3400
Epoch: 28, train_loss: 0.2608, train_clustering_loss:  0.2732, train_error: 0.0988
class 0: acc 0.9791666666666666, correct 94/96
class 1: acc 0.7441860465116279, correct 64/86
class 2: acc 0.7536231884057971, correct 52/69
class 3: acc 1.0, correct 83/83
class 4: acc 0.989010989010989, correct 90/91

Val Set, val_loss: 1.3662, val_error: 0.4800, auc: 0.8153
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.1325: correct 53/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.5833333333333334, correct 14/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.3465, instance_loss: 0.5457, weighted_loss: 1.1063, label: 1, bag_size: 446
batch 39, loss: 0.1008, instance_loss: 0.2803, weighted_loss: 0.1547, label: 3, bag_size: 697
batch 59, loss: 0.0007, instance_loss: 0.0830, weighted_loss: 0.0254, label: 4, bag_size: 625
batch 79, loss: 0.2807, instance_loss: 0.2309, weighted_loss: 0.2657, label: 2, bag_size: 935
batch 99, loss: 0.9016, instance_loss: 0.6976, weighted_loss: 0.8404, label: 1, bag_size: 293
batch 119, loss: 0.5636, instance_loss: 0.4327, weighted_loss: 0.5243, label: 2, bag_size: 839
batch 139, loss: 0.2309, instance_loss: 0.5654, weighted_loss: 0.3312, label: 3, bag_size: 281
batch 159, loss: 0.0031, instance_loss: 0.0298, weighted_loss: 0.0111, label: 0, bag_size: 1466
batch 179, loss: 0.1221, instance_loss: 0.5460, weighted_loss: 0.2493, label: 2, bag_size: 1139
batch 199, loss: 0.0000, instance_loss: 0.3742, weighted_loss: 0.1123, label: 4, bag_size: 823
batch 219, loss: 1.4706, instance_loss: 0.6256, weighted_loss: 1.2171, label: 1, bag_size: 838
batch 239, loss: 0.0226, instance_loss: 0.0346, weighted_loss: 0.0262, label: 3, bag_size: 556
batch 259, loss: 0.0937, instance_loss: 0.2499, weighted_loss: 0.1406, label: 2, bag_size: 373
batch 279, loss: 1.3034, instance_loss: 0.4801, weighted_loss: 1.0564, label: 1, bag_size: 1724
batch 299, loss: 0.0038, instance_loss: 0.0346, weighted_loss: 0.0130, label: 0, bag_size: 239
batch 319, loss: 0.3725, instance_loss: 0.4686, weighted_loss: 0.4013, label: 4, bag_size: 882
batch 339, loss: 0.0193, instance_loss: 0.0742, weighted_loss: 0.0358, label: 0, bag_size: 381
batch 359, loss: 0.0425, instance_loss: 0.3041, weighted_loss: 0.1210, label: 0, bag_size: 552
batch 379, loss: 0.0199, instance_loss: 0.2421, weighted_loss: 0.0866, label: 4, bag_size: 947
batch 399, loss: 0.0072, instance_loss: 0.0350, weighted_loss: 0.0155, label: 0, bag_size: 982
batch 419, loss: 0.0710, instance_loss: 0.6786, weighted_loss: 0.2533, label: 3, bag_size: 1167


class 0 clustering acc 0.9858235294117647: correct 16759/17000
class 1 clustering acc 0.4764705882352941: correct 1620/3400
Epoch: 29, train_loss: 0.3292, train_clustering_loss:  0.2993, train_error: 0.1224
class 0: acc 0.9292929292929293, correct 92/99
class 1: acc 0.6625, correct 53/80
class 2: acc 0.8505747126436781, correct 74/87
class 3: acc 1.0, correct 88/88
class 4: acc 0.9295774647887324, correct 66/71

Val Set, val_loss: 1.2768, val_error: 0.4000, auc: 0.8170
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0532, instance_loss: 0.2222, weighted_loss: 0.1039, label: 0, bag_size: 1046
batch 39, loss: 0.0153, instance_loss: 0.4825, weighted_loss: 0.1555, label: 4, bag_size: 882
batch 59, loss: 0.0180, instance_loss: 0.0613, weighted_loss: 0.0310, label: 0, bag_size: 246
batch 79, loss: 0.0265, instance_loss: 0.1315, weighted_loss: 0.0580, label: 0, bag_size: 1190
batch 99, loss: 0.0715, instance_loss: 0.2319, weighted_loss: 0.1196, label: 0, bag_size: 381
batch 119, loss: 0.2842, instance_loss: 0.3866, weighted_loss: 0.3150, label: 3, bag_size: 283
batch 139, loss: 0.0023, instance_loss: 0.4228, weighted_loss: 0.1285, label: 4, bag_size: 590
batch 159, loss: 0.0000, instance_loss: 0.1072, weighted_loss: 0.0322, label: 4, bag_size: 729
batch 179, loss: 0.6168, instance_loss: 0.4252, weighted_loss: 0.5593, label: 2, bag_size: 1653
batch 199, loss: 0.2716, instance_loss: 0.1988, weighted_loss: 0.2498, label: 2, bag_size: 455
batch 219, loss: 0.5908, instance_loss: 0.6011, weighted_loss: 0.5939, label: 1, bag_size: 293
batch 239, loss: 0.0974, instance_loss: 0.3591, weighted_loss: 0.1759, label: 4, bag_size: 1337
batch 259, loss: 0.5194, instance_loss: 0.7387, weighted_loss: 0.5852, label: 1, bag_size: 778
batch 279, loss: 0.9892, instance_loss: 0.5593, weighted_loss: 0.8602, label: 1, bag_size: 139
batch 299, loss: 0.1096, instance_loss: 0.3845, weighted_loss: 0.1920, label: 4, bag_size: 511
batch 319, loss: 1.3022, instance_loss: 0.5668, weighted_loss: 1.0816, label: 2, bag_size: 967
batch 339, loss: 0.0003, instance_loss: 0.0525, weighted_loss: 0.0160, label: 4, bag_size: 729
batch 359, loss: 0.4025, instance_loss: 0.4183, weighted_loss: 0.4072, label: 2, bag_size: 911
batch 379, loss: 0.1493, instance_loss: 0.2201, weighted_loss: 0.1705, label: 0, bag_size: 990
batch 399, loss: 0.5067, instance_loss: 0.4512, weighted_loss: 0.4900, label: 1, bag_size: 598
batch 419, loss: 0.0156, instance_loss: 0.0699, weighted_loss: 0.0318, label: 3, bag_size: 316


class 0 clustering acc 0.9897058823529412: correct 16825/17000
class 1 clustering acc 0.48764705882352943: correct 1658/3400
Epoch: 30, train_loss: 0.2901, train_clustering_loss:  0.2848, train_error: 0.1200
class 0: acc 0.9213483146067416, correct 82/89
class 1: acc 0.7954545454545454, correct 70/88
class 2: acc 0.6857142857142857, correct 48/70
class 3: acc 0.9775280898876404, correct 87/89
class 4: acc 0.9775280898876404, correct 87/89

Val Set, val_loss: 1.4449, val_error: 0.4200, auc: 0.8170
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.145: correct 58/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.75, correct 18/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0730, weighted_loss: 0.0220, label: 4, bag_size: 729
batch 39, loss: 0.0081, instance_loss: 0.0246, weighted_loss: 0.0131, label: 0, bag_size: 602
batch 59, loss: 0.0082, instance_loss: 0.0437, weighted_loss: 0.0189, label: 0, bag_size: 729
batch 79, loss: 0.9869, instance_loss: 0.6334, weighted_loss: 0.8808, label: 4, bag_size: 210
batch 99, loss: 0.0135, instance_loss: 0.2485, weighted_loss: 0.0840, label: 0, bag_size: 371
batch 119, loss: 0.2966, instance_loss: 0.4068, weighted_loss: 0.3296, label: 2, bag_size: 567
batch 139, loss: 0.2045, instance_loss: 0.7953, weighted_loss: 0.3817, label: 2, bag_size: 1439
batch 159, loss: 0.1289, instance_loss: 0.3163, weighted_loss: 0.1851, label: 0, bag_size: 552
batch 179, loss: 0.0068, instance_loss: 0.0622, weighted_loss: 0.0235, label: 0, bag_size: 976
batch 199, loss: 0.0477, instance_loss: 0.1907, weighted_loss: 0.0906, label: 0, bag_size: 437
batch 219, loss: 0.0067, instance_loss: 0.0376, weighted_loss: 0.0160, label: 3, bag_size: 729
batch 239, loss: 0.0023, instance_loss: 0.2211, weighted_loss: 0.0679, label: 4, bag_size: 1176
batch 259, loss: 0.0564, instance_loss: 0.2208, weighted_loss: 0.1057, label: 1, bag_size: 534
batch 279, loss: 0.6074, instance_loss: 0.4023, weighted_loss: 0.5459, label: 4, bag_size: 1337
batch 299, loss: 0.2331, instance_loss: 0.5318, weighted_loss: 0.3227, label: 4, bag_size: 663
batch 319, loss: 0.0526, instance_loss: 0.1052, weighted_loss: 0.0684, label: 0, bag_size: 1133
batch 339, loss: 0.2769, instance_loss: 0.3490, weighted_loss: 0.2985, label: 1, bag_size: 1646
batch 359, loss: 0.0084, instance_loss: 0.0568, weighted_loss: 0.0229, label: 0, bag_size: 518
batch 379, loss: 0.5037, instance_loss: 0.5675, weighted_loss: 0.5228, label: 1, bag_size: 660
batch 399, loss: 0.0105, instance_loss: 0.1739, weighted_loss: 0.0595, label: 4, bag_size: 947
batch 419, loss: 0.0673, instance_loss: 0.2031, weighted_loss: 0.1081, label: 0, bag_size: 515


class 0 clustering acc 0.9868235294117647: correct 16776/17000
class 1 clustering acc 0.5129411764705882: correct 1744/3400
Epoch: 31, train_loss: 0.2385, train_clustering_loss:  0.2800, train_error: 0.0941
class 0: acc 0.9651162790697675, correct 83/86
class 1: acc 0.7654320987654321, correct 62/81
class 2: acc 0.7894736842105263, correct 60/76
class 3: acc 1.0, correct 92/92
class 4: acc 0.9777777777777777, correct 88/90

Val Set, val_loss: 1.4751, val_error: 0.4400, auc: 0.8193
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4, correct 6/15
class 2: acc 0.6666666666666666, correct 16/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0783, instance_loss: 0.2479, weighted_loss: 0.1292, label: 3, bag_size: 841
batch 39, loss: 1.1252, instance_loss: 0.4668, weighted_loss: 0.9277, label: 1, bag_size: 1144
batch 59, loss: 1.3100, instance_loss: 0.5640, weighted_loss: 1.0862, label: 2, bag_size: 384
batch 79, loss: 0.0006, instance_loss: 0.0306, weighted_loss: 0.0096, label: 4, bag_size: 729
batch 99, loss: 0.5507, instance_loss: 0.8407, weighted_loss: 0.6377, label: 2, bag_size: 248
batch 119, loss: 0.0004, instance_loss: 0.2223, weighted_loss: 0.0669, label: 4, bag_size: 823
batch 139, loss: 0.0189, instance_loss: 0.0866, weighted_loss: 0.0392, label: 0, bag_size: 729
batch 159, loss: 0.0067, instance_loss: 0.1277, weighted_loss: 0.0430, label: 3, bag_size: 729
batch 179, loss: 0.0279, instance_loss: 0.1880, weighted_loss: 0.0760, label: 1, bag_size: 1239
batch 199, loss: 0.0277, instance_loss: 0.0853, weighted_loss: 0.0449, label: 1, bag_size: 369
batch 219, loss: 0.1542, instance_loss: 0.4556, weighted_loss: 0.2446, label: 3, bag_size: 281
batch 239, loss: 0.0019, instance_loss: 0.3451, weighted_loss: 0.1049, label: 4, bag_size: 1357
batch 259, loss: 0.2892, instance_loss: 0.4809, weighted_loss: 0.3467, label: 1, bag_size: 867
batch 279, loss: 0.0318, instance_loss: 0.0437, weighted_loss: 0.0354, label: 3, bag_size: 1399
batch 299, loss: 0.0206, instance_loss: 0.0728, weighted_loss: 0.0363, label: 4, bag_size: 625
batch 319, loss: 0.2036, instance_loss: 0.4153, weighted_loss: 0.2671, label: 2, bag_size: 330
batch 339, loss: 0.2110, instance_loss: 0.2920, weighted_loss: 0.2353, label: 1, bag_size: 1402
batch 359, loss: 0.0801, instance_loss: 0.3411, weighted_loss: 0.1584, label: 1, bag_size: 754
batch 379, loss: 0.5361, instance_loss: 0.2884, weighted_loss: 0.4618, label: 2, bag_size: 1348
batch 399, loss: 0.4208, instance_loss: 0.3940, weighted_loss: 0.4128, label: 4, bag_size: 511
batch 419, loss: 0.0784, instance_loss: 0.1476, weighted_loss: 0.0992, label: 1, bag_size: 320


class 0 clustering acc 0.9877058823529412: correct 16791/17000
class 1 clustering acc 0.5329411764705883: correct 1812/3400
Epoch: 32, train_loss: 0.2716, train_clustering_loss:  0.2671, train_error: 0.1012
class 0: acc 0.9456521739130435, correct 87/92
class 1: acc 0.7466666666666667, correct 56/75
class 2: acc 0.7951807228915663, correct 66/83
class 3: acc 1.0, correct 91/91
class 4: acc 0.9761904761904762, correct 82/84

Val Set, val_loss: 1.3512, val_error: 0.3800, auc: 0.8341
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.1725: correct 69/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0574, instance_loss: 0.0881, weighted_loss: 0.0666, label: 0, bag_size: 446
batch 39, loss: 0.0199, instance_loss: 0.4259, weighted_loss: 0.1417, label: 4, bag_size: 882
batch 59, loss: 0.0848, instance_loss: 0.2235, weighted_loss: 0.1264, label: 1, bag_size: 846
batch 79, loss: 0.0085, instance_loss: 0.0746, weighted_loss: 0.0283, label: 1, bag_size: 1426
batch 99, loss: 1.9325, instance_loss: 0.8539, weighted_loss: 1.6089, label: 2, bag_size: 1128
batch 119, loss: 0.0377, instance_loss: 0.0892, weighted_loss: 0.0531, label: 0, bag_size: 375
batch 139, loss: 1.5178, instance_loss: 0.4981, weighted_loss: 1.2119, label: 1, bag_size: 861
batch 159, loss: 0.1478, instance_loss: 0.2948, weighted_loss: 0.1919, label: 2, bag_size: 482
batch 179, loss: 0.3664, instance_loss: 0.3463, weighted_loss: 0.3604, label: 2, bag_size: 357
batch 199, loss: 0.2619, instance_loss: 0.2202, weighted_loss: 0.2494, label: 1, bag_size: 1049
batch 219, loss: 0.0072, instance_loss: 0.3115, weighted_loss: 0.0985, label: 3, bag_size: 1019
batch 239, loss: 0.9580, instance_loss: 0.4786, weighted_loss: 0.8142, label: 2, bag_size: 1653
batch 259, loss: 0.7405, instance_loss: 0.6618, weighted_loss: 0.7169, label: 1, bag_size: 1559
batch 279, loss: 0.0888, instance_loss: 0.3971, weighted_loss: 0.1813, label: 2, bag_size: 1133
batch 299, loss: 0.0000, instance_loss: 0.0946, weighted_loss: 0.0284, label: 4, bag_size: 729
batch 319, loss: 0.1025, instance_loss: 0.2418, weighted_loss: 0.1443, label: 1, bag_size: 746
batch 339, loss: 0.0049, instance_loss: 0.1434, weighted_loss: 0.0464, label: 3, bag_size: 729
batch 359, loss: 0.0292, instance_loss: 0.0606, weighted_loss: 0.0386, label: 0, bag_size: 1174
batch 379, loss: 0.1563, instance_loss: 0.2737, weighted_loss: 0.1916, label: 0, bag_size: 1247
batch 399, loss: 0.2956, instance_loss: 0.5616, weighted_loss: 0.3754, label: 2, bag_size: 571
batch 419, loss: 0.1162, instance_loss: 0.2154, weighted_loss: 0.1459, label: 2, bag_size: 863


class 0 clustering acc 0.9891764705882353: correct 16816/17000
class 1 clustering acc 0.4879411764705882: correct 1659/3400
Epoch: 33, train_loss: 0.2718, train_clustering_loss:  0.2825, train_error: 0.1035
class 0: acc 0.9459459459459459, correct 70/74
class 1: acc 0.803921568627451, correct 82/102
class 2: acc 0.8024691358024691, correct 65/81
class 3: acc 1.0, correct 73/73
class 4: acc 0.9578947368421052, correct 91/95

Val Set, val_loss: 1.4397, val_error: 0.4400, auc: 0.8164
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.4, correct 6/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0175, instance_loss: 0.0859, weighted_loss: 0.0380, label: 3, bag_size: 729
batch 39, loss: 0.0001, instance_loss: 0.3505, weighted_loss: 0.1053, label: 4, bag_size: 823
batch 59, loss: 0.0077, instance_loss: 0.0278, weighted_loss: 0.0137, label: 0, bag_size: 521
batch 79, loss: 0.9553, instance_loss: 0.6297, weighted_loss: 0.8576, label: 1, bag_size: 386
batch 99, loss: 0.5589, instance_loss: 0.3601, weighted_loss: 0.4992, label: 1, bag_size: 614
batch 119, loss: 0.6452, instance_loss: 0.6707, weighted_loss: 0.6529, label: 2, bag_size: 373
batch 139, loss: 0.0023, instance_loss: 0.1775, weighted_loss: 0.0549, label: 4, bag_size: 1235
batch 159, loss: 2.1023, instance_loss: 0.7296, weighted_loss: 1.6905, label: 2, bag_size: 758
batch 179, loss: 0.0295, instance_loss: 0.0585, weighted_loss: 0.0382, label: 3, bag_size: 729
batch 199, loss: 0.2988, instance_loss: 0.3473, weighted_loss: 0.3133, label: 2, bag_size: 1039
batch 219, loss: 0.0280, instance_loss: 0.1902, weighted_loss: 0.0767, label: 0, bag_size: 1034
batch 239, loss: 0.0183, instance_loss: 0.1614, weighted_loss: 0.0612, label: 0, bag_size: 1301
batch 259, loss: 0.3759, instance_loss: 0.2088, weighted_loss: 0.3258, label: 2, bag_size: 932
batch 279, loss: 0.2555, instance_loss: 0.7213, weighted_loss: 0.3953, label: 1, bag_size: 293
batch 299, loss: 2.8395, instance_loss: 0.7051, weighted_loss: 2.1992, label: 0, bag_size: 1257
batch 319, loss: 0.0087, instance_loss: 0.0539, weighted_loss: 0.0222, label: 0, bag_size: 360
batch 339, loss: 0.0315, instance_loss: 0.0929, weighted_loss: 0.0499, label: 3, bag_size: 729
batch 359, loss: 0.1780, instance_loss: 0.3034, weighted_loss: 0.2156, label: 0, bag_size: 1527
batch 379, loss: 0.0368, instance_loss: 0.4643, weighted_loss: 0.1650, label: 3, bag_size: 936
batch 399, loss: 0.0044, instance_loss: 0.0339, weighted_loss: 0.0132, label: 0, bag_size: 729
batch 419, loss: 0.0107, instance_loss: 0.0285, weighted_loss: 0.0160, label: 3, bag_size: 729


class 0 clustering acc 0.9874117647058823: correct 16786/17000
class 1 clustering acc 0.5173529411764706: correct 1759/3400
Epoch: 34, train_loss: 0.2860, train_clustering_loss:  0.2806, train_error: 0.0847
class 0: acc 0.9741379310344828, correct 113/116
class 1: acc 0.810126582278481, correct 64/79
class 2: acc 0.7954545454545454, correct 70/88
class 3: acc 1.0, correct 65/65
class 4: acc 1.0, correct 77/77

Val Set, val_loss: 1.6851, val_error: 0.5400, auc: 0.7932
class 0 clustering acc 0.9525: correct 1905/2000
class 1 clustering acc 0.1375: correct 55/400
class 0: acc 0.75, correct 3/4
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.5416666666666666, correct 13/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0341, instance_loss: 0.0404, weighted_loss: 0.0360, label: 3, bag_size: 729
batch 39, loss: 0.0324, instance_loss: 0.0868, weighted_loss: 0.0487, label: 3, bag_size: 729
batch 59, loss: 0.0312, instance_loss: 0.0380, weighted_loss: 0.0333, label: 3, bag_size: 405
batch 79, loss: 0.0065, instance_loss: 0.0798, weighted_loss: 0.0285, label: 3, bag_size: 729
batch 99, loss: 0.1903, instance_loss: 0.3730, weighted_loss: 0.2451, label: 4, bag_size: 511
batch 119, loss: 0.0839, instance_loss: 0.2989, weighted_loss: 0.1484, label: 2, bag_size: 1242
batch 139, loss: 0.0805, instance_loss: 0.2752, weighted_loss: 0.1389, label: 4, bag_size: 533
batch 159, loss: 0.6155, instance_loss: 0.7696, weighted_loss: 0.6617, label: 1, bag_size: 660
batch 179, loss: 1.2356, instance_loss: 0.9803, weighted_loss: 1.1590, label: 2, bag_size: 1231
batch 199, loss: 0.0228, instance_loss: 0.2012, weighted_loss: 0.0763, label: 0, bag_size: 1018
batch 219, loss: 0.0006, instance_loss: 0.1441, weighted_loss: 0.0436, label: 4, bag_size: 729
batch 239, loss: 0.6612, instance_loss: 0.3912, weighted_loss: 0.5802, label: 1, bag_size: 838
batch 259, loss: 1.8233, instance_loss: 1.0616, weighted_loss: 1.5948, label: 1, bag_size: 1799
batch 279, loss: 0.2535, instance_loss: 0.2784, weighted_loss: 0.2610, label: 2, bag_size: 404
batch 299, loss: 0.0139, instance_loss: 0.0786, weighted_loss: 0.0333, label: 3, bag_size: 729
batch 319, loss: 0.0096, instance_loss: 0.2278, weighted_loss: 0.0751, label: 0, bag_size: 729
batch 339, loss: 0.2230, instance_loss: 0.2590, weighted_loss: 0.2338, label: 1, bag_size: 534
batch 359, loss: 0.3527, instance_loss: 0.3277, weighted_loss: 0.3452, label: 0, bag_size: 1247
batch 379, loss: 0.1037, instance_loss: 0.5064, weighted_loss: 0.2245, label: 1, bag_size: 442
batch 399, loss: 0.3374, instance_loss: 0.6314, weighted_loss: 0.4256, label: 2, bag_size: 1439
batch 419, loss: 0.0233, instance_loss: 0.0864, weighted_loss: 0.0422, label: 0, bag_size: 1579


class 0 clustering acc 0.987: correct 16779/17000
class 1 clustering acc 0.4902941176470588: correct 1667/3400
Epoch: 35, train_loss: 0.2833, train_clustering_loss:  0.2902, train_error: 0.1035
class 0: acc 0.9625, correct 77/80
class 1: acc 0.7682926829268293, correct 63/82
class 2: acc 0.8333333333333334, correct 85/102
class 3: acc 0.974025974025974, correct 75/77
class 4: acc 0.9642857142857143, correct 81/84

Val Set, val_loss: 1.4852, val_error: 0.4800, auc: 0.7876
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.145: correct 58/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.625, correct 15/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.2815, instance_loss: 0.3246, weighted_loss: 0.2944, label: 2, bag_size: 1052
batch 39, loss: 0.0337, instance_loss: 0.2139, weighted_loss: 0.0878, label: 3, bag_size: 1177
batch 59, loss: 0.0320, instance_loss: 0.1483, weighted_loss: 0.0669, label: 0, bag_size: 1190
batch 79, loss: 0.0719, instance_loss: 0.5735, weighted_loss: 0.2224, label: 4, bag_size: 366
batch 99, loss: 0.0792, instance_loss: 0.5148, weighted_loss: 0.2099, label: 1, bag_size: 1080
batch 119, loss: 0.0479, instance_loss: 0.3854, weighted_loss: 0.1492, label: 3, bag_size: 1019
batch 139, loss: 0.1276, instance_loss: 0.4166, weighted_loss: 0.2143, label: 1, bag_size: 1080
batch 159, loss: 0.0027, instance_loss: 0.0271, weighted_loss: 0.0100, label: 0, bag_size: 1466
batch 179, loss: 0.1364, instance_loss: 0.4375, weighted_loss: 0.2267, label: 2, bag_size: 1139
batch 199, loss: 0.0366, instance_loss: 0.1416, weighted_loss: 0.0681, label: 0, bag_size: 1247
batch 219, loss: 0.2453, instance_loss: 0.3008, weighted_loss: 0.2619, label: 2, bag_size: 1378
batch 239, loss: 0.5685, instance_loss: 0.3466, weighted_loss: 0.5019, label: 2, bag_size: 676
batch 259, loss: 0.0366, instance_loss: 0.1241, weighted_loss: 0.0629, label: 0, bag_size: 367
batch 279, loss: 0.4040, instance_loss: 0.4588, weighted_loss: 0.4204, label: 1, bag_size: 535
batch 299, loss: 0.1577, instance_loss: 0.6062, weighted_loss: 0.2923, label: 4, bag_size: 366
batch 319, loss: 0.0641, instance_loss: 0.2327, weighted_loss: 0.1147, label: 0, bag_size: 367
batch 339, loss: 0.0014, instance_loss: 0.0319, weighted_loss: 0.0105, label: 0, bag_size: 982
batch 359, loss: 0.0027, instance_loss: 0.0695, weighted_loss: 0.0227, label: 0, bag_size: 521
batch 379, loss: 0.0304, instance_loss: 0.1133, weighted_loss: 0.0553, label: 0, bag_size: 367
batch 399, loss: 0.0011, instance_loss: 0.0793, weighted_loss: 0.0245, label: 4, bag_size: 729
batch 419, loss: 0.0622, instance_loss: 0.4569, weighted_loss: 0.1806, label: 4, bag_size: 663


class 0 clustering acc 0.9892352941176471: correct 16817/17000
class 1 clustering acc 0.44441176470588234: correct 1511/3400
Epoch: 36, train_loss: 0.2458, train_clustering_loss:  0.2963, train_error: 0.0965
class 0: acc 0.9024390243902439, correct 74/82
class 1: acc 0.8602150537634409, correct 80/93
class 2: acc 0.7682926829268293, correct 63/82
class 3: acc 1.0, correct 80/80
class 4: acc 0.9886363636363636, correct 87/88

Val Set, val_loss: 1.5552, val_error: 0.5000, auc: 0.7761
class 0 clustering acc 0.965: correct 1930/2000
class 1 clustering acc 0.13: correct 52/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.5833333333333334, correct 14/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0292, instance_loss: 0.1527, weighted_loss: 0.0663, label: 1, bag_size: 534
batch 39, loss: 0.3055, instance_loss: 0.2514, weighted_loss: 0.2892, label: 1, bag_size: 534
batch 59, loss: 0.0449, instance_loss: 0.3030, weighted_loss: 0.1223, label: 1, bag_size: 318
batch 79, loss: 0.0690, instance_loss: 0.3155, weighted_loss: 0.1430, label: 1, bag_size: 318
batch 99, loss: 0.1676, instance_loss: 0.1745, weighted_loss: 0.1697, label: 1, bag_size: 847
batch 119, loss: 0.0063, instance_loss: 0.0654, weighted_loss: 0.0240, label: 3, bag_size: 729
batch 139, loss: 0.0090, instance_loss: 0.0155, weighted_loss: 0.0109, label: 1, bag_size: 937
batch 159, loss: 3.0500, instance_loss: 0.4996, weighted_loss: 2.2849, label: 2, bag_size: 1133
batch 179, loss: 0.0044, instance_loss: 0.0545, weighted_loss: 0.0195, label: 4, bag_size: 729
batch 199, loss: 1.0978, instance_loss: 0.4610, weighted_loss: 0.9068, label: 1, bag_size: 711
batch 219, loss: 0.0047, instance_loss: 0.4955, weighted_loss: 0.1519, label: 4, bag_size: 882
batch 239, loss: 0.0241, instance_loss: 0.1518, weighted_loss: 0.0624, label: 4, bag_size: 764
batch 259, loss: 0.9286, instance_loss: 0.5370, weighted_loss: 0.8111, label: 1, bag_size: 139
batch 279, loss: 0.0959, instance_loss: 0.4747, weighted_loss: 0.2096, label: 3, bag_size: 936
batch 299, loss: 0.3069, instance_loss: 0.5906, weighted_loss: 0.3920, label: 2, bag_size: 679
batch 319, loss: 0.0169, instance_loss: 0.0623, weighted_loss: 0.0305, label: 0, bag_size: 446
batch 339, loss: 0.0091, instance_loss: 0.1585, weighted_loss: 0.0539, label: 0, bag_size: 729
batch 359, loss: 0.0651, instance_loss: 0.2271, weighted_loss: 0.1137, label: 1, bag_size: 1646
batch 379, loss: 0.2438, instance_loss: 0.2681, weighted_loss: 0.2511, label: 0, bag_size: 338
batch 399, loss: 0.0329, instance_loss: 0.1966, weighted_loss: 0.0820, label: 4, bag_size: 297
batch 419, loss: 0.8417, instance_loss: 0.3616, weighted_loss: 0.6977, label: 1, bag_size: 1724


class 0 clustering acc 0.9875294117647059: correct 16788/17000
class 1 clustering acc 0.46705882352941175: correct 1588/3400
Epoch: 37, train_loss: 0.3260, train_clustering_loss:  0.2999, train_error: 0.1082
class 0: acc 0.9456521739130435, correct 87/92
class 1: acc 0.78125, correct 75/96
class 2: acc 0.8160919540229885, correct 71/87
class 3: acc 0.971830985915493, correct 69/71
class 4: acc 0.9746835443037974, correct 77/79

Val Set, val_loss: 1.4738, val_error: 0.5000, auc: 0.7966
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.1275: correct 51/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.625, correct 15/24
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 26 out of 20


batch 19, loss: 1.1164, instance_loss: 0.6023, weighted_loss: 0.9622, label: 1, bag_size: 936
batch 39, loss: 0.4427, instance_loss: 0.3706, weighted_loss: 0.4211, label: 2, bag_size: 270
batch 59, loss: 0.1138, instance_loss: 0.5752, weighted_loss: 0.2522, label: 1, bag_size: 1080
batch 79, loss: 3.2510, instance_loss: 0.4492, weighted_loss: 2.4104, label: 0, bag_size: 729
batch 99, loss: 0.0096, instance_loss: 0.0719, weighted_loss: 0.0283, label: 3, bag_size: 1291
batch 119, loss: 0.0359, instance_loss: 0.1493, weighted_loss: 0.0699, label: 0, bag_size: 731
batch 139, loss: 0.0362, instance_loss: 0.4188, weighted_loss: 0.1510, label: 1, bag_size: 818
batch 159, loss: 0.0061, instance_loss: 0.0473, weighted_loss: 0.0184, label: 0, bag_size: 729
batch 179, loss: 0.0104, instance_loss: 0.0772, weighted_loss: 0.0304, label: 0, bag_size: 731
batch 199, loss: 0.0196, instance_loss: 0.0840, weighted_loss: 0.0389, label: 3, bag_size: 952
batch 219, loss: 0.3752, instance_loss: 0.4286, weighted_loss: 0.3912, label: 0, bag_size: 801
batch 239, loss: 0.3125, instance_loss: 0.3924, weighted_loss: 0.3364, label: 1, bag_size: 711
batch 259, loss: 1.3796, instance_loss: 0.5988, weighted_loss: 1.1454, label: 1, bag_size: 1273
batch 279, loss: 0.0008, instance_loss: 0.0840, weighted_loss: 0.0258, label: 4, bag_size: 729
batch 299, loss: 0.0046, instance_loss: 0.0668, weighted_loss: 0.0233, label: 0, bag_size: 976
batch 319, loss: 0.0015, instance_loss: 0.1735, weighted_loss: 0.0531, label: 4, bag_size: 1176
batch 339, loss: 0.0181, instance_loss: 0.1270, weighted_loss: 0.0508, label: 0, bag_size: 437
batch 359, loss: 0.3464, instance_loss: 0.3378, weighted_loss: 0.3438, label: 3, bag_size: 1019
batch 379, loss: 0.0137, instance_loss: 0.1854, weighted_loss: 0.0652, label: 4, bag_size: 928
batch 399, loss: 0.0609, instance_loss: 0.6168, weighted_loss: 0.2277, label: 2, bag_size: 248
batch 419, loss: 0.0486, instance_loss: 0.2704, weighted_loss: 0.1152, label: 2, bag_size: 245


class 0 clustering acc 0.9894117647058823: correct 16820/17000
class 1 clustering acc 0.46911764705882353: correct 1595/3400
Epoch: 38, train_loss: 0.2205, train_clustering_loss:  0.2756, train_error: 0.0682
class 0: acc 0.9381443298969072, correct 91/97
class 1: acc 0.863013698630137, correct 63/73
class 2: acc 0.8586956521739131, correct 79/92
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.4581, val_error: 0.5000, auc: 0.8123
class 0 clustering acc 0.9605: correct 1921/2000
class 1 clustering acc 0.165: correct 66/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.2, correct 3/15
class 2: acc 0.75, correct 18/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0209, instance_loss: 0.0416, weighted_loss: 0.0271, label: 3, bag_size: 556
batch 39, loss: 0.9949, instance_loss: 0.5760, weighted_loss: 0.8692, label: 1, bag_size: 1080
batch 59, loss: 0.0012, instance_loss: 0.1150, weighted_loss: 0.0353, label: 4, bag_size: 388
batch 79, loss: 0.2869, instance_loss: 0.3509, weighted_loss: 0.3061, label: 0, bag_size: 350
batch 99, loss: 0.1510, instance_loss: 0.4963, weighted_loss: 0.2546, label: 1, bag_size: 959
batch 119, loss: 0.0077, instance_loss: 0.1901, weighted_loss: 0.0624, label: 4, bag_size: 817
batch 139, loss: 0.0031, instance_loss: 0.0615, weighted_loss: 0.0207, label: 3, bag_size: 1069
batch 159, loss: 0.0135, instance_loss: 0.7711, weighted_loss: 0.2408, label: 4, bag_size: 542
batch 179, loss: 0.0002, instance_loss: 0.0668, weighted_loss: 0.0202, label: 4, bag_size: 1176
batch 199, loss: 0.2266, instance_loss: 0.4015, weighted_loss: 0.2791, label: 2, bag_size: 741
batch 219, loss: 0.0648, instance_loss: 0.5819, weighted_loss: 0.2199, label: 4, bag_size: 663
batch 239, loss: 0.0199, instance_loss: 0.0851, weighted_loss: 0.0395, label: 3, bag_size: 729
batch 259, loss: 0.0057, instance_loss: 0.0290, weighted_loss: 0.0127, label: 0, bag_size: 729
batch 279, loss: 0.0078, instance_loss: 0.1222, weighted_loss: 0.0421, label: 4, bag_size: 817
batch 299, loss: 0.0847, instance_loss: 0.1869, weighted_loss: 0.1153, label: 0, bag_size: 736
batch 319, loss: 0.0000, instance_loss: 0.1397, weighted_loss: 0.0419, label: 4, bag_size: 729
batch 339, loss: 0.0183, instance_loss: 0.1315, weighted_loss: 0.0523, label: 1, bag_size: 994
batch 359, loss: 0.0002, instance_loss: 0.2456, weighted_loss: 0.0738, label: 4, bag_size: 823
batch 379, loss: 0.0000, instance_loss: 0.1376, weighted_loss: 0.0413, label: 4, bag_size: 1002
batch 399, loss: 0.4103, instance_loss: 0.3832, weighted_loss: 0.4021, label: 1, bag_size: 968
batch 419, loss: 0.0059, instance_loss: 0.1632, weighted_loss: 0.0531, label: 1, bag_size: 636


class 0 clustering acc 0.9901764705882353: correct 16833/17000
class 1 clustering acc 0.5023529411764706: correct 1708/3400
Epoch: 39, train_loss: 0.2221, train_clustering_loss:  0.2767, train_error: 0.0753
class 0: acc 0.9595959595959596, correct 95/99
class 1: acc 0.8235294117647058, correct 70/85
class 2: acc 0.8354430379746836, correct 66/79
class 3: acc 1.0, correct 76/76
class 4: acc 1.0, correct 86/86

Val Set, val_loss: 1.5307, val_error: 0.4400, auc: 0.7928
class 0 clustering acc 0.965: correct 1930/2000
class 1 clustering acc 0.1725: correct 69/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.75, correct 18/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0000, instance_loss: 0.1492, weighted_loss: 0.0448, label: 4, bag_size: 1002
batch 39, loss: 0.0038, instance_loss: 0.0472, weighted_loss: 0.0169, label: 0, bag_size: 521
batch 59, loss: 0.0046, instance_loss: 0.0361, weighted_loss: 0.0140, label: 0, bag_size: 518
batch 79, loss: 0.0798, instance_loss: 0.1918, weighted_loss: 0.1134, label: 2, bag_size: 499
batch 99, loss: 0.0079, instance_loss: 0.1499, weighted_loss: 0.0505, label: 3, bag_size: 729
batch 119, loss: 0.0244, instance_loss: 0.0946, weighted_loss: 0.0455, label: 0, bag_size: 552
batch 139, loss: 0.0047, instance_loss: 0.0500, weighted_loss: 0.0183, label: 3, bag_size: 729
batch 159, loss: 0.0258, instance_loss: 0.5750, weighted_loss: 0.1906, label: 3, bag_size: 1167
batch 179, loss: 0.0911, instance_loss: 0.5306, weighted_loss: 0.2230, label: 3, bag_size: 281
batch 199, loss: 0.0869, instance_loss: 0.2671, weighted_loss: 0.1409, label: 1, bag_size: 1402
batch 219, loss: 0.2282, instance_loss: 0.2427, weighted_loss: 0.2325, label: 0, bag_size: 545
batch 239, loss: 1.0775, instance_loss: 0.6658, weighted_loss: 0.9540, label: 2, bag_size: 384
batch 259, loss: 0.0308, instance_loss: 0.0929, weighted_loss: 0.0494, label: 3, bag_size: 729
batch 279, loss: 0.1673, instance_loss: 0.5366, weighted_loss: 0.2781, label: 1, bag_size: 700
batch 299, loss: 0.0039, instance_loss: 0.0278, weighted_loss: 0.0111, label: 0, bag_size: 1599
batch 319, loss: 0.0562, instance_loss: 0.0700, weighted_loss: 0.0604, label: 3, bag_size: 1291
batch 339, loss: 0.0115, instance_loss: 0.0928, weighted_loss: 0.0359, label: 0, bag_size: 1046
batch 359, loss: 0.0880, instance_loss: 0.6257, weighted_loss: 0.2493, label: 4, bag_size: 366
batch 379, loss: 0.0003, instance_loss: 0.0617, weighted_loss: 0.0187, label: 4, bag_size: 729
batch 399, loss: 0.1555, instance_loss: 0.0718, weighted_loss: 0.1304, label: 3, bag_size: 1177
batch 419, loss: 0.0019, instance_loss: 0.0862, weighted_loss: 0.0272, label: 3, bag_size: 952


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.5026470588235294: correct 1709/3400
Epoch: 40, train_loss: 0.2106, train_clustering_loss:  0.2822, train_error: 0.0729
class 0: acc 0.9642857142857143, correct 81/84
class 1: acc 0.8536585365853658, correct 70/82
class 2: acc 0.8170731707317073, correct 67/82
class 3: acc 1.0, correct 93/93
class 4: acc 0.9880952380952381, correct 83/84

Val Set, val_loss: 1.6011, val_error: 0.4800, auc: 0.7882
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.13: correct 52/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.75, correct 18/24
class 3: acc 0.16666666666666666, correct 1/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.1264, instance_loss: 0.4501, weighted_loss: 0.2235, label: 1, bag_size: 1144
batch 39, loss: 0.0034, instance_loss: 0.0903, weighted_loss: 0.0295, label: 3, bag_size: 1291
batch 59, loss: 0.0689, instance_loss: 0.2285, weighted_loss: 0.1168, label: 3, bag_size: 343
batch 79, loss: 0.0059, instance_loss: 0.0383, weighted_loss: 0.0156, label: 0, bag_size: 385
batch 99, loss: 0.0035, instance_loss: 0.0336, weighted_loss: 0.0125, label: 1, bag_size: 937
batch 119, loss: 0.0213, instance_loss: 0.5475, weighted_loss: 0.1792, label: 4, bag_size: 663
batch 139, loss: 0.0019, instance_loss: 0.0426, weighted_loss: 0.0141, label: 3, bag_size: 729
batch 159, loss: 2.2481, instance_loss: 0.8013, weighted_loss: 1.8141, label: 1, bag_size: 1409
batch 179, loss: 0.8146, instance_loss: 0.3411, weighted_loss: 0.6725, label: 2, bag_size: 1148
batch 199, loss: 0.0272, instance_loss: 0.1399, weighted_loss: 0.0610, label: 0, bag_size: 552
batch 219, loss: 0.1052, instance_loss: 0.3158, weighted_loss: 0.1684, label: 2, bag_size: 1150
batch 239, loss: 0.0105, instance_loss: 0.1730, weighted_loss: 0.0592, label: 4, bag_size: 947
batch 259, loss: 0.4286, instance_loss: 0.5378, weighted_loss: 0.4614, label: 1, bag_size: 648
batch 279, loss: 0.1339, instance_loss: 0.1425, weighted_loss: 0.1365, label: 0, bag_size: 375
batch 299, loss: 0.0086, instance_loss: 0.1149, weighted_loss: 0.0405, label: 0, bag_size: 524
batch 319, loss: 0.3503, instance_loss: 0.5549, weighted_loss: 0.4117, label: 2, bag_size: 934
batch 339, loss: 0.0879, instance_loss: 0.3708, weighted_loss: 0.1728, label: 1, bag_size: 818
batch 359, loss: 0.1318, instance_loss: 0.1777, weighted_loss: 0.1456, label: 2, bag_size: 1281
batch 379, loss: 0.0935, instance_loss: 0.5999, weighted_loss: 0.2454, label: 2, bag_size: 405
batch 399, loss: 0.4102, instance_loss: 0.2948, weighted_loss: 0.3756, label: 0, bag_size: 1527
batch 419, loss: 0.0024, instance_loss: 0.0145, weighted_loss: 0.0060, label: 0, bag_size: 521


class 0 clustering acc 0.9871764705882353: correct 16782/17000
class 1 clustering acc 0.4647058823529412: correct 1580/3400
Epoch: 41, train_loss: 0.1933, train_clustering_loss:  0.2860, train_error: 0.0659
class 0: acc 0.9629629629629629, correct 78/81
class 1: acc 0.8028169014084507, correct 57/71
class 2: acc 0.8865979381443299, correct 86/97
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 96/96

Val Set, val_loss: 1.5071, val_error: 0.4600, auc: 0.8023
class 0 clustering acc 0.9635: correct 1927/2000
class 1 clustering acc 0.2: correct 80/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0045, instance_loss: 0.0653, weighted_loss: 0.0227, label: 3, bag_size: 451
batch 39, loss: 0.3382, instance_loss: 0.6016, weighted_loss: 0.4172, label: 3, bag_size: 283
batch 59, loss: 0.0669, instance_loss: 0.7733, weighted_loss: 0.2788, label: 3, bag_size: 200
batch 79, loss: 0.2425, instance_loss: 0.1171, weighted_loss: 0.2049, label: 1, bag_size: 1086
batch 99, loss: 0.0028, instance_loss: 0.0445, weighted_loss: 0.0153, label: 0, bag_size: 360
batch 119, loss: 0.0260, instance_loss: 0.4737, weighted_loss: 0.1603, label: 3, bag_size: 533
batch 139, loss: 1.0357, instance_loss: 0.5719, weighted_loss: 0.8966, label: 2, bag_size: 272
batch 159, loss: 0.0008, instance_loss: 0.1110, weighted_loss: 0.0339, label: 4, bag_size: 656
batch 179, loss: 0.0067, instance_loss: 0.0314, weighted_loss: 0.0141, label: 0, bag_size: 729
batch 199, loss: 0.1586, instance_loss: 0.2576, weighted_loss: 0.1883, label: 2, bag_size: 2703
batch 219, loss: 0.0046, instance_loss: 0.2323, weighted_loss: 0.0729, label: 3, bag_size: 1253
batch 239, loss: 0.0264, instance_loss: 0.5086, weighted_loss: 0.1710, label: 3, bag_size: 200
batch 259, loss: 0.0004, instance_loss: 0.0300, weighted_loss: 0.0093, label: 4, bag_size: 729
batch 279, loss: 0.0080, instance_loss: 0.0592, weighted_loss: 0.0234, label: 0, bag_size: 375
batch 299, loss: 0.0072, instance_loss: 0.0626, weighted_loss: 0.0238, label: 3, bag_size: 451
batch 319, loss: 0.0092, instance_loss: 0.0629, weighted_loss: 0.0253, label: 0, bag_size: 1174
batch 339, loss: 0.0085, instance_loss: 0.2817, weighted_loss: 0.0905, label: 0, bag_size: 524
batch 359, loss: 0.2665, instance_loss: 0.6757, weighted_loss: 0.3892, label: 1, bag_size: 269
batch 379, loss: 1.8638, instance_loss: 0.6257, weighted_loss: 1.4923, label: 1, bag_size: 446
batch 399, loss: 2.2747, instance_loss: 0.6670, weighted_loss: 1.7924, label: 1, bag_size: 1376
batch 419, loss: 0.0001, instance_loss: 0.0842, weighted_loss: 0.0253, label: 4, bag_size: 729


class 0 clustering acc 0.9874705882352941: correct 16787/17000
class 1 clustering acc 0.5076470588235295: correct 1726/3400
Epoch: 42, train_loss: 0.2041, train_clustering_loss:  0.2785, train_error: 0.0776
class 0: acc 0.9659090909090909, correct 85/88
class 1: acc 0.8227848101265823, correct 65/79
class 2: acc 0.8235294117647058, correct 70/85
class 3: acc 1.0, correct 78/78
class 4: acc 0.9894736842105263, correct 94/95

Val Set, val_loss: 1.6438, val_error: 0.5000, auc: 0.7899
class 0 clustering acc 0.963: correct 1926/2000
class 1 clustering acc 0.1475: correct 59/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.6666666666666666, correct 16/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0095, instance_loss: 0.0219, weighted_loss: 0.0132, label: 3, bag_size: 729
batch 39, loss: 0.0060, instance_loss: 0.1884, weighted_loss: 0.0607, label: 3, bag_size: 1019
batch 59, loss: 0.0000, instance_loss: 0.0458, weighted_loss: 0.0138, label: 4, bag_size: 729
batch 79, loss: 0.0000, instance_loss: 0.1454, weighted_loss: 0.0436, label: 4, bag_size: 1002
batch 99, loss: 0.3145, instance_loss: 0.3681, weighted_loss: 0.3306, label: 2, bag_size: 828
batch 119, loss: 0.0105, instance_loss: 0.1030, weighted_loss: 0.0382, label: 1, bag_size: 1426
batch 139, loss: 0.9398, instance_loss: 0.3196, weighted_loss: 0.7538, label: 0, bag_size: 718
batch 159, loss: 0.0095, instance_loss: 0.0410, weighted_loss: 0.0190, label: 0, bag_size: 760
batch 179, loss: 0.0245, instance_loss: 0.2509, weighted_loss: 0.0924, label: 3, bag_size: 697
batch 199, loss: 0.0056, instance_loss: 0.0650, weighted_loss: 0.0234, label: 0, bag_size: 255
batch 219, loss: 0.0027, instance_loss: 0.1163, weighted_loss: 0.0368, label: 4, bag_size: 817
batch 239, loss: 0.0026, instance_loss: 0.3065, weighted_loss: 0.0938, label: 3, bag_size: 706
batch 259, loss: 0.1573, instance_loss: 0.2888, weighted_loss: 0.1967, label: 1, bag_size: 790
batch 279, loss: 0.0015, instance_loss: 0.0407, weighted_loss: 0.0133, label: 0, bag_size: 933
batch 299, loss: 0.9842, instance_loss: 0.5235, weighted_loss: 0.8460, label: 2, bag_size: 411
batch 319, loss: 0.1752, instance_loss: 0.2383, weighted_loss: 0.1941, label: 2, bag_size: 1242
batch 339, loss: 0.0067, instance_loss: 0.1390, weighted_loss: 0.0464, label: 3, bag_size: 1019
batch 359, loss: 0.3621, instance_loss: 0.7537, weighted_loss: 0.4796, label: 4, bag_size: 366
batch 379, loss: 0.1797, instance_loss: 0.5334, weighted_loss: 0.2858, label: 2, bag_size: 803
batch 399, loss: 0.0001, instance_loss: 0.0410, weighted_loss: 0.0124, label: 4, bag_size: 729
batch 419, loss: 0.0212, instance_loss: 0.0973, weighted_loss: 0.0440, label: 3, bag_size: 729


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.5147058823529411: correct 1750/3400
Epoch: 43, train_loss: 0.1785, train_clustering_loss:  0.2699, train_error: 0.0612
class 0: acc 0.9425287356321839, correct 82/87
class 1: acc 0.8472222222222222, correct 61/72
class 2: acc 0.9058823529411765, correct 77/85
class 3: acc 1.0, correct 95/95
class 4: acc 0.9767441860465116, correct 84/86

Val Set, val_loss: 1.7001, val_error: 0.4000, auc: 0.7873
class 0 clustering acc 0.9615: correct 1923/2000
class 1 clustering acc 0.175: correct 70/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.7916666666666666, correct 19/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.2272, instance_loss: 0.6655, weighted_loss: 0.3587, label: 4, bag_size: 436
batch 39, loss: 0.9275, instance_loss: 0.2808, weighted_loss: 0.7335, label: 4, bag_size: 947
batch 59, loss: 0.0001, instance_loss: 0.0911, weighted_loss: 0.0274, label: 4, bag_size: 729
batch 79, loss: 0.1428, instance_loss: 0.2297, weighted_loss: 0.1689, label: 2, bag_size: 286
batch 99, loss: 0.0049, instance_loss: 0.0274, weighted_loss: 0.0116, label: 0, bag_size: 1143
batch 119, loss: 0.0104, instance_loss: 0.4739, weighted_loss: 0.1495, label: 1, bag_size: 867
batch 139, loss: 0.0019, instance_loss: 0.0403, weighted_loss: 0.0134, label: 3, bag_size: 305
batch 159, loss: 0.0463, instance_loss: 0.0621, weighted_loss: 0.0510, label: 0, bag_size: 1012
batch 179, loss: 1.1296, instance_loss: 0.4942, weighted_loss: 0.9390, label: 1, bag_size: 446
batch 199, loss: 3.8799, instance_loss: 0.9497, weighted_loss: 3.0008, label: 2, bag_size: 511
batch 219, loss: 0.0671, instance_loss: 0.2240, weighted_loss: 0.1142, label: 0, bag_size: 1034
batch 239, loss: 0.0299, instance_loss: 0.0283, weighted_loss: 0.0294, label: 3, bag_size: 556
batch 259, loss: 0.0091, instance_loss: 0.4395, weighted_loss: 0.1382, label: 0, bag_size: 371
batch 279, loss: 0.0297, instance_loss: 0.2901, weighted_loss: 0.1078, label: 2, bag_size: 777
batch 299, loss: 0.0000, instance_loss: 0.0236, weighted_loss: 0.0071, label: 4, bag_size: 729
batch 319, loss: 0.0007, instance_loss: 0.2830, weighted_loss: 0.0854, label: 4, bag_size: 1235
batch 339, loss: 0.0899, instance_loss: 0.1911, weighted_loss: 0.1203, label: 0, bag_size: 340
batch 359, loss: 0.0070, instance_loss: 0.4938, weighted_loss: 0.1531, label: 1, bag_size: 614
batch 379, loss: 0.1010, instance_loss: 0.3705, weighted_loss: 0.1818, label: 1, bag_size: 965
batch 399, loss: 0.0313, instance_loss: 0.0561, weighted_loss: 0.0387, label: 3, bag_size: 729
batch 419, loss: 0.0094, instance_loss: 0.1497, weighted_loss: 0.0515, label: 4, bag_size: 656


class 0 clustering acc 0.9866470588235294: correct 16773/17000
class 1 clustering acc 0.48970588235294116: correct 1665/3400
Epoch: 44, train_loss: 0.1967, train_clustering_loss:  0.2876, train_error: 0.0729
class 0: acc 0.9468085106382979, correct 89/94
class 1: acc 0.8505747126436781, correct 74/87
class 2: acc 0.875, correct 77/88
class 3: acc 0.987012987012987, correct 76/77
class 4: acc 0.9873417721518988, correct 78/79

Val Set, val_loss: 1.6943, val_error: 0.4200, auc: 0.7889
class 0 clustering acc 0.966: correct 1932/2000
class 1 clustering acc 0.17: correct 68/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.6666666666666666, correct 16/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0092, instance_loss: 0.0669, weighted_loss: 0.0265, label: 3, bag_size: 729
batch 39, loss: 0.1576, instance_loss: 0.3768, weighted_loss: 0.2233, label: 2, bag_size: 1439
batch 59, loss: 0.0031, instance_loss: 0.0536, weighted_loss: 0.0183, label: 1, bag_size: 690
batch 79, loss: 0.1143, instance_loss: 0.2665, weighted_loss: 0.1600, label: 1, bag_size: 530
batch 99, loss: 0.2353, instance_loss: 0.2775, weighted_loss: 0.2480, label: 0, bag_size: 1133
batch 119, loss: 0.1085, instance_loss: 0.5855, weighted_loss: 0.2516, label: 2, bag_size: 405
batch 139, loss: 0.0502, instance_loss: 0.1713, weighted_loss: 0.0865, label: 3, bag_size: 1177
batch 159, loss: 0.2723, instance_loss: 0.2422, weighted_loss: 0.2633, label: 2, bag_size: 1385
batch 179, loss: 0.0000, instance_loss: 0.0549, weighted_loss: 0.0165, label: 4, bag_size: 729
batch 199, loss: 0.0055, instance_loss: 0.0450, weighted_loss: 0.0173, label: 0, bag_size: 760
batch 219, loss: 0.1209, instance_loss: 0.4005, weighted_loss: 0.2047, label: 1, bag_size: 754
batch 239, loss: 0.0319, instance_loss: 0.0495, weighted_loss: 0.0372, label: 0, bag_size: 1235
batch 259, loss: 0.0313, instance_loss: 0.3566, weighted_loss: 0.1289, label: 3, bag_size: 706
batch 279, loss: 0.0453, instance_loss: 0.2277, weighted_loss: 0.1000, label: 2, bag_size: 405
batch 299, loss: 0.1031, instance_loss: 0.3242, weighted_loss: 0.1694, label: 1, bag_size: 965
batch 319, loss: 0.0153, instance_loss: 0.3497, weighted_loss: 0.1156, label: 2, bag_size: 500
batch 339, loss: 0.0087, instance_loss: 0.0944, weighted_loss: 0.0344, label: 1, bag_size: 1426
batch 359, loss: 0.0061, instance_loss: 0.6028, weighted_loss: 0.1851, label: 4, bag_size: 882
batch 379, loss: 0.0591, instance_loss: 0.0618, weighted_loss: 0.0599, label: 3, bag_size: 556
batch 399, loss: 0.0131, instance_loss: 0.0517, weighted_loss: 0.0247, label: 0, bag_size: 446
batch 419, loss: 0.0470, instance_loss: 0.3674, weighted_loss: 0.1431, label: 1, bag_size: 925


class 0 clustering acc 0.9848235294117647: correct 16742/17000
class 1 clustering acc 0.4697058823529412: correct 1597/3400
Epoch: 45, train_loss: 0.2224, train_clustering_loss:  0.2988, train_error: 0.0753
class 0: acc 0.95, correct 76/80
class 1: acc 0.825, correct 66/80
class 2: acc 0.8846153846153846, correct 92/104
class 3: acc 0.9878048780487805, correct 81/82
class 4: acc 0.9873417721518988, correct 78/79

Val Set, val_loss: 1.5142, val_error: 0.5000, auc: 0.8035
class 0 clustering acc 0.962: correct 1924/2000
class 1 clustering acc 0.2075: correct 83/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.625, correct 15/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0097, instance_loss: 0.0777, weighted_loss: 0.0301, label: 0, bag_size: 413
batch 39, loss: 0.1547, instance_loss: 0.1994, weighted_loss: 0.1681, label: 2, bag_size: 1052
batch 59, loss: 0.0749, instance_loss: 0.1717, weighted_loss: 0.1040, label: 2, bag_size: 404
batch 79, loss: 0.1746, instance_loss: 0.6370, weighted_loss: 0.3133, label: 3, bag_size: 281
batch 99, loss: 0.1825, instance_loss: 0.2981, weighted_loss: 0.2172, label: 2, bag_size: 911
batch 119, loss: 0.0106, instance_loss: 0.1054, weighted_loss: 0.0390, label: 4, bag_size: 729
batch 139, loss: 1.6689, instance_loss: 0.7191, weighted_loss: 1.3839, label: 1, bag_size: 446
batch 159, loss: 0.0081, instance_loss: 0.0670, weighted_loss: 0.0258, label: 0, bag_size: 729
batch 179, loss: 0.5226, instance_loss: 0.5723, weighted_loss: 0.5375, label: 3, bag_size: 1167
batch 199, loss: 0.0031, instance_loss: 0.0313, weighted_loss: 0.0115, label: 0, bag_size: 729
batch 219, loss: 0.0134, instance_loss: 0.0768, weighted_loss: 0.0325, label: 0, bag_size: 446
batch 239, loss: 0.0135, instance_loss: 0.1149, weighted_loss: 0.0439, label: 0, bag_size: 1086
batch 259, loss: 0.0324, instance_loss: 0.1721, weighted_loss: 0.0743, label: 1, bag_size: 288
batch 279, loss: 0.0010, instance_loss: 0.0533, weighted_loss: 0.0167, label: 3, bag_size: 1172
batch 299, loss: 0.3675, instance_loss: 0.4579, weighted_loss: 0.3946, label: 2, bag_size: 1617
batch 319, loss: 0.0100, instance_loss: 0.1322, weighted_loss: 0.0467, label: 4, bag_size: 928
batch 339, loss: 0.0100, instance_loss: 0.0413, weighted_loss: 0.0194, label: 0, bag_size: 1235
batch 359, loss: 0.1288, instance_loss: 0.6405, weighted_loss: 0.2823, label: 1, bag_size: 269
batch 379, loss: 0.0332, instance_loss: 0.1919, weighted_loss: 0.0808, label: 0, bag_size: 1301
batch 399, loss: 1.7060, instance_loss: 1.0309, weighted_loss: 1.5035, label: 1, bag_size: 1799
batch 419, loss: 0.1302, instance_loss: 0.2191, weighted_loss: 0.1569, label: 2, bag_size: 404


class 0 clustering acc 0.9863529411764705: correct 16768/17000
class 1 clustering acc 0.5035294117647059: correct 1712/3400
Epoch: 46, train_loss: 0.1965, train_clustering_loss:  0.2770, train_error: 0.0612
class 0: acc 0.975, correct 78/80
class 1: acc 0.8409090909090909, correct 74/88
class 2: acc 0.8795180722891566, correct 73/83
class 3: acc 1.0, correct 91/91
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.5707, val_error: 0.5000, auc: 0.7873
class 0 clustering acc 0.9625: correct 1925/2000
class 1 clustering acc 0.225: correct 90/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.625, correct 15/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0368, weighted_loss: 0.0110, label: 4, bag_size: 729
batch 39, loss: 0.0442, instance_loss: 0.4858, weighted_loss: 0.1767, label: 2, bag_size: 1139
batch 59, loss: 0.0001, instance_loss: 0.0318, weighted_loss: 0.0096, label: 4, bag_size: 646
batch 79, loss: 0.2361, instance_loss: 0.8365, weighted_loss: 0.4162, label: 1, bag_size: 778
batch 99, loss: 0.0006, instance_loss: 0.1438, weighted_loss: 0.0436, label: 4, bag_size: 388
batch 119, loss: 0.0003, instance_loss: 0.0439, weighted_loss: 0.0134, label: 4, bag_size: 729
batch 139, loss: 0.0988, instance_loss: 0.5168, weighted_loss: 0.2242, label: 3, bag_size: 283
batch 159, loss: 0.1352, instance_loss: 0.3730, weighted_loss: 0.2066, label: 4, bag_size: 436
batch 179, loss: 0.1048, instance_loss: 0.5753, weighted_loss: 0.2459, label: 2, bag_size: 409
batch 199, loss: 0.1446, instance_loss: 0.5701, weighted_loss: 0.2722, label: 4, bag_size: 436
batch 219, loss: 0.0105, instance_loss: 0.1802, weighted_loss: 0.0614, label: 3, bag_size: 729
batch 239, loss: 0.0021, instance_loss: 0.0560, weighted_loss: 0.0183, label: 0, bag_size: 976
batch 259, loss: 0.0002, instance_loss: 0.0466, weighted_loss: 0.0141, label: 4, bag_size: 646
batch 279, loss: 0.0193, instance_loss: 0.6337, weighted_loss: 0.2036, label: 3, bag_size: 1250
batch 299, loss: 0.0019, instance_loss: 0.1764, weighted_loss: 0.0543, label: 1, bag_size: 1426
batch 319, loss: 0.1167, instance_loss: 0.0991, weighted_loss: 0.1114, label: 1, bag_size: 1325
batch 339, loss: 0.0289, instance_loss: 0.5131, weighted_loss: 0.1742, label: 1, bag_size: 1390
batch 359, loss: 0.0003, instance_loss: 0.0658, weighted_loss: 0.0200, label: 4, bag_size: 764
batch 379, loss: 0.0532, instance_loss: 0.3055, weighted_loss: 0.1289, label: 1, bag_size: 530
batch 399, loss: 0.0232, instance_loss: 0.1322, weighted_loss: 0.0559, label: 0, bag_size: 246
batch 419, loss: 0.0001, instance_loss: 0.0496, weighted_loss: 0.0150, label: 4, bag_size: 729


class 0 clustering acc 0.9870588235294118: correct 16780/17000
class 1 clustering acc 0.5379411764705883: correct 1829/3400
Epoch: 47, train_loss: 0.1370, train_clustering_loss:  0.2712, train_error: 0.0494
class 0: acc 0.9651162790697675, correct 83/86
class 1: acc 0.9263157894736842, correct 88/95
class 2: acc 0.8648648648648649, correct 64/74
class 3: acc 1.0, correct 74/74
class 4: acc 0.9895833333333334, correct 95/96

Val Set, val_loss: 1.6353, val_error: 0.4400, auc: 0.7863
class 0 clustering acc 0.9615: correct 1923/2000
class 1 clustering acc 0.155: correct 62/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.4, correct 6/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0032, instance_loss: 0.0351, weighted_loss: 0.0128, label: 0, bag_size: 518
batch 39, loss: 0.0005, instance_loss: 0.3454, weighted_loss: 0.1040, label: 4, bag_size: 1235
batch 59, loss: 0.1922, instance_loss: 0.3031, weighted_loss: 0.2255, label: 2, bag_size: 828
batch 79, loss: 0.0039, instance_loss: 0.0269, weighted_loss: 0.0108, label: 3, bag_size: 729
batch 99, loss: 0.1556, instance_loss: 0.6574, weighted_loss: 0.3061, label: 2, bag_size: 537
batch 119, loss: 0.0043, instance_loss: 0.0933, weighted_loss: 0.0310, label: 0, bag_size: 729
batch 139, loss: 0.0000, instance_loss: 0.0467, weighted_loss: 0.0140, label: 4, bag_size: 729
batch 159, loss: 0.0064, instance_loss: 0.0354, weighted_loss: 0.0151, label: 0, bag_size: 446
batch 179, loss: 0.0037, instance_loss: 0.0451, weighted_loss: 0.0161, label: 0, bag_size: 729
batch 199, loss: 0.0295, instance_loss: 0.1607, weighted_loss: 0.0688, label: 1, bag_size: 1127
batch 219, loss: 0.3239, instance_loss: 0.4023, weighted_loss: 0.3474, label: 2, bag_size: 262
batch 239, loss: 0.0008, instance_loss: 0.0276, weighted_loss: 0.0088, label: 3, bag_size: 1069
batch 259, loss: 5.1089, instance_loss: 1.8970, weighted_loss: 4.1453, label: 2, bag_size: 1108
batch 279, loss: 0.0742, instance_loss: 0.5983, weighted_loss: 0.2315, label: 3, bag_size: 281
batch 299, loss: 0.0296, instance_loss: 0.4474, weighted_loss: 0.1550, label: 4, bag_size: 436
batch 319, loss: 0.0088, instance_loss: 0.0665, weighted_loss: 0.0261, label: 0, bag_size: 653
batch 339, loss: 0.0396, instance_loss: 0.2478, weighted_loss: 0.1021, label: 2, bag_size: 1052
batch 359, loss: 0.3211, instance_loss: 0.5796, weighted_loss: 0.3986, label: 1, bag_size: 700
batch 379, loss: 0.0505, instance_loss: 0.2293, weighted_loss: 0.1042, label: 3, bag_size: 317
batch 399, loss: 0.0016, instance_loss: 0.0300, weighted_loss: 0.0101, label: 0, bag_size: 1466
batch 419, loss: 0.0366, instance_loss: 0.1868, weighted_loss: 0.0817, label: 3, bag_size: 697


class 0 clustering acc 0.9881176470588235: correct 16798/17000
class 1 clustering acc 0.5188235294117647: correct 1764/3400
Epoch: 48, train_loss: 0.1561, train_clustering_loss:  0.2709, train_error: 0.0376
class 0: acc 0.978494623655914, correct 91/93
class 1: acc 0.9213483146067416, correct 82/89
class 2: acc 0.9014084507042254, correct 64/71
class 3: acc 1.0, correct 88/88
class 4: acc 1.0, correct 84/84

Val Set, val_loss: 1.5886, val_error: 0.4800, auc: 0.7843
class 0 clustering acc 0.967: correct 1934/2000
class 1 clustering acc 0.145: correct 58/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.625, correct 15/24
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.0004, instance_loss: 0.0693, weighted_loss: 0.0211, label: 4, bag_size: 636
batch 39, loss: 0.2866, instance_loss: 0.2947, weighted_loss: 0.2890, label: 2, bag_size: 1218
batch 59, loss: 0.0185, instance_loss: 0.1707, weighted_loss: 0.0642, label: 0, bag_size: 653
batch 79, loss: 0.0004, instance_loss: 0.4210, weighted_loss: 0.1266, label: 4, bag_size: 1278
batch 99, loss: 0.0015, instance_loss: 0.1201, weighted_loss: 0.0371, label: 4, bag_size: 1474
batch 119, loss: 0.0306, instance_loss: 0.0219, weighted_loss: 0.0280, label: 3, bag_size: 729
batch 139, loss: 0.0055, instance_loss: 0.3737, weighted_loss: 0.1160, label: 3, bag_size: 841
batch 159, loss: 0.2188, instance_loss: 0.3605, weighted_loss: 0.2613, label: 3, bag_size: 281
batch 179, loss: 0.0045, instance_loss: 0.0481, weighted_loss: 0.0176, label: 0, bag_size: 518
batch 199, loss: 0.0219, instance_loss: 0.2142, weighted_loss: 0.0796, label: 0, bag_size: 381
batch 219, loss: 0.0166, instance_loss: 0.0679, weighted_loss: 0.0320, label: 0, bag_size: 731
batch 239, loss: 0.0020, instance_loss: 0.0974, weighted_loss: 0.0306, label: 1, bag_size: 945
batch 259, loss: 0.4385, instance_loss: 0.4919, weighted_loss: 0.4546, label: 1, bag_size: 487
batch 279, loss: 0.0554, instance_loss: 0.8367, weighted_loss: 0.2898, label: 1, bag_size: 778
batch 299, loss: 0.0461, instance_loss: 0.2229, weighted_loss: 0.0992, label: 2, bag_size: 1215
batch 319, loss: 0.0049, instance_loss: 0.0984, weighted_loss: 0.0329, label: 3, bag_size: 1291
batch 339, loss: 0.0560, instance_loss: 0.5930, weighted_loss: 0.2171, label: 2, bag_size: 409
batch 359, loss: 0.0197, instance_loss: 0.3983, weighted_loss: 0.1333, label: 3, bag_size: 281
batch 379, loss: 0.3068, instance_loss: 0.2758, weighted_loss: 0.2975, label: 2, bag_size: 632
batch 399, loss: 0.0262, instance_loss: 0.0786, weighted_loss: 0.0419, label: 0, bag_size: 367
batch 419, loss: 0.0134, instance_loss: 0.1679, weighted_loss: 0.0598, label: 0, bag_size: 338


class 0 clustering acc 0.9870588235294118: correct 16780/17000
class 1 clustering acc 0.47352941176470587: correct 1610/3400
Epoch: 49, train_loss: 0.1612, train_clustering_loss:  0.2946, train_error: 0.0588
class 0: acc 0.9759036144578314, correct 81/83
class 1: acc 0.8804347826086957, correct 81/92
class 2: acc 0.8651685393258427, correct 77/89
class 3: acc 1.0, correct 82/82
class 4: acc 1.0, correct 79/79

Val Set, val_loss: 1.5465, val_error: 0.4600, auc: 0.7916
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.1725: correct 69/400
class 0: acc 0.25, correct 1/4
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.5, correct 3/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0090, instance_loss: 0.5129, weighted_loss: 0.1602, label: 4, bag_size: 754
batch 39, loss: 0.0488, instance_loss: 0.3540, weighted_loss: 0.1403, label: 2, bag_size: 1024
batch 59, loss: 0.0236, instance_loss: 0.5826, weighted_loss: 0.1913, label: 3, bag_size: 1250
batch 79, loss: 0.5911, instance_loss: 0.4911, weighted_loss: 0.5611, label: 2, bag_size: 1231
batch 99, loss: 0.9031, instance_loss: 0.5371, weighted_loss: 0.7933, label: 2, bag_size: 248
batch 119, loss: 0.0272, instance_loss: 0.0247, weighted_loss: 0.0264, label: 3, bag_size: 556
batch 139, loss: 0.1474, instance_loss: 0.1352, weighted_loss: 0.1437, label: 1, bag_size: 636
batch 159, loss: 0.8259, instance_loss: 0.5994, weighted_loss: 0.7579, label: 2, bag_size: 324
batch 179, loss: 0.0038, instance_loss: 0.0253, weighted_loss: 0.0103, label: 0, bag_size: 729
batch 199, loss: 0.0166, instance_loss: 0.0963, weighted_loss: 0.0405, label: 0, bag_size: 246
batch 219, loss: 0.0015, instance_loss: 0.0485, weighted_loss: 0.0156, label: 3, bag_size: 1172
batch 239, loss: 0.1674, instance_loss: 0.4646, weighted_loss: 0.2565, label: 2, bag_size: 1410
batch 259, loss: 0.0016, instance_loss: 0.1664, weighted_loss: 0.0510, label: 4, bag_size: 764
batch 279, loss: 0.0541, instance_loss: 0.2217, weighted_loss: 0.1043, label: 0, bag_size: 801
batch 299, loss: 0.0629, instance_loss: 0.2575, weighted_loss: 0.1213, label: 1, bag_size: 818
batch 319, loss: 0.0380, instance_loss: 0.2885, weighted_loss: 0.1132, label: 1, bag_size: 838
batch 339, loss: 0.3052, instance_loss: 0.4633, weighted_loss: 0.3526, label: 0, bag_size: 1527
batch 359, loss: 0.0016, instance_loss: 0.0674, weighted_loss: 0.0214, label: 3, bag_size: 729
batch 379, loss: 0.0204, instance_loss: 0.2109, weighted_loss: 0.0775, label: 4, bag_size: 297
batch 399, loss: 0.0693, instance_loss: 0.6357, weighted_loss: 0.2392, label: 1, bag_size: 778
batch 419, loss: 1.7345, instance_loss: 0.4149, weighted_loss: 1.3386, label: 0, bag_size: 371


class 0 clustering acc 0.9885882352941177: correct 16806/17000
class 1 clustering acc 0.5064705882352941: correct 1722/3400
Epoch: 50, train_loss: 0.2056, train_clustering_loss:  0.2804, train_error: 0.0800
class 0: acc 0.9411764705882353, correct 96/102
class 1: acc 0.8829787234042553, correct 83/94
class 2: acc 0.8, correct 56/70
class 3: acc 0.9868421052631579, correct 75/76
class 4: acc 0.9759036144578314, correct 81/83

Val Set, val_loss: 1.3516, val_error: 0.4000, auc: 0.8288
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.16: correct 64/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.6, correct 9/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0153, instance_loss: 0.2022, weighted_loss: 0.0714, label: 0, bag_size: 1332
batch 39, loss: 0.0034, instance_loss: 0.0558, weighted_loss: 0.0191, label: 3, bag_size: 729
batch 59, loss: 0.1676, instance_loss: 0.4229, weighted_loss: 0.2442, label: 2, bag_size: 264
batch 79, loss: 0.0002, instance_loss: 0.0705, weighted_loss: 0.0213, label: 4, bag_size: 646
batch 99, loss: 0.0004, instance_loss: 0.1084, weighted_loss: 0.0328, label: 4, bag_size: 729
batch 119, loss: 0.2699, instance_loss: 0.3107, weighted_loss: 0.2821, label: 2, bag_size: 1006
batch 139, loss: 2.0057, instance_loss: 1.2392, weighted_loss: 1.7757, label: 1, bag_size: 1799
batch 159, loss: 0.3312, instance_loss: 0.3583, weighted_loss: 0.3393, label: 3, bag_size: 1019
batch 179, loss: 0.0082, instance_loss: 0.1010, weighted_loss: 0.0360, label: 0, bag_size: 760
batch 199, loss: 0.1578, instance_loss: 0.6140, weighted_loss: 0.2947, label: 2, bag_size: 194
batch 219, loss: 0.0016, instance_loss: 0.0254, weighted_loss: 0.0087, label: 0, bag_size: 729
batch 239, loss: 0.0018, instance_loss: 0.0778, weighted_loss: 0.0246, label: 0, bag_size: 255
batch 259, loss: 0.0082, instance_loss: 0.1188, weighted_loss: 0.0414, label: 0, bag_size: 381
batch 279, loss: 0.0239, instance_loss: 0.1345, weighted_loss: 0.0571, label: 2, bag_size: 461
batch 299, loss: 0.0824, instance_loss: 0.1682, weighted_loss: 0.1081, label: 2, bag_size: 1242
batch 319, loss: 0.0004, instance_loss: 0.0741, weighted_loss: 0.0225, label: 3, bag_size: 729
batch 339, loss: 0.0022, instance_loss: 0.0297, weighted_loss: 0.0105, label: 0, bag_size: 729
batch 359, loss: 0.3619, instance_loss: 0.7833, weighted_loss: 0.4883, label: 4, bag_size: 210
batch 379, loss: 0.0107, instance_loss: 0.1829, weighted_loss: 0.0624, label: 3, bag_size: 230
batch 399, loss: 0.4849, instance_loss: 0.3527, weighted_loss: 0.4452, label: 2, bag_size: 1006
batch 419, loss: 0.0127, instance_loss: 0.2475, weighted_loss: 0.0832, label: 3, bag_size: 697


class 0 clustering acc 0.986764705882353: correct 16775/17000
class 1 clustering acc 0.5114705882352941: correct 1739/3400
Epoch: 51, train_loss: 0.1353, train_clustering_loss:  0.2781, train_error: 0.0353
class 0: acc 0.9902912621359223, correct 102/103
class 1: acc 0.9154929577464789, correct 65/71
class 2: acc 0.9278350515463918, correct 90/97
class 3: acc 0.9873417721518988, correct 78/79
class 4: acc 1.0, correct 75/75

Val Set, val_loss: 1.5422, val_error: 0.4600, auc: 0.8093
class 0 clustering acc 0.962: correct 1924/2000
class 1 clustering acc 0.1825: correct 73/400
class 0: acc 0.5, correct 2/4
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.7083333333333334, correct 17/24
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 1/1
EarlyStopping counter: 40 out of 20
Early stopping
Val error: 0.4600, ROC AUC: 0.8149
Test error: 0.3400, ROC AUC: 0.8821
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7272727272727273, correct 16/22
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 1.0, correct 3/3

Training Fold 8!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7483, instance_loss: 1.2057, weighted_loss: 1.5855, label: 2, bag_size: 409
batch 39, loss: 1.4660, instance_loss: 1.0717, weighted_loss: 1.3477, label: 3, bag_size: 729
batch 59, loss: 1.4792, instance_loss: 0.9283, weighted_loss: 1.3139, label: 0, bag_size: 729
batch 79, loss: 1.7996, instance_loss: 0.7417, weighted_loss: 1.4822, label: 2, bag_size: 1281
batch 99, loss: 1.5613, instance_loss: 0.6180, weighted_loss: 1.2783, label: 0, bag_size: 524
batch 119, loss: 1.7662, instance_loss: 0.5808, weighted_loss: 1.4106, label: 3, bag_size: 729
batch 139, loss: 1.7090, instance_loss: 0.5519, weighted_loss: 1.3618, label: 0, bag_size: 653
batch 159, loss: 1.8146, instance_loss: 0.5372, weighted_loss: 1.4314, label: 3, bag_size: 729
batch 179, loss: 1.6777, instance_loss: 0.5105, weighted_loss: 1.3275, label: 1, bag_size: 869
batch 199, loss: 1.6544, instance_loss: 0.5117, weighted_loss: 1.3116, label: 4, bag_size: 1121
batch 219, loss: 1.7090, instance_loss: 0.5196, weighted_loss: 1.3521, label: 2, bag_size: 863
batch 239, loss: 1.5500, instance_loss: 0.4944, weighted_loss: 1.2333, label: 3, bag_size: 1069
batch 259, loss: 1.4504, instance_loss: 0.5006, weighted_loss: 1.1655, label: 0, bag_size: 607
batch 279, loss: 1.3285, instance_loss: 0.4946, weighted_loss: 1.0783, label: 0, bag_size: 729
batch 299, loss: 1.3237, instance_loss: 0.4887, weighted_loss: 1.0732, label: 0, bag_size: 1133
batch 319, loss: 1.7153, instance_loss: 0.5106, weighted_loss: 1.3539, label: 1, bag_size: 446
batch 339, loss: 1.4896, instance_loss: 0.4964, weighted_loss: 1.1916, label: 0, bag_size: 402
batch 359, loss: 1.6110, instance_loss: 0.5141, weighted_loss: 1.2820, label: 2, bag_size: 421
batch 379, loss: 1.6338, instance_loss: 0.5115, weighted_loss: 1.2971, label: 4, bag_size: 656
batch 399, loss: 1.6543, instance_loss: 0.5237, weighted_loss: 1.3151, label: 3, bag_size: 211
batch 419, loss: 1.6399, instance_loss: 0.5165, weighted_loss: 1.3029, label: 3, bag_size: 281


class 0 clustering acc 0.9922941176470588: correct 16869/17000
class 1 clustering acc 0.010588235294117647: correct 36/3400
Epoch: 0, train_loss: 1.5971, train_clustering_loss:  0.6246, train_error: 0.7459
class 0: acc 0.4044943820224719, correct 36/89
class 1: acc 0.10975609756097561, correct 9/82
class 2: acc 0.013333333333333334, correct 1/75
class 3: acc 0.2558139534883721, correct 22/86
class 4: acc 0.43010752688172044, correct 40/93

Val Set, val_loss: 1.7022, val_error: 0.8800, auc: 0.7079
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/20
class 3: acc 0.0, correct 0/2
class 4: acc 1.0, correct 5/5
Validation loss decreased (inf --> 1.702186).  Saving model ...


batch 19, loss: 1.6660, instance_loss: 0.5177, weighted_loss: 1.3215, label: 1, bag_size: 1390
batch 39, loss: 1.0614, instance_loss: 0.4791, weighted_loss: 0.8867, label: 1, bag_size: 937
batch 59, loss: 2.1491, instance_loss: 0.5661, weighted_loss: 1.6742, label: 3, bag_size: 630
batch 79, loss: 1.3747, instance_loss: 0.4838, weighted_loss: 1.1074, label: 1, bag_size: 474
batch 99, loss: 1.4265, instance_loss: 0.5053, weighted_loss: 1.1501, label: 0, bag_size: 729
batch 119, loss: 1.5613, instance_loss: 0.5203, weighted_loss: 1.2490, label: 2, bag_size: 758
batch 139, loss: 1.7736, instance_loss: 0.5427, weighted_loss: 1.4043, label: 3, bag_size: 1172
batch 159, loss: 2.0807, instance_loss: 0.5490, weighted_loss: 1.6212, label: 4, bag_size: 366
batch 179, loss: 1.5143, instance_loss: 0.4985, weighted_loss: 1.2096, label: 2, bag_size: 461
batch 199, loss: 1.5498, instance_loss: 0.4972, weighted_loss: 1.2341, label: 0, bag_size: 1135
batch 219, loss: 1.3414, instance_loss: 0.4888, weighted_loss: 1.0857, label: 0, bag_size: 1190
batch 239, loss: 1.2217, instance_loss: 0.4860, weighted_loss: 1.0010, label: 0, bag_size: 921
batch 259, loss: 1.4111, instance_loss: 0.4653, weighted_loss: 1.1273, label: 4, bag_size: 754
batch 279, loss: 1.3575, instance_loss: 0.4888, weighted_loss: 1.0969, label: 4, bag_size: 354
batch 299, loss: 1.1635, instance_loss: 0.4827, weighted_loss: 0.9592, label: 1, bag_size: 636
batch 319, loss: 1.3898, instance_loss: 0.5098, weighted_loss: 1.1258, label: 3, bag_size: 729
batch 339, loss: 1.5665, instance_loss: 0.5044, weighted_loss: 1.2479, label: 0, bag_size: 245
batch 359, loss: 1.7171, instance_loss: 0.5113, weighted_loss: 1.3554, label: 2, bag_size: 1053
batch 379, loss: 0.9338, instance_loss: 0.4490, weighted_loss: 0.7883, label: 0, bag_size: 545
batch 399, loss: 1.4424, instance_loss: 0.4903, weighted_loss: 1.1567, label: 2, bag_size: 795
batch 419, loss: 1.4320, instance_loss: 0.4872, weighted_loss: 1.1486, label: 2, bag_size: 883


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4727, train_clustering_loss:  0.5012, train_error: 0.6259
class 0: acc 0.5408163265306123, correct 53/98
class 1: acc 0.39080459770114945, correct 34/87
class 2: acc 0.16483516483516483, correct 15/91
class 3: acc 0.21212121212121213, correct 14/66
class 4: acc 0.5180722891566265, correct 43/83

Val Set, val_loss: 1.4463, val_error: 0.6000, auc: 0.7602
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.3, correct 6/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.702186 --> 1.446251).  Saving model ...


batch 19, loss: 1.3763, instance_loss: 0.4963, weighted_loss: 1.1123, label: 0, bag_size: 807
batch 39, loss: 0.8776, instance_loss: 0.4607, weighted_loss: 0.7526, label: 4, bag_size: 729
batch 59, loss: 1.6726, instance_loss: 0.5287, weighted_loss: 1.3295, label: 4, bag_size: 1331
batch 79, loss: 1.5149, instance_loss: 0.5306, weighted_loss: 1.2196, label: 3, bag_size: 729
batch 99, loss: 1.7938, instance_loss: 0.4995, weighted_loss: 1.4055, label: 1, bag_size: 1409
batch 119, loss: 1.2359, instance_loss: 0.4270, weighted_loss: 0.9932, label: 1, bag_size: 925
batch 139, loss: 1.1633, instance_loss: 0.4676, weighted_loss: 0.9546, label: 3, bag_size: 729
batch 159, loss: 0.8075, instance_loss: 0.3867, weighted_loss: 0.6813, label: 1, bag_size: 1127
batch 179, loss: 1.5486, instance_loss: 0.5243, weighted_loss: 1.2413, label: 2, bag_size: 725
batch 199, loss: 1.4551, instance_loss: 0.4913, weighted_loss: 1.1660, label: 3, bag_size: 1380
batch 219, loss: 1.1157, instance_loss: 0.4494, weighted_loss: 0.9158, label: 1, bag_size: 636
batch 239, loss: 0.5463, instance_loss: 0.3610, weighted_loss: 0.4907, label: 3, bag_size: 451
batch 259, loss: 1.4479, instance_loss: 0.5506, weighted_loss: 1.1787, label: 2, bag_size: 1404
batch 279, loss: 1.9847, instance_loss: 0.5559, weighted_loss: 1.5560, label: 4, bag_size: 542
batch 299, loss: 1.1713, instance_loss: 0.4564, weighted_loss: 0.9568, label: 2, bag_size: 868
batch 319, loss: 1.1171, instance_loss: 0.4883, weighted_loss: 0.9285, label: 0, bag_size: 552
batch 339, loss: 1.4681, instance_loss: 0.4776, weighted_loss: 1.1709, label: 4, bag_size: 542
batch 359, loss: 0.5675, instance_loss: 0.3858, weighted_loss: 0.5130, label: 0, bag_size: 446
batch 379, loss: 0.5905, instance_loss: 0.3953, weighted_loss: 0.5319, label: 0, bag_size: 1143
batch 399, loss: 1.5163, instance_loss: 0.5234, weighted_loss: 1.2184, label: 2, bag_size: 357
batch 419, loss: 1.5701, instance_loss: 0.4984, weighted_loss: 1.2486, label: 3, bag_size: 281


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.2942, train_clustering_loss:  0.4765, train_error: 0.4847
class 0: acc 0.49382716049382713, correct 40/81
class 1: acc 0.7191011235955056, correct 64/89
class 2: acc 0.3829787234042553, correct 36/94
class 3: acc 0.5168539325842697, correct 46/89
class 4: acc 0.4583333333333333, correct 33/72

Val Set, val_loss: 1.3964, val_error: 0.6000, auc: 0.7510
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.4, correct 8/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.446251 --> 1.396351).  Saving model ...


batch 19, loss: 1.1855, instance_loss: 0.4522, weighted_loss: 0.9655, label: 2, bag_size: 396
batch 39, loss: 1.1506, instance_loss: 0.4324, weighted_loss: 0.9352, label: 3, bag_size: 1177
batch 59, loss: 1.8120, instance_loss: 0.5451, weighted_loss: 1.4319, label: 4, bag_size: 533
batch 79, loss: 0.6353, instance_loss: 0.3910, weighted_loss: 0.5620, label: 3, bag_size: 697
batch 99, loss: 1.3140, instance_loss: 0.4715, weighted_loss: 1.0612, label: 4, bag_size: 625
batch 119, loss: 1.6588, instance_loss: 0.5429, weighted_loss: 1.3240, label: 2, bag_size: 537
batch 139, loss: 0.7739, instance_loss: 0.4524, weighted_loss: 0.6774, label: 0, bag_size: 476
batch 159, loss: 0.6266, instance_loss: 0.3254, weighted_loss: 0.5363, label: 3, bag_size: 729
batch 179, loss: 0.2036, instance_loss: 0.2101, weighted_loss: 0.2055, label: 3, bag_size: 1559
batch 199, loss: 2.1243, instance_loss: 0.6023, weighted_loss: 1.6677, label: 1, bag_size: 308
batch 219, loss: 1.2908, instance_loss: 0.5045, weighted_loss: 1.0549, label: 2, bag_size: 408
batch 239, loss: 0.5416, instance_loss: 0.3878, weighted_loss: 0.4955, label: 1, bag_size: 890
batch 259, loss: 0.9827, instance_loss: 0.4515, weighted_loss: 0.8233, label: 2, bag_size: 1141
batch 279, loss: 1.0190, instance_loss: 0.4399, weighted_loss: 0.8453, label: 2, bag_size: 307
batch 299, loss: 0.8826, instance_loss: 0.4544, weighted_loss: 0.7542, label: 0, bag_size: 542
batch 319, loss: 1.0222, instance_loss: 0.4603, weighted_loss: 0.8536, label: 2, bag_size: 1400
batch 339, loss: 0.4475, instance_loss: 0.4114, weighted_loss: 0.4367, label: 4, bag_size: 754
batch 359, loss: 0.3563, instance_loss: 0.3205, weighted_loss: 0.3456, label: 4, bag_size: 729
batch 379, loss: 2.6349, instance_loss: 0.5562, weighted_loss: 2.0113, label: 0, bag_size: 1301
batch 399, loss: 0.5911, instance_loss: 0.3981, weighted_loss: 0.5332, label: 0, bag_size: 367
batch 419, loss: 0.9086, instance_loss: 0.3994, weighted_loss: 0.7558, label: 4, bag_size: 354


class 0 clustering acc 0.999: correct 16983/17000
class 1 clustering acc 0.012352941176470587: correct 42/3400
Epoch: 3, train_loss: 1.0604, train_clustering_loss:  0.4373, train_error: 0.3388
class 0: acc 0.632183908045977, correct 55/87
class 1: acc 0.4647887323943662, correct 33/71
class 2: acc 0.47560975609756095, correct 39/82
class 3: acc 0.8333333333333334, correct 80/96
class 4: acc 0.8314606741573034, correct 74/89

Val Set, val_loss: 1.2307, val_error: 0.5200, auc: 0.8033
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.2, correct 4/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.396351 --> 1.230726).  Saving model ...


batch 19, loss: 0.4428, instance_loss: 0.3593, weighted_loss: 0.4177, label: 0, bag_size: 1872
batch 39, loss: 1.6099, instance_loss: 0.5152, weighted_loss: 1.2815, label: 1, bag_size: 319
batch 59, loss: 2.1909, instance_loss: 0.5459, weighted_loss: 1.6974, label: 3, bag_size: 281
batch 79, loss: 0.5121, instance_loss: 0.3606, weighted_loss: 0.4667, label: 4, bag_size: 773
batch 99, loss: 1.1625, instance_loss: 0.5023, weighted_loss: 0.9644, label: 0, bag_size: 976
batch 119, loss: 0.6376, instance_loss: 0.2960, weighted_loss: 0.5351, label: 3, bag_size: 729
batch 139, loss: 0.5438, instance_loss: 0.3831, weighted_loss: 0.4956, label: 4, bag_size: 826
batch 159, loss: 0.4650, instance_loss: 0.3166, weighted_loss: 0.4205, label: 1, bag_size: 288
batch 179, loss: 0.6017, instance_loss: 0.3941, weighted_loss: 0.5394, label: 0, bag_size: 1247
batch 199, loss: 1.8363, instance_loss: 0.5694, weighted_loss: 1.4562, label: 3, bag_size: 200
batch 219, loss: 1.4904, instance_loss: 0.4811, weighted_loss: 1.1876, label: 1, bag_size: 887
batch 239, loss: 2.0929, instance_loss: 0.6109, weighted_loss: 1.6483, label: 1, bag_size: 1376
batch 259, loss: 0.5286, instance_loss: 0.3807, weighted_loss: 0.4842, label: 0, bag_size: 367
batch 279, loss: 2.3778, instance_loss: 0.7261, weighted_loss: 1.8823, label: 2, bag_size: 1108
batch 299, loss: 2.6987, instance_loss: 0.5820, weighted_loss: 2.0637, label: 4, bag_size: 1235
batch 319, loss: 0.2556, instance_loss: 0.2172, weighted_loss: 0.2441, label: 1, bag_size: 828
batch 339, loss: 0.8885, instance_loss: 0.4145, weighted_loss: 0.7463, label: 4, bag_size: 436
batch 359, loss: 0.4968, instance_loss: 0.2802, weighted_loss: 0.4318, label: 1, bag_size: 1325
batch 379, loss: 0.7231, instance_loss: 0.4372, weighted_loss: 0.6373, label: 2, bag_size: 2826
batch 399, loss: 1.1919, instance_loss: 0.4890, weighted_loss: 0.9810, label: 2, bag_size: 1006
batch 419, loss: 0.2375, instance_loss: 0.4507, weighted_loss: 0.3015, label: 4, bag_size: 882


class 0 clustering acc 0.9977647058823529: correct 16962/17000
class 1 clustering acc 0.039411764705882354: correct 134/3400
Epoch: 4, train_loss: 0.9798, train_clustering_loss:  0.4222, train_error: 0.3153
class 0: acc 0.7875, correct 63/80
class 1: acc 0.5465116279069767, correct 47/86
class 2: acc 0.6346153846153846, correct 66/104
class 3: acc 0.6197183098591549, correct 44/71
class 4: acc 0.8452380952380952, correct 71/84

Val Set, val_loss: 1.1790, val_error: 0.4200, auc: 0.8009
class 0 clustering acc 0.9975: correct 1995/2000
class 1 clustering acc 0.005: correct 2/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.5, correct 10/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.230726 --> 1.178959).  Saving model ...


batch 19, loss: 0.5790, instance_loss: 0.3231, weighted_loss: 0.5022, label: 1, bag_size: 696
batch 39, loss: 1.8658, instance_loss: 0.4981, weighted_loss: 1.4555, label: 1, bag_size: 1646
batch 59, loss: 1.6414, instance_loss: 0.4777, weighted_loss: 1.2923, label: 1, bag_size: 1273
batch 79, loss: 0.1059, instance_loss: 0.2847, weighted_loss: 0.1596, label: 3, bag_size: 1253
batch 99, loss: 0.1148, instance_loss: 0.4457, weighted_loss: 0.2141, label: 4, bag_size: 754
batch 119, loss: 1.9048, instance_loss: 0.5471, weighted_loss: 1.4975, label: 3, bag_size: 630
batch 139, loss: 0.7726, instance_loss: 0.4663, weighted_loss: 0.6807, label: 2, bag_size: 1218
batch 159, loss: 0.4127, instance_loss: 0.3608, weighted_loss: 0.3971, label: 4, bag_size: 754
batch 179, loss: 0.3050, instance_loss: 0.3830, weighted_loss: 0.3284, label: 0, bag_size: 729
batch 199, loss: 0.6165, instance_loss: 0.3228, weighted_loss: 0.5284, label: 1, bag_size: 869
batch 219, loss: 0.3918, instance_loss: 0.2017, weighted_loss: 0.3348, label: 3, bag_size: 729
batch 239, loss: 0.2099, instance_loss: 0.2095, weighted_loss: 0.2098, label: 4, bag_size: 729
batch 259, loss: 1.0180, instance_loss: 0.5769, weighted_loss: 0.8857, label: 0, bag_size: 1301
batch 279, loss: 0.3281, instance_loss: 0.5664, weighted_loss: 0.3996, label: 4, bag_size: 542
batch 299, loss: 0.2557, instance_loss: 0.1559, weighted_loss: 0.2258, label: 3, bag_size: 729
batch 319, loss: 0.4034, instance_loss: 0.3024, weighted_loss: 0.3731, label: 4, bag_size: 729
batch 339, loss: 0.6756, instance_loss: 0.3182, weighted_loss: 0.5684, label: 1, bag_size: 614
batch 359, loss: 0.3690, instance_loss: 0.3594, weighted_loss: 0.3661, label: 0, bag_size: 1466
batch 379, loss: 0.9310, instance_loss: 0.3668, weighted_loss: 0.7617, label: 1, bag_size: 968
batch 399, loss: 0.3698, instance_loss: 0.2152, weighted_loss: 0.3234, label: 3, bag_size: 729
batch 419, loss: 0.1957, instance_loss: 0.2633, weighted_loss: 0.2160, label: 3, bag_size: 316


class 0 clustering acc 0.9969411764705882: correct 16948/17000
class 1 clustering acc 0.11588235294117646: correct 394/3400
Epoch: 5, train_loss: 0.8289, train_clustering_loss:  0.3941, train_error: 0.3176
class 0: acc 0.8351648351648352, correct 76/91
class 1: acc 0.5897435897435898, correct 46/78
class 2: acc 0.4588235294117647, correct 39/85
class 3: acc 0.76, correct 57/75
class 4: acc 0.75, correct 72/96

Val Set, val_loss: 1.2376, val_error: 0.5200, auc: 0.8048
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.0325: correct 13/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.3, correct 6/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.8, correct 4/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1224, instance_loss: 0.3297, weighted_loss: 0.1846, label: 4, bag_size: 675
batch 39, loss: 0.1273, instance_loss: 0.1935, weighted_loss: 0.1471, label: 0, bag_size: 367
batch 59, loss: 0.2264, instance_loss: 0.2087, weighted_loss: 0.2211, label: 3, bag_size: 729
batch 79, loss: 0.0732, instance_loss: 0.1454, weighted_loss: 0.0948, label: 3, bag_size: 451
batch 99, loss: 0.2362, instance_loss: 0.1428, weighted_loss: 0.2082, label: 3, bag_size: 556
batch 119, loss: 1.7999, instance_loss: 0.7006, weighted_loss: 1.4701, label: 4, bag_size: 511
batch 139, loss: 1.2979, instance_loss: 0.5488, weighted_loss: 1.0732, label: 2, bag_size: 934
batch 159, loss: 0.6761, instance_loss: 0.4209, weighted_loss: 0.5995, label: 0, bag_size: 718
batch 179, loss: 1.1833, instance_loss: 0.4954, weighted_loss: 0.9769, label: 2, bag_size: 614
batch 199, loss: 0.4800, instance_loss: 0.1951, weighted_loss: 0.3945, label: 4, bag_size: 729
batch 219, loss: 0.9148, instance_loss: 0.4782, weighted_loss: 0.7838, label: 2, bag_size: 396
batch 239, loss: 0.3838, instance_loss: 0.4798, weighted_loss: 0.4126, label: 0, bag_size: 729
batch 259, loss: 0.3812, instance_loss: 0.2972, weighted_loss: 0.3560, label: 0, bag_size: 542
batch 279, loss: 0.1129, instance_loss: 0.1285, weighted_loss: 0.1175, label: 3, bag_size: 1559
batch 299, loss: 3.1743, instance_loss: 0.3453, weighted_loss: 2.3256, label: 4, bag_size: 1357
batch 319, loss: 0.3225, instance_loss: 0.3990, weighted_loss: 0.3454, label: 3, bag_size: 936
batch 339, loss: 0.6659, instance_loss: 0.3265, weighted_loss: 0.5640, label: 4, bag_size: 729
batch 359, loss: 0.4684, instance_loss: 0.2929, weighted_loss: 0.4157, label: 1, bag_size: 994
batch 379, loss: 0.8802, instance_loss: 0.5234, weighted_loss: 0.7732, label: 0, bag_size: 718
batch 399, loss: 0.8094, instance_loss: 0.4771, weighted_loss: 0.7097, label: 2, bag_size: 638
batch 419, loss: 0.8426, instance_loss: 0.6531, weighted_loss: 0.7858, label: 0, bag_size: 729


class 0 clustering acc 0.9971176470588236: correct 16951/17000
class 1 clustering acc 0.15176470588235294: correct 516/3400
Epoch: 6, train_loss: 0.8152, train_clustering_loss:  0.3860, train_error: 0.3012
class 0: acc 0.8367346938775511, correct 82/98
class 1: acc 0.5857142857142857, correct 41/70
class 2: acc 0.45121951219512196, correct 37/82
class 3: acc 0.7045454545454546, correct 62/88
class 4: acc 0.8620689655172413, correct 75/87

Val Set, val_loss: 1.1864, val_error: 0.4000, auc: 0.7964
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.0375: correct 15/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.55, correct 11/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8080, instance_loss: 0.4399, weighted_loss: 0.6976, label: 2, bag_size: 323
batch 39, loss: 0.1190, instance_loss: 0.1328, weighted_loss: 0.1232, label: 4, bag_size: 729
batch 59, loss: 1.2807, instance_loss: 0.5417, weighted_loss: 1.0590, label: 3, bag_size: 630
batch 79, loss: 1.4889, instance_loss: 0.5662, weighted_loss: 1.2121, label: 2, bag_size: 1400
batch 99, loss: 0.5404, instance_loss: 0.4277, weighted_loss: 0.5066, label: 2, bag_size: 1281
batch 119, loss: 0.7140, instance_loss: 0.4260, weighted_loss: 0.6276, label: 0, bag_size: 413
batch 139, loss: 0.9543, instance_loss: 0.4446, weighted_loss: 0.8014, label: 0, bag_size: 729
batch 159, loss: 1.8266, instance_loss: 0.5978, weighted_loss: 1.4579, label: 2, bag_size: 110
batch 179, loss: 0.3676, instance_loss: 0.3389, weighted_loss: 0.3590, label: 4, bag_size: 625
batch 199, loss: 0.9728, instance_loss: 0.4867, weighted_loss: 0.8270, label: 2, bag_size: 636
batch 219, loss: 2.3574, instance_loss: 0.6463, weighted_loss: 1.8441, label: 3, bag_size: 706
batch 239, loss: 1.5418, instance_loss: 0.5250, weighted_loss: 1.2368, label: 1, bag_size: 651
batch 259, loss: 0.3535, instance_loss: 0.4458, weighted_loss: 0.3812, label: 4, bag_size: 823
batch 279, loss: 0.1041, instance_loss: 0.0888, weighted_loss: 0.0995, label: 3, bag_size: 1172
batch 299, loss: 1.3648, instance_loss: 0.5292, weighted_loss: 1.1141, label: 4, bag_size: 533
batch 319, loss: 0.0287, instance_loss: 0.1611, weighted_loss: 0.0684, label: 4, bag_size: 388
batch 339, loss: 0.3388, instance_loss: 0.2945, weighted_loss: 0.3255, label: 1, bag_size: 1014
batch 359, loss: 0.7456, instance_loss: 0.4369, weighted_loss: 0.6530, label: 2, bag_size: 1123
batch 379, loss: 0.4365, instance_loss: 0.3505, weighted_loss: 0.4107, label: 0, bag_size: 718
batch 399, loss: 2.2448, instance_loss: 0.6012, weighted_loss: 1.7517, label: 2, bag_size: 373
batch 419, loss: 0.5853, instance_loss: 0.2810, weighted_loss: 0.4940, label: 3, bag_size: 697


class 0 clustering acc 0.9964117647058823: correct 16939/17000
class 1 clustering acc 0.20823529411764705: correct 708/3400
Epoch: 7, train_loss: 0.7311, train_clustering_loss:  0.3736, train_error: 0.2565
class 0: acc 0.8735632183908046, correct 76/87
class 1: acc 0.5301204819277109, correct 44/83
class 2: acc 0.625, correct 50/80
class 3: acc 0.8571428571428571, correct 78/91
class 4: acc 0.8095238095238095, correct 68/84

Val Set, val_loss: 1.1406, val_error: 0.4200, auc: 0.8030
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.0475: correct 19/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.4, correct 8/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.178959 --> 1.140550).  Saving model ...


batch 19, loss: 0.0931, instance_loss: 0.3286, weighted_loss: 0.1638, label: 4, bag_size: 711
batch 39, loss: 0.1618, instance_loss: 0.3125, weighted_loss: 0.2070, label: 3, bag_size: 936
batch 59, loss: 0.2568, instance_loss: 0.3824, weighted_loss: 0.2945, label: 3, bag_size: 821
batch 79, loss: 3.3277, instance_loss: 0.6633, weighted_loss: 2.5284, label: 0, bag_size: 282
batch 99, loss: 0.1218, instance_loss: 0.1398, weighted_loss: 0.1272, label: 3, bag_size: 729
batch 119, loss: 0.5437, instance_loss: 0.3534, weighted_loss: 0.4866, label: 2, bag_size: 1150
batch 139, loss: 1.1682, instance_loss: 0.3484, weighted_loss: 0.9223, label: 2, bag_size: 1155
batch 159, loss: 0.3333, instance_loss: 0.2849, weighted_loss: 0.3188, label: 2, bag_size: 461
batch 179, loss: 0.6181, instance_loss: 0.4817, weighted_loss: 0.5772, label: 0, bag_size: 1301
batch 199, loss: 0.0951, instance_loss: 0.1822, weighted_loss: 0.1212, label: 0, bag_size: 1012
batch 219, loss: 1.1910, instance_loss: 0.3936, weighted_loss: 0.9518, label: 4, bag_size: 297
batch 239, loss: 0.1586, instance_loss: 0.2225, weighted_loss: 0.1778, label: 1, bag_size: 636
batch 259, loss: 0.1570, instance_loss: 0.3235, weighted_loss: 0.2069, label: 4, bag_size: 729
batch 279, loss: 0.0335, instance_loss: 0.2798, weighted_loss: 0.1074, label: 3, bag_size: 841
batch 299, loss: 1.3711, instance_loss: 0.4453, weighted_loss: 1.0934, label: 4, bag_size: 533
batch 319, loss: 0.3352, instance_loss: 0.1989, weighted_loss: 0.2943, label: 1, bag_size: 869
batch 339, loss: 0.0539, instance_loss: 0.1174, weighted_loss: 0.0729, label: 3, bag_size: 1069
batch 359, loss: 0.7839, instance_loss: 0.3935, weighted_loss: 0.6668, label: 2, bag_size: 384
batch 379, loss: 0.9477, instance_loss: 0.4426, weighted_loss: 0.7962, label: 1, bag_size: 1724
batch 399, loss: 0.7792, instance_loss: 0.4737, weighted_loss: 0.6875, label: 2, bag_size: 373
batch 419, loss: 0.3908, instance_loss: 0.2489, weighted_loss: 0.3482, label: 0, bag_size: 1579


class 0 clustering acc 0.993764705882353: correct 16894/17000
class 1 clustering acc 0.2114705882352941: correct 719/3400
Epoch: 8, train_loss: 0.6958, train_clustering_loss:  0.3702, train_error: 0.2541
class 0: acc 0.8378378378378378, correct 62/74
class 1: acc 0.66, correct 66/100
class 2: acc 0.65, correct 65/100
class 3: acc 0.8088235294117647, correct 55/68
class 4: acc 0.8313253012048193, correct 69/83

Val Set, val_loss: 1.0690, val_error: 0.3800, auc: 0.8091
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.0925: correct 37/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.55, correct 11/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.140550 --> 1.069047).  Saving model ...


batch 19, loss: 0.5609, instance_loss: 0.3613, weighted_loss: 0.5010, label: 2, bag_size: 461
batch 39, loss: 0.7099, instance_loss: 0.4109, weighted_loss: 0.6202, label: 2, bag_size: 262
batch 59, loss: 1.6793, instance_loss: 0.5233, weighted_loss: 1.3325, label: 1, bag_size: 861
batch 79, loss: 1.9156, instance_loss: 0.6399, weighted_loss: 1.5329, label: 4, bag_size: 436
batch 99, loss: 0.8429, instance_loss: 0.4375, weighted_loss: 0.7213, label: 1, bag_size: 711
batch 119, loss: 0.4575, instance_loss: 0.3191, weighted_loss: 0.4160, label: 0, bag_size: 432
batch 139, loss: 0.1150, instance_loss: 0.1457, weighted_loss: 0.1242, label: 1, bag_size: 1261
batch 159, loss: 0.0549, instance_loss: 0.1634, weighted_loss: 0.0875, label: 4, bag_size: 1235
batch 179, loss: 0.0515, instance_loss: 0.0808, weighted_loss: 0.0603, label: 3, bag_size: 1559
batch 199, loss: 1.3131, instance_loss: 0.5807, weighted_loss: 1.0934, label: 2, bag_size: 1533
batch 219, loss: 0.0852, instance_loss: 0.1617, weighted_loss: 0.1082, label: 4, bag_size: 729
batch 239, loss: 0.5873, instance_loss: 0.3822, weighted_loss: 0.5257, label: 2, bag_size: 1404
batch 259, loss: 0.3029, instance_loss: 0.3761, weighted_loss: 0.3249, label: 1, bag_size: 1096
batch 279, loss: 0.5147, instance_loss: 0.2934, weighted_loss: 0.4483, label: 0, bag_size: 552
batch 299, loss: 0.0877, instance_loss: 0.2705, weighted_loss: 0.1425, label: 0, bag_size: 729
batch 319, loss: 0.0297, instance_loss: 0.0654, weighted_loss: 0.0404, label: 3, bag_size: 1172
batch 339, loss: 0.5392, instance_loss: 0.4841, weighted_loss: 0.5227, label: 4, bag_size: 436
batch 359, loss: 0.3073, instance_loss: 0.2185, weighted_loss: 0.2806, label: 1, bag_size: 994
batch 379, loss: 0.0312, instance_loss: 0.2054, weighted_loss: 0.0834, label: 4, bag_size: 1278
batch 399, loss: 0.0265, instance_loss: 0.0908, weighted_loss: 0.0458, label: 3, bag_size: 729
batch 419, loss: 0.2407, instance_loss: 0.3152, weighted_loss: 0.2631, label: 0, bag_size: 653


class 0 clustering acc 0.994764705882353: correct 16911/17000
class 1 clustering acc 0.2979411764705882: correct 1013/3400
Epoch: 9, train_loss: 0.6504, train_clustering_loss:  0.3472, train_error: 0.2424
class 0: acc 0.8829787234042553, correct 83/94
class 1: acc 0.6703296703296703, correct 61/91
class 2: acc 0.4098360655737705, correct 25/61
class 3: acc 0.8390804597701149, correct 73/87
class 4: acc 0.8695652173913043, correct 80/92

Val Set, val_loss: 1.3363, val_error: 0.5000, auc: 0.8013
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.0925: correct 37/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.35, correct 7/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1581, instance_loss: 0.4075, weighted_loss: 0.2329, label: 4, bag_size: 928
batch 39, loss: 0.1732, instance_loss: 0.1927, weighted_loss: 0.1791, label: 0, bag_size: 630
batch 59, loss: 0.4189, instance_loss: 0.3879, weighted_loss: 0.4096, label: 4, bag_size: 823
batch 79, loss: 0.0229, instance_loss: 0.1113, weighted_loss: 0.0494, label: 4, bag_size: 729
batch 99, loss: 0.2028, instance_loss: 0.1753, weighted_loss: 0.1946, label: 3, bag_size: 729
batch 119, loss: 2.6487, instance_loss: 0.5863, weighted_loss: 2.0300, label: 1, bag_size: 442
batch 139, loss: 1.4373, instance_loss: 0.6342, weighted_loss: 1.1964, label: 2, bag_size: 248
batch 159, loss: 0.4073, instance_loss: 0.3552, weighted_loss: 0.3917, label: 2, bag_size: 935
batch 179, loss: 0.8077, instance_loss: 0.3638, weighted_loss: 0.6745, label: 1, bag_size: 968
batch 199, loss: 0.4390, instance_loss: 0.3207, weighted_loss: 0.4035, label: 2, bag_size: 1448
batch 219, loss: 0.0961, instance_loss: 0.2150, weighted_loss: 0.1318, label: 1, bag_size: 696
batch 239, loss: 0.7477, instance_loss: 0.3492, weighted_loss: 0.6282, label: 0, bag_size: 1190
batch 259, loss: 0.4155, instance_loss: 0.3644, weighted_loss: 0.4002, label: 2, bag_size: 408
batch 279, loss: 0.0731, instance_loss: 0.1325, weighted_loss: 0.0910, label: 3, bag_size: 729
batch 299, loss: 1.0347, instance_loss: 0.4994, weighted_loss: 0.8741, label: 1, bag_size: 868
batch 319, loss: 0.1422, instance_loss: 0.1946, weighted_loss: 0.1579, label: 0, bag_size: 518
batch 339, loss: 0.0338, instance_loss: 0.1323, weighted_loss: 0.0633, label: 3, bag_size: 841
batch 359, loss: 0.7471, instance_loss: 0.4508, weighted_loss: 0.6582, label: 1, bag_size: 504
batch 379, loss: 1.3003, instance_loss: 0.5459, weighted_loss: 1.0740, label: 4, bag_size: 656
batch 399, loss: 0.6074, instance_loss: 0.4044, weighted_loss: 0.5465, label: 2, bag_size: 682
batch 419, loss: 0.6144, instance_loss: 0.6530, weighted_loss: 0.6260, label: 4, bag_size: 436


class 0 clustering acc 0.9918823529411764: correct 16862/17000
class 1 clustering acc 0.2711764705882353: correct 922/3400
Epoch: 10, train_loss: 0.6226, train_clustering_loss:  0.3601, train_error: 0.2235
class 0: acc 0.8181818181818182, correct 63/77
class 1: acc 0.7419354838709677, correct 69/93
class 2: acc 0.6210526315789474, correct 59/95
class 3: acc 0.8505747126436781, correct 74/87
class 4: acc 0.8904109589041096, correct 65/73

Val Set, val_loss: 1.0905, val_error: 0.3600, auc: 0.7992
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.0875: correct 35/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.65, correct 13/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0166, instance_loss: 0.1306, weighted_loss: 0.0508, label: 4, bag_size: 524
batch 39, loss: 0.0050, instance_loss: 0.0517, weighted_loss: 0.0190, label: 4, bag_size: 764
batch 59, loss: 0.7288, instance_loss: 0.5422, weighted_loss: 0.6729, label: 3, bag_size: 630
batch 79, loss: 0.5453, instance_loss: 0.2321, weighted_loss: 0.4514, label: 3, bag_size: 533
batch 99, loss: 0.5045, instance_loss: 0.4559, weighted_loss: 0.4899, label: 3, bag_size: 1380
batch 119, loss: 0.4395, instance_loss: 0.3446, weighted_loss: 0.4110, label: 2, bag_size: 774
batch 139, loss: 0.0969, instance_loss: 0.1743, weighted_loss: 0.1201, label: 0, bag_size: 1135
batch 159, loss: 1.4391, instance_loss: 0.5764, weighted_loss: 1.1803, label: 2, bag_size: 934
batch 179, loss: 0.0945, instance_loss: 0.0922, weighted_loss: 0.0938, label: 3, bag_size: 1291
batch 199, loss: 0.9724, instance_loss: 0.4463, weighted_loss: 0.8146, label: 0, bag_size: 1065
batch 219, loss: 0.2604, instance_loss: 0.1717, weighted_loss: 0.2338, label: 0, bag_size: 1579
batch 239, loss: 0.3872, instance_loss: 0.2986, weighted_loss: 0.3606, label: 0, bag_size: 962
batch 259, loss: 0.3399, instance_loss: 0.5806, weighted_loss: 0.4121, label: 3, bag_size: 1167
batch 279, loss: 0.0961, instance_loss: 0.1149, weighted_loss: 0.1018, label: 0, bag_size: 518
batch 299, loss: 0.2110, instance_loss: 0.3467, weighted_loss: 0.2517, label: 1, bag_size: 102
batch 319, loss: 0.1228, instance_loss: 0.1974, weighted_loss: 0.1452, label: 0, bag_size: 729
batch 339, loss: 0.0524, instance_loss: 0.4780, weighted_loss: 0.1801, label: 4, bag_size: 882
batch 359, loss: 0.8155, instance_loss: 0.4444, weighted_loss: 0.7042, label: 2, bag_size: 1167
batch 379, loss: 1.1989, instance_loss: 0.3670, weighted_loss: 0.9493, label: 0, bag_size: 350
batch 399, loss: 0.1091, instance_loss: 0.1879, weighted_loss: 0.1327, label: 0, bag_size: 1517
batch 419, loss: 0.7436, instance_loss: 0.4576, weighted_loss: 0.6578, label: 4, bag_size: 826


class 0 clustering acc 0.9914705882352941: correct 16855/17000
class 1 clustering acc 0.2952941176470588: correct 1004/3400
Epoch: 11, train_loss: 0.6180, train_clustering_loss:  0.3568, train_error: 0.2282
class 0: acc 0.8295454545454546, correct 73/88
class 1: acc 0.6222222222222222, correct 56/90
class 2: acc 0.625, correct 55/88
class 3: acc 0.8783783783783784, correct 65/74
class 4: acc 0.9294117647058824, correct 79/85

Val Set, val_loss: 1.1016, val_error: 0.3400, auc: 0.8173
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.1625: correct 65/400
class 0: acc 1.0, correct 11/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.55, correct 11/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1408, instance_loss: 0.2707, weighted_loss: 0.1797, label: 3, bag_size: 821
batch 39, loss: 2.2785, instance_loss: 0.7206, weighted_loss: 1.8111, label: 2, bag_size: 1231
batch 59, loss: 0.2528, instance_loss: 0.3457, weighted_loss: 0.2807, label: 0, bag_size: 1135
batch 79, loss: 0.2938, instance_loss: 0.3475, weighted_loss: 0.3099, label: 2, bag_size: 314
batch 99, loss: 0.6163, instance_loss: 0.4301, weighted_loss: 0.5604, label: 4, bag_size: 663
batch 119, loss: 0.0770, instance_loss: 0.1921, weighted_loss: 0.1115, label: 3, bag_size: 936
batch 139, loss: 0.1068, instance_loss: 0.0596, weighted_loss: 0.0926, label: 3, bag_size: 1172
batch 159, loss: 0.2032, instance_loss: 0.1109, weighted_loss: 0.1755, label: 3, bag_size: 729
batch 179, loss: 1.7179, instance_loss: 0.5259, weighted_loss: 1.3603, label: 1, bag_size: 1197
batch 199, loss: 0.0991, instance_loss: 0.1853, weighted_loss: 0.1249, label: 1, bag_size: 866
batch 219, loss: 0.8856, instance_loss: 0.4493, weighted_loss: 0.7547, label: 1, bag_size: 838
batch 239, loss: 0.6931, instance_loss: 0.3809, weighted_loss: 0.5994, label: 1, bag_size: 399
batch 259, loss: 0.6969, instance_loss: 0.3854, weighted_loss: 0.6035, label: 2, bag_size: 1180
batch 279, loss: 0.1747, instance_loss: 0.2987, weighted_loss: 0.2119, label: 4, bag_size: 773
batch 299, loss: 0.4212, instance_loss: 0.2923, weighted_loss: 0.3825, label: 0, bag_size: 432
batch 319, loss: 0.0735, instance_loss: 0.0944, weighted_loss: 0.0797, label: 3, bag_size: 1559
batch 339, loss: 0.3140, instance_loss: 0.2631, weighted_loss: 0.2988, label: 0, bag_size: 729
batch 359, loss: 1.9152, instance_loss: 0.5689, weighted_loss: 1.5113, label: 1, bag_size: 446
batch 379, loss: 1.5584, instance_loss: 0.5532, weighted_loss: 1.2569, label: 2, bag_size: 248
batch 399, loss: 1.6039, instance_loss: 0.5156, weighted_loss: 1.2774, label: 1, bag_size: 446
batch 419, loss: 0.0603, instance_loss: 0.1032, weighted_loss: 0.0732, label: 3, bag_size: 451


class 0 clustering acc 0.9921764705882353: correct 16867/17000
class 1 clustering acc 0.3111764705882353: correct 1058/3400
Epoch: 12, train_loss: 0.5912, train_clustering_loss:  0.3475, train_error: 0.2141
class 0: acc 0.8461538461538461, correct 66/78
class 1: acc 0.7291666666666666, correct 70/96
class 2: acc 0.6067415730337079, correct 54/89
class 3: acc 0.8717948717948718, correct 68/78
class 4: acc 0.9047619047619048, correct 76/84

Val Set, val_loss: 1.1183, val_error: 0.4400, auc: 0.7852
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.14: correct 56/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.5, correct 10/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0426, instance_loss: 0.0857, weighted_loss: 0.0556, label: 3, bag_size: 729
batch 39, loss: 0.3389, instance_loss: 0.3292, weighted_loss: 0.3360, label: 2, bag_size: 907
batch 59, loss: 0.1645, instance_loss: 0.3637, weighted_loss: 0.2243, label: 4, bag_size: 754
batch 79, loss: 0.0025, instance_loss: 0.1468, weighted_loss: 0.0458, label: 4, bag_size: 729
batch 99, loss: 0.0470, instance_loss: 0.2338, weighted_loss: 0.1031, label: 3, bag_size: 729
batch 119, loss: 1.1615, instance_loss: 0.4220, weighted_loss: 0.9397, label: 1, bag_size: 711
batch 139, loss: 0.1200, instance_loss: 0.2629, weighted_loss: 0.1628, label: 0, bag_size: 515
batch 159, loss: 0.7575, instance_loss: 0.5122, weighted_loss: 0.6839, label: 0, bag_size: 1065
batch 179, loss: 0.7631, instance_loss: 0.4748, weighted_loss: 0.6766, label: 3, bag_size: 1380
batch 199, loss: 0.0084, instance_loss: 0.1713, weighted_loss: 0.0573, label: 4, bag_size: 711
batch 219, loss: 1.4226, instance_loss: 0.5840, weighted_loss: 1.1710, label: 4, bag_size: 533
batch 239, loss: 0.1030, instance_loss: 0.2822, weighted_loss: 0.1567, label: 0, bag_size: 729
batch 259, loss: 0.2518, instance_loss: 0.1640, weighted_loss: 0.2255, label: 1, bag_size: 790
batch 279, loss: 0.0687, instance_loss: 0.0552, weighted_loss: 0.0647, label: 3, bag_size: 729
batch 299, loss: 0.3222, instance_loss: 0.2526, weighted_loss: 0.3013, label: 1, bag_size: 320
batch 319, loss: 1.2150, instance_loss: 0.4709, weighted_loss: 0.9917, label: 1, bag_size: 711
batch 339, loss: 0.2962, instance_loss: 0.5269, weighted_loss: 0.3654, label: 3, bag_size: 200
batch 359, loss: 0.4580, instance_loss: 0.4057, weighted_loss: 0.4423, label: 2, bag_size: 1052
batch 379, loss: 0.3096, instance_loss: 0.2925, weighted_loss: 0.3045, label: 4, bag_size: 625
batch 399, loss: 0.7346, instance_loss: 0.5657, weighted_loss: 0.6839, label: 0, bag_size: 515
batch 419, loss: 1.9263, instance_loss: 0.7011, weighted_loss: 1.5587, label: 1, bag_size: 293


class 0 clustering acc 0.9912941176470588: correct 16852/17000
class 1 clustering acc 0.39205882352941174: correct 1333/3400
Epoch: 13, train_loss: 0.4444, train_clustering_loss:  0.3146, train_error: 0.1435
class 0: acc 0.9493670886075949, correct 75/79
class 1: acc 0.7439024390243902, correct 61/82
class 2: acc 0.7037037037037037, correct 57/81
class 3: acc 0.9240506329113924, correct 73/79
class 4: acc 0.9423076923076923, correct 98/104

Val Set, val_loss: 1.1276, val_error: 0.3600, auc: 0.7782
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.125: correct 50/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.7, correct 14/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0043, instance_loss: 0.0818, weighted_loss: 0.0275, label: 4, bag_size: 1235
batch 39, loss: 0.0261, instance_loss: 0.0400, weighted_loss: 0.0302, label: 3, bag_size: 1069
batch 59, loss: 0.6699, instance_loss: 0.3346, weighted_loss: 0.5693, label: 3, bag_size: 697
batch 79, loss: 1.0767, instance_loss: 0.5570, weighted_loss: 0.9208, label: 2, bag_size: 707
batch 99, loss: 1.7427, instance_loss: 0.4087, weighted_loss: 1.3425, label: 3, bag_size: 821
batch 119, loss: 0.0011, instance_loss: 0.1292, weighted_loss: 0.0395, label: 4, bag_size: 729
batch 139, loss: 0.0036, instance_loss: 0.1548, weighted_loss: 0.0490, label: 4, bag_size: 729
batch 159, loss: 3.7340, instance_loss: 0.8815, weighted_loss: 2.8783, label: 1, bag_size: 875
batch 179, loss: 0.0137, instance_loss: 0.2396, weighted_loss: 0.0815, label: 4, bag_size: 882
batch 199, loss: 1.5253, instance_loss: 0.5942, weighted_loss: 1.2459, label: 0, bag_size: 818
batch 219, loss: 1.7355, instance_loss: 0.5569, weighted_loss: 1.3819, label: 1, bag_size: 1646
batch 239, loss: 0.4558, instance_loss: 0.3976, weighted_loss: 0.4384, label: 1, bag_size: 897
batch 259, loss: 3.4947, instance_loss: 0.8668, weighted_loss: 2.7063, label: 1, bag_size: 1799
batch 279, loss: 0.7309, instance_loss: 0.4615, weighted_loss: 0.6501, label: 2, bag_size: 748
batch 299, loss: 0.1604, instance_loss: 0.2749, weighted_loss: 0.1948, label: 0, bag_size: 729
batch 319, loss: 0.0356, instance_loss: 0.0910, weighted_loss: 0.0522, label: 3, bag_size: 729
batch 339, loss: 0.7340, instance_loss: 0.6194, weighted_loss: 0.6996, label: 4, bag_size: 366
batch 359, loss: 1.2201, instance_loss: 0.4343, weighted_loss: 0.9844, label: 1, bag_size: 377
batch 379, loss: 1.9251, instance_loss: 0.8440, weighted_loss: 1.6008, label: 1, bag_size: 700
batch 399, loss: 0.1579, instance_loss: 0.4696, weighted_loss: 0.2514, label: 1, bag_size: 442
batch 419, loss: 0.1156, instance_loss: 0.1184, weighted_loss: 0.1165, label: 3, bag_size: 729


class 0 clustering acc 0.9893529411764705: correct 16819/17000
class 1 clustering acc 0.3352941176470588: correct 1140/3400
Epoch: 14, train_loss: 0.5677, train_clustering_loss:  0.3574, train_error: 0.1929
class 0: acc 0.8160919540229885, correct 71/87
class 1: acc 0.6626506024096386, correct 55/83
class 2: acc 0.6705882352941176, correct 57/85
class 3: acc 0.9550561797752809, correct 85/89
class 4: acc 0.9259259259259259, correct 75/81

Val Set, val_loss: 1.1610, val_error: 0.4400, auc: 0.7730
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.135: correct 54/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.5, correct 10/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2151, instance_loss: 0.2134, weighted_loss: 0.2146, label: 1, bag_size: 697
batch 39, loss: 0.0161, instance_loss: 0.0539, weighted_loss: 0.0275, label: 3, bag_size: 316
batch 59, loss: 0.1667, instance_loss: 0.1769, weighted_loss: 0.1698, label: 0, bag_size: 340
batch 79, loss: 0.2727, instance_loss: 0.1448, weighted_loss: 0.2343, label: 3, bag_size: 849
batch 99, loss: 0.3012, instance_loss: 0.3457, weighted_loss: 0.3146, label: 3, bag_size: 697
batch 119, loss: 0.1457, instance_loss: 0.2669, weighted_loss: 0.1821, label: 1, bag_size: 1014
batch 139, loss: 0.3673, instance_loss: 0.4283, weighted_loss: 0.3856, label: 4, bag_size: 297
batch 159, loss: 0.0147, instance_loss: 0.1245, weighted_loss: 0.0476, label: 4, bag_size: 1002
batch 179, loss: 1.6235, instance_loss: 0.4302, weighted_loss: 1.2655, label: 3, bag_size: 697
batch 199, loss: 0.1930, instance_loss: 0.1919, weighted_loss: 0.1927, label: 1, bag_size: 994
batch 219, loss: 0.1716, instance_loss: 0.2827, weighted_loss: 0.2049, label: 1, bag_size: 1239
batch 239, loss: 0.0575, instance_loss: 0.0933, weighted_loss: 0.0682, label: 0, bag_size: 1517
batch 259, loss: 0.9484, instance_loss: 0.5233, weighted_loss: 0.8209, label: 2, bag_size: 1259
batch 279, loss: 2.5666, instance_loss: 0.9056, weighted_loss: 2.0683, label: 1, bag_size: 293
batch 299, loss: 0.0125, instance_loss: 0.0612, weighted_loss: 0.0271, label: 4, bag_size: 636
batch 319, loss: 0.0020, instance_loss: 0.0655, weighted_loss: 0.0211, label: 4, bag_size: 729
batch 339, loss: 0.5427, instance_loss: 0.4450, weighted_loss: 0.5134, label: 2, bag_size: 986
batch 359, loss: 0.6251, instance_loss: 0.4816, weighted_loss: 0.5821, label: 1, bag_size: 1080
batch 379, loss: 0.0264, instance_loss: 0.1303, weighted_loss: 0.0576, label: 0, bag_size: 729
batch 399, loss: 0.0736, instance_loss: 0.1222, weighted_loss: 0.0882, label: 0, bag_size: 570
batch 419, loss: 0.0335, instance_loss: 0.1946, weighted_loss: 0.0818, label: 4, bag_size: 823


class 0 clustering acc 0.9902941176470588: correct 16835/17000
class 1 clustering acc 0.38441176470588234: correct 1307/3400
Epoch: 15, train_loss: 0.4853, train_clustering_loss:  0.3272, train_error: 0.1553
class 0: acc 0.8494623655913979, correct 79/93
class 1: acc 0.6883116883116883, correct 53/77
class 2: acc 0.75, correct 54/72
class 3: acc 0.9310344827586207, correct 81/87
class 4: acc 0.9583333333333334, correct 92/96

Val Set, val_loss: 1.2900, val_error: 0.4200, auc: 0.7765
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.1625: correct 65/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.45, correct 9/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.7561, instance_loss: 0.5390, weighted_loss: 1.3909, label: 1, bag_size: 770
batch 39, loss: 0.7587, instance_loss: 0.5024, weighted_loss: 0.6818, label: 3, bag_size: 1250
batch 59, loss: 0.2063, instance_loss: 0.1189, weighted_loss: 0.1801, label: 3, bag_size: 1559
batch 79, loss: 0.0062, instance_loss: 0.1007, weighted_loss: 0.0346, label: 4, bag_size: 729
batch 99, loss: 0.0896, instance_loss: 0.2343, weighted_loss: 0.1330, label: 0, bag_size: 976
batch 119, loss: 0.2384, instance_loss: 0.3124, weighted_loss: 0.2606, label: 2, bag_size: 1788
batch 139, loss: 0.3024, instance_loss: 0.3393, weighted_loss: 0.3135, label: 2, bag_size: 758
batch 159, loss: 0.0470, instance_loss: 0.0806, weighted_loss: 0.0571, label: 0, bag_size: 1012
batch 179, loss: 0.1088, instance_loss: 0.1920, weighted_loss: 0.1338, label: 0, bag_size: 760
batch 199, loss: 0.2293, instance_loss: 0.3410, weighted_loss: 0.2628, label: 3, bag_size: 343
batch 219, loss: 0.2353, instance_loss: 0.1638, weighted_loss: 0.2139, label: 3, bag_size: 729
batch 239, loss: 0.0161, instance_loss: 0.1306, weighted_loss: 0.0505, label: 4, bag_size: 729
batch 259, loss: 0.1569, instance_loss: 0.0691, weighted_loss: 0.1306, label: 3, bag_size: 556
batch 279, loss: 0.3909, instance_loss: 0.3222, weighted_loss: 0.3703, label: 2, bag_size: 1039
batch 299, loss: 0.3683, instance_loss: 0.2742, weighted_loss: 0.3401, label: 0, bag_size: 1133
batch 319, loss: 0.0037, instance_loss: 0.2726, weighted_loss: 0.0844, label: 4, bag_size: 388
batch 339, loss: 0.5270, instance_loss: 0.3380, weighted_loss: 0.4703, label: 0, bag_size: 1190
batch 359, loss: 0.3003, instance_loss: 0.2780, weighted_loss: 0.2936, label: 0, bag_size: 962
batch 379, loss: 1.4850, instance_loss: 0.7819, weighted_loss: 1.2741, label: 2, bag_size: 1043
batch 399, loss: 0.3806, instance_loss: 0.3698, weighted_loss: 0.3774, label: 2, bag_size: 409
batch 419, loss: 0.2308, instance_loss: 0.1414, weighted_loss: 0.2039, label: 3, bag_size: 729


class 0 clustering acc 0.9892352941176471: correct 16817/17000
class 1 clustering acc 0.33647058823529413: correct 1144/3400
Epoch: 16, train_loss: 0.4714, train_clustering_loss:  0.3414, train_error: 0.1647
class 0: acc 0.9347826086956522, correct 86/92
class 1: acc 0.7701149425287356, correct 67/87
class 2: acc 0.651685393258427, correct 58/89
class 3: acc 0.8955223880597015, correct 60/67
class 4: acc 0.9333333333333333, correct 84/90

Val Set, val_loss: 1.1012, val_error: 0.3400, auc: 0.7786
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.1125: correct 45/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1310, instance_loss: 0.1803, weighted_loss: 0.1458, label: 0, bag_size: 375
batch 39, loss: 0.2649, instance_loss: 0.2667, weighted_loss: 0.2655, label: 0, bag_size: 607
batch 59, loss: 0.3534, instance_loss: 0.3365, weighted_loss: 0.3483, label: 3, bag_size: 849
batch 79, loss: 0.1755, instance_loss: 0.1687, weighted_loss: 0.1735, label: 0, bag_size: 1247
batch 99, loss: 0.1128, instance_loss: 0.2901, weighted_loss: 0.1660, label: 4, bag_size: 297
batch 119, loss: 0.5161, instance_loss: 0.3769, weighted_loss: 0.4743, label: 2, bag_size: 2703
batch 139, loss: 0.1161, instance_loss: 0.7010, weighted_loss: 0.2916, label: 4, bag_size: 511
batch 159, loss: 0.0288, instance_loss: 0.1330, weighted_loss: 0.0600, label: 4, bag_size: 729
batch 179, loss: 0.1188, instance_loss: 0.1481, weighted_loss: 0.1276, label: 1, bag_size: 994
batch 199, loss: 0.2114, instance_loss: 0.2151, weighted_loss: 0.2125, label: 0, bag_size: 962
batch 219, loss: 0.1075, instance_loss: 0.2231, weighted_loss: 0.1422, label: 0, bag_size: 653
batch 239, loss: 0.1478, instance_loss: 0.1874, weighted_loss: 0.1597, label: 0, bag_size: 1061
batch 259, loss: 0.2321, instance_loss: 0.2523, weighted_loss: 0.2382, label: 0, bag_size: 478
batch 279, loss: 0.9165, instance_loss: 0.4639, weighted_loss: 0.7807, label: 1, bag_size: 399
batch 299, loss: 0.1130, instance_loss: 0.1133, weighted_loss: 0.1131, label: 0, bag_size: 921
batch 319, loss: 0.0990, instance_loss: 0.1116, weighted_loss: 0.1028, label: 0, bag_size: 760
batch 339, loss: 0.1890, instance_loss: 0.1975, weighted_loss: 0.1915, label: 3, bag_size: 729
batch 359, loss: 0.2561, instance_loss: 0.3261, weighted_loss: 0.2771, label: 2, bag_size: 347
batch 379, loss: 0.1983, instance_loss: 0.1876, weighted_loss: 0.1951, label: 0, bag_size: 476
batch 399, loss: 0.0904, instance_loss: 0.0834, weighted_loss: 0.0883, label: 3, bag_size: 849
batch 419, loss: 1.2999, instance_loss: 0.7301, weighted_loss: 1.1289, label: 1, bag_size: 1390


class 0 clustering acc 0.9899411764705882: correct 16829/17000
class 1 clustering acc 0.3876470588235294: correct 1318/3400
Epoch: 17, train_loss: 0.4105, train_clustering_loss:  0.3153, train_error: 0.1435
class 0: acc 0.9, correct 72/80
class 1: acc 0.7857142857142857, correct 77/98
class 2: acc 0.6463414634146342, correct 53/82
class 3: acc 0.9775280898876404, correct 87/89
class 4: acc 0.9868421052631579, correct 75/76

Val Set, val_loss: 1.2746, val_error: 0.4200, auc: 0.8098
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.5, correct 10/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0393, instance_loss: 0.0862, weighted_loss: 0.0533, label: 3, bag_size: 729
batch 39, loss: 0.4249, instance_loss: 0.4325, weighted_loss: 0.4272, label: 2, bag_size: 247
batch 59, loss: 0.6931, instance_loss: 0.5742, weighted_loss: 0.6574, label: 2, bag_size: 409
batch 79, loss: 0.1264, instance_loss: 0.1840, weighted_loss: 0.1437, label: 1, bag_size: 828
batch 99, loss: 0.0606, instance_loss: 0.1332, weighted_loss: 0.0823, label: 4, bag_size: 773
batch 119, loss: 0.0803, instance_loss: 0.0759, weighted_loss: 0.0790, label: 3, bag_size: 729
batch 139, loss: 1.5580, instance_loss: 0.7523, weighted_loss: 1.3163, label: 1, bag_size: 293
batch 159, loss: 0.0403, instance_loss: 0.0653, weighted_loss: 0.0478, label: 1, bag_size: 286
batch 179, loss: 0.1125, instance_loss: 0.6800, weighted_loss: 0.2828, label: 4, bag_size: 542
batch 199, loss: 0.3197, instance_loss: 0.2774, weighted_loss: 0.3070, label: 0, bag_size: 1190
batch 219, loss: 0.7831, instance_loss: 0.4351, weighted_loss: 0.6787, label: 2, bag_size: 1306
batch 239, loss: 0.0051, instance_loss: 0.0971, weighted_loss: 0.0327, label: 4, bag_size: 729
batch 259, loss: 0.1080, instance_loss: 0.1642, weighted_loss: 0.1249, label: 1, bag_size: 1191
batch 279, loss: 0.9082, instance_loss: 0.4582, weighted_loss: 0.7732, label: 2, bag_size: 1306
batch 299, loss: 1.7362, instance_loss: 0.8589, weighted_loss: 1.4730, label: 2, bag_size: 1043
batch 319, loss: 0.2742, instance_loss: 0.3237, weighted_loss: 0.2890, label: 2, bag_size: 323
batch 339, loss: 0.0990, instance_loss: 0.3484, weighted_loss: 0.1738, label: 4, bag_size: 297
batch 359, loss: 0.1107, instance_loss: 0.1887, weighted_loss: 0.1341, label: 1, bag_size: 828
batch 379, loss: 0.1840, instance_loss: 0.6945, weighted_loss: 0.3372, label: 4, bag_size: 436
batch 399, loss: 0.0796, instance_loss: 0.1547, weighted_loss: 0.1021, label: 0, bag_size: 1174
batch 419, loss: 0.3337, instance_loss: 0.3201, weighted_loss: 0.3296, label: 2, bag_size: 347


class 0 clustering acc 0.991: correct 16847/17000
class 1 clustering acc 0.37823529411764706: correct 1286/3400
Epoch: 18, train_loss: 0.4423, train_clustering_loss:  0.3299, train_error: 0.1671
class 0: acc 0.8354430379746836, correct 66/79
class 1: acc 0.7108433734939759, correct 59/83
class 2: acc 0.6463414634146342, correct 53/82
class 3: acc 0.9797979797979798, correct 97/99
class 4: acc 0.9634146341463414, correct 79/82

Val Set, val_loss: 1.2509, val_error: 0.3000, auc: 0.7865
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.145: correct 58/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0013, instance_loss: 0.0331, weighted_loss: 0.0109, label: 4, bag_size: 764
batch 39, loss: 0.1159, instance_loss: 0.0835, weighted_loss: 0.1062, label: 3, bag_size: 1172
batch 59, loss: 0.2784, instance_loss: 0.2445, weighted_loss: 0.2682, label: 0, bag_size: 653
batch 79, loss: 0.1583, instance_loss: 0.1831, weighted_loss: 0.1657, label: 1, bag_size: 598
batch 99, loss: 0.0644, instance_loss: 0.3413, weighted_loss: 0.1475, label: 1, bag_size: 696
batch 119, loss: 5.0262, instance_loss: 1.0546, weighted_loss: 3.8347, label: 2, bag_size: 732
batch 139, loss: 0.7225, instance_loss: 0.3808, weighted_loss: 0.6200, label: 1, bag_size: 399
batch 159, loss: 0.1136, instance_loss: 0.1414, weighted_loss: 0.1219, label: 0, bag_size: 1247
batch 179, loss: 0.3963, instance_loss: 0.3358, weighted_loss: 0.3781, label: 2, bag_size: 682
batch 199, loss: 0.0025, instance_loss: 0.1235, weighted_loss: 0.0388, label: 4, bag_size: 1235
batch 219, loss: 0.0256, instance_loss: 0.2029, weighted_loss: 0.0788, label: 1, bag_size: 834
batch 239, loss: 0.0478, instance_loss: 0.0730, weighted_loss: 0.0554, label: 0, bag_size: 933
batch 259, loss: 0.0062, instance_loss: 0.3572, weighted_loss: 0.1115, label: 3, bag_size: 791
batch 279, loss: 0.1181, instance_loss: 0.5111, weighted_loss: 0.2360, label: 3, bag_size: 607
batch 299, loss: 0.0483, instance_loss: 0.3017, weighted_loss: 0.1243, label: 4, bag_size: 754
batch 319, loss: 0.0407, instance_loss: 0.0669, weighted_loss: 0.0486, label: 3, bag_size: 1559
batch 339, loss: 2.1854, instance_loss: 0.6443, weighted_loss: 1.7230, label: 1, bag_size: 1376
batch 359, loss: 0.2125, instance_loss: 0.2611, weighted_loss: 0.2271, label: 2, bag_size: 247
batch 379, loss: 0.1130, instance_loss: 0.3753, weighted_loss: 0.1917, label: 2, bag_size: 948
batch 399, loss: 1.2024, instance_loss: 0.5250, weighted_loss: 0.9992, label: 1, bag_size: 1273
batch 419, loss: 0.9615, instance_loss: 0.7420, weighted_loss: 0.8956, label: 0, bag_size: 818


class 0 clustering acc 0.9907058823529412: correct 16842/17000
class 1 clustering acc 0.3738235294117647: correct 1271/3400
Epoch: 19, train_loss: 0.3906, train_clustering_loss:  0.3205, train_error: 0.1459
class 0: acc 0.8705882352941177, correct 74/85
class 1: acc 0.7037037037037037, correct 57/81
class 2: acc 0.7578947368421053, correct 72/95
class 3: acc 0.9753086419753086, correct 79/81
class 4: acc 0.9759036144578314, correct 81/83

Val Set, val_loss: 1.1657, val_error: 0.3600, auc: 0.8115
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.22: correct 88/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.7, correct 14/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0145, instance_loss: 0.0695, weighted_loss: 0.0310, label: 0, bag_size: 729
batch 39, loss: 0.3478, instance_loss: 0.3506, weighted_loss: 0.3486, label: 2, bag_size: 1039
batch 59, loss: 0.0400, instance_loss: 0.1195, weighted_loss: 0.0638, label: 0, bag_size: 729
batch 79, loss: 0.0038, instance_loss: 0.1163, weighted_loss: 0.0375, label: 4, bag_size: 1235
batch 99, loss: 0.9613, instance_loss: 0.5067, weighted_loss: 0.8249, label: 1, bag_size: 139
batch 119, loss: 0.0521, instance_loss: 0.6277, weighted_loss: 0.2248, label: 4, bag_size: 436
batch 139, loss: 0.3560, instance_loss: 0.2025, weighted_loss: 0.3099, label: 0, bag_size: 731
batch 159, loss: 1.4205, instance_loss: 0.4902, weighted_loss: 1.1414, label: 1, bag_size: 1197
batch 179, loss: 0.0265, instance_loss: 0.1010, weighted_loss: 0.0489, label: 3, bag_size: 1172
batch 199, loss: 0.0307, instance_loss: 0.1126, weighted_loss: 0.0553, label: 0, bag_size: 385
batch 219, loss: 0.1880, instance_loss: 0.5047, weighted_loss: 0.2830, label: 1, bag_size: 102
batch 239, loss: 0.4402, instance_loss: 0.4200, weighted_loss: 0.4341, label: 2, bag_size: 482
batch 259, loss: 1.0759, instance_loss: 0.5318, weighted_loss: 0.9127, label: 2, bag_size: 636
batch 279, loss: 0.8858, instance_loss: 0.4521, weighted_loss: 0.7557, label: 2, bag_size: 204
batch 299, loss: 0.0928, instance_loss: 0.0553, weighted_loss: 0.0815, label: 3, bag_size: 556
batch 319, loss: 0.0160, instance_loss: 0.0475, weighted_loss: 0.0255, label: 0, bag_size: 382
batch 339, loss: 0.4515, instance_loss: 0.3461, weighted_loss: 0.4199, label: 2, bag_size: 252
batch 359, loss: 0.0423, instance_loss: 0.1037, weighted_loss: 0.0607, label: 3, bag_size: 316
batch 379, loss: 0.9213, instance_loss: 0.5200, weighted_loss: 0.8009, label: 3, bag_size: 1380
batch 399, loss: 0.0830, instance_loss: 0.3285, weighted_loss: 0.1567, label: 0, bag_size: 1301
batch 419, loss: 0.0128, instance_loss: 0.1542, weighted_loss: 0.0552, label: 3, bag_size: 1253


class 0 clustering acc 0.9892352941176471: correct 16817/17000
class 1 clustering acc 0.39941176470588236: correct 1358/3400
Epoch: 20, train_loss: 0.4032, train_clustering_loss:  0.3200, train_error: 0.1412
class 0: acc 0.89, correct 89/100
class 1: acc 0.7191011235955056, correct 64/89
class 2: acc 0.7441860465116279, correct 64/86
class 3: acc 0.9868421052631579, correct 75/76
class 4: acc 0.9864864864864865, correct 73/74

Val Set, val_loss: 1.1764, val_error: 0.3000, auc: 0.8000
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.155: correct 62/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4026, instance_loss: 0.3849, weighted_loss: 0.3973, label: 1, bag_size: 470
batch 39, loss: 0.0010, instance_loss: 0.1536, weighted_loss: 0.0468, label: 4, bag_size: 729
batch 59, loss: 0.0909, instance_loss: 0.2084, weighted_loss: 0.1261, label: 0, bag_size: 807
batch 79, loss: 1.7397, instance_loss: 0.5656, weighted_loss: 1.3875, label: 1, bag_size: 308
batch 99, loss: 0.4052, instance_loss: 0.3278, weighted_loss: 0.3820, label: 0, bag_size: 478
batch 119, loss: 0.0602, instance_loss: 0.1186, weighted_loss: 0.0777, label: 0, bag_size: 602
batch 139, loss: 0.1538, instance_loss: 0.4547, weighted_loss: 0.2441, label: 3, bag_size: 630
batch 159, loss: 0.0321, instance_loss: 0.3064, weighted_loss: 0.1144, label: 1, bag_size: 696
batch 179, loss: 0.4562, instance_loss: 0.3704, weighted_loss: 0.4305, label: 2, bag_size: 986
batch 199, loss: 0.7948, instance_loss: 0.5184, weighted_loss: 0.7119, label: 4, bag_size: 1337
batch 219, loss: 0.2129, instance_loss: 0.5147, weighted_loss: 0.3035, label: 4, bag_size: 533
batch 239, loss: 0.0002, instance_loss: 0.0477, weighted_loss: 0.0145, label: 4, bag_size: 729
batch 259, loss: 0.0091, instance_loss: 0.0762, weighted_loss: 0.0292, label: 4, bag_size: 1121
batch 279, loss: 0.1092, instance_loss: 0.1508, weighted_loss: 0.1216, label: 1, bag_size: 697
batch 299, loss: 2.5137, instance_loss: 0.5964, weighted_loss: 1.9385, label: 1, bag_size: 446
batch 319, loss: 0.1382, instance_loss: 0.1930, weighted_loss: 0.1546, label: 0, bag_size: 1046
batch 339, loss: 0.1111, instance_loss: 0.2907, weighted_loss: 0.1650, label: 3, bag_size: 841
batch 359, loss: 0.0018, instance_loss: 0.1714, weighted_loss: 0.0527, label: 4, bag_size: 729
batch 379, loss: 0.3363, instance_loss: 0.3563, weighted_loss: 0.3423, label: 2, bag_size: 1039
batch 399, loss: 1.6655, instance_loss: 0.5172, weighted_loss: 1.3210, label: 1, bag_size: 1376
batch 419, loss: 0.4567, instance_loss: 0.2421, weighted_loss: 0.3923, label: 1, bag_size: 847


class 0 clustering acc 0.9907058823529412: correct 16842/17000
class 1 clustering acc 0.39588235294117646: correct 1346/3400
Epoch: 21, train_loss: 0.3406, train_clustering_loss:  0.3157, train_error: 0.0988
class 0: acc 0.9027777777777778, correct 65/72
class 1: acc 0.84375, correct 81/96
class 2: acc 0.7662337662337663, correct 59/77
class 3: acc 0.9878048780487805, correct 81/82
class 4: acc 0.9897959183673469, correct 97/98

Val Set, val_loss: 1.2432, val_error: 0.3600, auc: 0.7938
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.6, correct 12/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2124, instance_loss: 0.4291, weighted_loss: 0.2774, label: 4, bag_size: 1337
batch 39, loss: 0.0044, instance_loss: 0.0823, weighted_loss: 0.0278, label: 4, bag_size: 729
batch 59, loss: 0.0950, instance_loss: 0.1985, weighted_loss: 0.1260, label: 0, bag_size: 410
batch 79, loss: 0.0130, instance_loss: 0.1668, weighted_loss: 0.0591, label: 0, bag_size: 976
batch 99, loss: 0.2217, instance_loss: 0.3027, weighted_loss: 0.2460, label: 2, bag_size: 470
batch 119, loss: 0.0715, instance_loss: 0.0484, weighted_loss: 0.0646, label: 3, bag_size: 729
batch 139, loss: 0.9435, instance_loss: 0.4664, weighted_loss: 0.8004, label: 0, bag_size: 718
batch 159, loss: 0.0063, instance_loss: 0.0739, weighted_loss: 0.0266, label: 3, bag_size: 729
batch 179, loss: 0.0462, instance_loss: 0.3093, weighted_loss: 0.1251, label: 3, bag_size: 1250
batch 199, loss: 0.0011, instance_loss: 0.1628, weighted_loss: 0.0496, label: 4, bag_size: 729
batch 219, loss: 0.4894, instance_loss: 0.5469, weighted_loss: 0.5066, label: 2, bag_size: 1141
batch 239, loss: 1.2082, instance_loss: 0.6112, weighted_loss: 1.0291, label: 2, bag_size: 1700
batch 259, loss: 0.1020, instance_loss: 0.1146, weighted_loss: 0.1058, label: 3, bag_size: 316
batch 279, loss: 0.0637, instance_loss: 0.0906, weighted_loss: 0.0718, label: 0, bag_size: 552
batch 299, loss: 0.9199, instance_loss: 0.4693, weighted_loss: 0.7847, label: 1, bag_size: 936
batch 319, loss: 0.0360, instance_loss: 0.0371, weighted_loss: 0.0363, label: 3, bag_size: 1172
batch 339, loss: 0.2567, instance_loss: 0.3919, weighted_loss: 0.2972, label: 1, bag_size: 648
batch 359, loss: 0.0701, instance_loss: 0.1418, weighted_loss: 0.0916, label: 1, bag_size: 994
batch 379, loss: 0.1575, instance_loss: 0.2826, weighted_loss: 0.1950, label: 0, bag_size: 1061
batch 399, loss: 0.0856, instance_loss: 0.4851, weighted_loss: 0.2054, label: 1, bag_size: 102
batch 419, loss: 0.9823, instance_loss: 0.3692, weighted_loss: 0.7983, label: 1, bag_size: 968


class 0 clustering acc 0.9904705882352941: correct 16838/17000
class 1 clustering acc 0.4514705882352941: correct 1535/3400
Epoch: 22, train_loss: 0.3491, train_clustering_loss:  0.3028, train_error: 0.1224
class 0: acc 0.9333333333333333, correct 84/90
class 1: acc 0.7435897435897436, correct 58/78
class 2: acc 0.6461538461538462, correct 42/65
class 3: acc 0.9797979797979798, correct 97/99
class 4: acc 0.989247311827957, correct 92/93

Val Set, val_loss: 1.3374, val_error: 0.3600, auc: 0.7901
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.165: correct 66/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1284, instance_loss: 0.4239, weighted_loss: 0.2170, label: 4, bag_size: 663
batch 39, loss: 0.2100, instance_loss: 0.4776, weighted_loss: 0.2903, label: 2, bag_size: 396
batch 59, loss: 0.0324, instance_loss: 0.0870, weighted_loss: 0.0488, label: 3, bag_size: 1177
batch 79, loss: 0.0114, instance_loss: 0.0572, weighted_loss: 0.0251, label: 3, bag_size: 1172
batch 99, loss: 0.0122, instance_loss: 0.1791, weighted_loss: 0.0623, label: 0, bag_size: 729
batch 119, loss: 0.0438, instance_loss: 0.0643, weighted_loss: 0.0500, label: 3, bag_size: 556
batch 139, loss: 0.2250, instance_loss: 0.3709, weighted_loss: 0.2687, label: 2, bag_size: 1128
batch 159, loss: 0.0905, instance_loss: 0.2305, weighted_loss: 0.1325, label: 4, bag_size: 354
batch 179, loss: 0.0906, instance_loss: 0.1263, weighted_loss: 0.1013, label: 0, bag_size: 630
batch 199, loss: 0.2736, instance_loss: 0.6983, weighted_loss: 0.4010, label: 4, bag_size: 542
batch 219, loss: 0.0916, instance_loss: 0.2016, weighted_loss: 0.1246, label: 4, bag_size: 625
batch 239, loss: 0.9112, instance_loss: 0.2909, weighted_loss: 0.7251, label: 0, bag_size: 381
batch 259, loss: 0.2038, instance_loss: 0.2892, weighted_loss: 0.2294, label: 2, bag_size: 202
batch 279, loss: 0.4660, instance_loss: 0.3113, weighted_loss: 0.4196, label: 3, bag_size: 533
batch 299, loss: 0.8830, instance_loss: 0.6614, weighted_loss: 0.8166, label: 1, bag_size: 405
batch 319, loss: 0.9313, instance_loss: 0.7376, weighted_loss: 0.8732, label: 2, bag_size: 295
batch 339, loss: 0.1878, instance_loss: 0.3463, weighted_loss: 0.2353, label: 1, bag_size: 1724
batch 359, loss: 0.1017, instance_loss: 0.1493, weighted_loss: 0.1160, label: 3, bag_size: 729
batch 379, loss: 0.0270, instance_loss: 0.3028, weighted_loss: 0.1097, label: 1, bag_size: 1014
batch 399, loss: 0.0001, instance_loss: 0.0671, weighted_loss: 0.0202, label: 4, bag_size: 729
batch 419, loss: 0.1402, instance_loss: 0.3248, weighted_loss: 0.1956, label: 0, bag_size: 1301


class 0 clustering acc 0.9879411764705882: correct 16795/17000
class 1 clustering acc 0.41558823529411765: correct 1413/3400
Epoch: 23, train_loss: 0.3548, train_clustering_loss:  0.3223, train_error: 0.1200
class 0: acc 0.8902439024390244, correct 73/82
class 1: acc 0.7790697674418605, correct 67/86
class 2: acc 0.7625, correct 61/80
class 3: acc 0.9659090909090909, correct 85/88
class 4: acc 0.9887640449438202, correct 88/89

Val Set, val_loss: 1.2667, val_error: 0.3800, auc: 0.8057
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.215: correct 86/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.65, correct 13/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2396, instance_loss: 0.5668, weighted_loss: 0.3378, label: 3, bag_size: 200
batch 39, loss: 0.2774, instance_loss: 0.4840, weighted_loss: 0.3394, label: 2, bag_size: 725
batch 59, loss: 0.0312, instance_loss: 0.0277, weighted_loss: 0.0302, label: 3, bag_size: 1069
batch 79, loss: 0.6976, instance_loss: 0.5297, weighted_loss: 0.6472, label: 1, bag_size: 319
batch 99, loss: 0.0783, instance_loss: 0.6952, weighted_loss: 0.2634, label: 1, bag_size: 867
batch 119, loss: 0.0172, instance_loss: 0.0910, weighted_loss: 0.0393, label: 0, bag_size: 616
batch 139, loss: 0.0250, instance_loss: 0.0939, weighted_loss: 0.0456, label: 0, bag_size: 1143
batch 159, loss: 0.0123, instance_loss: 0.1305, weighted_loss: 0.0477, label: 4, bag_size: 773
batch 179, loss: 0.0053, instance_loss: 0.0313, weighted_loss: 0.0131, label: 0, bag_size: 360
batch 199, loss: 0.0210, instance_loss: 0.2074, weighted_loss: 0.0769, label: 0, bag_size: 760
batch 219, loss: 0.0622, instance_loss: 0.0685, weighted_loss: 0.0641, label: 3, bag_size: 729
batch 239, loss: 0.2415, instance_loss: 0.3500, weighted_loss: 0.2741, label: 2, bag_size: 1180
batch 259, loss: 0.1698, instance_loss: 0.4093, weighted_loss: 0.2417, label: 2, bag_size: 508
batch 279, loss: 0.3305, instance_loss: 0.8026, weighted_loss: 0.4721, label: 4, bag_size: 542
batch 299, loss: 0.0565, instance_loss: 0.2622, weighted_loss: 0.1182, label: 0, bag_size: 1086
batch 319, loss: 0.3496, instance_loss: 0.1595, weighted_loss: 0.2926, label: 3, bag_size: 1399
batch 339, loss: 0.0009, instance_loss: 0.0354, weighted_loss: 0.0113, label: 4, bag_size: 729
batch 359, loss: 0.0182, instance_loss: 0.0645, weighted_loss: 0.0321, label: 3, bag_size: 729
batch 379, loss: 0.3803, instance_loss: 0.1935, weighted_loss: 0.3243, label: 1, bag_size: 697
batch 399, loss: 0.0646, instance_loss: 0.1025, weighted_loss: 0.0759, label: 3, bag_size: 1177
batch 419, loss: 0.0228, instance_loss: 0.4476, weighted_loss: 0.1503, label: 4, bag_size: 754


class 0 clustering acc 0.9864705882352941: correct 16770/17000
class 1 clustering acc 0.43117647058823527: correct 1466/3400
Epoch: 24, train_loss: 0.2993, train_clustering_loss:  0.3105, train_error: 0.0847
class 0: acc 0.96875, correct 93/96
class 1: acc 0.7671232876712328, correct 56/73
class 2: acc 0.8352941176470589, correct 71/85
class 3: acc 0.9761904761904762, correct 82/84
class 4: acc 1.0, correct 87/87

Val Set, val_loss: 1.3308, val_error: 0.3800, auc: 0.8133
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.65, correct 13/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0050, instance_loss: 0.3783, weighted_loss: 0.1170, label: 4, bag_size: 754
batch 39, loss: 0.1684, instance_loss: 0.4388, weighted_loss: 0.2495, label: 3, bag_size: 630
batch 59, loss: 0.0409, instance_loss: 0.2928, weighted_loss: 0.1164, label: 1, bag_size: 1127
batch 79, loss: 0.0660, instance_loss: 0.1168, weighted_loss: 0.0812, label: 0, bag_size: 432
batch 99, loss: 0.7153, instance_loss: 0.1908, weighted_loss: 0.5579, label: 3, bag_size: 533
batch 119, loss: 0.2338, instance_loss: 0.2238, weighted_loss: 0.2308, label: 1, bag_size: 1325
batch 139, loss: 0.5645, instance_loss: 0.6004, weighted_loss: 0.5753, label: 0, bag_size: 423
batch 159, loss: 0.4467, instance_loss: 0.4530, weighted_loss: 0.4486, label: 2, bag_size: 345
batch 179, loss: 0.0429, instance_loss: 0.2221, weighted_loss: 0.0966, label: 0, bag_size: 756
batch 199, loss: 0.1237, instance_loss: 0.1320, weighted_loss: 0.1262, label: 3, bag_size: 1399
batch 219, loss: 0.1385, instance_loss: 0.4847, weighted_loss: 0.2423, label: 1, bag_size: 487
batch 239, loss: 0.0102, instance_loss: 0.0600, weighted_loss: 0.0251, label: 4, bag_size: 524
batch 259, loss: 0.8243, instance_loss: 0.2807, weighted_loss: 0.6612, label: 3, bag_size: 1019
batch 279, loss: 0.0119, instance_loss: 0.3598, weighted_loss: 0.1163, label: 4, bag_size: 882
batch 299, loss: 0.0023, instance_loss: 0.1303, weighted_loss: 0.0407, label: 3, bag_size: 729
batch 319, loss: 0.0201, instance_loss: 0.0906, weighted_loss: 0.0412, label: 3, bag_size: 729
batch 339, loss: 1.5746, instance_loss: 0.3873, weighted_loss: 1.2184, label: 1, bag_size: 1646
batch 359, loss: 0.0742, instance_loss: 0.3094, weighted_loss: 0.1448, label: 2, bag_size: 1058
batch 379, loss: 0.0099, instance_loss: 0.0888, weighted_loss: 0.0336, label: 3, bag_size: 729
batch 399, loss: 0.1069, instance_loss: 0.1129, weighted_loss: 0.1087, label: 3, bag_size: 952
batch 419, loss: 0.0092, instance_loss: 0.0848, weighted_loss: 0.0319, label: 3, bag_size: 305


class 0 clustering acc 0.9884117647058823: correct 16803/17000
class 1 clustering acc 0.41205882352941176: correct 1401/3400
Epoch: 25, train_loss: 0.3409, train_clustering_loss:  0.3107, train_error: 0.1129
class 0: acc 0.9310344827586207, correct 81/87
class 1: acc 0.8, correct 68/85
class 2: acc 0.7821782178217822, correct 79/101
class 3: acc 0.9880952380952381, correct 83/84
class 4: acc 0.9705882352941176, correct 66/68

Val Set, val_loss: 1.3225, val_error: 0.3400, auc: 0.7762
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.175: correct 70/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.5462, instance_loss: 0.4765, weighted_loss: 0.5253, label: 2, bag_size: 345
batch 39, loss: 0.0578, instance_loss: 0.0526, weighted_loss: 0.0562, label: 3, bag_size: 1559
batch 59, loss: 0.4273, instance_loss: 0.8909, weighted_loss: 0.5663, label: 3, bag_size: 211
batch 79, loss: 0.5043, instance_loss: 0.3534, weighted_loss: 0.4590, label: 1, bag_size: 869
batch 99, loss: 0.0146, instance_loss: 0.1056, weighted_loss: 0.0419, label: 3, bag_size: 952
batch 119, loss: 0.2687, instance_loss: 0.3232, weighted_loss: 0.2850, label: 2, bag_size: 471
batch 139, loss: 0.3655, instance_loss: 0.3847, weighted_loss: 0.3713, label: 2, bag_size: 278
batch 159, loss: 0.0097, instance_loss: 0.3670, weighted_loss: 0.1169, label: 3, bag_size: 791
batch 179, loss: 1.8078, instance_loss: 0.5603, weighted_loss: 1.4335, label: 2, bag_size: 629
batch 199, loss: 0.0021, instance_loss: 0.0292, weighted_loss: 0.0103, label: 0, bag_size: 898
batch 219, loss: 0.0008, instance_loss: 0.0388, weighted_loss: 0.0122, label: 4, bag_size: 729
batch 239, loss: 0.0245, instance_loss: 0.1340, weighted_loss: 0.0573, label: 3, bag_size: 1069
batch 259, loss: 1.4045, instance_loss: 0.6524, weighted_loss: 1.1789, label: 1, bag_size: 875
batch 279, loss: 0.2369, instance_loss: 0.2552, weighted_loss: 0.2424, label: 2, bag_size: 846
batch 299, loss: 1.1377, instance_loss: 0.8046, weighted_loss: 1.0378, label: 1, bag_size: 1409
batch 319, loss: 1.5998, instance_loss: 0.3771, weighted_loss: 1.2330, label: 2, bag_size: 684
batch 339, loss: 0.0666, instance_loss: 0.0732, weighted_loss: 0.0686, label: 3, bag_size: 556
batch 359, loss: 0.0578, instance_loss: 0.0408, weighted_loss: 0.0527, label: 3, bag_size: 1069
batch 379, loss: 0.0349, instance_loss: 0.3007, weighted_loss: 0.1146, label: 3, bag_size: 1253
batch 399, loss: 1.6267, instance_loss: 0.5574, weighted_loss: 1.3059, label: 1, bag_size: 308
batch 419, loss: 0.2236, instance_loss: 0.4674, weighted_loss: 0.2967, label: 3, bag_size: 630


class 0 clustering acc 0.9882352941176471: correct 16800/17000
class 1 clustering acc 0.4147058823529412: correct 1410/3400
Epoch: 26, train_loss: 0.3288, train_clustering_loss:  0.3113, train_error: 0.1200
class 0: acc 0.9634146341463414, correct 79/82
class 1: acc 0.6323529411764706, correct 43/68
class 2: acc 0.7529411764705882, correct 64/85
class 3: acc 0.9805825242718447, correct 101/103
class 4: acc 1.0, correct 87/87

Val Set, val_loss: 1.3613, val_error: 0.4200, auc: 0.7701
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.1825: correct 73/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.55, correct 11/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0207, instance_loss: 0.0653, weighted_loss: 0.0341, label: 3, bag_size: 729
batch 39, loss: 0.0773, instance_loss: 0.2646, weighted_loss: 0.1335, label: 1, bag_size: 944
batch 59, loss: 0.0037, instance_loss: 0.0371, weighted_loss: 0.0137, label: 0, bag_size: 616
batch 79, loss: 0.0177, instance_loss: 0.0985, weighted_loss: 0.0419, label: 0, bag_size: 1135
batch 99, loss: 0.1675, instance_loss: 0.3770, weighted_loss: 0.2303, label: 1, bag_size: 754
batch 119, loss: 0.8799, instance_loss: 0.6050, weighted_loss: 0.7974, label: 1, bag_size: 1080
batch 139, loss: 1.4468, instance_loss: 0.6766, weighted_loss: 1.2157, label: 1, bag_size: 936
batch 159, loss: 1.4193, instance_loss: 0.5378, weighted_loss: 1.1549, label: 1, bag_size: 861
batch 179, loss: 0.5314, instance_loss: 0.6829, weighted_loss: 0.5768, label: 1, bag_size: 1390
batch 199, loss: 0.2358, instance_loss: 0.6678, weighted_loss: 0.3654, label: 3, bag_size: 1380
batch 219, loss: 0.0064, instance_loss: 0.3599, weighted_loss: 0.1125, label: 3, bag_size: 791
batch 239, loss: 0.4598, instance_loss: 0.2557, weighted_loss: 0.3985, label: 2, bag_size: 846
batch 259, loss: 0.8644, instance_loss: 0.1774, weighted_loss: 0.6583, label: 0, bag_size: 630
batch 279, loss: 1.2364, instance_loss: 0.4412, weighted_loss: 0.9978, label: 3, bag_size: 305
batch 299, loss: 0.4364, instance_loss: 0.6336, weighted_loss: 0.4955, label: 2, bag_size: 247
batch 319, loss: 0.0142, instance_loss: 0.1271, weighted_loss: 0.0481, label: 0, bag_size: 729
batch 339, loss: 0.0647, instance_loss: 0.0334, weighted_loss: 0.0553, label: 3, bag_size: 556
batch 359, loss: 0.0765, instance_loss: 0.3715, weighted_loss: 0.1650, label: 0, bag_size: 729
batch 379, loss: 0.5628, instance_loss: 0.4259, weighted_loss: 0.5217, label: 1, bag_size: 1646
batch 399, loss: 0.2977, instance_loss: 0.4367, weighted_loss: 0.3394, label: 3, bag_size: 317
batch 419, loss: 0.8215, instance_loss: 0.4900, weighted_loss: 0.7221, label: 2, bag_size: 883


class 0 clustering acc 0.9898823529411764: correct 16828/17000
class 1 clustering acc 0.4061764705882353: correct 1381/3400
Epoch: 27, train_loss: 0.2806, train_clustering_loss:  0.3140, train_error: 0.1012
class 0: acc 0.8918918918918919, correct 66/74
class 1: acc 0.8279569892473119, correct 77/93
class 2: acc 0.7926829268292683, correct 65/82
class 3: acc 0.978494623655914, correct 91/93
class 4: acc 1.0, correct 83/83

Val Set, val_loss: 1.3910, val_error: 0.3200, auc: 0.7531
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.1975: correct 79/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0019, instance_loss: 0.1671, weighted_loss: 0.0515, label: 4, bag_size: 388
batch 39, loss: 0.0820, instance_loss: 0.3608, weighted_loss: 0.1657, label: 1, bag_size: 818
batch 59, loss: 0.0078, instance_loss: 0.0800, weighted_loss: 0.0295, label: 3, bag_size: 952
batch 79, loss: 0.0222, instance_loss: 0.0922, weighted_loss: 0.0432, label: 1, bag_size: 636
batch 99, loss: 0.0356, instance_loss: 0.0591, weighted_loss: 0.0427, label: 3, bag_size: 729
batch 119, loss: 1.9036, instance_loss: 0.4933, weighted_loss: 1.4805, label: 1, bag_size: 1197
batch 139, loss: 0.0344, instance_loss: 0.5766, weighted_loss: 0.1970, label: 4, bag_size: 511
batch 159, loss: 0.0492, instance_loss: 0.5943, weighted_loss: 0.2127, label: 4, bag_size: 511
batch 179, loss: 0.1507, instance_loss: 0.1513, weighted_loss: 0.1509, label: 3, bag_size: 1177
batch 199, loss: 0.0134, instance_loss: 0.1259, weighted_loss: 0.0472, label: 3, bag_size: 729
batch 219, loss: 0.0093, instance_loss: 0.2428, weighted_loss: 0.0794, label: 4, bag_size: 656
batch 239, loss: 0.0264, instance_loss: 0.3141, weighted_loss: 0.1127, label: 2, bag_size: 396
batch 259, loss: 0.0747, instance_loss: 0.3019, weighted_loss: 0.1429, label: 4, bag_size: 656
batch 279, loss: 2.1359, instance_loss: 0.6141, weighted_loss: 1.6794, label: 1, bag_size: 1376
batch 299, loss: 0.7050, instance_loss: 0.4886, weighted_loss: 0.6401, label: 2, bag_size: 883
batch 319, loss: 0.0011, instance_loss: 0.2618, weighted_loss: 0.0793, label: 1, bag_size: 1127
batch 339, loss: 0.0996, instance_loss: 0.6435, weighted_loss: 0.2628, label: 4, bag_size: 436
batch 359, loss: 0.0951, instance_loss: 0.2431, weighted_loss: 0.1395, label: 0, bag_size: 1190
batch 379, loss: 0.9689, instance_loss: 0.3505, weighted_loss: 0.7833, label: 1, bag_size: 533
batch 399, loss: 0.2107, instance_loss: 0.1697, weighted_loss: 0.1984, label: 0, bag_size: 962
batch 419, loss: 0.0000, instance_loss: 0.0432, weighted_loss: 0.0130, label: 4, bag_size: 729


class 0 clustering acc 0.9888823529411764: correct 16811/17000
class 1 clustering acc 0.41558823529411765: correct 1413/3400
Epoch: 28, train_loss: 0.2868, train_clustering_loss:  0.3116, train_error: 0.0941
class 0: acc 0.9659090909090909, correct 85/88
class 1: acc 0.7976190476190477, correct 67/84
class 2: acc 0.7682926829268293, correct 63/82
class 3: acc 0.9861111111111112, correct 71/72
class 4: acc 1.0, correct 99/99

Val Set, val_loss: 1.3713, val_error: 0.3000, auc: 0.7788
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0245, instance_loss: 0.5600, weighted_loss: 0.1852, label: 4, bag_size: 436
batch 39, loss: 0.0378, instance_loss: 0.0982, weighted_loss: 0.0560, label: 3, bag_size: 316
batch 59, loss: 0.0037, instance_loss: 0.1157, weighted_loss: 0.0373, label: 4, bag_size: 1235
batch 79, loss: 0.6320, instance_loss: 0.3815, weighted_loss: 0.5568, label: 2, bag_size: 248
batch 99, loss: 0.0227, instance_loss: 0.0573, weighted_loss: 0.0331, label: 3, bag_size: 1399
batch 119, loss: 0.1181, instance_loss: 0.1869, weighted_loss: 0.1387, label: 0, bag_size: 962
batch 139, loss: 0.2930, instance_loss: 0.2954, weighted_loss: 0.2937, label: 2, bag_size: 470
batch 159, loss: 0.0056, instance_loss: 0.0792, weighted_loss: 0.0277, label: 0, bag_size: 1466
batch 179, loss: 0.9299, instance_loss: 0.8885, weighted_loss: 0.9175, label: 1, bag_size: 1390
batch 199, loss: 0.9953, instance_loss: 0.6613, weighted_loss: 0.8951, label: 1, bag_size: 487
batch 219, loss: 1.0047, instance_loss: 0.8320, weighted_loss: 0.9529, label: 0, bag_size: 818
batch 239, loss: 0.0182, instance_loss: 0.0284, weighted_loss: 0.0212, label: 3, bag_size: 556
batch 259, loss: 0.7484, instance_loss: 0.6102, weighted_loss: 0.7070, label: 1, bag_size: 657
batch 279, loss: 0.1906, instance_loss: 0.1787, weighted_loss: 0.1870, label: 1, bag_size: 474
batch 299, loss: 1.0542, instance_loss: 0.3487, weighted_loss: 0.8425, label: 4, bag_size: 1357
batch 319, loss: 0.0152, instance_loss: 0.3696, weighted_loss: 0.1215, label: 4, bag_size: 754
batch 339, loss: 0.1243, instance_loss: 0.1191, weighted_loss: 0.1227, label: 1, bag_size: 1191
batch 359, loss: 0.1047, instance_loss: 0.2243, weighted_loss: 0.1406, label: 2, bag_size: 1569
batch 379, loss: 0.0177, instance_loss: 0.0487, weighted_loss: 0.0270, label: 1, bag_size: 937
batch 399, loss: 0.3755, instance_loss: 0.3206, weighted_loss: 0.3590, label: 2, bag_size: 2703
batch 419, loss: 0.0497, instance_loss: 0.4838, weighted_loss: 0.1800, label: 4, bag_size: 1337


class 0 clustering acc 0.9877058823529412: correct 16791/17000
class 1 clustering acc 0.44382352941176473: correct 1509/3400
Epoch: 29, train_loss: 0.2815, train_clustering_loss:  0.3058, train_error: 0.1035
class 0: acc 0.9036144578313253, correct 75/83
class 1: acc 0.8395061728395061, correct 68/81
class 2: acc 0.7789473684210526, correct 74/95
class 3: acc 0.9893617021276596, correct 93/94
class 4: acc 0.9861111111111112, correct 71/72

Val Set, val_loss: 1.4218, val_error: 0.3000, auc: 0.7810
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.2225: correct 89/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.85, correct 17/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.9342, instance_loss: 0.6360, weighted_loss: 0.8447, label: 1, bag_size: 1255
batch 39, loss: 0.1302, instance_loss: 0.4190, weighted_loss: 0.2169, label: 4, bag_size: 754
batch 59, loss: 0.1156, instance_loss: 0.2663, weighted_loss: 0.1608, label: 0, bag_size: 756
batch 79, loss: 0.4751, instance_loss: 0.4103, weighted_loss: 0.4557, label: 2, bag_size: 307
batch 99, loss: 0.0540, instance_loss: 0.1374, weighted_loss: 0.0790, label: 1, bag_size: 1191
batch 119, loss: 0.0076, instance_loss: 0.0624, weighted_loss: 0.0241, label: 1, bag_size: 369
batch 139, loss: 0.2110, instance_loss: 0.3291, weighted_loss: 0.2464, label: 2, bag_size: 1533
batch 159, loss: 0.0001, instance_loss: 0.0615, weighted_loss: 0.0185, label: 4, bag_size: 729
batch 179, loss: 0.0051, instance_loss: 0.0401, weighted_loss: 0.0156, label: 0, bag_size: 360
batch 199, loss: 0.0979, instance_loss: 0.2176, weighted_loss: 0.1338, label: 0, bag_size: 1061
batch 219, loss: 0.0189, instance_loss: 0.0887, weighted_loss: 0.0399, label: 3, bag_size: 1399
batch 239, loss: 0.0334, instance_loss: 0.4731, weighted_loss: 0.1653, label: 4, bag_size: 1337
batch 259, loss: 0.7662, instance_loss: 0.8011, weighted_loss: 0.7767, label: 1, bag_size: 778
batch 279, loss: 1.6136, instance_loss: 0.7784, weighted_loss: 1.3631, label: 1, bag_size: 293
batch 299, loss: 0.0342, instance_loss: 0.3324, weighted_loss: 0.1236, label: 4, bag_size: 625
batch 319, loss: 0.3696, instance_loss: 0.4328, weighted_loss: 0.3885, label: 2, bag_size: 237
batch 339, loss: 0.0001, instance_loss: 0.0419, weighted_loss: 0.0127, label: 4, bag_size: 729
batch 359, loss: 0.0176, instance_loss: 0.0973, weighted_loss: 0.0415, label: 3, bag_size: 952
batch 379, loss: 0.0060, instance_loss: 0.0548, weighted_loss: 0.0206, label: 3, bag_size: 1172
batch 399, loss: 0.0068, instance_loss: 0.0703, weighted_loss: 0.0259, label: 3, bag_size: 1291
batch 419, loss: 0.0921, instance_loss: 0.3373, weighted_loss: 0.1657, label: 2, bag_size: 913


class 0 clustering acc 0.9898235294117647: correct 16827/17000
class 1 clustering acc 0.43058823529411766: correct 1464/3400
Epoch: 30, train_loss: 0.2693, train_clustering_loss:  0.3065, train_error: 0.1035
class 0: acc 0.9294117647058824, correct 79/85
class 1: acc 0.7804878048780488, correct 64/82
class 2: acc 0.8191489361702128, correct 77/94
class 3: acc 0.9620253164556962, correct 76/79
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.4102, val_error: 0.4000, auc: 0.8000
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.26: correct 104/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.65, correct 13/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0002, instance_loss: 0.0722, weighted_loss: 0.0218, label: 4, bag_size: 729
batch 39, loss: 0.0748, instance_loss: 0.1741, weighted_loss: 0.1046, label: 1, bag_size: 903
batch 59, loss: 0.0016, instance_loss: 0.0498, weighted_loss: 0.0160, label: 3, bag_size: 729
batch 79, loss: 0.0908, instance_loss: 0.2047, weighted_loss: 0.1250, label: 1, bag_size: 474
batch 99, loss: 0.0102, instance_loss: 0.2430, weighted_loss: 0.0800, label: 1, bag_size: 696
batch 119, loss: 0.0028, instance_loss: 0.4498, weighted_loss: 0.1369, label: 4, bag_size: 974
batch 139, loss: 0.4312, instance_loss: 0.4557, weighted_loss: 0.4386, label: 3, bag_size: 305
batch 159, loss: 0.2771, instance_loss: 0.2152, weighted_loss: 0.2585, label: 3, bag_size: 533
batch 179, loss: 0.0081, instance_loss: 0.1460, weighted_loss: 0.0495, label: 0, bag_size: 976
batch 199, loss: 0.4928, instance_loss: 0.4367, weighted_loss: 0.4760, label: 2, bag_size: 806
batch 219, loss: 0.0149, instance_loss: 0.0499, weighted_loss: 0.0254, label: 3, bag_size: 729
batch 239, loss: 1.8409, instance_loss: 0.6205, weighted_loss: 1.4748, label: 2, bag_size: 948
batch 259, loss: 0.0084, instance_loss: 0.0572, weighted_loss: 0.0230, label: 0, bag_size: 616
batch 279, loss: 0.1090, instance_loss: 0.4845, weighted_loss: 0.2216, label: 4, bag_size: 1337
batch 299, loss: 0.0324, instance_loss: 0.2835, weighted_loss: 0.1077, label: 4, bag_size: 663
batch 319, loss: 0.1608, instance_loss: 0.5011, weighted_loss: 0.2629, label: 3, bag_size: 630
batch 339, loss: 0.6466, instance_loss: 0.3221, weighted_loss: 0.5492, label: 1, bag_size: 682
batch 359, loss: 0.0062, instance_loss: 0.1016, weighted_loss: 0.0348, label: 0, bag_size: 518
batch 379, loss: 0.5685, instance_loss: 0.3349, weighted_loss: 0.4984, label: 1, bag_size: 377
batch 399, loss: 0.0062, instance_loss: 0.0335, weighted_loss: 0.0144, label: 1, bag_size: 937
batch 419, loss: 0.0081, instance_loss: 0.0434, weighted_loss: 0.0187, label: 1, bag_size: 286


class 0 clustering acc 0.9869411764705882: correct 16778/17000
class 1 clustering acc 0.4888235294117647: correct 1662/3400
Epoch: 31, train_loss: 0.2667, train_clustering_loss:  0.2909, train_error: 0.0965
class 0: acc 0.9404761904761905, correct 79/84
class 1: acc 0.8072289156626506, correct 67/83
class 2: acc 0.7391304347826086, correct 51/69
class 3: acc 1.0, correct 83/83
class 4: acc 0.9811320754716981, correct 104/106

Val Set, val_loss: 1.5632, val_error: 0.4000, auc: 0.8207
class 0 clustering acc 0.967: correct 1934/2000
class 1 clustering acc 0.2525: correct 101/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.5, correct 10/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0075, instance_loss: 0.1227, weighted_loss: 0.0421, label: 3, bag_size: 841
batch 39, loss: 0.5996, instance_loss: 0.5187, weighted_loss: 0.5753, label: 1, bag_size: 657
batch 59, loss: 0.1051, instance_loss: 0.0631, weighted_loss: 0.0925, label: 3, bag_size: 1177
batch 79, loss: 0.0010, instance_loss: 0.0360, weighted_loss: 0.0115, label: 4, bag_size: 729
batch 99, loss: 0.7215, instance_loss: 0.3372, weighted_loss: 0.6062, label: 1, bag_size: 533
batch 119, loss: 0.1393, instance_loss: 0.5561, weighted_loss: 0.2644, label: 1, bag_size: 487
batch 139, loss: 0.0088, instance_loss: 0.1457, weighted_loss: 0.0499, label: 0, bag_size: 729
batch 159, loss: 0.0077, instance_loss: 0.0768, weighted_loss: 0.0284, label: 3, bag_size: 729
batch 179, loss: 0.0119, instance_loss: 0.2649, weighted_loss: 0.0878, label: 3, bag_size: 1253
batch 199, loss: 0.0089, instance_loss: 0.0460, weighted_loss: 0.0201, label: 1, bag_size: 369
batch 219, loss: 0.5291, instance_loss: 0.2916, weighted_loss: 0.4579, label: 2, bag_size: 470
batch 239, loss: 0.6938, instance_loss: 0.1640, weighted_loss: 0.5348, label: 1, bag_size: 288
batch 259, loss: 0.0321, instance_loss: 0.0907, weighted_loss: 0.0497, label: 0, bag_size: 246
batch 279, loss: 0.0422, instance_loss: 0.2785, weighted_loss: 0.1131, label: 2, bag_size: 2826
batch 299, loss: 0.0036, instance_loss: 0.2582, weighted_loss: 0.0800, label: 4, bag_size: 1235
batch 319, loss: 0.0170, instance_loss: 0.0450, weighted_loss: 0.0254, label: 1, bag_size: 937
batch 339, loss: 0.0851, instance_loss: 0.5364, weighted_loss: 0.2205, label: 2, bag_size: 750
batch 359, loss: 0.0716, instance_loss: 0.5620, weighted_loss: 0.2187, label: 1, bag_size: 442
batch 379, loss: 0.0943, instance_loss: 0.3564, weighted_loss: 0.1729, label: 2, bag_size: 1348
batch 399, loss: 0.0427, instance_loss: 0.2802, weighted_loss: 0.1140, label: 4, bag_size: 625
batch 419, loss: 2.8749, instance_loss: 0.7078, weighted_loss: 2.2248, label: 0, bag_size: 760


class 0 clustering acc 0.9890588235294118: correct 16814/17000
class 1 clustering acc 0.4491176470588235: correct 1527/3400
Epoch: 32, train_loss: 0.3197, train_clustering_loss:  0.3011, train_error: 0.1012
class 0: acc 0.9425287356321839, correct 82/87
class 1: acc 0.7848101265822784, correct 62/79
class 2: acc 0.7738095238095238, correct 65/84
class 3: acc 0.9895833333333334, correct 95/96
class 4: acc 0.9873417721518988, correct 78/79

Val Set, val_loss: 1.4043, val_error: 0.3600, auc: 0.7886
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.1775: correct 71/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.9, correct 18/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0495, instance_loss: 0.5347, weighted_loss: 0.1951, label: 3, bag_size: 630
batch 39, loss: 0.0156, instance_loss: 0.2357, weighted_loss: 0.0816, label: 4, bag_size: 754
batch 59, loss: 0.0804, instance_loss: 0.2649, weighted_loss: 0.1357, label: 0, bag_size: 524
batch 79, loss: 0.0168, instance_loss: 0.2290, weighted_loss: 0.0805, label: 1, bag_size: 614
batch 99, loss: 0.0006, instance_loss: 0.0107, weighted_loss: 0.0036, label: 4, bag_size: 764
batch 119, loss: 0.0794, instance_loss: 0.1250, weighted_loss: 0.0930, label: 0, bag_size: 962
batch 139, loss: 0.3699, instance_loss: 0.8203, weighted_loss: 0.5051, label: 3, bag_size: 211
batch 159, loss: 0.0100, instance_loss: 0.4641, weighted_loss: 0.1463, label: 3, bag_size: 706
batch 179, loss: 0.2730, instance_loss: 0.3946, weighted_loss: 0.3095, label: 0, bag_size: 413
batch 199, loss: 1.9221, instance_loss: 0.5604, weighted_loss: 1.5136, label: 2, bag_size: 324
batch 219, loss: 0.2721, instance_loss: 0.1551, weighted_loss: 0.2370, label: 3, bag_size: 1019
batch 239, loss: 0.0523, instance_loss: 0.2121, weighted_loss: 0.1003, label: 1, bag_size: 828
batch 259, loss: 0.0590, instance_loss: 0.1767, weighted_loss: 0.0943, label: 0, bag_size: 1086
batch 279, loss: 0.1412, instance_loss: 0.3773, weighted_loss: 0.2120, label: 3, bag_size: 230
batch 299, loss: 0.0098, instance_loss: 0.3973, weighted_loss: 0.1260, label: 4, bag_size: 1331
batch 319, loss: 0.0095, instance_loss: 0.2399, weighted_loss: 0.0786, label: 4, bag_size: 826
batch 339, loss: 0.0063, instance_loss: 0.0946, weighted_loss: 0.0328, label: 3, bag_size: 729
batch 359, loss: 0.0902, instance_loss: 0.2101, weighted_loss: 0.1262, label: 1, bag_size: 1426
batch 379, loss: 1.0900, instance_loss: 0.3414, weighted_loss: 0.8654, label: 4, bag_size: 663
batch 399, loss: 0.0753, instance_loss: 0.1545, weighted_loss: 0.0990, label: 0, bag_size: 476
batch 419, loss: 0.1819, instance_loss: 0.2596, weighted_loss: 0.2052, label: 0, bag_size: 478


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.46147058823529413: correct 1569/3400
Epoch: 33, train_loss: 0.2230, train_clustering_loss:  0.2898, train_error: 0.0729
class 0: acc 0.9473684210526315, correct 90/95
class 1: acc 0.8767123287671232, correct 64/73
class 2: acc 0.7974683544303798, correct 63/79
class 3: acc 1.0, correct 75/75
class 4: acc 0.9902912621359223, correct 102/103

Val Set, val_loss: 1.4730, val_error: 0.3200, auc: 0.7894
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0081, instance_loss: 0.0321, weighted_loss: 0.0153, label: 3, bag_size: 729
batch 39, loss: 0.1150, instance_loss: 0.2957, weighted_loss: 0.1692, label: 2, bag_size: 655
batch 59, loss: 0.8838, instance_loss: 0.4886, weighted_loss: 0.7653, label: 2, bag_size: 323
batch 79, loss: 0.0151, instance_loss: 0.0558, weighted_loss: 0.0273, label: 3, bag_size: 1172
batch 99, loss: 0.7617, instance_loss: 0.5477, weighted_loss: 0.6975, label: 2, bag_size: 345
batch 119, loss: 0.0230, instance_loss: 0.0718, weighted_loss: 0.0376, label: 3, bag_size: 1559
batch 139, loss: 0.4679, instance_loss: 0.4102, weighted_loss: 0.4506, label: 0, bag_size: 542
batch 159, loss: 0.0406, instance_loss: 0.1509, weighted_loss: 0.0737, label: 1, bag_size: 858
batch 179, loss: 0.0047, instance_loss: 0.0422, weighted_loss: 0.0160, label: 3, bag_size: 729
batch 199, loss: 0.0361, instance_loss: 0.5779, weighted_loss: 0.1987, label: 4, bag_size: 436
batch 219, loss: 0.2315, instance_loss: 0.4205, weighted_loss: 0.2882, label: 0, bag_size: 1034
batch 239, loss: 0.2593, instance_loss: 0.3257, weighted_loss: 0.2792, label: 1, bag_size: 754
batch 259, loss: 0.0844, instance_loss: 0.2007, weighted_loss: 0.1193, label: 1, bag_size: 1402
batch 279, loss: 0.0406, instance_loss: 0.0502, weighted_loss: 0.0435, label: 3, bag_size: 1399
batch 299, loss: 0.1568, instance_loss: 0.2147, weighted_loss: 0.1742, label: 1, bag_size: 828
batch 319, loss: 0.0021, instance_loss: 0.0181, weighted_loss: 0.0069, label: 3, bag_size: 1069
batch 339, loss: 0.0002, instance_loss: 0.1012, weighted_loss: 0.0305, label: 4, bag_size: 729
batch 359, loss: 0.1818, instance_loss: 0.4779, weighted_loss: 0.2707, label: 2, bag_size: 967
batch 379, loss: 0.1872, instance_loss: 0.4592, weighted_loss: 0.2688, label: 2, bag_size: 1197
batch 399, loss: 0.0285, instance_loss: 0.1995, weighted_loss: 0.0798, label: 0, bag_size: 729
batch 419, loss: 0.0199, instance_loss: 0.0544, weighted_loss: 0.0303, label: 3, bag_size: 729


class 0 clustering acc 0.9872941176470589: correct 16784/17000
class 1 clustering acc 0.4214705882352941: correct 1433/3400
Epoch: 34, train_loss: 0.3104, train_clustering_loss:  0.3134, train_error: 0.1035
class 0: acc 0.9574468085106383, correct 90/94
class 1: acc 0.8315789473684211, correct 79/95
class 2: acc 0.7297297297297297, correct 54/74
class 3: acc 0.9764705882352941, correct 83/85
class 4: acc 0.974025974025974, correct 75/77

Val Set, val_loss: 1.4325, val_error: 0.4000, auc: 0.7962
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.2475: correct 99/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.6, correct 12/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0088, instance_loss: 0.0450, weighted_loss: 0.0197, label: 3, bag_size: 729
batch 39, loss: 0.0094, instance_loss: 0.0301, weighted_loss: 0.0156, label: 3, bag_size: 729
batch 59, loss: 0.6404, instance_loss: 0.5177, weighted_loss: 0.6036, label: 2, bag_size: 384
batch 79, loss: 0.0410, instance_loss: 0.1828, weighted_loss: 0.0835, label: 0, bag_size: 729
batch 99, loss: 0.2627, instance_loss: 0.3137, weighted_loss: 0.2780, label: 2, bag_size: 567
batch 119, loss: 0.2126, instance_loss: 0.1950, weighted_loss: 0.2074, label: 1, bag_size: 598
batch 139, loss: 0.0568, instance_loss: 0.2178, weighted_loss: 0.1051, label: 2, bag_size: 471
batch 159, loss: 1.0037, instance_loss: 0.4232, weighted_loss: 0.8295, label: 1, bag_size: 377
batch 179, loss: 0.0985, instance_loss: 0.3779, weighted_loss: 0.1823, label: 2, bag_size: 748
batch 199, loss: 0.0377, instance_loss: 0.0729, weighted_loss: 0.0483, label: 3, bag_size: 1559
batch 219, loss: 0.0016, instance_loss: 0.1788, weighted_loss: 0.0547, label: 4, bag_size: 729
batch 239, loss: 0.1990, instance_loss: 0.6318, weighted_loss: 0.3288, label: 0, bag_size: 818
batch 259, loss: 0.2476, instance_loss: 0.4323, weighted_loss: 0.3030, label: 2, bag_size: 1232
batch 279, loss: 0.1461, instance_loss: 0.2085, weighted_loss: 0.1648, label: 1, bag_size: 598
batch 299, loss: 0.0258, instance_loss: 0.0803, weighted_loss: 0.0421, label: 3, bag_size: 729
batch 319, loss: 0.0050, instance_loss: 0.1478, weighted_loss: 0.0479, label: 0, bag_size: 729
batch 339, loss: 0.0071, instance_loss: 0.0398, weighted_loss: 0.0169, label: 0, bag_size: 616
batch 359, loss: 0.0343, instance_loss: 0.3875, weighted_loss: 0.1402, label: 4, bag_size: 663
batch 379, loss: 0.6098, instance_loss: 0.3868, weighted_loss: 0.5429, label: 1, bag_size: 1096
batch 399, loss: 0.1007, instance_loss: 0.3910, weighted_loss: 0.1878, label: 3, bag_size: 305
batch 419, loss: 0.0097, instance_loss: 0.0626, weighted_loss: 0.0256, label: 0, bag_size: 921


class 0 clustering acc 0.9885882352941177: correct 16806/17000
class 1 clustering acc 0.4576470588235294: correct 1556/3400
Epoch: 35, train_loss: 0.2562, train_clustering_loss:  0.2954, train_error: 0.0800
class 0: acc 0.9545454545454546, correct 84/88
class 1: acc 0.7974683544303798, correct 63/79
class 2: acc 0.8604651162790697, correct 74/86
class 3: acc 0.9885057471264368, correct 86/87
class 4: acc 0.9882352941176471, correct 84/85

Val Set, val_loss: 1.3982, val_error: 0.3800, auc: 0.7976
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 27 out of 20


batch 19, loss: 1.8394, instance_loss: 0.5741, weighted_loss: 1.4598, label: 1, bag_size: 868
batch 39, loss: 0.7897, instance_loss: 0.5235, weighted_loss: 0.7098, label: 2, bag_size: 1133
batch 59, loss: 0.0027, instance_loss: 0.0657, weighted_loss: 0.0216, label: 1, bag_size: 847
batch 79, loss: 0.5367, instance_loss: 0.5358, weighted_loss: 0.5364, label: 1, bag_size: 887
batch 99, loss: 0.0305, instance_loss: 0.3167, weighted_loss: 0.1163, label: 3, bag_size: 230
batch 119, loss: 0.0280, instance_loss: 0.2375, weighted_loss: 0.0909, label: 3, bag_size: 1019
batch 139, loss: 0.0784, instance_loss: 0.3941, weighted_loss: 0.1731, label: 3, bag_size: 230
batch 159, loss: 0.0018, instance_loss: 0.0493, weighted_loss: 0.0161, label: 0, bag_size: 1466
batch 179, loss: 0.1437, instance_loss: 0.5647, weighted_loss: 0.2700, label: 1, bag_size: 1390
batch 199, loss: 0.1001, instance_loss: 0.4212, weighted_loss: 0.1964, label: 4, bag_size: 663
batch 219, loss: 0.7567, instance_loss: 0.4112, weighted_loss: 0.6530, label: 2, bag_size: 1617
batch 239, loss: 0.0009, instance_loss: 0.1169, weighted_loss: 0.0357, label: 1, bag_size: 866
batch 259, loss: 0.3066, instance_loss: 0.2683, weighted_loss: 0.2951, label: 0, bag_size: 367
batch 279, loss: 0.0279, instance_loss: 0.0847, weighted_loss: 0.0449, label: 0, bag_size: 446
batch 299, loss: 0.1034, instance_loss: 0.2395, weighted_loss: 0.1443, label: 2, bag_size: 701
batch 319, loss: 0.0127, instance_loss: 0.0968, weighted_loss: 0.0380, label: 0, bag_size: 367
batch 339, loss: 0.5101, instance_loss: 0.4129, weighted_loss: 0.4809, label: 2, bag_size: 883
batch 359, loss: 0.9265, instance_loss: 0.4172, weighted_loss: 0.7737, label: 2, bag_size: 323
batch 379, loss: 0.0096, instance_loss: 0.0645, weighted_loss: 0.0261, label: 0, bag_size: 367
batch 399, loss: 0.0011, instance_loss: 0.0845, weighted_loss: 0.0261, label: 4, bag_size: 729
batch 419, loss: 0.0258, instance_loss: 0.3278, weighted_loss: 0.1164, label: 4, bag_size: 663


class 0 clustering acc 0.988764705882353: correct 16809/17000
class 1 clustering acc 0.45794117647058824: correct 1557/3400
Epoch: 36, train_loss: 0.2246, train_clustering_loss:  0.2915, train_error: 0.0800
class 0: acc 0.967032967032967, correct 88/91
class 1: acc 0.8913043478260869, correct 82/92
class 2: acc 0.7682926829268293, correct 63/82
class 3: acc 0.987012987012987, correct 76/77
class 4: acc 0.9879518072289156, correct 82/83

Val Set, val_loss: 1.4608, val_error: 0.4000, auc: 0.7891
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.65, correct 13/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0195, instance_loss: 0.1510, weighted_loss: 0.0590, label: 0, bag_size: 756
batch 39, loss: 0.0023, instance_loss: 0.0372, weighted_loss: 0.0128, label: 0, bag_size: 616
batch 59, loss: 0.1646, instance_loss: 0.2636, weighted_loss: 0.1943, label: 0, bag_size: 294
batch 79, loss: 0.2952, instance_loss: 0.4355, weighted_loss: 0.3373, label: 1, bag_size: 470
batch 99, loss: 0.0536, instance_loss: 0.1707, weighted_loss: 0.0888, label: 0, bag_size: 294
batch 119, loss: 0.0185, instance_loss: 0.0421, weighted_loss: 0.0256, label: 3, bag_size: 729
batch 139, loss: 0.0905, instance_loss: 0.3352, weighted_loss: 0.1639, label: 1, bag_size: 1080
batch 159, loss: 0.0994, instance_loss: 0.3997, weighted_loss: 0.1895, label: 3, bag_size: 230
batch 179, loss: 0.0000, instance_loss: 0.0700, weighted_loss: 0.0210, label: 4, bag_size: 729
batch 199, loss: 0.2234, instance_loss: 0.4439, weighted_loss: 0.2896, label: 0, bag_size: 1527
batch 219, loss: 0.0080, instance_loss: 0.3708, weighted_loss: 0.1169, label: 4, bag_size: 754
batch 239, loss: 0.0390, instance_loss: 0.0393, weighted_loss: 0.0391, label: 3, bag_size: 556
batch 259, loss: 1.0889, instance_loss: 0.6857, weighted_loss: 0.9679, label: 1, bag_size: 293
batch 279, loss: 1.3459, instance_loss: 0.5416, weighted_loss: 1.1046, label: 2, bag_size: 272
batch 299, loss: 0.4701, instance_loss: 0.2208, weighted_loss: 0.3953, label: 3, bag_size: 1019
batch 319, loss: 0.0429, instance_loss: 0.4028, weighted_loss: 0.1509, label: 3, bag_size: 630
batch 339, loss: 0.0019, instance_loss: 0.0360, weighted_loss: 0.0121, label: 3, bag_size: 729
batch 359, loss: 0.0756, instance_loss: 0.3308, weighted_loss: 0.1521, label: 1, bag_size: 682
batch 379, loss: 0.0757, instance_loss: 0.1847, weighted_loss: 0.1084, label: 0, bag_size: 338
batch 399, loss: 0.0377, instance_loss: 0.3436, weighted_loss: 0.1294, label: 4, bag_size: 297
batch 419, loss: 0.0781, instance_loss: 0.3287, weighted_loss: 0.1532, label: 1, bag_size: 474


class 0 clustering acc 0.9891176470588235: correct 16815/17000
class 1 clustering acc 0.4388235294117647: correct 1492/3400
Epoch: 37, train_loss: 0.2732, train_clustering_loss:  0.2996, train_error: 0.1059
class 0: acc 0.9489795918367347, correct 93/98
class 1: acc 0.7407407407407407, correct 60/81
class 2: acc 0.7954545454545454, correct 70/88
class 3: acc 0.989010989010989, correct 90/91
class 4: acc 1.0, correct 67/67

Val Set, val_loss: 1.3884, val_error: 0.3800, auc: 0.8006
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.2125: correct 85/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0130, instance_loss: 0.1447, weighted_loss: 0.0525, label: 0, bag_size: 1012
batch 39, loss: 0.0150, instance_loss: 0.0220, weighted_loss: 0.0171, label: 3, bag_size: 1069
batch 59, loss: 0.0461, instance_loss: 0.2942, weighted_loss: 0.1206, label: 3, bag_size: 230
batch 79, loss: 0.0870, instance_loss: 0.1828, weighted_loss: 0.1157, label: 0, bag_size: 729
batch 99, loss: 1.1635, instance_loss: 0.5340, weighted_loss: 0.9746, label: 2, bag_size: 500
batch 119, loss: 0.2091, instance_loss: 0.6524, weighted_loss: 0.3421, label: 4, bag_size: 533
batch 139, loss: 3.1885, instance_loss: 0.6988, weighted_loss: 2.4416, label: 1, bag_size: 435
batch 159, loss: 0.0082, instance_loss: 0.2041, weighted_loss: 0.0670, label: 4, bag_size: 729
batch 179, loss: 0.0339, instance_loss: 0.5462, weighted_loss: 0.1876, label: 4, bag_size: 533
batch 199, loss: 0.1126, instance_loss: 0.3312, weighted_loss: 0.1782, label: 2, bag_size: 986
batch 219, loss: 0.1895, instance_loss: 0.5677, weighted_loss: 0.3030, label: 2, bag_size: 707
batch 239, loss: 0.1286, instance_loss: 0.2972, weighted_loss: 0.1792, label: 0, bag_size: 1527
batch 259, loss: 0.1762, instance_loss: 0.2459, weighted_loss: 0.1971, label: 1, bag_size: 697
batch 279, loss: 0.0030, instance_loss: 0.0827, weighted_loss: 0.0269, label: 4, bag_size: 729
batch 299, loss: 0.0409, instance_loss: 0.1203, weighted_loss: 0.0647, label: 4, bag_size: 773
batch 319, loss: 0.3022, instance_loss: 0.4499, weighted_loss: 0.3465, label: 0, bag_size: 1247
batch 339, loss: 0.2538, instance_loss: 0.5116, weighted_loss: 0.3312, label: 2, bag_size: 1232
batch 359, loss: 0.2875, instance_loss: 0.1850, weighted_loss: 0.2568, label: 3, bag_size: 1019
batch 379, loss: 0.3033, instance_loss: 0.3514, weighted_loss: 0.3178, label: 0, bag_size: 1190
batch 399, loss: 0.8146, instance_loss: 0.3195, weighted_loss: 0.6661, label: 1, bag_size: 533
batch 419, loss: 0.1146, instance_loss: 0.3564, weighted_loss: 0.1872, label: 2, bag_size: 245


class 0 clustering acc 0.9878235294117647: correct 16793/17000
class 1 clustering acc 0.4041176470588235: correct 1374/3400
Epoch: 38, train_loss: 0.2894, train_clustering_loss:  0.3214, train_error: 0.1012
class 0: acc 0.9555555555555556, correct 86/90
class 1: acc 0.7912087912087912, correct 72/91
class 2: acc 0.797752808988764, correct 71/89
class 3: acc 0.9864864864864865, correct 73/74
class 4: acc 0.9876543209876543, correct 80/81

Val Set, val_loss: 1.4239, val_error: 0.4000, auc: 0.7973
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0466, instance_loss: 0.2730, weighted_loss: 0.1146, label: 1, bag_size: 1014
batch 39, loss: 0.0770, instance_loss: 0.3393, weighted_loss: 0.1557, label: 3, bag_size: 230
batch 59, loss: 0.0004, instance_loss: 0.2043, weighted_loss: 0.0616, label: 4, bag_size: 388
batch 79, loss: 0.2607, instance_loss: 0.3621, weighted_loss: 0.2911, label: 1, bag_size: 965
batch 99, loss: 0.1395, instance_loss: 0.2447, weighted_loss: 0.1711, label: 2, bag_size: 1242
batch 119, loss: 0.0167, instance_loss: 0.4324, weighted_loss: 0.1414, label: 4, bag_size: 882
batch 139, loss: 0.0038, instance_loss: 0.3637, weighted_loss: 0.1117, label: 3, bag_size: 706
batch 159, loss: 0.0483, instance_loss: 0.1688, weighted_loss: 0.0845, label: 0, bag_size: 653
batch 179, loss: 0.8735, instance_loss: 0.4314, weighted_loss: 0.7409, label: 2, bag_size: 948
batch 199, loss: 0.1520, instance_loss: 0.3152, weighted_loss: 0.2009, label: 2, bag_size: 1006
batch 219, loss: 0.0662, instance_loss: 0.2790, weighted_loss: 0.1300, label: 4, bag_size: 663
batch 239, loss: 0.0151, instance_loss: 0.0803, weighted_loss: 0.0347, label: 3, bag_size: 729
batch 259, loss: 0.0009, instance_loss: 0.0387, weighted_loss: 0.0122, label: 4, bag_size: 729
batch 279, loss: 0.8295, instance_loss: 0.3791, weighted_loss: 0.6944, label: 2, bag_size: 1148
batch 299, loss: 0.0623, instance_loss: 0.2227, weighted_loss: 0.1104, label: 0, bag_size: 410
batch 319, loss: 0.0003, instance_loss: 0.0299, weighted_loss: 0.0092, label: 4, bag_size: 729
batch 339, loss: 0.4316, instance_loss: 0.2856, weighted_loss: 0.3878, label: 0, bag_size: 545
batch 359, loss: 0.1196, instance_loss: 0.5873, weighted_loss: 0.2599, label: 1, bag_size: 487
batch 379, loss: 0.4667, instance_loss: 0.3779, weighted_loss: 0.4401, label: 2, bag_size: 1133
batch 399, loss: 0.3124, instance_loss: 0.6611, weighted_loss: 0.4170, label: 1, bag_size: 269
batch 419, loss: 0.5585, instance_loss: 0.2843, weighted_loss: 0.4763, label: 2, bag_size: 395


class 0 clustering acc 0.9889411764705882: correct 16812/17000
class 1 clustering acc 0.3891176470588235: correct 1323/3400
Epoch: 39, train_loss: 0.2670, train_clustering_loss:  0.3188, train_error: 0.0941
class 0: acc 0.9310344827586207, correct 81/87
class 1: acc 0.8666666666666667, correct 78/90
class 2: acc 0.7777777777777778, correct 70/90
class 3: acc 1.0, correct 76/76
class 4: acc 0.975609756097561, correct 80/82

Val Set, val_loss: 1.4819, val_error: 0.3000, auc: 0.7826
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.22: correct 88/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0971, weighted_loss: 0.0291, label: 4, bag_size: 1002
batch 39, loss: 0.2243, instance_loss: 0.3773, weighted_loss: 0.2702, label: 2, bag_size: 911
batch 59, loss: 0.1380, instance_loss: 0.2902, weighted_loss: 0.1836, label: 2, bag_size: 758
batch 79, loss: 0.1388, instance_loss: 0.2820, weighted_loss: 0.1818, label: 4, bag_size: 354
batch 99, loss: 0.0058, instance_loss: 0.0803, weighted_loss: 0.0282, label: 3, bag_size: 729
batch 119, loss: 0.0526, instance_loss: 0.3851, weighted_loss: 0.1524, label: 1, bag_size: 504
batch 139, loss: 0.0262, instance_loss: 0.0405, weighted_loss: 0.0305, label: 3, bag_size: 729
batch 159, loss: 0.0404, instance_loss: 0.5053, weighted_loss: 0.1799, label: 4, bag_size: 1337
batch 179, loss: 0.0734, instance_loss: 0.2401, weighted_loss: 0.1234, label: 1, bag_size: 838
batch 199, loss: 1.5760, instance_loss: 0.7580, weighted_loss: 1.3306, label: 1, bag_size: 308
batch 219, loss: 0.0963, instance_loss: 0.4488, weighted_loss: 0.2021, label: 3, bag_size: 697
batch 239, loss: 0.0222, instance_loss: 0.0941, weighted_loss: 0.0438, label: 3, bag_size: 1177
batch 259, loss: 0.1535, instance_loss: 0.0811, weighted_loss: 0.1318, label: 3, bag_size: 729
batch 279, loss: 0.0433, instance_loss: 0.2584, weighted_loss: 0.1078, label: 2, bag_size: 1215
batch 299, loss: 0.2092, instance_loss: 0.2900, weighted_loss: 0.2334, label: 1, bag_size: 968
batch 319, loss: 0.1006, instance_loss: 0.1987, weighted_loss: 0.1300, label: 3, bag_size: 849
batch 339, loss: 0.0631, instance_loss: 0.2549, weighted_loss: 0.1206, label: 0, bag_size: 1046
batch 359, loss: 0.1990, instance_loss: 0.5957, weighted_loss: 0.3180, label: 4, bag_size: 366
batch 379, loss: 0.0002, instance_loss: 0.0327, weighted_loss: 0.0100, label: 4, bag_size: 729
batch 399, loss: 0.0021, instance_loss: 0.0361, weighted_loss: 0.0123, label: 0, bag_size: 382
batch 419, loss: 0.0575, instance_loss: 0.0957, weighted_loss: 0.0690, label: 1, bag_size: 994


class 0 clustering acc 0.9893529411764705: correct 16819/17000
class 1 clustering acc 0.48264705882352943: correct 1641/3400
Epoch: 40, train_loss: 0.2104, train_clustering_loss:  0.2795, train_error: 0.0800
class 0: acc 0.987012987012987, correct 76/77
class 1: acc 0.8241758241758241, correct 75/91
class 2: acc 0.8235294117647058, correct 70/85
class 3: acc 0.9764705882352941, correct 83/85
class 4: acc 1.0, correct 87/87

Val Set, val_loss: 1.5140, val_error: 0.3800, auc: 0.7671
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.3620, instance_loss: 0.5599, weighted_loss: 0.4214, label: 1, bag_size: 657
batch 39, loss: 0.8182, instance_loss: 0.5173, weighted_loss: 0.7280, label: 2, bag_size: 500
batch 59, loss: 0.9846, instance_loss: 0.4948, weighted_loss: 0.8376, label: 3, bag_size: 305
batch 79, loss: 0.0222, instance_loss: 0.1834, weighted_loss: 0.0706, label: 0, bag_size: 552
batch 99, loss: 0.3445, instance_loss: 0.5666, weighted_loss: 0.4112, label: 1, bag_size: 1080
batch 119, loss: 0.0547, instance_loss: 0.2552, weighted_loss: 0.1149, label: 4, bag_size: 663
batch 139, loss: 0.0040, instance_loss: 0.2634, weighted_loss: 0.0818, label: 0, bag_size: 729
batch 159, loss: 0.0022, instance_loss: 0.1634, weighted_loss: 0.0506, label: 4, bag_size: 625
batch 179, loss: 0.0189, instance_loss: 0.1517, weighted_loss: 0.0587, label: 1, bag_size: 944
batch 199, loss: 0.0415, instance_loss: 0.1563, weighted_loss: 0.0760, label: 2, bag_size: 1569
batch 219, loss: 0.1928, instance_loss: 0.2229, weighted_loss: 0.2018, label: 0, bag_size: 807
batch 239, loss: 0.0321, instance_loss: 0.0428, weighted_loss: 0.0353, label: 1, bag_size: 937
batch 259, loss: 0.0029, instance_loss: 0.0356, weighted_loss: 0.0127, label: 0, bag_size: 1143
batch 279, loss: 0.0968, instance_loss: 0.8560, weighted_loss: 0.3246, label: 1, bag_size: 651
batch 299, loss: 0.0482, instance_loss: 0.4009, weighted_loss: 0.1540, label: 2, bag_size: 405
batch 319, loss: 0.0031, instance_loss: 0.1420, weighted_loss: 0.0448, label: 4, bag_size: 1278
batch 339, loss: 0.9424, instance_loss: 0.7484, weighted_loss: 0.8842, label: 1, bag_size: 435
batch 359, loss: 0.0639, instance_loss: 0.7415, weighted_loss: 0.2672, label: 4, bag_size: 436
batch 379, loss: 0.0073, instance_loss: 0.1619, weighted_loss: 0.0537, label: 4, bag_size: 1278
batch 399, loss: 0.2465, instance_loss: 0.1749, weighted_loss: 0.2250, label: 4, bag_size: 1278
batch 419, loss: 0.1903, instance_loss: 0.4015, weighted_loss: 0.2536, label: 2, bag_size: 1052


class 0 clustering acc 0.9861764705882353: correct 16765/17000
class 1 clustering acc 0.4520588235294118: correct 1537/3400
Epoch: 41, train_loss: 0.2156, train_clustering_loss:  0.3047, train_error: 0.0588
class 0: acc 0.9390243902439024, correct 77/82
class 1: acc 0.8735632183908046, correct 76/87
class 2: acc 0.9139784946236559, correct 85/93
class 3: acc 0.9857142857142858, correct 69/70
class 4: acc 1.0, correct 93/93

Val Set, val_loss: 1.5590, val_error: 0.3800, auc: 0.7722
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0085, instance_loss: 0.0480, weighted_loss: 0.0203, label: 3, bag_size: 451
batch 39, loss: 0.0105, instance_loss: 0.0771, weighted_loss: 0.0305, label: 4, bag_size: 773
batch 59, loss: 0.0945, instance_loss: 0.6335, weighted_loss: 0.2562, label: 3, bag_size: 200
batch 79, loss: 0.0620, instance_loss: 0.6846, weighted_loss: 0.2488, label: 1, bag_size: 1409
batch 99, loss: 0.0200, instance_loss: 0.0227, weighted_loss: 0.0208, label: 3, bag_size: 1069
batch 119, loss: 0.0089, instance_loss: 0.1866, weighted_loss: 0.0622, label: 1, bag_size: 504
batch 139, loss: 0.1266, instance_loss: 0.2408, weighted_loss: 0.1609, label: 1, bag_size: 1646
batch 159, loss: 0.0066, instance_loss: 0.2868, weighted_loss: 0.0907, label: 4, bag_size: 656
batch 179, loss: 0.0119, instance_loss: 0.2198, weighted_loss: 0.0743, label: 0, bag_size: 729
batch 199, loss: 0.0644, instance_loss: 0.3109, weighted_loss: 0.1383, label: 2, bag_size: 795
batch 219, loss: 0.0009, instance_loss: 0.0391, weighted_loss: 0.0123, label: 0, bag_size: 402
batch 239, loss: 0.0175, instance_loss: 0.5319, weighted_loss: 0.1718, label: 3, bag_size: 200
batch 259, loss: 0.0000, instance_loss: 0.0383, weighted_loss: 0.0115, label: 4, bag_size: 729
batch 279, loss: 0.1340, instance_loss: 0.8263, weighted_loss: 0.3417, label: 1, bag_size: 651
batch 299, loss: 0.0093, instance_loss: 0.0509, weighted_loss: 0.0218, label: 0, bag_size: 1872
batch 319, loss: 0.0545, instance_loss: 0.1657, weighted_loss: 0.0879, label: 1, bag_size: 1426
batch 339, loss: 0.7424, instance_loss: 0.7152, weighted_loss: 0.7342, label: 2, bag_size: 934
batch 359, loss: 0.1646, instance_loss: 0.3989, weighted_loss: 0.2349, label: 2, bag_size: 508
batch 379, loss: 0.0379, instance_loss: 0.5688, weighted_loss: 0.1972, label: 4, bag_size: 436
batch 399, loss: 1.2463, instance_loss: 0.5722, weighted_loss: 1.0441, label: 1, bag_size: 1376
batch 419, loss: 0.0002, instance_loss: 0.1048, weighted_loss: 0.0316, label: 4, bag_size: 729


class 0 clustering acc 0.9864117647058823: correct 16769/17000
class 1 clustering acc 0.4323529411764706: correct 1470/3400
Epoch: 42, train_loss: 0.2092, train_clustering_loss:  0.3103, train_error: 0.0659
class 0: acc 0.9864864864864865, correct 73/74
class 1: acc 0.8172043010752689, correct 76/93
class 2: acc 0.8969072164948454, correct 87/97
class 3: acc 1.0, correct 75/75
class 4: acc 1.0, correct 86/86

Val Set, val_loss: 1.6629, val_error: 0.4200, auc: 0.7835
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.26: correct 104/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.55, correct 11/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0069, instance_loss: 0.1079, weighted_loss: 0.0372, label: 0, bag_size: 729
batch 39, loss: 0.0639, instance_loss: 0.1733, weighted_loss: 0.0967, label: 3, bag_size: 1019
batch 59, loss: 0.0004, instance_loss: 0.0539, weighted_loss: 0.0165, label: 4, bag_size: 729
batch 79, loss: 0.0002, instance_loss: 0.0947, weighted_loss: 0.0286, label: 4, bag_size: 1002
batch 99, loss: 0.0337, instance_loss: 0.3071, weighted_loss: 0.1157, label: 2, bag_size: 774
batch 119, loss: 0.2409, instance_loss: 0.4166, weighted_loss: 0.2936, label: 2, bag_size: 345
batch 139, loss: 0.3341, instance_loss: 0.3831, weighted_loss: 0.3488, label: 2, bag_size: 676
batch 159, loss: 0.1349, instance_loss: 0.3657, weighted_loss: 0.2042, label: 1, bag_size: 1049
batch 179, loss: 0.0349, instance_loss: 0.0827, weighted_loss: 0.0493, label: 3, bag_size: 316
batch 199, loss: 1.7684, instance_loss: 0.6870, weighted_loss: 1.4440, label: 2, bag_size: 542
batch 219, loss: 0.0049, instance_loss: 0.3794, weighted_loss: 0.1172, label: 4, bag_size: 882
batch 239, loss: 0.0230, instance_loss: 0.1193, weighted_loss: 0.0519, label: 4, bag_size: 524
batch 259, loss: 0.1244, instance_loss: 0.3719, weighted_loss: 0.1986, label: 2, bag_size: 1053
batch 279, loss: 0.0080, instance_loss: 0.1949, weighted_loss: 0.0641, label: 0, bag_size: 1133
batch 299, loss: 0.5429, instance_loss: 0.3652, weighted_loss: 0.4896, label: 2, bag_size: 682
batch 319, loss: 0.0840, instance_loss: 0.2258, weighted_loss: 0.1266, label: 2, bag_size: 1123
batch 339, loss: 0.0002, instance_loss: 0.0965, weighted_loss: 0.0291, label: 4, bag_size: 1002
batch 359, loss: 0.0367, instance_loss: 0.4740, weighted_loss: 0.1679, label: 4, bag_size: 366
batch 379, loss: 0.0239, instance_loss: 0.2524, weighted_loss: 0.0925, label: 1, bag_size: 534
batch 399, loss: 0.0338, instance_loss: 0.0974, weighted_loss: 0.0529, label: 4, bag_size: 729
batch 419, loss: 0.0074, instance_loss: 0.1134, weighted_loss: 0.0392, label: 0, bag_size: 729


class 0 clustering acc 0.9864705882352941: correct 16770/17000
class 1 clustering acc 0.4673529411764706: correct 1589/3400
Epoch: 43, train_loss: 0.2027, train_clustering_loss:  0.2917, train_error: 0.0659
class 0: acc 0.9866666666666667, correct 74/75
class 1: acc 0.8433734939759037, correct 70/83
class 2: acc 0.8817204301075269, correct 82/93
class 3: acc 0.9767441860465116, correct 84/86
class 4: acc 0.9886363636363636, correct 87/88

Val Set, val_loss: 1.4935, val_error: 0.3600, auc: 0.7597
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.265: correct 106/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.85, correct 17/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0524, instance_loss: 0.3229, weighted_loss: 0.1336, label: 2, bag_size: 237
batch 39, loss: 0.0277, instance_loss: 0.0509, weighted_loss: 0.0346, label: 1, bag_size: 937
batch 59, loss: 0.0016, instance_loss: 0.0663, weighted_loss: 0.0210, label: 0, bag_size: 729
batch 79, loss: 0.1427, instance_loss: 0.2816, weighted_loss: 0.1844, label: 2, bag_size: 638
batch 99, loss: 0.1612, instance_loss: 0.3296, weighted_loss: 0.2117, label: 2, bag_size: 347
batch 119, loss: 0.0080, instance_loss: 0.0777, weighted_loss: 0.0289, label: 0, bag_size: 616
batch 139, loss: 0.3027, instance_loss: 0.4722, weighted_loss: 0.3536, label: 2, bag_size: 649
batch 159, loss: 0.0340, instance_loss: 0.4575, weighted_loss: 0.1610, label: 2, bag_size: 204
batch 179, loss: 0.0252, instance_loss: 0.6254, weighted_loss: 0.2053, label: 4, bag_size: 436
batch 199, loss: 0.0014, instance_loss: 0.0357, weighted_loss: 0.0117, label: 0, bag_size: 898
batch 219, loss: 0.3264, instance_loss: 0.5802, weighted_loss: 0.4026, label: 0, bag_size: 1034
batch 239, loss: 0.0492, instance_loss: 0.4247, weighted_loss: 0.1618, label: 1, bag_size: 1014
batch 259, loss: 0.0059, instance_loss: 0.2893, weighted_loss: 0.0910, label: 1, bag_size: 696
batch 279, loss: 0.0029, instance_loss: 0.3938, weighted_loss: 0.1202, label: 4, bag_size: 1331
batch 299, loss: 0.0001, instance_loss: 0.0292, weighted_loss: 0.0089, label: 4, bag_size: 729
batch 319, loss: 0.0041, instance_loss: 0.1465, weighted_loss: 0.0468, label: 4, bag_size: 1235
batch 339, loss: 0.0750, instance_loss: 0.5003, weighted_loss: 0.2026, label: 3, bag_size: 317
batch 359, loss: 0.1164, instance_loss: 0.3398, weighted_loss: 0.1834, label: 2, bag_size: 345
batch 379, loss: 0.4309, instance_loss: 0.3362, weighted_loss: 0.4025, label: 1, bag_size: 1096
batch 399, loss: 0.0168, instance_loss: 0.0743, weighted_loss: 0.0341, label: 3, bag_size: 729
batch 419, loss: 0.0009, instance_loss: 0.5598, weighted_loss: 0.1686, label: 3, bag_size: 1167


class 0 clustering acc 0.9878235294117647: correct 16793/17000
class 1 clustering acc 0.435: correct 1479/3400
Epoch: 44, train_loss: 0.1920, train_clustering_loss:  0.2976, train_error: 0.0682
class 0: acc 0.9571428571428572, correct 67/70
class 1: acc 0.8541666666666666, correct 82/96
class 2: acc 0.89, correct 89/100
class 3: acc 0.9882352941176471, correct 84/85
class 4: acc 1.0, correct 74/74

Val Set, val_loss: 1.4357, val_error: 0.3200, auc: 0.7900
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.265: correct 106/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0522, weighted_loss: 0.0159, label: 3, bag_size: 729
batch 39, loss: 0.0864, instance_loss: 0.2349, weighted_loss: 0.1309, label: 0, bag_size: 542
batch 59, loss: 0.0192, instance_loss: 0.4924, weighted_loss: 0.1612, label: 3, bag_size: 281
batch 79, loss: 0.0587, instance_loss: 0.4564, weighted_loss: 0.1780, label: 1, bag_size: 648
batch 99, loss: 0.0543, instance_loss: 0.4106, weighted_loss: 0.1612, label: 3, bag_size: 630
batch 119, loss: 0.0015, instance_loss: 0.1026, weighted_loss: 0.0318, label: 4, bag_size: 1278
batch 139, loss: 0.4660, instance_loss: 0.5322, weighted_loss: 0.4858, label: 2, bag_size: 1133
batch 159, loss: 0.0638, instance_loss: 0.4148, weighted_loss: 0.1691, label: 0, bag_size: 570
batch 179, loss: 0.0004, instance_loss: 0.0650, weighted_loss: 0.0198, label: 4, bag_size: 729
batch 199, loss: 0.2675, instance_loss: 0.4602, weighted_loss: 0.3253, label: 1, bag_size: 1049
batch 219, loss: 0.1343, instance_loss: 0.4538, weighted_loss: 0.2301, label: 1, bag_size: 442
batch 239, loss: 0.0029, instance_loss: 0.0240, weighted_loss: 0.0092, label: 0, bag_size: 1235
batch 259, loss: 0.0065, instance_loss: 0.0941, weighted_loss: 0.0328, label: 4, bag_size: 524
batch 279, loss: 0.0025, instance_loss: 0.1061, weighted_loss: 0.0336, label: 4, bag_size: 1278
batch 299, loss: 0.0095, instance_loss: 0.0911, weighted_loss: 0.0339, label: 0, bag_size: 446
batch 319, loss: 0.8518, instance_loss: 0.5906, weighted_loss: 0.7734, label: 2, bag_size: 500
batch 339, loss: 0.0052, instance_loss: 0.1786, weighted_loss: 0.0572, label: 1, bag_size: 614
batch 359, loss: 0.0167, instance_loss: 0.5217, weighted_loss: 0.1682, label: 4, bag_size: 754
batch 379, loss: 0.0304, instance_loss: 0.3647, weighted_loss: 0.1307, label: 1, bag_size: 1014
batch 399, loss: 0.2143, instance_loss: 0.3494, weighted_loss: 0.2548, label: 3, bag_size: 630
batch 419, loss: 0.0006, instance_loss: 0.0432, weighted_loss: 0.0134, label: 0, bag_size: 898


class 0 clustering acc 0.9872941176470589: correct 16784/17000
class 1 clustering acc 0.4723529411764706: correct 1606/3400
Epoch: 45, train_loss: 0.1904, train_clustering_loss:  0.2992, train_error: 0.0612
class 0: acc 0.96875, correct 93/96
class 1: acc 0.8850574712643678, correct 77/87
class 2: acc 0.8493150684931506, correct 62/73
class 3: acc 0.9782608695652174, correct 90/92
class 4: acc 1.0, correct 77/77

Val Set, val_loss: 1.5691, val_error: 0.3400, auc: 0.7688
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.9, correct 18/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.7558, instance_loss: 0.5552, weighted_loss: 0.6956, label: 1, bag_size: 308
batch 39, loss: 2.8718, instance_loss: 0.5499, weighted_loss: 2.1752, label: 1, bag_size: 868
batch 59, loss: 0.1125, instance_loss: 0.1717, weighted_loss: 0.1302, label: 1, bag_size: 598
batch 79, loss: 0.0544, instance_loss: 0.1980, weighted_loss: 0.0975, label: 1, bag_size: 838
batch 99, loss: 0.0101, instance_loss: 0.0591, weighted_loss: 0.0248, label: 3, bag_size: 952
batch 119, loss: 0.0008, instance_loss: 0.0455, weighted_loss: 0.0142, label: 4, bag_size: 729
batch 139, loss: 0.0461, instance_loss: 0.7507, weighted_loss: 0.2575, label: 4, bag_size: 436
batch 159, loss: 0.0364, instance_loss: 0.0536, weighted_loss: 0.0416, label: 3, bag_size: 729
batch 179, loss: 0.0120, instance_loss: 0.6139, weighted_loss: 0.1926, label: 3, bag_size: 1167
batch 199, loss: 0.0034, instance_loss: 0.0715, weighted_loss: 0.0238, label: 0, bag_size: 729
batch 219, loss: 0.0306, instance_loss: 0.4891, weighted_loss: 0.1681, label: 3, bag_size: 630
batch 239, loss: 0.0856, instance_loss: 0.5326, weighted_loss: 0.2197, label: 2, bag_size: 725
batch 259, loss: 0.0329, instance_loss: 0.2435, weighted_loss: 0.0960, label: 0, bag_size: 760
batch 279, loss: 0.0455, instance_loss: 0.3767, weighted_loss: 0.1448, label: 3, bag_size: 821
batch 299, loss: 0.0600, instance_loss: 0.2554, weighted_loss: 0.1186, label: 3, bag_size: 697
batch 319, loss: 0.0513, instance_loss: 0.2267, weighted_loss: 0.1039, label: 0, bag_size: 1190
batch 339, loss: 0.0037, instance_loss: 0.0655, weighted_loss: 0.0223, label: 0, bag_size: 1235
batch 359, loss: 0.0017, instance_loss: 0.4094, weighted_loss: 0.1240, label: 3, bag_size: 791
batch 379, loss: 0.1627, instance_loss: 0.3731, weighted_loss: 0.2258, label: 1, bag_size: 754
batch 399, loss: 0.1582, instance_loss: 0.4621, weighted_loss: 0.2494, label: 1, bag_size: 959
batch 419, loss: 0.2233, instance_loss: 0.2618, weighted_loss: 0.2348, label: 1, bag_size: 598


class 0 clustering acc 0.9909411764705882: correct 16846/17000
class 1 clustering acc 0.46911764705882353: correct 1595/3400
Epoch: 46, train_loss: 0.2233, train_clustering_loss:  0.2824, train_error: 0.0682
class 0: acc 1.0, correct 82/82
class 1: acc 0.8390804597701149, correct 73/87
class 2: acc 0.8414634146341463, correct 69/82
class 3: acc 0.989010989010989, correct 90/91
class 4: acc 0.9879518072289156, correct 82/83

Val Set, val_loss: 1.5382, val_error: 0.3800, auc: 0.7757
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0401, weighted_loss: 0.0121, label: 4, bag_size: 729
batch 39, loss: 0.0717, instance_loss: 0.6014, weighted_loss: 0.2306, label: 1, bag_size: 1390
batch 59, loss: 0.0008, instance_loss: 0.2878, weighted_loss: 0.0869, label: 4, bag_size: 823
batch 79, loss: 0.9760, instance_loss: 0.6021, weighted_loss: 0.8638, label: 1, bag_size: 778
batch 99, loss: 0.0001, instance_loss: 0.1497, weighted_loss: 0.0450, label: 4, bag_size: 388
batch 119, loss: 0.0007, instance_loss: 0.1106, weighted_loss: 0.0337, label: 4, bag_size: 729
batch 139, loss: 0.0016, instance_loss: 0.0500, weighted_loss: 0.0161, label: 1, bag_size: 369
batch 159, loss: 0.1705, instance_loss: 0.6722, weighted_loss: 0.3210, label: 1, bag_size: 386
batch 179, loss: 0.3987, instance_loss: 0.3892, weighted_loss: 0.3958, label: 2, bag_size: 1259
batch 199, loss: 0.0979, instance_loss: 0.6056, weighted_loss: 0.2502, label: 1, bag_size: 386
batch 219, loss: 0.0016, instance_loss: 0.0490, weighted_loss: 0.0158, label: 0, bag_size: 729
batch 239, loss: 0.0162, instance_loss: 0.0880, weighted_loss: 0.0378, label: 4, bag_size: 773
batch 259, loss: 0.0034, instance_loss: 0.2000, weighted_loss: 0.0624, label: 4, bag_size: 823
batch 279, loss: 0.0201, instance_loss: 0.1137, weighted_loss: 0.0482, label: 0, bag_size: 1579
batch 299, loss: 0.0764, instance_loss: 0.2044, weighted_loss: 0.1148, label: 1, bag_size: 614
batch 319, loss: 0.0014, instance_loss: 0.0414, weighted_loss: 0.0134, label: 0, bag_size: 1235
batch 339, loss: 4.5070, instance_loss: 0.9591, weighted_loss: 3.4426, label: 1, bag_size: 1799
batch 359, loss: 0.0013, instance_loss: 0.0797, weighted_loss: 0.0249, label: 4, bag_size: 764
batch 379, loss: 0.1432, instance_loss: 0.3414, weighted_loss: 0.2027, label: 1, bag_size: 925
batch 399, loss: 0.0139, instance_loss: 0.1694, weighted_loss: 0.0605, label: 0, bag_size: 756
batch 419, loss: 0.0000, instance_loss: 0.0739, weighted_loss: 0.0222, label: 4, bag_size: 729


class 0 clustering acc 0.9868823529411764: correct 16777/17000
class 1 clustering acc 0.48823529411764705: correct 1660/3400
Epoch: 47, train_loss: 0.2124, train_clustering_loss:  0.2924, train_error: 0.0682
class 0: acc 0.9404761904761905, correct 79/84
class 1: acc 0.8395061728395061, correct 68/81
class 2: acc 0.8850574712643678, correct 77/87
class 3: acc 1.0, correct 76/76
class 4: acc 0.9896907216494846, correct 96/97

Val Set, val_loss: 1.5335, val_error: 0.3200, auc: 0.7669
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.85, correct 17/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0031, instance_loss: 0.0983, weighted_loss: 0.0317, label: 0, bag_size: 518
batch 39, loss: 0.0022, instance_loss: 0.1467, weighted_loss: 0.0455, label: 4, bag_size: 1235
batch 59, loss: 0.0072, instance_loss: 0.1186, weighted_loss: 0.0406, label: 0, bag_size: 630
batch 79, loss: 0.0109, instance_loss: 0.0390, weighted_loss: 0.0193, label: 3, bag_size: 729
batch 99, loss: 0.0120, instance_loss: 0.1099, weighted_loss: 0.0414, label: 0, bag_size: 731
batch 119, loss: 0.0014, instance_loss: 0.0737, weighted_loss: 0.0231, label: 0, bag_size: 729
batch 139, loss: 0.0002, instance_loss: 0.0465, weighted_loss: 0.0141, label: 4, bag_size: 729
batch 159, loss: 0.0619, instance_loss: 0.5174, weighted_loss: 0.1986, label: 3, bag_size: 630
batch 179, loss: 0.0044, instance_loss: 0.1229, weighted_loss: 0.0400, label: 0, bag_size: 729
batch 199, loss: 0.0006, instance_loss: 0.3740, weighted_loss: 0.1126, label: 1, bag_size: 1127
batch 219, loss: 0.6828, instance_loss: 0.6358, weighted_loss: 0.6687, label: 0, bag_size: 423
batch 239, loss: 0.0020, instance_loss: 0.4029, weighted_loss: 0.1223, label: 3, bag_size: 706
batch 259, loss: 0.0046, instance_loss: 0.0746, weighted_loss: 0.0256, label: 0, bag_size: 340
batch 279, loss: 0.0145, instance_loss: 0.2193, weighted_loss: 0.0759, label: 2, bag_size: 621
batch 299, loss: 0.1030, instance_loss: 0.2085, weighted_loss: 0.1346, label: 0, bag_size: 381
batch 319, loss: 0.0351, instance_loss: 0.4702, weighted_loss: 0.1656, label: 3, bag_size: 1380
batch 339, loss: 1.8477, instance_loss: 0.6062, weighted_loss: 1.4753, label: 1, bag_size: 868
batch 359, loss: 0.0190, instance_loss: 0.3334, weighted_loss: 0.1133, label: 2, bag_size: 1215
batch 379, loss: 0.0192, instance_loss: 0.4451, weighted_loss: 0.1470, label: 3, bag_size: 317
batch 399, loss: 0.0012, instance_loss: 0.0859, weighted_loss: 0.0266, label: 0, bag_size: 1466
batch 419, loss: 0.0118, instance_loss: 0.0830, weighted_loss: 0.0331, label: 3, bag_size: 316


class 0 clustering acc 0.9884705882352941: correct 16804/17000
class 1 clustering acc 0.4547058823529412: correct 1546/3400
Epoch: 48, train_loss: 0.1698, train_clustering_loss:  0.2946, train_error: 0.0400
class 0: acc 0.978494623655914, correct 91/93
class 1: acc 0.9263157894736842, correct 88/95
class 2: acc 0.9102564102564102, correct 71/78
class 3: acc 1.0, correct 75/75
class 4: acc 0.9880952380952381, correct 83/84

Val Set, val_loss: 1.6423, val_error: 0.3400, auc: 0.7674
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.275: correct 110/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.6582, instance_loss: 0.5441, weighted_loss: 0.6240, label: 1, bag_size: 1080
batch 39, loss: 0.3442, instance_loss: 0.7191, weighted_loss: 0.4567, label: 1, bag_size: 386
batch 59, loss: 0.0075, instance_loss: 0.4086, weighted_loss: 0.1278, label: 3, bag_size: 1380
batch 79, loss: 0.0315, instance_loss: 0.4096, weighted_loss: 0.1449, label: 1, bag_size: 1724
batch 99, loss: 0.2009, instance_loss: 0.4847, weighted_loss: 0.2860, label: 0, bag_size: 1257
batch 119, loss: 0.0250, instance_loss: 0.0563, weighted_loss: 0.0344, label: 3, bag_size: 729
batch 139, loss: 0.0019, instance_loss: 0.1754, weighted_loss: 0.0539, label: 3, bag_size: 841
batch 159, loss: 0.2039, instance_loss: 0.5421, weighted_loss: 0.3053, label: 1, bag_size: 139
batch 179, loss: 0.0019, instance_loss: 0.0589, weighted_loss: 0.0190, label: 0, bag_size: 518
batch 199, loss: 0.0201, instance_loss: 0.0666, weighted_loss: 0.0341, label: 1, bag_size: 1191
batch 219, loss: 0.0292, instance_loss: 0.6085, weighted_loss: 0.2030, label: 4, bag_size: 533
batch 239, loss: 0.0001, instance_loss: 0.0175, weighted_loss: 0.0053, label: 4, bag_size: 764
batch 259, loss: 0.0762, instance_loss: 0.2770, weighted_loss: 0.1364, label: 2, bag_size: 355
batch 279, loss: 0.9644, instance_loss: 0.6440, weighted_loss: 0.8683, label: 1, bag_size: 778
batch 299, loss: 0.0962, instance_loss: 0.5193, weighted_loss: 0.2231, label: 3, bag_size: 1250
batch 319, loss: 0.0262, instance_loss: 0.0517, weighted_loss: 0.0338, label: 3, bag_size: 849
batch 339, loss: 0.0403, instance_loss: 0.3243, weighted_loss: 0.1255, label: 2, bag_size: 1259
batch 359, loss: 0.2150, instance_loss: 0.5145, weighted_loss: 0.3048, label: 2, bag_size: 869
batch 379, loss: 0.0773, instance_loss: 0.2956, weighted_loss: 0.1428, label: 4, bag_size: 354
batch 399, loss: 0.0194, instance_loss: 0.1561, weighted_loss: 0.0604, label: 0, bag_size: 367
batch 419, loss: 0.0308, instance_loss: 0.1372, weighted_loss: 0.0627, label: 0, bag_size: 338


class 0 clustering acc 0.9872352941176471: correct 16783/17000
class 1 clustering acc 0.5064705882352941: correct 1722/3400
Epoch: 49, train_loss: 0.1336, train_clustering_loss:  0.2771, train_error: 0.0353
class 0: acc 0.9887640449438202, correct 88/89
class 1: acc 0.9560439560439561, correct 87/91
class 2: acc 0.8837209302325582, correct 76/86
class 3: acc 1.0, correct 81/81
class 4: acc 1.0, correct 78/78

Val Set, val_loss: 1.6663, val_error: 0.3800, auc: 0.7709
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.3525: correct 141/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.0196, instance_loss: 0.1216, weighted_loss: 0.0502, label: 0, bag_size: 552
batch 39, loss: 0.1097, instance_loss: 0.3155, weighted_loss: 0.1715, label: 1, bag_size: 242
batch 59, loss: 0.0157, instance_loss: 0.0698, weighted_loss: 0.0319, label: 0, bag_size: 1579
batch 79, loss: 3.0002, instance_loss: 0.6423, weighted_loss: 2.2928, label: 1, bag_size: 446
batch 99, loss: 0.2418, instance_loss: 0.7124, weighted_loss: 0.3830, label: 4, bag_size: 542
batch 119, loss: 0.0399, instance_loss: 0.1637, weighted_loss: 0.0770, label: 2, bag_size: 461
batch 139, loss: 0.0008, instance_loss: 0.0398, weighted_loss: 0.0125, label: 0, bag_size: 1135
batch 159, loss: 0.2231, instance_loss: 0.1869, weighted_loss: 0.2122, label: 3, bag_size: 533
batch 179, loss: 0.0058, instance_loss: 0.0836, weighted_loss: 0.0291, label: 0, bag_size: 729
batch 199, loss: 1.6659, instance_loss: 0.6821, weighted_loss: 1.3708, label: 2, bag_size: 373
batch 219, loss: 0.0652, instance_loss: 0.2165, weighted_loss: 0.1106, label: 1, bag_size: 754
batch 239, loss: 0.0014, instance_loss: 0.4025, weighted_loss: 0.1217, label: 3, bag_size: 791
batch 259, loss: 0.0123, instance_loss: 0.0190, weighted_loss: 0.0143, label: 3, bag_size: 556
batch 279, loss: 0.1230, instance_loss: 0.5842, weighted_loss: 0.2613, label: 2, bag_size: 707
batch 299, loss: 0.5907, instance_loss: 0.7047, weighted_loss: 0.6249, label: 1, bag_size: 435
batch 319, loss: 0.1116, instance_loss: 0.9036, weighted_loss: 0.3492, label: 0, bag_size: 818
batch 339, loss: 0.0004, instance_loss: 0.1463, weighted_loss: 0.0442, label: 4, bag_size: 1278
batch 359, loss: 0.0314, instance_loss: 0.0810, weighted_loss: 0.0463, label: 3, bag_size: 729
batch 379, loss: 0.8263, instance_loss: 0.4936, weighted_loss: 0.7265, label: 2, bag_size: 537
batch 399, loss: 0.1028, instance_loss: 0.7233, weighted_loss: 0.2890, label: 1, bag_size: 778
batch 419, loss: 0.0018, instance_loss: 0.2365, weighted_loss: 0.0722, label: 1, bag_size: 696


class 0 clustering acc 0.9845882352941177: correct 16738/17000
class 1 clustering acc 0.5008823529411764: correct 1703/3400
Epoch: 50, train_loss: 0.1591, train_clustering_loss:  0.2922, train_error: 0.0588
class 0: acc 0.9782608695652174, correct 90/92
class 1: acc 0.8539325842696629, correct 76/89
class 2: acc 0.8977272727272727, correct 79/88
class 3: acc 0.987012987012987, correct 76/77
class 4: acc 1.0, correct 79/79

Val Set, val_loss: 1.7320, val_error: 0.3800, auc: 0.7580
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.2525: correct 101/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.7, correct 14/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.2435, instance_loss: 0.4760, weighted_loss: 0.3132, label: 2, bag_size: 1164
batch 39, loss: 0.0004, instance_loss: 0.0668, weighted_loss: 0.0203, label: 4, bag_size: 729
batch 59, loss: 0.0620, instance_loss: 0.5671, weighted_loss: 0.2135, label: 1, bag_size: 1390
batch 79, loss: 0.0080, instance_loss: 0.1699, weighted_loss: 0.0566, label: 4, bag_size: 823
batch 99, loss: 0.0001, instance_loss: 0.1255, weighted_loss: 0.0377, label: 4, bag_size: 729
batch 119, loss: 0.0107, instance_loss: 0.2463, weighted_loss: 0.0814, label: 4, bag_size: 1357
batch 139, loss: 0.0498, instance_loss: 0.3668, weighted_loss: 0.1449, label: 2, bag_size: 1232
batch 159, loss: 0.0000, instance_loss: 0.0540, weighted_loss: 0.0162, label: 4, bag_size: 1002
batch 179, loss: 0.0845, instance_loss: 0.5008, weighted_loss: 0.2094, label: 0, bag_size: 423
batch 199, loss: 0.1950, instance_loss: 0.3968, weighted_loss: 0.2555, label: 1, bag_size: 470
batch 219, loss: 0.0009, instance_loss: 0.0357, weighted_loss: 0.0114, label: 3, bag_size: 729
batch 239, loss: 0.3892, instance_loss: 0.7203, weighted_loss: 0.4886, label: 2, bag_size: 542
batch 259, loss: 0.0252, instance_loss: 0.0712, weighted_loss: 0.0390, label: 1, bag_size: 1191
batch 279, loss: 0.0129, instance_loss: 0.4122, weighted_loss: 0.1327, label: 1, bag_size: 1014
batch 299, loss: 0.0537, instance_loss: 0.2060, weighted_loss: 0.0994, label: 2, bag_size: 1123
batch 319, loss: 0.0016, instance_loss: 0.0904, weighted_loss: 0.0282, label: 3, bag_size: 729
batch 339, loss: 0.0074, instance_loss: 0.1892, weighted_loss: 0.0619, label: 0, bag_size: 729
batch 359, loss: 0.0627, instance_loss: 0.2120, weighted_loss: 0.1075, label: 1, bag_size: 474
batch 379, loss: 0.0756, instance_loss: 0.2292, weighted_loss: 0.1217, label: 2, bag_size: 907
batch 399, loss: 0.0131, instance_loss: 0.2529, weighted_loss: 0.0850, label: 4, bag_size: 1357
batch 419, loss: 0.0593, instance_loss: 0.0810, weighted_loss: 0.0658, label: 3, bag_size: 316


class 0 clustering acc 0.9860588235294118: correct 16763/17000
class 1 clustering acc 0.4726470588235294: correct 1607/3400
Epoch: 51, train_loss: 0.1540, train_clustering_loss:  0.2939, train_error: 0.0471
class 0: acc 0.9775280898876404, correct 87/89
class 1: acc 0.8875, correct 71/80
class 2: acc 0.9204545454545454, correct 81/88
class 3: acc 0.978494623655914, correct 91/93
class 4: acc 1.0, correct 75/75

Val Set, val_loss: 1.6052, val_error: 0.3200, auc: 0.7873
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.3025: correct 121/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.75, correct 15/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 43 out of 20
Early stopping
Val error: 0.3800, ROC AUC: 0.8091
Test error: 0.4000, ROC AUC: 0.8875
class 0: acc 1.0, correct 5/5
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.48148148148148145, correct 13/27
class 3: acc 0.25, correct 1/4
class 4: acc 1.0, correct 3/3

Training Fold 9!

Init train/val/test splits... 
Done!
Training on 425 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.4539, instance_loss: 1.1915, weighted_loss: 1.3752, label: 0, bag_size: 1247
batch 39, loss: 1.6773, instance_loss: 1.0261, weighted_loss: 1.4820, label: 3, bag_size: 729
batch 59, loss: 1.5205, instance_loss: 0.8435, weighted_loss: 1.3174, label: 0, bag_size: 729
batch 79, loss: 1.5624, instance_loss: 0.7188, weighted_loss: 1.3093, label: 1, bag_size: 838
batch 99, loss: 1.5501, instance_loss: 0.6761, weighted_loss: 1.2879, label: 0, bag_size: 736
batch 119, loss: 1.4716, instance_loss: 0.5545, weighted_loss: 1.1965, label: 3, bag_size: 729
batch 139, loss: 1.4289, instance_loss: 0.5268, weighted_loss: 1.1583, label: 1, bag_size: 1646
batch 159, loss: 1.5886, instance_loss: 0.5309, weighted_loss: 1.2713, label: 3, bag_size: 729
batch 179, loss: 1.6157, instance_loss: 0.5167, weighted_loss: 1.2860, label: 2, bag_size: 682
batch 199, loss: 1.8916, instance_loss: 0.5240, weighted_loss: 1.4814, label: 4, bag_size: 1121
batch 219, loss: 1.6963, instance_loss: 0.5089, weighted_loss: 1.3401, label: 2, bag_size: 259
batch 239, loss: 1.6309, instance_loss: 0.5043, weighted_loss: 1.2929, label: 3, bag_size: 706
batch 259, loss: 1.4628, instance_loss: 0.4831, weighted_loss: 1.1689, label: 0, bag_size: 607
batch 279, loss: 1.5084, instance_loss: 0.4978, weighted_loss: 1.2052, label: 3, bag_size: 729
batch 299, loss: 1.4898, instance_loss: 0.4909, weighted_loss: 1.1901, label: 3, bag_size: 821
batch 319, loss: 1.5527, instance_loss: 0.5009, weighted_loss: 1.2371, label: 1, bag_size: 838
batch 339, loss: 1.6405, instance_loss: 0.5109, weighted_loss: 1.3016, label: 0, bag_size: 478
batch 359, loss: 1.4269, instance_loss: 0.5030, weighted_loss: 1.1497, label: 4, bag_size: 1357
batch 379, loss: 1.6067, instance_loss: 0.5145, weighted_loss: 1.2791, label: 2, bag_size: 1448
batch 399, loss: 1.6647, instance_loss: 0.5220, weighted_loss: 1.3219, label: 0, bag_size: 472
batch 419, loss: 1.4179, instance_loss: 0.4994, weighted_loss: 1.1424, label: 0, bag_size: 630


class 0 clustering acc 0.9957058823529412: correct 16927/17000
class 1 clustering acc 0.0008823529411764706: correct 3/3400
Epoch: 0, train_loss: 1.5943, train_clustering_loss:  0.6178, train_error: 0.7694
class 0: acc 0.42105263157894735, correct 40/95
class 1: acc 0.1728395061728395, correct 14/81
class 2: acc 0.02531645569620253, correct 2/79
class 3: acc 0.14634146341463414, correct 12/82
class 4: acc 0.3409090909090909, correct 30/88

Val Set, val_loss: 1.5802, val_error: 0.9200, auc: 0.6224
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.0, correct 0/11
class 2: acc 0.0, correct 0/26
class 3: acc 0.0, correct 0/6
class 4: acc 0.0, correct 0/1
Validation loss decreased (inf --> 1.580211).  Saving model ...


batch 19, loss: 1.8507, instance_loss: 0.5304, weighted_loss: 1.4546, label: 1, bag_size: 1799
batch 39, loss: 2.0279, instance_loss: 0.5495, weighted_loss: 1.5844, label: 3, bag_size: 671
batch 59, loss: 1.9548, instance_loss: 0.5448, weighted_loss: 1.5318, label: 3, bag_size: 821
batch 79, loss: 1.6795, instance_loss: 0.5060, weighted_loss: 1.3275, label: 4, bag_size: 436
batch 99, loss: 1.6436, instance_loss: 0.5391, weighted_loss: 1.3123, label: 0, bag_size: 729
batch 119, loss: 1.7749, instance_loss: 0.5113, weighted_loss: 1.3958, label: 1, bag_size: 660
batch 139, loss: 1.7066, instance_loss: 0.5031, weighted_loss: 1.3455, label: 2, bag_size: 237
batch 159, loss: 1.4224, instance_loss: 0.5066, weighted_loss: 1.1476, label: 0, bag_size: 807
batch 179, loss: 1.5587, instance_loss: 0.5183, weighted_loss: 1.2466, label: 3, bag_size: 556
batch 199, loss: 1.8965, instance_loss: 0.5420, weighted_loss: 1.4902, label: 2, bag_size: 959
batch 219, loss: 1.3179, instance_loss: 0.4827, weighted_loss: 1.0673, label: 1, bag_size: 949
batch 239, loss: 1.6691, instance_loss: 0.5121, weighted_loss: 1.3220, label: 2, bag_size: 469
batch 259, loss: 1.4617, instance_loss: 0.4898, weighted_loss: 1.1701, label: 4, bag_size: 754
batch 279, loss: 1.6210, instance_loss: 0.5174, weighted_loss: 1.2899, label: 2, bag_size: 1231
batch 299, loss: 1.4678, instance_loss: 0.5158, weighted_loss: 1.1822, label: 0, bag_size: 1135
batch 319, loss: 1.1708, instance_loss: 0.4487, weighted_loss: 0.9542, label: 3, bag_size: 729
batch 339, loss: 1.2368, instance_loss: 0.4854, weighted_loss: 1.0114, label: 0, bag_size: 607
batch 359, loss: 1.6405, instance_loss: 0.5239, weighted_loss: 1.3055, label: 1, bag_size: 242
batch 379, loss: 1.7332, instance_loss: 0.5311, weighted_loss: 1.3726, label: 2, bag_size: 1617
batch 399, loss: 1.0595, instance_loss: 0.4683, weighted_loss: 0.8821, label: 1, bag_size: 994
batch 419, loss: 1.9992, instance_loss: 0.5395, weighted_loss: 1.5613, label: 3, bag_size: 952


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 1, train_loss: 1.4913, train_clustering_loss:  0.5015, train_error: 0.5976
class 0: acc 0.5108695652173914, correct 47/92
class 1: acc 0.43023255813953487, correct 37/86
class 2: acc 0.2976190476190476, correct 25/84
class 3: acc 0.3614457831325301, correct 30/83
class 4: acc 0.4, correct 32/80

Val Set, val_loss: 1.5714, val_error: 0.8200, auc: 0.6360
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.5, correct 3/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.038461538461538464, correct 1/26
class 3: acc 0.0, correct 0/6
class 4: acc 0.0, correct 0/1
Validation loss decreased (1.580211 --> 1.571365).  Saving model ...


batch 19, loss: 1.3949, instance_loss: 0.4994, weighted_loss: 1.1262, label: 1, bag_size: 1426
batch 39, loss: 0.9627, instance_loss: 0.4631, weighted_loss: 0.8128, label: 4, bag_size: 729
batch 59, loss: 1.3677, instance_loss: 0.4750, weighted_loss: 1.0999, label: 4, bag_size: 1331
batch 79, loss: 1.3924, instance_loss: 0.5171, weighted_loss: 1.1298, label: 3, bag_size: 729
batch 99, loss: 0.9957, instance_loss: 0.4260, weighted_loss: 0.8248, label: 4, bag_size: 1360
batch 119, loss: 1.1363, instance_loss: 0.4538, weighted_loss: 0.9316, label: 0, bag_size: 718
batch 139, loss: 0.8847, instance_loss: 0.4023, weighted_loss: 0.7400, label: 3, bag_size: 729
batch 159, loss: 0.6565, instance_loss: 0.3942, weighted_loss: 0.5778, label: 1, bag_size: 1127
batch 179, loss: 1.7421, instance_loss: 0.4867, weighted_loss: 1.3655, label: 1, bag_size: 1559
batch 199, loss: 0.8046, instance_loss: 0.4006, weighted_loss: 0.6834, label: 1, bag_size: 682
batch 219, loss: 1.5466, instance_loss: 0.5260, weighted_loss: 1.2404, label: 0, bag_size: 1135
batch 239, loss: 1.1419, instance_loss: 0.4800, weighted_loss: 0.9434, label: 2, bag_size: 1215
batch 259, loss: 1.6562, instance_loss: 0.4729, weighted_loss: 1.3012, label: 4, bag_size: 436
batch 279, loss: 0.9966, instance_loss: 0.4443, weighted_loss: 0.8309, label: 2, bag_size: 1155
batch 299, loss: 1.1470, instance_loss: 0.4638, weighted_loss: 0.9420, label: 2, bag_size: 358
batch 319, loss: 1.0308, instance_loss: 0.4645, weighted_loss: 0.8609, label: 2, bag_size: 738
batch 339, loss: 1.3307, instance_loss: 0.4268, weighted_loss: 1.0595, label: 2, bag_size: 943
batch 359, loss: 1.7165, instance_loss: 0.5634, weighted_loss: 1.3706, label: 0, bag_size: 350
batch 379, loss: 1.1613, instance_loss: 0.4644, weighted_loss: 0.9522, label: 2, bag_size: 314
batch 399, loss: 1.5387, instance_loss: 0.5220, weighted_loss: 1.2337, label: 0, bag_size: 413
batch 419, loss: 0.7960, instance_loss: 0.4243, weighted_loss: 0.6845, label: 0, bag_size: 630


class 0 clustering acc 1.0: correct 17000/17000
class 1 clustering acc 0.0: correct 0/3400
Epoch: 2, train_loss: 1.2718, train_clustering_loss:  0.4734, train_error: 0.4518
class 0: acc 0.5903614457831325, correct 49/83
class 1: acc 0.5747126436781609, correct 50/87
class 2: acc 0.4583333333333333, correct 44/96
class 3: acc 0.5333333333333333, correct 40/75
class 4: acc 0.5952380952380952, correct 50/84

Val Set, val_loss: 1.2286, val_error: 0.4600, auc: 0.7670
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5, correct 13/26
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
Validation loss decreased (1.571365 --> 1.228643).  Saving model ...


batch 19, loss: 1.4360, instance_loss: 0.4986, weighted_loss: 1.1548, label: 2, bag_size: 252
batch 39, loss: 0.7979, instance_loss: 0.3387, weighted_loss: 0.6601, label: 3, bag_size: 1177
batch 59, loss: 1.4511, instance_loss: 0.5299, weighted_loss: 1.1747, label: 0, bag_size: 1190
batch 79, loss: 0.8235, instance_loss: 0.3335, weighted_loss: 0.6765, label: 3, bag_size: 316
batch 99, loss: 1.1067, instance_loss: 0.4864, weighted_loss: 0.9206, label: 0, bag_size: 476
batch 119, loss: 1.1617, instance_loss: 0.5115, weighted_loss: 0.9666, label: 0, bag_size: 1174
batch 139, loss: 0.9500, instance_loss: 0.4417, weighted_loss: 0.7975, label: 4, bag_size: 826
batch 159, loss: 0.5767, instance_loss: 0.3057, weighted_loss: 0.4954, label: 3, bag_size: 729
batch 179, loss: 0.6694, instance_loss: 0.4322, weighted_loss: 0.5983, label: 0, bag_size: 616
batch 199, loss: 1.1996, instance_loss: 0.5072, weighted_loss: 0.9919, label: 0, bag_size: 1046
batch 219, loss: 0.7951, instance_loss: 0.4164, weighted_loss: 0.6815, label: 2, bag_size: 323
batch 239, loss: 0.5394, instance_loss: 0.3261, weighted_loss: 0.4754, label: 1, bag_size: 890
batch 259, loss: 0.3343, instance_loss: 0.2776, weighted_loss: 0.3173, label: 3, bag_size: 1019
batch 279, loss: 1.9548, instance_loss: 0.5369, weighted_loss: 1.5294, label: 1, bag_size: 386
batch 299, loss: 1.0712, instance_loss: 0.3938, weighted_loss: 0.8679, label: 4, bag_size: 974
batch 319, loss: 2.2385, instance_loss: 0.5603, weighted_loss: 1.7351, label: 3, bag_size: 281
batch 339, loss: 1.2526, instance_loss: 0.4585, weighted_loss: 1.0144, label: 4, bag_size: 754
batch 359, loss: 1.2400, instance_loss: 0.5490, weighted_loss: 1.0327, label: 4, bag_size: 729
batch 379, loss: 2.7823, instance_loss: 0.6716, weighted_loss: 2.1491, label: 4, bag_size: 210
batch 399, loss: 0.5890, instance_loss: 0.3786, weighted_loss: 0.5259, label: 0, bag_size: 367
batch 419, loss: 0.5980, instance_loss: 0.3607, weighted_loss: 0.5268, label: 3, bag_size: 841


class 0 clustering acc 0.9995294117647059: correct 16992/17000
class 1 clustering acc 0.03: correct 102/3400
Epoch: 3, train_loss: 1.0549, train_clustering_loss:  0.4299, train_error: 0.3624
class 0: acc 0.6375, correct 51/80
class 1: acc 0.6875, correct 66/96
class 2: acc 0.42168674698795183, correct 35/83
class 3: acc 0.7684210526315789, correct 73/95
class 4: acc 0.647887323943662, correct 46/71

Val Set, val_loss: 1.1374, val_error: 0.3800, auc: 0.7366
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.015: correct 6/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.6153846153846154, correct 16/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
Validation loss decreased (1.228643 --> 1.137367).  Saving model ...


batch 19, loss: 0.9357, instance_loss: 0.4342, weighted_loss: 0.7853, label: 2, bag_size: 1215
batch 39, loss: 0.1020, instance_loss: 0.1664, weighted_loss: 0.1213, label: 3, bag_size: 1172
batch 59, loss: 0.8240, instance_loss: 0.4462, weighted_loss: 0.7106, label: 0, bag_size: 630
batch 79, loss: 0.8515, instance_loss: 0.4437, weighted_loss: 0.7292, label: 0, bag_size: 1255
batch 99, loss: 0.9127, instance_loss: 0.4411, weighted_loss: 0.7712, label: 0, bag_size: 515
batch 119, loss: 0.8621, instance_loss: 0.2969, weighted_loss: 0.6925, label: 3, bag_size: 729
batch 139, loss: 0.2291, instance_loss: 0.2649, weighted_loss: 0.2398, label: 4, bag_size: 388
batch 159, loss: 0.9327, instance_loss: 0.3374, weighted_loss: 0.7541, label: 1, bag_size: 288
batch 179, loss: 0.7246, instance_loss: 0.4206, weighted_loss: 0.6334, label: 0, bag_size: 1247
batch 199, loss: 1.2558, instance_loss: 0.5019, weighted_loss: 1.0296, label: 2, bag_size: 589
batch 219, loss: 1.8346, instance_loss: 0.5368, weighted_loss: 1.4453, label: 2, bag_size: 629
batch 239, loss: 0.8038, instance_loss: 0.4406, weighted_loss: 0.6949, label: 0, bag_size: 1579
batch 259, loss: 0.7117, instance_loss: 0.4211, weighted_loss: 0.6245, label: 0, bag_size: 367
batch 279, loss: 0.8049, instance_loss: 0.3907, weighted_loss: 0.6806, label: 2, bag_size: 1050
batch 299, loss: 1.5301, instance_loss: 0.5225, weighted_loss: 1.2278, label: 4, bag_size: 625
batch 319, loss: 1.0402, instance_loss: 0.4824, weighted_loss: 0.8729, label: 2, bag_size: 482
batch 339, loss: 1.0276, instance_loss: 0.4438, weighted_loss: 0.8524, label: 2, bag_size: 405
batch 359, loss: 0.0585, instance_loss: 0.0631, weighted_loss: 0.0599, label: 3, bag_size: 1559
batch 379, loss: 1.3699, instance_loss: 0.5108, weighted_loss: 1.1122, label: 2, bag_size: 869
batch 399, loss: 0.3425, instance_loss: 0.3187, weighted_loss: 0.3354, label: 0, bag_size: 1235
batch 419, loss: 1.4972, instance_loss: 0.5118, weighted_loss: 1.2016, label: 1, bag_size: 917


class 0 clustering acc 0.9992941176470588: correct 16988/17000
class 1 clustering acc 0.07352941176470588: correct 250/3400
Epoch: 4, train_loss: 0.9413, train_clustering_loss:  0.4143, train_error: 0.3294
class 0: acc 0.725, correct 58/80
class 1: acc 0.5714285714285714, correct 44/77
class 2: acc 0.625, correct 65/104
class 3: acc 0.7439024390243902, correct 61/82
class 4: acc 0.6951219512195121, correct 57/82

Val Set, val_loss: 1.1812, val_error: 0.4600, auc: 0.7334
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.02: correct 8/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6153846153846154, correct 16/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1178, instance_loss: 0.2901, weighted_loss: 0.1695, label: 4, bag_size: 675
batch 39, loss: 0.5734, instance_loss: 0.3353, weighted_loss: 0.5020, label: 4, bag_size: 542
batch 59, loss: 1.7885, instance_loss: 0.5922, weighted_loss: 1.4296, label: 1, bag_size: 448
batch 79, loss: 0.6900, instance_loss: 0.3978, weighted_loss: 0.6023, label: 2, bag_size: 863
batch 99, loss: 1.5679, instance_loss: 0.5001, weighted_loss: 1.2475, label: 2, bag_size: 324
batch 119, loss: 0.7638, instance_loss: 0.4320, weighted_loss: 0.6643, label: 1, bag_size: 319
batch 139, loss: 1.4194, instance_loss: 0.4651, weighted_loss: 1.1331, label: 1, bag_size: 446
batch 159, loss: 0.6159, instance_loss: 0.3998, weighted_loss: 0.5510, label: 4, bag_size: 754
batch 179, loss: 0.2944, instance_loss: 0.3784, weighted_loss: 0.3196, label: 0, bag_size: 729
batch 199, loss: 1.3390, instance_loss: 0.4922, weighted_loss: 1.0850, label: 2, bag_size: 682
batch 219, loss: 0.3154, instance_loss: 0.2056, weighted_loss: 0.2824, label: 3, bag_size: 729
batch 239, loss: 0.4948, instance_loss: 0.3414, weighted_loss: 0.4488, label: 4, bag_size: 729
batch 259, loss: 2.0782, instance_loss: 0.6595, weighted_loss: 1.6526, label: 1, bag_size: 1724
batch 279, loss: 1.3313, instance_loss: 0.4844, weighted_loss: 1.0773, label: 2, bag_size: 272
batch 299, loss: 0.0709, instance_loss: 0.1135, weighted_loss: 0.0837, label: 3, bag_size: 729
batch 319, loss: 0.7299, instance_loss: 0.3705, weighted_loss: 0.6221, label: 4, bag_size: 729
batch 339, loss: 1.8639, instance_loss: 0.6101, weighted_loss: 1.4878, label: 3, bag_size: 283
batch 359, loss: 0.2303, instance_loss: 0.2946, weighted_loss: 0.2496, label: 0, bag_size: 1466
batch 379, loss: 1.1358, instance_loss: 0.5273, weighted_loss: 0.9533, label: 2, bag_size: 1410
batch 399, loss: 0.2764, instance_loss: 0.1727, weighted_loss: 0.2453, label: 3, bag_size: 729
batch 419, loss: 0.1204, instance_loss: 0.2349, weighted_loss: 0.1547, label: 4, bag_size: 790


class 0 clustering acc 0.9981176470588236: correct 16968/17000
class 1 clustering acc 0.1476470588235294: correct 502/3400
Epoch: 5, train_loss: 0.8186, train_clustering_loss:  0.3823, train_error: 0.2753
class 0: acc 0.7888888888888889, correct 71/90
class 1: acc 0.625, correct 50/80
class 2: acc 0.5119047619047619, correct 43/84
class 3: acc 0.8205128205128205, correct 64/78
class 4: acc 0.8602150537634409, correct 80/93

Val Set, val_loss: 1.0735, val_error: 0.4400, auc: 0.7722
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.0275: correct 11/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5769230769230769, correct 15/26
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
Validation loss decreased (1.137367 --> 1.073507).  Saving model ...


batch 19, loss: 0.4534, instance_loss: 0.3529, weighted_loss: 0.4232, label: 0, bag_size: 1872
batch 39, loss: 1.5065, instance_loss: 0.3848, weighted_loss: 1.1700, label: 0, bag_size: 1034
batch 59, loss: 0.1222, instance_loss: 0.1988, weighted_loss: 0.1452, label: 3, bag_size: 729
batch 79, loss: 0.7722, instance_loss: 0.5431, weighted_loss: 0.7035, label: 1, bag_size: 700
batch 99, loss: 0.1268, instance_loss: 0.1778, weighted_loss: 0.1421, label: 4, bag_size: 764
batch 119, loss: 0.2449, instance_loss: 0.2788, weighted_loss: 0.2551, label: 4, bag_size: 1360
batch 139, loss: 0.4297, instance_loss: 0.3562, weighted_loss: 0.4077, label: 2, bag_size: 499
batch 159, loss: 0.7999, instance_loss: 0.5092, weighted_loss: 0.7127, label: 4, bag_size: 366
batch 179, loss: 0.3048, instance_loss: 0.3057, weighted_loss: 0.3050, label: 0, bag_size: 921
batch 199, loss: 0.1736, instance_loss: 0.3072, weighted_loss: 0.2137, label: 4, bag_size: 729
batch 219, loss: 0.5006, instance_loss: 0.3342, weighted_loss: 0.4507, label: 2, bag_size: 252
batch 239, loss: 0.2082, instance_loss: 0.3072, weighted_loss: 0.2379, label: 0, bag_size: 729
batch 259, loss: 0.0857, instance_loss: 0.3241, weighted_loss: 0.1572, label: 4, bag_size: 974
batch 279, loss: 0.6577, instance_loss: 0.4007, weighted_loss: 0.5806, label: 0, bag_size: 756
batch 299, loss: 0.8249, instance_loss: 0.3891, weighted_loss: 0.6941, label: 4, bag_size: 1357
batch 319, loss: 0.1219, instance_loss: 0.3280, weighted_loss: 0.1837, label: 3, bag_size: 936
batch 339, loss: 0.5830, instance_loss: 0.3173, weighted_loss: 0.5033, label: 4, bag_size: 729
batch 359, loss: 0.5487, instance_loss: 0.3972, weighted_loss: 0.5033, label: 2, bag_size: 317
batch 379, loss: 0.7697, instance_loss: 0.5008, weighted_loss: 0.6891, label: 4, bag_size: 366
batch 399, loss: 0.9258, instance_loss: 0.4325, weighted_loss: 0.7778, label: 4, bag_size: 297
batch 419, loss: 0.2551, instance_loss: 0.4025, weighted_loss: 0.2993, label: 0, bag_size: 729


class 0 clustering acc 0.9978823529411764: correct 16964/17000
class 1 clustering acc 0.1688235294117647: correct 574/3400
Epoch: 6, train_loss: 0.8084, train_clustering_loss:  0.3836, train_error: 0.2753
class 0: acc 0.782051282051282, correct 61/78
class 1: acc 0.5125, correct 41/80
class 2: acc 0.7373737373737373, correct 73/99
class 3: acc 0.7662337662337663, correct 59/77
class 4: acc 0.8131868131868132, correct 74/91

Val Set, val_loss: 1.1514, val_error: 0.4400, auc: 0.7758
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.045: correct 18/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8781, instance_loss: 0.5416, weighted_loss: 1.4771, label: 2, bag_size: 323
batch 39, loss: 0.0665, instance_loss: 0.2087, weighted_loss: 0.1091, label: 4, bag_size: 729
batch 59, loss: 0.0576, instance_loss: 0.1491, weighted_loss: 0.0851, label: 3, bag_size: 821
batch 79, loss: 1.7944, instance_loss: 0.5607, weighted_loss: 1.4243, label: 3, bag_size: 281
batch 99, loss: 1.0874, instance_loss: 0.4488, weighted_loss: 0.8958, label: 1, bag_size: 838
batch 119, loss: 1.8500, instance_loss: 0.6657, weighted_loss: 1.4947, label: 2, bag_size: 3236
batch 139, loss: 1.0256, instance_loss: 0.5340, weighted_loss: 0.8781, label: 0, bag_size: 729
batch 159, loss: 0.8144, instance_loss: 0.4298, weighted_loss: 0.6990, label: 2, bag_size: 480
batch 179, loss: 0.8828, instance_loss: 0.4531, weighted_loss: 0.7539, label: 0, bag_size: 759
batch 199, loss: 0.7840, instance_loss: 0.4247, weighted_loss: 0.6762, label: 0, bag_size: 718
batch 219, loss: 0.7361, instance_loss: 0.4448, weighted_loss: 0.6487, label: 2, bag_size: 358
batch 239, loss: 0.4921, instance_loss: 0.3789, weighted_loss: 0.4581, label: 0, bag_size: 1101
batch 259, loss: 0.0407, instance_loss: 0.0356, weighted_loss: 0.0392, label: 3, bag_size: 405
batch 279, loss: 2.9755, instance_loss: 0.7953, weighted_loss: 2.3214, label: 4, bag_size: 210
batch 299, loss: 0.4644, instance_loss: 0.3089, weighted_loss: 0.4177, label: 4, bag_size: 928
batch 319, loss: 1.0468, instance_loss: 0.4953, weighted_loss: 0.8813, label: 2, bag_size: 1141
batch 339, loss: 0.5490, instance_loss: 0.3349, weighted_loss: 0.4848, label: 2, bag_size: 461
batch 359, loss: 1.7205, instance_loss: 0.4576, weighted_loss: 1.3417, label: 2, bag_size: 1123
batch 379, loss: 1.2417, instance_loss: 0.5991, weighted_loss: 1.0490, label: 4, bag_size: 366
batch 399, loss: 0.6590, instance_loss: 0.3852, weighted_loss: 0.5768, label: 2, bag_size: 1306
batch 419, loss: 0.2783, instance_loss: 0.1831, weighted_loss: 0.2497, label: 3, bag_size: 316


class 0 clustering acc 0.9968235294117647: correct 16946/17000
class 1 clustering acc 0.23058823529411765: correct 784/3400
Epoch: 7, train_loss: 0.7449, train_clustering_loss:  0.3635, train_error: 0.2612
class 0: acc 0.8529411764705882, correct 87/102
class 1: acc 0.5735294117647058, correct 39/68
class 2: acc 0.5569620253164557, correct 44/79
class 3: acc 0.8247422680412371, correct 80/97
class 4: acc 0.810126582278481, correct 64/79

Val Set, val_loss: 1.1247, val_error: 0.4600, auc: 0.7486
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.0325: correct 13/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.6538461538461539, correct 17/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2662, instance_loss: 0.4343, weighted_loss: 1.0167, label: 1, bag_size: 1651
batch 39, loss: 0.0839, instance_loss: 0.3363, weighted_loss: 0.1596, label: 3, bag_size: 936
batch 59, loss: 0.1867, instance_loss: 0.1630, weighted_loss: 0.1796, label: 1, bag_size: 1191
batch 79, loss: 0.3648, instance_loss: 0.3932, weighted_loss: 0.3733, label: 1, bag_size: 102
batch 99, loss: 0.2399, instance_loss: 0.1250, weighted_loss: 0.2054, label: 3, bag_size: 729
batch 119, loss: 1.3532, instance_loss: 0.4883, weighted_loss: 1.0938, label: 4, bag_size: 533
batch 139, loss: 2.2287, instance_loss: 0.6156, weighted_loss: 1.7448, label: 0, bag_size: 245
batch 159, loss: 0.0867, instance_loss: 0.0760, weighted_loss: 0.0835, label: 3, bag_size: 556
batch 179, loss: 1.7845, instance_loss: 0.5802, weighted_loss: 1.4232, label: 1, bag_size: 1724
batch 199, loss: 0.1254, instance_loss: 0.2568, weighted_loss: 0.1648, label: 0, bag_size: 1012
batch 219, loss: 1.2168, instance_loss: 0.5262, weighted_loss: 1.0096, label: 4, bag_size: 533
batch 239, loss: 0.2688, instance_loss: 0.2788, weighted_loss: 0.2718, label: 0, bag_size: 1135
batch 259, loss: 0.6233, instance_loss: 0.3893, weighted_loss: 0.5531, label: 4, bag_size: 729
batch 279, loss: 0.6105, instance_loss: 0.3604, weighted_loss: 0.5355, label: 2, bag_size: 1653
batch 299, loss: 0.4385, instance_loss: 0.4231, weighted_loss: 0.4339, label: 4, bag_size: 928
batch 319, loss: 0.6676, instance_loss: 0.3762, weighted_loss: 0.5802, label: 2, bag_size: 682
batch 339, loss: 1.4860, instance_loss: 0.5101, weighted_loss: 1.1933, label: 3, bag_size: 706
batch 359, loss: 0.0280, instance_loss: 0.0299, weighted_loss: 0.0286, label: 3, bag_size: 405
batch 379, loss: 0.2392, instance_loss: 0.2661, weighted_loss: 0.2473, label: 4, bag_size: 1278
batch 399, loss: 2.6885, instance_loss: 0.7518, weighted_loss: 2.1075, label: 0, bag_size: 801
batch 419, loss: 1.1896, instance_loss: 0.4671, weighted_loss: 0.9729, label: 1, bag_size: 925


class 0 clustering acc 0.9954705882352941: correct 16923/17000
class 1 clustering acc 0.25558823529411767: correct 869/3400
Epoch: 8, train_loss: 0.6694, train_clustering_loss:  0.3563, train_error: 0.2494
class 0: acc 0.8421052631578947, correct 80/95
class 1: acc 0.6436781609195402, correct 56/87
class 2: acc 0.6071428571428571, correct 51/84
class 3: acc 0.8372093023255814, correct 72/86
class 4: acc 0.821917808219178, correct 60/73

Val Set, val_loss: 1.2482, val_error: 0.5200, auc: 0.7310
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.0625: correct 25/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0597, instance_loss: 0.2686, weighted_loss: 0.1224, label: 4, bag_size: 1474
batch 39, loss: 0.6534, instance_loss: 0.4013, weighted_loss: 0.5778, label: 2, bag_size: 1148
batch 59, loss: 0.2046, instance_loss: 0.3897, weighted_loss: 0.2601, label: 3, bag_size: 230
batch 79, loss: 1.0550, instance_loss: 0.5266, weighted_loss: 0.8965, label: 0, bag_size: 1527
batch 99, loss: 0.7900, instance_loss: 0.4165, weighted_loss: 0.6779, label: 0, bag_size: 410
batch 119, loss: 1.2324, instance_loss: 0.5717, weighted_loss: 1.0342, label: 2, bag_size: 916
batch 139, loss: 0.6381, instance_loss: 0.3169, weighted_loss: 0.5417, label: 1, bag_size: 1144
batch 159, loss: 0.7979, instance_loss: 0.3658, weighted_loss: 0.6683, label: 4, bag_size: 625
batch 179, loss: 0.3992, instance_loss: 0.3388, weighted_loss: 0.3811, label: 0, bag_size: 756
batch 199, loss: 0.8415, instance_loss: 0.4599, weighted_loss: 0.7270, label: 2, bag_size: 508
batch 219, loss: 0.0346, instance_loss: 0.1637, weighted_loss: 0.0733, label: 4, bag_size: 729
batch 239, loss: 1.5883, instance_loss: 0.4771, weighted_loss: 1.2549, label: 4, bag_size: 436
batch 259, loss: 1.6806, instance_loss: 0.6247, weighted_loss: 1.3638, label: 1, bag_size: 535
batch 279, loss: 0.7679, instance_loss: 0.2805, weighted_loss: 0.6217, label: 3, bag_size: 533
batch 299, loss: 0.0745, instance_loss: 0.2338, weighted_loss: 0.1223, label: 0, bag_size: 729
batch 319, loss: 1.0126, instance_loss: 0.4624, weighted_loss: 0.8475, label: 2, bag_size: 237
batch 339, loss: 0.3604, instance_loss: 0.2918, weighted_loss: 0.3398, label: 0, bag_size: 1527
batch 359, loss: 0.3079, instance_loss: 0.3032, weighted_loss: 0.3065, label: 2, bag_size: 317
batch 379, loss: 0.2812, instance_loss: 0.2498, weighted_loss: 0.2718, label: 1, bag_size: 696
batch 399, loss: 0.0642, instance_loss: 0.1858, weighted_loss: 0.1007, label: 3, bag_size: 729
batch 419, loss: 1.2500, instance_loss: 0.3931, weighted_loss: 0.9929, label: 1, bag_size: 1646


class 0 clustering acc 0.9944705882352941: correct 16906/17000
class 1 clustering acc 0.24558823529411763: correct 835/3400
Epoch: 9, train_loss: 0.6745, train_clustering_loss:  0.3606, train_error: 0.2424
class 0: acc 0.8607594936708861, correct 68/79
class 1: acc 0.6116504854368932, correct 63/103
class 2: acc 0.6629213483146067, correct 59/89
class 3: acc 0.8714285714285714, correct 61/70
class 4: acc 0.8452380952380952, correct 71/84

Val Set, val_loss: 1.2574, val_error: 0.5200, auc: 0.7169
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.09: correct 36/400
class 0: acc 0.5, correct 3/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1164, instance_loss: 0.2015, weighted_loss: 0.1419, label: 4, bag_size: 773
batch 39, loss: 0.6141, instance_loss: 0.3361, weighted_loss: 0.5307, label: 0, bag_size: 868
batch 59, loss: 0.0162, instance_loss: 0.0232, weighted_loss: 0.0183, label: 3, bag_size: 405
batch 79, loss: 0.0373, instance_loss: 0.1222, weighted_loss: 0.0627, label: 4, bag_size: 729
batch 99, loss: 0.0502, instance_loss: 0.0762, weighted_loss: 0.0580, label: 3, bag_size: 729
batch 119, loss: 0.1260, instance_loss: 0.1151, weighted_loss: 0.1227, label: 1, bag_size: 847
batch 139, loss: 0.2488, instance_loss: 0.2597, weighted_loss: 0.2521, label: 1, bag_size: 913
batch 159, loss: 2.2373, instance_loss: 0.6378, weighted_loss: 1.7575, label: 1, bag_size: 1172
batch 179, loss: 1.5473, instance_loss: 0.5215, weighted_loss: 1.2396, label: 1, bag_size: 269
batch 199, loss: 0.0146, instance_loss: 0.0883, weighted_loss: 0.0367, label: 4, bag_size: 711
batch 219, loss: 0.1630, instance_loss: 0.2940, weighted_loss: 0.2023, label: 4, bag_size: 675
batch 239, loss: 1.1426, instance_loss: 0.4983, weighted_loss: 0.9493, label: 1, bag_size: 786
batch 259, loss: 0.7928, instance_loss: 0.3899, weighted_loss: 0.6719, label: 2, bag_size: 323
batch 279, loss: 0.0364, instance_loss: 0.0728, weighted_loss: 0.0474, label: 3, bag_size: 729
batch 299, loss: 1.3832, instance_loss: 0.6102, weighted_loss: 1.1513, label: 1, bag_size: 868
batch 319, loss: 1.1521, instance_loss: 0.5281, weighted_loss: 0.9649, label: 1, bag_size: 660
batch 339, loss: 2.1495, instance_loss: 0.5843, weighted_loss: 1.6799, label: 2, bag_size: 110
batch 359, loss: 0.2940, instance_loss: 0.2773, weighted_loss: 0.2890, label: 0, bag_size: 413
batch 379, loss: 0.0167, instance_loss: 0.2006, weighted_loss: 0.0718, label: 4, bag_size: 711
batch 399, loss: 0.3934, instance_loss: 0.3688, weighted_loss: 0.3860, label: 2, bag_size: 1053
batch 419, loss: 2.6442, instance_loss: 0.7869, weighted_loss: 2.0870, label: 2, bag_size: 934


class 0 clustering acc 0.992764705882353: correct 16877/17000
class 1 clustering acc 0.2926470588235294: correct 995/3400
Epoch: 10, train_loss: 0.6071, train_clustering_loss:  0.3510, train_error: 0.2282
class 0: acc 0.8837209302325582, correct 76/86
class 1: acc 0.6728971962616822, correct 72/107
class 2: acc 0.6111111111111112, correct 44/72
class 3: acc 0.8837209302325582, correct 76/86
class 4: acc 0.8108108108108109, correct 60/74

Val Set, val_loss: 1.2589, val_error: 0.4600, auc: 0.7520
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.0925: correct 37/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0206, instance_loss: 0.2339, weighted_loss: 0.0846, label: 4, bag_size: 524
batch 39, loss: 1.3739, instance_loss: 0.6310, weighted_loss: 1.1510, label: 2, bag_size: 1128
batch 59, loss: 0.0230, instance_loss: 0.0913, weighted_loss: 0.0435, label: 3, bag_size: 821
batch 79, loss: 0.3786, instance_loss: 0.3116, weighted_loss: 0.3585, label: 2, bag_size: 1569
batch 99, loss: 0.0077, instance_loss: 0.1245, weighted_loss: 0.0427, label: 4, bag_size: 646
batch 119, loss: 0.0337, instance_loss: 0.0629, weighted_loss: 0.0424, label: 3, bag_size: 305
batch 139, loss: 2.0354, instance_loss: 0.6406, weighted_loss: 1.6170, label: 2, bag_size: 959
batch 159, loss: 0.3213, instance_loss: 0.2974, weighted_loss: 0.3142, label: 2, bag_size: 499
batch 179, loss: 0.4883, instance_loss: 0.3106, weighted_loss: 0.4350, label: 1, bag_size: 598
batch 199, loss: 1.2332, instance_loss: 0.6183, weighted_loss: 1.0487, label: 2, bag_size: 1700
batch 219, loss: 0.3018, instance_loss: 0.3707, weighted_loss: 0.3225, label: 2, bag_size: 636
batch 239, loss: 0.0626, instance_loss: 0.2718, weighted_loss: 0.1254, label: 4, bag_size: 826
batch 259, loss: 1.5339, instance_loss: 0.6075, weighted_loss: 1.2560, label: 4, bag_size: 1337
batch 279, loss: 1.7871, instance_loss: 0.6305, weighted_loss: 1.4401, label: 1, bag_size: 660
batch 299, loss: 0.2333, instance_loss: 0.4733, weighted_loss: 0.3053, label: 4, bag_size: 663
batch 319, loss: 0.1901, instance_loss: 0.4409, weighted_loss: 0.2653, label: 0, bag_size: 729
batch 339, loss: 1.6023, instance_loss: 0.6398, weighted_loss: 1.3135, label: 1, bag_size: 917
batch 359, loss: 0.7043, instance_loss: 0.4298, weighted_loss: 0.6220, label: 2, bag_size: 758
batch 379, loss: 0.7193, instance_loss: 0.4635, weighted_loss: 0.6425, label: 2, bag_size: 1404
batch 399, loss: 0.1068, instance_loss: 0.2114, weighted_loss: 0.1382, label: 1, bag_size: 1239
batch 419, loss: 0.0665, instance_loss: 0.2684, weighted_loss: 0.1271, label: 4, bag_size: 388


class 0 clustering acc 0.9931764705882353: correct 16884/17000
class 1 clustering acc 0.34147058823529414: correct 1161/3400
Epoch: 11, train_loss: 0.5774, train_clustering_loss:  0.3353, train_error: 0.2141
class 0: acc 0.8876404494382022, correct 79/89
class 1: acc 0.6222222222222222, correct 56/90
class 2: acc 0.6447368421052632, correct 49/76
class 3: acc 0.9176470588235294, correct 78/85
class 4: acc 0.8470588235294118, correct 72/85

Val Set, val_loss: 1.0836, val_error: 0.4400, auc: 0.7841
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.1025: correct 41/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5769230769230769, correct 15/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2968, instance_loss: 0.2368, weighted_loss: 0.2788, label: 0, bag_size: 1301
batch 39, loss: 0.4950, instance_loss: 0.3839, weighted_loss: 0.4616, label: 2, bag_size: 1289
batch 59, loss: 2.0790, instance_loss: 0.6156, weighted_loss: 1.6400, label: 2, bag_size: 959
batch 79, loss: 0.4464, instance_loss: 0.3118, weighted_loss: 0.4060, label: 2, bag_size: 701
batch 99, loss: 0.0592, instance_loss: 0.0960, weighted_loss: 0.0702, label: 0, bag_size: 933
batch 119, loss: 0.0221, instance_loss: 0.2404, weighted_loss: 0.0876, label: 3, bag_size: 936
batch 139, loss: 0.9873, instance_loss: 0.4028, weighted_loss: 0.8120, label: 2, bag_size: 237
batch 159, loss: 0.2179, instance_loss: 0.0999, weighted_loss: 0.1825, label: 3, bag_size: 729
batch 179, loss: 1.2680, instance_loss: 0.3789, weighted_loss: 1.0012, label: 1, bag_size: 1080
batch 199, loss: 0.1602, instance_loss: 0.1985, weighted_loss: 0.1717, label: 0, bag_size: 807
batch 219, loss: 0.0071, instance_loss: 0.0327, weighted_loss: 0.0148, label: 3, bag_size: 451
batch 239, loss: 0.4975, instance_loss: 0.2762, weighted_loss: 0.4311, label: 1, bag_size: 399
batch 259, loss: 0.2678, instance_loss: 0.8065, weighted_loss: 0.4294, label: 3, bag_size: 607
batch 279, loss: 0.6715, instance_loss: 0.5077, weighted_loss: 0.6223, label: 4, bag_size: 590
batch 299, loss: 1.8245, instance_loss: 0.8876, weighted_loss: 1.5434, label: 2, bag_size: 916
batch 319, loss: 0.5207, instance_loss: 0.3194, weighted_loss: 0.4603, label: 2, bag_size: 373
batch 339, loss: 0.2444, instance_loss: 0.3958, weighted_loss: 0.2898, label: 0, bag_size: 729
batch 359, loss: 0.4682, instance_loss: 0.3002, weighted_loss: 0.4178, label: 0, bag_size: 371
batch 379, loss: 0.1777, instance_loss: 0.1631, weighted_loss: 0.1733, label: 1, bag_size: 994
batch 399, loss: 0.3506, instance_loss: 0.3336, weighted_loss: 0.3455, label: 0, bag_size: 371
batch 419, loss: 1.3681, instance_loss: 0.5243, weighted_loss: 1.1149, label: 1, bag_size: 700


class 0 clustering acc 0.993: correct 16881/17000
class 1 clustering acc 0.3173529411764706: correct 1079/3400
Epoch: 12, train_loss: 0.5265, train_clustering_loss:  0.3412, train_error: 0.1953
class 0: acc 0.9111111111111111, correct 82/90
class 1: acc 0.6736842105263158, correct 64/95
class 2: acc 0.6588235294117647, correct 56/85
class 3: acc 0.9259259259259259, correct 75/81
class 4: acc 0.8783783783783784, correct 65/74

Val Set, val_loss: 1.2832, val_error: 0.4600, auc: 0.7551
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.1025: correct 41/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5384615384615384, correct 14/26
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0132, instance_loss: 0.1170, weighted_loss: 0.0443, label: 3, bag_size: 729
batch 39, loss: 1.4921, instance_loss: 0.5262, weighted_loss: 1.2023, label: 1, bag_size: 875
batch 59, loss: 0.3203, instance_loss: 0.3319, weighted_loss: 0.3238, label: 2, bag_size: 202
batch 79, loss: 0.0095, instance_loss: 0.1794, weighted_loss: 0.0605, label: 4, bag_size: 729
batch 99, loss: 0.0303, instance_loss: 0.1107, weighted_loss: 0.0544, label: 3, bag_size: 729
batch 119, loss: 0.6161, instance_loss: 0.3424, weighted_loss: 0.5340, label: 0, bag_size: 410
batch 139, loss: 0.3178, instance_loss: 0.2931, weighted_loss: 0.3104, label: 1, bag_size: 356
batch 159, loss: 0.5837, instance_loss: 0.3918, weighted_loss: 0.5261, label: 2, bag_size: 1700
batch 179, loss: 0.3168, instance_loss: 0.2128, weighted_loss: 0.2856, label: 1, bag_size: 682
batch 199, loss: 0.2455, instance_loss: 0.2284, weighted_loss: 0.2404, label: 1, bag_size: 834
batch 219, loss: 0.2144, instance_loss: 0.3740, weighted_loss: 0.2623, label: 4, bag_size: 928
batch 239, loss: 0.0579, instance_loss: 0.2641, weighted_loss: 0.1197, label: 0, bag_size: 729
batch 259, loss: 0.2911, instance_loss: 0.2122, weighted_loss: 0.2674, label: 1, bag_size: 790
batch 279, loss: 0.0278, instance_loss: 0.0377, weighted_loss: 0.0308, label: 3, bag_size: 729
batch 299, loss: 0.3773, instance_loss: 0.2729, weighted_loss: 0.3460, label: 1, bag_size: 320
batch 319, loss: 0.6939, instance_loss: 0.3577, weighted_loss: 0.5931, label: 0, bag_size: 410
batch 339, loss: 1.0763, instance_loss: 0.4657, weighted_loss: 0.8931, label: 1, bag_size: 898
batch 359, loss: 0.0631, instance_loss: 0.1428, weighted_loss: 0.0870, label: 0, bag_size: 982
batch 379, loss: 0.2151, instance_loss: 0.1623, weighted_loss: 0.1992, label: 0, bag_size: 476
batch 399, loss: 0.1989, instance_loss: 0.2394, weighted_loss: 0.2111, label: 1, bag_size: 356
batch 419, loss: 1.0145, instance_loss: 0.7148, weighted_loss: 0.9246, label: 3, bag_size: 281


class 0 clustering acc 0.9924117647058823: correct 16871/17000
class 1 clustering acc 0.3623529411764706: correct 1232/3400
Epoch: 13, train_loss: 0.5320, train_clustering_loss:  0.3211, train_error: 0.1906
class 0: acc 0.872093023255814, correct 75/86
class 1: acc 0.6063829787234043, correct 57/94
class 2: acc 0.7471264367816092, correct 65/87
class 3: acc 0.9655172413793104, correct 84/87
class 4: acc 0.8873239436619719, correct 63/71

Val Set, val_loss: 1.0618, val_error: 0.3000, auc: 0.7697
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.1675: correct 67/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.8461538461538461, correct 22/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
Validation loss decreased (1.073507 --> 1.061850).  Saving model ...


batch 19, loss: 0.2785, instance_loss: 0.2746, weighted_loss: 0.2774, label: 4, bag_size: 625
batch 39, loss: 0.9626, instance_loss: 0.4274, weighted_loss: 0.8021, label: 3, bag_size: 706
batch 59, loss: 0.0281, instance_loss: 0.0994, weighted_loss: 0.0495, label: 4, bag_size: 790
batch 79, loss: 1.1939, instance_loss: 0.5728, weighted_loss: 1.0076, label: 1, bag_size: 1144
batch 99, loss: 0.6496, instance_loss: 0.3182, weighted_loss: 0.5502, label: 0, bag_size: 1301
batch 119, loss: 0.0907, instance_loss: 0.3011, weighted_loss: 0.1538, label: 4, bag_size: 729
batch 139, loss: 0.0125, instance_loss: 0.2504, weighted_loss: 0.0839, label: 4, bag_size: 729
batch 159, loss: 0.4719, instance_loss: 0.3490, weighted_loss: 0.4350, label: 2, bag_size: 1514
batch 179, loss: 0.0428, instance_loss: 0.5488, weighted_loss: 0.1946, label: 4, bag_size: 882
batch 199, loss: 0.0257, instance_loss: 0.3624, weighted_loss: 0.1267, label: 4, bag_size: 675
batch 219, loss: 0.1036, instance_loss: 0.6520, weighted_loss: 0.2682, label: 4, bag_size: 542
batch 239, loss: 0.7920, instance_loss: 0.4132, weighted_loss: 0.6784, label: 2, bag_size: 878
batch 259, loss: 0.9535, instance_loss: 0.4635, weighted_loss: 0.8065, label: 1, bag_size: 959
batch 279, loss: 0.0828, instance_loss: 0.1577, weighted_loss: 0.1053, label: 0, bag_size: 371
batch 299, loss: 0.0300, instance_loss: 0.1141, weighted_loss: 0.0553, label: 0, bag_size: 729
batch 319, loss: 0.0352, instance_loss: 0.1362, weighted_loss: 0.0655, label: 3, bag_size: 729
batch 339, loss: 0.0587, instance_loss: 0.1014, weighted_loss: 0.0715, label: 0, bag_size: 1196
batch 359, loss: 0.0447, instance_loss: 0.2288, weighted_loss: 0.1000, label: 1, bag_size: 1376
batch 379, loss: 1.7463, instance_loss: 0.5658, weighted_loss: 1.3921, label: 2, bag_size: 356
batch 399, loss: 0.0022, instance_loss: 0.0419, weighted_loss: 0.0141, label: 3, bag_size: 1172
batch 419, loss: 0.0205, instance_loss: 0.0635, weighted_loss: 0.0334, label: 3, bag_size: 729


class 0 clustering acc 0.9918235294117647: correct 16861/17000
class 1 clustering acc 0.3947058823529412: correct 1342/3400
Epoch: 14, train_loss: 0.4468, train_clustering_loss:  0.3134, train_error: 0.1529
class 0: acc 0.8863636363636364, correct 78/88
class 1: acc 0.6704545454545454, correct 59/88
class 2: acc 0.7162162162162162, correct 53/74
class 3: acc 0.9759036144578314, correct 81/83
class 4: acc 0.967391304347826, correct 89/92

Val Set, val_loss: 1.3154, val_error: 0.5000, auc: 0.7734
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.155: correct 62/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0146, instance_loss: 0.0335, weighted_loss: 0.0203, label: 0, bag_size: 1466
batch 39, loss: 0.1622, instance_loss: 0.2612, weighted_loss: 0.1919, label: 4, bag_size: 790
batch 59, loss: 0.0691, instance_loss: 0.1678, weighted_loss: 0.0987, label: 1, bag_size: 886
batch 79, loss: 0.0139, instance_loss: 0.1297, weighted_loss: 0.0486, label: 3, bag_size: 849
batch 99, loss: 0.0986, instance_loss: 0.0722, weighted_loss: 0.0907, label: 3, bag_size: 316
batch 119, loss: 0.4852, instance_loss: 0.2709, weighted_loss: 0.4209, label: 2, bag_size: 461
batch 139, loss: 1.0888, instance_loss: 0.4404, weighted_loss: 0.8943, label: 4, bag_size: 533
batch 159, loss: 0.7100, instance_loss: 0.5115, weighted_loss: 0.6505, label: 2, bag_size: 1139
batch 179, loss: 0.1441, instance_loss: 0.1051, weighted_loss: 0.1324, label: 3, bag_size: 316
batch 199, loss: 0.1741, instance_loss: 0.3292, weighted_loss: 0.2207, label: 2, bag_size: 317
batch 219, loss: 0.0088, instance_loss: 0.0293, weighted_loss: 0.0149, label: 0, bag_size: 898
batch 239, loss: 0.0248, instance_loss: 0.0897, weighted_loss: 0.0443, label: 0, bag_size: 921
batch 259, loss: 1.3652, instance_loss: 0.4122, weighted_loss: 1.0793, label: 2, bag_size: 1259
batch 279, loss: 1.4060, instance_loss: 0.8362, weighted_loss: 1.2350, label: 3, bag_size: 281
batch 299, loss: 0.3619, instance_loss: 0.3923, weighted_loss: 0.3710, label: 3, bag_size: 671
batch 319, loss: 0.0206, instance_loss: 0.0807, weighted_loss: 0.0386, label: 4, bag_size: 729
batch 339, loss: 0.2576, instance_loss: 0.3627, weighted_loss: 0.2891, label: 0, bag_size: 466
batch 359, loss: 0.0382, instance_loss: 0.1767, weighted_loss: 0.0797, label: 4, bag_size: 636
batch 379, loss: 0.0319, instance_loss: 0.3223, weighted_loss: 0.1190, label: 0, bag_size: 729
batch 399, loss: 0.0149, instance_loss: 0.0996, weighted_loss: 0.0403, label: 3, bag_size: 841
batch 419, loss: 0.0298, instance_loss: 0.0315, weighted_loss: 0.0303, label: 3, bag_size: 405


class 0 clustering acc 0.9892941176470588: correct 16818/17000
class 1 clustering acc 0.4476470588235294: correct 1522/3400
Epoch: 15, train_loss: 0.4422, train_clustering_loss:  0.2984, train_error: 0.1600
class 0: acc 0.8712871287128713, correct 88/101
class 1: acc 0.75, correct 54/72
class 2: acc 0.7142857142857143, correct 55/77
class 3: acc 0.9767441860465116, correct 84/86
class 4: acc 0.8539325842696629, correct 76/89

Val Set, val_loss: 1.2620, val_error: 0.4600, auc: 0.7785
class 0 clustering acc 0.9665: correct 1933/2000
class 1 clustering acc 0.1425: correct 57/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5384615384615384, correct 14/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.2680, instance_loss: 0.6711, weighted_loss: 1.7890, label: 1, bag_size: 770
batch 39, loss: 0.2878, instance_loss: 0.4425, weighted_loss: 0.3342, label: 1, bag_size: 648
batch 59, loss: 0.1890, instance_loss: 0.2920, weighted_loss: 0.2199, label: 0, bag_size: 756
batch 79, loss: 0.0367, instance_loss: 0.1524, weighted_loss: 0.0714, label: 4, bag_size: 729
batch 99, loss: 0.0330, instance_loss: 0.1312, weighted_loss: 0.0625, label: 0, bag_size: 515
batch 119, loss: 0.4801, instance_loss: 0.2980, weighted_loss: 0.4255, label: 1, bag_size: 869
batch 139, loss: 0.9941, instance_loss: 0.5062, weighted_loss: 0.8477, label: 1, bag_size: 660
batch 159, loss: 0.1386, instance_loss: 0.3247, weighted_loss: 0.1944, label: 0, bag_size: 1012
batch 179, loss: 0.8296, instance_loss: 0.5065, weighted_loss: 0.7327, label: 1, bag_size: 470
batch 199, loss: 0.1306, instance_loss: 0.3306, weighted_loss: 0.1906, label: 3, bag_size: 305
batch 219, loss: 0.1015, instance_loss: 0.1512, weighted_loss: 0.1164, label: 3, bag_size: 729
batch 239, loss: 0.0077, instance_loss: 0.3014, weighted_loss: 0.0958, label: 4, bag_size: 729
batch 259, loss: 0.0493, instance_loss: 0.0575, weighted_loss: 0.0518, label: 3, bag_size: 556
batch 279, loss: 0.6071, instance_loss: 0.5182, weighted_loss: 0.5805, label: 1, bag_size: 711
batch 299, loss: 0.0331, instance_loss: 0.1172, weighted_loss: 0.0584, label: 3, bag_size: 821
batch 319, loss: 0.5475, instance_loss: 0.4566, weighted_loss: 0.5202, label: 2, bag_size: 1164
batch 339, loss: 0.2041, instance_loss: 0.2521, weighted_loss: 0.2185, label: 1, bag_size: 949
batch 359, loss: 0.0765, instance_loss: 0.2031, weighted_loss: 0.1145, label: 4, bag_size: 826
batch 379, loss: 2.3379, instance_loss: 0.8167, weighted_loss: 1.8815, label: 2, bag_size: 1043
batch 399, loss: 0.3317, instance_loss: 0.2332, weighted_loss: 0.3022, label: 0, bag_size: 1247
batch 419, loss: 0.0742, instance_loss: 0.1027, weighted_loss: 0.0828, label: 3, bag_size: 729


class 0 clustering acc 0.9872941176470589: correct 16784/17000
class 1 clustering acc 0.3985294117647059: correct 1355/3400
Epoch: 16, train_loss: 0.5434, train_clustering_loss:  0.3294, train_error: 0.1741
class 0: acc 0.9263157894736842, correct 88/95
class 1: acc 0.6808510638297872, correct 64/94
class 2: acc 0.7142857142857143, correct 60/84
class 3: acc 0.9347826086956522, correct 86/92
class 4: acc 0.8833333333333333, correct 53/60

Val Set, val_loss: 1.3975, val_error: 0.5200, auc: 0.7360
class 0 clustering acc 0.9665: correct 1933/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.4230769230769231, correct 11/26
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4649, instance_loss: 0.2570, weighted_loss: 0.4025, label: 1, bag_size: 746
batch 39, loss: 0.0382, instance_loss: 0.3181, weighted_loss: 0.1222, label: 3, bag_size: 936
batch 59, loss: 0.0717, instance_loss: 0.0987, weighted_loss: 0.0798, label: 3, bag_size: 1291
batch 79, loss: 0.3721, instance_loss: 0.3067, weighted_loss: 0.3525, label: 0, bag_size: 1247
batch 99, loss: 1.5157, instance_loss: 0.6221, weighted_loss: 1.2476, label: 2, bag_size: 629
batch 119, loss: 0.4211, instance_loss: 0.3189, weighted_loss: 0.3905, label: 2, bag_size: 883
batch 139, loss: 0.1530, instance_loss: 0.2624, weighted_loss: 0.1858, label: 4, bag_size: 1360
batch 159, loss: 0.0149, instance_loss: 0.1124, weighted_loss: 0.0441, label: 4, bag_size: 729
batch 179, loss: 0.6239, instance_loss: 0.4282, weighted_loss: 0.5652, label: 2, bag_size: 317
batch 199, loss: 0.0364, instance_loss: 0.1799, weighted_loss: 0.0795, label: 4, bag_size: 826
batch 219, loss: 1.6597, instance_loss: 0.4634, weighted_loss: 1.3008, label: 1, bag_size: 1646
batch 239, loss: 0.2753, instance_loss: 0.2939, weighted_loss: 0.2809, label: 0, bag_size: 1061
batch 259, loss: 0.3159, instance_loss: 0.5247, weighted_loss: 0.3785, label: 4, bag_size: 366
batch 279, loss: 0.7295, instance_loss: 0.5151, weighted_loss: 0.6652, label: 2, bag_size: 1259
batch 299, loss: 0.4547, instance_loss: 0.3924, weighted_loss: 0.4360, label: 2, bag_size: 469
batch 319, loss: 0.1074, instance_loss: 0.1507, weighted_loss: 0.1204, label: 0, bag_size: 760
batch 339, loss: 0.0678, instance_loss: 0.1252, weighted_loss: 0.0850, label: 3, bag_size: 729
batch 359, loss: 0.5789, instance_loss: 0.4164, weighted_loss: 0.5301, label: 2, bag_size: 358
batch 379, loss: 0.0351, instance_loss: 0.1656, weighted_loss: 0.0742, label: 4, bag_size: 826
batch 399, loss: 0.0013, instance_loss: 0.0754, weighted_loss: 0.0235, label: 3, bag_size: 1291
batch 419, loss: 4.4591, instance_loss: 1.3757, weighted_loss: 3.5341, label: 1, bag_size: 1799


class 0 clustering acc 0.9905294117647059: correct 16839/17000
class 1 clustering acc 0.3961764705882353: correct 1347/3400
Epoch: 17, train_loss: 0.4660, train_clustering_loss:  0.3166, train_error: 0.1694
class 0: acc 0.8611111111111112, correct 62/72
class 1: acc 0.6666666666666666, correct 64/96
class 2: acc 0.7323943661971831, correct 52/71
class 3: acc 0.9807692307692307, correct 102/104
class 4: acc 0.8902439024390244, correct 73/82

Val Set, val_loss: 1.4696, val_error: 0.5800, auc: 0.7542
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.12: correct 48/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.3076923076923077, correct 8/26
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0043, instance_loss: 0.0393, weighted_loss: 0.0148, label: 3, bag_size: 729
batch 39, loss: 0.7933, instance_loss: 0.5295, weighted_loss: 0.7142, label: 2, bag_size: 373
batch 59, loss: 0.3435, instance_loss: 0.3642, weighted_loss: 0.3497, label: 2, bag_size: 1235
batch 79, loss: 0.3441, instance_loss: 0.3402, weighted_loss: 0.3429, label: 2, bag_size: 482
batch 99, loss: 0.0709, instance_loss: 0.1277, weighted_loss: 0.0880, label: 0, bag_size: 1255
batch 119, loss: 0.0399, instance_loss: 0.0543, weighted_loss: 0.0442, label: 3, bag_size: 729
batch 139, loss: 0.4721, instance_loss: 0.4815, weighted_loss: 0.4749, label: 3, bag_size: 281
batch 159, loss: 0.1483, instance_loss: 0.2330, weighted_loss: 0.1737, label: 3, bag_size: 791
batch 179, loss: 1.2157, instance_loss: 0.5213, weighted_loss: 1.0074, label: 2, bag_size: 1197
batch 199, loss: 0.8956, instance_loss: 0.5238, weighted_loss: 0.7841, label: 2, bag_size: 1218
batch 219, loss: 0.4630, instance_loss: 0.3807, weighted_loss: 0.4383, label: 2, bag_size: 806
batch 239, loss: 0.0221, instance_loss: 0.1031, weighted_loss: 0.0464, label: 4, bag_size: 729
batch 259, loss: 1.6508, instance_loss: 0.7512, weighted_loss: 1.3809, label: 4, bag_size: 210
batch 279, loss: 0.6924, instance_loss: 0.3209, weighted_loss: 0.5810, label: 2, bag_size: 806
batch 299, loss: 2.1912, instance_loss: 0.6604, weighted_loss: 1.7320, label: 2, bag_size: 1043
batch 319, loss: 0.3469, instance_loss: 0.3986, weighted_loss: 0.3624, label: 2, bag_size: 1052
batch 339, loss: 0.3179, instance_loss: 0.3297, weighted_loss: 0.3215, label: 4, bag_size: 533
batch 359, loss: 0.1835, instance_loss: 0.2148, weighted_loss: 0.1929, label: 2, bag_size: 482
batch 379, loss: 0.2631, instance_loss: 0.3682, weighted_loss: 0.2947, label: 0, bag_size: 1527
batch 399, loss: 0.1257, instance_loss: 0.6482, weighted_loss: 0.2824, label: 3, bag_size: 283
batch 419, loss: 0.4862, instance_loss: 0.3712, weighted_loss: 0.4517, label: 2, bag_size: 358


class 0 clustering acc 0.9904117647058823: correct 16837/17000
class 1 clustering acc 0.43176470588235294: correct 1468/3400
Epoch: 18, train_loss: 0.3679, train_clustering_loss:  0.3007, train_error: 0.1200
class 0: acc 0.9318181818181818, correct 82/88
class 1: acc 0.7183098591549296, correct 51/71
class 2: acc 0.788235294117647, correct 67/85
class 3: acc 0.9782608695652174, correct 90/92
class 4: acc 0.9438202247191011, correct 84/89

Val Set, val_loss: 1.3130, val_error: 0.4200, auc: 0.7562
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.135: correct 54/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6153846153846154, correct 16/26
class 3: acc 0.5, correct 3/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 5 out of 20


batch 19, loss: 2.4861, instance_loss: 0.6998, weighted_loss: 1.9502, label: 2, bag_size: 194
batch 39, loss: 1.3054, instance_loss: 0.7472, weighted_loss: 1.1379, label: 4, bag_size: 210
batch 59, loss: 0.8692, instance_loss: 0.4041, weighted_loss: 0.7296, label: 1, bag_size: 1646
batch 79, loss: 0.5140, instance_loss: 0.3549, weighted_loss: 0.4662, label: 2, bag_size: 1123
batch 99, loss: 0.5175, instance_loss: 0.3237, weighted_loss: 0.4593, label: 2, bag_size: 1289
batch 119, loss: 0.1147, instance_loss: 0.1784, weighted_loss: 0.1338, label: 0, bag_size: 255
batch 139, loss: 1.6551, instance_loss: 0.7520, weighted_loss: 1.3842, label: 1, bag_size: 399
batch 159, loss: 0.0438, instance_loss: 0.0800, weighted_loss: 0.0546, label: 0, bag_size: 1247
batch 179, loss: 0.1251, instance_loss: 0.3138, weighted_loss: 0.1817, label: 2, bag_size: 1053
batch 199, loss: 0.0094, instance_loss: 0.6841, weighted_loss: 0.2118, label: 4, bag_size: 974
batch 219, loss: 0.5982, instance_loss: 0.4434, weighted_loss: 0.5517, label: 2, bag_size: 1006
batch 239, loss: 0.0855, instance_loss: 0.1052, weighted_loss: 0.0914, label: 1, bag_size: 847
batch 259, loss: 0.3834, instance_loss: 0.3230, weighted_loss: 0.3653, label: 2, bag_size: 1047
batch 279, loss: 0.5106, instance_loss: 0.7384, weighted_loss: 0.5790, label: 3, bag_size: 211
batch 299, loss: 0.1593, instance_loss: 0.2956, weighted_loss: 0.2002, label: 2, bag_size: 202
batch 319, loss: 0.0873, instance_loss: 0.1861, weighted_loss: 0.1169, label: 0, bag_size: 756
batch 339, loss: 0.2703, instance_loss: 0.2938, weighted_loss: 0.2773, label: 2, bag_size: 848
batch 359, loss: 0.4369, instance_loss: 0.3982, weighted_loss: 0.4253, label: 2, bag_size: 373
batch 379, loss: 0.5676, instance_loss: 0.3597, weighted_loss: 0.5052, label: 2, bag_size: 324
batch 399, loss: 1.1758, instance_loss: 0.4930, weighted_loss: 0.9710, label: 1, bag_size: 448
batch 419, loss: 0.0219, instance_loss: 0.4013, weighted_loss: 0.1357, label: 4, bag_size: 675


class 0 clustering acc 0.9892352941176471: correct 16817/17000
class 1 clustering acc 0.4052941176470588: correct 1378/3400
Epoch: 19, train_loss: 0.3923, train_clustering_loss:  0.3114, train_error: 0.1412
class 0: acc 0.9431818181818182, correct 83/88
class 1: acc 0.6904761904761905, correct 58/84
class 2: acc 0.7558139534883721, correct 65/86
class 3: acc 0.9714285714285714, correct 68/70
class 4: acc 0.9381443298969072, correct 91/97

Val Set, val_loss: 1.3331, val_error: 0.5200, auc: 0.7780
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.105: correct 42/400
class 0: acc 0.5, correct 3/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0382, instance_loss: 0.1029, weighted_loss: 0.0576, label: 0, bag_size: 729
batch 39, loss: 0.7805, instance_loss: 0.4918, weighted_loss: 0.6939, label: 1, bag_size: 711
batch 59, loss: 0.0256, instance_loss: 0.0798, weighted_loss: 0.0419, label: 0, bag_size: 729
batch 79, loss: 0.0620, instance_loss: 0.2371, weighted_loss: 0.1145, label: 4, bag_size: 625
batch 99, loss: 1.1702, instance_loss: 0.4132, weighted_loss: 0.9431, label: 0, bag_size: 912
batch 119, loss: 0.1442, instance_loss: 0.3357, weighted_loss: 0.2017, label: 2, bag_size: 405
batch 139, loss: 0.5094, instance_loss: 0.4196, weighted_loss: 0.4825, label: 1, bag_size: 614
batch 159, loss: 0.5257, instance_loss: 0.3633, weighted_loss: 0.4770, label: 1, bag_size: 1080
batch 179, loss: 1.3193, instance_loss: 0.7362, weighted_loss: 1.1444, label: 4, bag_size: 210
batch 199, loss: 0.2355, instance_loss: 0.2758, weighted_loss: 0.2476, label: 4, bag_size: 754
batch 219, loss: 0.3042, instance_loss: 0.5381, weighted_loss: 0.3744, label: 4, bag_size: 663
batch 239, loss: 0.0046, instance_loss: 0.0450, weighted_loss: 0.0167, label: 3, bag_size: 1069
batch 259, loss: 0.0374, instance_loss: 0.1133, weighted_loss: 0.0601, label: 0, bag_size: 653
batch 279, loss: 0.1741, instance_loss: 0.1837, weighted_loss: 0.1770, label: 1, bag_size: 1261
batch 299, loss: 0.0184, instance_loss: 0.0343, weighted_loss: 0.0232, label: 3, bag_size: 556
batch 319, loss: 0.6614, instance_loss: 0.1929, weighted_loss: 0.5209, label: 4, bag_size: 636
batch 339, loss: 0.0359, instance_loss: 0.0736, weighted_loss: 0.0472, label: 0, bag_size: 1235
batch 359, loss: 0.4586, instance_loss: 0.3178, weighted_loss: 0.4163, label: 2, bag_size: 913
batch 379, loss: 0.0185, instance_loss: 0.1900, weighted_loss: 0.0699, label: 1, bag_size: 682
batch 399, loss: 1.0812, instance_loss: 0.4643, weighted_loss: 0.8961, label: 1, bag_size: 1724
batch 419, loss: 0.3502, instance_loss: 0.3154, weighted_loss: 0.3398, label: 2, bag_size: 351


class 0 clustering acc 0.9892352941176471: correct 16817/17000
class 1 clustering acc 0.4329411764705882: correct 1472/3400
Epoch: 20, train_loss: 0.3740, train_clustering_loss:  0.2976, train_error: 0.1271
class 0: acc 0.9239130434782609, correct 85/92
class 1: acc 0.6829268292682927, correct 56/82
class 2: acc 0.8, correct 68/85
class 3: acc 1.0, correct 81/81
class 4: acc 0.9529411764705882, correct 81/85

Val Set, val_loss: 1.2982, val_error: 0.4600, auc: 0.7732
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.1575: correct 63/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5384615384615384, correct 14/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0957, instance_loss: 0.5417, weighted_loss: 0.2295, label: 3, bag_size: 200
batch 39, loss: 0.0087, instance_loss: 0.0752, weighted_loss: 0.0286, label: 4, bag_size: 729
batch 59, loss: 0.2418, instance_loss: 0.2126, weighted_loss: 0.2330, label: 1, bag_size: 1426
batch 79, loss: 0.0479, instance_loss: 0.1659, weighted_loss: 0.0833, label: 0, bag_size: 1046
batch 99, loss: 0.5797, instance_loss: 0.6510, weighted_loss: 0.6011, label: 4, bag_size: 366
batch 119, loss: 0.0412, instance_loss: 0.1666, weighted_loss: 0.0788, label: 0, bag_size: 602
batch 139, loss: 0.0074, instance_loss: 0.1248, weighted_loss: 0.0426, label: 3, bag_size: 821
batch 159, loss: 0.0429, instance_loss: 0.2631, weighted_loss: 0.1090, label: 4, bag_size: 675
batch 179, loss: 1.1838, instance_loss: 0.4094, weighted_loss: 0.9515, label: 1, bag_size: 533
batch 199, loss: 1.7234, instance_loss: 0.7467, weighted_loss: 1.4304, label: 0, bag_size: 282
batch 219, loss: 0.0723, instance_loss: 0.2238, weighted_loss: 0.1177, label: 4, bag_size: 928
batch 239, loss: 0.0068, instance_loss: 0.1090, weighted_loss: 0.0375, label: 4, bag_size: 729
batch 259, loss: 0.6287, instance_loss: 0.2668, weighted_loss: 0.5201, label: 2, bag_size: 408
batch 279, loss: 0.2140, instance_loss: 0.3430, weighted_loss: 0.2527, label: 1, bag_size: 1014
batch 299, loss: 0.2821, instance_loss: 0.3288, weighted_loss: 0.2961, label: 1, bag_size: 838
batch 319, loss: 1.0955, instance_loss: 0.4693, weighted_loss: 0.9077, label: 1, bag_size: 377
batch 339, loss: 0.8446, instance_loss: 0.3578, weighted_loss: 0.6986, label: 0, bag_size: 1257
batch 359, loss: 0.0261, instance_loss: 0.0922, weighted_loss: 0.0460, label: 4, bag_size: 729
batch 379, loss: 0.3761, instance_loss: 0.3854, weighted_loss: 0.3789, label: 1, bag_size: 711
batch 399, loss: 0.5428, instance_loss: 0.3431, weighted_loss: 0.4829, label: 2, bag_size: 848
batch 419, loss: 0.2317, instance_loss: 0.1558, weighted_loss: 0.2089, label: 1, bag_size: 847


class 0 clustering acc 0.9904117647058823: correct 16837/17000
class 1 clustering acc 0.4547058823529412: correct 1546/3400
Epoch: 21, train_loss: 0.3566, train_clustering_loss:  0.2967, train_error: 0.1388
class 0: acc 0.8888888888888888, correct 80/90
class 1: acc 0.7319587628865979, correct 71/97
class 2: acc 0.7638888888888888, correct 55/72
class 3: acc 0.9879518072289156, correct 82/83
class 4: acc 0.9397590361445783, correct 78/83

Val Set, val_loss: 1.4459, val_error: 0.4800, auc: 0.7544
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.13: correct 52/400
class 0: acc 0.5, correct 3/6
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.5, correct 13/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 8 out of 20


batch 19, loss: 2.1809, instance_loss: 0.6667, weighted_loss: 1.7267, label: 0, bag_size: 282
batch 39, loss: 0.0061, instance_loss: 0.0720, weighted_loss: 0.0259, label: 4, bag_size: 729
batch 59, loss: 0.2174, instance_loss: 0.3008, weighted_loss: 0.2424, label: 2, bag_size: 614
batch 79, loss: 0.0266, instance_loss: 0.0579, weighted_loss: 0.0360, label: 0, bag_size: 515
batch 99, loss: 0.0090, instance_loss: 0.0419, weighted_loss: 0.0189, label: 3, bag_size: 451
batch 119, loss: 0.0282, instance_loss: 0.0808, weighted_loss: 0.0440, label: 3, bag_size: 729
batch 139, loss: 0.1037, instance_loss: 0.2229, weighted_loss: 0.1394, label: 2, bag_size: 701
batch 159, loss: 0.0085, instance_loss: 0.0608, weighted_loss: 0.0242, label: 3, bag_size: 729
batch 179, loss: 0.1367, instance_loss: 0.3888, weighted_loss: 0.2123, label: 1, bag_size: 648
batch 199, loss: 0.0017, instance_loss: 0.0912, weighted_loss: 0.0286, label: 4, bag_size: 729
batch 219, loss: 0.0251, instance_loss: 0.0985, weighted_loss: 0.0471, label: 3, bag_size: 1019
batch 239, loss: 0.0214, instance_loss: 0.0504, weighted_loss: 0.0301, label: 3, bag_size: 316
batch 259, loss: 0.0144, instance_loss: 0.0865, weighted_loss: 0.0360, label: 4, bag_size: 790
batch 279, loss: 0.0416, instance_loss: 0.1096, weighted_loss: 0.0620, label: 0, bag_size: 602
batch 299, loss: 1.3315, instance_loss: 0.5171, weighted_loss: 1.0872, label: 1, bag_size: 936
batch 319, loss: 0.9772, instance_loss: 0.6649, weighted_loss: 0.8835, label: 4, bag_size: 210
batch 339, loss: 0.0699, instance_loss: 0.1425, weighted_loss: 0.0917, label: 0, bag_size: 478
batch 359, loss: 0.2901, instance_loss: 0.4400, weighted_loss: 0.3351, label: 0, bag_size: 466
batch 379, loss: 0.1198, instance_loss: 0.2382, weighted_loss: 0.1553, label: 0, bag_size: 1061
batch 399, loss: 0.0545, instance_loss: 0.5954, weighted_loss: 0.2168, label: 4, bag_size: 663
batch 419, loss: 0.9141, instance_loss: 0.5360, weighted_loss: 0.8007, label: 1, bag_size: 269


class 0 clustering acc 0.989764705882353: correct 16826/17000
class 1 clustering acc 0.46558823529411764: correct 1583/3400
Epoch: 22, train_loss: 0.3319, train_clustering_loss:  0.2912, train_error: 0.1200
class 0: acc 0.9195402298850575, correct 80/87
class 1: acc 0.7142857142857143, correct 55/77
class 2: acc 0.7564102564102564, correct 59/78
class 3: acc 1.0, correct 87/87
class 4: acc 0.96875, correct 93/96

Val Set, val_loss: 1.4820, val_error: 0.5200, auc: 0.7742
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.14: correct 56/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.4230769230769231, correct 11/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0973, instance_loss: 0.2365, weighted_loss: 0.1391, label: 2, bag_size: 626
batch 39, loss: 0.0791, instance_loss: 0.3407, weighted_loss: 0.1576, label: 2, bag_size: 252
batch 59, loss: 0.0855, instance_loss: 0.1003, weighted_loss: 0.0899, label: 3, bag_size: 1177
batch 79, loss: 0.5559, instance_loss: 0.4122, weighted_loss: 0.5128, label: 2, bag_size: 237
batch 99, loss: 0.0027, instance_loss: 0.0719, weighted_loss: 0.0235, label: 3, bag_size: 729
batch 119, loss: 0.0001, instance_loss: 0.0463, weighted_loss: 0.0139, label: 4, bag_size: 764
batch 139, loss: 0.7045, instance_loss: 0.4977, weighted_loss: 0.6425, label: 3, bag_size: 200
batch 159, loss: 1.4740, instance_loss: 0.6634, weighted_loss: 1.2308, label: 1, bag_size: 348
batch 179, loss: 0.3891, instance_loss: 0.2954, weighted_loss: 0.3610, label: 0, bag_size: 868
batch 199, loss: 0.1545, instance_loss: 0.2263, weighted_loss: 0.1760, label: 2, bag_size: 1155
batch 219, loss: 0.1055, instance_loss: 0.1325, weighted_loss: 0.1136, label: 0, bag_size: 759
batch 239, loss: 0.0301, instance_loss: 0.1002, weighted_loss: 0.0512, label: 4, bag_size: 1278
batch 259, loss: 0.2301, instance_loss: 0.1595, weighted_loss: 0.2090, label: 3, bag_size: 533
batch 279, loss: 0.2667, instance_loss: 0.3903, weighted_loss: 0.3038, label: 1, bag_size: 504
batch 299, loss: 0.0322, instance_loss: 0.3145, weighted_loss: 0.1169, label: 2, bag_size: 707
batch 319, loss: 0.4232, instance_loss: 0.4125, weighted_loss: 0.4200, label: 2, bag_size: 1167
batch 339, loss: 0.2773, instance_loss: 0.2652, weighted_loss: 0.2736, label: 2, bag_size: 1039
batch 359, loss: 0.0244, instance_loss: 0.0684, weighted_loss: 0.0376, label: 3, bag_size: 729
batch 379, loss: 0.0054, instance_loss: 0.0317, weighted_loss: 0.0133, label: 3, bag_size: 556
batch 399, loss: 0.0006, instance_loss: 0.0509, weighted_loss: 0.0157, label: 4, bag_size: 729
batch 419, loss: 0.8879, instance_loss: 0.4276, weighted_loss: 0.7498, label: 1, bag_size: 1724


class 0 clustering acc 0.9878235294117647: correct 16793/17000
class 1 clustering acc 0.4485294117647059: correct 1525/3400
Epoch: 23, train_loss: 0.3275, train_clustering_loss:  0.2984, train_error: 0.1035
class 0: acc 0.9294117647058824, correct 79/85
class 1: acc 0.759493670886076, correct 60/79
class 2: acc 0.8148148148148148, correct 66/81
class 3: acc 1.0, correct 89/89
class 4: acc 0.9560439560439561, correct 87/91

Val Set, val_loss: 1.3887, val_error: 0.4800, auc: 0.7582
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.1375: correct 55/400
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5769230769230769, correct 15/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0350, instance_loss: 0.8292, weighted_loss: 0.2732, label: 3, bag_size: 607
batch 39, loss: 0.9595, instance_loss: 0.4929, weighted_loss: 0.8195, label: 1, bag_size: 1559
batch 59, loss: 0.1468, instance_loss: 0.3265, weighted_loss: 0.2007, label: 3, bag_size: 706
batch 79, loss: 0.0011, instance_loss: 0.0173, weighted_loss: 0.0059, label: 3, bag_size: 1172
batch 99, loss: 0.0290, instance_loss: 0.0545, weighted_loss: 0.0367, label: 3, bag_size: 1399
batch 119, loss: 3.1383, instance_loss: 1.2354, weighted_loss: 2.5674, label: 1, bag_size: 867
batch 139, loss: 0.2276, instance_loss: 0.2124, weighted_loss: 0.2231, label: 2, bag_size: 314
batch 159, loss: 0.8326, instance_loss: 0.3118, weighted_loss: 0.6764, label: 4, bag_size: 590
batch 179, loss: 0.0012, instance_loss: 0.0639, weighted_loss: 0.0200, label: 3, bag_size: 1069
batch 199, loss: 0.0364, instance_loss: 0.0761, weighted_loss: 0.0483, label: 0, bag_size: 760
batch 219, loss: 0.0209, instance_loss: 0.1380, weighted_loss: 0.0560, label: 3, bag_size: 729
batch 239, loss: 0.1995, instance_loss: 0.8236, weighted_loss: 0.3867, label: 3, bag_size: 607
batch 259, loss: 0.1036, instance_loss: 0.1534, weighted_loss: 0.1185, label: 4, bag_size: 1121
batch 279, loss: 1.5177, instance_loss: 0.6671, weighted_loss: 1.2625, label: 2, bag_size: 272
batch 299, loss: 0.3444, instance_loss: 0.4523, weighted_loss: 0.3768, label: 1, bag_size: 747
batch 319, loss: 0.7113, instance_loss: 0.3641, weighted_loss: 0.6071, label: 1, bag_size: 139
batch 339, loss: 0.0012, instance_loss: 0.0534, weighted_loss: 0.0169, label: 4, bag_size: 729
batch 359, loss: 0.0066, instance_loss: 0.0632, weighted_loss: 0.0236, label: 3, bag_size: 729
batch 379, loss: 0.0139, instance_loss: 0.0510, weighted_loss: 0.0250, label: 0, bag_size: 1466
batch 399, loss: 0.0698, instance_loss: 0.1100, weighted_loss: 0.0818, label: 3, bag_size: 1177
batch 419, loss: 0.1427, instance_loss: 0.2604, weighted_loss: 0.1780, label: 2, bag_size: 202


class 0 clustering acc 0.9893529411764705: correct 16819/17000
class 1 clustering acc 0.4302941176470588: correct 1463/3400
Epoch: 24, train_loss: 0.3179, train_clustering_loss:  0.2970, train_error: 0.1247
class 0: acc 0.9444444444444444, correct 68/72
class 1: acc 0.6823529411764706, correct 58/85
class 2: acc 0.8089887640449438, correct 72/89
class 3: acc 1.0, correct 91/91
class 4: acc 0.9431818181818182, correct 83/88

Val Set, val_loss: 1.4291, val_error: 0.4600, auc: 0.7644
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5384615384615384, correct 14/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1121, instance_loss: 0.2697, weighted_loss: 0.1594, label: 2, bag_size: 202
batch 39, loss: 0.5833, instance_loss: 0.5197, weighted_loss: 0.5642, label: 1, bag_size: 319
batch 59, loss: 0.0990, instance_loss: 0.2041, weighted_loss: 0.1305, label: 1, bag_size: 1127
batch 79, loss: 0.8749, instance_loss: 0.7775, weighted_loss: 0.8457, label: 2, bag_size: 916
batch 99, loss: 0.8337, instance_loss: 0.3569, weighted_loss: 0.6907, label: 2, bag_size: 932
batch 119, loss: 0.0356, instance_loss: 0.2601, weighted_loss: 0.1029, label: 3, bag_size: 1559
batch 139, loss: 1.9594, instance_loss: 0.5989, weighted_loss: 1.5513, label: 0, bag_size: 423
batch 159, loss: 1.2132, instance_loss: 0.3377, weighted_loss: 0.9506, label: 4, bag_size: 773
batch 179, loss: 1.5108, instance_loss: 0.6785, weighted_loss: 1.2611, label: 1, bag_size: 867
batch 199, loss: 0.7065, instance_loss: 0.4156, weighted_loss: 0.6193, label: 1, bag_size: 139
batch 219, loss: 0.8615, instance_loss: 0.5243, weighted_loss: 0.7603, label: 1, bag_size: 487
batch 239, loss: 0.0739, instance_loss: 0.1637, weighted_loss: 0.1008, label: 1, bag_size: 346
batch 259, loss: 0.1629, instance_loss: 0.3111, weighted_loss: 0.2074, label: 4, bag_size: 1002
batch 279, loss: 1.3484, instance_loss: 0.6101, weighted_loss: 1.1269, label: 1, bag_size: 917
batch 299, loss: 0.0290, instance_loss: 0.0678, weighted_loss: 0.0407, label: 3, bag_size: 729
batch 319, loss: 0.0464, instance_loss: 0.0562, weighted_loss: 0.0493, label: 3, bag_size: 729
batch 339, loss: 0.0801, instance_loss: 0.6940, weighted_loss: 0.2643, label: 4, bag_size: 542
batch 359, loss: 0.0867, instance_loss: 0.1716, weighted_loss: 0.1122, label: 1, bag_size: 1239
batch 379, loss: 0.0007, instance_loss: 0.0605, weighted_loss: 0.0186, label: 3, bag_size: 729
batch 399, loss: 0.1300, instance_loss: 0.3819, weighted_loss: 0.2055, label: 2, bag_size: 730
batch 419, loss: 0.3065, instance_loss: 0.3515, weighted_loss: 0.3200, label: 4, bag_size: 354


class 0 clustering acc 0.989764705882353: correct 16826/17000
class 1 clustering acc 0.3911764705882353: correct 1330/3400
Epoch: 25, train_loss: 0.4068, train_clustering_loss:  0.3169, train_error: 0.1553
class 0: acc 0.8987341772151899, correct 71/79
class 1: acc 0.75, correct 69/92
class 2: acc 0.7272727272727273, correct 64/88
class 3: acc 0.9775280898876404, correct 87/89
class 4: acc 0.8831168831168831, correct 68/77

Val Set, val_loss: 1.5189, val_error: 0.5800, auc: 0.7587
class 0 clustering acc 0.966: correct 1932/2000
class 1 clustering acc 0.135: correct 54/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.2692307692307692, correct 7/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0035, instance_loss: 0.2212, weighted_loss: 0.0688, label: 4, bag_size: 773
batch 39, loss: 0.0130, instance_loss: 0.0525, weighted_loss: 0.0248, label: 0, bag_size: 616
batch 59, loss: 0.0471, instance_loss: 0.1126, weighted_loss: 0.0668, label: 0, bag_size: 800
batch 79, loss: 0.1283, instance_loss: 0.2307, weighted_loss: 0.1590, label: 2, bag_size: 1053
batch 99, loss: 0.0040, instance_loss: 0.1056, weighted_loss: 0.0345, label: 3, bag_size: 952
batch 119, loss: 0.1839, instance_loss: 0.2891, weighted_loss: 0.2155, label: 0, bag_size: 1190
batch 139, loss: 0.0323, instance_loss: 0.0590, weighted_loss: 0.0403, label: 0, bag_size: 1255
batch 159, loss: 0.4844, instance_loss: 0.4072, weighted_loss: 0.4612, label: 2, bag_size: 1047
batch 179, loss: 0.1815, instance_loss: 0.2153, weighted_loss: 0.1917, label: 2, bag_size: 846
batch 199, loss: 0.5113, instance_loss: 0.4428, weighted_loss: 0.4908, label: 2, bag_size: 638
batch 219, loss: 0.0024, instance_loss: 0.1102, weighted_loss: 0.0347, label: 4, bag_size: 729
batch 239, loss: 0.1567, instance_loss: 0.3270, weighted_loss: 0.2078, label: 3, bag_size: 706
batch 259, loss: 0.3477, instance_loss: 0.3413, weighted_loss: 0.3458, label: 2, bag_size: 1514
batch 279, loss: 0.0074, instance_loss: 0.1085, weighted_loss: 0.0377, label: 4, bag_size: 773
batch 299, loss: 0.1014, instance_loss: 0.3548, weighted_loss: 0.1774, label: 4, bag_size: 1360
batch 319, loss: 0.0550, instance_loss: 0.6101, weighted_loss: 0.2215, label: 4, bag_size: 542
batch 339, loss: 0.0029, instance_loss: 0.0291, weighted_loss: 0.0108, label: 4, bag_size: 764
batch 359, loss: 0.0839, instance_loss: 0.3038, weighted_loss: 0.1499, label: 3, bag_size: 706
batch 379, loss: 0.2562, instance_loss: 0.3009, weighted_loss: 0.2696, label: 2, bag_size: 868
batch 399, loss: 0.0447, instance_loss: 0.1322, weighted_loss: 0.0710, label: 0, bag_size: 1046
batch 419, loss: 0.0011, instance_loss: 0.1120, weighted_loss: 0.0344, label: 3, bag_size: 821


class 0 clustering acc 0.9895882352941177: correct 16823/17000
class 1 clustering acc 0.4414705882352941: correct 1501/3400
Epoch: 26, train_loss: 0.2989, train_clustering_loss:  0.2904, train_error: 0.1082
class 0: acc 0.9354838709677419, correct 87/93
class 1: acc 0.7746478873239436, correct 55/71
class 2: acc 0.7738095238095238, correct 65/84
class 3: acc 0.9894736842105263, correct 94/95
class 4: acc 0.9512195121951219, correct 78/82

Val Set, val_loss: 1.3753, val_error: 0.4400, auc: 0.7638
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.14: correct 56/400
class 0: acc 0.5, correct 3/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6923076923076923, correct 18/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0099, instance_loss: 0.0818, weighted_loss: 0.0315, label: 3, bag_size: 729
batch 39, loss: 0.0055, instance_loss: 0.0356, weighted_loss: 0.0146, label: 0, bag_size: 385
batch 59, loss: 0.1615, instance_loss: 0.4907, weighted_loss: 0.2602, label: 1, bag_size: 867
batch 79, loss: 1.9163, instance_loss: 0.8274, weighted_loss: 1.5896, label: 2, bag_size: 959
batch 99, loss: 0.1622, instance_loss: 0.2518, weighted_loss: 0.1891, label: 1, bag_size: 474
batch 119, loss: 0.2228, instance_loss: 0.1770, weighted_loss: 0.2091, label: 4, bag_size: 636
batch 139, loss: 2.0341, instance_loss: 0.6312, weighted_loss: 1.6133, label: 1, bag_size: 936
batch 159, loss: 0.0594, instance_loss: 0.4421, weighted_loss: 0.1742, label: 3, bag_size: 230
batch 179, loss: 1.8502, instance_loss: 0.9098, weighted_loss: 1.5680, label: 1, bag_size: 1799
batch 199, loss: 0.0830, instance_loss: 0.2173, weighted_loss: 0.1233, label: 1, bag_size: 682
batch 219, loss: 0.4928, instance_loss: 0.3271, weighted_loss: 0.4431, label: 2, bag_size: 1047
batch 239, loss: 0.0681, instance_loss: 0.1765, weighted_loss: 0.1006, label: 4, bag_size: 773
batch 259, loss: 0.0038, instance_loss: 0.0355, weighted_loss: 0.0133, label: 3, bag_size: 305
batch 279, loss: 0.0025, instance_loss: 0.3808, weighted_loss: 0.1160, label: 4, bag_size: 974
batch 299, loss: 0.0158, instance_loss: 0.2080, weighted_loss: 0.0735, label: 3, bag_size: 1559
batch 319, loss: 0.0069, instance_loss: 0.1291, weighted_loss: 0.0435, label: 0, bag_size: 729
batch 339, loss: 0.0011, instance_loss: 0.0438, weighted_loss: 0.0139, label: 4, bag_size: 764
batch 359, loss: 0.0214, instance_loss: 0.1373, weighted_loss: 0.0562, label: 0, bag_size: 729
batch 379, loss: 0.0636, instance_loss: 0.5977, weighted_loss: 0.2238, label: 4, bag_size: 542
batch 399, loss: 0.0656, instance_loss: 0.5200, weighted_loss: 0.2019, label: 3, bag_size: 317
batch 419, loss: 0.0082, instance_loss: 0.0527, weighted_loss: 0.0215, label: 3, bag_size: 952


class 0 clustering acc 0.9898235294117647: correct 16827/17000
class 1 clustering acc 0.47823529411764704: correct 1626/3400
Epoch: 27, train_loss: 0.3093, train_clustering_loss:  0.2876, train_error: 0.1082
class 0: acc 0.9555555555555556, correct 86/90
class 1: acc 0.75, correct 66/88
class 2: acc 0.7361111111111112, correct 53/72
class 3: acc 1.0, correct 93/93
class 4: acc 0.9878048780487805, correct 81/82

Val Set, val_loss: 1.3651, val_error: 0.4800, auc: 0.7798
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.1525: correct 61/400
class 0: acc 0.5, correct 3/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5384615384615384, correct 14/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3909, instance_loss: 0.4873, weighted_loss: 0.4198, label: 2, bag_size: 1069
batch 39, loss: 2.0139, instance_loss: 0.7137, weighted_loss: 1.6238, label: 1, bag_size: 435
batch 59, loss: 0.0018, instance_loss: 0.0643, weighted_loss: 0.0205, label: 3, bag_size: 952
batch 79, loss: 0.0133, instance_loss: 0.0515, weighted_loss: 0.0248, label: 0, bag_size: 1135
batch 99, loss: 0.0051, instance_loss: 0.0391, weighted_loss: 0.0153, label: 3, bag_size: 729
batch 119, loss: 0.5021, instance_loss: 0.3570, weighted_loss: 0.4586, label: 2, bag_size: 1133
batch 139, loss: 0.2112, instance_loss: 0.6213, weighted_loss: 0.3342, label: 2, bag_size: 571
batch 159, loss: 0.0713, instance_loss: 0.5117, weighted_loss: 0.2034, label: 2, bag_size: 571
batch 179, loss: 0.1371, instance_loss: 0.1396, weighted_loss: 0.1378, label: 3, bag_size: 1177
batch 199, loss: 0.0034, instance_loss: 0.0783, weighted_loss: 0.0259, label: 3, bag_size: 729
batch 219, loss: 0.0024, instance_loss: 0.5622, weighted_loss: 0.1703, label: 4, bag_size: 711
batch 239, loss: 0.3274, instance_loss: 0.2883, weighted_loss: 0.3157, label: 2, bag_size: 252
batch 259, loss: 0.2577, instance_loss: 0.2129, weighted_loss: 0.2442, label: 2, bag_size: 1448
batch 279, loss: 0.1228, instance_loss: 0.1720, weighted_loss: 0.1376, label: 2, bag_size: 848
batch 299, loss: 0.0136, instance_loss: 0.1125, weighted_loss: 0.0432, label: 3, bag_size: 952
batch 319, loss: 0.2744, instance_loss: 0.2130, weighted_loss: 0.2560, label: 0, bag_size: 367
batch 339, loss: 0.1638, instance_loss: 0.4073, weighted_loss: 0.2369, label: 2, bag_size: 405
batch 359, loss: 0.1994, instance_loss: 0.5104, weighted_loss: 0.2927, label: 1, bag_size: 818
batch 379, loss: 0.8850, instance_loss: 0.4352, weighted_loss: 0.7500, label: 1, bag_size: 533
batch 399, loss: 0.0473, instance_loss: 0.2301, weighted_loss: 0.1021, label: 0, bag_size: 1101
batch 419, loss: 0.0000, instance_loss: 0.0689, weighted_loss: 0.0207, label: 4, bag_size: 729


class 0 clustering acc 0.9882352941176471: correct 16800/17000
class 1 clustering acc 0.4388235294117647: correct 1492/3400
Epoch: 28, train_loss: 0.2825, train_clustering_loss:  0.2970, train_error: 0.0918
class 0: acc 0.9342105263157895, correct 71/76
class 1: acc 0.6956521739130435, correct 48/69
class 2: acc 0.898989898989899, correct 89/99
class 3: acc 1.0, correct 91/91
class 4: acc 0.9666666666666667, correct 87/90

Val Set, val_loss: 1.4902, val_error: 0.4600, auc: 0.7739
class 0 clustering acc 0.969: correct 1938/2000
class 1 clustering acc 0.1575: correct 63/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2472, instance_loss: 0.6022, weighted_loss: 0.3537, label: 2, bag_size: 405
batch 39, loss: 1.0645, instance_loss: 0.4301, weighted_loss: 0.8742, label: 2, bag_size: 1006
batch 59, loss: 0.0511, instance_loss: 0.2890, weighted_loss: 0.1225, label: 4, bag_size: 625
batch 79, loss: 0.1439, instance_loss: 0.2544, weighted_loss: 0.1770, label: 1, bag_size: 913
batch 99, loss: 1.1530, instance_loss: 0.5767, weighted_loss: 0.9801, label: 2, bag_size: 542
batch 119, loss: 0.0093, instance_loss: 0.2311, weighted_loss: 0.0758, label: 4, bag_size: 826
batch 139, loss: 0.0105, instance_loss: 0.1005, weighted_loss: 0.0375, label: 3, bag_size: 451
batch 159, loss: 0.0045, instance_loss: 0.0460, weighted_loss: 0.0170, label: 0, bag_size: 1466
batch 179, loss: 2.2418, instance_loss: 0.9760, weighted_loss: 1.8620, label: 1, bag_size: 1799
batch 199, loss: 0.0774, instance_loss: 0.2431, weighted_loss: 0.1271, label: 2, bag_size: 655
batch 219, loss: 0.2697, instance_loss: 0.3942, weighted_loss: 0.3071, label: 4, bag_size: 675
batch 239, loss: 0.0047, instance_loss: 0.0321, weighted_loss: 0.0130, label: 3, bag_size: 556
batch 259, loss: 0.3179, instance_loss: 0.6076, weighted_loss: 0.4048, label: 1, bag_size: 657
batch 279, loss: 0.2574, instance_loss: 0.2315, weighted_loss: 0.2497, label: 4, bag_size: 436
batch 299, loss: 0.0337, instance_loss: 0.2064, weighted_loss: 0.0855, label: 1, bag_size: 318
batch 319, loss: 0.3021, instance_loss: 0.2630, weighted_loss: 0.2904, label: 2, bag_size: 324
batch 339, loss: 2.3243, instance_loss: 0.7377, weighted_loss: 1.8483, label: 4, bag_size: 210
batch 359, loss: 0.3095, instance_loss: 0.2459, weighted_loss: 0.2904, label: 2, bag_size: 932
batch 379, loss: 0.0380, instance_loss: 0.0712, weighted_loss: 0.0479, label: 3, bag_size: 1177
batch 399, loss: 0.2665, instance_loss: 0.2524, weighted_loss: 0.2623, label: 2, bag_size: 883
batch 419, loss: 1.1856, instance_loss: 0.7238, weighted_loss: 1.0471, label: 0, bag_size: 282


class 0 clustering acc 0.9855882352941177: correct 16755/17000
class 1 clustering acc 0.4491176470588235: correct 1527/3400
Epoch: 29, train_loss: 0.2769, train_clustering_loss:  0.3018, train_error: 0.0918
class 0: acc 0.922077922077922, correct 71/77
class 1: acc 0.797752808988764, correct 71/89
class 2: acc 0.8571428571428571, correct 84/98
class 3: acc 1.0, correct 96/96
class 4: acc 0.9846153846153847, correct 64/65

Val Set, val_loss: 1.4933, val_error: 0.4400, auc: 0.7520
class 0 clustering acc 0.9625: correct 1925/2000
class 1 clustering acc 0.2: correct 80/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5769230769230769, correct 15/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0313, instance_loss: 0.1284, weighted_loss: 0.0604, label: 0, bag_size: 338
batch 39, loss: 0.1562, instance_loss: 0.2701, weighted_loss: 0.1904, label: 2, bag_size: 202
batch 59, loss: 0.1171, instance_loss: 0.2052, weighted_loss: 0.1435, label: 1, bag_size: 534
batch 79, loss: 0.0788, instance_loss: 0.1764, weighted_loss: 0.1081, label: 2, bag_size: 1404
batch 99, loss: 0.1893, instance_loss: 0.7383, weighted_loss: 0.3540, label: 4, bag_size: 210
batch 119, loss: 0.5616, instance_loss: 0.4168, weighted_loss: 0.5181, label: 4, bag_size: 590
batch 139, loss: 0.0056, instance_loss: 0.3148, weighted_loss: 0.0983, label: 3, bag_size: 791
batch 159, loss: 0.0003, instance_loss: 0.1239, weighted_loss: 0.0374, label: 4, bag_size: 729
batch 179, loss: 0.0064, instance_loss: 0.3115, weighted_loss: 0.0980, label: 3, bag_size: 1069
batch 199, loss: 0.0620, instance_loss: 0.2834, weighted_loss: 0.1284, label: 0, bag_size: 1061
batch 219, loss: 0.3992, instance_loss: 0.3857, weighted_loss: 0.3951, label: 2, bag_size: 542
batch 239, loss: 0.1764, instance_loss: 0.4268, weighted_loss: 0.2515, label: 1, bag_size: 102
batch 259, loss: 0.5119, instance_loss: 0.7103, weighted_loss: 0.5714, label: 1, bag_size: 778
batch 279, loss: 0.3212, instance_loss: 0.6466, weighted_loss: 0.4188, label: 3, bag_size: 281
batch 299, loss: 0.3489, instance_loss: 0.3224, weighted_loss: 0.3410, label: 0, bag_size: 759
batch 319, loss: 0.0351, instance_loss: 0.1308, weighted_loss: 0.0638, label: 4, bag_size: 1278
batch 339, loss: 0.0010, instance_loss: 0.0560, weighted_loss: 0.0175, label: 4, bag_size: 729
batch 359, loss: 0.0192, instance_loss: 0.0741, weighted_loss: 0.0357, label: 3, bag_size: 952
batch 379, loss: 1.0111, instance_loss: 0.9117, weighted_loss: 0.9813, label: 1, bag_size: 860
batch 399, loss: 0.0203, instance_loss: 0.0796, weighted_loss: 0.0381, label: 3, bag_size: 1291
batch 419, loss: 0.0249, instance_loss: 0.3116, weighted_loss: 0.1109, label: 2, bag_size: 421


class 0 clustering acc 0.9891764705882353: correct 16816/17000
class 1 clustering acc 0.4985294117647059: correct 1695/3400
Epoch: 30, train_loss: 0.2917, train_clustering_loss:  0.2751, train_error: 0.1059
class 0: acc 0.9578947368421052, correct 91/95
class 1: acc 0.7555555555555555, correct 68/90
class 2: acc 0.7804878048780488, correct 64/82
class 3: acc 1.0, correct 81/81
class 4: acc 0.987012987012987, correct 76/77

Val Set, val_loss: 1.3624, val_error: 0.4200, auc: 0.7757
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.1725: correct 69/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6153846153846154, correct 16/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0091, instance_loss: 0.0874, weighted_loss: 0.0326, label: 4, bag_size: 729
batch 39, loss: 0.0795, instance_loss: 0.1514, weighted_loss: 0.1011, label: 1, bag_size: 636
batch 59, loss: 0.0004, instance_loss: 0.0916, weighted_loss: 0.0278, label: 3, bag_size: 729
batch 79, loss: 0.6773, instance_loss: 0.4140, weighted_loss: 0.5983, label: 2, bag_size: 1218
batch 99, loss: 0.0802, instance_loss: 0.3164, weighted_loss: 0.1510, label: 4, bag_size: 675
batch 119, loss: 0.0508, instance_loss: 0.0912, weighted_loss: 0.0629, label: 1, bag_size: 1086
batch 139, loss: 0.0040, instance_loss: 0.6145, weighted_loss: 0.1871, label: 4, bag_size: 974
batch 159, loss: 0.7075, instance_loss: 0.4740, weighted_loss: 0.6374, label: 2, bag_size: 932
batch 179, loss: 0.0153, instance_loss: 0.1252, weighted_loss: 0.0483, label: 0, bag_size: 515
batch 199, loss: 0.2598, instance_loss: 0.4069, weighted_loss: 0.3040, label: 1, bag_size: 959
batch 219, loss: 0.0058, instance_loss: 0.0552, weighted_loss: 0.0206, label: 3, bag_size: 729
batch 239, loss: 2.0792, instance_loss: 0.6493, weighted_loss: 1.6502, label: 2, bag_size: 948
batch 259, loss: 0.0498, instance_loss: 0.7810, weighted_loss: 0.2692, label: 1, bag_size: 867
batch 279, loss: 1.3952, instance_loss: 0.7171, weighted_loss: 1.1918, label: 0, bag_size: 282
batch 299, loss: 0.0033, instance_loss: 0.0519, weighted_loss: 0.0179, label: 0, bag_size: 933
batch 319, loss: 0.5042, instance_loss: 0.5483, weighted_loss: 0.5174, label: 1, bag_size: 319
batch 339, loss: 1.0138, instance_loss: 0.4554, weighted_loss: 0.8463, label: 1, bag_size: 343
batch 359, loss: 0.4976, instance_loss: 0.7768, weighted_loss: 0.5813, label: 1, bag_size: 660
batch 379, loss: 0.0028, instance_loss: 0.1552, weighted_loss: 0.0485, label: 1, bag_size: 1376
batch 399, loss: 0.0628, instance_loss: 0.0591, weighted_loss: 0.0617, label: 3, bag_size: 1177
batch 419, loss: 0.0089, instance_loss: 0.3501, weighted_loss: 0.1113, label: 3, bag_size: 791


class 0 clustering acc 0.987764705882353: correct 16792/17000
class 1 clustering acc 0.48470588235294115: correct 1648/3400
Epoch: 31, train_loss: 0.2442, train_clustering_loss:  0.2828, train_error: 0.0800
class 0: acc 0.9487179487179487, correct 74/78
class 1: acc 0.8686868686868687, correct 86/99
class 2: acc 0.7875, correct 63/80
class 3: acc 1.0, correct 88/88
class 4: acc 1.0, correct 80/80

Val Set, val_loss: 1.5258, val_error: 0.4600, auc: 0.7761
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.1675: correct 67/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.6563, instance_loss: 0.3906, weighted_loss: 0.5766, label: 0, bag_size: 1257
batch 39, loss: 0.2779, instance_loss: 0.5577, weighted_loss: 0.3618, label: 2, bag_size: 1439
batch 59, loss: 0.0431, instance_loss: 0.0492, weighted_loss: 0.0449, label: 3, bag_size: 1177
batch 79, loss: 0.0007, instance_loss: 0.0566, weighted_loss: 0.0174, label: 4, bag_size: 729
batch 99, loss: 0.7642, instance_loss: 0.3376, weighted_loss: 0.6362, label: 1, bag_size: 533
batch 119, loss: 0.0401, instance_loss: 0.2376, weighted_loss: 0.0993, label: 2, bag_size: 655
batch 139, loss: 0.0142, instance_loss: 0.2241, weighted_loss: 0.0772, label: 0, bag_size: 729
batch 159, loss: 0.0035, instance_loss: 0.0969, weighted_loss: 0.0315, label: 3, bag_size: 729
batch 179, loss: 0.0014, instance_loss: 0.0282, weighted_loss: 0.0095, label: 0, bag_size: 898
batch 199, loss: 0.2282, instance_loss: 0.4635, weighted_loss: 0.2988, label: 2, bag_size: 1410
batch 219, loss: 0.0020, instance_loss: 0.0824, weighted_loss: 0.0261, label: 3, bag_size: 451
batch 239, loss: 0.0367, instance_loss: 0.1049, weighted_loss: 0.0572, label: 1, bag_size: 288
batch 259, loss: 0.1560, instance_loss: 0.6750, weighted_loss: 0.3117, label: 2, bag_size: 803
batch 279, loss: 0.9195, instance_loss: 0.3659, weighted_loss: 0.7534, label: 2, bag_size: 869
batch 299, loss: 0.0197, instance_loss: 0.2318, weighted_loss: 0.0833, label: 4, bag_size: 625
batch 319, loss: 0.0877, instance_loss: 0.5371, weighted_loss: 0.2225, label: 3, bag_size: 671
batch 339, loss: 0.0645, instance_loss: 0.5753, weighted_loss: 0.2177, label: 1, bag_size: 1255
batch 359, loss: 0.0132, instance_loss: 0.0457, weighted_loss: 0.0229, label: 1, bag_size: 847
batch 379, loss: 0.0212, instance_loss: 0.1891, weighted_loss: 0.0716, label: 3, bag_size: 1559
batch 399, loss: 0.1694, instance_loss: 0.1791, weighted_loss: 0.1723, label: 0, bag_size: 759
batch 419, loss: 0.0095, instance_loss: 0.0431, weighted_loss: 0.0196, label: 0, bag_size: 760


class 0 clustering acc 0.9871176470588235: correct 16781/17000
class 1 clustering acc 0.4808823529411765: correct 1635/3400
Epoch: 32, train_loss: 0.2363, train_clustering_loss:  0.2827, train_error: 0.0753
class 0: acc 0.9904761904761905, correct 104/105
class 1: acc 0.7951807228915663, correct 66/83
class 2: acc 0.8390804597701149, correct 73/87
class 3: acc 1.0, correct 78/78
class 4: acc 1.0, correct 72/72

Val Set, val_loss: 1.4547, val_error: 0.4400, auc: 0.7679
class 0 clustering acc 0.9645: correct 1929/2000
class 1 clustering acc 0.195: correct 78/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6538461538461539, correct 17/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0131, instance_loss: 0.1475, weighted_loss: 0.0534, label: 3, bag_size: 821
batch 39, loss: 0.3108, instance_loss: 0.3457, weighted_loss: 0.3213, label: 4, bag_size: 754
batch 59, loss: 0.0325, instance_loss: 0.0956, weighted_loss: 0.0514, label: 0, bag_size: 736
batch 79, loss: 0.2085, instance_loss: 0.6594, weighted_loss: 0.3438, label: 3, bag_size: 283
batch 99, loss: 0.1436, instance_loss: 0.6319, weighted_loss: 0.2901, label: 2, bag_size: 1128
batch 119, loss: 0.0133, instance_loss: 0.2147, weighted_loss: 0.0737, label: 4, bag_size: 826
batch 139, loss: 0.0117, instance_loss: 0.0724, weighted_loss: 0.0299, label: 0, bag_size: 472
batch 159, loss: 0.1133, instance_loss: 0.3375, weighted_loss: 0.1806, label: 2, bag_size: 358
batch 179, loss: 0.1402, instance_loss: 0.4482, weighted_loss: 0.2326, label: 2, bag_size: 3236
batch 199, loss: 0.1772, instance_loss: 0.2208, weighted_loss: 0.1903, label: 3, bag_size: 533
batch 219, loss: 0.1436, instance_loss: 0.2890, weighted_loss: 0.1872, label: 2, bag_size: 1133
batch 239, loss: 0.0003, instance_loss: 0.0299, weighted_loss: 0.0092, label: 3, bag_size: 1069
batch 259, loss: 0.4443, instance_loss: 0.4288, weighted_loss: 0.4397, label: 1, bag_size: 747
batch 279, loss: 0.7954, instance_loss: 0.3841, weighted_loss: 0.6720, label: 1, bag_size: 1197
batch 299, loss: 0.0031, instance_loss: 0.3027, weighted_loss: 0.0930, label: 4, bag_size: 1331
batch 319, loss: 0.0004, instance_loss: 0.1294, weighted_loss: 0.0391, label: 4, bag_size: 388
batch 339, loss: 0.0023, instance_loss: 0.0499, weighted_loss: 0.0166, label: 3, bag_size: 729
batch 359, loss: 0.0461, instance_loss: 0.6982, weighted_loss: 0.2418, label: 3, bag_size: 283
batch 379, loss: 0.0087, instance_loss: 0.4034, weighted_loss: 0.1271, label: 4, bag_size: 663
batch 399, loss: 0.0069, instance_loss: 0.1659, weighted_loss: 0.0546, label: 4, bag_size: 826
batch 419, loss: 0.1495, instance_loss: 0.5292, weighted_loss: 0.2634, label: 4, bag_size: 366


class 0 clustering acc 0.987: correct 16779/17000
class 1 clustering acc 0.4958823529411765: correct 1686/3400
Epoch: 33, train_loss: 0.2511, train_clustering_loss:  0.2898, train_error: 0.0776
class 0: acc 0.9523809523809523, correct 80/84
class 1: acc 0.7931034482758621, correct 69/87
class 2: acc 0.881578947368421, correct 67/76
class 3: acc 1.0, correct 71/71
class 4: acc 0.9813084112149533, correct 105/107

Val Set, val_loss: 1.4136, val_error: 0.4200, auc: 0.7814
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.1625: correct 65/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6538461538461539, correct 17/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0298, instance_loss: 0.1051, weighted_loss: 0.0524, label: 3, bag_size: 729
batch 39, loss: 0.1109, instance_loss: 0.2973, weighted_loss: 0.1668, label: 2, bag_size: 330
batch 59, loss: 0.0033, instance_loss: 0.0393, weighted_loss: 0.0141, label: 0, bag_size: 982
batch 79, loss: 0.9588, instance_loss: 0.6495, weighted_loss: 0.8660, label: 4, bag_size: 210
batch 99, loss: 0.0027, instance_loss: 0.1615, weighted_loss: 0.0503, label: 4, bag_size: 773
batch 119, loss: 0.0935, instance_loss: 0.3224, weighted_loss: 0.1621, label: 0, bag_size: 756
batch 139, loss: 0.0009, instance_loss: 0.3602, weighted_loss: 0.1087, label: 4, bag_size: 974
batch 159, loss: 0.7445, instance_loss: 0.3744, weighted_loss: 0.6335, label: 1, bag_size: 887
batch 179, loss: 0.0274, instance_loss: 0.0881, weighted_loss: 0.0456, label: 3, bag_size: 729
batch 199, loss: 0.9311, instance_loss: 0.5141, weighted_loss: 0.8060, label: 0, bag_size: 1527
batch 219, loss: 0.2719, instance_loss: 0.2970, weighted_loss: 0.2794, label: 0, bag_size: 1034
batch 239, loss: 0.0181, instance_loss: 0.2371, weighted_loss: 0.0838, label: 1, bag_size: 474
batch 259, loss: 0.0085, instance_loss: 0.0834, weighted_loss: 0.0309, label: 0, bag_size: 518
batch 279, loss: 0.0518, instance_loss: 0.1607, weighted_loss: 0.0845, label: 2, bag_size: 1019
batch 299, loss: 0.0017, instance_loss: 0.0171, weighted_loss: 0.0063, label: 3, bag_size: 1069
batch 319, loss: 0.0108, instance_loss: 0.2376, weighted_loss: 0.0788, label: 3, bag_size: 706
batch 339, loss: 0.0022, instance_loss: 0.0523, weighted_loss: 0.0173, label: 3, bag_size: 729
batch 359, loss: 0.9807, instance_loss: 0.6195, weighted_loss: 0.8723, label: 0, bag_size: 818
batch 379, loss: 0.3527, instance_loss: 0.2814, weighted_loss: 0.3313, label: 2, bag_size: 1200
batch 399, loss: 0.0055, instance_loss: 0.1754, weighted_loss: 0.0565, label: 0, bag_size: 729
batch 419, loss: 0.0011, instance_loss: 0.0255, weighted_loss: 0.0084, label: 3, bag_size: 729


class 0 clustering acc 0.9884117647058823: correct 16803/17000
class 1 clustering acc 0.49676470588235294: correct 1689/3400
Epoch: 34, train_loss: 0.2310, train_clustering_loss:  0.2867, train_error: 0.0871
class 0: acc 0.9090909090909091, correct 80/88
class 1: acc 0.8522727272727273, correct 75/88
class 2: acc 0.8181818181818182, correct 63/77
class 3: acc 0.9885057471264368, correct 86/87
class 4: acc 0.9882352941176471, correct 84/85

Val Set, val_loss: 1.4693, val_error: 0.4400, auc: 0.7735
class 0 clustering acc 0.965: correct 1930/2000
class 1 clustering acc 0.1925: correct 77/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5769230769230769, correct 15/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0018, instance_loss: 0.0543, weighted_loss: 0.0175, label: 3, bag_size: 729
batch 39, loss: 0.0027, instance_loss: 0.0478, weighted_loss: 0.0162, label: 3, bag_size: 729
batch 59, loss: 0.0002, instance_loss: 0.0123, weighted_loss: 0.0039, label: 3, bag_size: 405
batch 79, loss: 0.0038, instance_loss: 0.0411, weighted_loss: 0.0150, label: 3, bag_size: 729
batch 99, loss: 0.1343, instance_loss: 0.1855, weighted_loss: 0.1496, label: 0, bag_size: 962
batch 119, loss: 0.1056, instance_loss: 0.2363, weighted_loss: 0.1448, label: 2, bag_size: 1123
batch 139, loss: 0.1758, instance_loss: 0.2426, weighted_loss: 0.1959, label: 0, bag_size: 1190
batch 159, loss: 0.0071, instance_loss: 0.2194, weighted_loss: 0.0708, label: 1, bag_size: 1376
batch 179, loss: 0.0573, instance_loss: 0.2721, weighted_loss: 0.1217, label: 0, bag_size: 371
batch 199, loss: 0.0729, instance_loss: 0.3091, weighted_loss: 0.1437, label: 0, bag_size: 756
batch 219, loss: 0.0090, instance_loss: 0.0934, weighted_loss: 0.0343, label: 4, bag_size: 729
batch 239, loss: 0.0154, instance_loss: 0.2298, weighted_loss: 0.0797, label: 4, bag_size: 675
batch 259, loss: 0.1518, instance_loss: 0.3816, weighted_loss: 0.2208, label: 3, bag_size: 1118
batch 279, loss: 0.0687, instance_loss: 0.1244, weighted_loss: 0.0854, label: 1, bag_size: 938
batch 299, loss: 0.0043, instance_loss: 0.0841, weighted_loss: 0.0283, label: 3, bag_size: 729
batch 319, loss: 0.0002, instance_loss: 0.0228, weighted_loss: 0.0070, label: 3, bag_size: 729
batch 339, loss: 0.0745, instance_loss: 0.8176, weighted_loss: 0.2975, label: 1, bag_size: 867
batch 359, loss: 0.0282, instance_loss: 0.4821, weighted_loss: 0.1644, label: 4, bag_size: 663
batch 379, loss: 1.5748, instance_loss: 0.7208, weighted_loss: 1.3186, label: 1, bag_size: 535
batch 399, loss: 0.0011, instance_loss: 0.6458, weighted_loss: 0.1945, label: 4, bag_size: 974
batch 419, loss: 0.1641, instance_loss: 0.2649, weighted_loss: 0.1943, label: 2, bag_size: 469


class 0 clustering acc 0.9886470588235294: correct 16807/17000
class 1 clustering acc 0.5058823529411764: correct 1720/3400
Epoch: 35, train_loss: 0.2329, train_clustering_loss:  0.2775, train_error: 0.0800
class 0: acc 0.975, correct 78/80
class 1: acc 0.8111111111111111, correct 73/90
class 2: acc 0.8313253012048193, correct 69/83
class 3: acc 1.0, correct 92/92
class 4: acc 0.9875, correct 79/80

Val Set, val_loss: 1.5964, val_error: 0.4600, auc: 0.7732
class 0 clustering acc 0.963: correct 1926/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.1739, instance_loss: 0.3805, weighted_loss: 0.2359, label: 2, bag_size: 2703
batch 39, loss: 0.0462, instance_loss: 0.3327, weighted_loss: 0.1321, label: 2, bag_size: 355
batch 59, loss: 2.7161, instance_loss: 0.9264, weighted_loss: 2.1792, label: 1, bag_size: 386
batch 79, loss: 0.1451, instance_loss: 0.3481, weighted_loss: 0.2060, label: 1, bag_size: 897
batch 99, loss: 0.0407, instance_loss: 0.3784, weighted_loss: 0.1420, label: 3, bag_size: 230
batch 119, loss: 0.1423, instance_loss: 0.3425, weighted_loss: 0.2023, label: 2, bag_size: 1133
batch 139, loss: 2.0644, instance_loss: 0.5939, weighted_loss: 1.6233, label: 1, bag_size: 1197
batch 159, loss: 0.0049, instance_loss: 0.0289, weighted_loss: 0.0121, label: 0, bag_size: 1466
batch 179, loss: 2.4076, instance_loss: 0.6917, weighted_loss: 1.8928, label: 1, bag_size: 1799
batch 199, loss: 0.0294, instance_loss: 0.4783, weighted_loss: 0.1641, label: 4, bag_size: 663
batch 219, loss: 0.1683, instance_loss: 0.2885, weighted_loss: 0.2043, label: 0, bag_size: 1065
batch 239, loss: 0.0218, instance_loss: 0.0806, weighted_loss: 0.0394, label: 0, bag_size: 807
batch 259, loss: 0.2502, instance_loss: 0.2409, weighted_loss: 0.2474, label: 0, bag_size: 367
batch 279, loss: 0.5917, instance_loss: 0.3787, weighted_loss: 0.5278, label: 0, bag_size: 350
batch 299, loss: 0.0253, instance_loss: 0.0698, weighted_loss: 0.0386, label: 0, bag_size: 731
batch 319, loss: 0.3869, instance_loss: 0.3106, weighted_loss: 0.3640, label: 0, bag_size: 367
batch 339, loss: 0.0010, instance_loss: 0.0530, weighted_loss: 0.0166, label: 3, bag_size: 952
batch 359, loss: 0.0043, instance_loss: 0.0263, weighted_loss: 0.0109, label: 0, bag_size: 982
batch 379, loss: 0.0560, instance_loss: 0.1371, weighted_loss: 0.0803, label: 0, bag_size: 367
batch 399, loss: 0.0060, instance_loss: 0.1759, weighted_loss: 0.0570, label: 4, bag_size: 729
batch 419, loss: 0.0508, instance_loss: 0.3288, weighted_loss: 0.1342, label: 2, bag_size: 626


class 0 clustering acc 0.9869411764705882: correct 16778/17000
class 1 clustering acc 0.4879411764705882: correct 1659/3400
Epoch: 36, train_loss: 0.2506, train_clustering_loss:  0.2939, train_error: 0.0706
class 0: acc 0.9620253164556962, correct 76/79
class 1: acc 0.8275862068965517, correct 72/87
class 2: acc 0.8461538461538461, correct 66/78
class 3: acc 1.0, correct 93/93
class 4: acc 1.0, correct 88/88

Val Set, val_loss: 1.5791, val_error: 0.4600, auc: 0.7698
class 0 clustering acc 0.963: correct 1926/2000
class 1 clustering acc 0.1725: correct 69/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 12/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0983, instance_loss: 0.8197, weighted_loss: 0.3147, label: 1, bag_size: 867
batch 39, loss: 0.0477, instance_loss: 0.6054, weighted_loss: 0.2150, label: 1, bag_size: 867
batch 59, loss: 0.1116, instance_loss: 0.4052, weighted_loss: 0.1997, label: 4, bag_size: 817
batch 79, loss: 0.0672, instance_loss: 0.3227, weighted_loss: 0.1438, label: 4, bag_size: 817
batch 99, loss: 0.0257, instance_loss: 0.2664, weighted_loss: 0.0979, label: 4, bag_size: 817
batch 119, loss: 0.0004, instance_loss: 0.0180, weighted_loss: 0.0057, label: 3, bag_size: 729
batch 139, loss: 0.0041, instance_loss: 0.1357, weighted_loss: 0.0436, label: 4, bag_size: 636
batch 159, loss: 1.0294, instance_loss: 0.4101, weighted_loss: 0.8436, label: 1, bag_size: 1197
batch 179, loss: 0.0015, instance_loss: 0.1031, weighted_loss: 0.0320, label: 4, bag_size: 729
batch 199, loss: 0.1681, instance_loss: 0.4287, weighted_loss: 0.2463, label: 1, bag_size: 846
batch 219, loss: 0.0008, instance_loss: 0.3878, weighted_loss: 0.1169, label: 4, bag_size: 754
batch 239, loss: 0.0049, instance_loss: 0.0365, weighted_loss: 0.0144, label: 3, bag_size: 556
batch 259, loss: 0.2780, instance_loss: 0.7057, weighted_loss: 0.4063, label: 3, bag_size: 281
batch 279, loss: 0.7526, instance_loss: 0.4413, weighted_loss: 0.6592, label: 2, bag_size: 248
batch 299, loss: 0.1412, instance_loss: 0.2435, weighted_loss: 0.1719, label: 4, bag_size: 1002
batch 319, loss: 0.0007, instance_loss: 0.1062, weighted_loss: 0.0324, label: 3, bag_size: 821
batch 339, loss: 0.0009, instance_loss: 0.0375, weighted_loss: 0.0119, label: 3, bag_size: 729
batch 359, loss: 0.0203, instance_loss: 0.1556, weighted_loss: 0.0609, label: 1, bag_size: 682
batch 379, loss: 0.4607, instance_loss: 0.3252, weighted_loss: 0.4200, label: 2, bag_size: 525
batch 399, loss: 0.0267, instance_loss: 0.4921, weighted_loss: 0.1663, label: 4, bag_size: 533
batch 419, loss: 0.0271, instance_loss: 0.2453, weighted_loss: 0.0926, label: 4, bag_size: 436


class 0 clustering acc 0.9883529411764705: correct 16802/17000
class 1 clustering acc 0.4908823529411765: correct 1669/3400
Epoch: 37, train_loss: 0.2122, train_clustering_loss:  0.2827, train_error: 0.0776
class 0: acc 0.978021978021978, correct 89/91
class 1: acc 0.8333333333333334, correct 75/90
class 2: acc 0.8125, correct 65/80
class 3: acc 1.0, correct 84/84
class 4: acc 0.9875, correct 79/80

Val Set, val_loss: 1.5309, val_error: 0.4600, auc: 0.7739
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.165: correct 66/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5384615384615384, correct 14/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0195, instance_loss: 0.0873, weighted_loss: 0.0399, label: 0, bag_size: 1012
batch 39, loss: 0.0265, instance_loss: 0.3467, weighted_loss: 0.1226, label: 3, bag_size: 706
batch 59, loss: 1.2877, instance_loss: 0.5310, weighted_loss: 1.0607, label: 1, bag_size: 1197
batch 79, loss: 0.0032, instance_loss: 0.0282, weighted_loss: 0.0107, label: 0, bag_size: 729
batch 99, loss: 0.0439, instance_loss: 0.1745, weighted_loss: 0.0831, label: 3, bag_size: 849
batch 119, loss: 0.0149, instance_loss: 0.3280, weighted_loss: 0.1088, label: 4, bag_size: 928
batch 139, loss: 0.8101, instance_loss: 0.3555, weighted_loss: 0.6738, label: 2, bag_size: 1533
batch 159, loss: 0.0001, instance_loss: 0.0775, weighted_loss: 0.0233, label: 4, bag_size: 729
batch 179, loss: 0.0084, instance_loss: 0.1308, weighted_loss: 0.0451, label: 4, bag_size: 928
batch 199, loss: 0.2003, instance_loss: 0.2753, weighted_loss: 0.2228, label: 0, bag_size: 466
batch 219, loss: 0.7779, instance_loss: 0.4451, weighted_loss: 0.6780, label: 1, bag_size: 1144
batch 239, loss: 0.2084, instance_loss: 0.3180, weighted_loss: 0.2412, label: 2, bag_size: 621
batch 259, loss: 0.0013, instance_loss: 0.0171, weighted_loss: 0.0060, label: 0, bag_size: 1466
batch 279, loss: 0.0011, instance_loss: 0.0727, weighted_loss: 0.0225, label: 4, bag_size: 729
batch 299, loss: 0.0116, instance_loss: 0.0362, weighted_loss: 0.0190, label: 0, bag_size: 1255
batch 319, loss: 0.1291, instance_loss: 0.2300, weighted_loss: 0.1594, label: 0, bag_size: 1247
batch 339, loss: 0.1190, instance_loss: 0.1941, weighted_loss: 0.1415, label: 2, bag_size: 1242
batch 359, loss: 0.0362, instance_loss: 0.1218, weighted_loss: 0.0619, label: 4, bag_size: 1002
batch 379, loss: 0.0393, instance_loss: 0.4379, weighted_loss: 0.1589, label: 1, bag_size: 818
batch 399, loss: 0.5931, instance_loss: 0.3608, weighted_loss: 0.5234, label: 1, bag_size: 533
batch 419, loss: 0.0124, instance_loss: 0.0691, weighted_loss: 0.0294, label: 0, bag_size: 1235


class 0 clustering acc 0.9868235294117647: correct 16776/17000
class 1 clustering acc 0.5: correct 1700/3400
Epoch: 38, train_loss: 0.2117, train_clustering_loss:  0.2838, train_error: 0.0824
class 0: acc 0.9528301886792453, correct 101/106
class 1: acc 0.8214285714285714, correct 69/84
class 2: acc 0.8108108108108109, correct 60/74
class 3: acc 0.9868421052631579, correct 75/76
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.4104, val_error: 0.4200, auc: 0.8084
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.1425: correct 57/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6153846153846154, correct 16/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0035, instance_loss: 0.0413, weighted_loss: 0.0149, label: 3, bag_size: 556
batch 39, loss: 0.0690, instance_loss: 0.3876, weighted_loss: 0.1646, label: 3, bag_size: 230
batch 59, loss: 0.3749, instance_loss: 0.3996, weighted_loss: 0.3823, label: 2, bag_size: 1164
batch 79, loss: 0.0021, instance_loss: 0.0338, weighted_loss: 0.0116, label: 3, bag_size: 1172
batch 99, loss: 0.0119, instance_loss: 0.2342, weighted_loss: 0.0786, label: 3, bag_size: 1118
batch 119, loss: 0.0131, instance_loss: 0.4108, weighted_loss: 0.1324, label: 4, bag_size: 882
batch 139, loss: 0.0047, instance_loss: 0.0722, weighted_loss: 0.0250, label: 4, bag_size: 1176
batch 159, loss: 0.0968, instance_loss: 0.4374, weighted_loss: 0.1990, label: 1, bag_size: 1646
batch 179, loss: 2.5995, instance_loss: 0.7218, weighted_loss: 2.0362, label: 2, bag_size: 948
batch 199, loss: 0.0582, instance_loss: 0.1419, weighted_loss: 0.0833, label: 1, bag_size: 1325
batch 219, loss: 0.0049, instance_loss: 0.0945, weighted_loss: 0.0318, label: 0, bag_size: 933
batch 239, loss: 0.0012, instance_loss: 0.0341, weighted_loss: 0.0110, label: 3, bag_size: 729
batch 259, loss: 0.0002, instance_loss: 0.0728, weighted_loss: 0.0219, label: 4, bag_size: 729
batch 279, loss: 0.2336, instance_loss: 0.3115, weighted_loss: 0.2570, label: 2, bag_size: 1148
batch 299, loss: 0.0451, instance_loss: 0.2385, weighted_loss: 0.1032, label: 0, bag_size: 1517
batch 319, loss: 0.0009, instance_loss: 0.2296, weighted_loss: 0.0695, label: 4, bag_size: 729
batch 339, loss: 0.1609, instance_loss: 0.3099, weighted_loss: 0.2056, label: 0, bag_size: 1065
batch 359, loss: 0.7044, instance_loss: 0.4917, weighted_loss: 0.6406, label: 1, bag_size: 487
batch 379, loss: 0.1175, instance_loss: 0.6231, weighted_loss: 0.2692, label: 1, bag_size: 1390
batch 399, loss: 0.0117, instance_loss: 0.0550, weighted_loss: 0.0247, label: 1, bag_size: 286
batch 419, loss: 0.3699, instance_loss: 0.4897, weighted_loss: 0.4059, label: 2, bag_size: 725


class 0 clustering acc 0.9880588235294118: correct 16797/17000
class 1 clustering acc 0.47441176470588237: correct 1613/3400
Epoch: 39, train_loss: 0.2256, train_clustering_loss:  0.2924, train_error: 0.0729
class 0: acc 0.9690721649484536, correct 94/97
class 1: acc 0.8, correct 64/80
class 2: acc 0.8775510204081632, correct 86/98
class 3: acc 1.0, correct 75/75
class 4: acc 1.0, correct 75/75

Val Set, val_loss: 1.5708, val_error: 0.4200, auc: 0.7688
class 0 clustering acc 0.962: correct 1924/2000
class 1 clustering acc 0.145: correct 58/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5384615384615384, correct 14/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 26 out of 20


batch 19, loss: 1.0125, instance_loss: 0.6170, weighted_loss: 0.8939, label: 2, bag_size: 1139
batch 39, loss: 0.0073, instance_loss: 0.4495, weighted_loss: 0.1400, label: 2, bag_size: 323
batch 59, loss: 0.2967, instance_loss: 0.7224, weighted_loss: 0.4244, label: 1, bag_size: 660
batch 79, loss: 0.0005, instance_loss: 0.0584, weighted_loss: 0.0179, label: 3, bag_size: 841
batch 99, loss: 0.0001, instance_loss: 0.0472, weighted_loss: 0.0143, label: 3, bag_size: 729
batch 119, loss: 1.4764, instance_loss: 0.7027, weighted_loss: 1.2443, label: 2, bag_size: 295
batch 139, loss: 0.0130, instance_loss: 0.0715, weighted_loss: 0.0306, label: 3, bag_size: 729
batch 159, loss: 0.8107, instance_loss: 0.5452, weighted_loss: 0.7310, label: 0, bag_size: 282
batch 179, loss: 0.0053, instance_loss: 0.1514, weighted_loss: 0.0491, label: 3, bag_size: 451
batch 199, loss: 0.1734, instance_loss: 0.3654, weighted_loss: 0.2310, label: 0, bag_size: 1046
batch 219, loss: 0.0461, instance_loss: 0.0894, weighted_loss: 0.0591, label: 3, bag_size: 316
batch 239, loss: 0.6297, instance_loss: 0.4399, weighted_loss: 0.5727, label: 1, bag_size: 487
batch 259, loss: 0.0087, instance_loss: 0.0817, weighted_loss: 0.0306, label: 3, bag_size: 729
batch 279, loss: 0.0018, instance_loss: 0.0212, weighted_loss: 0.0076, label: 0, bag_size: 402
batch 299, loss: 0.3470, instance_loss: 0.5993, weighted_loss: 0.4227, label: 1, bag_size: 269
batch 319, loss: 0.0050, instance_loss: 0.1260, weighted_loss: 0.0413, label: 3, bag_size: 849
batch 339, loss: 0.0382, instance_loss: 0.1633, weighted_loss: 0.0757, label: 0, bag_size: 338
batch 359, loss: 0.0200, instance_loss: 0.2545, weighted_loss: 0.0904, label: 0, bag_size: 1196
batch 379, loss: 0.0002, instance_loss: 0.0403, weighted_loss: 0.0122, label: 4, bag_size: 729
batch 399, loss: 0.0356, instance_loss: 0.1794, weighted_loss: 0.0787, label: 4, bag_size: 636
batch 419, loss: 0.0775, instance_loss: 0.3865, weighted_loss: 0.1702, label: 2, bag_size: 317


class 0 clustering acc 0.9868823529411764: correct 16777/17000
class 1 clustering acc 0.4861764705882353: correct 1653/3400
Epoch: 40, train_loss: 0.2453, train_clustering_loss:  0.2843, train_error: 0.0706
class 0: acc 0.9789473684210527, correct 93/95
class 1: acc 0.8705882352941177, correct 74/85
class 2: acc 0.8227848101265823, correct 65/79
class 3: acc 0.9888888888888889, correct 89/90
class 4: acc 0.9736842105263158, correct 74/76

Val Set, val_loss: 1.3766, val_error: 0.3800, auc: 0.7927
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.16: correct 64/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7307692307692307, correct 19/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0889, instance_loss: 0.5214, weighted_loss: 0.2186, label: 2, bag_size: 1439
batch 39, loss: 0.0119, instance_loss: 0.0688, weighted_loss: 0.0290, label: 3, bag_size: 849
batch 59, loss: 0.1379, instance_loss: 0.5142, weighted_loss: 0.2508, label: 4, bag_size: 1235
batch 79, loss: 0.0925, instance_loss: 0.1610, weighted_loss: 0.1131, label: 3, bag_size: 533
batch 99, loss: 0.0009, instance_loss: 0.0515, weighted_loss: 0.0161, label: 4, bag_size: 636
batch 119, loss: 0.1309, instance_loss: 0.3215, weighted_loss: 0.1881, label: 2, bag_size: 626
batch 139, loss: 0.0004, instance_loss: 0.0580, weighted_loss: 0.0176, label: 3, bag_size: 729
batch 159, loss: 0.0066, instance_loss: 0.0844, weighted_loss: 0.0299, label: 0, bag_size: 476
batch 179, loss: 0.0054, instance_loss: 0.0635, weighted_loss: 0.0228, label: 0, bag_size: 385
batch 199, loss: 0.3409, instance_loss: 0.3781, weighted_loss: 0.3521, label: 2, bag_size: 932
batch 219, loss: 0.0118, instance_loss: 0.1082, weighted_loss: 0.0407, label: 1, bag_size: 1426
batch 239, loss: 0.0571, instance_loss: 0.0993, weighted_loss: 0.0697, label: 3, bag_size: 1177
batch 259, loss: 0.0452, instance_loss: 0.2047, weighted_loss: 0.0931, label: 1, bag_size: 858
batch 279, loss: 0.0944, instance_loss: 0.2159, weighted_loss: 0.1309, label: 0, bag_size: 1101
batch 299, loss: 0.0827, instance_loss: 0.2005, weighted_loss: 0.1180, label: 2, bag_size: 499
batch 319, loss: 0.3667, instance_loss: 0.3897, weighted_loss: 0.3736, label: 1, bag_size: 711
batch 339, loss: 0.0444, instance_loss: 0.0903, weighted_loss: 0.0582, label: 0, bag_size: 200
batch 359, loss: 0.0350, instance_loss: 0.1774, weighted_loss: 0.0777, label: 0, bag_size: 1527
batch 379, loss: 0.0303, instance_loss: 0.2211, weighted_loss: 0.0875, label: 1, bag_size: 696
batch 399, loss: 0.3265, instance_loss: 0.4886, weighted_loss: 0.3751, label: 0, bag_size: 818
batch 419, loss: 0.0019, instance_loss: 0.0327, weighted_loss: 0.0112, label: 0, bag_size: 982


class 0 clustering acc 0.9894117647058823: correct 16820/17000
class 1 clustering acc 0.5211764705882352: correct 1772/3400
Epoch: 41, train_loss: 0.1825, train_clustering_loss:  0.2659, train_error: 0.0635
class 0: acc 0.956989247311828, correct 89/93
class 1: acc 0.8395061728395061, correct 68/81
class 2: acc 0.8809523809523809, correct 74/84
class 3: acc 1.0, correct 77/77
class 4: acc 1.0, correct 90/90

Val Set, val_loss: 1.2908, val_error: 0.3600, auc: 0.8206
class 0 clustering acc 0.9585: correct 1917/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7307692307692307, correct 19/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 28 out of 20


batch 19, loss: 1.0845, instance_loss: 0.5316, weighted_loss: 0.9186, label: 1, bag_size: 700
batch 39, loss: 0.0214, instance_loss: 0.4270, weighted_loss: 0.1431, label: 4, bag_size: 590
batch 59, loss: 0.0756, instance_loss: 0.3296, weighted_loss: 0.1518, label: 1, bag_size: 898
batch 79, loss: 0.0410, instance_loss: 0.4842, weighted_loss: 0.1740, label: 4, bag_size: 1360
batch 99, loss: 0.0029, instance_loss: 0.2498, weighted_loss: 0.0770, label: 3, bag_size: 706
batch 119, loss: 0.7502, instance_loss: 0.7531, weighted_loss: 0.7511, label: 2, bag_size: 295
batch 139, loss: 0.0544, instance_loss: 0.8132, weighted_loss: 0.2821, label: 4, bag_size: 542
batch 159, loss: 0.0683, instance_loss: 0.1399, weighted_loss: 0.0898, label: 2, bag_size: 1448
batch 179, loss: 0.0047, instance_loss: 0.1796, weighted_loss: 0.0571, label: 0, bag_size: 729
batch 199, loss: 0.0333, instance_loss: 0.1415, weighted_loss: 0.0658, label: 1, bag_size: 994
batch 219, loss: 0.4526, instance_loss: 0.4315, weighted_loss: 0.4463, label: 2, bag_size: 758
batch 239, loss: 0.6832, instance_loss: 0.3487, weighted_loss: 0.5828, label: 2, bag_size: 589
batch 259, loss: 0.0008, instance_loss: 0.0324, weighted_loss: 0.0103, label: 4, bag_size: 729
batch 279, loss: 0.0394, instance_loss: 0.2183, weighted_loss: 0.0931, label: 0, bag_size: 1101
batch 299, loss: 0.0805, instance_loss: 0.2740, weighted_loss: 0.1386, label: 2, bag_size: 1215
batch 319, loss: 0.0493, instance_loss: 0.7161, weighted_loss: 0.2493, label: 3, bag_size: 283
batch 339, loss: 0.1032, instance_loss: 0.2334, weighted_loss: 0.1422, label: 2, bag_size: 499
batch 359, loss: 0.0504, instance_loss: 0.0806, weighted_loss: 0.0594, label: 4, bag_size: 1121
batch 379, loss: 0.3960, instance_loss: 0.4387, weighted_loss: 0.4088, label: 2, bag_size: 934
batch 399, loss: 0.0386, instance_loss: 0.1474, weighted_loss: 0.0713, label: 2, bag_size: 848
batch 419, loss: 0.0215, instance_loss: 0.1460, weighted_loss: 0.0589, label: 4, bag_size: 729


class 0 clustering acc 0.9861176470588235: correct 16764/17000
class 1 clustering acc 0.5317647058823529: correct 1808/3400
Epoch: 42, train_loss: 0.1737, train_clustering_loss:  0.2710, train_error: 0.0612
class 0: acc 1.0, correct 77/77
class 1: acc 0.775, correct 62/80
class 2: acc 0.9148936170212766, correct 86/94
class 3: acc 1.0, correct 85/85
class 4: acc 1.0, correct 89/89

Val Set, val_loss: 1.4580, val_error: 0.3800, auc: 0.7922
class 0 clustering acc 0.9605: correct 1921/2000
class 1 clustering acc 0.2525: correct 101/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7692307692307693, correct 20/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0059, instance_loss: 0.0977, weighted_loss: 0.0334, label: 0, bag_size: 729
batch 39, loss: 0.4804, instance_loss: 0.2510, weighted_loss: 0.4116, label: 4, bag_size: 1002
batch 59, loss: 0.0014, instance_loss: 0.0634, weighted_loss: 0.0200, label: 4, bag_size: 729
batch 79, loss: 1.9363, instance_loss: 0.7152, weighted_loss: 1.5700, label: 2, bag_size: 1139
batch 99, loss: 0.0016, instance_loss: 0.0221, weighted_loss: 0.0078, label: 3, bag_size: 305
batch 119, loss: 0.0331, instance_loss: 0.5656, weighted_loss: 0.1929, label: 3, bag_size: 283
batch 139, loss: 0.0492, instance_loss: 0.1525, weighted_loss: 0.0802, label: 4, bag_size: 297
batch 159, loss: 0.0097, instance_loss: 0.4665, weighted_loss: 0.1468, label: 4, bag_size: 882
batch 179, loss: 0.1198, instance_loss: 0.3222, weighted_loss: 0.1805, label: 2, bag_size: 913
batch 199, loss: 0.0643, instance_loss: 0.2206, weighted_loss: 0.1112, label: 1, bag_size: 690
batch 219, loss: 0.0210, instance_loss: 0.5188, weighted_loss: 0.1703, label: 4, bag_size: 882
batch 239, loss: 0.0005, instance_loss: 0.1961, weighted_loss: 0.0592, label: 4, bag_size: 524
batch 259, loss: 0.1990, instance_loss: 0.4693, weighted_loss: 0.2801, label: 1, bag_size: 242
batch 279, loss: 0.0001, instance_loss: 0.0649, weighted_loss: 0.0196, label: 3, bag_size: 821
batch 299, loss: 0.0743, instance_loss: 0.1918, weighted_loss: 0.1096, label: 2, bag_size: 1053
batch 319, loss: 0.1199, instance_loss: 0.2006, weighted_loss: 0.1441, label: 2, bag_size: 1123
batch 339, loss: 0.6193, instance_loss: 0.6394, weighted_loss: 0.6253, label: 2, bag_size: 1139
batch 359, loss: 0.0157, instance_loss: 0.0739, weighted_loss: 0.0332, label: 0, bag_size: 731
batch 379, loss: 0.0213, instance_loss: 0.0382, weighted_loss: 0.0264, label: 3, bag_size: 1399
batch 399, loss: 0.0000, instance_loss: 0.0822, weighted_loss: 0.0247, label: 4, bag_size: 729
batch 419, loss: 0.0128, instance_loss: 0.1853, weighted_loss: 0.0645, label: 0, bag_size: 729


class 0 clustering acc 0.9874705882352941: correct 16787/17000
class 1 clustering acc 0.5035294117647059: correct 1712/3400
Epoch: 43, train_loss: 0.1683, train_clustering_loss:  0.2858, train_error: 0.0494
class 0: acc 1.0, correct 76/76
class 1: acc 0.8354430379746836, correct 66/79
class 2: acc 0.8987341772151899, correct 71/79
class 3: acc 1.0, correct 93/93
class 4: acc 1.0, correct 98/98

Val Set, val_loss: 1.4072, val_error: 0.4000, auc: 0.7912
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.1325: correct 53/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6923076923076923, correct 18/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0004, instance_loss: 0.0843, weighted_loss: 0.0256, label: 4, bag_size: 1278
batch 39, loss: 0.0226, instance_loss: 0.0370, weighted_loss: 0.0269, label: 3, bag_size: 1177
batch 59, loss: 0.0155, instance_loss: 0.4249, weighted_loss: 0.1383, label: 0, bag_size: 729
batch 79, loss: 0.0921, instance_loss: 0.2333, weighted_loss: 0.1344, label: 4, bag_size: 297
batch 99, loss: 1.3168, instance_loss: 0.4612, weighted_loss: 1.0601, label: 2, bag_size: 358
batch 119, loss: 0.4030, instance_loss: 0.3267, weighted_loss: 0.3801, label: 2, bag_size: 265
batch 139, loss: 0.0882, instance_loss: 0.1865, weighted_loss: 0.1177, label: 4, bag_size: 354
batch 159, loss: 0.1171, instance_loss: 0.3090, weighted_loss: 0.1746, label: 1, bag_size: 1261
batch 179, loss: 0.1877, instance_loss: 0.2218, weighted_loss: 0.1979, label: 0, bag_size: 1527
batch 199, loss: 0.3290, instance_loss: 0.4979, weighted_loss: 0.3797, label: 2, bag_size: 259
batch 219, loss: 0.3024, instance_loss: 0.3105, weighted_loss: 0.3048, label: 0, bag_size: 1034
batch 239, loss: 0.0016, instance_loss: 0.0344, weighted_loss: 0.0115, label: 3, bag_size: 556
batch 259, loss: 0.0034, instance_loss: 0.1447, weighted_loss: 0.0458, label: 4, bag_size: 675
batch 279, loss: 0.0333, instance_loss: 0.3762, weighted_loss: 0.1361, label: 4, bag_size: 1331
batch 299, loss: 0.0001, instance_loss: 0.0347, weighted_loss: 0.0105, label: 4, bag_size: 729
batch 319, loss: 0.0138, instance_loss: 0.0750, weighted_loss: 0.0322, label: 4, bag_size: 625
batch 339, loss: 0.0040, instance_loss: 0.2918, weighted_loss: 0.0903, label: 3, bag_size: 317
batch 359, loss: 0.0009, instance_loss: 0.2387, weighted_loss: 0.0723, label: 4, bag_size: 773
batch 379, loss: 0.0568, instance_loss: 0.1825, weighted_loss: 0.0945, label: 0, bag_size: 350
batch 399, loss: 0.0010, instance_loss: 0.0580, weighted_loss: 0.0181, label: 3, bag_size: 729
batch 419, loss: 0.0503, instance_loss: 0.4156, weighted_loss: 0.1599, label: 4, bag_size: 1337


class 0 clustering acc 0.9864705882352941: correct 16770/17000
class 1 clustering acc 0.49264705882352944: correct 1675/3400
Epoch: 44, train_loss: 0.2233, train_clustering_loss:  0.2853, train_error: 0.0800
class 0: acc 0.961038961038961, correct 74/77
class 1: acc 0.7934782608695652, correct 73/92
class 2: acc 0.85, correct 68/80
class 3: acc 1.0, correct 83/83
class 4: acc 1.0, correct 93/93

Val Set, val_loss: 1.4561, val_error: 0.4200, auc: 0.8049
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.5769230769230769, correct 15/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0815, weighted_loss: 0.0245, label: 3, bag_size: 729
batch 39, loss: 0.0001, instance_loss: 0.2924, weighted_loss: 0.0878, label: 4, bag_size: 974
batch 59, loss: 0.0527, instance_loss: 0.2225, weighted_loss: 0.1036, label: 0, bag_size: 630
batch 79, loss: 0.0512, instance_loss: 0.1780, weighted_loss: 0.0892, label: 0, bag_size: 478
batch 99, loss: 0.0001, instance_loss: 0.0502, weighted_loss: 0.0151, label: 3, bag_size: 821
batch 119, loss: 0.0343, instance_loss: 0.2816, weighted_loss: 0.1085, label: 1, bag_size: 696
batch 139, loss: 0.4361, instance_loss: 0.5465, weighted_loss: 0.4693, label: 2, bag_size: 355
batch 159, loss: 0.0053, instance_loss: 0.1600, weighted_loss: 0.0517, label: 3, bag_size: 841
batch 179, loss: 0.0001, instance_loss: 0.1116, weighted_loss: 0.0335, label: 4, bag_size: 729
batch 199, loss: 0.0225, instance_loss: 0.4693, weighted_loss: 0.1566, label: 4, bag_size: 882
batch 219, loss: 0.0013, instance_loss: 0.0820, weighted_loss: 0.0255, label: 1, bag_size: 847
batch 239, loss: 0.9383, instance_loss: 0.5005, weighted_loss: 0.8069, label: 2, bag_size: 471
batch 259, loss: 0.0073, instance_loss: 0.1820, weighted_loss: 0.0597, label: 4, bag_size: 524
batch 279, loss: 0.0239, instance_loss: 0.1411, weighted_loss: 0.0591, label: 1, bag_size: 696
batch 299, loss: 0.1431, instance_loss: 0.2496, weighted_loss: 0.1750, label: 0, bag_size: 350
batch 319, loss: 0.0222, instance_loss: 0.1172, weighted_loss: 0.0507, label: 3, bag_size: 849
batch 339, loss: 0.0726, instance_loss: 0.6491, weighted_loss: 0.2455, label: 3, bag_size: 283
batch 359, loss: 0.0016, instance_loss: 0.2868, weighted_loss: 0.0872, label: 4, bag_size: 754
batch 379, loss: 0.0701, instance_loss: 0.2696, weighted_loss: 0.1300, label: 2, bag_size: 461
batch 399, loss: 0.0001, instance_loss: 0.0841, weighted_loss: 0.0253, label: 3, bag_size: 821
batch 419, loss: 0.0808, instance_loss: 0.2004, weighted_loss: 0.1167, label: 1, bag_size: 858


class 0 clustering acc 0.9904705882352941: correct 16838/17000
class 1 clustering acc 0.49058823529411766: correct 1668/3400
Epoch: 45, train_loss: 0.1751, train_clustering_loss:  0.2726, train_error: 0.0541
class 0: acc 0.963855421686747, correct 80/83
class 1: acc 0.8854166666666666, correct 85/96
class 2: acc 0.8904109589041096, correct 65/73
class 3: acc 1.0, correct 93/93
class 4: acc 0.9875, correct 79/80

Val Set, val_loss: 1.6086, val_error: 0.4200, auc: 0.7783
class 0 clustering acc 0.9555: correct 1911/2000
class 1 clustering acc 0.1825: correct 73/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5384615384615384, correct 14/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0219, instance_loss: 0.1665, weighted_loss: 0.0653, label: 0, bag_size: 1046
batch 39, loss: 0.2779, instance_loss: 0.4942, weighted_loss: 0.3428, label: 1, bag_size: 868
batch 59, loss: 0.0162, instance_loss: 0.1585, weighted_loss: 0.0589, label: 1, bag_size: 938
batch 79, loss: 0.0015, instance_loss: 0.1757, weighted_loss: 0.0537, label: 3, bag_size: 451
batch 99, loss: 0.0001, instance_loss: 0.0498, weighted_loss: 0.0150, label: 3, bag_size: 952
batch 119, loss: 0.0000, instance_loss: 0.0351, weighted_loss: 0.0106, label: 4, bag_size: 729
batch 139, loss: 0.0646, instance_loss: 0.4672, weighted_loss: 0.1854, label: 2, bag_size: 405
batch 159, loss: 0.0004, instance_loss: 0.0388, weighted_loss: 0.0119, label: 3, bag_size: 729
batch 179, loss: 0.1453, instance_loss: 0.6282, weighted_loss: 0.2902, label: 4, bag_size: 1337
batch 199, loss: 0.0033, instance_loss: 0.1207, weighted_loss: 0.0385, label: 0, bag_size: 729
batch 219, loss: 0.0006, instance_loss: 0.1684, weighted_loss: 0.0509, label: 3, bag_size: 821
batch 239, loss: 0.3354, instance_loss: 0.4071, weighted_loss: 0.3569, label: 1, bag_size: 1559
batch 259, loss: 0.0377, instance_loss: 0.1128, weighted_loss: 0.0602, label: 0, bag_size: 760
batch 279, loss: 0.0139, instance_loss: 0.1221, weighted_loss: 0.0464, label: 0, bag_size: 1190
batch 299, loss: 0.0057, instance_loss: 0.1149, weighted_loss: 0.0384, label: 4, bag_size: 790
batch 319, loss: 0.0505, instance_loss: 0.5310, weighted_loss: 0.1946, label: 1, bag_size: 786
batch 339, loss: 0.3859, instance_loss: 0.3318, weighted_loss: 0.3697, label: 2, bag_size: 1348
batch 359, loss: 0.0396, instance_loss: 0.3071, weighted_loss: 0.1199, label: 2, bag_size: 1047
batch 379, loss: 0.0107, instance_loss: 0.1633, weighted_loss: 0.0565, label: 0, bag_size: 1190
batch 399, loss: 0.0144, instance_loss: 0.2740, weighted_loss: 0.0923, label: 3, bag_size: 1118
batch 419, loss: 0.0109, instance_loss: 0.1715, weighted_loss: 0.0591, label: 1, bag_size: 938


class 0 clustering acc 0.987764705882353: correct 16792/17000
class 1 clustering acc 0.5379411764705883: correct 1829/3400
Epoch: 46, train_loss: 0.1110, train_clustering_loss:  0.2593, train_error: 0.0306
class 0: acc 0.9901960784313726, correct 101/102
class 1: acc 0.922077922077922, correct 71/77
class 2: acc 0.9230769230769231, correct 60/65
class 3: acc 1.0, correct 93/93
class 4: acc 0.9886363636363636, correct 87/88

Val Set, val_loss: 1.5352, val_error: 0.4000, auc: 0.7565
class 0 clustering acc 0.957: correct 1914/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6153846153846154, correct 16/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0016, instance_loss: 0.0461, weighted_loss: 0.0149, label: 4, bag_size: 729
batch 39, loss: 2.5083, instance_loss: 0.6663, weighted_loss: 1.9557, label: 1, bag_size: 1799
batch 59, loss: 0.0006, instance_loss: 0.0276, weighted_loss: 0.0087, label: 3, bag_size: 405
batch 79, loss: 0.3557, instance_loss: 0.6625, weighted_loss: 0.4477, label: 1, bag_size: 778
batch 99, loss: 0.1248, instance_loss: 0.4214, weighted_loss: 0.2138, label: 2, bag_size: 1069
batch 119, loss: 0.0003, instance_loss: 0.0907, weighted_loss: 0.0274, label: 4, bag_size: 729
batch 139, loss: 0.0395, instance_loss: 0.3132, weighted_loss: 0.1216, label: 4, bag_size: 590
batch 159, loss: 0.2182, instance_loss: 0.4070, weighted_loss: 0.2748, label: 2, bag_size: 967
batch 179, loss: 0.0723, instance_loss: 0.3471, weighted_loss: 0.1547, label: 4, bag_size: 663
batch 199, loss: 0.0216, instance_loss: 0.4080, weighted_loss: 0.1375, label: 4, bag_size: 436
batch 219, loss: 0.0053, instance_loss: 0.0596, weighted_loss: 0.0216, label: 0, bag_size: 729
batch 239, loss: 0.0089, instance_loss: 0.0865, weighted_loss: 0.0321, label: 0, bag_size: 1255
batch 259, loss: 0.0007, instance_loss: 0.0144, weighted_loss: 0.0048, label: 3, bag_size: 405
batch 279, loss: 0.0101, instance_loss: 0.0658, weighted_loss: 0.0268, label: 0, bag_size: 1143
batch 299, loss: 0.0153, instance_loss: 0.7213, weighted_loss: 0.2271, label: 3, bag_size: 283
batch 319, loss: 0.1853, instance_loss: 0.2147, weighted_loss: 0.1941, label: 2, bag_size: 1348
batch 339, loss: 0.0526, instance_loss: 0.2991, weighted_loss: 0.1266, label: 2, bag_size: 1232
batch 359, loss: 0.0000, instance_loss: 0.0147, weighted_loss: 0.0044, label: 4, bag_size: 764
batch 379, loss: 0.0862, instance_loss: 0.2751, weighted_loss: 0.1429, label: 2, bag_size: 286
batch 399, loss: 0.0502, instance_loss: 0.2289, weighted_loss: 0.1038, label: 1, bag_size: 534
batch 419, loss: 0.0001, instance_loss: 0.1017, weighted_loss: 0.0306, label: 4, bag_size: 729


class 0 clustering acc 0.9853529411764705: correct 16751/17000
class 1 clustering acc 0.4852941176470588: correct 1650/3400
Epoch: 47, train_loss: 0.1989, train_clustering_loss:  0.2908, train_error: 0.0635
class 0: acc 0.9436619718309859, correct 67/71
class 1: acc 0.8313253012048193, correct 69/83
class 2: acc 0.9174311926605505, correct 100/109
class 3: acc 1.0, correct 83/83
class 4: acc 1.0, correct 79/79

Val Set, val_loss: 1.4264, val_error: 0.4000, auc: 0.7887
class 0 clustering acc 0.9665: correct 1933/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6923076923076923, correct 18/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.3933, instance_loss: 0.7284, weighted_loss: 0.4938, label: 1, bag_size: 660
batch 39, loss: 0.0037, instance_loss: 0.7752, weighted_loss: 0.2352, label: 4, bag_size: 974
batch 59, loss: 0.0024, instance_loss: 0.0402, weighted_loss: 0.0138, label: 3, bag_size: 305
batch 79, loss: 0.0041, instance_loss: 0.0656, weighted_loss: 0.0225, label: 3, bag_size: 729
batch 99, loss: 0.0042, instance_loss: 0.0604, weighted_loss: 0.0210, label: 1, bag_size: 1426
batch 119, loss: 0.0036, instance_loss: 0.1958, weighted_loss: 0.0612, label: 0, bag_size: 729
batch 139, loss: 0.0001, instance_loss: 0.0383, weighted_loss: 0.0116, label: 4, bag_size: 729
batch 159, loss: 0.0009, instance_loss: 0.1041, weighted_loss: 0.0319, label: 3, bag_size: 821
batch 179, loss: 0.0068, instance_loss: 0.1673, weighted_loss: 0.0550, label: 0, bag_size: 729
batch 199, loss: 0.0743, instance_loss: 0.4170, weighted_loss: 0.1771, label: 1, bag_size: 1127
batch 219, loss: 0.1677, instance_loss: 0.4235, weighted_loss: 0.2444, label: 0, bag_size: 423
batch 239, loss: 0.0008, instance_loss: 0.5911, weighted_loss: 0.1779, label: 4, bag_size: 1176
batch 259, loss: 0.1567, instance_loss: 0.2784, weighted_loss: 0.1932, label: 1, bag_size: 886
batch 279, loss: 0.0009, instance_loss: 0.0578, weighted_loss: 0.0179, label: 3, bag_size: 451
batch 299, loss: 0.0005, instance_loss: 0.0672, weighted_loss: 0.0205, label: 4, bag_size: 1278
batch 319, loss: 0.0000, instance_loss: 0.0533, weighted_loss: 0.0160, label: 4, bag_size: 646
batch 339, loss: 0.0514, instance_loss: 0.2223, weighted_loss: 0.1027, label: 2, bag_size: 2703
batch 359, loss: 0.0016, instance_loss: 0.0312, weighted_loss: 0.0105, label: 0, bag_size: 402
batch 379, loss: 0.1181, instance_loss: 0.5702, weighted_loss: 0.2537, label: 3, bag_size: 317
batch 399, loss: 0.0010, instance_loss: 0.0302, weighted_loss: 0.0097, label: 0, bag_size: 1466
batch 419, loss: 0.1763, instance_loss: 0.2898, weighted_loss: 0.2104, label: 2, bag_size: 913


class 0 clustering acc 0.9896470588235294: correct 16824/17000
class 1 clustering acc 0.5461764705882353: correct 1857/3400
Epoch: 48, train_loss: 0.1236, train_clustering_loss:  0.2562, train_error: 0.0447
class 0: acc 0.989247311827957, correct 92/93
class 1: acc 0.8875, correct 71/80
class 2: acc 0.8947368421052632, correct 68/76
class 3: acc 1.0, correct 90/90
class 4: acc 0.9883720930232558, correct 85/86

Val Set, val_loss: 1.5305, val_error: 0.4200, auc: 0.7843
class 0 clustering acc 0.963: correct 1926/2000
class 1 clustering acc 0.2075: correct 83/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6538461538461539, correct 17/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.3344, instance_loss: 0.5032, weighted_loss: 0.3850, label: 2, bag_size: 1133
batch 39, loss: 0.0129, instance_loss: 0.3734, weighted_loss: 0.1210, label: 4, bag_size: 436
batch 59, loss: 0.0000, instance_loss: 0.0922, weighted_loss: 0.0277, label: 4, bag_size: 646
batch 79, loss: 0.2186, instance_loss: 0.2772, weighted_loss: 0.2362, label: 2, bag_size: 1039
batch 99, loss: 0.0071, instance_loss: 0.0750, weighted_loss: 0.0275, label: 0, bag_size: 360
batch 119, loss: 0.0015, instance_loss: 0.0224, weighted_loss: 0.0078, label: 3, bag_size: 729
batch 139, loss: 0.4133, instance_loss: 0.6838, weighted_loss: 0.4944, label: 2, bag_size: 110
batch 159, loss: 0.4496, instance_loss: 0.3307, weighted_loss: 0.4139, label: 0, bag_size: 912
batch 179, loss: 0.1240, instance_loss: 0.7744, weighted_loss: 0.3191, label: 1, bag_size: 660
batch 199, loss: 0.1033, instance_loss: 0.6957, weighted_loss: 0.2810, label: 4, bag_size: 210
batch 219, loss: 0.0419, instance_loss: 0.1785, weighted_loss: 0.0829, label: 2, bag_size: 846
batch 239, loss: 0.0106, instance_loss: 0.1157, weighted_loss: 0.0421, label: 1, bag_size: 945
batch 259, loss: 0.0572, instance_loss: 0.6332, weighted_loss: 0.2300, label: 3, bag_size: 671
batch 279, loss: 1.1119, instance_loss: 0.8543, weighted_loss: 1.0346, label: 1, bag_size: 778
batch 299, loss: 0.0133, instance_loss: 0.4740, weighted_loss: 0.1515, label: 1, bag_size: 648
batch 319, loss: 0.1055, instance_loss: 0.2423, weighted_loss: 0.1466, label: 3, bag_size: 849
batch 339, loss: 0.0040, instance_loss: 0.2678, weighted_loss: 0.0831, label: 4, bag_size: 663
batch 359, loss: 0.0434, instance_loss: 0.2108, weighted_loss: 0.0936, label: 0, bag_size: 255
batch 379, loss: 0.0022, instance_loss: 0.1837, weighted_loss: 0.0567, label: 3, bag_size: 841
batch 399, loss: 0.0571, instance_loss: 0.1965, weighted_loss: 0.0989, label: 0, bag_size: 367
batch 419, loss: 0.1550, instance_loss: 0.2247, weighted_loss: 0.1759, label: 2, bag_size: 525


class 0 clustering acc 0.9864117647058823: correct 16769/17000
class 1 clustering acc 0.4961764705882353: correct 1687/3400
Epoch: 49, train_loss: 0.1396, train_clustering_loss:  0.2852, train_error: 0.0353
class 0: acc 0.987012987012987, correct 76/77
class 1: acc 0.9157894736842105, correct 87/95
class 2: acc 0.9367088607594937, correct 74/79
class 3: acc 1.0, correct 82/82
class 4: acc 0.9891304347826086, correct 91/92

Val Set, val_loss: 1.5488, val_error: 0.4000, auc: 0.7994
class 0 clustering acc 0.9645: correct 1929/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6538461538461539, correct 17/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0228, instance_loss: 0.1278, weighted_loss: 0.0543, label: 2, bag_size: 1569
batch 39, loss: 2.2906, instance_loss: 0.6883, weighted_loss: 1.8099, label: 2, bag_size: 411
batch 59, loss: 0.0048, instance_loss: 0.0472, weighted_loss: 0.0175, label: 0, bag_size: 1143
batch 79, loss: 0.0191, instance_loss: 0.2340, weighted_loss: 0.0836, label: 0, bag_size: 371
batch 99, loss: 0.5913, instance_loss: 0.5779, weighted_loss: 0.5873, label: 2, bag_size: 272
batch 119, loss: 0.0009, instance_loss: 0.0243, weighted_loss: 0.0079, label: 3, bag_size: 556
batch 139, loss: 0.5777, instance_loss: 0.7056, weighted_loss: 0.6161, label: 2, bag_size: 959
batch 159, loss: 0.0086, instance_loss: 0.2960, weighted_loss: 0.0948, label: 1, bag_size: 504
batch 179, loss: 0.0002, instance_loss: 0.1267, weighted_loss: 0.0381, label: 0, bag_size: 729
batch 199, loss: 0.2213, instance_loss: 0.2512, weighted_loss: 0.2303, label: 0, bag_size: 246
batch 219, loss: 0.0292, instance_loss: 0.2474, weighted_loss: 0.0946, label: 0, bag_size: 1190
batch 239, loss: 0.0006, instance_loss: 0.0125, weighted_loss: 0.0042, label: 0, bag_size: 521
batch 259, loss: 0.0000, instance_loss: 0.0139, weighted_loss: 0.0042, label: 4, bag_size: 764
batch 279, loss: 1.8211, instance_loss: 0.6850, weighted_loss: 1.4803, label: 1, bag_size: 1144
batch 299, loss: 0.0972, instance_loss: 0.1866, weighted_loss: 0.1240, label: 0, bag_size: 200
batch 319, loss: 0.0177, instance_loss: 0.4390, weighted_loss: 0.1441, label: 4, bag_size: 675
batch 339, loss: 0.2157, instance_loss: 0.5932, weighted_loss: 0.3290, label: 0, bag_size: 818
batch 359, loss: 0.0013, instance_loss: 0.0735, weighted_loss: 0.0230, label: 3, bag_size: 729
batch 379, loss: 0.0014, instance_loss: 0.0186, weighted_loss: 0.0065, label: 0, bag_size: 1174
batch 399, loss: 0.1308, instance_loss: 0.6659, weighted_loss: 0.2913, label: 1, bag_size: 778
batch 419, loss: 0.0351, instance_loss: 0.2658, weighted_loss: 0.1043, label: 4, bag_size: 675


class 0 clustering acc 0.9842352941176471: correct 16732/17000
class 1 clustering acc 0.49323529411764705: correct 1677/3400
Epoch: 50, train_loss: 0.1555, train_clustering_loss:  0.2914, train_error: 0.0541
class 0: acc 0.9651162790697675, correct 83/86
class 1: acc 0.872093023255814, correct 75/86
class 2: acc 0.9174311926605505, correct 100/109
class 3: acc 1.0, correct 80/80
class 4: acc 1.0, correct 64/64

Val Set, val_loss: 1.7643, val_error: 0.4400, auc: 0.7874
class 0 clustering acc 0.964: correct 1928/2000
class 1 clustering acc 0.1775: correct 71/400
class 0: acc 0.5, correct 3/6
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.5769230769230769, correct 15/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.0017, instance_loss: 0.1051, weighted_loss: 0.0327, label: 3, bag_size: 1019
batch 39, loss: 0.0000, instance_loss: 0.0433, weighted_loss: 0.0130, label: 3, bag_size: 729
batch 59, loss: 3.1850, instance_loss: 0.7728, weighted_loss: 2.4613, label: 1, bag_size: 1799
batch 79, loss: 0.0002, instance_loss: 0.0120, weighted_loss: 0.0037, label: 3, bag_size: 405
batch 99, loss: 0.0001, instance_loss: 0.0712, weighted_loss: 0.0214, label: 4, bag_size: 729
batch 119, loss: 0.0369, instance_loss: 0.1525, weighted_loss: 0.0716, label: 2, bag_size: 292
batch 139, loss: 0.0107, instance_loss: 0.0880, weighted_loss: 0.0338, label: 2, bag_size: 1242
batch 159, loss: 0.0184, instance_loss: 0.4943, weighted_loss: 0.1612, label: 2, bag_size: 1139
batch 179, loss: 0.3597, instance_loss: 0.4231, weighted_loss: 0.3788, label: 0, bag_size: 423
batch 199, loss: 0.0408, instance_loss: 0.4502, weighted_loss: 0.1636, label: 3, bag_size: 200
batch 219, loss: 0.0001, instance_loss: 0.0231, weighted_loss: 0.0070, label: 3, bag_size: 729
batch 239, loss: 0.0084, instance_loss: 0.1645, weighted_loss: 0.0552, label: 1, bag_size: 690
batch 259, loss: 0.1324, instance_loss: 0.7618, weighted_loss: 0.3212, label: 4, bag_size: 210
batch 279, loss: 2.4140, instance_loss: 0.8005, weighted_loss: 1.9300, label: 1, bag_size: 448
batch 299, loss: 0.0416, instance_loss: 0.1275, weighted_loss: 0.0674, label: 2, bag_size: 1123
batch 319, loss: 0.0009, instance_loss: 0.0334, weighted_loss: 0.0107, label: 3, bag_size: 729
batch 339, loss: 0.0017, instance_loss: 0.1991, weighted_loss: 0.0609, label: 0, bag_size: 729
batch 359, loss: 0.0494, instance_loss: 0.3223, weighted_loss: 0.1313, label: 2, bag_size: 1218
batch 379, loss: 0.2901, instance_loss: 0.7209, weighted_loss: 0.4193, label: 1, bag_size: 875
batch 399, loss: 0.0338, instance_loss: 0.2536, weighted_loss: 0.0998, label: 2, bag_size: 292
batch 419, loss: 0.0004, instance_loss: 0.0725, weighted_loss: 0.0221, label: 4, bag_size: 790


class 0 clustering acc 0.985: correct 16745/17000
class 1 clustering acc 0.5167647058823529: correct 1757/3400
Epoch: 51, train_loss: 0.1434, train_clustering_loss:  0.2787, train_error: 0.0424
class 0: acc 0.9866666666666667, correct 74/75
class 1: acc 0.8333333333333334, correct 60/72
class 2: acc 0.954954954954955, correct 106/111
class 3: acc 1.0, correct 102/102
class 4: acc 1.0, correct 65/65

Val Set, val_loss: 1.4813, val_error: 0.3800, auc: 0.8007
class 0 clustering acc 0.964: correct 1928/2000
class 1 clustering acc 0.22: correct 88/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6538461538461539, correct 17/26
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.0, correct 0/1
EarlyStopping counter: 38 out of 20
Early stopping
Val error: 0.3000, ROC AUC: 0.7697
Test error: 0.3800, ROC AUC: 0.8049
class 0: acc 0.6, correct 9/15
class 1: acc 0.6, correct 6/10
class 2: acc 0.8, correct 16/20
class 3: acc 0.0, correct 0/3
class 4: acc 0.0, correct 0/2
finished!
end script

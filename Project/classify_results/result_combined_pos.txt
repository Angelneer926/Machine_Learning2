
Load Dataset
label column: label
label dictionary: {'CC': 0, 'EC': 1, 'HGSC': 2, 'LGSC': 3, 'MC': 4}
number of classes: 5
slide-level counts:  
 label
2    206
1    117
0    106
4    109
3    107
Name: count, dtype: int64
Patient-LVL; Number of samples registered in class 0: 106
Slide-LVL; Number of samples registered in class 0: 106
Patient-LVL; Number of samples registered in class 1: 117
Slide-LVL; Number of samples registered in class 1: 117
Patient-LVL; Number of samples registered in class 2: 206
Slide-LVL; Number of samples registered in class 2: 206
Patient-LVL; Number of samples registered in class 3: 107
Slide-LVL; Number of samples registered in class 3: 107
Patient-LVL; Number of samples registered in class 4: 109
Slide-LVL; Number of samples registered in class 4: 109
split_dir:  splits/task_1_tumor_subtyping_5_classes_100
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  task_1_tumor_subtyping_5_classes
max_epochs:  200
results_dir:  ./results
lr:  0.0002
experiment:  task_1_tumor_subtyping_5_classes
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_sb
model_size:  small
use_drop_out:  0.25
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/task_1_tumor_subtyping_5_classes_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7018, instance_loss: 1.2226, weighted_loss: 1.5580, label: 2, bag_size: 1167
batch 39, loss: 1.6412, instance_loss: 1.0998, weighted_loss: 1.4788, label: 0, bag_size: 143
batch 59, loss: 1.3861, instance_loss: 0.8541, weighted_loss: 1.2265, label: 4, bag_size: 78
batch 79, loss: 1.2192, instance_loss: 0.7052, weighted_loss: 1.0650, label: 1, bag_size: 1191
batch 99, loss: 1.3344, instance_loss: 0.5830, weighted_loss: 1.1090, label: 1, bag_size: 446
batch 119, loss: 1.8755, instance_loss: 0.5726, weighted_loss: 1.4846, label: 0, bag_size: 143
batch 139, loss: 1.1150, instance_loss: 0.4954, weighted_loss: 0.9291, label: 1, bag_size: 504
batch 159, loss: 1.9751, instance_loss: 0.5560, weighted_loss: 1.5494, label: 3, bag_size: 46
batch 179, loss: 1.7638, instance_loss: 0.5485, weighted_loss: 1.3992, label: 3, bag_size: 20
batch 199, loss: 1.6739, instance_loss: 0.5325, weighted_loss: 1.3315, label: 3, bag_size: 1380
batch 219, loss: 1.5338, instance_loss: 0.5188, weighted_loss: 1.2293, label: 1, bag_size: 1096
batch 239, loss: 1.5992, instance_loss: 0.5454, weighted_loss: 1.2831, label: 0, bag_size: 1065
batch 259, loss: 1.5128, instance_loss: 0.5268, weighted_loss: 1.2170, label: 2, bag_size: 525
batch 279, loss: 1.9823, instance_loss: 0.5414, weighted_loss: 1.5500, label: 0, bag_size: 148
batch 299, loss: 1.2804, instance_loss: 0.4905, weighted_loss: 1.0434, label: 2, bag_size: 1416
batch 319, loss: 1.4409, instance_loss: 0.5167, weighted_loss: 1.1637, label: 1, bag_size: 1191
batch 339, loss: 1.3553, instance_loss: 0.4922, weighted_loss: 1.0964, label: 1, bag_size: 867
batch 359, loss: 1.1791, instance_loss: 0.4991, weighted_loss: 0.9751, label: 1, bag_size: 937
batch 379, loss: 1.4417, instance_loss: 0.5129, weighted_loss: 1.1630, label: 0, bag_size: 898
batch 399, loss: 1.1818, instance_loss: 0.4966, weighted_loss: 0.9762, label: 1, bag_size: 1409
batch 419, loss: 1.4707, instance_loss: 0.4999, weighted_loss: 1.1795, label: 0, bag_size: 466
batch 439, loss: 1.0160, instance_loss: 0.4378, weighted_loss: 0.8425, label: 1, bag_size: 1014
batch 459, loss: 1.6172, instance_loss: 0.5153, weighted_loss: 1.2867, label: 2, bag_size: 345
batch 479, loss: 0.4502, instance_loss: 0.3637, weighted_loss: 0.4243, label: 4, bag_size: 150
batch 499, loss: 1.4210, instance_loss: 0.5013, weighted_loss: 1.1451, label: 0, bag_size: 736
batch 519, loss: 0.4246, instance_loss: 0.3558, weighted_loss: 0.4039, label: 4, bag_size: 23
batch 539, loss: 1.2459, instance_loss: 0.4826, weighted_loss: 1.0169, label: 2, bag_size: 409


class 0 clustering acc 0.9963302752293578: correct 21720/21800
class 1 clustering acc 0.0027522935779816515: correct 12/4360
Epoch: 0, train_loss: 1.4469, train_clustering_loss:  0.5919, train_error: 0.6147
class 0: acc 0.020202020202020204, correct 2/99
class 1: acc 0.6311475409836066, correct 77/122
class 2: acc 0.21904761904761905, correct 23/105
class 3: acc 0.2818181818181818, correct 31/110
class 4: acc 0.7064220183486238, correct 77/109

Val Set, val_loss: 1.4093, val_error: 0.5400, auc: 0.7350
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/9
class 1: acc 0.2, correct 2/10
class 2: acc 0.8947368421052632, correct 17/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.4444444444444444, correct 4/9
Validation loss decreased (inf --> 1.409282).  Saving model ...


batch 19, loss: 1.7628, instance_loss: 0.5085, weighted_loss: 1.3865, label: 3, bag_size: 1250
batch 39, loss: 1.4222, instance_loss: 0.5035, weighted_loss: 1.1466, label: 0, bag_size: 630
batch 59, loss: 1.1604, instance_loss: 0.4520, weighted_loss: 0.9479, label: 1, bag_size: 1261
batch 79, loss: 1.0672, instance_loss: 0.4939, weighted_loss: 0.8952, label: 3, bag_size: 16
batch 99, loss: 1.6132, instance_loss: 0.5191, weighted_loss: 1.2850, label: 0, bag_size: 410
batch 119, loss: 1.3058, instance_loss: 0.5046, weighted_loss: 1.0654, label: 0, bag_size: 756
batch 139, loss: 1.3047, instance_loss: 0.4981, weighted_loss: 1.0627, label: 0, bag_size: 1034
batch 159, loss: 2.4002, instance_loss: 0.6005, weighted_loss: 1.8603, label: 4, bag_size: 817
batch 179, loss: 0.2323, instance_loss: 0.1874, weighted_loss: 0.2188, label: 4, bag_size: 44
batch 199, loss: 0.9519, instance_loss: 0.4573, weighted_loss: 0.8035, label: 3, bag_size: 20
batch 219, loss: 1.4690, instance_loss: 0.5291, weighted_loss: 1.1870, label: 1, bag_size: 1376
batch 239, loss: 0.7965, instance_loss: 0.4491, weighted_loss: 0.6923, label: 3, bag_size: 18
batch 259, loss: 1.4583, instance_loss: 0.4942, weighted_loss: 1.1691, label: 3, bag_size: 607
batch 279, loss: 1.4278, instance_loss: 0.4999, weighted_loss: 1.1494, label: 0, bag_size: 245
batch 299, loss: 1.1412, instance_loss: 0.4602, weighted_loss: 0.9369, label: 2, bag_size: 935
batch 319, loss: 0.9370, instance_loss: 0.4364, weighted_loss: 0.7868, label: 1, bag_size: 320
batch 339, loss: 1.1200, instance_loss: 0.4737, weighted_loss: 0.9261, label: 1, bag_size: 690
batch 359, loss: 0.3915, instance_loss: 0.2330, weighted_loss: 0.3440, label: 4, bag_size: 39
batch 379, loss: 2.2563, instance_loss: 0.7323, weighted_loss: 1.7991, label: 0, bag_size: 116
batch 399, loss: 1.4062, instance_loss: 0.5191, weighted_loss: 1.1401, label: 0, bag_size: 818
batch 419, loss: 0.4146, instance_loss: 0.2108, weighted_loss: 0.3534, label: 4, bag_size: 140
batch 439, loss: 0.6423, instance_loss: 0.3894, weighted_loss: 0.5664, label: 1, bag_size: 711
batch 459, loss: 1.0601, instance_loss: 0.3848, weighted_loss: 0.8575, label: 1, bag_size: 959
batch 479, loss: 1.4752, instance_loss: 0.5173, weighted_loss: 1.1878, label: 0, bag_size: 1190
batch 499, loss: 1.9724, instance_loss: 0.5250, weighted_loss: 1.5382, label: 4, bag_size: 711
batch 519, loss: 1.0616, instance_loss: 0.4773, weighted_loss: 0.8863, label: 0, bag_size: 1466
batch 539, loss: 1.1671, instance_loss: 0.4592, weighted_loss: 0.9547, label: 1, bag_size: 1096


class 0 clustering acc 0.9985779816513761: correct 21769/21800
class 1 clustering acc 0.04908256880733945: correct 214/4360
Epoch: 1, train_loss: 1.2085, train_clustering_loss:  0.4525, train_error: 0.4661
class 0: acc 0.20909090909090908, correct 23/110
class 1: acc 0.5047619047619047, correct 53/105
class 2: acc 0.6153846153846154, correct 64/104
class 3: acc 0.6132075471698113, correct 65/106
class 4: acc 0.7166666666666667, correct 86/120

Val Set, val_loss: 1.3890, val_error: 0.5600, auc: 0.7530
class 0 clustering acc 0.9995: correct 1999/2000
class 1 clustering acc 0.0775: correct 31/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9, correct 9/10
class 2: acc 0.0, correct 0/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
Validation loss decreased (1.409282 --> 1.388996).  Saving model ...


batch 19, loss: 0.6341, instance_loss: 0.3250, weighted_loss: 0.5414, label: 1, bag_size: 949
batch 39, loss: 1.9026, instance_loss: 0.5796, weighted_loss: 1.5057, label: 2, bag_size: 1231
batch 59, loss: 1.1326, instance_loss: 0.4082, weighted_loss: 0.9152, label: 1, bag_size: 1096
batch 79, loss: 0.2011, instance_loss: 0.1480, weighted_loss: 0.1852, label: 4, bag_size: 86
batch 99, loss: 1.0724, instance_loss: 0.4719, weighted_loss: 0.8922, label: 0, bag_size: 385
batch 119, loss: 1.1512, instance_loss: 0.4896, weighted_loss: 0.9527, label: 2, bag_size: 314
batch 139, loss: 2.6558, instance_loss: 0.6595, weighted_loss: 2.0569, label: 3, bag_size: 821
batch 159, loss: 1.8301, instance_loss: 0.5922, weighted_loss: 1.4587, label: 2, bag_size: 358
batch 179, loss: 1.1676, instance_loss: 0.4937, weighted_loss: 0.9655, label: 2, bag_size: 1533
batch 199, loss: 1.4294, instance_loss: 0.4386, weighted_loss: 1.1322, label: 1, bag_size: 648
batch 219, loss: 0.2451, instance_loss: 0.2451, weighted_loss: 0.2451, label: 3, bag_size: 41
batch 239, loss: 0.3608, instance_loss: 0.3225, weighted_loss: 0.3493, label: 4, bag_size: 23
batch 259, loss: 2.1651, instance_loss: 0.5400, weighted_loss: 1.6776, label: 1, bag_size: 657
batch 279, loss: 1.2707, instance_loss: 0.4844, weighted_loss: 1.0348, label: 0, bag_size: 818
batch 299, loss: 1.3278, instance_loss: 0.4396, weighted_loss: 1.0613, label: 1, bag_size: 1255
batch 319, loss: 1.2608, instance_loss: 0.4549, weighted_loss: 1.0190, label: 2, bag_size: 358
batch 339, loss: 1.4331, instance_loss: 0.4653, weighted_loss: 1.1428, label: 1, bag_size: 435
batch 359, loss: 1.3959, instance_loss: 0.4837, weighted_loss: 1.1223, label: 1, bag_size: 818
batch 379, loss: 1.2888, instance_loss: 0.5188, weighted_loss: 1.0578, label: 0, bag_size: 1235
batch 399, loss: 1.2635, instance_loss: 0.4657, weighted_loss: 1.0242, label: 4, bag_size: 656
batch 419, loss: 0.1657, instance_loss: 0.1978, weighted_loss: 0.1753, label: 3, bag_size: 31
batch 439, loss: 1.0865, instance_loss: 0.4548, weighted_loss: 0.8970, label: 2, bag_size: 986
batch 459, loss: 0.4813, instance_loss: 0.2831, weighted_loss: 0.4218, label: 1, bag_size: 828
batch 479, loss: 0.7375, instance_loss: 0.4001, weighted_loss: 0.6363, label: 2, bag_size: 1788
batch 499, loss: 0.1256, instance_loss: 0.2051, weighted_loss: 0.1495, label: 3, bag_size: 20
batch 519, loss: 1.6639, instance_loss: 0.5472, weighted_loss: 1.3289, label: 4, bag_size: 646
batch 539, loss: 1.0370, instance_loss: 0.4550, weighted_loss: 0.8624, label: 0, bag_size: 1065


class 0 clustering acc 0.9954128440366973: correct 21700/21800
class 1 clustering acc 0.1360091743119266: correct 593/4360
Epoch: 2, train_loss: 1.0368, train_clustering_loss:  0.4151, train_error: 0.3798
class 0: acc 0.46226415094339623, correct 49/106
class 1: acc 0.6372549019607843, correct 65/102
class 2: acc 0.584070796460177, correct 66/113
class 3: acc 0.7788461538461539, correct 81/104
class 4: acc 0.6416666666666667, correct 77/120

Val Set, val_loss: 1.2484, val_error: 0.5200, auc: 0.7637
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0725: correct 29/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.2631578947368421, correct 5/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.4444444444444444, correct 4/9
Validation loss decreased (1.388996 --> 1.248392).  Saving model ...


batch 19, loss: 2.4491, instance_loss: 0.5915, weighted_loss: 1.8918, label: 1, bag_size: 1376
batch 39, loss: 1.4426, instance_loss: 0.4920, weighted_loss: 1.1574, label: 0, bag_size: 801
batch 59, loss: 1.1624, instance_loss: 0.4436, weighted_loss: 0.9467, label: 1, bag_size: 320
batch 79, loss: 0.6876, instance_loss: 0.3856, weighted_loss: 0.5970, label: 2, bag_size: 1200
batch 99, loss: 0.7715, instance_loss: 0.3926, weighted_loss: 0.6578, label: 0, bag_size: 402
batch 119, loss: 0.7256, instance_loss: 0.3667, weighted_loss: 0.6179, label: 2, bag_size: 248
batch 139, loss: 0.9331, instance_loss: 0.3917, weighted_loss: 0.7707, label: 1, bag_size: 648
batch 159, loss: 0.1921, instance_loss: 0.1125, weighted_loss: 0.1682, label: 4, bag_size: 167
batch 179, loss: 2.7909, instance_loss: 0.5884, weighted_loss: 2.1302, label: 3, bag_size: 1118
batch 199, loss: 0.1400, instance_loss: 0.1754, weighted_loss: 0.1506, label: 3, bag_size: 28
batch 219, loss: 0.7305, instance_loss: 0.4140, weighted_loss: 0.6356, label: 0, bag_size: 385
batch 239, loss: 0.5344, instance_loss: 0.3715, weighted_loss: 0.4855, label: 0, bag_size: 385
batch 259, loss: 1.1324, instance_loss: 0.4579, weighted_loss: 0.9300, label: 2, bag_size: 252
batch 279, loss: 2.0329, instance_loss: 0.6151, weighted_loss: 1.6076, label: 1, bag_size: 1409
batch 299, loss: 1.5742, instance_loss: 0.5591, weighted_loss: 1.2697, label: 1, bag_size: 470
batch 319, loss: 0.1703, instance_loss: 0.1327, weighted_loss: 0.1590, label: 4, bag_size: 39
batch 339, loss: 0.6108, instance_loss: 0.3410, weighted_loss: 0.5299, label: 2, bag_size: 1164
batch 359, loss: 0.1010, instance_loss: 0.1870, weighted_loss: 0.1268, label: 3, bag_size: 19
batch 379, loss: 0.8557, instance_loss: 0.3646, weighted_loss: 0.7084, label: 1, bag_size: 1144
batch 399, loss: 1.2103, instance_loss: 0.5156, weighted_loss: 1.0019, label: 4, bag_size: 297
batch 419, loss: 1.9332, instance_loss: 0.5684, weighted_loss: 1.5238, label: 1, bag_size: 446
batch 439, loss: 0.5121, instance_loss: 0.3676, weighted_loss: 0.4688, label: 0, bag_size: 524
batch 459, loss: 0.9904, instance_loss: 0.4597, weighted_loss: 0.8312, label: 2, bag_size: 245
batch 479, loss: 0.2591, instance_loss: 0.2567, weighted_loss: 0.2584, label: 4, bag_size: 47
batch 499, loss: 0.1506, instance_loss: 0.1598, weighted_loss: 0.1534, label: 4, bag_size: 160
batch 519, loss: 0.6058, instance_loss: 0.3526, weighted_loss: 0.5298, label: 2, bag_size: 347
batch 539, loss: 0.7227, instance_loss: 0.3474, weighted_loss: 0.6101, label: 2, bag_size: 480


class 0 clustering acc 0.9950917431192661: correct 21693/21800
class 1 clustering acc 0.17660550458715596: correct 770/4360
Epoch: 3, train_loss: 0.9601, train_clustering_loss:  0.3985, train_error: 0.3413
class 0: acc 0.5897435897435898, correct 69/117
class 1: acc 0.5116279069767442, correct 44/86
class 2: acc 0.7461538461538462, correct 97/130
class 3: acc 0.7333333333333333, correct 77/105
class 4: acc 0.6728971962616822, correct 72/107

Val Set, val_loss: 1.1400, val_error: 0.3800, auc: 0.7784
class 0 clustering acc 0.9995: correct 1999/2000
class 1 clustering acc 0.0625: correct 25/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
Validation loss decreased (1.248392 --> 1.140039).  Saving model ...


batch 19, loss: 0.9312, instance_loss: 0.3995, weighted_loss: 0.7717, label: 1, bag_size: 470
batch 39, loss: 1.5040, instance_loss: 0.5164, weighted_loss: 1.2077, label: 0, bag_size: 868
batch 59, loss: 0.4575, instance_loss: 0.3520, weighted_loss: 0.4258, label: 4, bag_size: 20
batch 79, loss: 0.5995, instance_loss: 0.3683, weighted_loss: 0.5301, label: 2, bag_size: 868
batch 99, loss: 0.6750, instance_loss: 0.3679, weighted_loss: 0.5828, label: 2, bag_size: 1788
batch 119, loss: 0.9392, instance_loss: 0.4524, weighted_loss: 0.7932, label: 0, bag_size: 472
batch 139, loss: 0.8590, instance_loss: 0.4600, weighted_loss: 0.7393, label: 2, bag_size: 846
batch 159, loss: 0.6700, instance_loss: 0.4181, weighted_loss: 0.5944, label: 0, bag_size: 472
batch 179, loss: 1.6109, instance_loss: 0.6466, weighted_loss: 1.3217, label: 3, bag_size: 791
batch 199, loss: 0.1068, instance_loss: 0.1806, weighted_loss: 0.1289, label: 3, bag_size: 18
batch 219, loss: 0.4624, instance_loss: 0.2874, weighted_loss: 0.4099, label: 4, bag_size: 38
batch 239, loss: 1.4089, instance_loss: 0.5110, weighted_loss: 1.1395, label: 2, bag_size: 537
batch 259, loss: 1.1347, instance_loss: 0.4509, weighted_loss: 0.9296, label: 2, bag_size: 373
batch 279, loss: 0.9629, instance_loss: 0.3960, weighted_loss: 0.7928, label: 2, bag_size: 248
batch 299, loss: 0.4927, instance_loss: 0.3327, weighted_loss: 0.4447, label: 0, bag_size: 630
batch 319, loss: 0.1153, instance_loss: 0.0901, weighted_loss: 0.1077, label: 4, bag_size: 101
batch 339, loss: 2.2309, instance_loss: 0.6085, weighted_loss: 1.7442, label: 1, bag_size: 1197
batch 359, loss: 0.2146, instance_loss: 0.3029, weighted_loss: 0.2411, label: 4, bag_size: 19
batch 379, loss: 0.8822, instance_loss: 0.4159, weighted_loss: 0.7423, label: 2, bag_size: 421
batch 399, loss: 0.5981, instance_loss: 0.3190, weighted_loss: 0.5144, label: 2, bag_size: 292
batch 419, loss: 0.3768, instance_loss: 0.2388, weighted_loss: 0.3354, label: 1, bag_size: 405
batch 439, loss: 1.4600, instance_loss: 0.5890, weighted_loss: 1.1987, label: 4, bag_size: 297
batch 459, loss: 1.9107, instance_loss: 0.6575, weighted_loss: 1.5348, label: 4, bag_size: 663
batch 479, loss: 0.6560, instance_loss: 0.3285, weighted_loss: 0.5578, label: 1, bag_size: 711
batch 499, loss: 0.0984, instance_loss: 0.1803, weighted_loss: 0.1230, label: 3, bag_size: 16
batch 519, loss: 0.7361, instance_loss: 0.3829, weighted_loss: 0.6301, label: 2, bag_size: 941
batch 539, loss: 1.4719, instance_loss: 0.4594, weighted_loss: 1.1682, label: 1, bag_size: 1409


class 0 clustering acc 0.9919724770642202: correct 21625/21800
class 1 clustering acc 0.24564220183486238: correct 1071/4360
Epoch: 4, train_loss: 0.8836, train_clustering_loss:  0.3781, train_error: 0.3358
class 0: acc 0.44, correct 44/100
class 1: acc 0.6942148760330579, correct 84/121
class 2: acc 0.6915887850467289, correct 74/107
class 3: acc 0.7521367521367521, correct 88/117
class 4: acc 0.72, correct 72/100

Val Set, val_loss: 1.1694, val_error: 0.4600, auc: 0.7983
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.0975: correct 39/400
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.8, correct 8/10
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.4444444444444444, correct 4/9
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4840, instance_loss: 0.3132, weighted_loss: 0.4328, label: 2, bag_size: 1218
batch 39, loss: 0.9138, instance_loss: 0.4126, weighted_loss: 0.7635, label: 1, bag_size: 868
batch 59, loss: 1.1904, instance_loss: 0.4217, weighted_loss: 0.9598, label: 1, bag_size: 1096
batch 79, loss: 0.6974, instance_loss: 0.2909, weighted_loss: 0.5754, label: 1, bag_size: 530
batch 99, loss: 0.4764, instance_loss: 0.3187, weighted_loss: 0.4291, label: 2, bag_size: 500
batch 119, loss: 0.0822, instance_loss: 0.2444, weighted_loss: 0.1309, label: 3, bag_size: 26
batch 139, loss: 0.9743, instance_loss: 0.3679, weighted_loss: 0.7924, label: 1, bag_size: 1014
batch 159, loss: 0.5059, instance_loss: 0.3078, weighted_loss: 0.4465, label: 1, bag_size: 945
batch 179, loss: 0.6578, instance_loss: 0.3318, weighted_loss: 0.5600, label: 1, bag_size: 102
batch 199, loss: 0.4125, instance_loss: 0.2083, weighted_loss: 0.3513, label: 1, bag_size: 945
batch 219, loss: 0.3367, instance_loss: 0.3071, weighted_loss: 0.3278, label: 3, bag_size: 17
batch 239, loss: 2.0734, instance_loss: 0.9769, weighted_loss: 1.7445, label: 0, bag_size: 114
batch 259, loss: 0.8662, instance_loss: 0.3584, weighted_loss: 0.7139, label: 1, bag_size: 504
batch 279, loss: 0.5296, instance_loss: 0.3981, weighted_loss: 0.4902, label: 4, bag_size: 764
batch 299, loss: 0.0602, instance_loss: 0.1834, weighted_loss: 0.0972, label: 4, bag_size: 20
batch 319, loss: 0.5303, instance_loss: 0.3304, weighted_loss: 0.4704, label: 3, bag_size: 821
batch 339, loss: 0.5655, instance_loss: 0.3255, weighted_loss: 0.4935, label: 3, bag_size: 952
batch 359, loss: 0.4874, instance_loss: 0.2569, weighted_loss: 0.4182, label: 1, bag_size: 682
batch 379, loss: 1.0340, instance_loss: 0.6546, weighted_loss: 0.9202, label: 0, bag_size: 116
batch 399, loss: 0.7018, instance_loss: 0.4874, weighted_loss: 0.6375, label: 0, bag_size: 255
batch 419, loss: 1.6407, instance_loss: 0.5214, weighted_loss: 1.3049, label: 4, bag_size: 1235
batch 439, loss: 0.5518, instance_loss: 0.4207, weighted_loss: 0.5125, label: 0, bag_size: 1133
batch 459, loss: 0.3044, instance_loss: 0.2794, weighted_loss: 0.2969, label: 1, bag_size: 858
batch 479, loss: 0.6822, instance_loss: 0.3497, weighted_loss: 0.5825, label: 2, bag_size: 1050
batch 499, loss: 1.0429, instance_loss: 0.5203, weighted_loss: 0.8861, label: 2, bag_size: 571
batch 519, loss: 0.0401, instance_loss: 0.1347, weighted_loss: 0.0684, label: 3, bag_size: 18
batch 539, loss: 0.6510, instance_loss: 0.3577, weighted_loss: 0.5630, label: 2, bag_size: 935


class 0 clustering acc 0.9920183486238532: correct 21626/21800
class 1 clustering acc 0.2727064220183486: correct 1189/4360
Epoch: 5, train_loss: 0.7715, train_clustering_loss:  0.3570, train_error: 0.2899
class 0: acc 0.6057692307692307, correct 63/104
class 1: acc 0.6851851851851852, correct 74/108
class 2: acc 0.6837606837606838, correct 80/117
class 3: acc 0.7909090909090909, correct 87/110
class 4: acc 0.7830188679245284, correct 83/106

Val Set, val_loss: 1.1712, val_error: 0.5000, auc: 0.8178
class 0 clustering acc 0.995: correct 1990/2000
class 1 clustering acc 0.0875: correct 35/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.4444444444444444, correct 4/9
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2313, instance_loss: 0.4000, weighted_loss: 0.9819, label: 1, bag_size: 1273
batch 39, loss: 1.1480, instance_loss: 0.5299, weighted_loss: 0.9626, label: 4, bag_size: 1002
batch 59, loss: 0.0568, instance_loss: 0.1629, weighted_loss: 0.0886, label: 3, bag_size: 20
batch 79, loss: 1.9358, instance_loss: 0.6320, weighted_loss: 1.5446, label: 2, bag_size: 358
batch 99, loss: 0.6090, instance_loss: 0.4442, weighted_loss: 0.5596, label: 4, bag_size: 524
batch 119, loss: 1.5968, instance_loss: 0.8888, weighted_loss: 1.3844, label: 0, bag_size: 163
batch 139, loss: 0.4451, instance_loss: 0.3693, weighted_loss: 0.4223, label: 2, bag_size: 351
batch 159, loss: 2.1269, instance_loss: 0.7812, weighted_loss: 1.7232, label: 3, bag_size: 283
batch 179, loss: 2.8910, instance_loss: 0.8058, weighted_loss: 2.2654, label: 2, bag_size: 474
batch 199, loss: 0.2667, instance_loss: 0.2097, weighted_loss: 0.2496, label: 1, bag_size: 937
batch 219, loss: 1.8215, instance_loss: 0.5026, weighted_loss: 1.4258, label: 1, bag_size: 936
batch 239, loss: 1.9519, instance_loss: 0.5942, weighted_loss: 1.5446, label: 4, bag_size: 524
batch 259, loss: 0.8728, instance_loss: 0.3883, weighted_loss: 0.7275, label: 2, bag_size: 1306
batch 279, loss: 0.6149, instance_loss: 0.3161, weighted_loss: 0.5253, label: 2, bag_size: 247
batch 299, loss: 0.3968, instance_loss: 0.2853, weighted_loss: 0.3633, label: 0, bag_size: 1301
batch 319, loss: 0.7832, instance_loss: 0.4823, weighted_loss: 0.6929, label: 2, bag_size: 878
batch 339, loss: 0.2062, instance_loss: 0.3849, weighted_loss: 0.2598, label: 4, bag_size: 14
batch 359, loss: 0.0304, instance_loss: 0.0790, weighted_loss: 0.0450, label: 3, bag_size: 43
batch 379, loss: 1.8791, instance_loss: 0.5138, weighted_loss: 1.4695, label: 1, bag_size: 657
batch 399, loss: 0.0112, instance_loss: 0.1070, weighted_loss: 0.0400, label: 3, bag_size: 24
batch 419, loss: 0.2751, instance_loss: 0.3381, weighted_loss: 0.2940, label: 1, bag_size: 648
batch 439, loss: 1.1694, instance_loss: 0.4570, weighted_loss: 0.9557, label: 2, bag_size: 237
batch 459, loss: 1.8190, instance_loss: 0.5995, weighted_loss: 1.4532, label: 3, bag_size: 317
batch 479, loss: 0.2019, instance_loss: 0.1511, weighted_loss: 0.1866, label: 1, bag_size: 937
batch 499, loss: 1.6762, instance_loss: 0.5709, weighted_loss: 1.3446, label: 3, bag_size: 343
batch 519, loss: 0.1310, instance_loss: 0.1986, weighted_loss: 0.1513, label: 0, bag_size: 524
batch 539, loss: 0.1767, instance_loss: 0.1343, weighted_loss: 0.1640, label: 1, bag_size: 994


class 0 clustering acc 0.9923394495412844: correct 21633/21800
class 1 clustering acc 0.268348623853211: correct 1170/4360
Epoch: 6, train_loss: 0.7652, train_clustering_loss:  0.3599, train_error: 0.2991
class 0: acc 0.6851851851851852, correct 74/108
class 1: acc 0.5398230088495575, correct 61/113
class 2: acc 0.7232142857142857, correct 81/112
class 3: acc 0.8240740740740741, correct 89/108
class 4: acc 0.7403846153846154, correct 77/104

Val Set, val_loss: 1.0158, val_error: 0.4200, auc: 0.8359
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
Validation loss decreased (1.140039 --> 1.015765).  Saving model ...


batch 19, loss: 1.2359, instance_loss: 0.6529, weighted_loss: 1.0610, label: 2, bag_size: 373
batch 39, loss: 0.0944, instance_loss: 0.1365, weighted_loss: 0.1070, label: 3, bag_size: 41
batch 59, loss: 0.6490, instance_loss: 0.3618, weighted_loss: 0.5628, label: 2, bag_size: 345
batch 79, loss: 0.6712, instance_loss: 0.4137, weighted_loss: 0.5940, label: 0, bag_size: 1018
batch 99, loss: 0.2877, instance_loss: 0.2060, weighted_loss: 0.2632, label: 1, bag_size: 696
batch 119, loss: 0.1531, instance_loss: 0.1817, weighted_loss: 0.1617, label: 3, bag_size: 18
batch 139, loss: 0.3636, instance_loss: 0.2439, weighted_loss: 0.3277, label: 2, bag_size: 632
batch 159, loss: 0.1512, instance_loss: 0.2476, weighted_loss: 0.1801, label: 0, bag_size: 1517
batch 179, loss: 0.2275, instance_loss: 0.1544, weighted_loss: 0.2056, label: 3, bag_size: 405
batch 199, loss: 0.1817, instance_loss: 0.2539, weighted_loss: 0.2034, label: 1, bag_size: 1255
batch 219, loss: 2.1374, instance_loss: 0.7266, weighted_loss: 1.7142, label: 3, bag_size: 200
batch 239, loss: 1.5746, instance_loss: 0.5206, weighted_loss: 1.2584, label: 1, bag_size: 435
batch 259, loss: 0.6461, instance_loss: 0.3777, weighted_loss: 0.5655, label: 2, bag_size: 405
batch 279, loss: 1.8028, instance_loss: 0.5279, weighted_loss: 1.4203, label: 0, bag_size: 350
batch 299, loss: 0.1710, instance_loss: 0.1408, weighted_loss: 0.1619, label: 1, bag_size: 636
batch 319, loss: 2.8893, instance_loss: 0.7805, weighted_loss: 2.2567, label: 3, bag_size: 706
batch 339, loss: 1.0680, instance_loss: 0.5516, weighted_loss: 0.9131, label: 2, bag_size: 784
batch 359, loss: 0.3109, instance_loss: 0.5258, weighted_loss: 0.3754, label: 4, bag_size: 24
batch 379, loss: 0.0104, instance_loss: 0.1089, weighted_loss: 0.0400, label: 3, bag_size: 20
batch 399, loss: 0.4944, instance_loss: 0.2806, weighted_loss: 0.4303, label: 2, bag_size: 1150
batch 419, loss: 0.4094, instance_loss: 0.2713, weighted_loss: 0.3679, label: 2, bag_size: 806
batch 439, loss: 0.1005, instance_loss: 0.2099, weighted_loss: 0.1333, label: 3, bag_size: 35
batch 459, loss: 0.2988, instance_loss: 0.2509, weighted_loss: 0.2844, label: 2, bag_size: 1788
batch 479, loss: 2.3132, instance_loss: 0.7294, weighted_loss: 1.8381, label: 0, bag_size: 801
batch 499, loss: 1.7153, instance_loss: 0.5259, weighted_loss: 1.3585, label: 1, bag_size: 917
batch 519, loss: 0.7846, instance_loss: 0.4139, weighted_loss: 0.6734, label: 2, bag_size: 1259
batch 539, loss: 0.0572, instance_loss: 0.3043, weighted_loss: 0.1313, label: 3, bag_size: 16


class 0 clustering acc 0.9903211009174312: correct 21589/21800
class 1 clustering acc 0.2995412844036697: correct 1306/4360
Epoch: 7, train_loss: 0.6468, train_clustering_loss:  0.3389, train_error: 0.2532
class 0: acc 0.7310924369747899, correct 87/119
class 1: acc 0.6022727272727273, correct 53/88
class 2: acc 0.7727272727272727, correct 85/110
class 3: acc 0.8411214953271028, correct 90/107
class 4: acc 0.7603305785123967, correct 92/121

Val Set, val_loss: 1.0792, val_error: 0.3800, auc: 0.8694
class 0 clustering acc 0.993: correct 1986/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.8888888888888888, correct 8/9
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0992, instance_loss: 0.1967, weighted_loss: 0.1285, label: 0, bag_size: 1517
batch 39, loss: 1.7568, instance_loss: 0.6710, weighted_loss: 1.4311, label: 2, bag_size: 679
batch 59, loss: 0.6605, instance_loss: 0.3660, weighted_loss: 0.5721, label: 1, bag_size: 747
batch 79, loss: 0.9254, instance_loss: 0.6675, weighted_loss: 0.8480, label: 0, bag_size: 143
batch 99, loss: 1.3198, instance_loss: 0.5302, weighted_loss: 1.0829, label: 2, bag_size: 1231
batch 119, loss: 2.3129, instance_loss: 0.6650, weighted_loss: 1.8185, label: 1, bag_size: 770
batch 139, loss: 0.1224, instance_loss: 0.1496, weighted_loss: 0.1306, label: 0, bag_size: 521
batch 159, loss: 0.4649, instance_loss: 0.3354, weighted_loss: 0.4261, label: 1, bag_size: 320
batch 179, loss: 1.0235, instance_loss: 0.4441, weighted_loss: 0.8497, label: 0, bag_size: 423
batch 199, loss: 1.5427, instance_loss: 0.5062, weighted_loss: 1.2318, label: 1, bag_size: 1172
batch 219, loss: 0.8620, instance_loss: 0.6975, weighted_loss: 0.8127, label: 0, bag_size: 116
batch 239, loss: 1.0694, instance_loss: 0.5340, weighted_loss: 0.9088, label: 4, bag_size: 366
batch 259, loss: 0.0189, instance_loss: 0.0669, weighted_loss: 0.0333, label: 4, bag_size: 60
batch 279, loss: 0.5032, instance_loss: 0.3270, weighted_loss: 0.4504, label: 2, bag_size: 1653
batch 299, loss: 0.4703, instance_loss: 0.2832, weighted_loss: 0.4142, label: 2, bag_size: 1050
batch 319, loss: 0.8302, instance_loss: 0.4369, weighted_loss: 0.7122, label: 1, bag_size: 442
batch 339, loss: 0.0231, instance_loss: 0.2034, weighted_loss: 0.0772, label: 3, bag_size: 33
batch 359, loss: 0.3593, instance_loss: 0.2776, weighted_loss: 0.3348, label: 0, bag_size: 1046
batch 379, loss: 0.5888, instance_loss: 0.7054, weighted_loss: 0.6238, label: 4, bag_size: 663
batch 399, loss: 1.9020, instance_loss: 0.6731, weighted_loss: 1.5333, label: 4, bag_size: 511
batch 419, loss: 0.8449, instance_loss: 0.3734, weighted_loss: 0.7034, label: 3, bag_size: 936
batch 439, loss: 0.3179, instance_loss: 0.2718, weighted_loss: 0.3041, label: 0, bag_size: 607
batch 459, loss: 0.5810, instance_loss: 0.2630, weighted_loss: 0.4856, label: 4, bag_size: 19
batch 479, loss: 0.0773, instance_loss: 0.2182, weighted_loss: 0.1195, label: 4, bag_size: 168
batch 499, loss: 0.2621, instance_loss: 0.2375, weighted_loss: 0.2547, label: 2, bag_size: 935
batch 519, loss: 0.0739, instance_loss: 0.1928, weighted_loss: 0.1096, label: 3, bag_size: 43
batch 539, loss: 1.5606, instance_loss: 0.6715, weighted_loss: 1.2939, label: 4, bag_size: 1360


class 0 clustering acc 0.9936697247706422: correct 21662/21800
class 1 clustering acc 0.30252293577981654: correct 1319/4360
Epoch: 8, train_loss: 0.6569, train_clustering_loss:  0.3387, train_error: 0.2385
class 0: acc 0.7830188679245284, correct 83/106
class 1: acc 0.6306306306306306, correct 70/111
class 2: acc 0.7304347826086957, correct 84/115
class 3: acc 0.803921568627451, correct 82/102
class 4: acc 0.8648648648648649, correct 96/111

Val Set, val_loss: 0.9726, val_error: 0.3800, auc: 0.8737
class 0 clustering acc 0.9935: correct 1987/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4, correct 4/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
Validation loss decreased (1.015765 --> 0.972570).  Saving model ...


batch 19, loss: 0.0234, instance_loss: 0.0789, weighted_loss: 0.0401, label: 3, bag_size: 97
batch 39, loss: 3.0186, instance_loss: 0.7063, weighted_loss: 2.3249, label: 1, bag_size: 435
batch 59, loss: 0.3677, instance_loss: 0.3536, weighted_loss: 0.3635, label: 0, bag_size: 607
batch 79, loss: 0.2124, instance_loss: 0.2192, weighted_loss: 0.2145, label: 0, bag_size: 338
batch 99, loss: 0.0630, instance_loss: 0.1237, weighted_loss: 0.0812, label: 3, bag_size: 28
batch 119, loss: 0.0222, instance_loss: 0.1663, weighted_loss: 0.0654, label: 3, bag_size: 18
batch 139, loss: 0.6591, instance_loss: 0.3759, weighted_loss: 0.5741, label: 0, bag_size: 381
batch 159, loss: 0.3116, instance_loss: 0.3194, weighted_loss: 0.3139, label: 0, bag_size: 367
batch 179, loss: 1.3373, instance_loss: 0.6339, weighted_loss: 1.1263, label: 4, bag_size: 1331
batch 199, loss: 0.1347, instance_loss: 0.2269, weighted_loss: 0.1624, label: 4, bag_size: 28
batch 219, loss: 0.6260, instance_loss: 0.3250, weighted_loss: 0.5357, label: 2, bag_size: 967
batch 239, loss: 1.1422, instance_loss: 0.7835, weighted_loss: 1.0346, label: 2, bag_size: 1348
batch 259, loss: 2.7751, instance_loss: 0.7121, weighted_loss: 2.1562, label: 0, bag_size: 818
batch 279, loss: 0.2954, instance_loss: 0.3439, weighted_loss: 0.3100, label: 0, bag_size: 1174
batch 299, loss: 0.8862, instance_loss: 0.3490, weighted_loss: 0.7250, label: 2, bag_size: 741
batch 319, loss: 0.8398, instance_loss: 0.4234, weighted_loss: 0.7149, label: 1, bag_size: 343
batch 339, loss: 0.2184, instance_loss: 0.1968, weighted_loss: 0.2119, label: 2, bag_size: 621
batch 359, loss: 1.2475, instance_loss: 0.6307, weighted_loss: 1.0624, label: 3, bag_size: 791
batch 379, loss: 1.7159, instance_loss: 0.5599, weighted_loss: 1.3691, label: 1, bag_size: 1724
batch 399, loss: 0.0488, instance_loss: 0.3366, weighted_loss: 0.1352, label: 3, bag_size: 952
batch 419, loss: 0.0492, instance_loss: 0.1275, weighted_loss: 0.0727, label: 0, bag_size: 385
batch 439, loss: 0.2956, instance_loss: 0.1998, weighted_loss: 0.2669, label: 0, bag_size: 1133
batch 459, loss: 0.0862, instance_loss: 0.3850, weighted_loss: 0.1759, label: 4, bag_size: 14
batch 479, loss: 0.3591, instance_loss: 0.2513, weighted_loss: 0.3267, label: 0, bag_size: 1579
batch 499, loss: 1.2406, instance_loss: 0.4773, weighted_loss: 1.0117, label: 1, bag_size: 1409
batch 519, loss: 0.1517, instance_loss: 0.2055, weighted_loss: 0.1678, label: 0, bag_size: 375
batch 539, loss: 0.1110, instance_loss: 0.1690, weighted_loss: 0.1284, label: 1, bag_size: 318


class 0 clustering acc 0.9909174311926605: correct 21602/21800
class 1 clustering acc 0.3470183486238532: correct 1513/4360
Epoch: 9, train_loss: 0.5804, train_clustering_loss:  0.3247, train_error: 0.2183
class 0: acc 0.8403361344537815, correct 100/119
class 1: acc 0.639344262295082, correct 78/122
class 2: acc 0.7572815533980582, correct 78/103
class 3: acc 0.8762886597938144, correct 85/97
class 4: acc 0.8173076923076923, correct 85/104

Val Set, val_loss: 0.9786, val_error: 0.3200, auc: 0.8867
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 10/10
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9366, instance_loss: 0.4431, weighted_loss: 0.7886, label: 1, bag_size: 868
batch 39, loss: 2.2937, instance_loss: 0.6708, weighted_loss: 1.8069, label: 3, bag_size: 281
batch 59, loss: 0.4823, instance_loss: 0.2579, weighted_loss: 0.4150, label: 1, bag_size: 504
batch 79, loss: 0.1421, instance_loss: 0.2666, weighted_loss: 0.1794, label: 0, bag_size: 616
batch 99, loss: 0.3871, instance_loss: 0.3104, weighted_loss: 0.3641, label: 0, bag_size: 542
batch 119, loss: 0.5322, instance_loss: 0.3691, weighted_loss: 0.4833, label: 2, bag_size: 1404
batch 139, loss: 0.6063, instance_loss: 0.4256, weighted_loss: 0.5521, label: 4, bag_size: 636
batch 159, loss: 0.5511, instance_loss: 0.3896, weighted_loss: 0.5027, label: 2, bag_size: 567
batch 179, loss: 0.0045, instance_loss: 0.1153, weighted_loss: 0.0378, label: 3, bag_size: 26
batch 199, loss: 0.1146, instance_loss: 0.2838, weighted_loss: 0.1654, label: 4, bag_size: 24
batch 219, loss: 0.0216, instance_loss: 0.1109, weighted_loss: 0.0484, label: 3, bag_size: 143
batch 239, loss: 0.2222, instance_loss: 0.1427, weighted_loss: 0.1983, label: 1, bag_size: 869
batch 259, loss: 0.6862, instance_loss: 0.3813, weighted_loss: 0.5947, label: 1, bag_size: 917
batch 279, loss: 0.4574, instance_loss: 0.3247, weighted_loss: 0.4176, label: 2, bag_size: 1052
batch 299, loss: 0.0559, instance_loss: 0.1666, weighted_loss: 0.0891, label: 3, bag_size: 75
batch 319, loss: 0.1876, instance_loss: 0.1192, weighted_loss: 0.1671, label: 3, bag_size: 143
batch 339, loss: 0.9910, instance_loss: 0.5600, weighted_loss: 0.8617, label: 1, bag_size: 319
batch 359, loss: 0.0321, instance_loss: 0.1088, weighted_loss: 0.0551, label: 3, bag_size: 19
batch 379, loss: 0.0504, instance_loss: 0.1513, weighted_loss: 0.0807, label: 3, bag_size: 94
batch 399, loss: 1.7297, instance_loss: 0.5798, weighted_loss: 1.3847, label: 0, bag_size: 1065
batch 419, loss: 0.3143, instance_loss: 0.3445, weighted_loss: 0.3234, label: 0, bag_size: 478
batch 439, loss: 1.7445, instance_loss: 0.5366, weighted_loss: 1.3822, label: 2, bag_size: 373
batch 459, loss: 0.5160, instance_loss: 0.4534, weighted_loss: 0.4972, label: 2, bag_size: 750
batch 479, loss: 1.0049, instance_loss: 0.6820, weighted_loss: 0.9080, label: 4, bag_size: 663
batch 499, loss: 0.4041, instance_loss: 0.3684, weighted_loss: 0.3934, label: 4, bag_size: 646
batch 519, loss: 1.3667, instance_loss: 0.4359, weighted_loss: 1.0875, label: 1, bag_size: 1724
batch 539, loss: 0.3560, instance_loss: 0.2735, weighted_loss: 0.3313, label: 2, bag_size: 245


class 0 clustering acc 0.9894954128440367: correct 21571/21800
class 1 clustering acc 0.3834862385321101: correct 1672/4360
Epoch: 10, train_loss: 0.5628, train_clustering_loss:  0.3191, train_error: 0.2257
class 0: acc 0.8148148148148148, correct 88/108
class 1: acc 0.631578947368421, correct 72/114
class 2: acc 0.654320987654321, correct 53/81
class 3: acc 0.8760330578512396, correct 106/121
class 4: acc 0.8512396694214877, correct 103/121

Val Set, val_loss: 0.9188, val_error: 0.4400, auc: 0.8880
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.175: correct 70/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.4, correct 4/10
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
Validation loss decreased (0.972570 --> 0.918784).  Saving model ...


batch 19, loss: 0.1436, instance_loss: 0.2861, weighted_loss: 0.1864, label: 3, bag_size: 18
batch 39, loss: 0.4135, instance_loss: 0.3598, weighted_loss: 0.3974, label: 2, bag_size: 421
batch 59, loss: 0.8576, instance_loss: 0.6257, weighted_loss: 0.7880, label: 0, bag_size: 143
batch 79, loss: 0.1478, instance_loss: 0.2142, weighted_loss: 0.1677, label: 0, bag_size: 1135
batch 99, loss: 0.0112, instance_loss: 0.1205, weighted_loss: 0.0440, label: 3, bag_size: 16
batch 119, loss: 2.3697, instance_loss: 0.7366, weighted_loss: 1.8797, label: 3, bag_size: 281
batch 139, loss: 0.0282, instance_loss: 0.1134, weighted_loss: 0.0538, label: 3, bag_size: 56
batch 159, loss: 0.0678, instance_loss: 0.1212, weighted_loss: 0.0839, label: 3, bag_size: 18
batch 179, loss: 0.0214, instance_loss: 0.0617, weighted_loss: 0.0335, label: 3, bag_size: 41
batch 199, loss: 0.0362, instance_loss: 0.0552, weighted_loss: 0.0419, label: 4, bag_size: 202
batch 219, loss: 0.0215, instance_loss: 0.0743, weighted_loss: 0.0373, label: 4, bag_size: 112
batch 239, loss: 0.0384, instance_loss: 0.0662, weighted_loss: 0.0468, label: 3, bag_size: 305
batch 259, loss: 1.8154, instance_loss: 0.4488, weighted_loss: 1.4054, label: 4, bag_size: 17
batch 279, loss: 1.7845, instance_loss: 0.6238, weighted_loss: 1.4363, label: 4, bag_size: 436
batch 299, loss: 0.0440, instance_loss: 0.1035, weighted_loss: 0.0619, label: 0, bag_size: 402
batch 319, loss: 0.0371, instance_loss: 0.1119, weighted_loss: 0.0596, label: 3, bag_size: 29
batch 339, loss: 0.6727, instance_loss: 0.3191, weighted_loss: 0.5667, label: 3, bag_size: 1253
batch 359, loss: 0.1420, instance_loss: 0.2087, weighted_loss: 0.1620, label: 0, bag_size: 478
batch 379, loss: 0.5511, instance_loss: 0.3844, weighted_loss: 0.5011, label: 1, bag_size: 598
batch 399, loss: 0.2641, instance_loss: 0.2304, weighted_loss: 0.2540, label: 2, bag_size: 932
batch 419, loss: 1.5478, instance_loss: 0.6016, weighted_loss: 1.2639, label: 4, bag_size: 366
batch 439, loss: 0.0355, instance_loss: 0.1335, weighted_loss: 0.0649, label: 1, bag_size: 828
batch 459, loss: 0.7442, instance_loss: 0.2684, weighted_loss: 0.6015, label: 1, bag_size: 846
batch 479, loss: 1.6909, instance_loss: 0.6282, weighted_loss: 1.3721, label: 1, bag_size: 1724
batch 499, loss: 0.0450, instance_loss: 0.4483, weighted_loss: 0.1660, label: 4, bag_size: 711
batch 519, loss: 2.0323, instance_loss: 0.5836, weighted_loss: 1.5977, label: 1, bag_size: 386
batch 539, loss: 0.1137, instance_loss: 0.2583, weighted_loss: 0.1571, label: 4, bag_size: 20


class 0 clustering acc 0.9890825688073395: correct 21562/21800
class 1 clustering acc 0.4022935779816514: correct 1754/4360
Epoch: 11, train_loss: 0.5382, train_clustering_loss:  0.3112, train_error: 0.2000
class 0: acc 0.8113207547169812, correct 86/106
class 1: acc 0.6274509803921569, correct 64/102
class 2: acc 0.8041237113402062, correct 78/97
class 3: acc 0.8434782608695652, correct 97/115
class 4: acc 0.888, correct 111/125

Val Set, val_loss: 0.9964, val_error: 0.3800, auc: 0.8726
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.215: correct 86/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0502, instance_loss: 0.0898, weighted_loss: 0.0620, label: 4, bag_size: 162
batch 39, loss: 0.0597, instance_loss: 0.0856, weighted_loss: 0.0675, label: 4, bag_size: 148
batch 59, loss: 0.2550, instance_loss: 0.2583, weighted_loss: 0.2560, label: 4, bag_size: 19
batch 79, loss: 0.1343, instance_loss: 0.0898, weighted_loss: 0.1209, label: 4, bag_size: 40
batch 99, loss: 0.7273, instance_loss: 0.3513, weighted_loss: 0.6145, label: 1, bag_size: 530
batch 119, loss: 0.4595, instance_loss: 0.3588, weighted_loss: 0.4293, label: 2, bag_size: 1348
batch 139, loss: 0.6945, instance_loss: 0.4534, weighted_loss: 0.6222, label: 4, bag_size: 1002
batch 159, loss: 0.7093, instance_loss: 0.4679, weighted_loss: 0.6369, label: 2, bag_size: 542
batch 179, loss: 0.0481, instance_loss: 0.2747, weighted_loss: 0.1161, label: 3, bag_size: 24
batch 199, loss: 2.0810, instance_loss: 0.6260, weighted_loss: 1.6445, label: 1, bag_size: 446
batch 219, loss: 1.4965, instance_loss: 0.5652, weighted_loss: 1.2172, label: 1, bag_size: 917
batch 239, loss: 0.0518, instance_loss: 0.0650, weighted_loss: 0.0557, label: 3, bag_size: 63
batch 259, loss: 0.3332, instance_loss: 0.6151, weighted_loss: 0.4178, label: 0, bag_size: 109
batch 279, loss: 1.6644, instance_loss: 0.4452, weighted_loss: 1.2987, label: 0, bag_size: 759
batch 299, loss: 2.0150, instance_loss: 0.4946, weighted_loss: 1.5589, label: 2, bag_size: 508
batch 319, loss: 0.3996, instance_loss: 0.3611, weighted_loss: 0.3881, label: 2, bag_size: 1348
batch 339, loss: 0.2399, instance_loss: 0.2415, weighted_loss: 0.2404, label: 2, bag_size: 1123
batch 359, loss: 0.0152, instance_loss: 0.1514, weighted_loss: 0.0561, label: 3, bag_size: 28
batch 379, loss: 1.9273, instance_loss: 0.6263, weighted_loss: 1.5370, label: 4, bag_size: 542
batch 399, loss: 0.0205, instance_loss: 0.1394, weighted_loss: 0.0562, label: 3, bag_size: 29
batch 419, loss: 0.1133, instance_loss: 0.1711, weighted_loss: 0.1306, label: 4, bag_size: 44
batch 439, loss: 0.1191, instance_loss: 0.1540, weighted_loss: 0.1296, label: 3, bag_size: 31
batch 459, loss: 4.3129, instance_loss: 0.6533, weighted_loss: 3.2150, label: 2, bag_size: 732
batch 479, loss: 0.3352, instance_loss: 0.2337, weighted_loss: 0.3048, label: 0, bag_size: 1579
batch 499, loss: 0.1822, instance_loss: 0.1925, weighted_loss: 0.1853, label: 1, bag_size: 1239
batch 519, loss: 0.0373, instance_loss: 0.1018, weighted_loss: 0.0566, label: 3, bag_size: 143
batch 539, loss: 0.8416, instance_loss: 0.3643, weighted_loss: 0.6984, label: 1, bag_size: 847


class 0 clustering acc 0.9907339449541285: correct 21598/21800
class 1 clustering acc 0.42041284403669726: correct 1833/4360
Epoch: 12, train_loss: 0.4783, train_clustering_loss:  0.2941, train_error: 0.1761
class 0: acc 0.8849557522123894, correct 100/113
class 1: acc 0.6310679611650486, correct 65/103
class 2: acc 0.7870370370370371, correct 85/108
class 3: acc 0.8761904761904762, correct 92/105
class 4: acc 0.9224137931034483, correct 107/116

Val Set, val_loss: 0.9478, val_error: 0.4200, auc: 0.8850
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2486, instance_loss: 0.4684, weighted_loss: 0.3146, label: 4, bag_size: 826
batch 39, loss: 0.2124, instance_loss: 0.2070, weighted_loss: 0.2107, label: 1, bag_size: 890
batch 59, loss: 0.0171, instance_loss: 0.0463, weighted_loss: 0.0259, label: 4, bag_size: 72
batch 79, loss: 0.0446, instance_loss: 0.0727, weighted_loss: 0.0530, label: 4, bag_size: 72
batch 99, loss: 2.1270, instance_loss: 0.7015, weighted_loss: 1.6993, label: 1, bag_size: 1409
batch 119, loss: 0.0174, instance_loss: 0.1427, weighted_loss: 0.0550, label: 3, bag_size: 18
batch 139, loss: 0.2293, instance_loss: 0.4076, weighted_loss: 0.2828, label: 1, bag_size: 860
batch 159, loss: 0.8233, instance_loss: 0.4757, weighted_loss: 0.7190, label: 1, bag_size: 470
batch 179, loss: 0.0128, instance_loss: 0.0999, weighted_loss: 0.0389, label: 4, bag_size: 40
batch 199, loss: 1.9122, instance_loss: 0.6212, weighted_loss: 1.5249, label: 0, bag_size: 1257
batch 219, loss: 0.0068, instance_loss: 0.1587, weighted_loss: 0.0523, label: 4, bag_size: 30
batch 239, loss: 0.0221, instance_loss: 0.0668, weighted_loss: 0.0355, label: 0, bag_size: 898
batch 259, loss: 0.1384, instance_loss: 0.2730, weighted_loss: 0.1788, label: 4, bag_size: 19
batch 279, loss: 1.6722, instance_loss: 0.6833, weighted_loss: 1.3755, label: 1, bag_size: 308
batch 299, loss: 0.0055, instance_loss: 0.0764, weighted_loss: 0.0268, label: 4, bag_size: 24
batch 319, loss: 2.4936, instance_loss: 0.6890, weighted_loss: 1.9523, label: 4, bag_size: 511
batch 339, loss: 2.8699, instance_loss: 0.7129, weighted_loss: 2.2228, label: 1, bag_size: 386
batch 359, loss: 0.0087, instance_loss: 0.0819, weighted_loss: 0.0307, label: 3, bag_size: 28
batch 379, loss: 0.0028, instance_loss: 0.1842, weighted_loss: 0.0572, label: 3, bag_size: 21
batch 399, loss: 1.4460, instance_loss: 0.5821, weighted_loss: 1.1869, label: 2, bag_size: 110
batch 419, loss: 0.0152, instance_loss: 0.1823, weighted_loss: 0.0654, label: 3, bag_size: 34
batch 439, loss: 0.3005, instance_loss: 0.5502, weighted_loss: 0.3754, label: 0, bag_size: 128
batch 459, loss: 0.3204, instance_loss: 0.2788, weighted_loss: 0.3079, label: 0, bag_size: 371
batch 479, loss: 0.1564, instance_loss: 0.1188, weighted_loss: 0.1451, label: 1, bag_size: 1277
batch 499, loss: 0.1871, instance_loss: 0.1105, weighted_loss: 0.1641, label: 1, bag_size: 288
batch 519, loss: 0.2957, instance_loss: 0.2555, weighted_loss: 0.2837, label: 1, bag_size: 598
batch 539, loss: 1.6681, instance_loss: 0.5705, weighted_loss: 1.3388, label: 1, bag_size: 470


class 0 clustering acc 0.9870642201834863: correct 21518/21800
class 1 clustering acc 0.413302752293578: correct 1802/4360
Epoch: 13, train_loss: 0.5116, train_clustering_loss:  0.3103, train_error: 0.1963
class 0: acc 0.8557692307692307, correct 89/104
class 1: acc 0.6274509803921569, correct 64/102
class 2: acc 0.8, correct 88/110
class 3: acc 0.8333333333333334, correct 85/102
class 4: acc 0.8818897637795275, correct 112/127

Val Set, val_loss: 0.9311, val_error: 0.3400, auc: 0.8686
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.225: correct 90/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4758, instance_loss: 0.2737, weighted_loss: 0.4152, label: 1, bag_size: 847
batch 39, loss: 1.1714, instance_loss: 0.5361, weighted_loss: 0.9808, label: 2, bag_size: 1653
batch 59, loss: 0.2270, instance_loss: 0.2240, weighted_loss: 0.2261, label: 2, bag_size: 1148
batch 79, loss: 1.3080, instance_loss: 0.6909, weighted_loss: 1.1228, label: 2, bag_size: 518
batch 99, loss: 0.2318, instance_loss: 0.2173, weighted_loss: 0.2275, label: 2, bag_size: 1533
batch 119, loss: 1.9585, instance_loss: 0.6309, weighted_loss: 1.5602, label: 1, bag_size: 936
batch 139, loss: 0.9821, instance_loss: 0.3885, weighted_loss: 0.8040, label: 1, bag_size: 778
batch 159, loss: 0.3391, instance_loss: 0.3609, weighted_loss: 0.3456, label: 2, bag_size: 1148
batch 179, loss: 0.0054, instance_loss: 0.1611, weighted_loss: 0.0521, label: 4, bag_size: 20
batch 199, loss: 0.2620, instance_loss: 0.4600, weighted_loss: 0.3214, label: 0, bag_size: 148
batch 219, loss: 0.5270, instance_loss: 0.3564, weighted_loss: 0.4758, label: 2, bag_size: 1197
batch 239, loss: 0.1593, instance_loss: 0.1224, weighted_loss: 0.1482, label: 1, bag_size: 399
batch 259, loss: 0.0055, instance_loss: 0.0435, weighted_loss: 0.0169, label: 4, bag_size: 157
batch 279, loss: 0.1277, instance_loss: 0.0844, weighted_loss: 0.1147, label: 3, bag_size: 405
batch 299, loss: 0.2406, instance_loss: 0.2458, weighted_loss: 0.2422, label: 2, bag_size: 863
batch 319, loss: 0.0129, instance_loss: 0.0899, weighted_loss: 0.0360, label: 3, bag_size: 24
batch 339, loss: 0.0170, instance_loss: 0.2004, weighted_loss: 0.0720, label: 4, bag_size: 55
batch 359, loss: 1.6378, instance_loss: 0.5893, weighted_loss: 1.3233, label: 1, bag_size: 386
batch 379, loss: 0.2599, instance_loss: 0.1395, weighted_loss: 0.2238, label: 1, bag_size: 399
batch 399, loss: 0.0402, instance_loss: 0.1277, weighted_loss: 0.0664, label: 4, bag_size: 157
batch 419, loss: 0.0902, instance_loss: 0.1872, weighted_loss: 0.1193, label: 4, bag_size: 28
batch 439, loss: 1.8668, instance_loss: 0.6229, weighted_loss: 1.4937, label: 1, bag_size: 861
batch 459, loss: 0.0302, instance_loss: 0.0976, weighted_loss: 0.0504, label: 0, bag_size: 521
batch 479, loss: 0.1729, instance_loss: 0.2522, weighted_loss: 0.1967, label: 4, bag_size: 1235
batch 499, loss: 0.0075, instance_loss: 0.0901, weighted_loss: 0.0323, label: 3, bag_size: 55
batch 519, loss: 0.0255, instance_loss: 0.0809, weighted_loss: 0.0421, label: 0, bag_size: 382
batch 539, loss: 0.0928, instance_loss: 0.2747, weighted_loss: 0.1474, label: 4, bag_size: 17


class 0 clustering acc 0.9888073394495412: correct 21556/21800
class 1 clustering acc 0.423394495412844: correct 1846/4360
Epoch: 14, train_loss: 0.4462, train_clustering_loss:  0.2957, train_error: 0.1651
class 0: acc 0.8421052631578947, correct 80/95
class 1: acc 0.7068965517241379, correct 82/116
class 2: acc 0.7982456140350878, correct 91/114
class 3: acc 0.9181818181818182, correct 101/110
class 4: acc 0.9181818181818182, correct 101/110

Val Set, val_loss: 0.9910, val_error: 0.4000, auc: 0.8713
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 4 out of 20


batch 19, loss: 2.4611, instance_loss: 0.7533, weighted_loss: 1.9487, label: 4, bag_size: 436
batch 39, loss: 0.0220, instance_loss: 0.0400, weighted_loss: 0.0274, label: 4, bag_size: 192
batch 59, loss: 0.0652, instance_loss: 0.1330, weighted_loss: 0.0855, label: 0, bag_size: 1135
batch 79, loss: 1.6103, instance_loss: 0.6909, weighted_loss: 1.3345, label: 1, bag_size: 293
batch 99, loss: 1.0214, instance_loss: 0.3902, weighted_loss: 0.8320, label: 3, bag_size: 533
batch 119, loss: 0.7366, instance_loss: 0.4655, weighted_loss: 0.6553, label: 1, bag_size: 1255
batch 139, loss: 2.9828, instance_loss: 0.7575, weighted_loss: 2.3152, label: 1, bag_size: 700
batch 159, loss: 0.0123, instance_loss: 0.0836, weighted_loss: 0.0337, label: 3, bag_size: 37
batch 179, loss: 0.2166, instance_loss: 0.2329, weighted_loss: 0.2214, label: 2, bag_size: 399
batch 199, loss: 0.4415, instance_loss: 0.2947, weighted_loss: 0.3975, label: 0, bag_size: 1018
batch 219, loss: 0.1558, instance_loss: 0.1686, weighted_loss: 0.1596, label: 0, bag_size: 760
batch 239, loss: 0.0183, instance_loss: 0.0773, weighted_loss: 0.0360, label: 4, bag_size: 157
batch 259, loss: 0.0071, instance_loss: 0.0718, weighted_loss: 0.0265, label: 4, bag_size: 134
batch 279, loss: 0.4696, instance_loss: 0.3680, weighted_loss: 0.4392, label: 2, bag_size: 295
batch 299, loss: 0.0383, instance_loss: 0.0972, weighted_loss: 0.0560, label: 3, bag_size: 78
batch 319, loss: 0.0258, instance_loss: 0.0708, weighted_loss: 0.0393, label: 3, bag_size: 37
batch 339, loss: 0.0511, instance_loss: 0.1862, weighted_loss: 0.0916, label: 3, bag_size: 35
batch 359, loss: 0.0694, instance_loss: 0.0627, weighted_loss: 0.0674, label: 3, bag_size: 1559
batch 379, loss: 0.1921, instance_loss: 0.2729, weighted_loss: 0.2164, label: 2, bag_size: 2703
batch 399, loss: 1.5449, instance_loss: 0.4874, weighted_loss: 1.2277, label: 1, bag_size: 1559
batch 419, loss: 1.7200, instance_loss: 0.7492, weighted_loss: 1.4288, label: 0, bag_size: 245
batch 439, loss: 0.0298, instance_loss: 0.0599, weighted_loss: 0.0388, label: 4, bag_size: 202
batch 459, loss: 0.0556, instance_loss: 0.1058, weighted_loss: 0.0706, label: 1, bag_size: 937
batch 479, loss: 1.2059, instance_loss: 0.4192, weighted_loss: 0.9699, label: 1, bag_size: 535
batch 499, loss: 0.2674, instance_loss: 0.3253, weighted_loss: 0.2848, label: 1, bag_size: 786
batch 519, loss: 0.0243, instance_loss: 0.0556, weighted_loss: 0.0337, label: 0, bag_size: 616
batch 539, loss: 0.1832, instance_loss: 0.4219, weighted_loss: 0.2548, label: 4, bag_size: 711


class 0 clustering acc 0.9856422018348624: correct 21487/21800
class 1 clustering acc 0.44770642201834865: correct 1952/4360
Epoch: 15, train_loss: 0.4482, train_clustering_loss:  0.3020, train_error: 0.1688
class 0: acc 0.8916666666666667, correct 107/120
class 1: acc 0.6448598130841121, correct 69/107
class 2: acc 0.8207547169811321, correct 87/106
class 3: acc 0.8584905660377359, correct 91/106
class 4: acc 0.9339622641509434, correct 99/106

Val Set, val_loss: 0.9607, val_error: 0.3600, auc: 0.8680
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.2275: correct 91/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0982, instance_loss: 0.1311, weighted_loss: 0.1081, label: 1, bag_size: 790
batch 39, loss: 0.0267, instance_loss: 0.0800, weighted_loss: 0.0427, label: 0, bag_size: 524
batch 59, loss: 0.4088, instance_loss: 0.5637, weighted_loss: 0.4553, label: 2, bag_size: 916
batch 79, loss: 0.2466, instance_loss: 0.2116, weighted_loss: 0.2361, label: 0, bag_size: 375
batch 99, loss: 0.2105, instance_loss: 0.2075, weighted_loss: 0.2096, label: 2, bag_size: 499
batch 119, loss: 1.8301, instance_loss: 0.6375, weighted_loss: 1.4723, label: 1, bag_size: 446
batch 139, loss: 0.8522, instance_loss: 0.3792, weighted_loss: 0.7103, label: 2, bag_size: 421
batch 159, loss: 0.0159, instance_loss: 0.0555, weighted_loss: 0.0278, label: 4, bag_size: 134
batch 179, loss: 0.2958, instance_loss: 0.3153, weighted_loss: 0.3017, label: 0, bag_size: 760
batch 199, loss: 0.4099, instance_loss: 0.4131, weighted_loss: 0.4109, label: 2, bag_size: 508
batch 219, loss: 0.1484, instance_loss: 0.2134, weighted_loss: 0.1679, label: 2, bag_size: 399
batch 239, loss: 0.7368, instance_loss: 0.3534, weighted_loss: 0.6218, label: 1, bag_size: 778
batch 259, loss: 0.2993, instance_loss: 0.2548, weighted_loss: 0.2860, label: 1, bag_size: 778
batch 279, loss: 0.4161, instance_loss: 0.4639, weighted_loss: 0.4304, label: 2, bag_size: 312
batch 299, loss: 0.9010, instance_loss: 0.3631, weighted_loss: 0.7396, label: 1, bag_size: 1152
batch 319, loss: 0.2796, instance_loss: 0.6742, weighted_loss: 0.3980, label: 3, bag_size: 283
batch 339, loss: 0.0043, instance_loss: 0.0621, weighted_loss: 0.0217, label: 4, bag_size: 125
batch 359, loss: 0.0073, instance_loss: 0.0964, weighted_loss: 0.0341, label: 3, bag_size: 28
batch 379, loss: 0.6202, instance_loss: 0.4283, weighted_loss: 0.5626, label: 2, bag_size: 1024
batch 399, loss: 0.0187, instance_loss: 0.1353, weighted_loss: 0.0537, label: 3, bag_size: 78
batch 419, loss: 0.0174, instance_loss: 0.0611, weighted_loss: 0.0305, label: 4, bag_size: 96
batch 439, loss: 0.0105, instance_loss: 0.1220, weighted_loss: 0.0440, label: 3, bag_size: 20
batch 459, loss: 0.0080, instance_loss: 0.2575, weighted_loss: 0.0828, label: 3, bag_size: 20
batch 479, loss: 0.5176, instance_loss: 0.4157, weighted_loss: 0.4870, label: 0, bag_size: 759
batch 499, loss: 0.0430, instance_loss: 0.4354, weighted_loss: 0.1607, label: 4, bag_size: 17
batch 519, loss: 1.2247, instance_loss: 0.4780, weighted_loss: 1.0007, label: 0, bag_size: 545
batch 539, loss: 0.0331, instance_loss: 0.0660, weighted_loss: 0.0430, label: 4, bag_size: 130


class 0 clustering acc 0.9860550458715597: correct 21496/21800
class 1 clustering acc 0.42201834862385323: correct 1840/4360
Epoch: 16, train_loss: 0.4163, train_clustering_loss:  0.3024, train_error: 0.1541
class 0: acc 0.8932038834951457, correct 92/103
class 1: acc 0.6822429906542056, correct 73/107
class 2: acc 0.7927927927927928, correct 88/111
class 3: acc 0.9326923076923077, correct 97/104
class 4: acc 0.925, correct 111/120

Val Set, val_loss: 0.9442, val_error: 0.3200, auc: 0.8575
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.25: correct 100/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 6 out of 20


batch 19, loss: 2.2548, instance_loss: 0.6545, weighted_loss: 1.7747, label: 1, bag_size: 448
batch 39, loss: 1.9068, instance_loss: 0.6795, weighted_loss: 1.5386, label: 0, bag_size: 245
batch 59, loss: 0.5988, instance_loss: 0.6219, weighted_loss: 0.6057, label: 3, bag_size: 1250
batch 79, loss: 0.0016, instance_loss: 0.0455, weighted_loss: 0.0147, label: 3, bag_size: 115
batch 99, loss: 0.0092, instance_loss: 0.0705, weighted_loss: 0.0275, label: 4, bag_size: 157
batch 119, loss: 0.1245, instance_loss: 0.5788, weighted_loss: 0.2608, label: 0, bag_size: 116
batch 139, loss: 0.4741, instance_loss: 0.3647, weighted_loss: 0.4413, label: 2, bag_size: 1141
batch 159, loss: 0.9004, instance_loss: 0.6970, weighted_loss: 0.8394, label: 4, bag_size: 817
batch 179, loss: 0.0621, instance_loss: 0.5396, weighted_loss: 0.2053, label: 0, bag_size: 109
batch 199, loss: 0.6328, instance_loss: 0.2580, weighted_loss: 0.5204, label: 0, bag_size: 653
batch 219, loss: 0.0115, instance_loss: 0.0391, weighted_loss: 0.0198, label: 4, bag_size: 112
batch 239, loss: 0.0098, instance_loss: 0.0326, weighted_loss: 0.0166, label: 4, bag_size: 192
batch 259, loss: 0.7629, instance_loss: 0.4239, weighted_loss: 0.6612, label: 2, bag_size: 1617
batch 279, loss: 0.0200, instance_loss: 0.0494, weighted_loss: 0.0288, label: 4, bag_size: 112
batch 299, loss: 0.0112, instance_loss: 0.1404, weighted_loss: 0.0500, label: 4, bag_size: 790
batch 319, loss: 0.0010, instance_loss: 0.0579, weighted_loss: 0.0181, label: 4, bag_size: 30
batch 339, loss: 0.2512, instance_loss: 0.1349, weighted_loss: 0.2163, label: 1, bag_size: 399
batch 359, loss: 0.7597, instance_loss: 0.6353, weighted_loss: 0.7224, label: 4, bag_size: 542
batch 379, loss: 0.1127, instance_loss: 0.1763, weighted_loss: 0.1318, label: 2, bag_size: 499
batch 399, loss: 0.0567, instance_loss: 0.1081, weighted_loss: 0.0721, label: 0, bag_size: 756
batch 419, loss: 0.0047, instance_loss: 0.1065, weighted_loss: 0.0353, label: 3, bag_size: 41
batch 439, loss: 0.1582, instance_loss: 0.2729, weighted_loss: 0.1926, label: 4, bag_size: 24
batch 459, loss: 0.4058, instance_loss: 0.3207, weighted_loss: 0.3803, label: 2, bag_size: 748
batch 479, loss: 0.3694, instance_loss: 0.3267, weighted_loss: 0.3566, label: 1, bag_size: 504
batch 499, loss: 0.2139, instance_loss: 0.1789, weighted_loss: 0.2034, label: 3, bag_size: 1291
batch 519, loss: 2.0659, instance_loss: 0.6229, weighted_loss: 1.6330, label: 0, bag_size: 912
batch 539, loss: 0.0455, instance_loss: 0.1488, weighted_loss: 0.0765, label: 3, bag_size: 1291


class 0 clustering acc 0.9870642201834863: correct 21518/21800
class 1 clustering acc 0.48211009174311925: correct 2102/4360
Epoch: 17, train_loss: 0.4042, train_clustering_loss:  0.2862, train_error: 0.1450
class 0: acc 0.93, correct 93/100
class 1: acc 0.7307692307692307, correct 76/104
class 2: acc 0.847457627118644, correct 100/118
class 3: acc 0.8846153846153846, correct 92/104
class 4: acc 0.8823529411764706, correct 105/119

Val Set, val_loss: 0.9637, val_error: 0.3000, auc: 0.8689
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0438, instance_loss: 0.0726, weighted_loss: 0.0524, label: 4, bag_size: 94
batch 39, loss: 0.1694, instance_loss: 0.3698, weighted_loss: 0.2295, label: 4, bag_size: 524
batch 59, loss: 0.3811, instance_loss: 0.3164, weighted_loss: 0.3617, label: 1, bag_size: 242
batch 79, loss: 0.1070, instance_loss: 0.2069, weighted_loss: 0.1370, label: 0, bag_size: 921
batch 99, loss: 0.0636, instance_loss: 0.1388, weighted_loss: 0.0861, label: 4, bag_size: 26
batch 119, loss: 0.0039, instance_loss: 0.0328, weighted_loss: 0.0125, label: 3, bag_size: 66
batch 139, loss: 0.6968, instance_loss: 0.5151, weighted_loss: 0.6423, label: 4, bag_size: 542
batch 159, loss: 0.0034, instance_loss: 0.0675, weighted_loss: 0.0226, label: 4, bag_size: 134
batch 179, loss: 0.3825, instance_loss: 0.5138, weighted_loss: 0.4219, label: 0, bag_size: 466
batch 199, loss: 0.0979, instance_loss: 0.1371, weighted_loss: 0.1097, label: 4, bag_size: 20
batch 219, loss: 1.6844, instance_loss: 0.5799, weighted_loss: 1.3530, label: 1, bag_size: 530
batch 239, loss: 0.0824, instance_loss: 0.1943, weighted_loss: 0.1159, label: 1, bag_size: 945
batch 259, loss: 0.0122, instance_loss: 0.0841, weighted_loss: 0.0337, label: 0, bag_size: 982
batch 279, loss: 0.0029, instance_loss: 0.1641, weighted_loss: 0.0513, label: 3, bag_size: 26
batch 299, loss: 0.0952, instance_loss: 0.5892, weighted_loss: 0.2434, label: 4, bag_size: 675
batch 319, loss: 0.2021, instance_loss: 0.7711, weighted_loss: 0.3728, label: 3, bag_size: 1380
batch 339, loss: 1.0233, instance_loss: 0.5064, weighted_loss: 0.8683, label: 2, bag_size: 1617
batch 359, loss: 0.1069, instance_loss: 0.2421, weighted_loss: 0.1474, label: 2, bag_size: 621
batch 379, loss: 0.4917, instance_loss: 0.5094, weighted_loss: 0.4970, label: 3, bag_size: 671
batch 399, loss: 2.1635, instance_loss: 0.6416, weighted_loss: 1.7070, label: 1, bag_size: 1197
batch 419, loss: 1.8308, instance_loss: 0.7431, weighted_loss: 1.5044, label: 0, bag_size: 818
batch 439, loss: 0.5783, instance_loss: 0.3007, weighted_loss: 0.4950, label: 3, bag_size: 24
batch 459, loss: 0.0852, instance_loss: 0.3463, weighted_loss: 0.1636, label: 2, bag_size: 373
batch 479, loss: 0.1299, instance_loss: 0.2128, weighted_loss: 0.1548, label: 3, bag_size: 1177
batch 499, loss: 0.1042, instance_loss: 0.1173, weighted_loss: 0.1081, label: 4, bag_size: 168
batch 519, loss: 0.0172, instance_loss: 0.2117, weighted_loss: 0.0755, label: 0, bag_size: 110
batch 539, loss: 0.2110, instance_loss: 0.3740, weighted_loss: 0.2599, label: 1, bag_size: 858


class 0 clustering acc 0.9856880733944954: correct 21488/21800
class 1 clustering acc 0.45642201834862384: correct 1990/4360
Epoch: 18, train_loss: 0.3718, train_clustering_loss:  0.2918, train_error: 0.1284
class 0: acc 0.9351851851851852, correct 101/108
class 1: acc 0.6530612244897959, correct 64/98
class 2: acc 0.875, correct 105/120
class 3: acc 0.9243697478991597, correct 110/119
class 4: acc 0.95, correct 95/100

Val Set, val_loss: 1.0083, val_error: 0.3800, auc: 0.8626
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.3225: correct 129/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0491, instance_loss: 0.1249, weighted_loss: 0.0719, label: 2, bag_size: 347
batch 39, loss: 0.0398, instance_loss: 0.1264, weighted_loss: 0.0658, label: 4, bag_size: 157
batch 59, loss: 0.7181, instance_loss: 0.3899, weighted_loss: 0.6196, label: 2, bag_size: 272
batch 79, loss: 0.0083, instance_loss: 0.0818, weighted_loss: 0.0303, label: 4, bag_size: 88
batch 99, loss: 0.0025, instance_loss: 0.1451, weighted_loss: 0.0453, label: 3, bag_size: 50
batch 119, loss: 0.1612, instance_loss: 0.1868, weighted_loss: 0.1689, label: 2, bag_size: 932
batch 139, loss: 0.5799, instance_loss: 0.4525, weighted_loss: 0.5417, label: 1, bag_size: 925
batch 159, loss: 0.2396, instance_loss: 0.1816, weighted_loss: 0.2222, label: 1, bag_size: 846
batch 179, loss: 0.1244, instance_loss: 0.3657, weighted_loss: 0.1968, label: 1, bag_size: 343
batch 199, loss: 0.0042, instance_loss: 0.0991, weighted_loss: 0.0327, label: 3, bag_size: 27
batch 219, loss: 1.4954, instance_loss: 0.7441, weighted_loss: 1.2700, label: 3, bag_size: 671
batch 239, loss: 1.1454, instance_loss: 0.5461, weighted_loss: 0.9656, label: 1, bag_size: 448
batch 259, loss: 0.9913, instance_loss: 0.4724, weighted_loss: 0.8356, label: 2, bag_size: 421
batch 279, loss: 0.1944, instance_loss: 0.2801, weighted_loss: 0.2201, label: 2, bag_size: 1788
batch 299, loss: 0.4946, instance_loss: 0.3353, weighted_loss: 0.4468, label: 2, bag_size: 1052
batch 319, loss: 0.0227, instance_loss: 0.1396, weighted_loss: 0.0578, label: 4, bag_size: 47
batch 339, loss: 0.2472, instance_loss: 0.1979, weighted_loss: 0.2324, label: 2, bag_size: 252
batch 359, loss: 0.0041, instance_loss: 0.0553, weighted_loss: 0.0195, label: 3, bag_size: 41
batch 379, loss: 1.4533, instance_loss: 0.4674, weighted_loss: 1.1575, label: 0, bag_size: 545
batch 399, loss: 0.0300, instance_loss: 0.1392, weighted_loss: 0.0627, label: 0, bag_size: 1133
batch 419, loss: 0.0942, instance_loss: 0.1455, weighted_loss: 0.1096, label: 1, bag_size: 1239
batch 439, loss: 0.2102, instance_loss: 0.2567, weighted_loss: 0.2242, label: 2, bag_size: 868
batch 459, loss: 0.0040, instance_loss: 0.0781, weighted_loss: 0.0262, label: 4, bag_size: 86
batch 479, loss: 1.6509, instance_loss: 0.4594, weighted_loss: 1.2935, label: 0, bag_size: 801
batch 499, loss: 0.0017, instance_loss: 0.1416, weighted_loss: 0.0437, label: 3, bag_size: 26
batch 519, loss: 0.1711, instance_loss: 0.1656, weighted_loss: 0.1694, label: 1, bag_size: 682
batch 539, loss: 0.7391, instance_loss: 0.3369, weighted_loss: 0.6184, label: 2, bag_size: 373


class 0 clustering acc 0.986605504587156: correct 21508/21800
class 1 clustering acc 0.4651376146788991: correct 2028/4360
Epoch: 19, train_loss: 0.4122, train_clustering_loss:  0.2899, train_error: 0.1706
class 0: acc 0.9, correct 108/120
class 1: acc 0.6126126126126126, correct 68/111
class 2: acc 0.8547008547008547, correct 100/117
class 3: acc 0.9215686274509803, correct 94/102
class 4: acc 0.8631578947368421, correct 82/95

Val Set, val_loss: 0.9701, val_error: 0.3200, auc: 0.8676
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3130, instance_loss: 0.2562, weighted_loss: 0.2960, label: 1, bag_size: 598
batch 39, loss: 0.5455, instance_loss: 0.4171, weighted_loss: 0.5070, label: 0, bag_size: 759
batch 59, loss: 0.2363, instance_loss: 0.2188, weighted_loss: 0.2311, label: 2, bag_size: 941
batch 79, loss: 3.0167, instance_loss: 0.4955, weighted_loss: 2.2604, label: 2, bag_size: 732
batch 99, loss: 0.1808, instance_loss: 0.5531, weighted_loss: 0.2925, label: 0, bag_size: 120
batch 119, loss: 1.8053, instance_loss: 0.6033, weighted_loss: 1.4447, label: 4, bag_size: 436
batch 139, loss: 1.5202, instance_loss: 0.6355, weighted_loss: 1.2548, label: 1, bag_size: 446
batch 159, loss: 0.1589, instance_loss: 0.8581, weighted_loss: 0.3687, label: 3, bag_size: 607
batch 179, loss: 0.2438, instance_loss: 0.2593, weighted_loss: 0.2485, label: 2, bag_size: 861
batch 199, loss: 0.0026, instance_loss: 0.1258, weighted_loss: 0.0396, label: 3, bag_size: 18
batch 219, loss: 0.4778, instance_loss: 0.3802, weighted_loss: 0.4485, label: 0, bag_size: 1034
batch 239, loss: 0.1315, instance_loss: 0.1749, weighted_loss: 0.1445, label: 0, bag_size: 350
batch 259, loss: 0.0010, instance_loss: 0.1422, weighted_loss: 0.0434, label: 3, bag_size: 31
batch 279, loss: 0.0006, instance_loss: 0.1188, weighted_loss: 0.0360, label: 3, bag_size: 24
batch 299, loss: 0.0213, instance_loss: 0.3181, weighted_loss: 0.1104, label: 4, bag_size: 17
batch 319, loss: 0.0604, instance_loss: 0.2724, weighted_loss: 0.1240, label: 4, bag_size: 524
batch 339, loss: 0.4614, instance_loss: 0.3894, weighted_loss: 0.4398, label: 2, bag_size: 500
batch 359, loss: 0.0028, instance_loss: 0.1073, weighted_loss: 0.0341, label: 3, bag_size: 48
batch 379, loss: 0.0028, instance_loss: 0.1396, weighted_loss: 0.0439, label: 3, bag_size: 53
batch 399, loss: 0.0941, instance_loss: 0.2836, weighted_loss: 0.1510, label: 4, bag_size: 19
batch 419, loss: 0.0410, instance_loss: 0.3118, weighted_loss: 0.1223, label: 4, bag_size: 17
batch 439, loss: 0.3568, instance_loss: 0.5536, weighted_loss: 0.4158, label: 0, bag_size: 515
batch 459, loss: 0.3755, instance_loss: 0.4326, weighted_loss: 0.3926, label: 1, bag_size: 778
batch 479, loss: 0.0017, instance_loss: 0.2479, weighted_loss: 0.0755, label: 3, bag_size: 20
batch 499, loss: 0.0063, instance_loss: 0.0373, weighted_loss: 0.0156, label: 0, bag_size: 1466
batch 519, loss: 0.0353, instance_loss: 0.1887, weighted_loss: 0.0813, label: 4, bag_size: 47
batch 539, loss: 0.5556, instance_loss: 0.1556, weighted_loss: 0.4356, label: 3, bag_size: 316


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.4534403669724771: correct 1977/4360
Epoch: 20, train_loss: 0.3531, train_clustering_loss:  0.2915, train_error: 0.1266
class 0: acc 0.9615384615384616, correct 125/130
class 1: acc 0.7289719626168224, correct 78/107
class 2: acc 0.8181818181818182, correct 90/110
class 3: acc 0.9532710280373832, correct 102/107
class 4: acc 0.8901098901098901, correct 81/91

Val Set, val_loss: 0.9891, val_error: 0.4000, auc: 0.8532
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.2525: correct 101/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.4, correct 4/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.3149, instance_loss: 0.5834, weighted_loss: 0.3955, label: 4, bag_size: 928
batch 39, loss: 0.3153, instance_loss: 0.2826, weighted_loss: 0.3055, label: 2, bag_size: 405
batch 59, loss: 0.6355, instance_loss: 0.3650, weighted_loss: 0.5543, label: 2, bag_size: 1533
batch 79, loss: 0.1705, instance_loss: 0.1926, weighted_loss: 0.1771, label: 2, bag_size: 270
batch 99, loss: 0.0700, instance_loss: 0.2509, weighted_loss: 0.1243, label: 3, bag_size: 952
batch 119, loss: 0.0093, instance_loss: 0.0753, weighted_loss: 0.0291, label: 4, bag_size: 94
batch 139, loss: 0.0394, instance_loss: 0.1964, weighted_loss: 0.0865, label: 3, bag_size: 18
batch 159, loss: 0.1350, instance_loss: 0.1136, weighted_loss: 0.1286, label: 1, bag_size: 1127
batch 179, loss: 3.2157, instance_loss: 1.1852, weighted_loss: 2.6066, label: 2, bag_size: 1108
batch 199, loss: 0.0969, instance_loss: 0.4042, weighted_loss: 0.1891, label: 1, bag_size: 343
batch 219, loss: 0.0303, instance_loss: 0.1077, weighted_loss: 0.0535, label: 1, bag_size: 1426
batch 239, loss: 0.4016, instance_loss: 0.4068, weighted_loss: 0.4032, label: 1, bag_size: 1273
batch 259, loss: 1.2979, instance_loss: 0.7657, weighted_loss: 1.1383, label: 4, bag_size: 663
batch 279, loss: 0.2476, instance_loss: 0.3014, weighted_loss: 0.2638, label: 1, bag_size: 778
batch 299, loss: 0.0156, instance_loss: 0.0799, weighted_loss: 0.0349, label: 4, bag_size: 185
batch 319, loss: 0.0137, instance_loss: 0.0427, weighted_loss: 0.0224, label: 4, bag_size: 130
batch 339, loss: 0.1866, instance_loss: 0.2611, weighted_loss: 0.2089, label: 2, bag_size: 421
batch 359, loss: 0.0044, instance_loss: 0.2630, weighted_loss: 0.0819, label: 4, bag_size: 24
batch 379, loss: 0.1316, instance_loss: 0.2153, weighted_loss: 0.1567, label: 1, bag_size: 890
batch 399, loss: 0.3798, instance_loss: 0.2245, weighted_loss: 0.3332, label: 2, bag_size: 1052
batch 419, loss: 0.0395, instance_loss: 0.1355, weighted_loss: 0.0683, label: 1, bag_size: 790
batch 439, loss: 0.4087, instance_loss: 0.2581, weighted_loss: 0.3635, label: 2, bag_size: 1039
batch 459, loss: 1.0035, instance_loss: 0.4156, weighted_loss: 0.8271, label: 1, bag_size: 1559
batch 479, loss: 1.3318, instance_loss: 0.5305, weighted_loss: 1.0914, label: 1, bag_size: 1096
batch 499, loss: 0.0070, instance_loss: 0.1100, weighted_loss: 0.0379, label: 4, bag_size: 26
batch 519, loss: 0.0703, instance_loss: 0.1195, weighted_loss: 0.0850, label: 0, bag_size: 340
batch 539, loss: 0.1748, instance_loss: 0.3171, weighted_loss: 0.2175, label: 2, bag_size: 525


class 0 clustering acc 0.9842660550458716: correct 21457/21800
class 1 clustering acc 0.4926605504587156: correct 2148/4360
Epoch: 21, train_loss: 0.3250, train_clustering_loss:  0.2823, train_error: 0.1193
class 0: acc 0.908256880733945, correct 99/109
class 1: acc 0.6915887850467289, correct 74/107
class 2: acc 0.9217391304347826, correct 106/115
class 3: acc 0.9387755102040817, correct 92/98
class 4: acc 0.9396551724137931, correct 109/116

Val Set, val_loss: 0.9266, val_error: 0.3400, auc: 0.8930
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.5590, instance_loss: 0.4348, weighted_loss: 0.5218, label: 1, bag_size: 1559
batch 39, loss: 0.0012, instance_loss: 0.1847, weighted_loss: 0.0563, label: 3, bag_size: 20
batch 59, loss: 0.0377, instance_loss: 0.2350, weighted_loss: 0.0969, label: 3, bag_size: 18
batch 79, loss: 0.1151, instance_loss: 0.1445, weighted_loss: 0.1239, label: 2, bag_size: 1569
batch 99, loss: 0.0091, instance_loss: 0.2513, weighted_loss: 0.0818, label: 4, bag_size: 20
batch 119, loss: 0.4621, instance_loss: 0.3190, weighted_loss: 0.4192, label: 2, bag_size: 839
batch 139, loss: 0.0048, instance_loss: 0.2664, weighted_loss: 0.0833, label: 3, bag_size: 20
batch 159, loss: 0.0056, instance_loss: 0.0439, weighted_loss: 0.0171, label: 4, bag_size: 63
batch 179, loss: 0.0123, instance_loss: 0.0914, weighted_loss: 0.0360, label: 4, bag_size: 160
batch 199, loss: 1.5306, instance_loss: 0.6262, weighted_loss: 1.2593, label: 1, bag_size: 293
batch 219, loss: 0.6046, instance_loss: 0.3973, weighted_loss: 0.5424, label: 2, bag_size: 679
batch 239, loss: 0.2672, instance_loss: 0.2977, weighted_loss: 0.2763, label: 2, bag_size: 784
batch 259, loss: 0.0047, instance_loss: 0.0885, weighted_loss: 0.0298, label: 3, bag_size: 50
batch 279, loss: 0.4722, instance_loss: 0.3078, weighted_loss: 0.4229, label: 1, bag_size: 847
batch 299, loss: 0.3826, instance_loss: 0.3003, weighted_loss: 0.3579, label: 2, bag_size: 312
batch 319, loss: 0.2062, instance_loss: 0.2664, weighted_loss: 0.2242, label: 1, bag_size: 847
batch 339, loss: 0.8979, instance_loss: 0.4308, weighted_loss: 0.7578, label: 3, bag_size: 706
batch 359, loss: 0.3104, instance_loss: 0.2407, weighted_loss: 0.2895, label: 2, bag_size: 1259
batch 379, loss: 0.1352, instance_loss: 0.2871, weighted_loss: 0.1807, label: 3, bag_size: 317
batch 399, loss: 0.0040, instance_loss: 0.1001, weighted_loss: 0.0329, label: 1, bag_size: 1376
batch 419, loss: 0.5632, instance_loss: 0.6072, weighted_loss: 0.5764, label: 1, bag_size: 487
batch 439, loss: 0.4785, instance_loss: 0.2248, weighted_loss: 0.4024, label: 1, bag_size: 869
batch 459, loss: 0.0039, instance_loss: 0.0718, weighted_loss: 0.0243, label: 3, bag_size: 50
batch 479, loss: 0.0099, instance_loss: 0.1689, weighted_loss: 0.0576, label: 3, bag_size: 1291
batch 499, loss: 1.2501, instance_loss: 0.5614, weighted_loss: 1.0435, label: 1, bag_size: 711
batch 519, loss: 0.1035, instance_loss: 0.1865, weighted_loss: 0.1284, label: 0, bag_size: 478
batch 539, loss: 0.3160, instance_loss: 0.4431, weighted_loss: 0.3541, label: 0, bag_size: 1065


class 0 clustering acc 0.9842201834862385: correct 21456/21800
class 1 clustering acc 0.48577981651376145: correct 2118/4360
Epoch: 22, train_loss: 0.3534, train_clustering_loss:  0.2874, train_error: 0.1193
class 0: acc 0.941747572815534, correct 97/103
class 1: acc 0.6697247706422018, correct 73/109
class 2: acc 0.888, correct 111/125
class 3: acc 0.9719626168224299, correct 104/107
class 4: acc 0.9405940594059405, correct 95/101

Val Set, val_loss: 0.9381, val_error: 0.2800, auc: 0.8684
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.295: correct 118/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.7777777777777778, correct 7/9
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0008, instance_loss: 0.0741, weighted_loss: 0.0228, label: 4, bag_size: 134
batch 39, loss: 0.0145, instance_loss: 0.1795, weighted_loss: 0.0640, label: 3, bag_size: 20
batch 59, loss: 0.2989, instance_loss: 0.4575, weighted_loss: 0.3464, label: 0, bag_size: 1065
batch 79, loss: 0.0017, instance_loss: 0.0602, weighted_loss: 0.0192, label: 4, bag_size: 134
batch 99, loss: 0.1698, instance_loss: 0.2685, weighted_loss: 0.1994, label: 1, bag_size: 696
batch 119, loss: 0.1420, instance_loss: 0.2456, weighted_loss: 0.1731, label: 0, bag_size: 1196
batch 139, loss: 0.0012, instance_loss: 0.0257, weighted_loss: 0.0085, label: 4, bag_size: 182
batch 159, loss: 0.8988, instance_loss: 0.4070, weighted_loss: 0.7513, label: 1, bag_size: 651
batch 179, loss: 0.4307, instance_loss: 0.3079, weighted_loss: 0.3939, label: 2, bag_size: 247
batch 199, loss: 0.1132, instance_loss: 0.1487, weighted_loss: 0.1238, label: 1, bag_size: 1277
batch 219, loss: 0.0274, instance_loss: 0.1306, weighted_loss: 0.0584, label: 1, bag_size: 1191
batch 239, loss: 0.0419, instance_loss: 0.2322, weighted_loss: 0.0990, label: 0, bag_size: 120
batch 259, loss: 0.2845, instance_loss: 0.4320, weighted_loss: 0.3288, label: 2, bag_size: 1052
batch 279, loss: 0.1329, instance_loss: 0.1172, weighted_loss: 0.1282, label: 1, bag_size: 690
batch 299, loss: 0.0020, instance_loss: 0.0528, weighted_loss: 0.0172, label: 3, bag_size: 46
batch 319, loss: 2.2118, instance_loss: 0.7133, weighted_loss: 1.7623, label: 1, bag_size: 936
batch 339, loss: 0.0050, instance_loss: 0.1324, weighted_loss: 0.0432, label: 3, bag_size: 28
batch 359, loss: 0.0270, instance_loss: 0.1222, weighted_loss: 0.0555, label: 1, bag_size: 828
batch 379, loss: 0.2845, instance_loss: 0.2785, weighted_loss: 0.2827, label: 0, bag_size: 868
batch 399, loss: 0.2722, instance_loss: 0.3619, weighted_loss: 0.2991, label: 2, bag_size: 1215
batch 419, loss: 0.1725, instance_loss: 0.5725, weighted_loss: 0.2925, label: 1, bag_size: 293
batch 439, loss: 0.1333, instance_loss: 0.2598, weighted_loss: 0.1712, label: 2, bag_size: 649
batch 459, loss: 0.2068, instance_loss: 0.2920, weighted_loss: 0.2324, label: 2, bag_size: 1050
batch 479, loss: 0.0025, instance_loss: 0.2824, weighted_loss: 0.0864, label: 4, bag_size: 20
batch 499, loss: 0.0955, instance_loss: 0.1690, weighted_loss: 0.1176, label: 0, bag_size: 476
batch 519, loss: 0.0006, instance_loss: 0.1448, weighted_loss: 0.0439, label: 3, bag_size: 50
batch 539, loss: 0.0129, instance_loss: 0.1503, weighted_loss: 0.0541, label: 3, bag_size: 21


class 0 clustering acc 0.986605504587156: correct 21508/21800
class 1 clustering acc 0.4834862385321101: correct 2108/4360
Epoch: 23, train_loss: 0.3166, train_clustering_loss:  0.2831, train_error: 0.1119
class 0: acc 0.9487179487179487, correct 111/117
class 1: acc 0.6907216494845361, correct 67/97
class 2: acc 0.8818181818181818, correct 97/110
class 3: acc 0.93, correct 93/100
class 4: acc 0.9586776859504132, correct 116/121

Val Set, val_loss: 0.9228, val_error: 0.3400, auc: 0.8742
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.3375: correct 135/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0070, instance_loss: 0.0934, weighted_loss: 0.0329, label: 3, bag_size: 48
batch 39, loss: 0.0053, instance_loss: 0.0211, weighted_loss: 0.0100, label: 4, bag_size: 148
batch 59, loss: 0.4292, instance_loss: 0.3171, weighted_loss: 0.3956, label: 2, bag_size: 395
batch 79, loss: 0.2163, instance_loss: 0.2303, weighted_loss: 0.2205, label: 2, bag_size: 324
batch 99, loss: 0.8330, instance_loss: 0.4315, weighted_loss: 0.7126, label: 3, bag_size: 791
batch 119, loss: 0.2775, instance_loss: 0.2143, weighted_loss: 0.2586, label: 2, bag_size: 809
batch 139, loss: 1.9190, instance_loss: 0.7416, weighted_loss: 1.5658, label: 4, bag_size: 1337
batch 159, loss: 0.0465, instance_loss: 0.2194, weighted_loss: 0.0984, label: 4, bag_size: 636
batch 179, loss: 0.0182, instance_loss: 0.1856, weighted_loss: 0.0684, label: 0, bag_size: 110
batch 199, loss: 0.2734, instance_loss: 0.3470, weighted_loss: 0.2955, label: 1, bag_size: 343
batch 219, loss: 0.0014, instance_loss: 0.0811, weighted_loss: 0.0253, label: 3, bag_size: 19
batch 239, loss: 0.3098, instance_loss: 0.4869, weighted_loss: 0.3630, label: 3, bag_size: 200
batch 259, loss: 0.0147, instance_loss: 0.1159, weighted_loss: 0.0451, label: 4, bag_size: 119
batch 279, loss: 0.6682, instance_loss: 0.2575, weighted_loss: 0.5450, label: 2, bag_size: 1164
batch 299, loss: 0.0007, instance_loss: 0.1028, weighted_loss: 0.0313, label: 3, bag_size: 18
batch 319, loss: 0.0080, instance_loss: 0.4747, weighted_loss: 0.1480, label: 4, bag_size: 711
batch 339, loss: 0.0021, instance_loss: 0.0883, weighted_loss: 0.0280, label: 4, bag_size: 88
batch 359, loss: 0.3968, instance_loss: 0.2351, weighted_loss: 0.3483, label: 2, bag_size: 395
batch 379, loss: 0.0040, instance_loss: 0.0371, weighted_loss: 0.0139, label: 4, bag_size: 174
batch 399, loss: 0.0658, instance_loss: 0.5205, weighted_loss: 0.2022, label: 0, bag_size: 109
batch 419, loss: 0.7856, instance_loss: 0.5622, weighted_loss: 0.7186, label: 2, bag_size: 803
batch 439, loss: 0.0536, instance_loss: 0.5550, weighted_loss: 0.2040, label: 1, bag_size: 867
batch 459, loss: 0.0816, instance_loss: 0.2139, weighted_loss: 0.1213, label: 2, bag_size: 247
batch 479, loss: 0.0068, instance_loss: 0.1927, weighted_loss: 0.0625, label: 3, bag_size: 32
batch 499, loss: 0.0119, instance_loss: 0.0536, weighted_loss: 0.0244, label: 3, bag_size: 305
batch 519, loss: 0.1306, instance_loss: 0.2164, weighted_loss: 0.1564, label: 2, bag_size: 863
batch 539, loss: 0.0106, instance_loss: 0.1888, weighted_loss: 0.0640, label: 1, bag_size: 945


class 0 clustering acc 0.9868807339449541: correct 21514/21800
class 1 clustering acc 0.5162844036697247: correct 2251/4360
Epoch: 24, train_loss: 0.2652, train_clustering_loss:  0.2694, train_error: 0.0862
class 0: acc 0.956140350877193, correct 109/114
class 1: acc 0.7731958762886598, correct 75/97
class 2: acc 0.9130434782608695, correct 105/115
class 3: acc 0.9666666666666667, correct 116/120
class 4: acc 0.9393939393939394, correct 93/99

Val Set, val_loss: 0.9464, val_error: 0.3200, auc: 0.8815
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.275: correct 110/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.4568, instance_loss: 0.4653, weighted_loss: 0.4594, label: 1, bag_size: 1724
batch 39, loss: 0.0257, instance_loss: 0.2831, weighted_loss: 0.1029, label: 0, bag_size: 122
batch 59, loss: 0.0041, instance_loss: 0.0626, weighted_loss: 0.0216, label: 3, bag_size: 48
batch 79, loss: 0.1320, instance_loss: 0.2472, weighted_loss: 0.1666, label: 2, bag_size: 264
batch 99, loss: 0.0439, instance_loss: 0.1385, weighted_loss: 0.0723, label: 1, bag_size: 1426
batch 119, loss: 0.0079, instance_loss: 0.0451, weighted_loss: 0.0191, label: 0, bag_size: 756
batch 139, loss: 0.0003, instance_loss: 0.0513, weighted_loss: 0.0156, label: 4, bag_size: 30
batch 159, loss: 0.0084, instance_loss: 0.0628, weighted_loss: 0.0247, label: 4, bag_size: 43
batch 179, loss: 0.0030, instance_loss: 0.1688, weighted_loss: 0.0527, label: 4, bag_size: 39
batch 199, loss: 0.0679, instance_loss: 0.1585, weighted_loss: 0.0951, label: 2, bag_size: 271
batch 219, loss: 0.6811, instance_loss: 0.5067, weighted_loss: 0.6288, label: 1, bag_size: 887
batch 239, loss: 0.0020, instance_loss: 0.0202, weighted_loss: 0.0074, label: 4, bag_size: 130
batch 259, loss: 0.3457, instance_loss: 0.5122, weighted_loss: 0.3957, label: 1, bag_size: 1152
batch 279, loss: 0.0696, instance_loss: 0.2591, weighted_loss: 0.1265, label: 0, bag_size: 128
batch 299, loss: 0.0014, instance_loss: 0.2815, weighted_loss: 0.0855, label: 3, bag_size: 1291
batch 319, loss: 0.3854, instance_loss: 0.3808, weighted_loss: 0.3840, label: 0, bag_size: 200
batch 339, loss: 0.0120, instance_loss: 0.1506, weighted_loss: 0.0536, label: 4, bag_size: 72
batch 359, loss: 0.7988, instance_loss: 0.3999, weighted_loss: 0.6791, label: 1, bag_size: 867
batch 379, loss: 0.0388, instance_loss: 0.3942, weighted_loss: 0.1454, label: 4, bag_size: 1278
batch 399, loss: 0.3768, instance_loss: 0.5706, weighted_loss: 0.4349, label: 1, bag_size: 1144
batch 419, loss: 0.1408, instance_loss: 0.2259, weighted_loss: 0.1663, label: 2, bag_size: 396
batch 439, loss: 0.0354, instance_loss: 0.1664, weighted_loss: 0.0747, label: 1, bag_size: 846
batch 459, loss: 0.0582, instance_loss: 0.1813, weighted_loss: 0.0952, label: 0, bag_size: 736
batch 479, loss: 2.6606, instance_loss: 0.8415, weighted_loss: 2.1149, label: 2, bag_size: 959
batch 499, loss: 0.0857, instance_loss: 0.1516, weighted_loss: 0.1055, label: 2, bag_size: 399
batch 519, loss: 0.0035, instance_loss: 0.2153, weighted_loss: 0.0670, label: 3, bag_size: 16
batch 539, loss: 0.0733, instance_loss: 0.2674, weighted_loss: 0.1315, label: 1, bag_size: 242


class 0 clustering acc 0.9845871559633027: correct 21464/21800
class 1 clustering acc 0.539908256880734: correct 2354/4360
Epoch: 25, train_loss: 0.2486, train_clustering_loss:  0.2635, train_error: 0.0844
class 0: acc 0.9587628865979382, correct 93/97
class 1: acc 0.8155339805825242, correct 84/103
class 2: acc 0.8761061946902655, correct 99/113
class 3: acc 0.9714285714285714, correct 102/105
class 4: acc 0.952755905511811, correct 121/127

Val Set, val_loss: 1.0675, val_error: 0.3400, auc: 0.8519
class 0 clustering acc 0.969: correct 1938/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0119, instance_loss: 0.0788, weighted_loss: 0.0319, label: 0, bag_size: 385
batch 39, loss: 0.1946, instance_loss: 0.3637, weighted_loss: 0.2453, label: 3, bag_size: 230
batch 59, loss: 0.0105, instance_loss: 0.0473, weighted_loss: 0.0215, label: 3, bag_size: 305
batch 79, loss: 0.0934, instance_loss: 0.3113, weighted_loss: 0.1588, label: 0, bag_size: 545
batch 99, loss: 0.2217, instance_loss: 0.3475, weighted_loss: 0.2594, label: 2, bag_size: 252
batch 119, loss: 0.2397, instance_loss: 0.4911, weighted_loss: 0.3151, label: 1, bag_size: 860
batch 139, loss: 0.1405, instance_loss: 0.1912, weighted_loss: 0.1557, label: 0, bag_size: 1061
batch 159, loss: 0.0199, instance_loss: 0.2305, weighted_loss: 0.0831, label: 1, bag_size: 890
batch 179, loss: 0.1960, instance_loss: 0.3162, weighted_loss: 0.2320, label: 1, bag_size: 598
batch 199, loss: 0.0689, instance_loss: 0.4815, weighted_loss: 0.1927, label: 1, bag_size: 442
batch 219, loss: 0.0015, instance_loss: 0.1114, weighted_loss: 0.0345, label: 4, bag_size: 72
batch 239, loss: 0.2631, instance_loss: 0.3374, weighted_loss: 0.2854, label: 2, bag_size: 1047
batch 259, loss: 0.2824, instance_loss: 0.5156, weighted_loss: 0.3523, label: 1, bag_size: 487
batch 279, loss: 0.3550, instance_loss: 0.3303, weighted_loss: 0.3476, label: 2, bag_size: 262
batch 299, loss: 0.0020, instance_loss: 0.2416, weighted_loss: 0.0739, label: 4, bag_size: 14
batch 319, loss: 0.3433, instance_loss: 0.3825, weighted_loss: 0.3551, label: 2, bag_size: 1119
batch 339, loss: 0.0767, instance_loss: 0.4376, weighted_loss: 0.1849, label: 1, bag_size: 442
batch 359, loss: 0.0066, instance_loss: 0.1526, weighted_loss: 0.0504, label: 3, bag_size: 34
batch 379, loss: 0.0015, instance_loss: 0.1561, weighted_loss: 0.0479, label: 4, bag_size: 24
batch 399, loss: 0.1581, instance_loss: 0.3242, weighted_loss: 0.2079, label: 2, bag_size: 839
batch 419, loss: 0.0028, instance_loss: 0.0615, weighted_loss: 0.0204, label: 4, bag_size: 764
batch 439, loss: 0.1124, instance_loss: 0.4361, weighted_loss: 0.2095, label: 4, bag_size: 1002
batch 459, loss: 0.0969, instance_loss: 0.2197, weighted_loss: 0.1338, label: 3, bag_size: 1253
batch 479, loss: 0.0364, instance_loss: 0.1255, weighted_loss: 0.0631, label: 0, bag_size: 1196
batch 499, loss: 0.2403, instance_loss: 0.3043, weighted_loss: 0.2595, label: 2, bag_size: 409
batch 519, loss: 0.0024, instance_loss: 0.4018, weighted_loss: 0.1222, label: 4, bag_size: 1002
batch 539, loss: 1.9009, instance_loss: 0.5947, weighted_loss: 1.5090, label: 1, bag_size: 818


class 0 clustering acc 0.9856880733944954: correct 21488/21800
class 1 clustering acc 0.5151376146788991: correct 2246/4360
Epoch: 26, train_loss: 0.2515, train_clustering_loss:  0.2708, train_error: 0.0844
class 0: acc 0.9304347826086956, correct 107/115
class 1: acc 0.8529411764705882, correct 87/102
class 2: acc 0.9032258064516129, correct 84/93
class 3: acc 0.940677966101695, correct 111/118
class 4: acc 0.9401709401709402, correct 110/117

Val Set, val_loss: 1.0032, val_error: 0.3200, auc: 0.8701
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.2975: correct 119/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8, correct 8/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.9786, instance_loss: 0.5701, weighted_loss: 1.5560, label: 0, bag_size: 423
batch 39, loss: 0.1763, instance_loss: 0.2736, weighted_loss: 0.2055, label: 2, bag_size: 1259
batch 59, loss: 0.3685, instance_loss: 0.6807, weighted_loss: 0.4622, label: 1, bag_size: 1144
batch 79, loss: 0.0028, instance_loss: 0.1374, weighted_loss: 0.0432, label: 0, bag_size: 136
batch 99, loss: 0.0103, instance_loss: 0.0517, weighted_loss: 0.0227, label: 4, bag_size: 148
batch 119, loss: 0.8342, instance_loss: 0.5384, weighted_loss: 0.7454, label: 3, bag_size: 1177
batch 139, loss: 0.1479, instance_loss: 0.1445, weighted_loss: 0.1469, label: 1, bag_size: 869
batch 159, loss: 0.8490, instance_loss: 0.4885, weighted_loss: 0.7409, label: 2, bag_size: 272
batch 179, loss: 0.2965, instance_loss: 0.3997, weighted_loss: 0.3275, label: 2, bag_size: 784
batch 199, loss: 0.0141, instance_loss: 0.0931, weighted_loss: 0.0378, label: 4, bag_size: 38
batch 219, loss: 1.2023, instance_loss: 0.4831, weighted_loss: 0.9865, label: 0, bag_size: 1257
batch 239, loss: 0.0024, instance_loss: 0.0498, weighted_loss: 0.0166, label: 4, bag_size: 114
batch 259, loss: 0.0136, instance_loss: 0.0871, weighted_loss: 0.0357, label: 0, bag_size: 1235
batch 279, loss: 0.1589, instance_loss: 0.2934, weighted_loss: 0.1992, label: 2, bag_size: 500
batch 299, loss: 0.0078, instance_loss: 0.0359, weighted_loss: 0.0162, label: 4, bag_size: 160
batch 319, loss: 0.3693, instance_loss: 0.2979, weighted_loss: 0.3479, label: 0, bag_size: 478
batch 339, loss: 0.0363, instance_loss: 0.0784, weighted_loss: 0.0489, label: 1, bag_size: 405
batch 359, loss: 0.0990, instance_loss: 0.3273, weighted_loss: 0.1675, label: 2, bag_size: 421
batch 379, loss: 0.0109, instance_loss: 0.0484, weighted_loss: 0.0221, label: 1, bag_size: 994
batch 399, loss: 0.0091, instance_loss: 0.0462, weighted_loss: 0.0203, label: 0, bag_size: 521
batch 419, loss: 0.0767, instance_loss: 0.1496, weighted_loss: 0.0986, label: 1, bag_size: 1144
batch 439, loss: 0.0639, instance_loss: 0.1996, weighted_loss: 0.1046, label: 4, bag_size: 524
batch 459, loss: 0.4470, instance_loss: 0.3202, weighted_loss: 0.4090, label: 3, bag_size: 1177
batch 479, loss: 0.0023, instance_loss: 0.2906, weighted_loss: 0.0888, label: 3, bag_size: 16
batch 499, loss: 0.0242, instance_loss: 0.0556, weighted_loss: 0.0336, label: 3, bag_size: 1172
batch 519, loss: 0.0002, instance_loss: 0.0502, weighted_loss: 0.0152, label: 4, bag_size: 30
batch 539, loss: 0.0534, instance_loss: 0.1911, weighted_loss: 0.0947, label: 3, bag_size: 316


class 0 clustering acc 0.9854587155963302: correct 21483/21800
class 1 clustering acc 0.5176605504587156: correct 2257/4360
Epoch: 27, train_loss: 0.3298, train_clustering_loss:  0.2737, train_error: 0.1248
class 0: acc 0.9203539823008849, correct 104/113
class 1: acc 0.7868852459016393, correct 96/122
class 2: acc 0.8095238095238095, correct 85/105
class 3: acc 0.954954954954955, correct 106/111
class 4: acc 0.9148936170212766, correct 86/94

Val Set, val_loss: 0.9710, val_error: 0.3400, auc: 0.8689
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.2875: correct 115/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 17 out of 20


batch 19, loss: 2.9923, instance_loss: 1.1022, weighted_loss: 2.4253, label: 2, bag_size: 1108
batch 39, loss: 0.3646, instance_loss: 0.1532, weighted_loss: 0.3012, label: 4, bag_size: 47
batch 59, loss: 0.0170, instance_loss: 0.0260, weighted_loss: 0.0197, label: 4, bag_size: 110
batch 79, loss: 0.1751, instance_loss: 0.2568, weighted_loss: 0.1996, label: 4, bag_size: 646
batch 99, loss: 0.0064, instance_loss: 0.0728, weighted_loss: 0.0264, label: 4, bag_size: 91
batch 119, loss: 1.2674, instance_loss: 0.6740, weighted_loss: 1.0893, label: 3, bag_size: 671
batch 139, loss: 0.0578, instance_loss: 0.3026, weighted_loss: 0.1313, label: 0, bag_size: 114
batch 159, loss: 0.0798, instance_loss: 0.0921, weighted_loss: 0.0835, label: 1, bag_size: 944
batch 179, loss: 0.3612, instance_loss: 0.5306, weighted_loss: 0.4120, label: 4, bag_size: 817
batch 199, loss: 0.4431, instance_loss: 0.5407, weighted_loss: 0.4724, label: 1, bag_size: 293
batch 219, loss: 0.0188, instance_loss: 0.3507, weighted_loss: 0.1183, label: 0, bag_size: 163
batch 239, loss: 1.1144, instance_loss: 0.5115, weighted_loss: 0.9335, label: 2, bag_size: 500
batch 259, loss: 0.0200, instance_loss: 0.3526, weighted_loss: 0.1198, label: 4, bag_size: 656
batch 279, loss: 0.0102, instance_loss: 0.1404, weighted_loss: 0.0493, label: 3, bag_size: 18
batch 299, loss: 0.5187, instance_loss: 0.3385, weighted_loss: 0.4646, label: 0, bag_size: 282
batch 319, loss: 0.3780, instance_loss: 0.5825, weighted_loss: 0.4394, label: 2, bag_size: 373
batch 339, loss: 0.0182, instance_loss: 0.0633, weighted_loss: 0.0317, label: 1, bag_size: 1086
batch 359, loss: 0.1659, instance_loss: 0.3655, weighted_loss: 0.2258, label: 2, bag_size: 1215
batch 379, loss: 0.1276, instance_loss: 0.5683, weighted_loss: 0.2598, label: 2, bag_size: 518
batch 399, loss: 0.3832, instance_loss: 0.4974, weighted_loss: 0.4174, label: 1, bag_size: 959
batch 419, loss: 0.1172, instance_loss: 0.1831, weighted_loss: 0.1369, label: 2, bag_size: 470
batch 439, loss: 0.4797, instance_loss: 0.3001, weighted_loss: 0.4258, label: 2, bag_size: 682
batch 459, loss: 0.0326, instance_loss: 0.3707, weighted_loss: 0.1340, label: 4, bag_size: 1278
batch 479, loss: 0.0434, instance_loss: 0.1485, weighted_loss: 0.0749, label: 0, bag_size: 1174
batch 499, loss: 0.2299, instance_loss: 0.2560, weighted_loss: 0.2377, label: 0, bag_size: 990
batch 519, loss: 0.0595, instance_loss: 0.1340, weighted_loss: 0.0818, label: 1, bag_size: 682
batch 539, loss: 1.7685, instance_loss: 0.6381, weighted_loss: 1.4293, label: 0, bag_size: 570


class 0 clustering acc 0.9871100917431193: correct 21519/21800
class 1 clustering acc 0.47660550458715595: correct 2078/4360
Epoch: 28, train_loss: 0.3005, train_clustering_loss:  0.2811, train_error: 0.1138
class 0: acc 0.9175257731958762, correct 89/97
class 1: acc 0.7631578947368421, correct 87/114
class 2: acc 0.8532110091743119, correct 93/109
class 3: acc 0.9482758620689655, correct 110/116
class 4: acc 0.9541284403669725, correct 104/109

Val Set, val_loss: 1.0598, val_error: 0.3800, auc: 0.8699
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0831, instance_loss: 0.2222, weighted_loss: 0.1248, label: 1, bag_size: 1239
batch 39, loss: 0.0151, instance_loss: 0.0663, weighted_loss: 0.0305, label: 1, bag_size: 1261
batch 59, loss: 0.0736, instance_loss: 0.0947, weighted_loss: 0.0799, label: 2, bag_size: 270
batch 79, loss: 1.4652, instance_loss: 0.6077, weighted_loss: 1.2080, label: 0, bag_size: 912
batch 99, loss: 0.2721, instance_loss: 0.5118, weighted_loss: 0.3440, label: 2, bag_size: 3236
batch 119, loss: 0.1984, instance_loss: 0.2136, weighted_loss: 0.2030, label: 0, bag_size: 801
batch 139, loss: 0.0482, instance_loss: 0.1325, weighted_loss: 0.0735, label: 0, bag_size: 736
batch 159, loss: 0.0413, instance_loss: 0.4314, weighted_loss: 0.1583, label: 0, bag_size: 143
batch 179, loss: 0.0234, instance_loss: 0.4282, weighted_loss: 0.1448, label: 0, bag_size: 129
batch 199, loss: 0.3582, instance_loss: 0.6963, weighted_loss: 0.4596, label: 3, bag_size: 281
batch 219, loss: 0.0019, instance_loss: 0.0683, weighted_loss: 0.0218, label: 4, bag_size: 55
batch 239, loss: 0.1866, instance_loss: 0.2454, weighted_loss: 0.2042, label: 1, bag_size: 504
batch 259, loss: 0.4267, instance_loss: 0.4879, weighted_loss: 0.4450, label: 0, bag_size: 245
batch 279, loss: 0.4037, instance_loss: 0.4108, weighted_loss: 0.4059, label: 2, bag_size: 943
batch 299, loss: 0.0007, instance_loss: 0.2167, weighted_loss: 0.0655, label: 3, bag_size: 20
batch 319, loss: 0.0156, instance_loss: 0.1245, weighted_loss: 0.0483, label: 3, bag_size: 18
batch 339, loss: 0.1230, instance_loss: 0.1432, weighted_loss: 0.1291, label: 3, bag_size: 451
batch 359, loss: 0.0054, instance_loss: 0.0413, weighted_loss: 0.0162, label: 4, bag_size: 174
batch 379, loss: 0.0005, instance_loss: 0.0654, weighted_loss: 0.0200, label: 3, bag_size: 87
batch 399, loss: 0.1541, instance_loss: 0.2075, weighted_loss: 0.1701, label: 2, bag_size: 1533
batch 419, loss: 0.0103, instance_loss: 0.0810, weighted_loss: 0.0315, label: 3, bag_size: 27
batch 439, loss: 0.0128, instance_loss: 0.3524, weighted_loss: 0.1147, label: 3, bag_size: 16
batch 459, loss: 0.0431, instance_loss: 0.2205, weighted_loss: 0.0963, label: 3, bag_size: 18
batch 479, loss: 0.0029, instance_loss: 0.0674, weighted_loss: 0.0223, label: 4, bag_size: 40
batch 499, loss: 1.3800, instance_loss: 0.5538, weighted_loss: 1.1321, label: 1, bag_size: 377
batch 519, loss: 0.0384, instance_loss: 0.1049, weighted_loss: 0.0584, label: 1, bag_size: 697
batch 539, loss: 0.0175, instance_loss: 0.0668, weighted_loss: 0.0323, label: 1, bag_size: 937


class 0 clustering acc 0.9856880733944954: correct 21488/21800
class 1 clustering acc 0.5100917431192661: correct 2224/4360
Epoch: 29, train_loss: 0.2598, train_clustering_loss:  0.2711, train_error: 0.0862
class 0: acc 0.9615384615384616, correct 100/104
class 1: acc 0.7731958762886598, correct 75/97
class 2: acc 0.8879310344827587, correct 103/116
class 3: acc 0.9565217391304348, correct 110/115
class 4: acc 0.9734513274336283, correct 110/113

Val Set, val_loss: 1.1179, val_error: 0.4200, auc: 0.8713
class 0 clustering acc 0.964: correct 1928/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0005, instance_loss: 0.1468, weighted_loss: 0.0444, label: 3, bag_size: 16
batch 39, loss: 1.1551, instance_loss: 0.6657, weighted_loss: 1.0083, label: 1, bag_size: 446
batch 59, loss: 0.2520, instance_loss: 0.2605, weighted_loss: 0.2545, label: 1, bag_size: 1014
batch 79, loss: 0.0199, instance_loss: 0.2041, weighted_loss: 0.0752, label: 3, bag_size: 1291
batch 99, loss: 0.1418, instance_loss: 0.1725, weighted_loss: 0.1510, label: 3, bag_size: 1177
batch 119, loss: 0.0553, instance_loss: 0.2179, weighted_loss: 0.1040, label: 1, bag_size: 754
batch 139, loss: 0.0245, instance_loss: 0.0518, weighted_loss: 0.0327, label: 1, bag_size: 886
batch 159, loss: 1.0057, instance_loss: 0.3900, weighted_loss: 0.8210, label: 4, bag_size: 1235
batch 179, loss: 0.1335, instance_loss: 0.2912, weighted_loss: 0.1808, label: 2, bag_size: 542
batch 199, loss: 0.0065, instance_loss: 0.0698, weighted_loss: 0.0255, label: 1, bag_size: 828
batch 219, loss: 0.0587, instance_loss: 0.1488, weighted_loss: 0.0857, label: 0, bag_size: 375
batch 239, loss: 0.4826, instance_loss: 0.4477, weighted_loss: 0.4721, label: 4, bag_size: 354
batch 259, loss: 0.0015, instance_loss: 0.0442, weighted_loss: 0.0143, label: 3, bag_size: 78
batch 279, loss: 0.1309, instance_loss: 0.5921, weighted_loss: 0.2692, label: 1, bag_size: 319
batch 299, loss: 0.0062, instance_loss: 0.0856, weighted_loss: 0.0300, label: 0, bag_size: 1599
batch 319, loss: 0.3239, instance_loss: 0.4894, weighted_loss: 0.3735, label: 3, bag_size: 1253
batch 339, loss: 0.3492, instance_loss: 0.4664, weighted_loss: 0.3843, label: 1, bag_size: 838
batch 359, loss: 0.0038, instance_loss: 0.1418, weighted_loss: 0.0452, label: 3, bag_size: 55
batch 379, loss: 0.0004, instance_loss: 0.1420, weighted_loss: 0.0429, label: 3, bag_size: 21
batch 399, loss: 0.2264, instance_loss: 0.2866, weighted_loss: 0.2444, label: 0, bag_size: 868
batch 419, loss: 0.2313, instance_loss: 0.4475, weighted_loss: 0.2962, label: 1, bag_size: 1255
batch 439, loss: 0.0784, instance_loss: 0.1423, weighted_loss: 0.0976, label: 2, bag_size: 941
batch 459, loss: 0.0028, instance_loss: 0.0261, weighted_loss: 0.0098, label: 0, bag_size: 1517
batch 479, loss: 1.4638, instance_loss: 0.6737, weighted_loss: 1.2268, label: 1, bag_size: 887
batch 499, loss: 0.1149, instance_loss: 0.6098, weighted_loss: 0.2634, label: 3, bag_size: 1253
batch 519, loss: 0.0337, instance_loss: 0.2972, weighted_loss: 0.1128, label: 0, bag_size: 118
batch 539, loss: 0.0015, instance_loss: 0.0620, weighted_loss: 0.0196, label: 3, bag_size: 43


class 0 clustering acc 0.9857798165137615: correct 21490/21800
class 1 clustering acc 0.5344036697247706: correct 2330/4360
Epoch: 30, train_loss: 0.2384, train_clustering_loss:  0.2626, train_error: 0.0807
class 0: acc 0.9745762711864406, correct 115/118
class 1: acc 0.7884615384615384, correct 82/104
class 2: acc 0.9304347826086956, correct 107/115
class 3: acc 0.9727272727272728, correct 107/110
class 4: acc 0.9183673469387755, correct 90/98

Val Set, val_loss: 1.0917, val_error: 0.3400, auc: 0.8717
class 0 clustering acc 0.969: correct 1938/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.3337, instance_loss: 0.4911, weighted_loss: 0.3809, label: 1, bag_size: 917
batch 39, loss: 0.0656, instance_loss: 0.0901, weighted_loss: 0.0730, label: 1, bag_size: 697
batch 59, loss: 0.0215, instance_loss: 0.0696, weighted_loss: 0.0360, label: 1, bag_size: 1086
batch 79, loss: 0.2369, instance_loss: 0.2353, weighted_loss: 0.2364, label: 2, bag_size: 806
batch 99, loss: 0.0021, instance_loss: 0.0172, weighted_loss: 0.0066, label: 3, bag_size: 60
batch 119, loss: 0.0165, instance_loss: 0.0908, weighted_loss: 0.0388, label: 0, bag_size: 1086
batch 139, loss: 0.0627, instance_loss: 0.2557, weighted_loss: 0.1206, label: 4, bag_size: 23
batch 159, loss: 0.1745, instance_loss: 0.2933, weighted_loss: 0.2102, label: 2, bag_size: 237
batch 179, loss: 1.6594, instance_loss: 0.6152, weighted_loss: 1.3461, label: 2, bag_size: 803
batch 199, loss: 0.5485, instance_loss: 0.5851, weighted_loss: 0.5595, label: 2, bag_size: 110
batch 219, loss: 1.9066, instance_loss: 0.6481, weighted_loss: 1.5290, label: 1, bag_size: 1376
batch 239, loss: 0.0004, instance_loss: 0.0875, weighted_loss: 0.0265, label: 4, bag_size: 134
batch 259, loss: 0.3777, instance_loss: 0.5530, weighted_loss: 0.4303, label: 3, bag_size: 706
batch 279, loss: 0.0024, instance_loss: 0.1070, weighted_loss: 0.0338, label: 3, bag_size: 18
batch 299, loss: 0.5436, instance_loss: 0.6095, weighted_loss: 0.5634, label: 2, bag_size: 687
batch 319, loss: 0.0623, instance_loss: 0.0525, weighted_loss: 0.0593, label: 1, bag_size: 1127
batch 339, loss: 0.0159, instance_loss: 0.2952, weighted_loss: 0.0997, label: 0, bag_size: 122
batch 359, loss: 0.7061, instance_loss: 0.5354, weighted_loss: 0.6549, label: 1, bag_size: 293
batch 379, loss: 1.4073, instance_loss: 0.5682, weighted_loss: 1.1556, label: 1, bag_size: 838
batch 399, loss: 0.2542, instance_loss: 0.5630, weighted_loss: 0.3468, label: 4, bag_size: 542
batch 419, loss: 0.0947, instance_loss: 0.4489, weighted_loss: 0.2009, label: 1, bag_size: 860
batch 439, loss: 0.0070, instance_loss: 0.2151, weighted_loss: 0.0694, label: 3, bag_size: 18
batch 459, loss: 0.2568, instance_loss: 0.2499, weighted_loss: 0.2547, label: 0, bag_size: 200
batch 479, loss: 0.0042, instance_loss: 0.3178, weighted_loss: 0.0983, label: 4, bag_size: 24
batch 499, loss: 0.0006, instance_loss: 0.0414, weighted_loss: 0.0128, label: 4, bag_size: 167
batch 519, loss: 2.4931, instance_loss: 0.3295, weighted_loss: 1.8440, label: 4, bag_size: 646
batch 539, loss: 0.0011, instance_loss: 0.0289, weighted_loss: 0.0094, label: 0, bag_size: 385


class 0 clustering acc 0.9858256880733945: correct 21491/21800
class 1 clustering acc 0.5497706422018349: correct 2397/4360
Epoch: 31, train_loss: 0.2184, train_clustering_loss:  0.2552, train_error: 0.0734
class 0: acc 0.9622641509433962, correct 102/106
class 1: acc 0.8067226890756303, correct 96/119
class 2: acc 0.9074074074074074, correct 98/108
class 3: acc 0.9907407407407407, correct 107/108
class 4: acc 0.9807692307692307, correct 102/104

Val Set, val_loss: 1.0027, val_error: 0.3000, auc: 0.8553
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.29: correct 116/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.7777777777777778, correct 7/9
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0222, weighted_loss: 0.0067, label: 4, bag_size: 174
batch 39, loss: 0.1886, instance_loss: 0.1878, weighted_loss: 0.1883, label: 0, bag_size: 760
batch 59, loss: 0.0207, instance_loss: 0.4331, weighted_loss: 0.1444, label: 0, bag_size: 163
batch 79, loss: 0.1531, instance_loss: 0.2990, weighted_loss: 0.1969, label: 0, bag_size: 478
batch 99, loss: 0.0042, instance_loss: 0.2597, weighted_loss: 0.0808, label: 1, bag_size: 614
batch 119, loss: 0.2407, instance_loss: 0.2517, weighted_loss: 0.2440, label: 0, bag_size: 350
batch 139, loss: 0.1133, instance_loss: 0.2143, weighted_loss: 0.1436, label: 2, bag_size: 499
batch 159, loss: 0.0054, instance_loss: 0.1102, weighted_loss: 0.0369, label: 4, bag_size: 764
batch 179, loss: 0.0846, instance_loss: 0.3071, weighted_loss: 0.1514, label: 3, bag_size: 316
batch 199, loss: 0.3829, instance_loss: 0.4651, weighted_loss: 0.4076, label: 2, bag_size: 110
batch 219, loss: 0.0007, instance_loss: 0.0394, weighted_loss: 0.0123, label: 3, bag_size: 43
batch 239, loss: 0.2105, instance_loss: 0.5528, weighted_loss: 0.3132, label: 1, bag_size: 1144
batch 259, loss: 0.0655, instance_loss: 0.1433, weighted_loss: 0.0888, label: 2, bag_size: 499
batch 279, loss: 0.0327, instance_loss: 0.2082, weighted_loss: 0.0853, label: 0, bag_size: 371
batch 299, loss: 0.0108, instance_loss: 0.1592, weighted_loss: 0.0554, label: 3, bag_size: 78
batch 319, loss: 0.0004, instance_loss: 0.0397, weighted_loss: 0.0122, label: 4, bag_size: 114
batch 339, loss: 0.0131, instance_loss: 0.2081, weighted_loss: 0.0716, label: 0, bag_size: 155
batch 359, loss: 0.0030, instance_loss: 0.0485, weighted_loss: 0.0166, label: 3, bag_size: 54
batch 379, loss: 1.2546, instance_loss: 0.5567, weighted_loss: 1.0452, label: 1, bag_size: 861
batch 399, loss: 0.4143, instance_loss: 0.2841, weighted_loss: 0.3752, label: 0, bag_size: 912
batch 419, loss: 0.0204, instance_loss: 0.1333, weighted_loss: 0.0542, label: 0, bag_size: 246
batch 439, loss: 0.0008, instance_loss: 0.0913, weighted_loss: 0.0279, label: 3, bag_size: 34
batch 459, loss: 1.0280, instance_loss: 0.4841, weighted_loss: 0.8648, label: 1, bag_size: 651
batch 479, loss: 0.2288, instance_loss: 0.3774, weighted_loss: 0.2734, label: 1, bag_size: 887
batch 499, loss: 0.0162, instance_loss: 0.0519, weighted_loss: 0.0269, label: 0, bag_size: 1012
batch 519, loss: 0.0654, instance_loss: 0.2381, weighted_loss: 0.1172, label: 0, bag_size: 515
batch 539, loss: 0.7208, instance_loss: 0.7028, weighted_loss: 0.7154, label: 4, bag_size: 817


class 0 clustering acc 0.9854587155963302: correct 21483/21800
class 1 clustering acc 0.5364678899082569: correct 2339/4360
Epoch: 32, train_loss: 0.2121, train_clustering_loss:  0.2646, train_error: 0.0771
class 0: acc 0.9767441860465116, correct 126/129
class 1: acc 0.8017241379310345, correct 93/116
class 2: acc 0.912621359223301, correct 94/103
class 3: acc 0.98, correct 98/100
class 4: acc 0.9484536082474226, correct 92/97

Val Set, val_loss: 1.1808, val_error: 0.3200, auc: 0.8760
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.9, correct 9/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.1584, instance_loss: 0.3911, weighted_loss: 0.2282, label: 1, bag_size: 917
batch 39, loss: 0.0365, instance_loss: 0.5751, weighted_loss: 0.1981, label: 0, bag_size: 255
batch 59, loss: 0.1421, instance_loss: 0.2222, weighted_loss: 0.1661, label: 2, bag_size: 567
batch 79, loss: 0.0740, instance_loss: 0.1874, weighted_loss: 0.1080, label: 2, bag_size: 252
batch 99, loss: 0.0055, instance_loss: 0.0683, weighted_loss: 0.0244, label: 4, bag_size: 48
batch 119, loss: 0.0401, instance_loss: 0.1043, weighted_loss: 0.0594, label: 2, bag_size: 347
batch 139, loss: 0.0238, instance_loss: 0.2264, weighted_loss: 0.0846, label: 1, bag_size: 890
batch 159, loss: 0.0388, instance_loss: 0.2987, weighted_loss: 0.1168, label: 3, bag_size: 1291
batch 179, loss: 0.0183, instance_loss: 0.0611, weighted_loss: 0.0311, label: 0, bag_size: 1135
batch 199, loss: 0.0451, instance_loss: 0.1825, weighted_loss: 0.0863, label: 2, bag_size: 247
batch 219, loss: 0.0737, instance_loss: 0.7210, weighted_loss: 0.2679, label: 3, bag_size: 283
batch 239, loss: 0.7216, instance_loss: 0.5529, weighted_loss: 0.6710, label: 1, bag_size: 377
batch 259, loss: 0.0701, instance_loss: 0.1650, weighted_loss: 0.0986, label: 2, bag_size: 1653
batch 279, loss: 2.3247, instance_loss: 0.5775, weighted_loss: 1.8006, label: 1, bag_size: 1724
batch 299, loss: 0.0942, instance_loss: 0.1005, weighted_loss: 0.0961, label: 1, bag_size: 288
batch 319, loss: 0.0000, instance_loss: 0.0475, weighted_loss: 0.0143, label: 4, bag_size: 125
batch 339, loss: 0.3697, instance_loss: 0.3703, weighted_loss: 0.3699, label: 2, bag_size: 1141
batch 359, loss: 0.0006, instance_loss: 0.0758, weighted_loss: 0.0231, label: 3, bag_size: 18
batch 379, loss: 0.0170, instance_loss: 0.4146, weighted_loss: 0.1363, label: 0, bag_size: 116
batch 399, loss: 0.0079, instance_loss: 0.2858, weighted_loss: 0.0913, label: 3, bag_size: 24
batch 419, loss: 0.0035, instance_loss: 0.1144, weighted_loss: 0.0367, label: 4, bag_size: 764
batch 439, loss: 0.0077, instance_loss: 0.2823, weighted_loss: 0.0901, label: 0, bag_size: 118
batch 459, loss: 0.0974, instance_loss: 0.1817, weighted_loss: 0.1227, label: 2, bag_size: 470
batch 479, loss: 0.0353, instance_loss: 0.3234, weighted_loss: 0.1217, label: 3, bag_size: 24
batch 499, loss: 0.2295, instance_loss: 0.1890, weighted_loss: 0.2174, label: 2, bag_size: 910
batch 519, loss: 0.0076, instance_loss: 0.0889, weighted_loss: 0.0320, label: 0, bag_size: 1235
batch 539, loss: 0.0003, instance_loss: 0.0463, weighted_loss: 0.0141, label: 4, bag_size: 79


class 0 clustering acc 0.984954128440367: correct 21472/21800
class 1 clustering acc 0.5545871559633028: correct 2418/4360
Epoch: 33, train_loss: 0.2057, train_clustering_loss:  0.2569, train_error: 0.0716
class 0: acc 0.9326923076923077, correct 97/104
class 1: acc 0.8020833333333334, correct 77/96
class 2: acc 0.9310344827586207, correct 108/116
class 3: acc 0.990990990990991, correct 110/111
class 4: acc 0.9661016949152542, correct 114/118

Val Set, val_loss: 1.0320, val_error: 0.3400, auc: 0.8725
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.3025: correct 121/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0153, instance_loss: 0.2183, weighted_loss: 0.0762, label: 3, bag_size: 17
batch 39, loss: 0.0053, instance_loss: 0.2336, weighted_loss: 0.0738, label: 4, bag_size: 86
batch 59, loss: 0.0102, instance_loss: 0.1990, weighted_loss: 0.0669, label: 1, bag_size: 945
batch 79, loss: 0.0686, instance_loss: 0.0665, weighted_loss: 0.0680, label: 3, bag_size: 1559
batch 99, loss: 0.2093, instance_loss: 0.5184, weighted_loss: 0.3020, label: 1, bag_size: 786
batch 119, loss: 1.7913, instance_loss: 0.4949, weighted_loss: 1.4024, label: 2, bag_size: 1653
batch 139, loss: 0.0022, instance_loss: 0.0327, weighted_loss: 0.0113, label: 3, bag_size: 72
batch 159, loss: 0.0003, instance_loss: 0.0216, weighted_loss: 0.0067, label: 4, bag_size: 162
batch 179, loss: 0.0834, instance_loss: 0.4888, weighted_loss: 0.2050, label: 2, bag_size: 1197
batch 199, loss: 0.0095, instance_loss: 0.1013, weighted_loss: 0.0371, label: 3, bag_size: 18
batch 219, loss: 0.0002, instance_loss: 0.0518, weighted_loss: 0.0157, label: 4, bag_size: 157
batch 239, loss: 0.9460, instance_loss: 0.4601, weighted_loss: 0.8002, label: 0, bag_size: 1257
batch 259, loss: 0.0007, instance_loss: 0.1759, weighted_loss: 0.0532, label: 3, bag_size: 20
batch 279, loss: 0.0012, instance_loss: 0.1460, weighted_loss: 0.0447, label: 3, bag_size: 21
batch 299, loss: 0.0172, instance_loss: 0.1151, weighted_loss: 0.0466, label: 0, bag_size: 476
batch 319, loss: 0.0531, instance_loss: 0.2156, weighted_loss: 0.1018, label: 0, bag_size: 1196
batch 339, loss: 0.1092, instance_loss: 0.2855, weighted_loss: 0.1621, label: 2, bag_size: 252
batch 359, loss: 0.0851, instance_loss: 0.3015, weighted_loss: 0.1500, label: 2, bag_size: 649
batch 379, loss: 0.0501, instance_loss: 0.3179, weighted_loss: 0.1304, label: 0, bag_size: 542
batch 399, loss: 0.0050, instance_loss: 0.0463, weighted_loss: 0.0174, label: 3, bag_size: 43
batch 419, loss: 0.0133, instance_loss: 0.1343, weighted_loss: 0.0496, label: 0, bag_size: 921
batch 439, loss: 0.0439, instance_loss: 0.0999, weighted_loss: 0.0607, label: 0, bag_size: 410
batch 459, loss: 0.0176, instance_loss: 0.0664, weighted_loss: 0.0322, label: 3, bag_size: 1172
batch 479, loss: 0.3801, instance_loss: 0.4864, weighted_loss: 0.4120, label: 3, bag_size: 200
batch 499, loss: 0.0090, instance_loss: 0.2523, weighted_loss: 0.0820, label: 0, bag_size: 120
batch 519, loss: 0.0005, instance_loss: 0.1409, weighted_loss: 0.0426, label: 4, bag_size: 35
batch 539, loss: 0.0013, instance_loss: 0.0513, weighted_loss: 0.0163, label: 3, bag_size: 28


class 0 clustering acc 0.9870183486238532: correct 21517/21800
class 1 clustering acc 0.5736238532110092: correct 2501/4360
Epoch: 34, train_loss: 0.1735, train_clustering_loss:  0.2434, train_error: 0.0697
class 0: acc 0.9696969696969697, correct 96/99
class 1: acc 0.797979797979798, correct 79/99
class 2: acc 0.9047619047619048, correct 95/105
class 3: acc 0.9833333333333333, correct 118/120
class 4: acc 0.9754098360655737, correct 119/122

Val Set, val_loss: 0.9319, val_error: 0.2800, auc: 0.8964
class 0 clustering acc 0.9665: correct 1933/2000
class 1 clustering acc 0.325: correct 130/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.7777777777777778, correct 7/9
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1025, instance_loss: 0.1478, weighted_loss: 0.1161, label: 2, bag_size: 1006
batch 39, loss: 0.1199, instance_loss: 0.2825, weighted_loss: 0.1687, label: 2, bag_size: 687
batch 59, loss: 0.0140, instance_loss: 0.0700, weighted_loss: 0.0308, label: 3, bag_size: 18
batch 79, loss: 0.0072, instance_loss: 0.1079, weighted_loss: 0.0374, label: 4, bag_size: 140
batch 99, loss: 0.1132, instance_loss: 0.4775, weighted_loss: 0.2225, label: 1, bag_size: 319
batch 119, loss: 0.0041, instance_loss: 0.1944, weighted_loss: 0.0612, label: 3, bag_size: 115
batch 139, loss: 0.2060, instance_loss: 0.2967, weighted_loss: 0.2332, label: 2, bag_size: 883
batch 159, loss: 0.0086, instance_loss: 0.2338, weighted_loss: 0.0762, label: 0, bag_size: 630
batch 179, loss: 0.0666, instance_loss: 0.3638, weighted_loss: 0.1558, label: 2, bag_size: 1218
batch 199, loss: 0.1469, instance_loss: 0.4796, weighted_loss: 0.2467, label: 1, bag_size: 1144
batch 219, loss: 0.0006, instance_loss: 0.0503, weighted_loss: 0.0155, label: 3, bag_size: 78
batch 239, loss: 0.0395, instance_loss: 0.1610, weighted_loss: 0.0760, label: 0, bag_size: 1061
batch 259, loss: 0.0021, instance_loss: 0.1259, weighted_loss: 0.0392, label: 3, bag_size: 21
batch 279, loss: 0.1361, instance_loss: 0.2012, weighted_loss: 0.1556, label: 0, bag_size: 1061
batch 299, loss: 0.2619, instance_loss: 0.3122, weighted_loss: 0.2770, label: 2, bag_size: 482
batch 319, loss: 0.0034, instance_loss: 0.0887, weighted_loss: 0.0290, label: 3, bag_size: 94
batch 339, loss: 2.2884, instance_loss: 0.8061, weighted_loss: 1.8437, label: 1, bag_size: 1376
batch 359, loss: 0.0108, instance_loss: 0.3517, weighted_loss: 0.1130, label: 0, bag_size: 128
batch 379, loss: 0.0002, instance_loss: 0.0418, weighted_loss: 0.0126, label: 4, bag_size: 148
batch 399, loss: 0.0761, instance_loss: 0.4330, weighted_loss: 0.1832, label: 0, bag_size: 466
batch 419, loss: 0.0059, instance_loss: 0.3666, weighted_loss: 0.1141, label: 0, bag_size: 118
batch 439, loss: 0.0000, instance_loss: 0.1296, weighted_loss: 0.0389, label: 3, bag_size: 20
batch 459, loss: 0.0363, instance_loss: 0.7714, weighted_loss: 0.2568, label: 3, bag_size: 1380
batch 479, loss: 0.0546, instance_loss: 1.0752, weighted_loss: 0.3608, label: 3, bag_size: 1380
batch 499, loss: 0.0126, instance_loss: 0.0714, weighted_loss: 0.0302, label: 1, bag_size: 1191
batch 519, loss: 0.0149, instance_loss: 0.0296, weighted_loss: 0.0193, label: 3, bag_size: 1172
batch 539, loss: 0.0127, instance_loss: 0.0909, weighted_loss: 0.0362, label: 1, bag_size: 682


class 0 clustering acc 0.9853211009174312: correct 21480/21800
class 1 clustering acc 0.5775229357798165: correct 2518/4360
Epoch: 35, train_loss: 0.1573, train_clustering_loss:  0.2517, train_error: 0.0477
class 0: acc 0.9693877551020408, correct 95/98
class 1: acc 0.8571428571428571, correct 96/112
class 2: acc 0.9658119658119658, correct 113/117
class 3: acc 0.9907407407407407, correct 107/108
class 4: acc 0.9818181818181818, correct 108/110

Val Set, val_loss: 1.2240, val_error: 0.3600, auc: 0.8713
class 0 clustering acc 0.9615: correct 1923/2000
class 1 clustering acc 0.3375: correct 135/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8, correct 8/10
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 25 out of 20


batch 19, loss: 1.5216, instance_loss: 0.3429, weighted_loss: 1.1679, label: 2, bag_size: 395
batch 39, loss: 0.2280, instance_loss: 0.5864, weighted_loss: 0.3355, label: 1, bag_size: 747
batch 59, loss: 0.0006, instance_loss: 0.0737, weighted_loss: 0.0225, label: 4, bag_size: 38
batch 79, loss: 0.8545, instance_loss: 0.8531, weighted_loss: 0.8540, label: 1, bag_size: 660
batch 99, loss: 0.2802, instance_loss: 0.1904, weighted_loss: 0.2532, label: 2, bag_size: 395
batch 119, loss: 0.9065, instance_loss: 0.3830, weighted_loss: 0.7495, label: 0, bag_size: 117
batch 139, loss: 0.1925, instance_loss: 0.5926, weighted_loss: 0.3125, label: 1, bag_size: 386
batch 159, loss: 0.0162, instance_loss: 0.0766, weighted_loss: 0.0343, label: 3, bag_size: 63
batch 179, loss: 0.0731, instance_loss: 0.2735, weighted_loss: 0.1332, label: 0, bag_size: 1332
batch 199, loss: 0.0284, instance_loss: 0.0955, weighted_loss: 0.0485, label: 4, bag_size: 26
batch 219, loss: 1.2956, instance_loss: 0.7805, weighted_loss: 1.1411, label: 1, bag_size: 660
batch 239, loss: 0.3259, instance_loss: 0.2788, weighted_loss: 0.3118, label: 2, bag_size: 1404
batch 259, loss: 0.2319, instance_loss: 0.2399, weighted_loss: 0.2343, label: 3, bag_size: 18
batch 279, loss: 0.0673, instance_loss: 0.1809, weighted_loss: 0.1014, label: 2, bag_size: 525
batch 299, loss: 0.0076, instance_loss: 0.0525, weighted_loss: 0.0211, label: 4, bag_size: 123
batch 319, loss: 0.1462, instance_loss: 0.6307, weighted_loss: 0.2916, label: 2, bag_size: 1677
batch 339, loss: 0.0790, instance_loss: 0.2038, weighted_loss: 0.1164, label: 2, bag_size: 345
batch 359, loss: 0.0005, instance_loss: 0.1263, weighted_loss: 0.0383, label: 3, bag_size: 21
batch 379, loss: 0.1858, instance_loss: 0.2869, weighted_loss: 0.2161, label: 2, bag_size: 861
batch 399, loss: 0.1443, instance_loss: 0.2027, weighted_loss: 0.1618, label: 2, bag_size: 758
batch 419, loss: 0.0012, instance_loss: 0.1206, weighted_loss: 0.0371, label: 3, bag_size: 35
batch 439, loss: 0.0193, instance_loss: 0.1335, weighted_loss: 0.0535, label: 1, bag_size: 790
batch 459, loss: 0.0775, instance_loss: 0.2178, weighted_loss: 0.1196, label: 2, bag_size: 589
batch 479, loss: 0.1018, instance_loss: 0.6138, weighted_loss: 0.2554, label: 4, bag_size: 1331
batch 499, loss: 0.0156, instance_loss: 0.2539, weighted_loss: 0.0871, label: 2, bag_size: 358
batch 519, loss: 0.0201, instance_loss: 0.4232, weighted_loss: 0.1411, label: 1, bag_size: 965
batch 539, loss: 0.0168, instance_loss: 0.0548, weighted_loss: 0.0282, label: 2, bag_size: 455


class 0 clustering acc 0.9838990825688073: correct 21449/21800
class 1 clustering acc 0.5793577981651377: correct 2526/4360
Epoch: 36, train_loss: 0.1610, train_clustering_loss:  0.2502, train_error: 0.0495
class 0: acc 0.9578947368421052, correct 91/95
class 1: acc 0.8514851485148515, correct 86/101
class 2: acc 0.9385964912280702, correct 107/114
class 3: acc 1.0, correct 125/125
class 4: acc 0.990909090909091, correct 109/110

Val Set, val_loss: 1.1721, val_error: 0.3600, auc: 0.8706
class 0 clustering acc 0.9665: correct 1933/2000
class 1 clustering acc 0.4125: correct 165/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0031, instance_loss: 0.5888, weighted_loss: 0.1788, label: 0, bag_size: 109
batch 39, loss: 0.0002, instance_loss: 0.0627, weighted_loss: 0.0189, label: 3, bag_size: 18
batch 59, loss: 0.0108, instance_loss: 0.0757, weighted_loss: 0.0303, label: 0, bag_size: 1235
batch 79, loss: 0.0098, instance_loss: 0.6644, weighted_loss: 0.2062, label: 1, bag_size: 945
batch 99, loss: 0.0151, instance_loss: 0.1488, weighted_loss: 0.0552, label: 2, bag_size: 1788
batch 119, loss: 0.0261, instance_loss: 0.1246, weighted_loss: 0.0556, label: 3, bag_size: 952
batch 139, loss: 0.0102, instance_loss: 0.0781, weighted_loss: 0.0305, label: 3, bag_size: 1172
batch 159, loss: 0.0436, instance_loss: 0.3856, weighted_loss: 0.1462, label: 4, bag_size: 1474
batch 179, loss: 0.3187, instance_loss: 0.2589, weighted_loss: 0.3007, label: 2, bag_size: 748
batch 199, loss: 0.0059, instance_loss: 0.1233, weighted_loss: 0.0411, label: 3, bag_size: 78
batch 219, loss: 0.0009, instance_loss: 0.0663, weighted_loss: 0.0205, label: 3, bag_size: 105
batch 239, loss: 0.0686, instance_loss: 0.3041, weighted_loss: 0.1392, label: 0, bag_size: 1301
batch 259, loss: 0.0075, instance_loss: 0.1126, weighted_loss: 0.0390, label: 0, bag_size: 653
batch 279, loss: 0.0621, instance_loss: 0.0996, weighted_loss: 0.0734, label: 1, bag_size: 869
batch 299, loss: 0.0050, instance_loss: 0.7961, weighted_loss: 0.2423, label: 4, bag_size: 436
batch 319, loss: 0.0036, instance_loss: 0.0458, weighted_loss: 0.0163, label: 0, bag_size: 402
batch 339, loss: 0.0921, instance_loss: 0.1773, weighted_loss: 0.1177, label: 2, bag_size: 935
batch 359, loss: 0.0267, instance_loss: 0.2332, weighted_loss: 0.0887, label: 0, bag_size: 1174
batch 379, loss: 0.0037, instance_loss: 0.2075, weighted_loss: 0.0648, label: 3, bag_size: 1253
batch 399, loss: 0.3903, instance_loss: 0.3248, weighted_loss: 0.3707, label: 2, bag_size: 400
batch 419, loss: 0.3137, instance_loss: 0.4701, weighted_loss: 0.3606, label: 2, bag_size: 373
batch 439, loss: 1.6107, instance_loss: 0.2688, weighted_loss: 1.2081, label: 2, bag_size: 323
batch 459, loss: 0.0442, instance_loss: 0.1309, weighted_loss: 0.0702, label: 2, bag_size: 499
batch 479, loss: 0.2456, instance_loss: 0.2033, weighted_loss: 0.2329, label: 1, bag_size: 847
batch 499, loss: 0.4497, instance_loss: 0.4504, weighted_loss: 0.4499, label: 0, bag_size: 1527
batch 519, loss: 0.0018, instance_loss: 0.0378, weighted_loss: 0.0126, label: 3, bag_size: 43
batch 539, loss: 0.0784, instance_loss: 0.2442, weighted_loss: 0.1281, label: 3, bag_size: 533


class 0 clustering acc 0.9828899082568807: correct 21427/21800
class 1 clustering acc 0.5711009174311926: correct 2490/4360
Epoch: 37, train_loss: 0.1917, train_clustering_loss:  0.2577, train_error: 0.0642
class 0: acc 0.9545454545454546, correct 105/110
class 1: acc 0.8440366972477065, correct 92/109
class 2: acc 0.9326923076923077, correct 97/104
class 3: acc 0.9711538461538461, correct 101/104
class 4: acc 0.9745762711864406, correct 115/118

Val Set, val_loss: 1.1167, val_error: 0.3200, auc: 0.8739
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.3325: correct 133/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0175, instance_loss: 0.1568, weighted_loss: 0.0593, label: 4, bag_size: 86
batch 39, loss: 0.0010, instance_loss: 0.0324, weighted_loss: 0.0104, label: 3, bag_size: 43
batch 59, loss: 0.0098, instance_loss: 0.1457, weighted_loss: 0.0506, label: 0, bag_size: 1012
batch 79, loss: 0.0061, instance_loss: 0.1554, weighted_loss: 0.0509, label: 3, bag_size: 1118
batch 99, loss: 0.7505, instance_loss: 0.4336, weighted_loss: 0.6554, label: 0, bag_size: 759
batch 119, loss: 0.2213, instance_loss: 0.3151, weighted_loss: 0.2494, label: 2, bag_size: 806
batch 139, loss: 0.0296, instance_loss: 0.0790, weighted_loss: 0.0444, label: 3, bag_size: 451
batch 159, loss: 0.0047, instance_loss: 0.3894, weighted_loss: 0.1201, label: 3, bag_size: 16
batch 179, loss: 0.0020, instance_loss: 0.5697, weighted_loss: 0.1723, label: 4, bag_size: 711
batch 199, loss: 0.0905, instance_loss: 0.2539, weighted_loss: 0.1395, label: 2, bag_size: 774
batch 219, loss: 0.0957, instance_loss: 0.1012, weighted_loss: 0.0973, label: 3, bag_size: 1177
batch 239, loss: 0.0066, instance_loss: 0.1684, weighted_loss: 0.0551, label: 0, bag_size: 1101
batch 259, loss: 0.0002, instance_loss: 0.0364, weighted_loss: 0.0111, label: 4, bag_size: 157
batch 279, loss: 0.0003, instance_loss: 0.0394, weighted_loss: 0.0120, label: 4, bag_size: 86
batch 299, loss: 0.0933, instance_loss: 0.4869, weighted_loss: 0.2114, label: 1, bag_size: 386
batch 319, loss: 0.0096, instance_loss: 0.1570, weighted_loss: 0.0538, label: 0, bag_size: 413
batch 339, loss: 0.0001, instance_loss: 0.0161, weighted_loss: 0.0049, label: 4, bag_size: 147
batch 359, loss: 0.7965, instance_loss: 0.3340, weighted_loss: 0.6577, label: 0, bag_size: 1257
batch 379, loss: 0.3634, instance_loss: 0.4747, weighted_loss: 0.3968, label: 3, bag_size: 1250
batch 399, loss: 0.0001, instance_loss: 0.0788, weighted_loss: 0.0237, label: 4, bag_size: 24
batch 419, loss: 0.1553, instance_loss: 0.3637, weighted_loss: 0.2179, label: 0, bag_size: 1332
batch 439, loss: 0.0090, instance_loss: 0.0648, weighted_loss: 0.0257, label: 1, bag_size: 369
batch 459, loss: 0.9584, instance_loss: 0.4509, weighted_loss: 0.8061, label: 0, bag_size: 912
batch 479, loss: 0.0015, instance_loss: 0.1295, weighted_loss: 0.0399, label: 3, bag_size: 28
batch 499, loss: 0.1468, instance_loss: 0.5166, weighted_loss: 0.2578, label: 3, bag_size: 200
batch 519, loss: 0.1769, instance_loss: 0.1430, weighted_loss: 0.1667, label: 2, bag_size: 846
batch 539, loss: 0.0047, instance_loss: 0.0567, weighted_loss: 0.0203, label: 1, bag_size: 886


class 0 clustering acc 0.9833944954128441: correct 21438/21800
class 1 clustering acc 0.531651376146789: correct 2318/4360
Epoch: 38, train_loss: 0.1922, train_clustering_loss:  0.2687, train_error: 0.0624
class 0: acc 0.9489795918367347, correct 93/98
class 1: acc 0.8275862068965517, correct 96/116
class 2: acc 0.9401709401709402, correct 110/117
class 3: acc 0.990990990990991, correct 110/111
class 4: acc 0.9902912621359223, correct 102/103

Val Set, val_loss: 1.1873, val_error: 0.3400, auc: 0.8734
class 0 clustering acc 0.965: correct 1930/2000
class 1 clustering acc 0.34: correct 136/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0010, instance_loss: 0.1161, weighted_loss: 0.0355, label: 3, bag_size: 48
batch 39, loss: 0.0122, instance_loss: 0.2023, weighted_loss: 0.0692, label: 1, bag_size: 405
batch 59, loss: 0.0065, instance_loss: 0.4602, weighted_loss: 0.1426, label: 0, bag_size: 116
batch 79, loss: 0.0040, instance_loss: 0.4107, weighted_loss: 0.1260, label: 3, bag_size: 706
batch 99, loss: 0.1652, instance_loss: 0.2598, weighted_loss: 0.1936, label: 0, bag_size: 1065
batch 119, loss: 1.2241, instance_loss: 0.5255, weighted_loss: 1.0145, label: 1, bag_size: 1197
batch 139, loss: 0.1523, instance_loss: 0.3462, weighted_loss: 0.2104, label: 1, bag_size: 1096
batch 159, loss: 0.1493, instance_loss: 0.4650, weighted_loss: 0.2440, label: 2, bag_size: 1410
batch 179, loss: 0.0288, instance_loss: 0.0895, weighted_loss: 0.0470, label: 1, bag_size: 790
batch 199, loss: 0.4352, instance_loss: 0.5206, weighted_loss: 0.4608, label: 2, bag_size: 259
batch 219, loss: 0.0183, instance_loss: 0.0626, weighted_loss: 0.0316, label: 1, bag_size: 1261
batch 239, loss: 0.1042, instance_loss: 0.2534, weighted_loss: 0.1490, label: 2, bag_size: 1141
batch 259, loss: 0.0417, instance_loss: 0.2109, weighted_loss: 0.0925, label: 2, bag_size: 247
batch 279, loss: 0.0017, instance_loss: 0.0487, weighted_loss: 0.0158, label: 4, bag_size: 182
batch 299, loss: 0.0005, instance_loss: 0.0607, weighted_loss: 0.0186, label: 1, bag_size: 1376
batch 319, loss: 0.0551, instance_loss: 0.1629, weighted_loss: 0.0874, label: 2, bag_size: 345
batch 339, loss: 0.0263, instance_loss: 0.5089, weighted_loss: 0.1711, label: 4, bag_size: 1331
batch 359, loss: 0.1843, instance_loss: 0.5009, weighted_loss: 0.2793, label: 3, bag_size: 936
batch 379, loss: 0.0299, instance_loss: 0.1762, weighted_loss: 0.0738, label: 0, bag_size: 1332
batch 399, loss: 0.0009, instance_loss: 0.0557, weighted_loss: 0.0173, label: 3, bag_size: 33
batch 419, loss: 0.9374, instance_loss: 0.6922, weighted_loss: 0.8638, label: 0, bag_size: 245
batch 439, loss: 0.0238, instance_loss: 0.1175, weighted_loss: 0.0519, label: 0, bag_size: 367
batch 459, loss: 0.1031, instance_loss: 0.2894, weighted_loss: 0.1590, label: 2, bag_size: 1410
batch 479, loss: 0.0016, instance_loss: 0.0322, weighted_loss: 0.0108, label: 4, bag_size: 43
batch 499, loss: 0.0523, instance_loss: 0.5330, weighted_loss: 0.1965, label: 1, bag_size: 319
batch 519, loss: 0.0386, instance_loss: 0.1050, weighted_loss: 0.0586, label: 3, bag_size: 451
batch 539, loss: 0.0563, instance_loss: 0.3580, weighted_loss: 0.1468, label: 2, bag_size: 803


class 0 clustering acc 0.9844954128440367: correct 21462/21800
class 1 clustering acc 0.5669724770642202: correct 2472/4360
Epoch: 39, train_loss: 0.2075, train_clustering_loss:  0.2561, train_error: 0.0569
class 0: acc 0.9739130434782609, correct 112/115
class 1: acc 0.8571428571428571, correct 96/112
class 2: acc 0.923728813559322, correct 109/118
class 3: acc 0.9895833333333334, correct 95/96
class 4: acc 0.9807692307692307, correct 102/104

Val Set, val_loss: 1.1233, val_error: 0.3600, auc: 0.8688
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.8421052631578947, correct 16/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0012, instance_loss: 0.3668, weighted_loss: 0.1109, label: 4, bag_size: 24
batch 39, loss: 0.0005, instance_loss: 0.3043, weighted_loss: 0.0917, label: 4, bag_size: 17
batch 59, loss: 0.0042, instance_loss: 0.1790, weighted_loss: 0.0567, label: 0, bag_size: 110
batch 79, loss: 0.7012, instance_loss: 0.5252, weighted_loss: 0.6484, label: 1, bag_size: 657
batch 99, loss: 0.2760, instance_loss: 0.3925, weighted_loss: 0.3109, label: 1, bag_size: 747
batch 119, loss: 0.0005, instance_loss: 0.0279, weighted_loss: 0.0087, label: 4, bag_size: 101
batch 139, loss: 0.0049, instance_loss: 0.0502, weighted_loss: 0.0185, label: 1, bag_size: 1261
batch 159, loss: 0.1681, instance_loss: 0.3513, weighted_loss: 0.2231, label: 0, bag_size: 1332
batch 179, loss: 0.0011, instance_loss: 0.1188, weighted_loss: 0.0364, label: 0, bag_size: 246
batch 199, loss: 0.0042, instance_loss: 0.0850, weighted_loss: 0.0284, label: 4, bag_size: 44
batch 219, loss: 0.0453, instance_loss: 0.1875, weighted_loss: 0.0880, label: 1, bag_size: 598
batch 239, loss: 0.0168, instance_loss: 0.0988, weighted_loss: 0.0414, label: 0, bag_size: 246
batch 259, loss: 0.0063, instance_loss: 0.1916, weighted_loss: 0.0619, label: 0, bag_size: 110
batch 279, loss: 0.3229, instance_loss: 0.2935, weighted_loss: 0.3141, label: 2, bag_size: 1617
batch 299, loss: 0.1156, instance_loss: 0.1239, weighted_loss: 0.1180, label: 3, bag_size: 1177
batch 319, loss: 0.0525, instance_loss: 0.1149, weighted_loss: 0.0712, label: 2, bag_size: 941
batch 339, loss: 0.0211, instance_loss: 0.1897, weighted_loss: 0.0717, label: 3, bag_size: 1291
batch 359, loss: 0.0014, instance_loss: 0.0748, weighted_loss: 0.0234, label: 3, bag_size: 32
batch 379, loss: 0.0484, instance_loss: 0.4170, weighted_loss: 0.1590, label: 2, bag_size: 750
batch 399, loss: 0.0006, instance_loss: 0.0701, weighted_loss: 0.0214, label: 4, bag_size: 178
batch 419, loss: 0.0005, instance_loss: 0.0560, weighted_loss: 0.0172, label: 3, bag_size: 143
batch 439, loss: 0.0005, instance_loss: 0.0464, weighted_loss: 0.0142, label: 4, bag_size: 30
batch 459, loss: 0.0028, instance_loss: 0.0583, weighted_loss: 0.0195, label: 0, bag_size: 1235
batch 479, loss: 0.1687, instance_loss: 0.1741, weighted_loss: 0.1703, label: 2, bag_size: 2081
batch 499, loss: 0.0002, instance_loss: 0.2087, weighted_loss: 0.0627, label: 4, bag_size: 134
batch 519, loss: 0.0051, instance_loss: 0.3347, weighted_loss: 0.1040, label: 4, bag_size: 297
batch 539, loss: 0.1482, instance_loss: 0.6450, weighted_loss: 0.2972, label: 2, bag_size: 732


class 0 clustering acc 0.9854128440366973: correct 21482/21800
class 1 clustering acc 0.55: correct 2398/4360
Epoch: 40, train_loss: 0.1395, train_clustering_loss:  0.2546, train_error: 0.0422
class 0: acc 0.9791666666666666, correct 94/96
class 1: acc 0.8916666666666667, correct 107/120
class 2: acc 0.9444444444444444, correct 102/108
class 3: acc 1.0, correct 102/102
class 4: acc 0.9831932773109243, correct 117/119

Val Set, val_loss: 1.1699, val_error: 0.3400, auc: 0.8713
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.33: correct 132/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0282, instance_loss: 0.5723, weighted_loss: 0.1914, label: 2, bag_size: 679
batch 39, loss: 0.0426, instance_loss: 0.2173, weighted_loss: 0.0950, label: 2, bag_size: 405
batch 59, loss: 0.0033, instance_loss: 0.2523, weighted_loss: 0.0780, label: 3, bag_size: 18
batch 79, loss: 0.0146, instance_loss: 0.2378, weighted_loss: 0.0815, label: 2, bag_size: 638
batch 99, loss: 0.0001, instance_loss: 0.0630, weighted_loss: 0.0189, label: 3, bag_size: 24
batch 119, loss: 0.0025, instance_loss: 0.1967, weighted_loss: 0.0607, label: 3, bag_size: 18
batch 139, loss: 0.0238, instance_loss: 0.1397, weighted_loss: 0.0585, label: 0, bag_size: 478
batch 159, loss: 0.0516, instance_loss: 0.5137, weighted_loss: 0.1902, label: 4, bag_size: 366
batch 179, loss: 0.0218, instance_loss: 0.0745, weighted_loss: 0.0376, label: 1, bag_size: 937
batch 199, loss: 0.0172, instance_loss: 0.2052, weighted_loss: 0.0736, label: 0, bag_size: 120
batch 219, loss: 0.0612, instance_loss: 0.5334, weighted_loss: 0.2028, label: 4, bag_size: 1474
batch 239, loss: 0.0045, instance_loss: 0.2821, weighted_loss: 0.0878, label: 3, bag_size: 18
batch 259, loss: 0.0007, instance_loss: 0.0381, weighted_loss: 0.0119, label: 0, bag_size: 1599
batch 279, loss: 0.0037, instance_loss: 0.2684, weighted_loss: 0.0831, label: 3, bag_size: 18
batch 299, loss: 0.0003, instance_loss: 0.1020, weighted_loss: 0.0308, label: 3, bag_size: 53
batch 319, loss: 0.0031, instance_loss: 0.2990, weighted_loss: 0.0919, label: 0, bag_size: 437
batch 339, loss: 0.0552, instance_loss: 0.3930, weighted_loss: 0.1566, label: 1, bag_size: 746
batch 359, loss: 0.0158, instance_loss: 0.1023, weighted_loss: 0.0418, label: 2, bag_size: 636
batch 379, loss: 1.9411, instance_loss: 0.7567, weighted_loss: 1.5858, label: 1, bag_size: 1197
batch 399, loss: 0.0017, instance_loss: 0.0731, weighted_loss: 0.0231, label: 3, bag_size: 97
batch 419, loss: 0.0254, instance_loss: 0.1620, weighted_loss: 0.0663, label: 2, bag_size: 636
batch 439, loss: 0.0005, instance_loss: 0.0140, weighted_loss: 0.0045, label: 0, bag_size: 982
batch 459, loss: 0.0058, instance_loss: 0.1324, weighted_loss: 0.0438, label: 3, bag_size: 305
batch 479, loss: 0.0014, instance_loss: 0.0912, weighted_loss: 0.0283, label: 3, bag_size: 48
batch 499, loss: 0.0022, instance_loss: 0.0333, weighted_loss: 0.0116, label: 3, bag_size: 41
batch 519, loss: 0.0112, instance_loss: 0.0801, weighted_loss: 0.0319, label: 1, bag_size: 369
batch 539, loss: 0.0356, instance_loss: 0.2350, weighted_loss: 0.0954, label: 0, bag_size: 1196


class 0 clustering acc 0.9838532110091743: correct 21448/21800
class 1 clustering acc 0.6009174311926605: correct 2620/4360
Epoch: 41, train_loss: 0.1142, train_clustering_loss:  0.2415, train_error: 0.0349
class 0: acc 0.9636363636363636, correct 106/110
class 1: acc 0.926829268292683, correct 76/82
class 2: acc 0.952755905511811, correct 121/127
class 3: acc 0.9841269841269841, correct 124/126
class 4: acc 0.99, correct 99/100

Val Set, val_loss: 1.3007, val_error: 0.3800, auc: 0.8552
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.3825: correct 153/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0010, instance_loss: 0.0186, weighted_loss: 0.0063, label: 4, bag_size: 202
batch 39, loss: 0.6919, instance_loss: 0.3663, weighted_loss: 0.5942, label: 0, bag_size: 1257
batch 59, loss: 0.1132, instance_loss: 0.4161, weighted_loss: 0.2041, label: 2, bag_size: 883
batch 79, loss: 0.9510, instance_loss: 0.4064, weighted_loss: 0.7876, label: 2, bag_size: 1119
batch 99, loss: 0.0287, instance_loss: 0.1747, weighted_loss: 0.0725, label: 1, bag_size: 399
batch 119, loss: 0.0013, instance_loss: 0.0266, weighted_loss: 0.0089, label: 0, bag_size: 616
batch 139, loss: 0.0271, instance_loss: 0.2665, weighted_loss: 0.0990, label: 2, bag_size: 248
batch 159, loss: 0.1929, instance_loss: 0.7718, weighted_loss: 0.3665, label: 1, bag_size: 868
batch 179, loss: 0.4421, instance_loss: 0.2143, weighted_loss: 0.3738, label: 1, bag_size: 1144
batch 199, loss: 0.0275, instance_loss: 0.7060, weighted_loss: 0.2311, label: 4, bag_size: 675
batch 219, loss: 0.0290, instance_loss: 0.2456, weighted_loss: 0.0940, label: 2, bag_size: 720
batch 239, loss: 0.0004, instance_loss: 0.0260, weighted_loss: 0.0081, label: 4, bag_size: 764
batch 259, loss: 0.0011, instance_loss: 0.0841, weighted_loss: 0.0260, label: 0, bag_size: 1517
batch 279, loss: 0.0399, instance_loss: 0.1820, weighted_loss: 0.0826, label: 1, bag_size: 1144
batch 299, loss: 0.2068, instance_loss: 0.5138, weighted_loss: 0.2989, label: 1, bag_size: 293
batch 319, loss: 0.0115, instance_loss: 0.0891, weighted_loss: 0.0348, label: 4, bag_size: 35
batch 339, loss: 0.3488, instance_loss: 0.3136, weighted_loss: 0.3382, label: 2, bag_size: 265
batch 359, loss: 0.4698, instance_loss: 0.6824, weighted_loss: 0.5335, label: 1, bag_size: 102
batch 379, loss: 0.2146, instance_loss: 0.2452, weighted_loss: 0.2238, label: 2, bag_size: 839
batch 399, loss: 0.0814, instance_loss: 0.2294, weighted_loss: 0.1258, label: 0, bag_size: 375
batch 419, loss: 0.0061, instance_loss: 0.0962, weighted_loss: 0.0331, label: 1, bag_size: 828
batch 439, loss: 0.0423, instance_loss: 0.1585, weighted_loss: 0.0772, label: 1, bag_size: 697
batch 459, loss: 0.0069, instance_loss: 0.2065, weighted_loss: 0.0667, label: 0, bag_size: 155
batch 479, loss: 0.0005, instance_loss: 0.0280, weighted_loss: 0.0087, label: 3, bag_size: 143
batch 499, loss: 0.1404, instance_loss: 0.2130, weighted_loss: 0.1622, label: 2, bag_size: 1164
batch 519, loss: 0.0000, instance_loss: 0.0611, weighted_loss: 0.0184, label: 4, bag_size: 157
batch 539, loss: 0.0367, instance_loss: 0.5067, weighted_loss: 0.1777, label: 1, bag_size: 959


class 0 clustering acc 0.9833944954128441: correct 21438/21800
class 1 clustering acc 0.5928899082568807: correct 2585/4360
Epoch: 42, train_loss: 0.1468, train_clustering_loss:  0.2514, train_error: 0.0385
class 0: acc 0.9716981132075472, correct 103/106
class 1: acc 0.898989898989899, correct 89/99
class 2: acc 0.9545454545454546, correct 105/110
class 3: acc 0.9921875, correct 127/128
class 4: acc 0.9803921568627451, correct 100/102

Val Set, val_loss: 1.1910, val_error: 0.3800, auc: 0.8624
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0820, instance_loss: 0.2407, weighted_loss: 0.1296, label: 2, bag_size: 649
batch 39, loss: 0.3015, instance_loss: 0.2949, weighted_loss: 0.2995, label: 0, bag_size: 200
batch 59, loss: 0.0095, instance_loss: 0.1208, weighted_loss: 0.0429, label: 4, bag_size: 764
batch 79, loss: 0.4784, instance_loss: 0.4478, weighted_loss: 0.4692, label: 4, bag_size: 1278
batch 99, loss: 0.1180, instance_loss: 0.2660, weighted_loss: 0.1624, label: 1, bag_size: 288
batch 119, loss: 0.0320, instance_loss: 0.1031, weighted_loss: 0.0533, label: 1, bag_size: 949
batch 139, loss: 0.0001, instance_loss: 0.0668, weighted_loss: 0.0201, label: 3, bag_size: 24
batch 159, loss: 0.0072, instance_loss: 0.1463, weighted_loss: 0.0489, label: 4, bag_size: 636
batch 179, loss: 0.0919, instance_loss: 0.3227, weighted_loss: 0.1612, label: 0, bag_size: 1257
batch 199, loss: 0.0402, instance_loss: 0.1839, weighted_loss: 0.0833, label: 3, bag_size: 533
batch 219, loss: 0.1985, instance_loss: 0.3865, weighted_loss: 0.2549, label: 2, bag_size: 508
batch 239, loss: 0.0008, instance_loss: 0.0572, weighted_loss: 0.0177, label: 0, bag_size: 898
batch 259, loss: 0.0152, instance_loss: 0.0887, weighted_loss: 0.0373, label: 4, bag_size: 91
batch 279, loss: 0.0445, instance_loss: 0.1484, weighted_loss: 0.0757, label: 1, bag_size: 399
batch 299, loss: 0.0316, instance_loss: 0.2274, weighted_loss: 0.0903, label: 0, bag_size: 200
batch 319, loss: 0.0025, instance_loss: 0.1679, weighted_loss: 0.0521, label: 0, bag_size: 760
batch 339, loss: 0.0314, instance_loss: 0.3659, weighted_loss: 0.1318, label: 0, bag_size: 117
batch 359, loss: 0.0064, instance_loss: 0.1621, weighted_loss: 0.0531, label: 3, bag_size: 952
batch 379, loss: 0.0132, instance_loss: 0.0368, weighted_loss: 0.0203, label: 4, bag_size: 44
batch 399, loss: 0.0445, instance_loss: 0.2148, weighted_loss: 0.0956, label: 1, bag_size: 598
batch 419, loss: 0.1396, instance_loss: 0.4630, weighted_loss: 0.2366, label: 3, bag_size: 200
batch 439, loss: 0.3035, instance_loss: 0.5980, weighted_loss: 0.3919, label: 1, bag_size: 435
batch 459, loss: 0.1163, instance_loss: 0.1022, weighted_loss: 0.1121, label: 0, bag_size: 524
batch 479, loss: 0.0428, instance_loss: 0.8090, weighted_loss: 0.2727, label: 4, bag_size: 436
batch 499, loss: 0.0245, instance_loss: 0.4111, weighted_loss: 0.1405, label: 1, bag_size: 442
batch 519, loss: 0.0004, instance_loss: 0.1561, weighted_loss: 0.0471, label: 3, bag_size: 18
batch 539, loss: 0.0027, instance_loss: 0.0458, weighted_loss: 0.0156, label: 4, bag_size: 48


class 0 clustering acc 0.986651376146789: correct 21509/21800
class 1 clustering acc 0.561697247706422: correct 2449/4360
Epoch: 43, train_loss: 0.1570, train_clustering_loss:  0.2511, train_error: 0.0477
class 0: acc 0.9904761904761905, correct 104/105
class 1: acc 0.8846153846153846, correct 92/104
class 2: acc 0.8958333333333334, correct 86/96
class 3: acc 0.983739837398374, correct 121/123
class 4: acc 0.9914529914529915, correct 116/117

Val Set, val_loss: 1.1174, val_error: 0.3600, auc: 0.8580
class 0 clustering acc 0.967: correct 1934/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.7777777777777778, correct 7/9
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0377, weighted_loss: 0.0115, label: 3, bag_size: 75
batch 39, loss: 0.0015, instance_loss: 0.0434, weighted_loss: 0.0140, label: 3, bag_size: 28
batch 59, loss: 0.0001, instance_loss: 0.0789, weighted_loss: 0.0237, label: 3, bag_size: 26
batch 79, loss: 0.0006, instance_loss: 0.0269, weighted_loss: 0.0085, label: 4, bag_size: 79
batch 99, loss: 0.0149, instance_loss: 0.4995, weighted_loss: 0.1603, label: 1, bag_size: 442
batch 119, loss: 0.0062, instance_loss: 0.1220, weighted_loss: 0.0410, label: 3, bag_size: 18
batch 139, loss: 0.1579, instance_loss: 0.4619, weighted_loss: 0.2491, label: 3, bag_size: 343
batch 159, loss: 0.0017, instance_loss: 0.0333, weighted_loss: 0.0112, label: 0, bag_size: 756
batch 179, loss: 0.0004, instance_loss: 0.0279, weighted_loss: 0.0087, label: 0, bag_size: 982
batch 199, loss: 0.1365, instance_loss: 0.1614, weighted_loss: 0.1439, label: 2, bag_size: 1006
batch 219, loss: 0.5786, instance_loss: 0.7183, weighted_loss: 0.6205, label: 4, bag_size: 1337
batch 239, loss: 0.1110, instance_loss: 0.2677, weighted_loss: 0.1580, label: 2, bag_size: 373
batch 259, loss: 0.0007, instance_loss: 0.0636, weighted_loss: 0.0196, label: 3, bag_size: 78
batch 279, loss: 0.0011, instance_loss: 0.0422, weighted_loss: 0.0134, label: 0, bag_size: 246
batch 299, loss: 0.2395, instance_loss: 0.5108, weighted_loss: 0.3209, label: 1, bag_size: 936
batch 319, loss: 0.7961, instance_loss: 0.4845, weighted_loss: 0.7026, label: 0, bag_size: 255
batch 339, loss: 0.2337, instance_loss: 0.8658, weighted_loss: 0.4233, label: 3, bag_size: 607
batch 359, loss: 0.0005, instance_loss: 0.0475, weighted_loss: 0.0146, label: 3, bag_size: 123
batch 379, loss: 0.1685, instance_loss: 0.1916, weighted_loss: 0.1755, label: 1, bag_size: 944
batch 399, loss: 0.0818, instance_loss: 0.7282, weighted_loss: 0.2757, label: 4, bag_size: 1337
batch 419, loss: 0.0000, instance_loss: 0.0065, weighted_loss: 0.0019, label: 4, bag_size: 185
batch 439, loss: 0.0033, instance_loss: 0.2449, weighted_loss: 0.0758, label: 3, bag_size: 18
batch 459, loss: 0.0024, instance_loss: 0.0572, weighted_loss: 0.0188, label: 1, bag_size: 834
batch 479, loss: 1.2100, instance_loss: 0.5188, weighted_loss: 1.0027, label: 2, bag_size: 265
batch 499, loss: 0.1294, instance_loss: 0.3288, weighted_loss: 0.1892, label: 3, bag_size: 343
batch 519, loss: 0.2307, instance_loss: 0.2708, weighted_loss: 0.2428, label: 3, bag_size: 697
batch 539, loss: 0.0009, instance_loss: 0.0693, weighted_loss: 0.0214, label: 1, bag_size: 1127


class 0 clustering acc 0.9855045871559633: correct 21484/21800
class 1 clustering acc 0.5928899082568807: correct 2585/4360
Epoch: 44, train_loss: 0.1726, train_clustering_loss:  0.2383, train_error: 0.0569
class 0: acc 0.9661016949152542, correct 114/118
class 1: acc 0.8545454545454545, correct 94/110
class 2: acc 0.9272727272727272, correct 102/110
class 3: acc 0.9918032786885246, correct 121/122
class 4: acc 0.9764705882352941, correct 83/85

Val Set, val_loss: 1.1629, val_error: 0.3400, auc: 0.8711
class 0 clustering acc 0.966: correct 1932/2000
class 1 clustering acc 0.37: correct 148/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.4444444444444444, correct 4/9
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0420, instance_loss: 0.1348, weighted_loss: 0.0698, label: 2, bag_size: 317
batch 39, loss: 0.0046, instance_loss: 0.3138, weighted_loss: 0.0974, label: 4, bag_size: 790
batch 59, loss: 0.0774, instance_loss: 0.1677, weighted_loss: 0.1045, label: 2, bag_size: 2703
batch 79, loss: 0.0026, instance_loss: 0.3009, weighted_loss: 0.0921, label: 0, bag_size: 155
batch 99, loss: 0.0375, instance_loss: 0.4569, weighted_loss: 0.1633, label: 1, bag_size: 1014
batch 119, loss: 0.0080, instance_loss: 0.1309, weighted_loss: 0.0449, label: 3, bag_size: 16
batch 139, loss: 0.0993, instance_loss: 0.4003, weighted_loss: 0.1896, label: 4, bag_size: 1002
batch 159, loss: 0.0795, instance_loss: 0.2826, weighted_loss: 0.1404, label: 0, bag_size: 801
batch 179, loss: 0.3655, instance_loss: 0.6146, weighted_loss: 0.4402, label: 1, bag_size: 435
batch 199, loss: 0.1334, instance_loss: 0.4106, weighted_loss: 0.2166, label: 4, bag_size: 817
batch 219, loss: 0.0298, instance_loss: 0.3715, weighted_loss: 0.1323, label: 2, bag_size: 461
batch 239, loss: 0.0092, instance_loss: 0.1049, weighted_loss: 0.0379, label: 1, bag_size: 690
batch 259, loss: 0.0000, instance_loss: 0.1707, weighted_loss: 0.0512, label: 3, bag_size: 18
batch 279, loss: 0.0031, instance_loss: 0.1999, weighted_loss: 0.0622, label: 0, bag_size: 148
batch 299, loss: 0.0035, instance_loss: 0.0948, weighted_loss: 0.0309, label: 3, bag_size: 33
batch 319, loss: 0.0001, instance_loss: 0.0974, weighted_loss: 0.0293, label: 3, bag_size: 50
batch 339, loss: 0.0019, instance_loss: 0.1518, weighted_loss: 0.0469, label: 4, bag_size: 1235
batch 359, loss: 0.0085, instance_loss: 0.0924, weighted_loss: 0.0337, label: 0, bag_size: 607
batch 379, loss: 0.1315, instance_loss: 0.7017, weighted_loss: 0.3026, label: 4, bag_size: 663
batch 399, loss: 0.0137, instance_loss: 0.1657, weighted_loss: 0.0593, label: 0, bag_size: 1086
batch 419, loss: 0.0002, instance_loss: 0.0506, weighted_loss: 0.0153, label: 4, bag_size: 137
batch 439, loss: 1.3438, instance_loss: 0.5926, weighted_loss: 1.1184, label: 1, bag_size: 1197
batch 459, loss: 0.1579, instance_loss: 0.5192, weighted_loss: 0.2663, label: 3, bag_size: 200
batch 479, loss: 0.0018, instance_loss: 0.1873, weighted_loss: 0.0575, label: 0, bag_size: 110
batch 499, loss: 0.0050, instance_loss: 0.1651, weighted_loss: 0.0530, label: 0, bag_size: 1101
batch 519, loss: 0.0341, instance_loss: 0.4766, weighted_loss: 0.1668, label: 1, bag_size: 648
batch 539, loss: 0.0219, instance_loss: 0.0700, weighted_loss: 0.0363, label: 4, bag_size: 94


class 0 clustering acc 0.9860091743119266: correct 21495/21800
class 1 clustering acc 0.5692660550458716: correct 2482/4360
Epoch: 45, train_loss: 0.1307, train_clustering_loss:  0.2527, train_error: 0.0422
class 0: acc 0.9895833333333334, correct 95/96
class 1: acc 0.8938053097345132, correct 101/113
class 2: acc 0.9166666666666666, correct 77/84
class 3: acc 0.9849624060150376, correct 131/133
class 4: acc 0.9915966386554622, correct 118/119

Val Set, val_loss: 1.2576, val_error: 0.3600, auc: 0.8671
class 0 clustering acc 0.9655: correct 1931/2000
class 1 clustering acc 0.3075: correct 123/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0151, instance_loss: 0.1705, weighted_loss: 0.0617, label: 0, bag_size: 921
batch 39, loss: 0.0201, instance_loss: 0.0901, weighted_loss: 0.0411, label: 0, bag_size: 607
batch 59, loss: 0.0042, instance_loss: 0.5359, weighted_loss: 0.1637, label: 0, bag_size: 437
batch 79, loss: 0.0004, instance_loss: 0.0642, weighted_loss: 0.0195, label: 4, bag_size: 162
batch 99, loss: 0.0031, instance_loss: 0.3347, weighted_loss: 0.1026, label: 3, bag_size: 17
batch 119, loss: 2.2399, instance_loss: 0.8822, weighted_loss: 1.8326, label: 1, bag_size: 1799
batch 139, loss: 0.0032, instance_loss: 0.2808, weighted_loss: 0.0865, label: 4, bag_size: 656
batch 159, loss: 0.0234, instance_loss: 0.1093, weighted_loss: 0.0492, label: 2, bag_size: 1289
batch 179, loss: 0.0110, instance_loss: 0.4310, weighted_loss: 0.1370, label: 1, bag_size: 648
batch 199, loss: 0.0001, instance_loss: 0.0781, weighted_loss: 0.0235, label: 3, bag_size: 50
batch 219, loss: 0.0011, instance_loss: 0.0333, weighted_loss: 0.0108, label: 3, bag_size: 63
batch 239, loss: 0.0206, instance_loss: 0.0869, weighted_loss: 0.0405, label: 0, bag_size: 410
batch 259, loss: 0.0057, instance_loss: 0.3557, weighted_loss: 0.1107, label: 4, bag_size: 1278
batch 279, loss: 0.0234, instance_loss: 0.2101, weighted_loss: 0.0794, label: 2, bag_size: 1218
batch 299, loss: 0.0576, instance_loss: 0.4573, weighted_loss: 0.1775, label: 0, bag_size: 114
batch 319, loss: 0.1680, instance_loss: 0.4943, weighted_loss: 0.2659, label: 4, bag_size: 928
batch 339, loss: 0.2968, instance_loss: 0.2666, weighted_loss: 0.2878, label: 2, bag_size: 265
batch 359, loss: 0.0158, instance_loss: 0.1238, weighted_loss: 0.0482, label: 3, bag_size: 18
batch 379, loss: 0.2323, instance_loss: 0.3033, weighted_loss: 0.2536, label: 0, bag_size: 128
batch 399, loss: 0.2351, instance_loss: 0.7818, weighted_loss: 0.3991, label: 1, bag_size: 660
batch 419, loss: 0.0103, instance_loss: 0.4417, weighted_loss: 0.1397, label: 3, bag_size: 1253
batch 439, loss: 0.0060, instance_loss: 0.1888, weighted_loss: 0.0608, label: 0, bag_size: 155
batch 459, loss: 0.0229, instance_loss: 0.1333, weighted_loss: 0.0560, label: 1, bag_size: 903
batch 479, loss: 0.0459, instance_loss: 0.3067, weighted_loss: 0.1241, label: 0, bag_size: 1196
batch 499, loss: 0.0008, instance_loss: 0.0709, weighted_loss: 0.0219, label: 4, bag_size: 157
batch 519, loss: 0.6270, instance_loss: 0.4550, weighted_loss: 0.5754, label: 2, bag_size: 471
batch 539, loss: 0.0049, instance_loss: 0.2582, weighted_loss: 0.0809, label: 0, bag_size: 117


class 0 clustering acc 0.9853669724770642: correct 21481/21800
class 1 clustering acc 0.5431192660550459: correct 2368/4360
Epoch: 46, train_loss: 0.1266, train_clustering_loss:  0.2617, train_error: 0.0385
class 0: acc 0.9908256880733946, correct 108/109
class 1: acc 0.8807339449541285, correct 96/109
class 2: acc 0.9469026548672567, correct 107/113
class 3: acc 0.9900990099009901, correct 100/101
class 4: acc 1.0, correct 113/113

Val Set, val_loss: 1.2299, val_error: 0.3200, auc: 0.8634
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.3225: correct 129/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0019, instance_loss: 0.5124, weighted_loss: 0.1551, label: 4, bag_size: 711
batch 39, loss: 0.0553, instance_loss: 0.1299, weighted_loss: 0.0777, label: 2, bag_size: 907
batch 59, loss: 0.0148, instance_loss: 0.0346, weighted_loss: 0.0207, label: 1, bag_size: 937
batch 79, loss: 0.0213, instance_loss: 0.2120, weighted_loss: 0.0785, label: 1, bag_size: 530
batch 99, loss: 0.3087, instance_loss: 0.4488, weighted_loss: 0.3507, label: 2, bag_size: 916
batch 119, loss: 0.1770, instance_loss: 0.2823, weighted_loss: 0.2086, label: 4, bag_size: 1357
batch 139, loss: 0.0035, instance_loss: 0.1341, weighted_loss: 0.0427, label: 0, bag_size: 350
batch 159, loss: 0.0706, instance_loss: 0.1381, weighted_loss: 0.0908, label: 0, bag_size: 375
batch 179, loss: 0.1124, instance_loss: 0.1890, weighted_loss: 0.1354, label: 2, bag_size: 264
batch 199, loss: 0.0498, instance_loss: 0.3032, weighted_loss: 0.1258, label: 2, bag_size: 1259
batch 219, loss: 0.0592, instance_loss: 0.1555, weighted_loss: 0.0881, label: 2, bag_size: 1058
batch 239, loss: 0.2370, instance_loss: 0.5716, weighted_loss: 0.3373, label: 1, bag_size: 747
batch 259, loss: 0.0012, instance_loss: 0.1081, weighted_loss: 0.0333, label: 4, bag_size: 140
batch 279, loss: 0.0380, instance_loss: 0.3154, weighted_loss: 0.1212, label: 0, bag_size: 350
batch 299, loss: 0.0004, instance_loss: 0.0215, weighted_loss: 0.0067, label: 3, bag_size: 56
batch 319, loss: 0.0055, instance_loss: 0.1094, weighted_loss: 0.0367, label: 1, bag_size: 1277
batch 339, loss: 0.1489, instance_loss: 0.6890, weighted_loss: 0.3109, label: 1, bag_size: 102
batch 359, loss: 0.0341, instance_loss: 0.1676, weighted_loss: 0.0742, label: 2, bag_size: 400
batch 379, loss: 0.2947, instance_loss: 0.2990, weighted_loss: 0.2960, label: 2, bag_size: 1052
batch 399, loss: 0.0662, instance_loss: 0.1588, weighted_loss: 0.0939, label: 2, bag_size: 404
batch 419, loss: 0.0011, instance_loss: 0.0191, weighted_loss: 0.0065, label: 3, bag_size: 46
batch 439, loss: 0.0671, instance_loss: 0.1963, weighted_loss: 0.1059, label: 2, bag_size: 400
batch 459, loss: 0.0010, instance_loss: 0.0309, weighted_loss: 0.0099, label: 4, bag_size: 790
batch 479, loss: 0.0520, instance_loss: 0.4212, weighted_loss: 0.1628, label: 3, bag_size: 791
batch 499, loss: 0.1180, instance_loss: 0.3124, weighted_loss: 0.1763, label: 2, bag_size: 839
batch 519, loss: 1.6412, instance_loss: 0.6050, weighted_loss: 1.3303, label: 1, bag_size: 657
batch 539, loss: 0.0085, instance_loss: 0.0690, weighted_loss: 0.0266, label: 1, bag_size: 994


class 0 clustering acc 0.9859174311926605: correct 21493/21800
class 1 clustering acc 0.5591743119266055: correct 2438/4360
Epoch: 47, train_loss: 0.1299, train_clustering_loss:  0.2545, train_error: 0.0440
class 0: acc 0.990909090909091, correct 109/110
class 1: acc 0.8611111111111112, correct 93/108
class 2: acc 0.9285714285714286, correct 104/112
class 3: acc 1.0, correct 106/106
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 1.2253, val_error: 0.3600, auc: 0.8738
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.3325: correct 133/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.2967, instance_loss: 0.3573, weighted_loss: 0.3148, label: 2, bag_size: 967
batch 39, loss: 0.1566, instance_loss: 0.5819, weighted_loss: 0.2842, label: 3, bag_size: 1250
batch 59, loss: 0.0014, instance_loss: 0.0352, weighted_loss: 0.0115, label: 4, bag_size: 128
batch 79, loss: 0.0048, instance_loss: 0.3063, weighted_loss: 0.0953, label: 0, bag_size: 118
batch 99, loss: 0.0409, instance_loss: 0.0884, weighted_loss: 0.0552, label: 1, bag_size: 1325
batch 119, loss: 0.1007, instance_loss: 0.4915, weighted_loss: 0.2179, label: 1, bag_size: 1559
batch 139, loss: 0.0274, instance_loss: 0.2599, weighted_loss: 0.0972, label: 2, bag_size: 1150
batch 159, loss: 0.0015, instance_loss: 0.0605, weighted_loss: 0.0192, label: 4, bag_size: 72
batch 179, loss: 0.4433, instance_loss: 0.5432, weighted_loss: 0.4732, label: 1, bag_size: 700
batch 199, loss: 0.2244, instance_loss: 0.6555, weighted_loss: 0.3537, label: 4, bag_size: 1337
batch 219, loss: 0.0034, instance_loss: 0.0716, weighted_loss: 0.0239, label: 1, bag_size: 320
batch 239, loss: 0.0007, instance_loss: 0.1461, weighted_loss: 0.0443, label: 4, bag_size: 20
batch 259, loss: 0.0000, instance_loss: 0.0803, weighted_loss: 0.0241, label: 3, bag_size: 26
batch 279, loss: 0.0070, instance_loss: 0.1392, weighted_loss: 0.0466, label: 0, bag_size: 1018
batch 299, loss: 0.1291, instance_loss: 0.8539, weighted_loss: 0.3465, label: 3, bag_size: 671
batch 319, loss: 0.0016, instance_loss: 0.2896, weighted_loss: 0.0880, label: 4, bag_size: 1235
batch 339, loss: 0.5340, instance_loss: 0.3160, weighted_loss: 0.4686, label: 2, bag_size: 758
batch 359, loss: 0.0952, instance_loss: 0.5006, weighted_loss: 0.2168, label: 1, bag_size: 487
batch 379, loss: 1.2964, instance_loss: 0.6328, weighted_loss: 1.0973, label: 1, bag_size: 1799
batch 399, loss: 0.0407, instance_loss: 0.3768, weighted_loss: 0.1415, label: 1, bag_size: 868
batch 419, loss: 0.3067, instance_loss: 0.2721, weighted_loss: 0.2963, label: 2, bag_size: 345
batch 439, loss: 0.1371, instance_loss: 0.2816, weighted_loss: 0.1805, label: 2, bag_size: 649
batch 459, loss: 0.9041, instance_loss: 0.6275, weighted_loss: 0.8211, label: 4, bag_size: 511
batch 479, loss: 0.0068, instance_loss: 0.2920, weighted_loss: 0.0923, label: 2, bag_size: 784
batch 499, loss: 0.0449, instance_loss: 0.1274, weighted_loss: 0.0697, label: 2, bag_size: 347
batch 519, loss: 0.0447, instance_loss: 0.1571, weighted_loss: 0.0784, label: 2, bag_size: 391
batch 539, loss: 0.0005, instance_loss: 0.0615, weighted_loss: 0.0188, label: 0, bag_size: 382


class 0 clustering acc 0.9876605504587156: correct 21531/21800
class 1 clustering acc 0.573394495412844: correct 2500/4360
Epoch: 48, train_loss: 0.1114, train_clustering_loss:  0.2476, train_error: 0.0385
class 0: acc 0.9807692307692307, correct 102/104
class 1: acc 0.8938053097345132, correct 101/113
class 2: acc 0.9489795918367347, correct 93/98
class 3: acc 1.0, correct 125/125
class 4: acc 0.9809523809523809, correct 103/105

Val Set, val_loss: 1.2364, val_error: 0.3400, auc: 0.8760
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.3475: correct 139/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.8, correct 8/10
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.6666666666666666, correct 6/9
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0117, instance_loss: 0.0823, weighted_loss: 0.0329, label: 0, bag_size: 1034
batch 39, loss: 0.0012, instance_loss: 0.0192, weighted_loss: 0.0066, label: 4, bag_size: 79
batch 59, loss: 0.0002, instance_loss: 0.0147, weighted_loss: 0.0046, label: 4, bag_size: 192
batch 79, loss: 0.0004, instance_loss: 0.0258, weighted_loss: 0.0080, label: 0, bag_size: 1018
batch 99, loss: 0.0017, instance_loss: 0.0740, weighted_loss: 0.0234, label: 3, bag_size: 105
batch 119, loss: 0.0002, instance_loss: 0.0381, weighted_loss: 0.0116, label: 4, bag_size: 147
batch 139, loss: 0.0463, instance_loss: 0.7497, weighted_loss: 0.2573, label: 3, bag_size: 607
batch 159, loss: 0.0026, instance_loss: 0.0652, weighted_loss: 0.0214, label: 3, bag_size: 123
batch 179, loss: 0.0116, instance_loss: 0.0927, weighted_loss: 0.0359, label: 4, bag_size: 44
batch 199, loss: 0.0047, instance_loss: 0.1474, weighted_loss: 0.0475, label: 3, bag_size: 15
batch 219, loss: 0.0001, instance_loss: 0.0338, weighted_loss: 0.0102, label: 4, bag_size: 162
batch 239, loss: 0.1204, instance_loss: 0.3491, weighted_loss: 0.1890, label: 2, bag_size: 967
batch 259, loss: 0.0275, instance_loss: 0.1537, weighted_loss: 0.0653, label: 1, bag_size: 949
batch 279, loss: 0.0339, instance_loss: 0.1342, weighted_loss: 0.0639, label: 2, bag_size: 270
batch 299, loss: 0.0000, instance_loss: 0.0755, weighted_loss: 0.0227, label: 4, bag_size: 88
batch 319, loss: 0.0119, instance_loss: 0.0808, weighted_loss: 0.0325, label: 1, bag_size: 994
batch 339, loss: 0.0096, instance_loss: 0.5525, weighted_loss: 0.1725, label: 4, bag_size: 436
batch 359, loss: 0.6743, instance_loss: 0.4229, weighted_loss: 0.5989, label: 1, bag_size: 535
batch 379, loss: 0.0364, instance_loss: 0.1248, weighted_loss: 0.0629, label: 0, bag_size: 1133
batch 399, loss: 0.0084, instance_loss: 0.0913, weighted_loss: 0.0332, label: 1, bag_size: 1261
batch 419, loss: 0.0001, instance_loss: 0.1178, weighted_loss: 0.0354, label: 4, bag_size: 19
batch 439, loss: 0.0004, instance_loss: 0.0352, weighted_loss: 0.0108, label: 3, bag_size: 78
batch 459, loss: 0.0009, instance_loss: 0.0635, weighted_loss: 0.0197, label: 3, bag_size: 32
batch 479, loss: 0.0248, instance_loss: 0.2705, weighted_loss: 0.0985, label: 0, bag_size: 350
batch 499, loss: 0.0057, instance_loss: 0.1100, weighted_loss: 0.0370, label: 3, bag_size: 18
batch 519, loss: 0.0519, instance_loss: 0.4015, weighted_loss: 0.1568, label: 0, bag_size: 432
batch 539, loss: 0.1405, instance_loss: 0.6010, weighted_loss: 0.2786, label: 2, bag_size: 518


class 0 clustering acc 0.9857798165137615: correct 21490/21800
class 1 clustering acc 0.5672018348623853: correct 2473/4360
Epoch: 49, train_loss: 0.1624, train_clustering_loss:  0.2530, train_error: 0.0495
class 0: acc 0.946236559139785, correct 88/93
class 1: acc 0.8857142857142857, correct 93/105
class 2: acc 0.9174311926605505, correct 100/109
class 3: acc 0.990990990990991, correct 110/111
class 4: acc 1.0, correct 127/127

Val Set, val_loss: 1.3536, val_error: 0.3800, auc: 0.8586
class 0 clustering acc 0.966: correct 1932/2000
class 1 clustering acc 0.3175: correct 127/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0046, instance_loss: 0.3944, weighted_loss: 0.1215, label: 1, bag_size: 648
batch 39, loss: 3.4291, instance_loss: 0.6838, weighted_loss: 2.6055, label: 2, bag_size: 1231
batch 59, loss: 0.0901, instance_loss: 0.3133, weighted_loss: 0.1571, label: 2, bag_size: 411
batch 79, loss: 0.0009, instance_loss: 0.0601, weighted_loss: 0.0187, label: 3, bag_size: 26
batch 99, loss: 0.0022, instance_loss: 0.1432, weighted_loss: 0.0445, label: 3, bag_size: 20
batch 119, loss: 0.0004, instance_loss: 0.2428, weighted_loss: 0.0731, label: 4, bag_size: 524
batch 139, loss: 0.0603, instance_loss: 0.1503, weighted_loss: 0.0873, label: 0, bag_size: 801
batch 159, loss: 0.0023, instance_loss: 0.0462, weighted_loss: 0.0154, label: 0, bag_size: 521
batch 179, loss: 0.0003, instance_loss: 0.2304, weighted_loss: 0.0693, label: 4, bag_size: 17
batch 199, loss: 0.0079, instance_loss: 0.1366, weighted_loss: 0.0465, label: 1, bag_size: 682
batch 219, loss: 0.0036, instance_loss: 0.0385, weighted_loss: 0.0140, label: 4, bag_size: 160
batch 239, loss: 0.0002, instance_loss: 0.0861, weighted_loss: 0.0260, label: 3, bag_size: 34
batch 259, loss: 0.0809, instance_loss: 0.2504, weighted_loss: 0.1318, label: 2, bag_size: 649
batch 279, loss: 0.0157, instance_loss: 0.1216, weighted_loss: 0.0475, label: 3, bag_size: 451
batch 299, loss: 0.0113, instance_loss: 0.0700, weighted_loss: 0.0289, label: 0, bag_size: 1046
batch 319, loss: 0.0120, instance_loss: 0.1186, weighted_loss: 0.0440, label: 0, bag_size: 1174
batch 339, loss: 0.0319, instance_loss: 0.1799, weighted_loss: 0.0763, label: 2, bag_size: 323
batch 359, loss: 0.0018, instance_loss: 0.0990, weighted_loss: 0.0309, label: 4, bag_size: 114
batch 379, loss: 0.0002, instance_loss: 0.0844, weighted_loss: 0.0254, label: 4, bag_size: 646
batch 399, loss: 0.0591, instance_loss: 0.3378, weighted_loss: 0.1427, label: 0, bag_size: 120
batch 419, loss: 0.0243, instance_loss: 0.5742, weighted_loss: 0.1892, label: 4, bag_size: 542
batch 439, loss: 0.1087, instance_loss: 0.2260, weighted_loss: 0.1439, label: 2, bag_size: 907
batch 459, loss: 0.0012, instance_loss: 0.0867, weighted_loss: 0.0269, label: 4, bag_size: 790
batch 479, loss: 0.0001, instance_loss: 0.0410, weighted_loss: 0.0124, label: 4, bag_size: 185
batch 499, loss: 0.0345, instance_loss: 0.2695, weighted_loss: 0.1050, label: 2, bag_size: 943
batch 519, loss: 0.2150, instance_loss: 0.2295, weighted_loss: 0.2194, label: 2, bag_size: 265
batch 539, loss: 0.0184, instance_loss: 0.1579, weighted_loss: 0.0603, label: 2, bag_size: 684


class 0 clustering acc 0.9871100917431193: correct 21519/21800
class 1 clustering acc 0.5584862385321101: correct 2435/4360
Epoch: 50, train_loss: 0.1174, train_clustering_loss:  0.2474, train_error: 0.0312
class 0: acc 0.990990990990991, correct 110/111
class 1: acc 0.90625, correct 87/96
class 2: acc 0.9565217391304348, correct 110/115
class 3: acc 1.0, correct 107/107
class 4: acc 0.9827586206896551, correct 114/116

Val Set, val_loss: 1.2575, val_error: 0.3600, auc: 0.8616
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.3675: correct 147/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.0244, instance_loss: 0.1338, weighted_loss: 0.0572, label: 0, bag_size: 338
batch 39, loss: 0.0047, instance_loss: 0.2123, weighted_loss: 0.0670, label: 0, bag_size: 176
batch 59, loss: 0.0182, instance_loss: 0.2203, weighted_loss: 0.0788, label: 4, bag_size: 1002
batch 79, loss: 0.0002, instance_loss: 0.0729, weighted_loss: 0.0220, label: 4, bag_size: 40
batch 99, loss: 0.0036, instance_loss: 0.0828, weighted_loss: 0.0273, label: 0, bag_size: 476
batch 119, loss: 0.0134, instance_loss: 0.2133, weighted_loss: 0.0733, label: 0, bag_size: 1332
batch 139, loss: 0.0437, instance_loss: 0.1190, weighted_loss: 0.0663, label: 2, bag_size: 499
batch 159, loss: 0.0006, instance_loss: 0.1584, weighted_loss: 0.0479, label: 3, bag_size: 16
batch 179, loss: 0.0856, instance_loss: 0.5837, weighted_loss: 0.2350, label: 1, bag_size: 487
batch 199, loss: 0.0518, instance_loss: 0.1613, weighted_loss: 0.0846, label: 0, bag_size: 200
batch 219, loss: 0.0018, instance_loss: 0.1746, weighted_loss: 0.0537, label: 4, bag_size: 823
batch 239, loss: 0.0037, instance_loss: 0.3146, weighted_loss: 0.0970, label: 1, bag_size: 890
batch 259, loss: 0.2855, instance_loss: 0.4001, weighted_loss: 0.3199, label: 0, bag_size: 1257
batch 279, loss: 0.9729, instance_loss: 0.4937, weighted_loss: 0.8291, label: 0, bag_size: 255
batch 299, loss: 0.0133, instance_loss: 0.0813, weighted_loss: 0.0337, label: 2, bag_size: 499
batch 319, loss: 3.2262, instance_loss: 0.7504, weighted_loss: 2.4834, label: 1, bag_size: 448
batch 339, loss: 0.2996, instance_loss: 0.5450, weighted_loss: 0.3732, label: 2, bag_size: 1050
batch 359, loss: 0.0029, instance_loss: 0.0408, weighted_loss: 0.0142, label: 0, bag_size: 760
batch 379, loss: 0.0097, instance_loss: 0.0901, weighted_loss: 0.0338, label: 2, bag_size: 262
batch 399, loss: 0.0590, instance_loss: 0.5901, weighted_loss: 0.2183, label: 1, bag_size: 308
batch 419, loss: 0.0191, instance_loss: 0.7145, weighted_loss: 0.2277, label: 4, bag_size: 663
batch 439, loss: 0.0147, instance_loss: 0.0679, weighted_loss: 0.0307, label: 1, bag_size: 369
batch 459, loss: 0.0024, instance_loss: 0.1443, weighted_loss: 0.0450, label: 1, bag_size: 890
batch 479, loss: 0.0002, instance_loss: 0.1014, weighted_loss: 0.0306, label: 3, bag_size: 27
batch 499, loss: 0.0006, instance_loss: 0.0176, weighted_loss: 0.0057, label: 3, bag_size: 55
batch 519, loss: 0.0064, instance_loss: 0.2323, weighted_loss: 0.0742, label: 0, bag_size: 136
batch 539, loss: 0.0177, instance_loss: 0.3751, weighted_loss: 0.1249, label: 0, bag_size: 868


class 0 clustering acc 0.9833944954128441: correct 21438/21800
class 1 clustering acc 0.5740825688073394: correct 2503/4360
Epoch: 51, train_loss: 0.1099, train_clustering_loss:  0.2573, train_error: 0.0275
class 0: acc 1.0, correct 101/101
class 1: acc 0.9174311926605505, correct 100/109
class 2: acc 0.9652173913043478, correct 111/115
class 3: acc 0.9896907216494846, correct 96/97
class 4: acc 0.991869918699187, correct 122/123

Val Set, val_loss: 1.1730, val_error: 0.3000, auc: 0.8691
class 0 clustering acc 0.9665: correct 1933/2000
class 1 clustering acc 0.375: correct 150/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.0, correct 0/3
class 4: acc 0.5555555555555556, correct 5/9
EarlyStopping counter: 41 out of 20
Early stopping
Val error: 0.4400, ROC AUC: 0.8880
Test error: 0.3000, ROC AUC: 0.9169
class 0: acc 0.9, correct 9/10
class 1: acc 0.75, correct 9/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.3333333333333333, correct 2/6
class 4: acc 0.75, correct 3/4

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.5041, instance_loss: 1.2204, weighted_loss: 1.4189, label: 0, bag_size: 1046
batch 39, loss: 1.6437, instance_loss: 0.9942, weighted_loss: 1.4489, label: 4, bag_size: 78
batch 59, loss: 1.3087, instance_loss: 0.8062, weighted_loss: 1.1580, label: 3, bag_size: 46
batch 79, loss: 1.5077, instance_loss: 0.7075, weighted_loss: 1.2676, label: 2, bag_size: 237
batch 99, loss: 1.4851, instance_loss: 0.6321, weighted_loss: 1.2292, label: 2, bag_size: 307
batch 119, loss: 1.7026, instance_loss: 0.5554, weighted_loss: 1.3584, label: 4, bag_size: 78
batch 139, loss: 1.5837, instance_loss: 0.5438, weighted_loss: 1.2717, label: 2, bag_size: 932
batch 159, loss: 1.3991, instance_loss: 0.5294, weighted_loss: 1.1382, label: 4, bag_size: 79
batch 179, loss: 1.9423, instance_loss: 0.5515, weighted_loss: 1.5251, label: 0, bag_size: 129
batch 199, loss: 1.4889, instance_loss: 0.5330, weighted_loss: 1.2021, label: 2, bag_size: 1164
batch 219, loss: 2.3651, instance_loss: 0.5618, weighted_loss: 1.8241, label: 4, bag_size: 928
batch 239, loss: 1.5839, instance_loss: 0.5451, weighted_loss: 1.2723, label: 0, bag_size: 524
batch 259, loss: 1.4670, instance_loss: 0.5300, weighted_loss: 1.1859, label: 1, bag_size: 944
batch 279, loss: 2.0699, instance_loss: 0.5576, weighted_loss: 1.6162, label: 0, bag_size: 148
batch 299, loss: 1.5520, instance_loss: 0.5125, weighted_loss: 1.2402, label: 2, bag_size: 649
batch 319, loss: 1.4591, instance_loss: 0.5162, weighted_loss: 1.1762, label: 2, bag_size: 237
batch 339, loss: 1.4808, instance_loss: 0.5384, weighted_loss: 1.1981, label: 2, bag_size: 373
batch 359, loss: 1.5556, instance_loss: 0.5297, weighted_loss: 1.2478, label: 2, bag_size: 959
batch 379, loss: 1.4637, instance_loss: 0.5271, weighted_loss: 1.1827, label: 0, bag_size: 718
batch 399, loss: 1.5254, instance_loss: 0.5302, weighted_loss: 1.2268, label: 0, bag_size: 476
batch 419, loss: 1.7479, instance_loss: 0.5540, weighted_loss: 1.3897, label: 0, bag_size: 521
batch 439, loss: 1.6467, instance_loss: 0.5725, weighted_loss: 1.3244, label: 1, bag_size: 470
batch 459, loss: 2.0149, instance_loss: 0.5018, weighted_loss: 1.5610, label: 4, bag_size: 711
batch 479, loss: 0.3940, instance_loss: 0.3275, weighted_loss: 0.3741, label: 4, bag_size: 178
batch 499, loss: 2.5612, instance_loss: 0.5682, weighted_loss: 1.9633, label: 4, bag_size: 882
batch 519, loss: 0.3958, instance_loss: 0.3601, weighted_loss: 0.3851, label: 4, bag_size: 23
batch 539, loss: 1.2318, instance_loss: 0.4826, weighted_loss: 1.0070, label: 2, bag_size: 636


class 0 clustering acc 0.9935321100917431: correct 21659/21800
class 1 clustering acc 0.00871559633027523: correct 38/4360
Epoch: 0, train_loss: 1.4312, train_clustering_loss:  0.5859, train_error: 0.6037
class 0: acc 0.2268041237113402, correct 22/97
class 1: acc 0.42727272727272725, correct 47/110
class 2: acc 0.3620689655172414, correct 42/116
class 3: acc 0.3684210526315789, correct 42/114
class 4: acc 0.5833333333333334, correct 63/108

Val Set, val_loss: 1.4739, val_error: 0.4800, auc: 0.7589
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.0, correct 0/5
Validation loss decreased (inf --> 1.473933).  Saving model ...


batch 19, loss: 1.5231, instance_loss: 0.5008, weighted_loss: 1.2164, label: 3, bag_size: 360
batch 39, loss: 1.0237, instance_loss: 0.4832, weighted_loss: 0.8616, label: 2, bag_size: 626
batch 59, loss: 1.2412, instance_loss: 0.4896, weighted_loss: 1.0157, label: 2, bag_size: 809
batch 79, loss: 0.7945, instance_loss: 0.4549, weighted_loss: 0.6926, label: 3, bag_size: 18
batch 99, loss: 1.1590, instance_loss: 0.4721, weighted_loss: 0.9529, label: 1, bag_size: 1239
batch 119, loss: 1.2682, instance_loss: 0.4566, weighted_loss: 1.0247, label: 2, bag_size: 471
batch 139, loss: 1.3509, instance_loss: 0.5222, weighted_loss: 1.1023, label: 1, bag_size: 886
batch 159, loss: 1.1775, instance_loss: 0.4952, weighted_loss: 0.9728, label: 0, bag_size: 736
batch 179, loss: 1.2574, instance_loss: 0.5632, weighted_loss: 1.0491, label: 3, bag_size: 53
batch 199, loss: 0.7327, instance_loss: 0.4469, weighted_loss: 0.6470, label: 3, bag_size: 20
batch 219, loss: 1.6355, instance_loss: 0.5269, weighted_loss: 1.3029, label: 0, bag_size: 423
batch 239, loss: 2.3517, instance_loss: 0.7052, weighted_loss: 1.8578, label: 0, bag_size: 128
batch 259, loss: 1.2812, instance_loss: 0.4209, weighted_loss: 1.0231, label: 3, bag_size: 936
batch 279, loss: 1.2474, instance_loss: 0.4962, weighted_loss: 1.0220, label: 1, bag_size: 1172
batch 299, loss: 1.3445, instance_loss: 0.4808, weighted_loss: 1.0854, label: 2, bag_size: 409
batch 319, loss: 1.2133, instance_loss: 0.4716, weighted_loss: 0.9908, label: 2, bag_size: 784
batch 339, loss: 2.9043, instance_loss: 0.6230, weighted_loss: 2.2199, label: 3, bag_size: 630
batch 359, loss: 1.4558, instance_loss: 0.4754, weighted_loss: 1.1617, label: 1, bag_size: 448
batch 379, loss: 2.4845, instance_loss: 0.8339, weighted_loss: 1.9893, label: 0, bag_size: 116
batch 399, loss: 1.1132, instance_loss: 0.4355, weighted_loss: 0.9099, label: 1, bag_size: 847
batch 419, loss: 0.2362, instance_loss: 0.1389, weighted_loss: 0.2070, label: 4, bag_size: 86
batch 439, loss: 1.6202, instance_loss: 0.5421, weighted_loss: 1.2967, label: 2, bag_size: 3236
batch 459, loss: 0.8356, instance_loss: 0.4439, weighted_loss: 0.7181, label: 1, bag_size: 938
batch 479, loss: 1.9155, instance_loss: 0.5292, weighted_loss: 1.4996, label: 2, bag_size: 911
batch 499, loss: 1.2377, instance_loss: 0.4793, weighted_loss: 1.0102, label: 2, bag_size: 1289
batch 519, loss: 1.2692, instance_loss: 0.4816, weighted_loss: 1.0329, label: 0, bag_size: 382
batch 539, loss: 0.9677, instance_loss: 0.4003, weighted_loss: 0.7975, label: 1, bag_size: 867


class 0 clustering acc 0.9979816513761468: correct 21756/21800
class 1 clustering acc 0.06811926605504587: correct 297/4360
Epoch: 1, train_loss: 1.1806, train_clustering_loss:  0.4521, train_error: 0.4716
class 0: acc 0.1485148514851485, correct 15/101
class 1: acc 0.5217391304347826, correct 60/115
class 2: acc 0.4818181818181818, correct 53/110
class 3: acc 0.7047619047619048, correct 74/105
class 4: acc 0.7543859649122807, correct 86/114

Val Set, val_loss: 1.3322, val_error: 0.6600, auc: 0.8460
class 0 clustering acc 0.998: correct 1996/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.16666666666666666, correct 2/12
class 1: acc 1.0, correct 9/9
class 2: acc 0.05555555555555555, correct 1/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.0, correct 0/5
Validation loss decreased (1.473933 --> 1.332181).  Saving model ...


batch 19, loss: 2.4216, instance_loss: 0.6975, weighted_loss: 1.9044, label: 4, bag_size: 1357
batch 39, loss: 1.6172, instance_loss: 0.5330, weighted_loss: 1.2920, label: 2, bag_size: 324
batch 59, loss: 0.9590, instance_loss: 0.3778, weighted_loss: 0.7846, label: 1, bag_size: 867
batch 79, loss: 0.3556, instance_loss: 0.3578, weighted_loss: 0.3563, label: 3, bag_size: 21
batch 99, loss: 2.5864, instance_loss: 0.6916, weighted_loss: 2.0180, label: 4, bag_size: 754
batch 119, loss: 1.4027, instance_loss: 0.4852, weighted_loss: 1.1274, label: 2, bag_size: 537
batch 139, loss: 1.4959, instance_loss: 0.5290, weighted_loss: 1.2058, label: 0, bag_size: 976
batch 159, loss: 2.4533, instance_loss: 0.6451, weighted_loss: 1.9108, label: 3, bag_size: 200
batch 179, loss: 0.8578, instance_loss: 0.4510, weighted_loss: 0.7358, label: 0, bag_size: 521
batch 199, loss: 1.1217, instance_loss: 0.4947, weighted_loss: 0.9336, label: 0, bag_size: 898
batch 219, loss: 0.4323, instance_loss: 0.2378, weighted_loss: 0.3739, label: 4, bag_size: 119
batch 239, loss: 0.6026, instance_loss: 0.3089, weighted_loss: 0.5145, label: 4, bag_size: 23
batch 259, loss: 1.3178, instance_loss: 0.4842, weighted_loss: 1.0677, label: 2, bag_size: 1439
batch 279, loss: 0.3120, instance_loss: 0.2732, weighted_loss: 0.3004, label: 1, bag_size: 847
batch 299, loss: 1.5804, instance_loss: 0.5279, weighted_loss: 1.2646, label: 0, bag_size: 338
batch 319, loss: 2.9771, instance_loss: 0.7361, weighted_loss: 2.3048, label: 3, bag_size: 343
batch 339, loss: 0.8058, instance_loss: 0.4120, weighted_loss: 0.6876, label: 0, bag_size: 731
batch 359, loss: 1.0696, instance_loss: 0.4279, weighted_loss: 0.8771, label: 0, bag_size: 200
batch 379, loss: 2.6054, instance_loss: 0.6944, weighted_loss: 2.0321, label: 4, bag_size: 436
batch 399, loss: 1.0154, instance_loss: 0.4504, weighted_loss: 0.8459, label: 0, bag_size: 933
batch 419, loss: 0.2585, instance_loss: 0.1957, weighted_loss: 0.2397, label: 4, bag_size: 112
batch 439, loss: 1.9168, instance_loss: 0.6513, weighted_loss: 1.5372, label: 3, bag_size: 791
batch 459, loss: 1.3020, instance_loss: 0.4309, weighted_loss: 1.0407, label: 1, bag_size: 1049
batch 479, loss: 0.8539, instance_loss: 0.4162, weighted_loss: 0.7226, label: 2, bag_size: 480
batch 499, loss: 2.0684, instance_loss: 0.7844, weighted_loss: 1.6832, label: 0, bag_size: 129
batch 519, loss: 1.0707, instance_loss: 0.4615, weighted_loss: 0.8879, label: 0, bag_size: 653
batch 539, loss: 0.8251, instance_loss: 0.4346, weighted_loss: 0.7080, label: 0, bag_size: 524


class 0 clustering acc 0.9955963302752293: correct 21704/21800
class 1 clustering acc 0.11284403669724771: correct 492/4360
Epoch: 2, train_loss: 1.0453, train_clustering_loss:  0.4219, train_error: 0.3817
class 0: acc 0.5897435897435898, correct 69/117
class 1: acc 0.6956521739130435, correct 80/115
class 2: acc 0.37735849056603776, correct 40/106
class 3: acc 0.7623762376237624, correct 77/101
class 4: acc 0.6698113207547169, correct 71/106

Val Set, val_loss: 1.0881, val_error: 0.3000, auc: 0.8939
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.015: correct 6/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
Validation loss decreased (1.332181 --> 1.088147).  Saving model ...


batch 19, loss: 1.2319, instance_loss: 0.4408, weighted_loss: 0.9946, label: 2, bag_size: 687
batch 39, loss: 1.3728, instance_loss: 0.4290, weighted_loss: 1.0897, label: 1, bag_size: 657
batch 59, loss: 1.5428, instance_loss: 0.5317, weighted_loss: 1.2395, label: 0, bag_size: 736
batch 79, loss: 1.8581, instance_loss: 0.5249, weighted_loss: 1.4581, label: 1, bag_size: 1172
batch 99, loss: 1.1143, instance_loss: 0.4736, weighted_loss: 0.9221, label: 2, bag_size: 861
batch 119, loss: 2.4679, instance_loss: 0.6676, weighted_loss: 1.9278, label: 4, bag_size: 663
batch 139, loss: 0.9424, instance_loss: 0.4947, weighted_loss: 0.8081, label: 0, bag_size: 898
batch 159, loss: 1.0647, instance_loss: 0.5166, weighted_loss: 0.9002, label: 4, bag_size: 764
batch 179, loss: 1.0771, instance_loss: 0.3695, weighted_loss: 0.8648, label: 1, bag_size: 959
batch 199, loss: 0.0993, instance_loss: 0.1776, weighted_loss: 0.1228, label: 3, bag_size: 28
batch 219, loss: 1.9255, instance_loss: 0.5990, weighted_loss: 1.5276, label: 4, bag_size: 754
batch 239, loss: 2.0973, instance_loss: 0.6210, weighted_loss: 1.6544, label: 4, bag_size: 754
batch 259, loss: 1.9267, instance_loss: 0.6032, weighted_loss: 1.5296, label: 0, bag_size: 1527
batch 279, loss: 0.6240, instance_loss: 0.3541, weighted_loss: 0.5431, label: 0, bag_size: 476
batch 299, loss: 0.9100, instance_loss: 0.4152, weighted_loss: 0.7616, label: 2, bag_size: 1148
batch 319, loss: 1.5796, instance_loss: 0.4770, weighted_loss: 1.2488, label: 1, bag_size: 448
batch 339, loss: 2.3480, instance_loss: 0.6942, weighted_loss: 1.8518, label: 4, bag_size: 974
batch 359, loss: 0.3784, instance_loss: 0.3019, weighted_loss: 0.3554, label: 4, bag_size: 19
batch 379, loss: 0.6758, instance_loss: 0.3788, weighted_loss: 0.5867, label: 0, bag_size: 375
batch 399, loss: 0.8677, instance_loss: 0.3969, weighted_loss: 0.7265, label: 2, bag_size: 469
batch 419, loss: 1.2681, instance_loss: 0.4808, weighted_loss: 1.0319, label: 0, bag_size: 350
batch 439, loss: 0.5260, instance_loss: 0.2945, weighted_loss: 0.4565, label: 1, bag_size: 1402
batch 459, loss: 0.8843, instance_loss: 0.3888, weighted_loss: 0.7356, label: 2, bag_size: 1039
batch 479, loss: 1.5301, instance_loss: 0.4115, weighted_loss: 1.1945, label: 1, bag_size: 1273
batch 499, loss: 0.1997, instance_loss: 0.1097, weighted_loss: 0.1727, label: 4, bag_size: 160
batch 519, loss: 0.7396, instance_loss: 0.3325, weighted_loss: 0.6175, label: 1, bag_size: 968
batch 539, loss: 1.9071, instance_loss: 0.5450, weighted_loss: 1.4984, label: 0, bag_size: 1257


class 0 clustering acc 0.9945871559633027: correct 21682/21800
class 1 clustering acc 0.15412844036697249: correct 672/4360
Epoch: 3, train_loss: 0.9583, train_clustering_loss:  0.4038, train_error: 0.3560
class 0: acc 0.628099173553719, correct 76/121
class 1: acc 0.6416666666666667, correct 77/120
class 2: acc 0.6016949152542372, correct 71/118
class 3: acc 0.6704545454545454, correct 59/88
class 4: acc 0.6938775510204082, correct 68/98

Val Set, val_loss: 0.9856, val_error: 0.3200, auc: 0.9262
class 0 clustering acc 0.9975: correct 1995/2000
class 1 clustering acc 0.0825: correct 33/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.0, correct 0/5
Validation loss decreased (1.088147 --> 0.985649).  Saving model ...


batch 19, loss: 0.3628, instance_loss: 0.2260, weighted_loss: 0.3217, label: 1, bag_size: 1127
batch 39, loss: 2.0119, instance_loss: 0.6416, weighted_loss: 1.6008, label: 4, bag_size: 656
batch 59, loss: 0.0076, instance_loss: 0.1114, weighted_loss: 0.0387, label: 3, bag_size: 41
batch 79, loss: 0.9526, instance_loss: 0.3586, weighted_loss: 0.7744, label: 1, bag_size: 968
batch 99, loss: 1.2673, instance_loss: 0.4806, weighted_loss: 1.0313, label: 2, bag_size: 480
batch 119, loss: 0.6490, instance_loss: 0.3177, weighted_loss: 0.5496, label: 1, bag_size: 1080
batch 139, loss: 2.7728, instance_loss: 0.7698, weighted_loss: 2.1719, label: 3, bag_size: 283
batch 159, loss: 0.5897, instance_loss: 0.2842, weighted_loss: 0.4981, label: 1, bag_size: 1080
batch 179, loss: 0.8288, instance_loss: 0.4263, weighted_loss: 0.7081, label: 2, bag_size: 408
batch 199, loss: 0.0732, instance_loss: 0.1638, weighted_loss: 0.1004, label: 3, bag_size: 18
batch 219, loss: 0.0516, instance_loss: 0.1567, weighted_loss: 0.0831, label: 3, bag_size: 16
batch 239, loss: 0.3584, instance_loss: 0.3556, weighted_loss: 0.3575, label: 0, bag_size: 1143
batch 259, loss: 0.0677, instance_loss: 0.0648, weighted_loss: 0.0668, label: 3, bag_size: 1559
batch 279, loss: 0.7659, instance_loss: 0.3855, weighted_loss: 0.6518, label: 4, bag_size: 663
batch 299, loss: 0.4604, instance_loss: 0.4114, weighted_loss: 0.4457, label: 0, bag_size: 1133
batch 319, loss: 0.1901, instance_loss: 0.2424, weighted_loss: 0.2058, label: 4, bag_size: 28
batch 339, loss: 1.8437, instance_loss: 0.5327, weighted_loss: 1.4504, label: 1, bag_size: 487
batch 359, loss: 0.0473, instance_loss: 0.0700, weighted_loss: 0.0541, label: 4, bag_size: 148
batch 379, loss: 0.5464, instance_loss: 0.2888, weighted_loss: 0.4691, label: 1, bag_size: 1402
batch 399, loss: 0.6543, instance_loss: 0.3113, weighted_loss: 0.5514, label: 1, bag_size: 847
batch 419, loss: 3.1413, instance_loss: 0.7425, weighted_loss: 2.4217, label: 3, bag_size: 281
batch 439, loss: 0.8921, instance_loss: 0.4292, weighted_loss: 0.7532, label: 2, bag_size: 469
batch 459, loss: 1.3222, instance_loss: 0.4488, weighted_loss: 1.0602, label: 1, bag_size: 319
batch 479, loss: 0.7606, instance_loss: 0.4015, weighted_loss: 0.6529, label: 2, bag_size: 461
batch 499, loss: 0.0355, instance_loss: 0.1990, weighted_loss: 0.0846, label: 3, bag_size: 18
batch 519, loss: 0.8079, instance_loss: 0.4024, weighted_loss: 0.6862, label: 2, bag_size: 271
batch 539, loss: 0.8275, instance_loss: 0.4366, weighted_loss: 0.7103, label: 0, bag_size: 476


class 0 clustering acc 0.9942660550458715: correct 21675/21800
class 1 clustering acc 0.2481651376146789: correct 1082/4360
Epoch: 4, train_loss: 0.8164, train_clustering_loss:  0.3714, train_error: 0.3119
class 0: acc 0.6, correct 54/90
class 1: acc 0.6551724137931034, correct 76/116
class 2: acc 0.6111111111111112, correct 66/108
class 3: acc 0.8392857142857143, correct 94/112
class 4: acc 0.7142857142857143, correct 85/119

Val Set, val_loss: 0.8258, val_error: 0.3000, auc: 0.9333
class 0 clustering acc 0.997: correct 1994/2000
class 1 clustering acc 0.0925: correct 37/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.2, correct 1/5
Validation loss decreased (0.985649 --> 0.825809).  Saving model ...


batch 19, loss: 0.4760, instance_loss: 0.3244, weighted_loss: 0.4305, label: 0, bag_size: 1517
batch 39, loss: 0.2919, instance_loss: 0.1905, weighted_loss: 0.2615, label: 1, bag_size: 1191
batch 59, loss: 0.5347, instance_loss: 0.4417, weighted_loss: 0.5068, label: 1, bag_size: 867
batch 79, loss: 0.6468, instance_loss: 0.3736, weighted_loss: 0.5648, label: 2, bag_size: 419
batch 99, loss: 1.4203, instance_loss: 0.4573, weighted_loss: 1.1314, label: 3, bag_size: 936
batch 119, loss: 0.0081, instance_loss: 0.0806, weighted_loss: 0.0299, label: 3, bag_size: 24
batch 139, loss: 1.4170, instance_loss: 0.4740, weighted_loss: 1.1341, label: 1, bag_size: 470
batch 159, loss: 0.5388, instance_loss: 0.2856, weighted_loss: 0.4629, label: 1, bag_size: 1127
batch 179, loss: 0.7958, instance_loss: 0.3985, weighted_loss: 0.6766, label: 1, bag_size: 442
batch 199, loss: 1.8438, instance_loss: 0.6375, weighted_loss: 1.4819, label: 2, bag_size: 1043
batch 219, loss: 0.0894, instance_loss: 0.2083, weighted_loss: 0.1251, label: 3, bag_size: 18
batch 239, loss: 0.1074, instance_loss: 0.1944, weighted_loss: 0.1335, label: 3, bag_size: 18
batch 259, loss: 0.7355, instance_loss: 0.4158, weighted_loss: 0.6396, label: 2, bag_size: 932
batch 279, loss: 1.4642, instance_loss: 0.5088, weighted_loss: 1.1776, label: 2, bag_size: 194
batch 299, loss: 0.0869, instance_loss: 0.1652, weighted_loss: 0.1104, label: 4, bag_size: 20
batch 319, loss: 0.3391, instance_loss: 0.4395, weighted_loss: 0.3692, label: 0, bag_size: 976
batch 339, loss: 0.4576, instance_loss: 0.2710, weighted_loss: 0.4017, label: 1, bag_size: 994
batch 359, loss: 1.4418, instance_loss: 0.5093, weighted_loss: 1.1620, label: 4, bag_size: 542
batch 379, loss: 1.0374, instance_loss: 0.6224, weighted_loss: 0.9129, label: 0, bag_size: 116
batch 399, loss: 0.9381, instance_loss: 0.4082, weighted_loss: 0.7791, label: 2, bag_size: 869
batch 419, loss: 2.6127, instance_loss: 0.6516, weighted_loss: 2.0244, label: 4, bag_size: 511
batch 439, loss: 1.7604, instance_loss: 0.6504, weighted_loss: 1.4274, label: 1, bag_size: 867
batch 459, loss: 0.4402, instance_loss: 0.3416, weighted_loss: 0.4106, label: 0, bag_size: 630
batch 479, loss: 1.1702, instance_loss: 0.4752, weighted_loss: 0.9617, label: 0, bag_size: 413
batch 499, loss: 1.2503, instance_loss: 0.5403, weighted_loss: 1.0373, label: 2, bag_size: 943
batch 519, loss: 0.6404, instance_loss: 0.6563, weighted_loss: 0.6452, label: 0, bag_size: 109
batch 539, loss: 1.3728, instance_loss: 0.5411, weighted_loss: 1.1233, label: 4, bag_size: 524


class 0 clustering acc 0.9947706422018349: correct 21686/21800
class 1 clustering acc 0.2378440366972477: correct 1037/4360
Epoch: 5, train_loss: 0.7865, train_clustering_loss:  0.3681, train_error: 0.2954
class 0: acc 0.696078431372549, correct 71/102
class 1: acc 0.5740740740740741, correct 62/108
class 2: acc 0.680672268907563, correct 81/119
class 3: acc 0.811965811965812, correct 95/117
class 4: acc 0.7575757575757576, correct 75/99

Val Set, val_loss: 0.8177, val_error: 0.3000, auc: 0.9334
class 0 clustering acc 0.9925: correct 1985/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.6, correct 3/5
Validation loss decreased (0.825809 --> 0.817733).  Saving model ...


batch 19, loss: 0.5383, instance_loss: 0.3959, weighted_loss: 0.4956, label: 2, bag_size: 750
batch 39, loss: 1.2364, instance_loss: 0.5140, weighted_loss: 1.0197, label: 1, bag_size: 1409
batch 59, loss: 0.0254, instance_loss: 0.1174, weighted_loss: 0.0530, label: 3, bag_size: 27
batch 79, loss: 0.8291, instance_loss: 0.4714, weighted_loss: 0.7217, label: 2, bag_size: 649
batch 99, loss: 0.8102, instance_loss: 0.4671, weighted_loss: 0.7073, label: 2, bag_size: 571
batch 119, loss: 0.1175, instance_loss: 0.1979, weighted_loss: 0.1416, label: 3, bag_size: 28
batch 139, loss: 2.0757, instance_loss: 0.6211, weighted_loss: 1.6393, label: 2, bag_size: 319
batch 159, loss: 1.5704, instance_loss: 0.5189, weighted_loss: 1.2549, label: 1, bag_size: 770
batch 179, loss: 0.6446, instance_loss: 0.3603, weighted_loss: 0.5593, label: 2, bag_size: 474
batch 199, loss: 1.2996, instance_loss: 0.4953, weighted_loss: 1.0583, label: 2, bag_size: 916
batch 219, loss: 0.7021, instance_loss: 0.3228, weighted_loss: 0.5883, label: 1, bag_size: 1144
batch 239, loss: 0.7321, instance_loss: 0.3590, weighted_loss: 0.6202, label: 1, bag_size: 343
batch 259, loss: 2.9082, instance_loss: 0.6421, weighted_loss: 2.2284, label: 3, bag_size: 1118
batch 279, loss: 1.1955, instance_loss: 0.5000, weighted_loss: 0.9869, label: 2, bag_size: 766
batch 299, loss: 0.4384, instance_loss: 0.2992, weighted_loss: 0.3966, label: 2, bag_size: 508
batch 319, loss: 0.3589, instance_loss: 0.3135, weighted_loss: 0.3453, label: 2, bag_size: 1289
batch 339, loss: 0.0901, instance_loss: 0.1224, weighted_loss: 0.0998, label: 3, bag_size: 50
batch 359, loss: 0.0948, instance_loss: 0.0897, weighted_loss: 0.0932, label: 4, bag_size: 147
batch 379, loss: 1.0643, instance_loss: 0.4190, weighted_loss: 0.8707, label: 2, bag_size: 482
batch 399, loss: 0.0239, instance_loss: 0.1822, weighted_loss: 0.0714, label: 3, bag_size: 18
batch 419, loss: 0.1020, instance_loss: 0.2801, weighted_loss: 0.1554, label: 0, bag_size: 898
batch 439, loss: 1.7883, instance_loss: 0.6077, weighted_loss: 1.4341, label: 1, bag_size: 1376
batch 459, loss: 2.8629, instance_loss: 0.7268, weighted_loss: 2.2220, label: 1, bag_size: 1799
batch 479, loss: 1.1754, instance_loss: 0.5238, weighted_loss: 0.9799, label: 2, bag_size: 959
batch 499, loss: 1.5027, instance_loss: 0.5331, weighted_loss: 1.2118, label: 1, bag_size: 700
batch 519, loss: 0.2173, instance_loss: 0.1710, weighted_loss: 0.2034, label: 1, bag_size: 1402
batch 539, loss: 0.9695, instance_loss: 0.5501, weighted_loss: 0.8437, label: 0, bag_size: 466


class 0 clustering acc 0.993348623853211: correct 21655/21800
class 1 clustering acc 0.24954128440366974: correct 1088/4360
Epoch: 6, train_loss: 0.6994, train_clustering_loss:  0.3550, train_error: 0.2807
class 0: acc 0.7311827956989247, correct 68/93
class 1: acc 0.6616541353383458, correct 88/133
class 2: acc 0.639344262295082, correct 78/122
class 3: acc 0.7920792079207921, correct 80/101
class 4: acc 0.8125, correct 78/96

Val Set, val_loss: 0.9234, val_error: 0.4400, auc: 0.9328
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 1.0, correct 9/9
class 2: acc 0.1111111111111111, correct 2/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4407, instance_loss: 0.2470, weighted_loss: 0.3826, label: 1, bag_size: 1144
batch 39, loss: 0.0811, instance_loss: 0.0780, weighted_loss: 0.0802, label: 4, bag_size: 119
batch 59, loss: 0.4538, instance_loss: 0.3055, weighted_loss: 0.4093, label: 4, bag_size: 711
batch 79, loss: 0.3327, instance_loss: 0.1635, weighted_loss: 0.2819, label: 1, bag_size: 1426
batch 99, loss: 0.4549, instance_loss: 0.3238, weighted_loss: 0.4156, label: 0, bag_size: 1190
batch 119, loss: 0.1960, instance_loss: 0.0972, weighted_loss: 0.1664, label: 4, bag_size: 147
batch 139, loss: 0.5616, instance_loss: 0.4286, weighted_loss: 0.5217, label: 2, bag_size: 682
batch 159, loss: 1.1889, instance_loss: 0.5066, weighted_loss: 0.9842, label: 2, bag_size: 312
batch 179, loss: 0.8788, instance_loss: 0.4096, weighted_loss: 0.7381, label: 0, bag_size: 1332
batch 199, loss: 0.1737, instance_loss: 0.2052, weighted_loss: 0.1832, label: 1, bag_size: 828
batch 219, loss: 0.3613, instance_loss: 0.3523, weighted_loss: 0.3586, label: 0, bag_size: 367
batch 239, loss: 0.6058, instance_loss: 0.5030, weighted_loss: 0.5749, label: 0, bag_size: 731
batch 259, loss: 0.1152, instance_loss: 0.1795, weighted_loss: 0.1345, label: 1, bag_size: 847
batch 279, loss: 2.9066, instance_loss: 0.6106, weighted_loss: 2.2178, label: 1, bag_size: 386
batch 299, loss: 1.6315, instance_loss: 0.5220, weighted_loss: 1.2987, label: 1, bag_size: 1390
batch 319, loss: 1.9142, instance_loss: 0.5677, weighted_loss: 1.5102, label: 3, bag_size: 343
batch 339, loss: 0.4002, instance_loss: 0.2331, weighted_loss: 0.3501, label: 3, bag_size: 697
batch 359, loss: 1.0321, instance_loss: 0.7690, weighted_loss: 0.9532, label: 0, bag_size: 118
batch 379, loss: 0.5506, instance_loss: 0.5071, weighted_loss: 0.5375, label: 0, bag_size: 129
batch 399, loss: 0.6200, instance_loss: 0.3635, weighted_loss: 0.5430, label: 1, bag_size: 925
batch 419, loss: 0.5693, instance_loss: 0.3767, weighted_loss: 0.5115, label: 2, bag_size: 404
batch 439, loss: 0.4162, instance_loss: 0.5216, weighted_loss: 0.4478, label: 0, bag_size: 114
batch 459, loss: 0.5223, instance_loss: 0.3126, weighted_loss: 0.4594, label: 2, bag_size: 480
batch 479, loss: 2.3212, instance_loss: 0.6196, weighted_loss: 1.8107, label: 1, bag_size: 657
batch 499, loss: 0.0981, instance_loss: 0.1851, weighted_loss: 0.1242, label: 4, bag_size: 790
batch 519, loss: 0.2083, instance_loss: 0.2825, weighted_loss: 0.2306, label: 4, bag_size: 826
batch 539, loss: 0.0191, instance_loss: 0.1293, weighted_loss: 0.0522, label: 3, bag_size: 31


class 0 clustering acc 0.9918348623853211: correct 21622/21800
class 1 clustering acc 0.2818807339449541: correct 1229/4360
Epoch: 7, train_loss: 0.6491, train_clustering_loss:  0.3506, train_error: 0.2385
class 0: acc 0.8, correct 88/110
class 1: acc 0.6915887850467289, correct 74/107
class 2: acc 0.638095238095238, correct 67/105
class 3: acc 0.8301886792452831, correct 88/106
class 4: acc 0.8376068376068376, correct 98/117

Val Set, val_loss: 0.6993, val_error: 0.2600, auc: 0.9431
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.1525: correct 61/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.6, correct 3/5
Validation loss decreased (0.817733 --> 0.699304).  Saving model ...


batch 19, loss: 0.1951, instance_loss: 0.2153, weighted_loss: 0.2011, label: 0, bag_size: 921
batch 39, loss: 3.7229, instance_loss: 0.8783, weighted_loss: 2.8696, label: 3, bag_size: 211
batch 59, loss: 0.4854, instance_loss: 0.3481, weighted_loss: 0.4442, label: 2, bag_size: 395
batch 79, loss: 0.0316, instance_loss: 0.1213, weighted_loss: 0.0585, label: 3, bag_size: 48
batch 99, loss: 0.8805, instance_loss: 0.3976, weighted_loss: 0.7356, label: 2, bag_size: 324
batch 119, loss: 0.4187, instance_loss: 0.3534, weighted_loss: 0.3991, label: 3, bag_size: 952
batch 139, loss: 0.4067, instance_loss: 0.3328, weighted_loss: 0.3845, label: 2, bag_size: 292
batch 159, loss: 0.7375, instance_loss: 0.3679, weighted_loss: 0.6266, label: 2, bag_size: 784
batch 179, loss: 0.2449, instance_loss: 0.3356, weighted_loss: 0.2721, label: 3, bag_size: 1253
batch 199, loss: 0.4969, instance_loss: 0.2618, weighted_loss: 0.4264, label: 1, bag_size: 346
batch 219, loss: 0.0860, instance_loss: 0.2277, weighted_loss: 0.1285, label: 3, bag_size: 35
batch 239, loss: 0.3500, instance_loss: 0.2489, weighted_loss: 0.3197, label: 1, bag_size: 530
batch 259, loss: 0.0533, instance_loss: 0.1254, weighted_loss: 0.0749, label: 4, bag_size: 30
batch 279, loss: 1.1001, instance_loss: 0.3901, weighted_loss: 0.8871, label: 0, bag_size: 255
batch 299, loss: 0.3424, instance_loss: 0.3824, weighted_loss: 0.3544, label: 0, bag_size: 413
batch 319, loss: 0.2219, instance_loss: 0.3649, weighted_loss: 0.2648, label: 0, bag_size: 976
batch 339, loss: 0.0260, instance_loss: 0.1336, weighted_loss: 0.0582, label: 3, bag_size: 33
batch 359, loss: 1.1500, instance_loss: 0.3823, weighted_loss: 0.9197, label: 1, bag_size: 1255
batch 379, loss: 0.2880, instance_loss: 0.2229, weighted_loss: 0.2685, label: 1, bag_size: 965
batch 399, loss: 1.9602, instance_loss: 0.7780, weighted_loss: 1.6055, label: 4, bag_size: 1360
batch 419, loss: 0.2821, instance_loss: 0.1521, weighted_loss: 0.2431, label: 1, bag_size: 399
batch 439, loss: 0.8280, instance_loss: 0.4699, weighted_loss: 0.7205, label: 2, bag_size: 324
batch 459, loss: 0.0288, instance_loss: 0.3893, weighted_loss: 0.1370, label: 4, bag_size: 17
batch 479, loss: 0.0190, instance_loss: 0.0407, weighted_loss: 0.0255, label: 4, bag_size: 40
batch 499, loss: 0.6569, instance_loss: 0.4274, weighted_loss: 0.5881, label: 4, bag_size: 524
batch 519, loss: 0.0101, instance_loss: 0.0881, weighted_loss: 0.0335, label: 3, bag_size: 37
batch 539, loss: 0.0996, instance_loss: 0.2896, weighted_loss: 0.1566, label: 0, bag_size: 1135


class 0 clustering acc 0.9933944954128441: correct 21656/21800
class 1 clustering acc 0.35573394495412847: correct 1551/4360
Epoch: 8, train_loss: 0.5924, train_clustering_loss:  0.3193, train_error: 0.2018
class 0: acc 0.8440366972477065, correct 92/109
class 1: acc 0.7317073170731707, correct 90/123
class 2: acc 0.6595744680851063, correct 62/94
class 3: acc 0.8421052631578947, correct 80/95
class 4: acc 0.8951612903225806, correct 111/124

Val Set, val_loss: 0.7326, val_error: 0.2400, auc: 0.9367
class 0 clustering acc 0.9905: correct 1981/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0101, instance_loss: 0.1980, weighted_loss: 0.0665, label: 4, bag_size: 20
batch 39, loss: 0.3150, instance_loss: 0.3296, weighted_loss: 0.3194, label: 0, bag_size: 731
batch 59, loss: 1.9473, instance_loss: 0.5458, weighted_loss: 1.5268, label: 2, bag_size: 948
batch 79, loss: 0.5309, instance_loss: 0.3741, weighted_loss: 0.4838, label: 2, bag_size: 525
batch 99, loss: 0.0296, instance_loss: 0.0756, weighted_loss: 0.0434, label: 3, bag_size: 28
batch 119, loss: 0.0886, instance_loss: 0.2054, weighted_loss: 0.1237, label: 4, bag_size: 47
batch 139, loss: 0.5740, instance_loss: 0.3493, weighted_loss: 0.5066, label: 2, bag_size: 1058
batch 159, loss: 1.1476, instance_loss: 0.5059, weighted_loss: 0.9551, label: 3, bag_size: 317
batch 179, loss: 0.3810, instance_loss: 0.2875, weighted_loss: 0.3530, label: 2, bag_size: 455
batch 199, loss: 0.0159, instance_loss: 0.0694, weighted_loss: 0.0320, label: 3, bag_size: 72
batch 219, loss: 0.2445, instance_loss: 0.1591, weighted_loss: 0.2189, label: 1, bag_size: 696
batch 239, loss: 0.6254, instance_loss: 0.4200, weighted_loss: 0.5638, label: 2, bag_size: 245
batch 259, loss: 0.0178, instance_loss: 0.0963, weighted_loss: 0.0413, label: 1, bag_size: 847
batch 279, loss: 1.1203, instance_loss: 0.4874, weighted_loss: 0.9304, label: 2, bag_size: 1006
batch 299, loss: 0.8636, instance_loss: 0.5212, weighted_loss: 0.7608, label: 2, bag_size: 317
batch 319, loss: 0.2132, instance_loss: 0.4052, weighted_loss: 0.2708, label: 0, bag_size: 1101
batch 339, loss: 1.5295, instance_loss: 0.4977, weighted_loss: 1.2200, label: 4, bag_size: 297
batch 359, loss: 1.5659, instance_loss: 0.5189, weighted_loss: 1.2518, label: 1, bag_size: 535
batch 379, loss: 0.4265, instance_loss: 0.3141, weighted_loss: 0.3928, label: 0, bag_size: 1517
batch 399, loss: 0.3769, instance_loss: 0.3454, weighted_loss: 0.3674, label: 2, bag_size: 730
batch 419, loss: 0.2488, instance_loss: 0.5024, weighted_loss: 0.3249, label: 4, bag_size: 754
batch 439, loss: 0.5308, instance_loss: 0.3338, weighted_loss: 0.4717, label: 1, bag_size: 965
batch 459, loss: 0.0587, instance_loss: 0.2487, weighted_loss: 0.1157, label: 4, bag_size: 86
batch 479, loss: 0.4618, instance_loss: 0.2873, weighted_loss: 0.4094, label: 1, bag_size: 846
batch 499, loss: 0.9032, instance_loss: 0.5542, weighted_loss: 0.7985, label: 4, bag_size: 1360
batch 519, loss: 0.0218, instance_loss: 0.2130, weighted_loss: 0.0792, label: 4, bag_size: 388
batch 539, loss: 0.2459, instance_loss: 0.2156, weighted_loss: 0.2369, label: 1, bag_size: 320


class 0 clustering acc 0.9907798165137615: correct 21599/21800
class 1 clustering acc 0.3330275229357798: correct 1452/4360
Epoch: 9, train_loss: 0.5404, train_clustering_loss:  0.3325, train_error: 0.2000
class 0: acc 0.888, correct 111/125
class 1: acc 0.6831683168316832, correct 69/101
class 2: acc 0.65625, correct 63/96
class 3: acc 0.8272727272727273, correct 91/110
class 4: acc 0.9026548672566371, correct 102/113

Val Set, val_loss: 0.7325, val_error: 0.3200, auc: 0.9445
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.2075: correct 83/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0740, instance_loss: 0.0739, weighted_loss: 0.0739, label: 1, bag_size: 1191
batch 39, loss: 0.1261, instance_loss: 0.1425, weighted_loss: 0.1310, label: 1, bag_size: 858
batch 59, loss: 0.6203, instance_loss: 0.2649, weighted_loss: 0.5137, label: 1, bag_size: 504
batch 79, loss: 0.0559, instance_loss: 0.0577, weighted_loss: 0.0565, label: 3, bag_size: 1559
batch 99, loss: 1.1945, instance_loss: 0.4535, weighted_loss: 0.9722, label: 1, bag_size: 936
batch 119, loss: 0.3239, instance_loss: 0.3304, weighted_loss: 0.3259, label: 2, bag_size: 271
batch 139, loss: 0.2357, instance_loss: 0.3231, weighted_loss: 0.2619, label: 1, bag_size: 598
batch 159, loss: 0.4663, instance_loss: 0.4233, weighted_loss: 0.4534, label: 2, bag_size: 409
batch 179, loss: 0.0168, instance_loss: 0.1528, weighted_loss: 0.0576, label: 3, bag_size: 24
batch 199, loss: 0.0281, instance_loss: 0.2000, weighted_loss: 0.0797, label: 4, bag_size: 24
batch 219, loss: 0.0144, instance_loss: 0.0597, weighted_loss: 0.0280, label: 3, bag_size: 43
batch 239, loss: 3.0846, instance_loss: 1.0945, weighted_loss: 2.4876, label: 2, bag_size: 373
batch 259, loss: 0.0397, instance_loss: 0.1622, weighted_loss: 0.0765, label: 4, bag_size: 790
batch 279, loss: 1.5305, instance_loss: 0.5089, weighted_loss: 1.2240, label: 1, bag_size: 1724
batch 299, loss: 0.0679, instance_loss: 0.2420, weighted_loss: 0.1201, label: 4, bag_size: 26
batch 319, loss: 0.0040, instance_loss: 0.0666, weighted_loss: 0.0228, label: 3, bag_size: 43
batch 339, loss: 0.0981, instance_loss: 0.1195, weighted_loss: 0.1045, label: 0, bag_size: 246
batch 359, loss: 0.0881, instance_loss: 0.1135, weighted_loss: 0.0957, label: 4, bag_size: 78
batch 379, loss: 0.0146, instance_loss: 0.0378, weighted_loss: 0.0216, label: 4, bag_size: 192
batch 399, loss: 0.0713, instance_loss: 0.1899, weighted_loss: 0.1069, label: 0, bag_size: 524
batch 419, loss: 0.1219, instance_loss: 0.3373, weighted_loss: 0.1865, label: 0, bag_size: 515
batch 439, loss: 0.4111, instance_loss: 0.3082, weighted_loss: 0.3802, label: 0, bag_size: 437
batch 459, loss: 0.2983, instance_loss: 0.2899, weighted_loss: 0.2958, label: 0, bag_size: 432
batch 479, loss: 0.3102, instance_loss: 0.1979, weighted_loss: 0.2765, label: 1, bag_size: 346
batch 499, loss: 0.2828, instance_loss: 0.3299, weighted_loss: 0.2969, label: 0, bag_size: 653
batch 519, loss: 0.7565, instance_loss: 0.4081, weighted_loss: 0.6520, label: 1, bag_size: 700
batch 539, loss: 0.3938, instance_loss: 0.3028, weighted_loss: 0.3665, label: 2, bag_size: 1039


class 0 clustering acc 0.9912844036697248: correct 21610/21800
class 1 clustering acc 0.3756880733944954: correct 1638/4360
Epoch: 10, train_loss: 0.5101, train_clustering_loss:  0.3139, train_error: 0.1890
class 0: acc 0.8350515463917526, correct 81/97
class 1: acc 0.6732673267326733, correct 68/101
class 2: acc 0.7669902912621359, correct 79/103
class 3: acc 0.8715596330275229, correct 95/109
class 4: acc 0.8814814814814815, correct 119/135

Val Set, val_loss: 0.7562, val_error: 0.2400, auc: 0.9324
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.6, correct 3/5
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5277, instance_loss: 0.2620, weighted_loss: 0.4480, label: 3, bag_size: 18
batch 39, loss: 0.1756, instance_loss: 0.1863, weighted_loss: 0.1788, label: 1, bag_size: 1402
batch 59, loss: 0.0076, instance_loss: 0.1700, weighted_loss: 0.0563, label: 3, bag_size: 48
batch 79, loss: 0.1718, instance_loss: 0.2171, weighted_loss: 0.1854, label: 0, bag_size: 602
batch 99, loss: 0.0439, instance_loss: 0.5163, weighted_loss: 0.1856, label: 4, bag_size: 14
batch 119, loss: 0.2105, instance_loss: 0.3001, weighted_loss: 0.2374, label: 2, bag_size: 1215
batch 139, loss: 0.0122, instance_loss: 0.0323, weighted_loss: 0.0183, label: 4, bag_size: 123
batch 159, loss: 0.0150, instance_loss: 0.2000, weighted_loss: 0.0705, label: 4, bag_size: 40
batch 179, loss: 0.0149, instance_loss: 0.0491, weighted_loss: 0.0251, label: 4, bag_size: 119
batch 199, loss: 0.0150, instance_loss: 0.0276, weighted_loss: 0.0188, label: 4, bag_size: 202
batch 219, loss: 0.1433, instance_loss: 0.1483, weighted_loss: 0.1448, label: 4, bag_size: 72
batch 239, loss: 0.4069, instance_loss: 0.3595, weighted_loss: 0.3926, label: 1, bag_size: 818
batch 259, loss: 0.0229, instance_loss: 0.0657, weighted_loss: 0.0358, label: 4, bag_size: 43
batch 279, loss: 0.8639, instance_loss: 0.3232, weighted_loss: 0.7017, label: 1, bag_size: 868
batch 299, loss: 1.4239, instance_loss: 0.5367, weighted_loss: 1.1578, label: 4, bag_size: 1337
batch 319, loss: 0.0079, instance_loss: 0.1284, weighted_loss: 0.0440, label: 3, bag_size: 63
batch 339, loss: 0.7153, instance_loss: 0.4239, weighted_loss: 0.6278, label: 0, bag_size: 552
batch 359, loss: 0.0619, instance_loss: 0.1779, weighted_loss: 0.0967, label: 0, bag_size: 515
batch 379, loss: 0.3294, instance_loss: 0.3225, weighted_loss: 0.3274, label: 2, bag_size: 907
batch 399, loss: 0.3425, instance_loss: 0.3316, weighted_loss: 0.3392, label: 2, bag_size: 357
batch 419, loss: 0.4582, instance_loss: 0.3243, weighted_loss: 0.4180, label: 1, bag_size: 530
batch 439, loss: 0.8484, instance_loss: 0.4470, weighted_loss: 0.7280, label: 2, bag_size: 738
batch 459, loss: 0.5436, instance_loss: 0.3792, weighted_loss: 0.4943, label: 2, bag_size: 399
batch 479, loss: 0.1804, instance_loss: 0.2100, weighted_loss: 0.1892, label: 0, bag_size: 1517
batch 499, loss: 0.2976, instance_loss: 0.3453, weighted_loss: 0.3119, label: 2, bag_size: 278
batch 519, loss: 2.2038, instance_loss: 0.7495, weighted_loss: 1.7675, label: 3, bag_size: 281
batch 539, loss: 0.0164, instance_loss: 0.0429, weighted_loss: 0.0244, label: 4, bag_size: 157


class 0 clustering acc 0.991788990825688: correct 21621/21800
class 1 clustering acc 0.3642201834862385: correct 1588/4360
Epoch: 11, train_loss: 0.4795, train_clustering_loss:  0.3195, train_error: 0.1761
class 0: acc 0.8829787234042553, correct 83/94
class 1: acc 0.7090909090909091, correct 78/110
class 2: acc 0.7256637168141593, correct 82/113
class 3: acc 0.9008264462809917, correct 109/121
class 4: acc 0.9065420560747663, correct 97/107

Val Set, val_loss: 0.7190, val_error: 0.2600, auc: 0.9395
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.225: correct 90/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0038, instance_loss: 0.0455, weighted_loss: 0.0163, label: 4, bag_size: 140
batch 39, loss: 0.0538, instance_loss: 0.2415, weighted_loss: 0.1101, label: 4, bag_size: 20
batch 59, loss: 0.3929, instance_loss: 0.3452, weighted_loss: 0.3786, label: 4, bag_size: 17
batch 79, loss: 0.3874, instance_loss: 0.5664, weighted_loss: 0.4411, label: 0, bag_size: 143
batch 99, loss: 0.7983, instance_loss: 0.4244, weighted_loss: 0.6861, label: 2, bag_size: 863
batch 119, loss: 0.5890, instance_loss: 0.4107, weighted_loss: 0.5355, label: 2, bag_size: 245
batch 139, loss: 0.3375, instance_loss: 0.4519, weighted_loss: 0.3718, label: 1, bag_size: 1409
batch 159, loss: 2.3446, instance_loss: 0.7313, weighted_loss: 1.8606, label: 2, bag_size: 803
batch 179, loss: 0.0307, instance_loss: 0.1051, weighted_loss: 0.0530, label: 3, bag_size: 123
batch 199, loss: 0.3819, instance_loss: 0.2816, weighted_loss: 0.3518, label: 0, bag_size: 350
batch 219, loss: 0.0054, instance_loss: 0.0828, weighted_loss: 0.0286, label: 4, bag_size: 790
batch 239, loss: 0.0100, instance_loss: 0.0466, weighted_loss: 0.0210, label: 4, bag_size: 91
batch 259, loss: 0.1732, instance_loss: 0.1739, weighted_loss: 0.1734, label: 4, bag_size: 119
batch 279, loss: 1.1343, instance_loss: 0.5451, weighted_loss: 0.9576, label: 1, bag_size: 747
batch 299, loss: 0.1391, instance_loss: 0.2129, weighted_loss: 0.1613, label: 0, bag_size: 1517
batch 319, loss: 0.9735, instance_loss: 0.5575, weighted_loss: 0.8487, label: 2, bag_size: 245
batch 339, loss: 0.0962, instance_loss: 0.0999, weighted_loss: 0.0973, label: 3, bag_size: 1291
batch 359, loss: 0.0955, instance_loss: 0.2571, weighted_loss: 0.1440, label: 4, bag_size: 23
batch 379, loss: 0.2614, instance_loss: 0.2794, weighted_loss: 0.2668, label: 1, bag_size: 348
batch 399, loss: 0.0318, instance_loss: 0.0819, weighted_loss: 0.0468, label: 3, bag_size: 63
batch 419, loss: 0.0124, instance_loss: 0.1007, weighted_loss: 0.0389, label: 3, bag_size: 53
batch 439, loss: 0.0115, instance_loss: 0.0518, weighted_loss: 0.0236, label: 4, bag_size: 112
batch 459, loss: 0.4737, instance_loss: 0.3228, weighted_loss: 0.4284, label: 2, bag_size: 828
batch 479, loss: 0.2619, instance_loss: 0.3616, weighted_loss: 0.2918, label: 1, bag_size: 846
batch 499, loss: 0.3974, instance_loss: 0.2842, weighted_loss: 0.3635, label: 2, bag_size: 470
batch 519, loss: 0.0063, instance_loss: 0.0741, weighted_loss: 0.0266, label: 3, bag_size: 43
batch 539, loss: 0.0409, instance_loss: 0.0966, weighted_loss: 0.0576, label: 3, bag_size: 451


class 0 clustering acc 0.9897706422018349: correct 21577/21800
class 1 clustering acc 0.38463302752293577: correct 1677/4360
Epoch: 12, train_loss: 0.4708, train_clustering_loss:  0.3144, train_error: 0.1670
class 0: acc 0.8706896551724138, correct 101/116
class 1: acc 0.7339449541284404, correct 80/109
class 2: acc 0.7522935779816514, correct 82/109
class 3: acc 0.8981481481481481, correct 97/108
class 4: acc 0.912621359223301, correct 94/103

Val Set, val_loss: 0.7188, val_error: 0.2400, auc: 0.9305
class 0 clustering acc 0.9945: correct 1989/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1679, instance_loss: 0.5223, weighted_loss: 0.2742, label: 0, bag_size: 653
batch 39, loss: 0.1411, instance_loss: 0.2614, weighted_loss: 0.1772, label: 0, bag_size: 1061
batch 59, loss: 0.0343, instance_loss: 0.1968, weighted_loss: 0.0830, label: 3, bag_size: 54
batch 79, loss: 0.0250, instance_loss: 0.1036, weighted_loss: 0.0486, label: 3, bag_size: 54
batch 99, loss: 0.0399, instance_loss: 0.1040, weighted_loss: 0.0592, label: 0, bag_size: 476
batch 119, loss: 0.0498, instance_loss: 0.1719, weighted_loss: 0.0865, label: 3, bag_size: 18
batch 139, loss: 1.6525, instance_loss: 0.5184, weighted_loss: 1.3123, label: 1, bag_size: 1376
batch 159, loss: 1.2486, instance_loss: 0.5555, weighted_loss: 1.0406, label: 2, bag_size: 1148
batch 179, loss: 0.5752, instance_loss: 0.6495, weighted_loss: 0.5975, label: 0, bag_size: 143
batch 199, loss: 0.6835, instance_loss: 0.3660, weighted_loss: 0.5882, label: 2, bag_size: 1019
batch 219, loss: 0.0794, instance_loss: 0.2417, weighted_loss: 0.1281, label: 4, bag_size: 55
batch 239, loss: 0.7797, instance_loss: 0.3436, weighted_loss: 0.6489, label: 0, bag_size: 718
batch 259, loss: 1.4755, instance_loss: 0.4344, weighted_loss: 1.1631, label: 4, bag_size: 17
batch 279, loss: 2.4103, instance_loss: 0.7232, weighted_loss: 1.9041, label: 1, bag_size: 660
batch 299, loss: 0.0262, instance_loss: 0.2985, weighted_loss: 0.1079, label: 4, bag_size: 24
batch 319, loss: 1.4703, instance_loss: 0.6815, weighted_loss: 1.2337, label: 4, bag_size: 1360
batch 339, loss: 2.6439, instance_loss: 0.8940, weighted_loss: 2.1189, label: 3, bag_size: 281
batch 359, loss: 0.2569, instance_loss: 0.3787, weighted_loss: 0.2934, label: 0, bag_size: 148
batch 379, loss: 0.1028, instance_loss: 0.1280, weighted_loss: 0.1104, label: 4, bag_size: 130
batch 399, loss: 0.7114, instance_loss: 0.3129, weighted_loss: 0.5918, label: 0, bag_size: 424
batch 419, loss: 0.0583, instance_loss: 0.1325, weighted_loss: 0.0805, label: 3, bag_size: 34
batch 439, loss: 0.0124, instance_loss: 0.1208, weighted_loss: 0.0449, label: 4, bag_size: 150
batch 459, loss: 0.1048, instance_loss: 0.1976, weighted_loss: 0.1327, label: 1, bag_size: 866
batch 479, loss: 0.0327, instance_loss: 0.1157, weighted_loss: 0.0576, label: 0, bag_size: 1466
batch 499, loss: 1.4585, instance_loss: 0.5040, weighted_loss: 1.1722, label: 1, bag_size: 470
batch 519, loss: 1.7203, instance_loss: 0.7309, weighted_loss: 1.4235, label: 1, bag_size: 875
batch 539, loss: 2.1645, instance_loss: 0.3749, weighted_loss: 1.6276, label: 0, bag_size: 760


class 0 clustering acc 0.9892660550458715: correct 21566/21800
class 1 clustering acc 0.3814220183486238: correct 1663/4360
Epoch: 13, train_loss: 0.5083, train_clustering_loss:  0.3188, train_error: 0.1890
class 0: acc 0.8833333333333333, correct 106/120
class 1: acc 0.6486486486486487, correct 72/111
class 2: acc 0.7272727272727273, correct 80/110
class 3: acc 0.897196261682243, correct 96/107
class 4: acc 0.9072164948453608, correct 88/97

Val Set, val_loss: 0.8274, val_error: 0.2600, auc: 0.9258
class 0 clustering acc 0.992: correct 1984/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.2348, instance_loss: 0.4294, weighted_loss: 0.9932, label: 1, bag_size: 470
batch 39, loss: 1.8879, instance_loss: 0.5120, weighted_loss: 1.4752, label: 1, bag_size: 700
batch 59, loss: 1.4743, instance_loss: 0.5775, weighted_loss: 1.2052, label: 0, bag_size: 1065
batch 79, loss: 0.6881, instance_loss: 0.5646, weighted_loss: 0.6510, label: 3, bag_size: 706
batch 99, loss: 0.0535, instance_loss: 0.1466, weighted_loss: 0.0814, label: 0, bag_size: 521
batch 119, loss: 0.1966, instance_loss: 0.1724, weighted_loss: 0.1893, label: 1, bag_size: 1144
batch 139, loss: 0.0364, instance_loss: 0.0792, weighted_loss: 0.0493, label: 0, bag_size: 382
batch 159, loss: 2.2774, instance_loss: 0.6638, weighted_loss: 1.7933, label: 0, bag_size: 1065
batch 179, loss: 0.1248, instance_loss: 0.5153, weighted_loss: 0.2419, label: 0, bag_size: 176
batch 199, loss: 0.1223, instance_loss: 0.3308, weighted_loss: 0.1848, label: 0, bag_size: 148
batch 219, loss: 0.3707, instance_loss: 0.2844, weighted_loss: 0.3448, label: 1, bag_size: 348
batch 239, loss: 0.7150, instance_loss: 0.5148, weighted_loss: 0.6549, label: 4, bag_size: 646
batch 259, loss: 0.1959, instance_loss: 0.4783, weighted_loss: 0.2806, label: 0, bag_size: 163
batch 279, loss: 1.2302, instance_loss: 0.3607, weighted_loss: 0.9694, label: 0, bag_size: 1332
batch 299, loss: 0.0041, instance_loss: 0.0233, weighted_loss: 0.0099, label: 3, bag_size: 305
batch 319, loss: 0.0049, instance_loss: 0.0343, weighted_loss: 0.0137, label: 4, bag_size: 178
batch 339, loss: 0.0076, instance_loss: 0.1608, weighted_loss: 0.0536, label: 4, bag_size: 63
batch 359, loss: 3.1888, instance_loss: 0.8249, weighted_loss: 2.4796, label: 3, bag_size: 281
batch 379, loss: 0.1516, instance_loss: 0.2877, weighted_loss: 0.1924, label: 4, bag_size: 826
batch 399, loss: 0.0013, instance_loss: 0.0440, weighted_loss: 0.0141, label: 4, bag_size: 157
batch 419, loss: 0.0172, instance_loss: 0.2591, weighted_loss: 0.0898, label: 3, bag_size: 72
batch 439, loss: 0.4991, instance_loss: 0.4111, weighted_loss: 0.4727, label: 2, bag_size: 355
batch 459, loss: 0.3343, instance_loss: 0.5281, weighted_loss: 0.3924, label: 2, bag_size: 323
batch 479, loss: 3.5682, instance_loss: 0.8517, weighted_loss: 2.7533, label: 4, bag_size: 511
batch 499, loss: 0.0098, instance_loss: 0.0501, weighted_loss: 0.0219, label: 4, bag_size: 162
batch 519, loss: 1.1815, instance_loss: 0.3904, weighted_loss: 0.9441, label: 3, bag_size: 1177
batch 539, loss: 0.0079, instance_loss: 0.0430, weighted_loss: 0.0184, label: 4, bag_size: 43


class 0 clustering acc 0.991651376146789: correct 21618/21800
class 1 clustering acc 0.40894495412844034: correct 1783/4360
Epoch: 14, train_loss: 0.4563, train_clustering_loss:  0.3028, train_error: 0.1743
class 0: acc 0.883495145631068, correct 91/103
class 1: acc 0.6454545454545455, correct 71/110
class 2: acc 0.7254901960784313, correct 74/102
class 3: acc 0.9224137931034483, correct 107/116
class 4: acc 0.9385964912280702, correct 107/114

Val Set, val_loss: 0.6662, val_error: 0.2200, auc: 0.9326
class 0 clustering acc 0.9915: correct 1983/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.6, correct 3/5
Validation loss decreased (0.699304 --> 0.666186).  Saving model ...


batch 19, loss: 1.0232, instance_loss: 0.5007, weighted_loss: 0.8664, label: 1, bag_size: 868
batch 39, loss: 0.0112, instance_loss: 0.0354, weighted_loss: 0.0184, label: 4, bag_size: 192
batch 59, loss: 0.0809, instance_loss: 0.2048, weighted_loss: 0.1181, label: 0, bag_size: 602
batch 79, loss: 0.2966, instance_loss: 0.2887, weighted_loss: 0.2942, label: 2, bag_size: 828
batch 99, loss: 0.5232, instance_loss: 0.3432, weighted_loss: 0.4692, label: 2, bag_size: 264
batch 119, loss: 0.1293, instance_loss: 0.2408, weighted_loss: 0.1627, label: 0, bag_size: 338
batch 139, loss: 1.4718, instance_loss: 0.5021, weighted_loss: 1.1809, label: 0, bag_size: 424
batch 159, loss: 0.0140, instance_loss: 0.1481, weighted_loss: 0.0542, label: 3, bag_size: 18
batch 179, loss: 0.3347, instance_loss: 0.4439, weighted_loss: 0.3675, label: 1, bag_size: 925
batch 199, loss: 0.3358, instance_loss: 0.2964, weighted_loss: 0.3240, label: 1, bag_size: 1325
batch 219, loss: 0.0527, instance_loss: 0.1816, weighted_loss: 0.0914, label: 3, bag_size: 316
batch 239, loss: 0.0389, instance_loss: 0.3094, weighted_loss: 0.1201, label: 0, bag_size: 163
batch 259, loss: 0.0362, instance_loss: 0.1311, weighted_loss: 0.0647, label: 4, bag_size: 44
batch 279, loss: 0.8032, instance_loss: 0.5638, weighted_loss: 0.7314, label: 2, bag_size: 295
batch 299, loss: 0.0078, instance_loss: 0.0487, weighted_loss: 0.0201, label: 4, bag_size: 211
batch 319, loss: 0.0797, instance_loss: 0.1802, weighted_loss: 0.1099, label: 3, bag_size: 18
batch 339, loss: 0.0417, instance_loss: 0.1977, weighted_loss: 0.0885, label: 0, bag_size: 114
batch 359, loss: 0.0691, instance_loss: 0.0925, weighted_loss: 0.0761, label: 1, bag_size: 834
batch 379, loss: 0.1696, instance_loss: 0.3096, weighted_loss: 0.2116, label: 2, bag_size: 730
batch 399, loss: 0.9718, instance_loss: 0.4991, weighted_loss: 0.8300, label: 2, bag_size: 271
batch 419, loss: 0.4796, instance_loss: 0.3282, weighted_loss: 0.4342, label: 2, bag_size: 1259
batch 439, loss: 0.0155, instance_loss: 0.2124, weighted_loss: 0.0746, label: 3, bag_size: 18
batch 459, loss: 0.6541, instance_loss: 0.4228, weighted_loss: 0.5847, label: 2, bag_size: 384
batch 479, loss: 0.1843, instance_loss: 0.1913, weighted_loss: 0.1864, label: 2, bag_size: 292
batch 499, loss: 0.0658, instance_loss: 0.0911, weighted_loss: 0.0734, label: 1, bag_size: 286
batch 519, loss: 0.0861, instance_loss: 0.2310, weighted_loss: 0.1296, label: 3, bag_size: 1559
batch 539, loss: 0.1601, instance_loss: 0.3916, weighted_loss: 0.2295, label: 3, bag_size: 283


class 0 clustering acc 0.9910550458715597: correct 21605/21800
class 1 clustering acc 0.4011467889908257: correct 1749/4360
Epoch: 15, train_loss: 0.4210, train_clustering_loss:  0.3027, train_error: 0.1450
class 0: acc 0.9090909090909091, correct 100/110
class 1: acc 0.7192982456140351, correct 82/114
class 2: acc 0.8157894736842105, correct 93/114
class 3: acc 0.900990099009901, correct 91/101
class 4: acc 0.9433962264150944, correct 100/106

Val Set, val_loss: 0.7808, val_error: 0.2800, auc: 0.9309
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.2975: correct 119/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4110, instance_loss: 0.3911, weighted_loss: 0.4050, label: 2, bag_size: 1141
batch 39, loss: 1.4361, instance_loss: 0.8167, weighted_loss: 1.2503, label: 2, bag_size: 3236
batch 59, loss: 0.1924, instance_loss: 0.2695, weighted_loss: 0.2155, label: 2, bag_size: 1200
batch 79, loss: 0.0116, instance_loss: 0.1284, weighted_loss: 0.0466, label: 4, bag_size: 388
batch 99, loss: 2.5334, instance_loss: 0.6259, weighted_loss: 1.9612, label: 3, bag_size: 305
batch 119, loss: 0.1455, instance_loss: 0.2977, weighted_loss: 0.1912, label: 0, bag_size: 350
batch 139, loss: 0.1593, instance_loss: 0.1658, weighted_loss: 0.1612, label: 1, bag_size: 1402
batch 159, loss: 0.1011, instance_loss: 0.1848, weighted_loss: 0.1262, label: 4, bag_size: 44
batch 179, loss: 0.0194, instance_loss: 0.1075, weighted_loss: 0.0458, label: 3, bag_size: 316
batch 199, loss: 0.0461, instance_loss: 0.1706, weighted_loss: 0.0835, label: 0, bag_size: 1517
batch 219, loss: 0.2038, instance_loss: 0.4132, weighted_loss: 0.2666, label: 1, bag_size: 925
batch 239, loss: 0.0086, instance_loss: 0.0452, weighted_loss: 0.0196, label: 0, bag_size: 382
batch 259, loss: 0.0117, instance_loss: 0.0487, weighted_loss: 0.0228, label: 0, bag_size: 382
batch 279, loss: 0.4055, instance_loss: 0.3690, weighted_loss: 0.3945, label: 2, bag_size: 358
batch 299, loss: 0.3241, instance_loss: 0.3656, weighted_loss: 0.3365, label: 2, bag_size: 1533
batch 319, loss: 0.7251, instance_loss: 0.2705, weighted_loss: 0.5887, label: 2, bag_size: 748
batch 339, loss: 0.4356, instance_loss: 0.4700, weighted_loss: 0.4459, label: 0, bag_size: 120
batch 359, loss: 0.2058, instance_loss: 0.3857, weighted_loss: 0.2598, label: 0, bag_size: 155
batch 379, loss: 0.0763, instance_loss: 0.0966, weighted_loss: 0.0824, label: 3, bag_size: 405
batch 399, loss: 0.0298, instance_loss: 0.0447, weighted_loss: 0.0342, label: 4, bag_size: 211
batch 419, loss: 0.0111, instance_loss: 0.3121, weighted_loss: 0.1014, label: 3, bag_size: 60
batch 439, loss: 0.0026, instance_loss: 0.2149, weighted_loss: 0.0663, label: 3, bag_size: 20
batch 459, loss: 0.0081, instance_loss: 0.0794, weighted_loss: 0.0295, label: 3, bag_size: 28
batch 479, loss: 0.4362, instance_loss: 0.4245, weighted_loss: 0.4327, label: 1, bag_size: 747
batch 499, loss: 0.0013, instance_loss: 0.0717, weighted_loss: 0.0224, label: 4, bag_size: 43
batch 519, loss: 0.0070, instance_loss: 0.0306, weighted_loss: 0.0141, label: 0, bag_size: 239
batch 539, loss: 0.5680, instance_loss: 0.2554, weighted_loss: 0.4742, label: 1, bag_size: 1014


class 0 clustering acc 0.9891743119266055: correct 21564/21800
class 1 clustering acc 0.39839449541284405: correct 1737/4360
Epoch: 16, train_loss: 0.3555, train_clustering_loss:  0.2990, train_error: 0.1303
class 0: acc 0.912621359223301, correct 94/103
class 1: acc 0.7, correct 77/110
class 2: acc 0.8264462809917356, correct 100/121
class 3: acc 0.9326923076923077, correct 97/104
class 4: acc 0.9906542056074766, correct 106/107

Val Set, val_loss: 0.8809, val_error: 0.2600, auc: 0.9205
class 0 clustering acc 0.992: correct 1984/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5061, instance_loss: 0.3213, weighted_loss: 0.4507, label: 1, bag_size: 470
batch 39, loss: 1.9875, instance_loss: 0.6397, weighted_loss: 1.5831, label: 1, bag_size: 1172
batch 59, loss: 0.5856, instance_loss: 0.4330, weighted_loss: 0.5398, label: 3, bag_size: 360
batch 79, loss: 0.0078, instance_loss: 0.2114, weighted_loss: 0.0689, label: 3, bag_size: 16
batch 99, loss: 0.0434, instance_loss: 0.3012, weighted_loss: 0.1207, label: 0, bag_size: 163
batch 119, loss: 0.0165, instance_loss: 0.1463, weighted_loss: 0.0554, label: 3, bag_size: 35
batch 139, loss: 0.6552, instance_loss: 0.4069, weighted_loss: 0.5807, label: 2, bag_size: 1133
batch 159, loss: 0.6436, instance_loss: 0.4646, weighted_loss: 0.5899, label: 0, bag_size: 736
batch 179, loss: 0.0228, instance_loss: 0.0998, weighted_loss: 0.0459, label: 4, bag_size: 119
batch 199, loss: 0.0128, instance_loss: 0.1810, weighted_loss: 0.0633, label: 0, bag_size: 1101
batch 219, loss: 0.1312, instance_loss: 0.2051, weighted_loss: 0.1534, label: 3, bag_size: 16
batch 239, loss: 0.0464, instance_loss: 0.0558, weighted_loss: 0.0492, label: 4, bag_size: 192
batch 259, loss: 0.7192, instance_loss: 0.3813, weighted_loss: 0.6178, label: 2, bag_size: 358
batch 279, loss: 0.1048, instance_loss: 0.2567, weighted_loss: 0.1504, label: 3, bag_size: 16
batch 299, loss: 0.1173, instance_loss: 0.2183, weighted_loss: 0.1476, label: 1, bag_size: 838
batch 319, loss: 0.0029, instance_loss: 0.0404, weighted_loss: 0.0141, label: 4, bag_size: 55
batch 339, loss: 0.0635, instance_loss: 0.3324, weighted_loss: 0.1442, label: 4, bag_size: 646
batch 359, loss: 0.0108, instance_loss: 0.2749, weighted_loss: 0.0900, label: 3, bag_size: 841
batch 379, loss: 0.4823, instance_loss: 0.4420, weighted_loss: 0.4702, label: 2, bag_size: 701
batch 399, loss: 0.8020, instance_loss: 0.4358, weighted_loss: 0.6921, label: 2, bag_size: 471
batch 419, loss: 0.0040, instance_loss: 0.0218, weighted_loss: 0.0093, label: 4, bag_size: 96
batch 439, loss: 0.0750, instance_loss: 0.3721, weighted_loss: 0.1641, label: 0, bag_size: 118
batch 459, loss: 1.0757, instance_loss: 0.5748, weighted_loss: 0.9254, label: 2, bag_size: 934
batch 479, loss: 0.2812, instance_loss: 0.2330, weighted_loss: 0.2668, label: 1, bag_size: 504
batch 499, loss: 0.3882, instance_loss: 0.3136, weighted_loss: 0.3658, label: 3, bag_size: 849
batch 519, loss: 0.0858, instance_loss: 0.1860, weighted_loss: 0.1159, label: 0, bag_size: 446
batch 539, loss: 0.1214, instance_loss: 0.2304, weighted_loss: 0.1541, label: 3, bag_size: 849


class 0 clustering acc 0.9896330275229358: correct 21574/21800
class 1 clustering acc 0.4405963302752294: correct 1921/4360
Epoch: 17, train_loss: 0.4156, train_clustering_loss:  0.2954, train_error: 0.1394
class 0: acc 0.8482142857142857, correct 95/112
class 1: acc 0.7631578947368421, correct 87/114
class 2: acc 0.8055555555555556, correct 87/108
class 3: acc 0.9215686274509803, correct 94/102
class 4: acc 0.9724770642201835, correct 106/109

Val Set, val_loss: 0.7850, val_error: 0.2800, auc: 0.9177
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0031, instance_loss: 0.0478, weighted_loss: 0.0166, label: 3, bag_size: 66
batch 39, loss: 0.1308, instance_loss: 0.2547, weighted_loss: 0.1679, label: 2, bag_size: 571
batch 59, loss: 0.1442, instance_loss: 0.3268, weighted_loss: 0.1990, label: 3, bag_size: 706
batch 79, loss: 0.2367, instance_loss: 0.2757, weighted_loss: 0.2484, label: 2, bag_size: 638
batch 99, loss: 0.0094, instance_loss: 0.1429, weighted_loss: 0.0495, label: 4, bag_size: 35
batch 119, loss: 0.1378, instance_loss: 0.0815, weighted_loss: 0.1209, label: 4, bag_size: 114
batch 139, loss: 0.0071, instance_loss: 0.3553, weighted_loss: 0.1116, label: 3, bag_size: 841
batch 159, loss: 0.0130, instance_loss: 0.1456, weighted_loss: 0.0528, label: 4, bag_size: 44
batch 179, loss: 0.2818, instance_loss: 0.2952, weighted_loss: 0.2858, label: 3, bag_size: 791
batch 199, loss: 0.0007, instance_loss: 0.1639, weighted_loss: 0.0497, label: 4, bag_size: 20
batch 219, loss: 0.1525, instance_loss: 0.2492, weighted_loss: 0.1815, label: 2, bag_size: 419
batch 239, loss: 1.2829, instance_loss: 0.7597, weighted_loss: 1.1259, label: 2, bag_size: 1043
batch 259, loss: 0.2907, instance_loss: 0.6911, weighted_loss: 0.4108, label: 4, bag_size: 210
batch 279, loss: 0.0007, instance_loss: 0.1565, weighted_loss: 0.0474, label: 3, bag_size: 24
batch 299, loss: 1.0513, instance_loss: 0.4952, weighted_loss: 0.8845, label: 2, bag_size: 1148
batch 319, loss: 0.2333, instance_loss: 0.2625, weighted_loss: 0.2421, label: 2, bag_size: 1164
batch 339, loss: 0.6919, instance_loss: 0.3936, weighted_loss: 0.6024, label: 2, bag_size: 676
batch 359, loss: 0.0943, instance_loss: 0.2327, weighted_loss: 0.1358, label: 4, bag_size: 297
batch 379, loss: 0.0907, instance_loss: 0.4228, weighted_loss: 0.1903, label: 4, bag_size: 823
batch 399, loss: 1.4676, instance_loss: 0.4810, weighted_loss: 1.1716, label: 1, bag_size: 487
batch 419, loss: 0.0035, instance_loss: 0.0295, weighted_loss: 0.0113, label: 1, bag_size: 847
batch 439, loss: 0.0017, instance_loss: 0.0651, weighted_loss: 0.0207, label: 3, bag_size: 37
batch 459, loss: 1.0623, instance_loss: 0.4700, weighted_loss: 0.8846, label: 1, bag_size: 1144
batch 479, loss: 0.2543, instance_loss: 0.2780, weighted_loss: 0.2614, label: 2, bag_size: 907
batch 499, loss: 0.0106, instance_loss: 0.1079, weighted_loss: 0.0398, label: 4, bag_size: 40
batch 519, loss: 0.0061, instance_loss: 0.2500, weighted_loss: 0.0793, label: 4, bag_size: 19
batch 539, loss: 0.2533, instance_loss: 0.3010, weighted_loss: 0.2676, label: 2, bag_size: 774


class 0 clustering acc 0.9894495412844037: correct 21570/21800
class 1 clustering acc 0.4488532110091743: correct 1957/4360
Epoch: 18, train_loss: 0.3578, train_clustering_loss:  0.2875, train_error: 0.1266
class 0: acc 0.9347826086956522, correct 86/92
class 1: acc 0.7047619047619048, correct 74/105
class 2: acc 0.8230088495575221, correct 93/113
class 3: acc 0.9385964912280702, correct 107/114
class 4: acc 0.9586776859504132, correct 116/121

Val Set, val_loss: 0.8556, val_error: 0.2600, auc: 0.9070
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.31: correct 124/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3905, instance_loss: 0.3320, weighted_loss: 0.3730, label: 2, bag_size: 286
batch 39, loss: 0.0069, instance_loss: 0.1114, weighted_loss: 0.0383, label: 3, bag_size: 143
batch 59, loss: 0.2001, instance_loss: 0.2495, weighted_loss: 0.2149, label: 2, bag_size: 499
batch 79, loss: 0.0235, instance_loss: 0.1291, weighted_loss: 0.0552, label: 4, bag_size: 40
batch 99, loss: 0.0014, instance_loss: 0.0189, weighted_loss: 0.0066, label: 4, bag_size: 137
batch 119, loss: 0.3161, instance_loss: 0.2981, weighted_loss: 0.3107, label: 2, bag_size: 357
batch 139, loss: 0.0070, instance_loss: 0.0624, weighted_loss: 0.0236, label: 0, bag_size: 898
batch 159, loss: 0.2074, instance_loss: 0.2375, weighted_loss: 0.2164, label: 2, bag_size: 701
batch 179, loss: 0.0495, instance_loss: 0.1696, weighted_loss: 0.0856, label: 0, bag_size: 1101
batch 199, loss: 0.0136, instance_loss: 0.1510, weighted_loss: 0.0548, label: 3, bag_size: 143
batch 219, loss: 0.0596, instance_loss: 0.4466, weighted_loss: 0.1757, label: 4, bag_size: 823
batch 239, loss: 1.2667, instance_loss: 0.4903, weighted_loss: 1.0338, label: 2, bag_size: 1128
batch 259, loss: 0.1055, instance_loss: 0.2203, weighted_loss: 0.1399, label: 1, bag_size: 1402
batch 279, loss: 0.2742, instance_loss: 0.2545, weighted_loss: 0.2683, label: 2, bag_size: 480
batch 299, loss: 1.1774, instance_loss: 0.4493, weighted_loss: 0.9589, label: 1, bag_size: 1724
batch 319, loss: 0.2730, instance_loss: 0.4091, weighted_loss: 0.3139, label: 1, bag_size: 1273
batch 339, loss: 0.3836, instance_loss: 0.4925, weighted_loss: 0.4163, label: 0, bag_size: 1527
batch 359, loss: 0.0210, instance_loss: 0.0568, weighted_loss: 0.0317, label: 4, bag_size: 119
batch 379, loss: 0.3804, instance_loss: 0.5841, weighted_loss: 0.4415, label: 2, bag_size: 1231
batch 399, loss: 0.1534, instance_loss: 0.2646, weighted_loss: 0.1868, label: 1, bag_size: 965
batch 419, loss: 0.1466, instance_loss: 0.2391, weighted_loss: 0.1743, label: 3, bag_size: 1399
batch 439, loss: 0.3656, instance_loss: 0.3611, weighted_loss: 0.3642, label: 1, bag_size: 968
batch 459, loss: 0.0176, instance_loss: 0.2358, weighted_loss: 0.0830, label: 3, bag_size: 21
batch 479, loss: 0.6096, instance_loss: 0.5822, weighted_loss: 0.6014, label: 1, bag_size: 657
batch 499, loss: 0.0009, instance_loss: 0.1267, weighted_loss: 0.0386, label: 3, bag_size: 24
batch 519, loss: 1.0726, instance_loss: 0.4326, weighted_loss: 0.8806, label: 2, bag_size: 684
batch 539, loss: 0.1056, instance_loss: 0.1736, weighted_loss: 0.1260, label: 0, bag_size: 437


class 0 clustering acc 0.9875688073394495: correct 21529/21800
class 1 clustering acc 0.4011467889908257: correct 1749/4360
Epoch: 19, train_loss: 0.4050, train_clustering_loss:  0.3135, train_error: 0.1486
class 0: acc 0.8796296296296297, correct 95/108
class 1: acc 0.6851851851851852, correct 74/108
class 2: acc 0.8166666666666667, correct 98/120
class 3: acc 0.9444444444444444, correct 102/108
class 4: acc 0.9405940594059405, correct 95/101

Val Set, val_loss: 0.6728, val_error: 0.2000, auc: 0.9307
class 0 clustering acc 0.9935: correct 1987/2000
class 1 clustering acc 0.3: correct 120/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.3100, instance_loss: 0.5004, weighted_loss: 1.0671, label: 1, bag_size: 875
batch 39, loss: 0.3815, instance_loss: 0.4669, weighted_loss: 0.4071, label: 1, bag_size: 747
batch 59, loss: 0.8552, instance_loss: 0.5403, weighted_loss: 0.7607, label: 2, bag_size: 271
batch 79, loss: 0.7857, instance_loss: 0.3263, weighted_loss: 0.6479, label: 2, bag_size: 828
batch 99, loss: 0.0390, instance_loss: 0.2849, weighted_loss: 0.1127, label: 0, bag_size: 122
batch 119, loss: 0.8992, instance_loss: 0.4770, weighted_loss: 0.7726, label: 1, bag_size: 868
batch 139, loss: 0.4408, instance_loss: 0.4239, weighted_loss: 0.4357, label: 2, bag_size: 307
batch 159, loss: 0.1612, instance_loss: 0.3978, weighted_loss: 0.2322, label: 3, bag_size: 936
batch 179, loss: 0.1212, instance_loss: 0.2058, weighted_loss: 0.1466, label: 0, bag_size: 1255
batch 199, loss: 0.0102, instance_loss: 0.1530, weighted_loss: 0.0531, label: 4, bag_size: 104
batch 219, loss: 0.0336, instance_loss: 0.0782, weighted_loss: 0.0470, label: 1, bag_size: 886
batch 239, loss: 4.4764, instance_loss: 0.9752, weighted_loss: 3.4261, label: 1, bag_size: 386
batch 259, loss: 0.0035, instance_loss: 0.0457, weighted_loss: 0.0162, label: 4, bag_size: 112
batch 279, loss: 0.0059, instance_loss: 0.0963, weighted_loss: 0.0330, label: 3, bag_size: 18
batch 299, loss: 0.0039, instance_loss: 0.0284, weighted_loss: 0.0112, label: 4, bag_size: 43
batch 319, loss: 0.2208, instance_loss: 0.3668, weighted_loss: 0.2646, label: 1, bag_size: 343
batch 339, loss: 3.0229, instance_loss: 0.6706, weighted_loss: 2.3172, label: 0, bag_size: 245
batch 359, loss: 0.0075, instance_loss: 0.0382, weighted_loss: 0.0167, label: 3, bag_size: 46
batch 379, loss: 0.0138, instance_loss: 0.2547, weighted_loss: 0.0861, label: 3, bag_size: 15
batch 399, loss: 0.0051, instance_loss: 0.4139, weighted_loss: 0.1278, label: 4, bag_size: 17
batch 419, loss: 0.0012, instance_loss: 0.0823, weighted_loss: 0.0256, label: 4, bag_size: 43
batch 439, loss: 0.0098, instance_loss: 0.0351, weighted_loss: 0.0174, label: 1, bag_size: 286
batch 459, loss: 0.0082, instance_loss: 0.0590, weighted_loss: 0.0234, label: 0, bag_size: 382
batch 479, loss: 0.0054, instance_loss: 0.1660, weighted_loss: 0.0535, label: 3, bag_size: 27
batch 499, loss: 0.0798, instance_loss: 0.2378, weighted_loss: 0.1272, label: 4, bag_size: 636
batch 519, loss: 0.1292, instance_loss: 0.4786, weighted_loss: 0.2340, label: 1, bag_size: 1273
batch 539, loss: 0.1639, instance_loss: 0.2368, weighted_loss: 0.1858, label: 1, bag_size: 711


class 0 clustering acc 0.9897706422018349: correct 21577/21800
class 1 clustering acc 0.45389908256880734: correct 1979/4360
Epoch: 20, train_loss: 0.3279, train_clustering_loss:  0.2819, train_error: 0.1229
class 0: acc 0.9159663865546218, correct 109/119
class 1: acc 0.7723577235772358, correct 95/123
class 2: acc 0.8108108108108109, correct 90/111
class 3: acc 0.93, correct 93/100
class 4: acc 0.9891304347826086, correct 91/92

Val Set, val_loss: 0.9386, val_error: 0.2600, auc: 0.9132
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 1.0, correct 9/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2710, instance_loss: 0.2915, weighted_loss: 0.2772, label: 0, bag_size: 756
batch 39, loss: 0.2757, instance_loss: 0.4016, weighted_loss: 0.3135, label: 2, bag_size: 1052
batch 59, loss: 0.0189, instance_loss: 0.0906, weighted_loss: 0.0404, label: 0, bag_size: 521
batch 79, loss: 1.9398, instance_loss: 0.5091, weighted_loss: 1.5106, label: 1, bag_size: 700
batch 99, loss: 0.0246, instance_loss: 0.0693, weighted_loss: 0.0380, label: 1, bag_size: 994
batch 119, loss: 0.2075, instance_loss: 0.3965, weighted_loss: 0.2642, label: 3, bag_size: 17
batch 139, loss: 0.0882, instance_loss: 0.4907, weighted_loss: 0.2089, label: 0, bag_size: 109
batch 159, loss: 0.0750, instance_loss: 0.1245, weighted_loss: 0.0898, label: 1, bag_size: 1277
batch 179, loss: 1.4528, instance_loss: 0.4740, weighted_loss: 1.1591, label: 1, bag_size: 1197
batch 199, loss: 0.0194, instance_loss: 0.1319, weighted_loss: 0.0532, label: 0, bag_size: 1101
batch 219, loss: 0.0469, instance_loss: 0.5031, weighted_loss: 0.1838, label: 4, bag_size: 1278
batch 239, loss: 0.0782, instance_loss: 0.2136, weighted_loss: 0.1188, label: 2, bag_size: 750
batch 259, loss: 0.0246, instance_loss: 0.2179, weighted_loss: 0.0826, label: 4, bag_size: 524
batch 279, loss: 0.0064, instance_loss: 0.0795, weighted_loss: 0.0283, label: 0, bag_size: 382
batch 299, loss: 0.0145, instance_loss: 0.0596, weighted_loss: 0.0280, label: 3, bag_size: 97
batch 319, loss: 0.5421, instance_loss: 0.4410, weighted_loss: 0.5118, label: 1, bag_size: 1014
batch 339, loss: 0.4247, instance_loss: 0.3284, weighted_loss: 0.3958, label: 1, bag_size: 1402
batch 359, loss: 0.0277, instance_loss: 0.2895, weighted_loss: 0.1063, label: 0, bag_size: 118
batch 379, loss: 0.1751, instance_loss: 0.2628, weighted_loss: 0.2014, label: 0, bag_size: 1061
batch 399, loss: 0.4751, instance_loss: 0.3710, weighted_loss: 0.4439, label: 1, bag_size: 1724
batch 419, loss: 0.3078, instance_loss: 0.3400, weighted_loss: 0.3174, label: 2, bag_size: 1141
batch 439, loss: 0.1355, instance_loss: 0.2280, weighted_loss: 0.1633, label: 0, bag_size: 350
batch 459, loss: 0.0299, instance_loss: 0.0828, weighted_loss: 0.0458, label: 1, bag_size: 636
batch 479, loss: 0.7186, instance_loss: 0.6526, weighted_loss: 0.6988, label: 1, bag_size: 867
batch 499, loss: 0.0017, instance_loss: 0.1049, weighted_loss: 0.0327, label: 4, bag_size: 35
batch 519, loss: 0.6072, instance_loss: 0.4920, weighted_loss: 0.5727, label: 1, bag_size: 861
batch 539, loss: 0.0498, instance_loss: 0.1191, weighted_loss: 0.0706, label: 1, bag_size: 944


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.4688073394495413: correct 2044/4360
Epoch: 21, train_loss: 0.3131, train_clustering_loss:  0.2789, train_error: 0.1119
class 0: acc 0.9166666666666666, correct 99/108
class 1: acc 0.7946428571428571, correct 89/112
class 2: acc 0.8135593220338984, correct 96/118
class 3: acc 0.95, correct 95/100
class 4: acc 0.9813084112149533, correct 105/107

Val Set, val_loss: 0.8114, val_error: 0.2600, auc: 0.9192
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0153, instance_loss: 0.0683, weighted_loss: 0.0312, label: 1, bag_size: 636
batch 39, loss: 0.0041, instance_loss: 0.1808, weighted_loss: 0.0571, label: 4, bag_size: 20
batch 59, loss: 0.0034, instance_loss: 0.0650, weighted_loss: 0.0219, label: 3, bag_size: 29
batch 79, loss: 0.1148, instance_loss: 0.2027, weighted_loss: 0.1412, label: 1, bag_size: 504
batch 99, loss: 0.0010, instance_loss: 0.0186, weighted_loss: 0.0063, label: 4, bag_size: 157
batch 119, loss: 0.3968, instance_loss: 0.4100, weighted_loss: 0.4008, label: 1, bag_size: 1646
batch 139, loss: 0.2192, instance_loss: 0.6378, weighted_loss: 0.3448, label: 0, bag_size: 176
batch 159, loss: 0.0070, instance_loss: 0.1002, weighted_loss: 0.0349, label: 3, bag_size: 75
batch 179, loss: 0.0019, instance_loss: 0.0504, weighted_loss: 0.0165, label: 4, bag_size: 160
batch 199, loss: 0.4357, instance_loss: 0.3283, weighted_loss: 0.4035, label: 2, bag_size: 828
batch 219, loss: 0.4406, instance_loss: 0.8463, weighted_loss: 0.5623, label: 3, bag_size: 211
batch 239, loss: 0.1262, instance_loss: 0.3656, weighted_loss: 0.1980, label: 3, bag_size: 697
batch 259, loss: 0.0067, instance_loss: 0.0527, weighted_loss: 0.0205, label: 4, bag_size: 137
batch 279, loss: 2.0049, instance_loss: 0.6482, weighted_loss: 1.5979, label: 1, bag_size: 470
batch 299, loss: 0.1906, instance_loss: 0.2712, weighted_loss: 0.2148, label: 2, bag_size: 358
batch 319, loss: 0.0169, instance_loss: 0.1131, weighted_loss: 0.0458, label: 3, bag_size: 451
batch 339, loss: 0.5593, instance_loss: 0.5403, weighted_loss: 0.5536, label: 3, bag_size: 343
batch 359, loss: 0.2686, instance_loss: 0.3253, weighted_loss: 0.2856, label: 4, bag_size: 826
batch 379, loss: 3.3159, instance_loss: 1.0552, weighted_loss: 2.6377, label: 1, bag_size: 1799
batch 399, loss: 1.4748, instance_loss: 0.5697, weighted_loss: 1.2033, label: 0, bag_size: 423
batch 419, loss: 1.1128, instance_loss: 0.3493, weighted_loss: 0.8837, label: 2, bag_size: 1180
batch 439, loss: 0.4113, instance_loss: 0.3137, weighted_loss: 0.3820, label: 2, bag_size: 373
batch 459, loss: 0.0090, instance_loss: 0.0266, weighted_loss: 0.0142, label: 4, bag_size: 137
batch 479, loss: 2.0184, instance_loss: 0.5850, weighted_loss: 1.5884, label: 2, bag_size: 120
batch 499, loss: 0.0702, instance_loss: 0.1653, weighted_loss: 0.0987, label: 2, bag_size: 461
batch 519, loss: 0.1101, instance_loss: 0.1827, weighted_loss: 0.1319, label: 0, bag_size: 515
batch 539, loss: 0.0298, instance_loss: 0.2244, weighted_loss: 0.0882, label: 0, bag_size: 524


class 0 clustering acc 0.9862385321100917: correct 21500/21800
class 1 clustering acc 0.46559633027522934: correct 2030/4360
Epoch: 22, train_loss: 0.3295, train_clustering_loss:  0.2866, train_error: 0.1046
class 0: acc 0.9259259259259259, correct 100/108
class 1: acc 0.8125, correct 91/112
class 2: acc 0.8571428571428571, correct 102/119
class 3: acc 0.9313725490196079, correct 95/102
class 4: acc 0.9615384615384616, correct 100/104

Val Set, val_loss: 0.8270, val_error: 0.2600, auc: 0.9215
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.36: correct 144/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0040, instance_loss: 0.5103, weighted_loss: 0.1559, label: 3, bag_size: 16
batch 39, loss: 0.0303, instance_loss: 0.3021, weighted_loss: 0.1118, label: 0, bag_size: 176
batch 59, loss: 0.0144, instance_loss: 0.1696, weighted_loss: 0.0610, label: 0, bag_size: 524
batch 79, loss: 0.0065, instance_loss: 0.1702, weighted_loss: 0.0556, label: 4, bag_size: 44
batch 99, loss: 0.0626, instance_loss: 0.1164, weighted_loss: 0.0787, label: 0, bag_size: 1190
batch 119, loss: 0.8857, instance_loss: 0.6744, weighted_loss: 0.8223, label: 2, bag_size: 803
batch 139, loss: 0.0006, instance_loss: 0.1152, weighted_loss: 0.0349, label: 3, bag_size: 26
batch 159, loss: 0.0605, instance_loss: 0.3180, weighted_loss: 0.1378, label: 0, bag_size: 1332
batch 179, loss: 0.2697, instance_loss: 0.5141, weighted_loss: 0.3430, label: 2, bag_size: 766
batch 199, loss: 0.1161, instance_loss: 0.4688, weighted_loss: 0.2219, label: 1, bag_size: 778
batch 219, loss: 0.1553, instance_loss: 0.3258, weighted_loss: 0.2064, label: 2, bag_size: 237
batch 239, loss: 0.1369, instance_loss: 0.5078, weighted_loss: 0.2482, label: 0, bag_size: 122
batch 259, loss: 0.8351, instance_loss: 0.3610, weighted_loss: 0.6929, label: 1, bag_size: 1724
batch 279, loss: 0.0294, instance_loss: 0.1273, weighted_loss: 0.0588, label: 0, bag_size: 1133
batch 299, loss: 0.0026, instance_loss: 0.2886, weighted_loss: 0.0884, label: 4, bag_size: 17
batch 319, loss: 0.0985, instance_loss: 0.2461, weighted_loss: 0.1428, label: 1, bag_size: 1144
batch 339, loss: 0.0399, instance_loss: 0.1494, weighted_loss: 0.0727, label: 3, bag_size: 28
batch 359, loss: 1.2247, instance_loss: 0.5248, weighted_loss: 1.0147, label: 2, bag_size: 738
batch 379, loss: 0.0263, instance_loss: 0.9178, weighted_loss: 0.2937, label: 3, bag_size: 1167
batch 399, loss: 0.2912, instance_loss: 0.2597, weighted_loss: 0.2817, label: 2, bag_size: 1259
batch 419, loss: 0.1450, instance_loss: 0.2444, weighted_loss: 0.1748, label: 2, bag_size: 828
batch 439, loss: 0.0167, instance_loss: 0.1012, weighted_loss: 0.0421, label: 0, bag_size: 1143
batch 459, loss: 0.0164, instance_loss: 0.0715, weighted_loss: 0.0329, label: 0, bag_size: 413
batch 479, loss: 0.0023, instance_loss: 0.0146, weighted_loss: 0.0060, label: 4, bag_size: 157
batch 499, loss: 0.2473, instance_loss: 0.3468, weighted_loss: 0.2771, label: 2, bag_size: 941
batch 519, loss: 0.0043, instance_loss: 0.0115, weighted_loss: 0.0064, label: 4, bag_size: 137
batch 539, loss: 0.0013, instance_loss: 0.0450, weighted_loss: 0.0144, label: 4, bag_size: 130


class 0 clustering acc 0.9898165137614678: correct 21578/21800
class 1 clustering acc 0.4841743119266055: correct 2111/4360
Epoch: 23, train_loss: 0.2952, train_clustering_loss:  0.2784, train_error: 0.0972
class 0: acc 0.9262295081967213, correct 113/122
class 1: acc 0.7981651376146789, correct 87/109
class 2: acc 0.8469387755102041, correct 83/98
class 3: acc 0.9724770642201835, correct 106/109
class 4: acc 0.9626168224299065, correct 103/107

Val Set, val_loss: 0.7269, val_error: 0.2600, auc: 0.9278
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.36: correct 144/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1079, instance_loss: 0.2398, weighted_loss: 0.1475, label: 4, bag_size: 19
batch 39, loss: 0.0727, instance_loss: 0.2591, weighted_loss: 0.1287, label: 4, bag_size: 20
batch 59, loss: 0.3824, instance_loss: 0.2896, weighted_loss: 0.3546, label: 2, bag_size: 373
batch 79, loss: 0.6456, instance_loss: 0.4132, weighted_loss: 0.5759, label: 2, bag_size: 839
batch 99, loss: 0.2191, instance_loss: 0.4321, weighted_loss: 0.2830, label: 2, bag_size: 1047
batch 119, loss: 0.0882, instance_loss: 0.2960, weighted_loss: 0.1505, label: 2, bag_size: 600
batch 139, loss: 0.1695, instance_loss: 0.3496, weighted_loss: 0.2236, label: 1, bag_size: 442
batch 159, loss: 0.0305, instance_loss: 0.1849, weighted_loss: 0.0768, label: 1, bag_size: 598
batch 179, loss: 0.0050, instance_loss: 0.2886, weighted_loss: 0.0901, label: 4, bag_size: 19
batch 199, loss: 0.0158, instance_loss: 0.2677, weighted_loss: 0.0914, label: 0, bag_size: 1101
batch 219, loss: 0.0039, instance_loss: 0.0238, weighted_loss: 0.0099, label: 4, bag_size: 78
batch 239, loss: 0.0328, instance_loss: 0.1557, weighted_loss: 0.0696, label: 0, bag_size: 367
batch 259, loss: 0.0155, instance_loss: 0.0620, weighted_loss: 0.0295, label: 4, bag_size: 94
batch 279, loss: 0.2232, instance_loss: 0.4153, weighted_loss: 0.2809, label: 4, bag_size: 974
batch 299, loss: 0.0010, instance_loss: 0.0336, weighted_loss: 0.0108, label: 4, bag_size: 104
batch 319, loss: 0.1432, instance_loss: 0.3415, weighted_loss: 0.2027, label: 2, bag_size: 278
batch 339, loss: 0.0083, instance_loss: 0.0495, weighted_loss: 0.0207, label: 4, bag_size: 162
batch 359, loss: 0.3978, instance_loss: 0.4292, weighted_loss: 0.4072, label: 2, bag_size: 373
batch 379, loss: 0.0035, instance_loss: 0.0186, weighted_loss: 0.0080, label: 4, bag_size: 182
batch 399, loss: 0.0061, instance_loss: 0.0391, weighted_loss: 0.0160, label: 4, bag_size: 119
batch 419, loss: 0.2727, instance_loss: 0.1918, weighted_loss: 0.2484, label: 1, bag_size: 690
batch 439, loss: 0.2123, instance_loss: 0.2922, weighted_loss: 0.2363, label: 0, bag_size: 756
batch 459, loss: 0.0880, instance_loss: 0.3614, weighted_loss: 0.1700, label: 2, bag_size: 766
batch 479, loss: 0.0132, instance_loss: 0.1941, weighted_loss: 0.0675, label: 4, bag_size: 24
batch 499, loss: 0.0338, instance_loss: 0.2969, weighted_loss: 0.1127, label: 1, bag_size: 818
batch 519, loss: 0.2472, instance_loss: 0.4337, weighted_loss: 0.3031, label: 0, bag_size: 718
batch 539, loss: 2.6524, instance_loss: 0.7855, weighted_loss: 2.0924, label: 2, bag_size: 1043


class 0 clustering acc 0.9894495412844037: correct 21570/21800
class 1 clustering acc 0.4738532110091743: correct 2066/4360
Epoch: 24, train_loss: 0.2972, train_clustering_loss:  0.2812, train_error: 0.0991
class 0: acc 0.9523809523809523, correct 100/105
class 1: acc 0.8, correct 96/120
class 2: acc 0.875, correct 98/112
class 3: acc 0.9108910891089109, correct 92/101
class 4: acc 0.9813084112149533, correct 105/107

Val Set, val_loss: 0.7373, val_error: 0.2400, auc: 0.9335
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.3825: correct 153/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.6076, instance_loss: 0.4395, weighted_loss: 0.5571, label: 1, bag_size: 700
batch 39, loss: 0.0641, instance_loss: 0.1449, weighted_loss: 0.0883, label: 4, bag_size: 38
batch 59, loss: 0.0011, instance_loss: 0.0769, weighted_loss: 0.0238, label: 3, bag_size: 46
batch 79, loss: 0.0349, instance_loss: 0.5534, weighted_loss: 0.1904, label: 4, bag_size: 823
batch 99, loss: 0.0572, instance_loss: 0.4199, weighted_loss: 0.1660, label: 4, bag_size: 1278
batch 119, loss: 0.0763, instance_loss: 0.1308, weighted_loss: 0.0927, label: 1, bag_size: 1325
batch 139, loss: 0.0068, instance_loss: 0.2290, weighted_loss: 0.0735, label: 3, bag_size: 16
batch 159, loss: 0.0030, instance_loss: 0.2398, weighted_loss: 0.0740, label: 3, bag_size: 18
batch 179, loss: 1.9039, instance_loss: 0.6355, weighted_loss: 1.5234, label: 1, bag_size: 448
batch 199, loss: 0.1073, instance_loss: 0.1374, weighted_loss: 0.1163, label: 0, bag_size: 1579
batch 219, loss: 0.3247, instance_loss: 0.3690, weighted_loss: 0.3380, label: 1, bag_size: 648
batch 239, loss: 0.3099, instance_loss: 0.3178, weighted_loss: 0.3123, label: 1, bag_size: 1014
batch 259, loss: 0.1789, instance_loss: 0.5123, weighted_loss: 0.2789, label: 2, bag_size: 1119
batch 279, loss: 0.1343, instance_loss: 0.2265, weighted_loss: 0.1620, label: 4, bag_size: 20
batch 299, loss: 0.0485, instance_loss: 0.2099, weighted_loss: 0.0969, label: 3, bag_size: 849
batch 319, loss: 0.0438, instance_loss: 0.1966, weighted_loss: 0.0897, label: 0, bag_size: 1174
batch 339, loss: 0.0150, instance_loss: 0.0626, weighted_loss: 0.0293, label: 3, bag_size: 54
batch 359, loss: 0.0361, instance_loss: 0.0607, weighted_loss: 0.0435, label: 0, bag_size: 756
batch 379, loss: 0.6271, instance_loss: 0.3945, weighted_loss: 0.5573, label: 0, bag_size: 818
batch 399, loss: 0.4628, instance_loss: 0.3095, weighted_loss: 0.4168, label: 2, bag_size: 461
batch 419, loss: 0.3214, instance_loss: 0.3890, weighted_loss: 0.3416, label: 0, bag_size: 1527
batch 439, loss: 0.1217, instance_loss: 0.2990, weighted_loss: 0.1749, label: 2, bag_size: 399
batch 459, loss: 0.3303, instance_loss: 0.5257, weighted_loss: 0.3889, label: 1, bag_size: 917
batch 479, loss: 0.1554, instance_loss: 0.4113, weighted_loss: 0.2322, label: 2, bag_size: 248
batch 499, loss: 0.0210, instance_loss: 0.1895, weighted_loss: 0.0716, label: 1, bag_size: 925
batch 519, loss: 0.0054, instance_loss: 0.0484, weighted_loss: 0.0183, label: 3, bag_size: 55
batch 539, loss: 0.1222, instance_loss: 0.3639, weighted_loss: 0.1947, label: 2, bag_size: 358


class 0 clustering acc 0.9894036697247707: correct 21569/21800
class 1 clustering acc 0.5084862385321101: correct 2217/4360
Epoch: 25, train_loss: 0.2463, train_clustering_loss:  0.2637, train_error: 0.0844
class 0: acc 0.9509803921568627, correct 97/102
class 1: acc 0.8275862068965517, correct 96/116
class 2: acc 0.8210526315789474, correct 78/95
class 3: acc 0.9622641509433962, correct 102/106
class 4: acc 1.0, correct 126/126

Val Set, val_loss: 0.9296, val_error: 0.2400, auc: 0.9109
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.4175: correct 167/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0776, instance_loss: 0.6659, weighted_loss: 0.2541, label: 4, bag_size: 754
batch 39, loss: 0.2501, instance_loss: 0.4255, weighted_loss: 0.3028, label: 3, bag_size: 1118
batch 59, loss: 0.0824, instance_loss: 0.2146, weighted_loss: 0.1221, label: 2, bag_size: 1410
batch 79, loss: 1.3850, instance_loss: 0.8255, weighted_loss: 1.2172, label: 2, bag_size: 1231
batch 99, loss: 0.9406, instance_loss: 0.5155, weighted_loss: 0.8131, label: 0, bag_size: 1527
batch 119, loss: 0.0331, instance_loss: 0.0635, weighted_loss: 0.0422, label: 0, bag_size: 1872
batch 139, loss: 0.0423, instance_loss: 0.1064, weighted_loss: 0.0616, label: 3, bag_size: 405
batch 159, loss: 0.3094, instance_loss: 0.2907, weighted_loss: 0.3038, label: 2, bag_size: 1024
batch 179, loss: 1.3899, instance_loss: 0.5776, weighted_loss: 1.1462, label: 1, bag_size: 875
batch 199, loss: 0.0052, instance_loss: 0.1006, weighted_loss: 0.0338, label: 0, bag_size: 976
batch 219, loss: 0.0149, instance_loss: 0.0758, weighted_loss: 0.0331, label: 3, bag_size: 54
batch 239, loss: 0.1857, instance_loss: 0.1531, weighted_loss: 0.1759, label: 1, bag_size: 288
batch 259, loss: 2.2576, instance_loss: 0.7190, weighted_loss: 1.7961, label: 3, bag_size: 607
batch 279, loss: 0.0605, instance_loss: 0.2902, weighted_loss: 0.1294, label: 3, bag_size: 697
batch 299, loss: 0.0006, instance_loss: 0.1002, weighted_loss: 0.0305, label: 3, bag_size: 50
batch 319, loss: 0.6514, instance_loss: 0.3992, weighted_loss: 0.5757, label: 1, bag_size: 535
batch 339, loss: 0.0504, instance_loss: 0.1415, weighted_loss: 0.0777, label: 1, bag_size: 534
batch 359, loss: 0.0013, instance_loss: 0.1613, weighted_loss: 0.0493, label: 3, bag_size: 34
batch 379, loss: 0.0699, instance_loss: 0.2496, weighted_loss: 0.1238, label: 4, bag_size: 24
batch 399, loss: 0.4960, instance_loss: 0.3958, weighted_loss: 0.4659, label: 2, bag_size: 684
batch 419, loss: 3.7898, instance_loss: 0.7155, weighted_loss: 2.8675, label: 2, bag_size: 194
batch 439, loss: 0.0448, instance_loss: 0.5189, weighted_loss: 0.1870, label: 1, bag_size: 1409
batch 459, loss: 0.2133, instance_loss: 0.2085, weighted_loss: 0.2118, label: 0, bag_size: 552
batch 479, loss: 0.3133, instance_loss: 0.2476, weighted_loss: 0.2936, label: 2, bag_size: 265
batch 499, loss: 0.8865, instance_loss: 0.5041, weighted_loss: 0.7718, label: 2, bag_size: 636
batch 519, loss: 0.0386, instance_loss: 0.6492, weighted_loss: 0.2218, label: 1, bag_size: 1409
batch 539, loss: 0.1437, instance_loss: 0.2480, weighted_loss: 0.1750, label: 0, bag_size: 200


class 0 clustering acc 0.9877522935779817: correct 21533/21800
class 1 clustering acc 0.5107798165137615: correct 2227/4360
Epoch: 26, train_loss: 0.2689, train_clustering_loss:  0.2708, train_error: 0.1083
class 0: acc 0.941747572815534, correct 97/103
class 1: acc 0.7863247863247863, correct 92/117
class 2: acc 0.8317757009345794, correct 89/107
class 3: acc 0.9607843137254902, correct 98/102
class 4: acc 0.9482758620689655, correct 110/116

Val Set, val_loss: 0.7016, val_error: 0.2400, auc: 0.9356
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.3575: correct 143/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0277, instance_loss: 0.2266, weighted_loss: 0.0874, label: 3, bag_size: 1253
batch 39, loss: 0.2265, instance_loss: 0.3797, weighted_loss: 0.2724, label: 4, bag_size: 826
batch 59, loss: 0.0534, instance_loss: 0.2334, weighted_loss: 0.1074, label: 2, bag_size: 461
batch 79, loss: 0.0013, instance_loss: 0.0794, weighted_loss: 0.0247, label: 4, bag_size: 174
batch 99, loss: 0.0139, instance_loss: 0.1604, weighted_loss: 0.0579, label: 4, bag_size: 20
batch 119, loss: 0.0643, instance_loss: 0.2423, weighted_loss: 0.1177, label: 0, bag_size: 800
batch 139, loss: 0.6751, instance_loss: 0.7952, weighted_loss: 0.7111, label: 2, bag_size: 373
batch 159, loss: 0.0837, instance_loss: 0.2302, weighted_loss: 0.1276, label: 2, bag_size: 499
batch 179, loss: 0.1599, instance_loss: 0.2723, weighted_loss: 0.1937, label: 3, bag_size: 697
batch 199, loss: 0.0003, instance_loss: 0.2930, weighted_loss: 0.0881, label: 3, bag_size: 16
batch 219, loss: 0.0179, instance_loss: 0.5687, weighted_loss: 0.1831, label: 3, bag_size: 281
batch 239, loss: 0.0024, instance_loss: 0.1006, weighted_loss: 0.0319, label: 3, bag_size: 18
batch 259, loss: 0.0805, instance_loss: 0.8761, weighted_loss: 0.3192, label: 4, bag_size: 436
batch 279, loss: 2.6114, instance_loss: 0.5973, weighted_loss: 2.0071, label: 0, bag_size: 245
batch 299, loss: 0.0001, instance_loss: 0.0296, weighted_loss: 0.0090, label: 3, bag_size: 32
batch 319, loss: 0.0112, instance_loss: 0.0948, weighted_loss: 0.0363, label: 0, bag_size: 515
batch 339, loss: 0.0856, instance_loss: 0.2609, weighted_loss: 0.1382, label: 0, bag_size: 255
batch 359, loss: 0.3198, instance_loss: 0.2449, weighted_loss: 0.2973, label: 1, bag_size: 1402
batch 379, loss: 0.0725, instance_loss: 0.1446, weighted_loss: 0.0941, label: 0, bag_size: 466
batch 399, loss: 0.6769, instance_loss: 0.4464, weighted_loss: 0.6077, label: 2, bag_size: 323
batch 419, loss: 0.0481, instance_loss: 0.1475, weighted_loss: 0.0780, label: 0, bag_size: 375
batch 439, loss: 0.3410, instance_loss: 0.3457, weighted_loss: 0.3424, label: 1, bag_size: 343
batch 459, loss: 0.0989, instance_loss: 0.1625, weighted_loss: 0.1179, label: 2, bag_size: 907
batch 479, loss: 0.0450, instance_loss: 0.2982, weighted_loss: 0.1210, label: 3, bag_size: 18
batch 499, loss: 0.1348, instance_loss: 0.3999, weighted_loss: 0.2143, label: 1, bag_size: 474
batch 519, loss: 0.0185, instance_loss: 0.3282, weighted_loss: 0.1114, label: 3, bag_size: 16
batch 539, loss: 0.4445, instance_loss: 0.3026, weighted_loss: 0.4019, label: 1, bag_size: 711


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.5087155963302752: correct 2218/4360
Epoch: 27, train_loss: 0.2301, train_clustering_loss:  0.2639, train_error: 0.0826
class 0: acc 0.95, correct 114/120
class 1: acc 0.8155339805825242, correct 84/103
class 2: acc 0.8869565217391304, correct 102/115
class 3: acc 0.954954954954955, correct 106/111
class 4: acc 0.9791666666666666, correct 94/96

Val Set, val_loss: 0.7547, val_error: 0.2800, auc: 0.9420
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.44: correct 176/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.6909, instance_loss: 0.5938, weighted_loss: 1.3618, label: 1, bag_size: 1197
batch 39, loss: 0.1859, instance_loss: 0.3470, weighted_loss: 0.2342, label: 1, bag_size: 1273
batch 59, loss: 0.0022, instance_loss: 0.0353, weighted_loss: 0.0121, label: 4, bag_size: 110
batch 79, loss: 0.0034, instance_loss: 0.0825, weighted_loss: 0.0272, label: 0, bag_size: 653
batch 99, loss: 0.0037, instance_loss: 0.0672, weighted_loss: 0.0228, label: 4, bag_size: 48
batch 119, loss: 0.0575, instance_loss: 0.4843, weighted_loss: 0.1855, label: 4, bag_size: 823
batch 139, loss: 0.0014, instance_loss: 0.3626, weighted_loss: 0.1098, label: 3, bag_size: 18
batch 159, loss: 1.1570, instance_loss: 0.5808, weighted_loss: 0.9841, label: 2, bag_size: 1231
batch 179, loss: 0.9923, instance_loss: 0.5096, weighted_loss: 0.8475, label: 0, bag_size: 736
batch 199, loss: 0.0113, instance_loss: 0.2645, weighted_loss: 0.0873, label: 4, bag_size: 354
batch 219, loss: 0.0846, instance_loss: 0.2318, weighted_loss: 0.1288, label: 0, bag_size: 163
batch 239, loss: 1.0349, instance_loss: 0.3946, weighted_loss: 0.8428, label: 0, bag_size: 245
batch 259, loss: 0.0032, instance_loss: 0.0440, weighted_loss: 0.0155, label: 0, bag_size: 933
batch 279, loss: 0.0362, instance_loss: 0.0989, weighted_loss: 0.0550, label: 3, bag_size: 29
batch 299, loss: 0.2282, instance_loss: 0.3110, weighted_loss: 0.2530, label: 2, bag_size: 471
batch 319, loss: 0.0610, instance_loss: 0.1973, weighted_loss: 0.1019, label: 0, bag_size: 437
batch 339, loss: 0.1608, instance_loss: 0.2631, weighted_loss: 0.1915, label: 0, bag_size: 962
batch 359, loss: 0.2653, instance_loss: 0.2243, weighted_loss: 0.2530, label: 1, bag_size: 399
batch 379, loss: 0.0053, instance_loss: 0.3612, weighted_loss: 0.1121, label: 3, bag_size: 706
batch 399, loss: 0.0933, instance_loss: 0.1706, weighted_loss: 0.1165, label: 1, bag_size: 938
batch 419, loss: 0.2945, instance_loss: 0.3221, weighted_loss: 0.3028, label: 2, bag_size: 1150
batch 439, loss: 0.2629, instance_loss: 0.2965, weighted_loss: 0.2730, label: 1, bag_size: 405
batch 459, loss: 0.0336, instance_loss: 0.2300, weighted_loss: 0.0925, label: 1, bag_size: 696
batch 479, loss: 0.0899, instance_loss: 0.1950, weighted_loss: 0.1214, label: 1, bag_size: 614
batch 499, loss: 0.0135, instance_loss: 0.0972, weighted_loss: 0.0386, label: 0, bag_size: 1872
batch 519, loss: 0.0213, instance_loss: 0.2546, weighted_loss: 0.0913, label: 4, bag_size: 542
batch 539, loss: 0.0054, instance_loss: 0.0382, weighted_loss: 0.0153, label: 3, bag_size: 1069


class 0 clustering acc 0.9888073394495412: correct 21556/21800
class 1 clustering acc 0.513302752293578: correct 2238/4360
Epoch: 28, train_loss: 0.1972, train_clustering_loss:  0.2639, train_error: 0.0697
class 0: acc 0.9196428571428571, correct 103/112
class 1: acc 0.897196261682243, correct 96/107
class 2: acc 0.8488372093023255, correct 73/86
class 3: acc 0.9724770642201835, correct 106/109
class 4: acc 0.9847328244274809, correct 129/131

Val Set, val_loss: 0.6464, val_error: 0.2200, auc: 0.9494
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.4: correct 160/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
Validation loss decreased (0.666186 --> 0.646389).  Saving model ...


batch 19, loss: 0.0301, instance_loss: 0.1829, weighted_loss: 0.0759, label: 2, bag_size: 470
batch 39, loss: 0.0102, instance_loss: 0.0875, weighted_loss: 0.0334, label: 1, bag_size: 790
batch 59, loss: 2.2500, instance_loss: 0.6421, weighted_loss: 1.7677, label: 1, bag_size: 700
batch 79, loss: 0.4529, instance_loss: 0.3696, weighted_loss: 0.4279, label: 3, bag_size: 630
batch 99, loss: 1.3034, instance_loss: 0.6218, weighted_loss: 1.0989, label: 1, bag_size: 660
batch 119, loss: 0.0198, instance_loss: 0.6192, weighted_loss: 0.1996, label: 1, bag_size: 657
batch 139, loss: 1.1788, instance_loss: 0.8456, weighted_loss: 1.0788, label: 1, bag_size: 917
batch 159, loss: 0.0072, instance_loss: 0.0581, weighted_loss: 0.0224, label: 4, bag_size: 78
batch 179, loss: 0.0001, instance_loss: 0.0821, weighted_loss: 0.0247, label: 3, bag_size: 18
batch 199, loss: 0.2858, instance_loss: 0.3133, weighted_loss: 0.2941, label: 2, bag_size: 1215
batch 219, loss: 0.0037, instance_loss: 0.2159, weighted_loss: 0.0674, label: 4, bag_size: 63
batch 239, loss: 0.0155, instance_loss: 0.1622, weighted_loss: 0.0595, label: 1, bag_size: 504
batch 259, loss: 2.0845, instance_loss: 0.6418, weighted_loss: 1.6517, label: 1, bag_size: 1172
batch 279, loss: 0.0806, instance_loss: 0.1852, weighted_loss: 0.1120, label: 1, bag_size: 348
batch 299, loss: 0.0032, instance_loss: 0.1519, weighted_loss: 0.0478, label: 3, bag_size: 28
batch 319, loss: 0.0002, instance_loss: 0.0229, weighted_loss: 0.0070, label: 4, bag_size: 110
batch 339, loss: 0.0134, instance_loss: 0.7063, weighted_loss: 0.2213, label: 4, bag_size: 882
batch 359, loss: 0.0081, instance_loss: 0.0452, weighted_loss: 0.0192, label: 3, bag_size: 105
batch 379, loss: 0.0306, instance_loss: 0.0410, weighted_loss: 0.0337, label: 3, bag_size: 87
batch 399, loss: 0.0043, instance_loss: 0.0739, weighted_loss: 0.0252, label: 0, bag_size: 521
batch 419, loss: 0.0010, instance_loss: 0.0554, weighted_loss: 0.0173, label: 3, bag_size: 143
batch 439, loss: 0.0020, instance_loss: 0.0494, weighted_loss: 0.0162, label: 4, bag_size: 63
batch 459, loss: 0.0040, instance_loss: 0.0405, weighted_loss: 0.0150, label: 4, bag_size: 147
batch 479, loss: 0.0392, instance_loss: 0.3501, weighted_loss: 0.1325, label: 0, bag_size: 143
batch 499, loss: 0.0196, instance_loss: 0.1228, weighted_loss: 0.0506, label: 0, bag_size: 552
batch 519, loss: 0.9293, instance_loss: 0.4821, weighted_loss: 0.7951, label: 2, bag_size: 1133
batch 539, loss: 1.2972, instance_loss: 0.4980, weighted_loss: 1.0575, label: 2, bag_size: 959


class 0 clustering acc 0.9860091743119266: correct 21495/21800
class 1 clustering acc 0.5270642201834862: correct 2298/4360
Epoch: 29, train_loss: 0.2254, train_clustering_loss:  0.2658, train_error: 0.0716
class 0: acc 0.945054945054945, correct 86/91
class 1: acc 0.865546218487395, correct 103/119
class 2: acc 0.8584905660377359, correct 91/106
class 3: acc 1.0, correct 109/109
class 4: acc 0.975, correct 117/120

Val Set, val_loss: 0.7438, val_error: 0.2600, auc: 0.9322
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.4575: correct 183/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0006, instance_loss: 0.0361, weighted_loss: 0.0113, label: 4, bag_size: 123
batch 39, loss: 0.2654, instance_loss: 0.2348, weighted_loss: 0.2562, label: 0, bag_size: 350
batch 59, loss: 0.2216, instance_loss: 0.5796, weighted_loss: 0.3290, label: 3, bag_size: 200
batch 79, loss: 0.1749, instance_loss: 0.3958, weighted_loss: 0.2412, label: 3, bag_size: 849
batch 99, loss: 0.0797, instance_loss: 0.2434, weighted_loss: 0.1288, label: 0, bag_size: 800
batch 119, loss: 0.0331, instance_loss: 0.1097, weighted_loss: 0.0561, label: 0, bag_size: 1301
batch 139, loss: 0.3411, instance_loss: 0.2295, weighted_loss: 0.3076, label: 2, bag_size: 391
batch 159, loss: 1.0178, instance_loss: 0.6153, weighted_loss: 0.8971, label: 4, bag_size: 511
batch 179, loss: 0.1741, instance_loss: 0.1711, weighted_loss: 0.1732, label: 1, bag_size: 858
batch 199, loss: 0.0326, instance_loss: 0.3661, weighted_loss: 0.1326, label: 2, bag_size: 525
batch 219, loss: 0.2774, instance_loss: 0.2381, weighted_loss: 0.2656, label: 3, bag_size: 1019
batch 239, loss: 0.5608, instance_loss: 0.3932, weighted_loss: 0.5106, label: 0, bag_size: 912
batch 259, loss: 0.0022, instance_loss: 0.0396, weighted_loss: 0.0134, label: 4, bag_size: 211
batch 279, loss: 0.1887, instance_loss: 0.4699, weighted_loss: 0.2731, label: 0, bag_size: 616
batch 299, loss: 0.0122, instance_loss: 0.0925, weighted_loss: 0.0363, label: 1, bag_size: 1426
batch 319, loss: 0.0251, instance_loss: 0.1715, weighted_loss: 0.0690, label: 0, bag_size: 552
batch 339, loss: 0.0031, instance_loss: 0.0341, weighted_loss: 0.0124, label: 0, bag_size: 518
batch 359, loss: 0.5606, instance_loss: 0.2249, weighted_loss: 0.4599, label: 4, bag_size: 134
batch 379, loss: 0.0000, instance_loss: 0.0093, weighted_loss: 0.0028, label: 4, bag_size: 130
batch 399, loss: 0.0125, instance_loss: 0.1477, weighted_loss: 0.0531, label: 4, bag_size: 656
batch 419, loss: 0.1387, instance_loss: 0.2950, weighted_loss: 0.1856, label: 0, bag_size: 338
batch 439, loss: 0.9179, instance_loss: 0.4903, weighted_loss: 0.7896, label: 2, bag_size: 271
batch 459, loss: 0.0156, instance_loss: 0.1345, weighted_loss: 0.0513, label: 0, bag_size: 921
batch 479, loss: 0.1395, instance_loss: 0.5099, weighted_loss: 0.2506, label: 1, bag_size: 648
batch 499, loss: 0.0173, instance_loss: 0.0929, weighted_loss: 0.0400, label: 0, bag_size: 552
batch 519, loss: 0.0346, instance_loss: 0.2921, weighted_loss: 0.1118, label: 0, bag_size: 118
batch 539, loss: 0.0061, instance_loss: 0.2871, weighted_loss: 0.0904, label: 3, bag_size: 23


class 0 clustering acc 0.9877064220183486: correct 21532/21800
class 1 clustering acc 0.5314220183486239: correct 2317/4360
Epoch: 30, train_loss: 0.2137, train_clustering_loss:  0.2616, train_error: 0.0697
class 0: acc 0.9734513274336283, correct 110/113
class 1: acc 0.83, correct 83/100
class 2: acc 0.8878504672897196, correct 95/107
class 3: acc 0.9826086956521739, correct 113/115
class 4: acc 0.9636363636363636, correct 106/110

Val Set, val_loss: 0.8549, val_error: 0.2600, auc: 0.9075
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.47: correct 188/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0065, instance_loss: 0.1305, weighted_loss: 0.0437, label: 2, bag_size: 913
batch 39, loss: 0.0407, instance_loss: 0.1773, weighted_loss: 0.0817, label: 4, bag_size: 636
batch 59, loss: 0.4305, instance_loss: 0.3246, weighted_loss: 0.3987, label: 0, bag_size: 962
batch 79, loss: 0.0601, instance_loss: 0.1635, weighted_loss: 0.0911, label: 2, bag_size: 404
batch 99, loss: 0.0014, instance_loss: 0.0457, weighted_loss: 0.0147, label: 3, bag_size: 66
batch 119, loss: 0.0395, instance_loss: 0.1526, weighted_loss: 0.0734, label: 1, bag_size: 903
batch 139, loss: 0.0061, instance_loss: 0.2954, weighted_loss: 0.0929, label: 4, bag_size: 23
batch 159, loss: 1.8398, instance_loss: 0.7340, weighted_loss: 1.5080, label: 1, bag_size: 1376
batch 179, loss: 0.0725, instance_loss: 0.0907, weighted_loss: 0.0780, label: 1, bag_size: 690
batch 199, loss: 0.2417, instance_loss: 0.3346, weighted_loss: 0.2696, label: 0, bag_size: 424
batch 219, loss: 0.0039, instance_loss: 0.0657, weighted_loss: 0.0225, label: 1, bag_size: 1239
batch 239, loss: 0.0012, instance_loss: 0.0796, weighted_loss: 0.0247, label: 4, bag_size: 44
batch 259, loss: 0.0537, instance_loss: 0.1397, weighted_loss: 0.0795, label: 2, bag_size: 270
batch 279, loss: 0.0677, instance_loss: 0.3601, weighted_loss: 0.1554, label: 0, bag_size: 110
batch 299, loss: 0.0505, instance_loss: 0.0695, weighted_loss: 0.0562, label: 3, bag_size: 1399
batch 319, loss: 0.0976, instance_loss: 0.3351, weighted_loss: 0.1689, label: 3, bag_size: 317
batch 339, loss: 0.0061, instance_loss: 0.0969, weighted_loss: 0.0333, label: 4, bag_size: 38
batch 359, loss: 0.0143, instance_loss: 0.2985, weighted_loss: 0.0996, label: 4, bag_size: 354
batch 379, loss: 0.0037, instance_loss: 0.0248, weighted_loss: 0.0100, label: 0, bag_size: 518
batch 399, loss: 0.1066, instance_loss: 0.3836, weighted_loss: 0.1897, label: 3, bag_size: 841
batch 419, loss: 0.9060, instance_loss: 0.5572, weighted_loss: 0.8013, label: 1, bag_size: 1376
batch 439, loss: 0.0003, instance_loss: 0.2339, weighted_loss: 0.0703, label: 3, bag_size: 18
batch 459, loss: 0.0022, instance_loss: 0.0660, weighted_loss: 0.0213, label: 0, bag_size: 1174
batch 479, loss: 0.5673, instance_loss: 0.3439, weighted_loss: 0.5003, label: 4, bag_size: 24
batch 499, loss: 0.0039, instance_loss: 0.0892, weighted_loss: 0.0295, label: 4, bag_size: 764
batch 519, loss: 0.0437, instance_loss: 0.1887, weighted_loss: 0.0872, label: 0, bag_size: 653
batch 539, loss: 0.0571, instance_loss: 0.6129, weighted_loss: 0.2238, label: 4, bag_size: 754


class 0 clustering acc 0.9860550458715597: correct 21496/21800
class 1 clustering acc 0.5376146788990825: correct 2344/4360
Epoch: 31, train_loss: 0.2121, train_clustering_loss:  0.2655, train_error: 0.0679
class 0: acc 0.9473684210526315, correct 108/114
class 1: acc 0.8316831683168316, correct 84/101
class 2: acc 0.8928571428571429, correct 100/112
class 3: acc 0.9908256880733946, correct 108/109
class 4: acc 0.9908256880733946, correct 108/109

Val Set, val_loss: 0.9327, val_error: 0.2400, auc: 0.9221
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.3625: correct 145/400
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0008, instance_loss: 0.0355, weighted_loss: 0.0112, label: 4, bag_size: 182
batch 39, loss: 0.5618, instance_loss: 0.5849, weighted_loss: 0.5687, label: 0, bag_size: 1065
batch 59, loss: 0.0073, instance_loss: 0.2285, weighted_loss: 0.0736, label: 3, bag_size: 28
batch 79, loss: 0.0585, instance_loss: 0.2827, weighted_loss: 0.1257, label: 0, bag_size: 515
batch 99, loss: 1.9818, instance_loss: 0.5776, weighted_loss: 1.5606, label: 2, bag_size: 878
batch 119, loss: 0.1884, instance_loss: 0.5972, weighted_loss: 0.3110, label: 1, bag_size: 386
batch 139, loss: 2.0296, instance_loss: 0.6473, weighted_loss: 1.6149, label: 4, bag_size: 366
batch 159, loss: 2.8752, instance_loss: 0.8672, weighted_loss: 2.2728, label: 2, bag_size: 194
batch 179, loss: 0.0804, instance_loss: 0.2171, weighted_loss: 0.1214, label: 0, bag_size: 524
batch 199, loss: 0.1006, instance_loss: 0.2062, weighted_loss: 0.1323, label: 0, bag_size: 424
batch 219, loss: 0.0000, instance_loss: 0.0664, weighted_loss: 0.0200, label: 3, bag_size: 37
batch 239, loss: 0.2065, instance_loss: 0.5008, weighted_loss: 0.2948, label: 2, bag_size: 777
batch 259, loss: 1.4592, instance_loss: 0.4800, weighted_loss: 1.1655, label: 3, bag_size: 305
batch 279, loss: 0.0083, instance_loss: 0.1873, weighted_loss: 0.0620, label: 1, bag_size: 866
batch 299, loss: 0.0004, instance_loss: 0.0220, weighted_loss: 0.0068, label: 4, bag_size: 211
batch 319, loss: 0.0003, instance_loss: 0.1113, weighted_loss: 0.0336, label: 3, bag_size: 18
batch 339, loss: 0.0007, instance_loss: 0.2998, weighted_loss: 0.0904, label: 4, bag_size: 24
batch 359, loss: 0.0007, instance_loss: 0.0542, weighted_loss: 0.0167, label: 4, bag_size: 48
batch 379, loss: 0.0865, instance_loss: 0.3235, weighted_loss: 0.1576, label: 2, bag_size: 355
batch 399, loss: 0.1324, instance_loss: 0.2637, weighted_loss: 0.1718, label: 3, bag_size: 630
batch 419, loss: 0.0067, instance_loss: 0.0990, weighted_loss: 0.0344, label: 0, bag_size: 1018
batch 439, loss: 0.0099, instance_loss: 0.2562, weighted_loss: 0.0838, label: 0, bag_size: 116
batch 459, loss: 0.4443, instance_loss: 0.3658, weighted_loss: 0.4207, label: 2, bag_size: 679
batch 479, loss: 0.1559, instance_loss: 0.5622, weighted_loss: 0.2778, label: 1, bag_size: 648
batch 499, loss: 0.0059, instance_loss: 0.1339, weighted_loss: 0.0443, label: 1, bag_size: 790
batch 519, loss: 0.0039, instance_loss: 0.0371, weighted_loss: 0.0139, label: 1, bag_size: 286
batch 539, loss: 0.0202, instance_loss: 0.0518, weighted_loss: 0.0297, label: 3, bag_size: 451


class 0 clustering acc 0.9877522935779817: correct 21533/21800
class 1 clustering acc 0.5245412844036698: correct 2287/4360
Epoch: 32, train_loss: 0.2012, train_clustering_loss:  0.2630, train_error: 0.0661
class 0: acc 0.9655172413793104, correct 112/116
class 1: acc 0.8365384615384616, correct 87/104
class 2: acc 0.8804347826086957, correct 81/92
class 3: acc 0.9922480620155039, correct 128/129
class 4: acc 0.9711538461538461, correct 101/104

Val Set, val_loss: 0.8305, val_error: 0.2000, auc: 0.9235
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.435: correct 174/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0274, weighted_loss: 0.0085, label: 4, bag_size: 790
batch 39, loss: 0.4052, instance_loss: 0.7531, weighted_loss: 0.5096, label: 1, bag_size: 293
batch 59, loss: 0.1486, instance_loss: 0.2655, weighted_loss: 0.1837, label: 2, bag_size: 1235
batch 79, loss: 0.6150, instance_loss: 0.5476, weighted_loss: 0.5948, label: 0, bag_size: 1527
batch 99, loss: 0.0004, instance_loss: 0.0433, weighted_loss: 0.0133, label: 4, bag_size: 128
batch 119, loss: 0.2190, instance_loss: 0.2638, weighted_loss: 0.2325, label: 2, bag_size: 286
batch 139, loss: 0.4350, instance_loss: 0.4009, weighted_loss: 0.4248, label: 2, bag_size: 1024
batch 159, loss: 0.0460, instance_loss: 0.2758, weighted_loss: 0.1150, label: 3, bag_size: 849
batch 179, loss: 0.0124, instance_loss: 0.1111, weighted_loss: 0.0420, label: 0, bag_size: 602
batch 199, loss: 0.0505, instance_loss: 0.5644, weighted_loss: 0.2047, label: 2, bag_size: 766
batch 219, loss: 1.2021, instance_loss: 0.5701, weighted_loss: 1.0125, label: 1, bag_size: 770
batch 239, loss: 0.0162, instance_loss: 0.1302, weighted_loss: 0.0504, label: 0, bag_size: 552
batch 259, loss: 0.1316, instance_loss: 0.5597, weighted_loss: 0.2600, label: 0, bag_size: 255
batch 279, loss: 0.1324, instance_loss: 0.2732, weighted_loss: 0.1746, label: 1, bag_size: 700
batch 299, loss: 0.9065, instance_loss: 0.5344, weighted_loss: 0.7949, label: 1, bag_size: 470
batch 319, loss: 0.0118, instance_loss: 0.1866, weighted_loss: 0.0642, label: 0, bag_size: 120
batch 339, loss: 0.3363, instance_loss: 0.7547, weighted_loss: 0.4618, label: 3, bag_size: 211
batch 359, loss: 0.0004, instance_loss: 0.0841, weighted_loss: 0.0255, label: 4, bag_size: 47
batch 379, loss: 0.0016, instance_loss: 0.0779, weighted_loss: 0.0245, label: 3, bag_size: 35
batch 399, loss: 0.0018, instance_loss: 0.0341, weighted_loss: 0.0115, label: 3, bag_size: 123
batch 419, loss: 0.1668, instance_loss: 0.4925, weighted_loss: 0.2645, label: 0, bag_size: 432
batch 439, loss: 0.0005, instance_loss: 0.0321, weighted_loss: 0.0100, label: 4, bag_size: 107
batch 459, loss: 0.3756, instance_loss: 0.5244, weighted_loss: 0.4203, label: 2, bag_size: 1150
batch 479, loss: 0.0044, instance_loss: 0.0411, weighted_loss: 0.0154, label: 3, bag_size: 123
batch 499, loss: 0.2202, instance_loss: 0.2645, weighted_loss: 0.2335, label: 2, bag_size: 1378
batch 519, loss: 0.0002, instance_loss: 0.7599, weighted_loss: 0.2281, label: 4, bag_size: 436
batch 539, loss: 0.0003, instance_loss: 0.0305, weighted_loss: 0.0094, label: 4, bag_size: 43


class 0 clustering acc 0.9871559633027523: correct 21520/21800
class 1 clustering acc 0.539908256880734: correct 2354/4360
Epoch: 33, train_loss: 0.1944, train_clustering_loss:  0.2606, train_error: 0.0697
class 0: acc 0.978494623655914, correct 91/93
class 1: acc 0.8113207547169812, correct 86/106
class 2: acc 0.8636363636363636, correct 95/110
class 3: acc 0.9921875, correct 127/128
class 4: acc 1.0, correct 108/108

Val Set, val_loss: 0.9371, val_error: 0.2600, auc: 0.9127
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.4175: correct 167/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0006, instance_loss: 0.1239, weighted_loss: 0.0376, label: 3, bag_size: 18
batch 39, loss: 0.0001, instance_loss: 0.0763, weighted_loss: 0.0229, label: 3, bag_size: 21
batch 59, loss: 0.5167, instance_loss: 0.6310, weighted_loss: 0.5510, label: 2, bag_size: 1043
batch 79, loss: 0.0064, instance_loss: 0.0943, weighted_loss: 0.0328, label: 1, bag_size: 834
batch 99, loss: 1.5576, instance_loss: 0.4655, weighted_loss: 1.2300, label: 1, bag_size: 435
batch 119, loss: 0.0581, instance_loss: 0.2952, weighted_loss: 0.1292, label: 0, bag_size: 255
batch 139, loss: 0.0006, instance_loss: 0.0281, weighted_loss: 0.0088, label: 4, bag_size: 72
batch 159, loss: 0.0000, instance_loss: 0.0202, weighted_loss: 0.0061, label: 4, bag_size: 140
batch 179, loss: 0.4463, instance_loss: 0.3321, weighted_loss: 0.4120, label: 1, bag_size: 348
batch 199, loss: 0.0309, instance_loss: 0.0960, weighted_loss: 0.0504, label: 4, bag_size: 147
batch 219, loss: 0.0293, instance_loss: 0.1847, weighted_loss: 0.0760, label: 4, bag_size: 168
batch 239, loss: 0.0776, instance_loss: 0.1908, weighted_loss: 0.1116, label: 2, bag_size: 1019
batch 259, loss: 0.0019, instance_loss: 0.0445, weighted_loss: 0.0146, label: 3, bag_size: 28
batch 279, loss: 0.0001, instance_loss: 0.0133, weighted_loss: 0.0041, label: 4, bag_size: 130
batch 299, loss: 0.8220, instance_loss: 0.6083, weighted_loss: 0.7579, label: 2, bag_size: 589
batch 319, loss: 0.4190, instance_loss: 0.3412, weighted_loss: 0.3956, label: 2, bag_size: 265
batch 339, loss: 0.0999, instance_loss: 0.3042, weighted_loss: 0.1612, label: 0, bag_size: 1527
batch 359, loss: 0.0230, instance_loss: 0.1084, weighted_loss: 0.0486, label: 0, bag_size: 1143
batch 379, loss: 0.0538, instance_loss: 0.2606, weighted_loss: 0.1159, label: 2, bag_size: 461
batch 399, loss: 0.0002, instance_loss: 0.0449, weighted_loss: 0.0136, label: 3, bag_size: 37
batch 419, loss: 0.2269, instance_loss: 0.4659, weighted_loss: 0.2986, label: 2, bag_size: 638
batch 439, loss: 0.0054, instance_loss: 0.1251, weighted_loss: 0.0413, label: 1, bag_size: 1239
batch 459, loss: 0.4429, instance_loss: 0.6138, weighted_loss: 0.4942, label: 1, bag_size: 474
batch 479, loss: 0.0053, instance_loss: 0.0572, weighted_loss: 0.0208, label: 0, bag_size: 367
batch 499, loss: 0.3133, instance_loss: 0.5442, weighted_loss: 0.3826, label: 0, bag_size: 122
batch 519, loss: 0.0081, instance_loss: 0.0614, weighted_loss: 0.0241, label: 4, bag_size: 51
batch 539, loss: 0.0193, instance_loss: 0.1684, weighted_loss: 0.0640, label: 0, bag_size: 148


class 0 clustering acc 0.9868348623853211: correct 21513/21800
class 1 clustering acc 0.5403669724770642: correct 2356/4360
Epoch: 34, train_loss: 0.1928, train_clustering_loss:  0.2563, train_error: 0.0679
class 0: acc 0.9724770642201835, correct 106/109
class 1: acc 0.84375, correct 81/96
class 2: acc 0.8761061946902655, correct 99/113
class 3: acc 1.0, correct 111/111
class 4: acc 0.9568965517241379, correct 111/116

Val Set, val_loss: 0.8769, val_error: 0.2000, auc: 0.9104
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.405: correct 162/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.1935, instance_loss: 0.4917, weighted_loss: 0.9830, label: 2, bag_size: 345
batch 39, loss: 0.2356, instance_loss: 0.1416, weighted_loss: 0.2074, label: 3, bag_size: 1399
batch 59, loss: 0.0101, instance_loss: 0.2493, weighted_loss: 0.0819, label: 0, bag_size: 128
batch 79, loss: 0.0082, instance_loss: 0.1322, weighted_loss: 0.0454, label: 3, bag_size: 53
batch 99, loss: 0.0045, instance_loss: 0.1330, weighted_loss: 0.0430, label: 0, bag_size: 246
batch 119, loss: 0.0002, instance_loss: 0.1588, weighted_loss: 0.0478, label: 3, bag_size: 16
batch 139, loss: 0.3307, instance_loss: 0.2280, weighted_loss: 0.2999, label: 2, bag_size: 910
batch 159, loss: 0.0147, instance_loss: 0.1701, weighted_loss: 0.0613, label: 0, bag_size: 1133
batch 179, loss: 0.0563, instance_loss: 0.7041, weighted_loss: 0.2506, label: 3, bag_size: 1250
batch 199, loss: 0.2728, instance_loss: 0.3604, weighted_loss: 0.2991, label: 2, bag_size: 482
batch 219, loss: 0.0011, instance_loss: 0.0182, weighted_loss: 0.0062, label: 4, bag_size: 211
batch 239, loss: 0.0027, instance_loss: 0.0223, weighted_loss: 0.0085, label: 3, bag_size: 405
batch 259, loss: 0.0009, instance_loss: 0.0442, weighted_loss: 0.0139, label: 4, bag_size: 130
batch 279, loss: 0.0070, instance_loss: 0.0637, weighted_loss: 0.0240, label: 3, bag_size: 405
batch 299, loss: 0.0056, instance_loss: 0.3651, weighted_loss: 0.1135, label: 1, bag_size: 890
batch 319, loss: 0.0008, instance_loss: 0.0131, weighted_loss: 0.0045, label: 4, bag_size: 192
batch 339, loss: 0.0024, instance_loss: 0.1296, weighted_loss: 0.0406, label: 1, bag_size: 1239
batch 359, loss: 0.0020, instance_loss: 0.0299, weighted_loss: 0.0104, label: 4, bag_size: 150
batch 379, loss: 0.0133, instance_loss: 0.1732, weighted_loss: 0.0613, label: 3, bag_size: 20
batch 399, loss: 0.0010, instance_loss: 0.0473, weighted_loss: 0.0149, label: 0, bag_size: 521
batch 419, loss: 0.0261, instance_loss: 0.3203, weighted_loss: 0.1143, label: 0, bag_size: 118
batch 439, loss: 0.0004, instance_loss: 0.1180, weighted_loss: 0.0357, label: 4, bag_size: 20
batch 459, loss: 0.1985, instance_loss: 0.2687, weighted_loss: 0.2196, label: 2, bag_size: 1164
batch 479, loss: 0.0202, instance_loss: 0.3359, weighted_loss: 0.1149, label: 1, bag_size: 1646
batch 499, loss: 0.2298, instance_loss: 0.3143, weighted_loss: 0.2552, label: 2, bag_size: 237
batch 519, loss: 0.3193, instance_loss: 0.4092, weighted_loss: 0.3463, label: 1, bag_size: 474
batch 539, loss: 0.6945, instance_loss: 0.4738, weighted_loss: 0.6283, label: 2, bag_size: 684


class 0 clustering acc 0.986788990825688: correct 21512/21800
class 1 clustering acc 0.555045871559633: correct 2420/4360
Epoch: 35, train_loss: 0.1862, train_clustering_loss:  0.2554, train_error: 0.0642
class 0: acc 0.9587628865979382, correct 93/97
class 1: acc 0.8532110091743119, correct 93/109
class 2: acc 0.8727272727272727, correct 96/110
class 3: acc 0.9907407407407407, correct 107/108
class 4: acc 1.0, correct 121/121

Val Set, val_loss: 0.8854, val_error: 0.2800, auc: 0.9217
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.39: correct 156/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.8921, instance_loss: 0.6925, weighted_loss: 0.8323, label: 2, bag_size: 373
batch 39, loss: 0.0081, instance_loss: 0.0821, weighted_loss: 0.0303, label: 0, bag_size: 472
batch 59, loss: 0.0012, instance_loss: 0.3617, weighted_loss: 0.1093, label: 3, bag_size: 16
batch 79, loss: 0.2214, instance_loss: 0.4117, weighted_loss: 0.2785, label: 1, bag_size: 377
batch 99, loss: 0.2024, instance_loss: 0.4001, weighted_loss: 0.2617, label: 2, bag_size: 373
batch 119, loss: 0.0107, instance_loss: 0.2458, weighted_loss: 0.0812, label: 0, bag_size: 117
batch 139, loss: 0.0626, instance_loss: 0.7676, weighted_loss: 0.2741, label: 3, bag_size: 281
batch 159, loss: 0.0047, instance_loss: 0.0845, weighted_loss: 0.0287, label: 4, bag_size: 51
batch 179, loss: 0.3857, instance_loss: 0.5347, weighted_loss: 0.4304, label: 2, bag_size: 1677
batch 199, loss: 0.0004, instance_loss: 0.1769, weighted_loss: 0.0534, label: 4, bag_size: 35
batch 219, loss: 0.1575, instance_loss: 0.4798, weighted_loss: 0.2542, label: 1, bag_size: 377
batch 239, loss: 0.2423, instance_loss: 0.1937, weighted_loss: 0.2277, label: 2, bag_size: 271
batch 259, loss: 0.0002, instance_loss: 0.3061, weighted_loss: 0.0920, label: 3, bag_size: 18
batch 279, loss: 0.0175, instance_loss: 0.0835, weighted_loss: 0.0373, label: 1, bag_size: 944
batch 299, loss: 0.0115, instance_loss: 0.0581, weighted_loss: 0.0255, label: 4, bag_size: 101
batch 319, loss: 0.3151, instance_loss: 0.3777, weighted_loss: 0.3339, label: 0, bag_size: 759
batch 339, loss: 0.0146, instance_loss: 0.2783, weighted_loss: 0.0937, label: 4, bag_size: 711
batch 359, loss: 0.0002, instance_loss: 0.0219, weighted_loss: 0.0067, label: 4, bag_size: 130
batch 379, loss: 0.0915, instance_loss: 0.2505, weighted_loss: 0.1392, label: 0, bag_size: 1255
batch 399, loss: 1.2992, instance_loss: 0.6329, weighted_loss: 1.0993, label: 1, bag_size: 377
batch 419, loss: 0.0004, instance_loss: 0.1224, weighted_loss: 0.0370, label: 3, bag_size: 35
batch 439, loss: 0.2824, instance_loss: 0.4055, weighted_loss: 0.3193, label: 2, bag_size: 1141
batch 459, loss: 0.0222, instance_loss: 0.2067, weighted_loss: 0.0776, label: 0, bag_size: 472
batch 479, loss: 0.0227, instance_loss: 0.1018, weighted_loss: 0.0464, label: 2, bag_size: 455
batch 499, loss: 0.2278, instance_loss: 0.5505, weighted_loss: 0.3246, label: 3, bag_size: 200
batch 519, loss: 0.0022, instance_loss: 0.0543, weighted_loss: 0.0179, label: 0, bag_size: 616
batch 539, loss: 0.0078, instance_loss: 0.0900, weighted_loss: 0.0325, label: 1, bag_size: 790


class 0 clustering acc 0.9876146788990826: correct 21530/21800
class 1 clustering acc 0.5490825688073394: correct 2394/4360
Epoch: 36, train_loss: 0.1659, train_clustering_loss:  0.2545, train_error: 0.0679
class 0: acc 0.9734513274336283, correct 110/113
class 1: acc 0.8653846153846154, correct 90/104
class 2: acc 0.868421052631579, correct 99/114
class 3: acc 0.9727272727272728, correct 107/110
class 4: acc 0.9807692307692307, correct 102/104

Val Set, val_loss: 0.8823, val_error: 0.2200, auc: 0.9179
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.4375: correct 175/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0033, instance_loss: 0.0637, weighted_loss: 0.0214, label: 4, bag_size: 119
batch 39, loss: 0.0004, instance_loss: 0.1562, weighted_loss: 0.0472, label: 4, bag_size: 47
batch 59, loss: 0.0012, instance_loss: 0.7739, weighted_loss: 0.2330, label: 4, bag_size: 436
batch 79, loss: 0.0583, instance_loss: 0.2094, weighted_loss: 0.1036, label: 0, bag_size: 432
batch 99, loss: 0.0748, instance_loss: 0.2034, weighted_loss: 0.1134, label: 2, bag_size: 480
batch 119, loss: 0.0104, instance_loss: 0.1275, weighted_loss: 0.0455, label: 1, bag_size: 994
batch 139, loss: 0.0766, instance_loss: 0.3443, weighted_loss: 0.1569, label: 1, bag_size: 474
batch 159, loss: 0.0253, instance_loss: 0.2368, weighted_loss: 0.0888, label: 4, bag_size: 1176
batch 179, loss: 0.8251, instance_loss: 0.6472, weighted_loss: 0.7717, label: 2, bag_size: 934
batch 199, loss: 0.0010, instance_loss: 0.0377, weighted_loss: 0.0120, label: 4, bag_size: 211
batch 219, loss: 0.0000, instance_loss: 0.0378, weighted_loss: 0.0114, label: 3, bag_size: 20
batch 239, loss: 0.0453, instance_loss: 0.2540, weighted_loss: 0.1079, label: 2, bag_size: 1218
batch 259, loss: 0.0021, instance_loss: 0.0356, weighted_loss: 0.0121, label: 0, bag_size: 1101
batch 279, loss: 0.0399, instance_loss: 0.2468, weighted_loss: 0.1019, label: 2, bag_size: 707
batch 299, loss: 0.2906, instance_loss: 0.3447, weighted_loss: 0.3068, label: 1, bag_size: 868
batch 319, loss: 0.1498, instance_loss: 0.4928, weighted_loss: 0.2527, label: 4, bag_size: 1337
batch 339, loss: 0.0128, instance_loss: 0.1886, weighted_loss: 0.0656, label: 4, bag_size: 524
batch 359, loss: 0.0277, instance_loss: 0.2685, weighted_loss: 0.1000, label: 1, bag_size: 614
batch 379, loss: 0.0435, instance_loss: 0.1765, weighted_loss: 0.0834, label: 0, bag_size: 552
batch 399, loss: 0.0363, instance_loss: 0.1920, weighted_loss: 0.0830, label: 0, bag_size: 437
batch 419, loss: 0.0135, instance_loss: 0.0804, weighted_loss: 0.0336, label: 0, bag_size: 437
batch 439, loss: 0.0446, instance_loss: 0.1815, weighted_loss: 0.0857, label: 1, bag_size: 847
batch 459, loss: 0.3791, instance_loss: 0.6601, weighted_loss: 0.4634, label: 3, bag_size: 305
batch 479, loss: 2.3070, instance_loss: 0.5986, weighted_loss: 1.7945, label: 1, bag_size: 470
batch 499, loss: 0.0042, instance_loss: 0.0618, weighted_loss: 0.0215, label: 3, bag_size: 1172
batch 519, loss: 0.0001, instance_loss: 0.0487, weighted_loss: 0.0147, label: 3, bag_size: 37
batch 539, loss: 0.0957, instance_loss: 0.3127, weighted_loss: 0.1608, label: 2, bag_size: 264


class 0 clustering acc 0.9872935779816514: correct 21523/21800
class 1 clustering acc 0.5419724770642201: correct 2363/4360
Epoch: 37, train_loss: 0.1635, train_clustering_loss:  0.2521, train_error: 0.0624
class 0: acc 0.9813084112149533, correct 105/107
class 1: acc 0.8695652173913043, correct 100/115
class 2: acc 0.84375, correct 81/96
class 3: acc 0.991304347826087, correct 114/115
class 4: acc 0.9910714285714286, correct 111/112

Val Set, val_loss: 0.7794, val_error: 0.2200, auc: 0.9299
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.41: correct 164/400
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0001, instance_loss: 0.1141, weighted_loss: 0.0343, label: 3, bag_size: 21
batch 39, loss: 0.0054, instance_loss: 0.2601, weighted_loss: 0.0818, label: 0, bag_size: 110
batch 59, loss: 0.0518, instance_loss: 0.1389, weighted_loss: 0.0779, label: 0, bag_size: 1061
batch 79, loss: 0.0653, instance_loss: 0.2431, weighted_loss: 0.1186, label: 2, bag_size: 806
batch 99, loss: 0.2319, instance_loss: 0.5320, weighted_loss: 0.3220, label: 1, bag_size: 747
batch 119, loss: 0.0590, instance_loss: 0.2072, weighted_loss: 0.1035, label: 2, bag_size: 404
batch 139, loss: 0.0942, instance_loss: 0.6272, weighted_loss: 0.2541, label: 4, bag_size: 882
batch 159, loss: 0.0000, instance_loss: 0.0840, weighted_loss: 0.0252, label: 3, bag_size: 31
batch 179, loss: 0.0093, instance_loss: 0.2367, weighted_loss: 0.0775, label: 2, bag_size: 278
batch 199, loss: 0.0655, instance_loss: 0.4453, weighted_loss: 0.1795, label: 4, bag_size: 1337
batch 219, loss: 0.1094, instance_loss: 0.1882, weighted_loss: 0.1330, label: 0, bag_size: 800
batch 239, loss: 0.1858, instance_loss: 0.6586, weighted_loss: 0.3277, label: 2, bag_size: 518
batch 259, loss: 0.0016, instance_loss: 0.0938, weighted_loss: 0.0293, label: 3, bag_size: 143
batch 279, loss: 0.0011, instance_loss: 0.1773, weighted_loss: 0.0539, label: 3, bag_size: 21
batch 299, loss: 0.1838, instance_loss: 0.7508, weighted_loss: 0.3539, label: 3, bag_size: 281
batch 319, loss: 0.0074, instance_loss: 0.1579, weighted_loss: 0.0526, label: 0, bag_size: 413
batch 339, loss: 0.0003, instance_loss: 0.0540, weighted_loss: 0.0164, label: 3, bag_size: 19
batch 359, loss: 0.2526, instance_loss: 0.2296, weighted_loss: 0.2457, label: 2, bag_size: 1019
batch 379, loss: 0.1023, instance_loss: 0.3969, weighted_loss: 0.1907, label: 2, bag_size: 312
batch 399, loss: 0.0005, instance_loss: 0.3587, weighted_loss: 0.1080, label: 4, bag_size: 24
batch 419, loss: 0.2723, instance_loss: 0.4297, weighted_loss: 0.3195, label: 2, bag_size: 1677
batch 439, loss: 0.0332, instance_loss: 0.1257, weighted_loss: 0.0609, label: 2, bag_size: 748
batch 459, loss: 0.0061, instance_loss: 0.0736, weighted_loss: 0.0263, label: 0, bag_size: 446
batch 479, loss: 0.0045, instance_loss: 0.1452, weighted_loss: 0.0467, label: 3, bag_size: 28
batch 499, loss: 0.0046, instance_loss: 0.0734, weighted_loss: 0.0252, label: 0, bag_size: 367
batch 519, loss: 0.0582, instance_loss: 0.5655, weighted_loss: 0.2104, label: 3, bag_size: 283
batch 539, loss: 0.0587, instance_loss: 0.1745, weighted_loss: 0.0934, label: 2, bag_size: 391


class 0 clustering acc 0.9865137614678899: correct 21506/21800
class 1 clustering acc 0.5672018348623853: correct 2473/4360
Epoch: 38, train_loss: 0.1428, train_clustering_loss:  0.2462, train_error: 0.0440
class 0: acc 0.9803921568627451, correct 100/102
class 1: acc 0.8878504672897196, correct 95/107
class 2: acc 0.9180327868852459, correct 112/122
class 3: acc 1.0, correct 113/113
class 4: acc 1.0, correct 101/101

Val Set, val_loss: 0.8442, val_error: 0.2200, auc: 0.9280
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.4975: correct 199/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0056, instance_loss: 0.0731, weighted_loss: 0.0258, label: 3, bag_size: 46
batch 39, loss: 0.0321, instance_loss: 0.2801, weighted_loss: 0.1065, label: 0, bag_size: 255
batch 59, loss: 0.0031, instance_loss: 0.2387, weighted_loss: 0.0738, label: 3, bag_size: 35
batch 79, loss: 0.0334, instance_loss: 0.1238, weighted_loss: 0.0606, label: 2, bag_size: 270
batch 99, loss: 0.0550, instance_loss: 0.2913, weighted_loss: 0.1259, label: 0, bag_size: 524
batch 119, loss: 0.0917, instance_loss: 0.2572, weighted_loss: 0.1414, label: 2, bag_size: 655
batch 139, loss: 0.0444, instance_loss: 0.6550, weighted_loss: 0.2276, label: 1, bag_size: 867
batch 159, loss: 0.0103, instance_loss: 0.0671, weighted_loss: 0.0273, label: 0, bag_size: 731
batch 179, loss: 0.0498, instance_loss: 0.1423, weighted_loss: 0.0775, label: 1, bag_size: 746
batch 199, loss: 0.0085, instance_loss: 0.0718, weighted_loss: 0.0275, label: 0, bag_size: 807
batch 219, loss: 0.0178, instance_loss: 0.1858, weighted_loss: 0.0682, label: 0, bag_size: 375
batch 239, loss: 0.5842, instance_loss: 0.3384, weighted_loss: 0.5104, label: 2, bag_size: 1133
batch 259, loss: 0.0292, instance_loss: 0.3381, weighted_loss: 0.1219, label: 2, bag_size: 766
batch 279, loss: 0.0001, instance_loss: 0.1552, weighted_loss: 0.0466, label: 3, bag_size: 26
batch 299, loss: 0.6157, instance_loss: 0.5653, weighted_loss: 0.6006, label: 0, bag_size: 423
batch 319, loss: 0.0001, instance_loss: 0.3361, weighted_loss: 0.1009, label: 4, bag_size: 711
batch 339, loss: 0.0225, instance_loss: 0.3445, weighted_loss: 0.1191, label: 2, bag_size: 204
batch 359, loss: 0.0497, instance_loss: 0.2507, weighted_loss: 0.1100, label: 1, bag_size: 399
batch 379, loss: 0.2074, instance_loss: 0.6483, weighted_loss: 0.3396, label: 4, bag_size: 974
batch 399, loss: 0.0013, instance_loss: 0.0605, weighted_loss: 0.0191, label: 3, bag_size: 33
batch 419, loss: 2.0639, instance_loss: 0.7161, weighted_loss: 1.6595, label: 1, bag_size: 1172
batch 439, loss: 0.1416, instance_loss: 0.3641, weighted_loss: 0.2084, label: 3, bag_size: 317
batch 459, loss: 0.0245, instance_loss: 0.1534, weighted_loss: 0.0631, label: 0, bag_size: 731
batch 479, loss: 0.0001, instance_loss: 0.1464, weighted_loss: 0.0440, label: 3, bag_size: 18
batch 499, loss: 0.0085, instance_loss: 0.0962, weighted_loss: 0.0348, label: 0, bag_size: 246
batch 519, loss: 0.0244, instance_loss: 0.6379, weighted_loss: 0.2085, label: 4, bag_size: 882
batch 539, loss: 0.5559, instance_loss: 0.2069, weighted_loss: 0.4512, label: 1, bag_size: 690


class 0 clustering acc 0.9868807339449541: correct 21514/21800
class 1 clustering acc 0.5422018348623853: correct 2364/4360
Epoch: 39, train_loss: 0.1534, train_clustering_loss:  0.2587, train_error: 0.0459
class 0: acc 0.991869918699187, correct 122/123
class 1: acc 0.8846153846153846, correct 92/104
class 2: acc 0.9107142857142857, correct 102/112
class 3: acc 0.98989898989899, correct 98/99
class 4: acc 0.9906542056074766, correct 106/107

Val Set, val_loss: 0.8401, val_error: 0.2200, auc: 0.9270
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.45: correct 180/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0063, instance_loss: 0.3048, weighted_loss: 0.0959, label: 0, bag_size: 118
batch 39, loss: 0.0000, instance_loss: 0.0535, weighted_loss: 0.0161, label: 4, bag_size: 43
batch 59, loss: 0.0004, instance_loss: 0.3163, weighted_loss: 0.0952, label: 4, bag_size: 19
batch 79, loss: 0.2755, instance_loss: 0.4086, weighted_loss: 0.3154, label: 2, bag_size: 482
batch 99, loss: 0.1470, instance_loss: 0.3322, weighted_loss: 0.2026, label: 2, bag_size: 395
batch 119, loss: 0.0007, instance_loss: 0.1022, weighted_loss: 0.0311, label: 4, bag_size: 28
batch 139, loss: 0.0435, instance_loss: 0.2499, weighted_loss: 0.1054, label: 2, bag_size: 809
batch 159, loss: 0.0002, instance_loss: 0.2266, weighted_loss: 0.0681, label: 4, bag_size: 974
batch 179, loss: 1.6604, instance_loss: 0.5843, weighted_loss: 1.3376, label: 2, bag_size: 1348
batch 199, loss: 0.0512, instance_loss: 0.0816, weighted_loss: 0.0603, label: 3, bag_size: 53
batch 219, loss: 0.0365, instance_loss: 0.5801, weighted_loss: 0.1996, label: 1, bag_size: 875
batch 239, loss: 0.0019, instance_loss: 0.0639, weighted_loss: 0.0205, label: 0, bag_size: 1018
batch 259, loss: 0.0005, instance_loss: 0.1261, weighted_loss: 0.0382, label: 4, bag_size: 19
batch 279, loss: 1.4650, instance_loss: 0.6468, weighted_loss: 1.2195, label: 2, bag_size: 676
batch 299, loss: 0.0899, instance_loss: 0.3726, weighted_loss: 0.1747, label: 0, bag_size: 800
batch 319, loss: 0.1291, instance_loss: 0.4009, weighted_loss: 0.2106, label: 2, bag_size: 271
batch 339, loss: 0.0455, instance_loss: 0.3414, weighted_loss: 0.1343, label: 3, bag_size: 849
batch 359, loss: 0.0003, instance_loss: 0.0483, weighted_loss: 0.0147, label: 3, bag_size: 32
batch 379, loss: 0.0406, instance_loss: 0.1880, weighted_loss: 0.0848, label: 0, bag_size: 432
batch 399, loss: 0.0016, instance_loss: 0.0578, weighted_loss: 0.0185, label: 4, bag_size: 60
batch 419, loss: 0.0002, instance_loss: 0.0513, weighted_loss: 0.0156, label: 3, bag_size: 43
batch 439, loss: 0.0018, instance_loss: 0.2236, weighted_loss: 0.0684, label: 3, bag_size: 16
batch 459, loss: 0.1321, instance_loss: 0.8902, weighted_loss: 0.3595, label: 4, bag_size: 436
batch 479, loss: 0.0288, instance_loss: 0.1401, weighted_loss: 0.0622, label: 2, bag_size: 567
batch 499, loss: 0.0005, instance_loss: 0.0797, weighted_loss: 0.0242, label: 4, bag_size: 44
batch 519, loss: 0.1622, instance_loss: 0.2146, weighted_loss: 0.1779, label: 2, bag_size: 469
batch 539, loss: 0.0634, instance_loss: 0.2220, weighted_loss: 0.1110, label: 2, bag_size: 774


class 0 clustering acc 0.9880733944954129: correct 21540/21800
class 1 clustering acc 0.5538990825688074: correct 2415/4360
Epoch: 40, train_loss: 0.1366, train_clustering_loss:  0.2516, train_error: 0.0404
class 0: acc 0.9805825242718447, correct 101/103
class 1: acc 0.9166666666666666, correct 110/120
class 2: acc 0.9215686274509803, correct 94/102
class 3: acc 1.0, correct 106/106
class 4: acc 0.9824561403508771, correct 112/114

Val Set, val_loss: 0.8348, val_error: 0.2200, auc: 0.9401
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.4775: correct 191/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1359, instance_loss: 0.8868, weighted_loss: 0.3612, label: 3, bag_size: 211
batch 39, loss: 0.0000, instance_loss: 0.0379, weighted_loss: 0.0114, label: 1, bag_size: 847
batch 59, loss: 0.0055, instance_loss: 0.2312, weighted_loss: 0.0732, label: 0, bag_size: 109
batch 79, loss: 0.2000, instance_loss: 0.3908, weighted_loss: 0.2572, label: 2, bag_size: 537
batch 99, loss: 0.0001, instance_loss: 0.0866, weighted_loss: 0.0260, label: 3, bag_size: 18
batch 119, loss: 0.0002, instance_loss: 0.1519, weighted_loss: 0.0457, label: 3, bag_size: 18
batch 139, loss: 0.0029, instance_loss: 0.0657, weighted_loss: 0.0218, label: 0, bag_size: 515
batch 159, loss: 0.0477, instance_loss: 0.2750, weighted_loss: 0.1159, label: 1, bag_size: 530
batch 179, loss: 0.3996, instance_loss: 0.4706, weighted_loss: 0.4209, label: 2, bag_size: 916
batch 199, loss: 0.0009, instance_loss: 0.3788, weighted_loss: 0.1143, label: 0, bag_size: 122
batch 219, loss: 0.0034, instance_loss: 0.2387, weighted_loss: 0.0740, label: 2, bag_size: 499
batch 239, loss: 0.0004, instance_loss: 0.0541, weighted_loss: 0.0165, label: 4, bag_size: 60
batch 259, loss: 0.0159, instance_loss: 0.1078, weighted_loss: 0.0435, label: 1, bag_size: 1426
batch 279, loss: 0.0000, instance_loss: 0.1964, weighted_loss: 0.0590, label: 3, bag_size: 18
batch 299, loss: 0.0004, instance_loss: 0.1845, weighted_loss: 0.0556, label: 3, bag_size: 15
batch 319, loss: 0.0680, instance_loss: 0.2203, weighted_loss: 0.1137, label: 2, bag_size: 1242
batch 339, loss: 0.0005, instance_loss: 0.1036, weighted_loss: 0.0314, label: 4, bag_size: 1002
batch 359, loss: 0.0862, instance_loss: 0.1926, weighted_loss: 0.1181, label: 0, bag_size: 478
batch 379, loss: 0.6112, instance_loss: 0.4708, weighted_loss: 0.5691, label: 2, bag_size: 655
batch 399, loss: 0.0060, instance_loss: 0.0370, weighted_loss: 0.0153, label: 3, bag_size: 97
batch 419, loss: 0.1089, instance_loss: 0.2604, weighted_loss: 0.1543, label: 0, bag_size: 478
batch 439, loss: 0.0485, instance_loss: 0.8077, weighted_loss: 0.2763, label: 4, bag_size: 210
batch 459, loss: 0.0044, instance_loss: 0.2720, weighted_loss: 0.0847, label: 1, bag_size: 818
batch 479, loss: 0.0001, instance_loss: 0.0104, weighted_loss: 0.0032, label: 3, bag_size: 46
batch 499, loss: 0.0120, instance_loss: 0.0349, weighted_loss: 0.0189, label: 4, bag_size: 119
batch 519, loss: 0.3290, instance_loss: 0.3689, weighted_loss: 0.3410, label: 0, bag_size: 1289
batch 539, loss: 0.0667, instance_loss: 0.3052, weighted_loss: 0.1382, label: 2, bag_size: 265


class 0 clustering acc 0.9875229357798165: correct 21528/21800
class 1 clustering acc 0.530045871559633: correct 2311/4360
Epoch: 41, train_loss: 0.1667, train_clustering_loss:  0.2613, train_error: 0.0495
class 0: acc 0.9814814814814815, correct 106/108
class 1: acc 0.8833333333333333, correct 106/120
class 2: acc 0.9074074074074074, correct 98/108
class 3: acc 1.0, correct 102/102
class 4: acc 0.9906542056074766, correct 106/107

Val Set, val_loss: 0.8515, val_error: 0.2200, auc: 0.9412
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.44: correct 176/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0012, instance_loss: 0.1864, weighted_loss: 0.0568, label: 3, bag_size: 18
batch 39, loss: 0.0770, instance_loss: 0.7540, weighted_loss: 0.2801, label: 3, bag_size: 281
batch 59, loss: 0.3237, instance_loss: 0.3275, weighted_loss: 0.3248, label: 2, bag_size: 910
batch 79, loss: 0.1143, instance_loss: 0.2494, weighted_loss: 0.1548, label: 1, bag_size: 535
batch 99, loss: 0.0062, instance_loss: 0.4435, weighted_loss: 0.1374, label: 4, bag_size: 646
batch 119, loss: 0.0019, instance_loss: 0.1888, weighted_loss: 0.0579, label: 3, bag_size: 1559
batch 139, loss: 0.0008, instance_loss: 0.5896, weighted_loss: 0.1774, label: 4, bag_size: 663
batch 159, loss: 0.0170, instance_loss: 0.0516, weighted_loss: 0.0274, label: 1, bag_size: 1191
batch 179, loss: 0.0106, instance_loss: 0.0913, weighted_loss: 0.0348, label: 3, bag_size: 405
batch 199, loss: 0.0233, instance_loss: 0.1539, weighted_loss: 0.0625, label: 2, bag_size: 262
batch 219, loss: 0.0029, instance_loss: 0.0296, weighted_loss: 0.0110, label: 0, bag_size: 1046
batch 239, loss: 0.1549, instance_loss: 0.4073, weighted_loss: 0.2306, label: 0, bag_size: 432
batch 259, loss: 0.0048, instance_loss: 0.1299, weighted_loss: 0.0423, label: 0, bag_size: 921
batch 279, loss: 0.0036, instance_loss: 0.0528, weighted_loss: 0.0184, label: 3, bag_size: 405
batch 299, loss: 0.0740, instance_loss: 0.2573, weighted_loss: 0.1290, label: 2, bag_size: 828
batch 319, loss: 0.0428, instance_loss: 0.2153, weighted_loss: 0.0946, label: 0, bag_size: 120
batch 339, loss: 0.0283, instance_loss: 0.1242, weighted_loss: 0.0571, label: 1, bag_size: 690
batch 359, loss: 0.0063, instance_loss: 0.3803, weighted_loss: 0.1185, label: 1, bag_size: 319
batch 379, loss: 0.0238, instance_loss: 0.2413, weighted_loss: 0.0891, label: 1, bag_size: 1646
batch 399, loss: 0.0001, instance_loss: 0.0672, weighted_loss: 0.0203, label: 4, bag_size: 388
batch 419, loss: 1.2825, instance_loss: 0.6774, weighted_loss: 1.1009, label: 2, bag_size: 738
batch 439, loss: 0.0098, instance_loss: 0.1287, weighted_loss: 0.0455, label: 4, bag_size: 636
batch 459, loss: 0.0065, instance_loss: 0.1735, weighted_loss: 0.0566, label: 0, bag_size: 155
batch 479, loss: 0.0001, instance_loss: 0.0718, weighted_loss: 0.0216, label: 3, bag_size: 43
batch 499, loss: 0.0001, instance_loss: 0.4319, weighted_loss: 0.1296, label: 4, bag_size: 974
batch 519, loss: 0.0055, instance_loss: 0.1791, weighted_loss: 0.0576, label: 0, bag_size: 163
batch 539, loss: 0.0114, instance_loss: 0.2118, weighted_loss: 0.0715, label: 2, bag_size: 1123


class 0 clustering acc 0.9882110091743119: correct 21543/21800
class 1 clustering acc 0.591743119266055: correct 2580/4360
Epoch: 42, train_loss: 0.1298, train_clustering_loss:  0.2364, train_error: 0.0477
class 0: acc 0.9848484848484849, correct 130/132
class 1: acc 0.8627450980392157, correct 88/102
class 2: acc 0.9285714285714286, correct 91/98
class 3: acc 0.9910714285714286, correct 111/112
class 4: acc 0.9801980198019802, correct 99/101

Val Set, val_loss: 0.9311, val_error: 0.2200, auc: 0.9390
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.4625: correct 185/400
class 0: acc 0.75, correct 9/12
class 1: acc 1.0, correct 9/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0571, instance_loss: 0.3071, weighted_loss: 0.1321, label: 2, bag_size: 419
batch 39, loss: 0.2139, instance_loss: 0.2453, weighted_loss: 0.2233, label: 2, bag_size: 471
batch 59, loss: 1.5920, instance_loss: 0.5809, weighted_loss: 1.2886, label: 2, bag_size: 194
batch 79, loss: 1.1350, instance_loss: 0.4288, weighted_loss: 0.9231, label: 0, bag_size: 818
batch 99, loss: 0.1368, instance_loss: 0.2853, weighted_loss: 0.1813, label: 0, bag_size: 294
batch 119, loss: 0.0004, instance_loss: 0.1051, weighted_loss: 0.0318, label: 4, bag_size: 1357
batch 139, loss: 0.0002, instance_loss: 0.3359, weighted_loss: 0.1009, label: 3, bag_size: 18
batch 159, loss: 0.0250, instance_loss: 0.1848, weighted_loss: 0.0730, label: 1, bag_size: 598
batch 179, loss: 0.1709, instance_loss: 0.2348, weighted_loss: 0.1900, label: 2, bag_size: 1019
batch 199, loss: 0.2633, instance_loss: 0.3141, weighted_loss: 0.2785, label: 2, bag_size: 264
batch 219, loss: 0.0032, instance_loss: 0.0649, weighted_loss: 0.0217, label: 0, bag_size: 1517
batch 239, loss: 0.2508, instance_loss: 0.4256, weighted_loss: 0.3033, label: 0, bag_size: 718
batch 259, loss: 0.0003, instance_loss: 0.0732, weighted_loss: 0.0222, label: 4, bag_size: 48
batch 279, loss: 0.0367, instance_loss: 0.1592, weighted_loss: 0.0734, label: 4, bag_size: 646
batch 299, loss: 0.4015, instance_loss: 0.2992, weighted_loss: 0.3708, label: 2, bag_size: 471
batch 319, loss: 0.0022, instance_loss: 0.0696, weighted_loss: 0.0224, label: 3, bag_size: 316
batch 339, loss: 0.0162, instance_loss: 0.2462, weighted_loss: 0.0852, label: 0, bag_size: 117
batch 359, loss: 0.0008, instance_loss: 0.0809, weighted_loss: 0.0248, label: 1, bag_size: 994
batch 379, loss: 0.0018, instance_loss: 0.0342, weighted_loss: 0.0115, label: 3, bag_size: 53
batch 399, loss: 0.0419, instance_loss: 0.4054, weighted_loss: 0.1509, label: 1, bag_size: 875
batch 419, loss: 0.0095, instance_loss: 0.0593, weighted_loss: 0.0244, label: 0, bag_size: 367
batch 439, loss: 1.1095, instance_loss: 0.5518, weighted_loss: 0.9422, label: 4, bag_size: 533
batch 459, loss: 0.6448, instance_loss: 0.5057, weighted_loss: 0.6031, label: 2, bag_size: 3236
batch 479, loss: 0.5446, instance_loss: 0.4953, weighted_loss: 0.5298, label: 1, bag_size: 868
batch 499, loss: 0.0024, instance_loss: 0.0967, weighted_loss: 0.0307, label: 0, bag_size: 976
batch 519, loss: 0.0001, instance_loss: 0.1960, weighted_loss: 0.0589, label: 3, bag_size: 18
batch 539, loss: 0.0005, instance_loss: 0.0229, weighted_loss: 0.0073, label: 4, bag_size: 128


class 0 clustering acc 0.9884403669724771: correct 21548/21800
class 1 clustering acc 0.5708715596330275: correct 2489/4360
Epoch: 43, train_loss: 0.1298, train_clustering_loss:  0.2407, train_error: 0.0404
class 0: acc 0.9826086956521739, correct 113/115
class 1: acc 0.9243697478991597, correct 110/119
class 2: acc 0.9215686274509803, correct 94/102
class 3: acc 0.9803921568627451, correct 100/102
class 4: acc 0.9906542056074766, correct 106/107

Val Set, val_loss: 1.0183, val_error: 0.2000, auc: 0.9219
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.4575: correct 183/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0018, instance_loss: 0.1074, weighted_loss: 0.0334, label: 4, bag_size: 26
batch 39, loss: 0.0146, instance_loss: 0.1490, weighted_loss: 0.0549, label: 0, bag_size: 148
batch 59, loss: 0.0001, instance_loss: 0.0483, weighted_loss: 0.0145, label: 3, bag_size: 24
batch 79, loss: 0.0045, instance_loss: 0.1805, weighted_loss: 0.0573, label: 3, bag_size: 24
batch 99, loss: 0.0221, instance_loss: 0.1282, weighted_loss: 0.0539, label: 1, bag_size: 534
batch 119, loss: 0.0006, instance_loss: 0.0465, weighted_loss: 0.0144, label: 4, bag_size: 60
batch 139, loss: 0.1406, instance_loss: 0.4758, weighted_loss: 0.2411, label: 2, bag_size: 110
batch 159, loss: 0.1885, instance_loss: 0.4380, weighted_loss: 0.2633, label: 2, bag_size: 471
batch 179, loss: 0.0184, instance_loss: 0.6853, weighted_loss: 0.2185, label: 4, bag_size: 210
batch 199, loss: 0.0155, instance_loss: 0.1009, weighted_loss: 0.0411, label: 1, bag_size: 614
batch 219, loss: 0.0523, instance_loss: 0.0999, weighted_loss: 0.0666, label: 0, bag_size: 1255
batch 239, loss: 0.0146, instance_loss: 0.2369, weighted_loss: 0.0813, label: 0, bag_size: 437
batch 259, loss: 0.0001, instance_loss: 0.0601, weighted_loss: 0.0181, label: 4, bag_size: 211
batch 279, loss: 0.0038, instance_loss: 0.0820, weighted_loss: 0.0273, label: 0, bag_size: 1018
batch 299, loss: 0.0749, instance_loss: 0.2100, weighted_loss: 0.1154, label: 1, bag_size: 1144
batch 319, loss: 0.6617, instance_loss: 0.8330, weighted_loss: 0.7131, label: 1, bag_size: 293
batch 339, loss: 0.0036, instance_loss: 0.1928, weighted_loss: 0.0604, label: 3, bag_size: 936
batch 359, loss: 0.0004, instance_loss: 0.0161, weighted_loss: 0.0051, label: 4, bag_size: 182
batch 379, loss: 0.0002, instance_loss: 0.0154, weighted_loss: 0.0047, label: 0, bag_size: 385
batch 399, loss: 0.0020, instance_loss: 0.0851, weighted_loss: 0.0270, label: 0, bag_size: 1255
batch 419, loss: 0.0000, instance_loss: 0.0113, weighted_loss: 0.0034, label: 4, bag_size: 185
batch 439, loss: 0.0000, instance_loss: 0.1583, weighted_loss: 0.0475, label: 3, bag_size: 18
batch 459, loss: 0.3022, instance_loss: 0.5241, weighted_loss: 0.3688, label: 1, bag_size: 446
batch 479, loss: 1.6877, instance_loss: 0.4756, weighted_loss: 1.3241, label: 0, bag_size: 912
batch 499, loss: 0.4108, instance_loss: 0.4508, weighted_loss: 0.4228, label: 1, bag_size: 700
batch 519, loss: 0.0076, instance_loss: 0.2111, weighted_loss: 0.0686, label: 2, bag_size: 421
batch 539, loss: 0.0018, instance_loss: 0.0666, weighted_loss: 0.0212, label: 1, bag_size: 1277


class 0 clustering acc 0.9877064220183486: correct 21532/21800
class 1 clustering acc 0.5658256880733945: correct 2467/4360
Epoch: 44, train_loss: 0.1021, train_clustering_loss:  0.2431, train_error: 0.0275
class 0: acc 0.967479674796748, correct 119/123
class 1: acc 0.9469026548672567, correct 107/113
class 2: acc 0.9587628865979382, correct 93/97
class 3: acc 0.9902912621359223, correct 102/103
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 0.8298, val_error: 0.2000, auc: 0.9343
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.4475: correct 179/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0216, instance_loss: 0.2268, weighted_loss: 0.0831, label: 1, bag_size: 754
batch 39, loss: 0.1037, instance_loss: 0.4451, weighted_loss: 0.2061, label: 1, bag_size: 838
batch 59, loss: 0.0860, instance_loss: 0.3103, weighted_loss: 0.1533, label: 2, bag_size: 730
batch 79, loss: 0.0050, instance_loss: 0.2825, weighted_loss: 0.0883, label: 0, bag_size: 155
batch 99, loss: 0.0559, instance_loss: 0.3189, weighted_loss: 0.1348, label: 1, bag_size: 470
batch 119, loss: 0.0001, instance_loss: 0.0180, weighted_loss: 0.0054, label: 4, bag_size: 125
batch 139, loss: 0.0070, instance_loss: 0.5903, weighted_loss: 0.1820, label: 1, bag_size: 1409
batch 159, loss: 0.0036, instance_loss: 0.7794, weighted_loss: 0.2363, label: 1, bag_size: 657
batch 179, loss: 0.0027, instance_loss: 0.1077, weighted_loss: 0.0342, label: 0, bag_size: 731
batch 199, loss: 0.0356, instance_loss: 0.1178, weighted_loss: 0.0602, label: 3, bag_size: 451
batch 219, loss: 0.0443, instance_loss: 0.1482, weighted_loss: 0.0754, label: 0, bag_size: 1012
batch 239, loss: 0.1136, instance_loss: 0.2727, weighted_loss: 0.1613, label: 0, bag_size: 1133
batch 259, loss: 0.0000, instance_loss: 0.1566, weighted_loss: 0.0470, label: 3, bag_size: 18
batch 279, loss: 0.0003, instance_loss: 0.0219, weighted_loss: 0.0068, label: 4, bag_size: 160
batch 299, loss: 0.0003, instance_loss: 0.1233, weighted_loss: 0.0372, label: 3, bag_size: 33
batch 319, loss: 0.0000, instance_loss: 0.0167, weighted_loss: 0.0050, label: 4, bag_size: 137
batch 339, loss: 0.1818, instance_loss: 0.5645, weighted_loss: 0.2966, label: 4, bag_size: 511
batch 359, loss: 0.6260, instance_loss: 0.4245, weighted_loss: 0.5656, label: 2, bag_size: 948
batch 379, loss: 0.0059, instance_loss: 0.1128, weighted_loss: 0.0379, label: 1, bag_size: 346
batch 399, loss: 0.0737, instance_loss: 0.2100, weighted_loss: 0.1146, label: 1, bag_size: 903
batch 419, loss: 0.0000, instance_loss: 0.0233, weighted_loss: 0.0070, label: 4, bag_size: 167
batch 439, loss: 0.1159, instance_loss: 0.3585, weighted_loss: 0.1887, label: 2, bag_size: 655
batch 459, loss: 0.0141, instance_loss: 0.1324, weighted_loss: 0.0496, label: 0, bag_size: 367
batch 479, loss: 0.0003, instance_loss: 0.2691, weighted_loss: 0.0809, label: 4, bag_size: 19
batch 499, loss: 0.1392, instance_loss: 0.6581, weighted_loss: 0.2949, label: 2, bag_size: 518
batch 519, loss: 0.0009, instance_loss: 0.1214, weighted_loss: 0.0371, label: 0, bag_size: 898
batch 539, loss: 0.8556, instance_loss: 0.4318, weighted_loss: 0.7285, label: 3, bag_size: 17


class 0 clustering acc 0.9868807339449541: correct 21514/21800
class 1 clustering acc 0.5396788990825688: correct 2353/4360
Epoch: 45, train_loss: 0.1472, train_clustering_loss:  0.2541, train_error: 0.0495
class 0: acc 0.9813084112149533, correct 105/107
class 1: acc 0.8823529411764706, correct 90/102
class 2: acc 0.8942307692307693, correct 93/104
class 3: acc 0.9910714285714286, correct 111/112
class 4: acc 0.9916666666666667, correct 119/120

Val Set, val_loss: 1.0394, val_error: 0.2200, auc: 0.9264
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.455: correct 182/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.2, correct 1/5
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0689, instance_loss: 0.4130, weighted_loss: 0.1722, label: 2, bag_size: 638
batch 39, loss: 0.0693, instance_loss: 0.1889, weighted_loss: 0.1052, label: 2, bag_size: 1235
batch 59, loss: 0.0141, instance_loss: 0.1557, weighted_loss: 0.0566, label: 2, bag_size: 1242
batch 79, loss: 0.0000, instance_loss: 0.0334, weighted_loss: 0.0100, label: 4, bag_size: 140
batch 99, loss: 0.0037, instance_loss: 0.1914, weighted_loss: 0.0600, label: 3, bag_size: 18
batch 119, loss: 0.0386, instance_loss: 0.7153, weighted_loss: 0.2416, label: 3, bag_size: 671
batch 139, loss: 0.0012, instance_loss: 0.0591, weighted_loss: 0.0186, label: 0, bag_size: 933
batch 159, loss: 0.0401, instance_loss: 0.6418, weighted_loss: 0.2206, label: 3, bag_size: 283
batch 179, loss: 0.0045, instance_loss: 0.1159, weighted_loss: 0.0379, label: 0, bag_size: 898
batch 199, loss: 0.0000, instance_loss: 0.0269, weighted_loss: 0.0081, label: 4, bag_size: 137
batch 219, loss: 0.0003, instance_loss: 0.0721, weighted_loss: 0.0218, label: 4, bag_size: 91
batch 239, loss: 0.0148, instance_loss: 0.1089, weighted_loss: 0.0430, label: 0, bag_size: 1579
batch 259, loss: 0.0462, instance_loss: 0.3957, weighted_loss: 0.1510, label: 0, bag_size: 818
batch 279, loss: 0.0435, instance_loss: 0.4933, weighted_loss: 0.1784, label: 3, bag_size: 1250
batch 299, loss: 0.0003, instance_loss: 0.3446, weighted_loss: 0.1036, label: 3, bag_size: 18
batch 319, loss: 0.0030, instance_loss: 0.0459, weighted_loss: 0.0159, label: 0, bag_size: 756
batch 339, loss: 0.0012, instance_loss: 0.0965, weighted_loss: 0.0298, label: 1, bag_size: 690
batch 359, loss: 0.0027, instance_loss: 0.0876, weighted_loss: 0.0282, label: 3, bag_size: 18
batch 379, loss: 0.0003, instance_loss: 0.0420, weighted_loss: 0.0128, label: 4, bag_size: 150
batch 399, loss: 0.0379, instance_loss: 0.3909, weighted_loss: 0.1438, label: 1, bag_size: 377
batch 419, loss: 0.0679, instance_loss: 0.1537, weighted_loss: 0.0936, label: 0, bag_size: 552
batch 439, loss: 0.0125, instance_loss: 0.1616, weighted_loss: 0.0572, label: 0, bag_size: 155
batch 459, loss: 0.0073, instance_loss: 0.3947, weighted_loss: 0.1235, label: 3, bag_size: 230
batch 479, loss: 0.0754, instance_loss: 0.2715, weighted_loss: 0.1342, label: 2, bag_size: 265
batch 499, loss: 0.0530, instance_loss: 0.1609, weighted_loss: 0.0853, label: 0, bag_size: 163
batch 519, loss: 0.1044, instance_loss: 0.2675, weighted_loss: 0.1533, label: 2, bag_size: 252
batch 539, loss: 0.0756, instance_loss: 0.3448, weighted_loss: 0.1564, label: 0, bag_size: 117


class 0 clustering acc 0.9874770642201834: correct 21527/21800
class 1 clustering acc 0.5594036697247706: correct 2439/4360
Epoch: 46, train_loss: 0.1449, train_clustering_loss:  0.2589, train_error: 0.0477
class 0: acc 0.9416666666666667, correct 113/120
class 1: acc 0.9272727272727272, correct 102/110
class 2: acc 0.9351851851851852, correct 101/108
class 3: acc 0.9904761904761905, correct 104/105
class 4: acc 0.9705882352941176, correct 99/102

Val Set, val_loss: 0.7407, val_error: 0.1800, auc: 0.9428
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.46: correct 184/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9444444444444444, correct 17/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0090, instance_loss: 0.1597, weighted_loss: 0.0542, label: 2, bag_size: 1289
batch 39, loss: 0.0132, instance_loss: 0.1130, weighted_loss: 0.0431, label: 0, bag_size: 607
batch 59, loss: 0.9362, instance_loss: 0.5802, weighted_loss: 0.8294, label: 2, bag_size: 916
batch 79, loss: 0.0202, instance_loss: 0.1725, weighted_loss: 0.0659, label: 2, bag_size: 863
batch 99, loss: 0.0344, instance_loss: 0.5343, weighted_loss: 0.1844, label: 0, bag_size: 245
batch 119, loss: 0.6000, instance_loss: 0.3891, weighted_loss: 0.5368, label: 2, bag_size: 1617
batch 139, loss: 0.0594, instance_loss: 0.6384, weighted_loss: 0.2331, label: 1, bag_size: 386
batch 159, loss: 0.1971, instance_loss: 0.1711, weighted_loss: 0.1893, label: 3, bag_size: 1019
batch 179, loss: 0.0060, instance_loss: 0.4077, weighted_loss: 0.1265, label: 4, bag_size: 823
batch 199, loss: 0.0314, instance_loss: 0.2058, weighted_loss: 0.0837, label: 4, bag_size: 826
batch 219, loss: 0.0069, instance_loss: 0.0982, weighted_loss: 0.0343, label: 0, bag_size: 921
batch 239, loss: 0.0533, instance_loss: 0.2644, weighted_loss: 0.1166, label: 2, bag_size: 395
batch 259, loss: 0.0018, instance_loss: 0.2126, weighted_loss: 0.0650, label: 4, bag_size: 86
batch 279, loss: 0.0482, instance_loss: 0.5732, weighted_loss: 0.2057, label: 1, bag_size: 386
batch 299, loss: 0.0002, instance_loss: 0.0277, weighted_loss: 0.0085, label: 3, bag_size: 60
batch 319, loss: 0.0001, instance_loss: 0.0142, weighted_loss: 0.0043, label: 0, bag_size: 1466
batch 339, loss: 0.0111, instance_loss: 0.2634, weighted_loss: 0.0868, label: 1, bag_size: 442
batch 359, loss: 0.0079, instance_loss: 0.1072, weighted_loss: 0.0377, label: 0, bag_size: 437
batch 379, loss: 0.0239, instance_loss: 0.3129, weighted_loss: 0.1106, label: 1, bag_size: 1724
batch 399, loss: 1.3663, instance_loss: 0.7390, weighted_loss: 1.1781, label: 2, bag_size: 120
batch 419, loss: 0.0007, instance_loss: 0.0215, weighted_loss: 0.0069, label: 4, bag_size: 79
batch 439, loss: 0.0020, instance_loss: 0.1495, weighted_loss: 0.0462, label: 0, bag_size: 437
batch 459, loss: 0.1758, instance_loss: 0.2899, weighted_loss: 0.2100, label: 1, bag_size: 838
batch 479, loss: 0.1655, instance_loss: 0.2924, weighted_loss: 0.2036, label: 1, bag_size: 535
batch 499, loss: 0.0475, instance_loss: 0.1642, weighted_loss: 0.0825, label: 1, bag_size: 1646
batch 519, loss: 0.3883, instance_loss: 0.4688, weighted_loss: 0.4124, label: 2, bag_size: 482
batch 539, loss: 0.0002, instance_loss: 0.0461, weighted_loss: 0.0139, label: 0, bag_size: 466


class 0 clustering acc 0.988302752293578: correct 21545/21800
class 1 clustering acc 0.5834862385321101: correct 2544/4360
Epoch: 47, train_loss: 0.1245, train_clustering_loss:  0.2406, train_error: 0.0440
class 0: acc 0.9711538461538461, correct 101/104
class 1: acc 0.9069767441860465, correct 117/129
class 2: acc 0.9245283018867925, correct 98/106
class 3: acc 1.0, correct 106/106
class 4: acc 0.99, correct 99/100

Val Set, val_loss: 1.0000, val_error: 0.2600, auc: 0.9282
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.505: correct 202/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0101, instance_loss: 0.1212, weighted_loss: 0.0435, label: 1, bag_size: 696
batch 39, loss: 0.0567, instance_loss: 0.3283, weighted_loss: 0.1382, label: 3, bag_size: 360
batch 59, loss: 0.0012, instance_loss: 0.2043, weighted_loss: 0.0621, label: 4, bag_size: 40
batch 79, loss: 0.0032, instance_loss: 0.1150, weighted_loss: 0.0368, label: 0, bag_size: 118
batch 99, loss: 0.0058, instance_loss: 0.4325, weighted_loss: 0.1338, label: 4, bag_size: 1278
batch 119, loss: 0.0071, instance_loss: 0.0797, weighted_loss: 0.0288, label: 1, bag_size: 636
batch 139, loss: 0.1137, instance_loss: 0.2889, weighted_loss: 0.1663, label: 2, bag_size: 636
batch 159, loss: 0.0015, instance_loss: 0.0141, weighted_loss: 0.0053, label: 3, bag_size: 54
batch 179, loss: 0.0066, instance_loss: 0.2414, weighted_loss: 0.0771, label: 0, bag_size: 424
batch 199, loss: 0.0078, instance_loss: 0.4079, weighted_loss: 0.1278, label: 1, bag_size: 442
batch 219, loss: 0.0082, instance_loss: 0.1961, weighted_loss: 0.0646, label: 2, bag_size: 784
batch 239, loss: 0.0002, instance_loss: 0.1406, weighted_loss: 0.0423, label: 4, bag_size: 20
batch 259, loss: 0.0000, instance_loss: 0.0647, weighted_loss: 0.0194, label: 3, bag_size: 24
batch 279, loss: 0.0257, instance_loss: 0.1312, weighted_loss: 0.0573, label: 1, bag_size: 1325
batch 299, loss: 0.0067, instance_loss: 0.1534, weighted_loss: 0.0507, label: 4, bag_size: 823
batch 319, loss: 0.0345, instance_loss: 0.5258, weighted_loss: 0.1819, label: 4, bag_size: 511
batch 339, loss: 0.0972, instance_loss: 0.4263, weighted_loss: 0.1959, label: 1, bag_size: 377
batch 359, loss: 0.4701, instance_loss: 0.7486, weighted_loss: 0.5537, label: 3, bag_size: 607
batch 379, loss: 0.0638, instance_loss: 0.4973, weighted_loss: 0.1939, label: 3, bag_size: 671
batch 399, loss: 0.0229, instance_loss: 0.1081, weighted_loss: 0.0485, label: 1, bag_size: 1191
batch 419, loss: 0.0001, instance_loss: 0.3863, weighted_loss: 0.1159, label: 4, bag_size: 711
batch 439, loss: 0.0020, instance_loss: 0.0359, weighted_loss: 0.0122, label: 0, bag_size: 1143
batch 459, loss: 0.0880, instance_loss: 0.5160, weighted_loss: 0.2164, label: 4, bag_size: 1360
batch 479, loss: 0.2213, instance_loss: 0.7104, weighted_loss: 0.3681, label: 1, bag_size: 917
batch 499, loss: 0.0411, instance_loss: 0.3319, weighted_loss: 0.1283, label: 1, bag_size: 968
batch 519, loss: 0.0001, instance_loss: 0.0211, weighted_loss: 0.0064, label: 1, bag_size: 937
batch 539, loss: 0.0438, instance_loss: 0.1194, weighted_loss: 0.0665, label: 3, bag_size: 1177


class 0 clustering acc 0.9867431192660551: correct 21511/21800
class 1 clustering acc 0.5605504587155963: correct 2444/4360
Epoch: 48, train_loss: 0.0936, train_clustering_loss:  0.2481, train_error: 0.0330
class 0: acc 0.9611650485436893, correct 99/103
class 1: acc 0.91, correct 91/100
class 2: acc 0.9619047619047619, correct 101/105
class 3: acc 1.0, correct 130/130
class 4: acc 0.9906542056074766, correct 106/107

Val Set, val_loss: 0.9996, val_error: 0.2400, auc: 0.9223
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.465: correct 186/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0735, instance_loss: 0.9766, weighted_loss: 0.3444, label: 1, bag_size: 778
batch 39, loss: 0.0210, instance_loss: 0.1659, weighted_loss: 0.0645, label: 3, bag_size: 24
batch 59, loss: 0.0000, instance_loss: 0.0766, weighted_loss: 0.0230, label: 3, bag_size: 18
batch 79, loss: 0.1325, instance_loss: 0.1216, weighted_loss: 0.1292, label: 1, bag_size: 1426
batch 99, loss: 0.0005, instance_loss: 0.0433, weighted_loss: 0.0133, label: 3, bag_size: 20
batch 119, loss: 0.0000, instance_loss: 0.1215, weighted_loss: 0.0364, label: 3, bag_size: 19
batch 139, loss: 0.0011, instance_loss: 0.2649, weighted_loss: 0.0802, label: 3, bag_size: 936
batch 159, loss: 0.0015, instance_loss: 0.0274, weighted_loss: 0.0093, label: 4, bag_size: 182
batch 179, loss: 0.0135, instance_loss: 0.0715, weighted_loss: 0.0309, label: 3, bag_size: 53
batch 199, loss: 0.0007, instance_loss: 0.0536, weighted_loss: 0.0165, label: 4, bag_size: 47
batch 219, loss: 0.0001, instance_loss: 0.0722, weighted_loss: 0.0217, label: 4, bag_size: 44
batch 239, loss: 0.0393, instance_loss: 0.1487, weighted_loss: 0.0721, label: 1, bag_size: 696
batch 259, loss: 0.0006, instance_loss: 0.4128, weighted_loss: 0.1243, label: 4, bag_size: 1357
batch 279, loss: 0.1104, instance_loss: 0.4296, weighted_loss: 0.2061, label: 1, bag_size: 700
batch 299, loss: 0.0003, instance_loss: 0.0555, weighted_loss: 0.0168, label: 4, bag_size: 162
batch 319, loss: 0.0019, instance_loss: 0.1394, weighted_loss: 0.0431, label: 0, bag_size: 466
batch 339, loss: 0.0983, instance_loss: 0.4091, weighted_loss: 0.1916, label: 1, bag_size: 868
batch 359, loss: 0.0232, instance_loss: 0.1400, weighted_loss: 0.0582, label: 2, bag_size: 848
batch 379, loss: 0.0023, instance_loss: 0.3342, weighted_loss: 0.1019, label: 1, bag_size: 965
batch 399, loss: 0.0044, instance_loss: 0.2336, weighted_loss: 0.0732, label: 1, bag_size: 790
batch 419, loss: 0.0000, instance_loss: 0.0307, weighted_loss: 0.0092, label: 4, bag_size: 148
batch 439, loss: 0.0001, instance_loss: 0.0208, weighted_loss: 0.0063, label: 4, bag_size: 211
batch 459, loss: 0.0006, instance_loss: 0.1288, weighted_loss: 0.0391, label: 4, bag_size: 24
batch 479, loss: 0.0482, instance_loss: 0.6675, weighted_loss: 0.2340, label: 1, bag_size: 386
batch 499, loss: 0.0002, instance_loss: 0.2118, weighted_loss: 0.0637, label: 0, bag_size: 128
batch 519, loss: 0.0010, instance_loss: 0.0560, weighted_loss: 0.0175, label: 0, bag_size: 1034
batch 539, loss: 0.0028, instance_loss: 0.3096, weighted_loss: 0.0948, label: 3, bag_size: 706


class 0 clustering acc 0.9865137614678899: correct 21506/21800
class 1 clustering acc 0.5903669724770643: correct 2574/4360
Epoch: 49, train_loss: 0.0894, train_clustering_loss:  0.2359, train_error: 0.0294
class 0: acc 0.9801980198019802, correct 99/101
class 1: acc 0.9148936170212766, correct 86/94
class 2: acc 0.9512195121951219, correct 117/123
class 3: acc 1.0, correct 98/98
class 4: acc 1.0, correct 129/129

Val Set, val_loss: 0.9466, val_error: 0.2200, auc: 0.9267
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.4825: correct 193/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0410, weighted_loss: 0.0125, label: 0, bag_size: 898
batch 39, loss: 0.0117, instance_loss: 0.4254, weighted_loss: 0.1358, label: 2, bag_size: 324
batch 59, loss: 0.0010, instance_loss: 0.2908, weighted_loss: 0.0880, label: 4, bag_size: 388
batch 79, loss: 0.0000, instance_loss: 0.0687, weighted_loss: 0.0206, label: 3, bag_size: 24
batch 99, loss: 0.0115, instance_loss: 0.2735, weighted_loss: 0.0901, label: 0, bag_size: 176
batch 119, loss: 0.0380, instance_loss: 0.4243, weighted_loss: 0.1539, label: 1, bag_size: 343
batch 139, loss: 0.0574, instance_loss: 0.8051, weighted_loss: 0.2817, label: 1, bag_size: 657
batch 159, loss: 0.6437, instance_loss: 0.3779, weighted_loss: 0.5640, label: 2, bag_size: 323
batch 179, loss: 0.0001, instance_loss: 0.0187, weighted_loss: 0.0057, label: 4, bag_size: 43
batch 199, loss: 0.0106, instance_loss: 0.2259, weighted_loss: 0.0752, label: 4, bag_size: 542
batch 219, loss: 0.0000, instance_loss: 0.0266, weighted_loss: 0.0080, label: 4, bag_size: 160
batch 239, loss: 1.4434, instance_loss: 0.3888, weighted_loss: 1.1270, label: 0, bag_size: 116
batch 259, loss: 0.0011, instance_loss: 0.0591, weighted_loss: 0.0185, label: 0, bag_size: 1143
batch 279, loss: 0.0877, instance_loss: 0.5895, weighted_loss: 0.2382, label: 4, bag_size: 882
batch 299, loss: 0.1751, instance_loss: 0.6195, weighted_loss: 0.3084, label: 1, bag_size: 1255
batch 319, loss: 0.0464, instance_loss: 0.2386, weighted_loss: 0.1041, label: 1, bag_size: 614
batch 339, loss: 0.0086, instance_loss: 0.1351, weighted_loss: 0.0465, label: 1, bag_size: 288
batch 359, loss: 0.0001, instance_loss: 0.1092, weighted_loss: 0.0328, label: 3, bag_size: 18
batch 379, loss: 0.0009, instance_loss: 0.0377, weighted_loss: 0.0119, label: 0, bag_size: 653
batch 399, loss: 0.0007, instance_loss: 0.1754, weighted_loss: 0.0531, label: 0, bag_size: 122
batch 419, loss: 0.1581, instance_loss: 0.4987, weighted_loss: 0.2603, label: 3, bag_size: 841
batch 439, loss: 0.0079, instance_loss: 0.1961, weighted_loss: 0.0644, label: 0, bag_size: 607
batch 459, loss: 0.0114, instance_loss: 0.4015, weighted_loss: 0.1284, label: 1, bag_size: 838
batch 479, loss: 0.0000, instance_loss: 0.1237, weighted_loss: 0.0371, label: 4, bag_size: 185
batch 499, loss: 0.0773, instance_loss: 0.2237, weighted_loss: 0.1212, label: 1, bag_size: 348
batch 519, loss: 0.0017, instance_loss: 0.2054, weighted_loss: 0.0628, label: 1, bag_size: 690
batch 539, loss: 0.0008, instance_loss: 0.3972, weighted_loss: 0.1197, label: 3, bag_size: 841


class 0 clustering acc 0.984954128440367: correct 21472/21800
class 1 clustering acc 0.563302752293578: correct 2456/4360
Epoch: 50, train_loss: 0.1392, train_clustering_loss:  0.2586, train_error: 0.0532
class 0: acc 0.9626168224299065, correct 103/107
class 1: acc 0.8857142857142857, correct 93/105
class 2: acc 0.9166666666666666, correct 110/120
class 3: acc 0.9910714285714286, correct 111/112
class 4: acc 0.9801980198019802, correct 99/101

Val Set, val_loss: 0.9928, val_error: 0.2600, auc: 0.9261
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.5075: correct 203/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.8333333333333334, correct 5/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0033, instance_loss: 0.1122, weighted_loss: 0.0359, label: 2, bag_size: 525
batch 39, loss: 0.0001, instance_loss: 0.0124, weighted_loss: 0.0038, label: 4, bag_size: 157
batch 59, loss: 0.0176, instance_loss: 0.7999, weighted_loss: 0.2523, label: 1, bag_size: 1409
batch 79, loss: 0.0002, instance_loss: 0.0593, weighted_loss: 0.0179, label: 4, bag_size: 83
batch 99, loss: 0.0033, instance_loss: 0.1049, weighted_loss: 0.0338, label: 0, bag_size: 1135
batch 119, loss: 0.0011, instance_loss: 0.3893, weighted_loss: 0.1175, label: 4, bag_size: 974
batch 139, loss: 0.0587, instance_loss: 0.6153, weighted_loss: 0.2257, label: 4, bag_size: 366
batch 159, loss: 0.0044, instance_loss: 0.0641, weighted_loss: 0.0223, label: 4, bag_size: 38
batch 179, loss: 0.0403, instance_loss: 0.6846, weighted_loss: 0.2336, label: 3, bag_size: 607
batch 199, loss: 0.0011, instance_loss: 0.0991, weighted_loss: 0.0305, label: 0, bag_size: 1174
batch 219, loss: 0.0062, instance_loss: 0.1449, weighted_loss: 0.0478, label: 2, bag_size: 2081
batch 239, loss: 0.3953, instance_loss: 0.3471, weighted_loss: 0.3808, label: 1, bag_size: 1144
batch 259, loss: 0.0591, instance_loss: 0.7769, weighted_loss: 0.2744, label: 3, bag_size: 281
batch 279, loss: 0.0742, instance_loss: 0.6806, weighted_loss: 0.2561, label: 1, bag_size: 293
batch 299, loss: 0.1611, instance_loss: 0.4833, weighted_loss: 0.2578, label: 3, bag_size: 305
batch 319, loss: 0.1301, instance_loss: 0.5157, weighted_loss: 0.2457, label: 2, bag_size: 1128
batch 339, loss: 0.0004, instance_loss: 0.0754, weighted_loss: 0.0229, label: 0, bag_size: 413
batch 359, loss: 0.7871, instance_loss: 0.7693, weighted_loss: 0.7817, label: 0, bag_size: 1065
batch 379, loss: 0.0077, instance_loss: 0.2972, weighted_loss: 0.0946, label: 3, bag_size: 697
batch 399, loss: 0.3399, instance_loss: 0.4892, weighted_loss: 0.3847, label: 1, bag_size: 660
batch 419, loss: 0.0017, instance_loss: 0.1612, weighted_loss: 0.0496, label: 4, bag_size: 524
batch 439, loss: 0.0395, instance_loss: 0.2509, weighted_loss: 0.1029, label: 0, bag_size: 1289
batch 459, loss: 0.2987, instance_loss: 0.3441, weighted_loss: 0.3123, label: 1, bag_size: 1144
batch 479, loss: 0.0021, instance_loss: 0.0406, weighted_loss: 0.0137, label: 3, bag_size: 143
batch 499, loss: 0.0075, instance_loss: 0.0770, weighted_loss: 0.0284, label: 4, bag_size: 162
batch 519, loss: 0.0004, instance_loss: 0.0553, weighted_loss: 0.0169, label: 3, bag_size: 123
batch 539, loss: 0.0054, instance_loss: 0.2097, weighted_loss: 0.0667, label: 4, bag_size: 656


class 0 clustering acc 0.9861467889908256: correct 21498/21800
class 1 clustering acc 0.575: correct 2507/4360
Epoch: 51, train_loss: 0.1076, train_clustering_loss:  0.2501, train_error: 0.0294
class 0: acc 0.9611650485436893, correct 99/103
class 1: acc 0.9439252336448598, correct 101/107
class 2: acc 0.9553571428571429, correct 107/112
class 3: acc 0.9905660377358491, correct 105/106
class 4: acc 1.0, correct 117/117

Val Set, val_loss: 0.9408, val_error: 0.2600, auc: 0.9288
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.49: correct 196/400
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 1.0, correct 6/6
class 4: acc 0.4, correct 2/5
EarlyStopping counter: 23 out of 20
Early stopping
Val error: 0.2200, ROC AUC: 0.9494
Test error: 0.4000, ROC AUC: 0.7616
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.65, correct 13/20
class 3: acc 0.0, correct 0/2
class 4: acc 0.5, correct 2/4

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.3829, instance_loss: 1.2217, weighted_loss: 1.3345, label: 1, bag_size: 377
batch 39, loss: 1.6713, instance_loss: 1.0966, weighted_loss: 1.4989, label: 0, bag_size: 143
batch 59, loss: 1.5741, instance_loss: 0.9137, weighted_loss: 1.3760, label: 4, bag_size: 78
batch 79, loss: 1.4986, instance_loss: 0.7667, weighted_loss: 1.2790, label: 0, bag_size: 381
batch 99, loss: 1.4042, instance_loss: 0.5342, weighted_loss: 1.1432, label: 1, bag_size: 847
batch 119, loss: 1.4643, instance_loss: 0.5619, weighted_loss: 1.1936, label: 0, bag_size: 143
batch 139, loss: 1.7507, instance_loss: 0.5341, weighted_loss: 1.3858, label: 3, bag_size: 849
batch 159, loss: 1.4608, instance_loss: 0.5383, weighted_loss: 1.1840, label: 3, bag_size: 46
batch 179, loss: 1.7101, instance_loss: 0.5526, weighted_loss: 1.3628, label: 0, bag_size: 128
batch 199, loss: 1.6805, instance_loss: 0.5478, weighted_loss: 1.3407, label: 3, bag_size: 1380
batch 219, loss: 1.5518, instance_loss: 0.5195, weighted_loss: 1.2421, label: 1, bag_size: 442
batch 239, loss: 1.4208, instance_loss: 0.5287, weighted_loss: 1.1532, label: 2, bag_size: 461
batch 259, loss: 1.4891, instance_loss: 0.5197, weighted_loss: 1.1983, label: 3, bag_size: 1253
batch 279, loss: 1.9081, instance_loss: 0.5606, weighted_loss: 1.5038, label: 0, bag_size: 148
batch 299, loss: 1.7912, instance_loss: 0.5537, weighted_loss: 1.4200, label: 2, bag_size: 511
batch 319, loss: 1.7141, instance_loss: 0.5392, weighted_loss: 1.3616, label: 2, bag_size: 237
batch 339, loss: 1.3198, instance_loss: 0.5149, weighted_loss: 1.0783, label: 0, bag_size: 616
batch 359, loss: 1.5282, instance_loss: 0.5285, weighted_loss: 1.2283, label: 2, bag_size: 959
batch 379, loss: 1.7437, instance_loss: 0.5455, weighted_loss: 1.3843, label: 1, bag_size: 818
batch 399, loss: 1.2825, instance_loss: 0.5217, weighted_loss: 1.0543, label: 1, bag_size: 1086
batch 419, loss: 1.0877, instance_loss: 0.5080, weighted_loss: 0.9138, label: 1, bag_size: 318
batch 439, loss: 1.3997, instance_loss: 0.4695, weighted_loss: 1.1207, label: 3, bag_size: 200
batch 459, loss: 2.1201, instance_loss: 0.5389, weighted_loss: 1.6457, label: 4, bag_size: 773
batch 479, loss: 1.2212, instance_loss: 0.4796, weighted_loss: 0.9987, label: 3, bag_size: 20
batch 499, loss: 1.6453, instance_loss: 0.4952, weighted_loss: 1.3003, label: 3, bag_size: 316
batch 519, loss: 0.4368, instance_loss: 0.4073, weighted_loss: 0.4279, label: 4, bag_size: 23
batch 539, loss: 1.0165, instance_loss: 0.4732, weighted_loss: 0.8535, label: 1, bag_size: 346


class 0 clustering acc 0.9959633027522936: correct 21712/21800
class 1 clustering acc 0.0009174311926605505: correct 4/4360
Epoch: 0, train_loss: 1.4860, train_clustering_loss:  0.6016, train_error: 0.6202
class 0: acc 0.1875, correct 21/112
class 1: acc 0.6521739130434783, correct 75/115
class 2: acc 0.056818181818181816, correct 5/88
class 3: acc 0.368, correct 46/125
class 4: acc 0.5714285714285714, correct 60/105

Val Set, val_loss: 1.4001, val_error: 0.6000, auc: 0.7480
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/6
class 1: acc 1.0, correct 16/16
class 2: acc 0.0, correct 0/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
Validation loss decreased (inf --> 1.400060).  Saving model ...


batch 19, loss: 1.5596, instance_loss: 0.5457, weighted_loss: 1.2555, label: 2, bag_size: 1617
batch 39, loss: 1.5193, instance_loss: 0.5074, weighted_loss: 1.2158, label: 0, bag_size: 912
batch 59, loss: 1.6330, instance_loss: 0.5145, weighted_loss: 1.2974, label: 0, bag_size: 375
batch 79, loss: 0.3629, instance_loss: 0.3029, weighted_loss: 0.3449, label: 4, bag_size: 86
batch 99, loss: 0.8212, instance_loss: 0.4449, weighted_loss: 0.7083, label: 1, bag_size: 1239
batch 119, loss: 1.5328, instance_loss: 0.5083, weighted_loss: 1.2254, label: 2, bag_size: 471
batch 139, loss: 1.5465, instance_loss: 0.4881, weighted_loss: 1.2290, label: 2, bag_size: 1108
batch 159, loss: 1.2770, instance_loss: 0.4860, weighted_loss: 1.0397, label: 1, bag_size: 917
batch 179, loss: 0.2603, instance_loss: 0.2418, weighted_loss: 0.2547, label: 4, bag_size: 86
batch 199, loss: 0.8577, instance_loss: 0.4657, weighted_loss: 0.7401, label: 3, bag_size: 20
batch 219, loss: 1.4513, instance_loss: 0.4533, weighted_loss: 1.1519, label: 3, bag_size: 1253
batch 239, loss: 0.4443, instance_loss: 0.3766, weighted_loss: 0.4240, label: 3, bag_size: 20
batch 259, loss: 1.6045, instance_loss: 0.5199, weighted_loss: 1.2791, label: 0, bag_size: 245
batch 279, loss: 1.2559, instance_loss: 0.5030, weighted_loss: 1.0300, label: 0, bag_size: 607
batch 299, loss: 0.7911, instance_loss: 0.4427, weighted_loss: 0.6865, label: 1, bag_size: 399
batch 319, loss: 1.3685, instance_loss: 0.5086, weighted_loss: 1.1105, label: 0, bag_size: 545
batch 339, loss: 1.2424, instance_loss: 0.5089, weighted_loss: 1.0224, label: 2, bag_size: 861
batch 359, loss: 1.7583, instance_loss: 0.5877, weighted_loss: 1.4071, label: 2, bag_size: 358
batch 379, loss: 2.2507, instance_loss: 0.6981, weighted_loss: 1.7849, label: 0, bag_size: 116
batch 399, loss: 1.3361, instance_loss: 0.5187, weighted_loss: 1.0909, label: 0, bag_size: 1301
batch 419, loss: 0.4737, instance_loss: 0.3813, weighted_loss: 0.4459, label: 3, bag_size: 18
batch 439, loss: 1.4304, instance_loss: 0.4567, weighted_loss: 1.1383, label: 1, bag_size: 660
batch 459, loss: 1.1926, instance_loss: 0.4976, weighted_loss: 0.9841, label: 0, bag_size: 437
batch 479, loss: 2.5543, instance_loss: 0.5574, weighted_loss: 1.9552, label: 3, bag_size: 952
batch 499, loss: 1.4340, instance_loss: 0.4938, weighted_loss: 1.1519, label: 2, bag_size: 911
batch 519, loss: 1.6857, instance_loss: 0.4824, weighted_loss: 1.3247, label: 1, bag_size: 1197
batch 539, loss: 1.2156, instance_loss: 0.4781, weighted_loss: 0.9944, label: 1, bag_size: 1096


class 0 clustering acc 0.9998623853211009: correct 21797/21800
class 1 clustering acc 0.005733944954128441: correct 25/4360
Epoch: 1, train_loss: 1.2318, train_clustering_loss:  0.4683, train_error: 0.4807
class 0: acc 0.1827956989247312, correct 17/93
class 1: acc 0.652542372881356, correct 77/118
class 2: acc 0.3783783783783784, correct 42/111
class 3: acc 0.6349206349206349, correct 80/126
class 4: acc 0.6907216494845361, correct 67/97

Val Set, val_loss: 1.1780, val_error: 0.4200, auc: 0.7703
class 0 clustering acc 0.9995: correct 1999/2000
class 1 clustering acc 0.015: correct 6/400
class 0: acc 0.0, correct 0/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
Validation loss decreased (1.400060 --> 1.177993).  Saving model ...


batch 19, loss: 1.6027, instance_loss: 0.4582, weighted_loss: 1.2593, label: 3, bag_size: 1250
batch 39, loss: 0.9828, instance_loss: 0.4531, weighted_loss: 0.8239, label: 1, bag_size: 504
batch 59, loss: 1.2668, instance_loss: 0.4662, weighted_loss: 1.0267, label: 1, bag_size: 1096
batch 79, loss: 0.0981, instance_loss: 0.1019, weighted_loss: 0.0992, label: 4, bag_size: 137
batch 99, loss: 1.3684, instance_loss: 0.5001, weighted_loss: 1.1079, label: 2, bag_size: 932
batch 119, loss: 1.0068, instance_loss: 0.3855, weighted_loss: 0.8204, label: 1, bag_size: 648
batch 139, loss: 1.0268, instance_loss: 0.3893, weighted_loss: 0.8356, label: 1, bag_size: 867
batch 159, loss: 1.8983, instance_loss: 0.5365, weighted_loss: 1.4898, label: 2, bag_size: 194
batch 179, loss: 0.5121, instance_loss: 0.3270, weighted_loss: 0.4566, label: 1, bag_size: 318
batch 199, loss: 0.6066, instance_loss: 0.3879, weighted_loss: 0.5410, label: 3, bag_size: 305
batch 219, loss: 0.4010, instance_loss: 0.3407, weighted_loss: 0.3829, label: 3, bag_size: 56
batch 239, loss: 0.5042, instance_loss: 0.3290, weighted_loss: 0.4516, label: 4, bag_size: 23
batch 259, loss: 1.3860, instance_loss: 0.4437, weighted_loss: 1.1033, label: 1, bag_size: 1144
batch 279, loss: 1.2433, instance_loss: 0.4254, weighted_loss: 0.9979, label: 1, bag_size: 386
batch 299, loss: 0.5896, instance_loss: 0.3254, weighted_loss: 0.5104, label: 1, bag_size: 1376
batch 319, loss: 2.0629, instance_loss: 0.6613, weighted_loss: 1.6424, label: 3, bag_size: 706
batch 339, loss: 1.5385, instance_loss: 0.4944, weighted_loss: 1.2252, label: 2, bag_size: 1006
batch 359, loss: 1.5598, instance_loss: 0.5198, weighted_loss: 1.2478, label: 1, bag_size: 897
batch 379, loss: 0.8084, instance_loss: 0.4222, weighted_loss: 0.6925, label: 2, bag_size: 317
batch 399, loss: 1.4351, instance_loss: 0.5022, weighted_loss: 1.1552, label: 1, bag_size: 102
batch 419, loss: 0.2930, instance_loss: 0.2511, weighted_loss: 0.2804, label: 3, bag_size: 75
batch 439, loss: 1.4076, instance_loss: 0.4651, weighted_loss: 1.1248, label: 2, bag_size: 323
batch 459, loss: 0.9705, instance_loss: 0.4386, weighted_loss: 0.8109, label: 0, bag_size: 423
batch 479, loss: 2.4244, instance_loss: 0.6981, weighted_loss: 1.9065, label: 3, bag_size: 706
batch 499, loss: 1.6140, instance_loss: 0.6872, weighted_loss: 1.3360, label: 0, bag_size: 128
batch 519, loss: 2.1364, instance_loss: 0.4376, weighted_loss: 1.6268, label: 3, bag_size: 1380
batch 539, loss: 1.0012, instance_loss: 0.3895, weighted_loss: 0.8177, label: 1, bag_size: 1402


class 0 clustering acc 0.9957339449541285: correct 21707/21800
class 1 clustering acc 0.10022935779816514: correct 437/4360
Epoch: 2, train_loss: 1.1093, train_clustering_loss:  0.4310, train_error: 0.4477
class 0: acc 0.18518518518518517, correct 20/108
class 1: acc 0.7592592592592593, correct 82/108
class 2: acc 0.46153846153846156, correct 54/117
class 3: acc 0.7009345794392523, correct 75/107
class 4: acc 0.6666666666666666, correct 70/105

Val Set, val_loss: 1.0698, val_error: 0.3600, auc: 0.8221
class 0 clustering acc 0.9995: correct 1999/2000
class 1 clustering acc 0.0325: correct 13/400
class 0: acc 0.0, correct 0/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
Validation loss decreased (1.177993 --> 1.069756).  Saving model ...


batch 19, loss: 1.4177, instance_loss: 0.5071, weighted_loss: 1.1445, label: 0, bag_size: 921
batch 39, loss: 0.9889, instance_loss: 0.4266, weighted_loss: 0.8202, label: 2, bag_size: 356
batch 59, loss: 0.8020, instance_loss: 0.3645, weighted_loss: 0.6707, label: 2, bag_size: 614
batch 79, loss: 1.0824, instance_loss: 0.4524, weighted_loss: 0.8934, label: 0, bag_size: 607
batch 99, loss: 0.9730, instance_loss: 0.4695, weighted_loss: 0.8219, label: 0, bag_size: 630
batch 119, loss: 2.1038, instance_loss: 0.6195, weighted_loss: 1.6585, label: 3, bag_size: 936
batch 139, loss: 0.5180, instance_loss: 0.2959, weighted_loss: 0.4514, label: 3, bag_size: 305
batch 159, loss: 1.1410, instance_loss: 0.4800, weighted_loss: 0.9427, label: 2, bag_size: 750
batch 179, loss: 1.3166, instance_loss: 0.4360, weighted_loss: 1.0524, label: 1, bag_size: 1390
batch 199, loss: 0.1154, instance_loss: 0.1690, weighted_loss: 0.1315, label: 3, bag_size: 28
batch 219, loss: 0.8670, instance_loss: 0.3739, weighted_loss: 0.7191, label: 1, bag_size: 504
batch 239, loss: 0.7780, instance_loss: 0.3510, weighted_loss: 0.6499, label: 1, bag_size: 504
batch 259, loss: 0.4957, instance_loss: 0.2948, weighted_loss: 0.4354, label: 1, bag_size: 696
batch 279, loss: 0.3152, instance_loss: 0.2198, weighted_loss: 0.2866, label: 1, bag_size: 1086
batch 299, loss: 1.2512, instance_loss: 0.3397, weighted_loss: 0.9778, label: 3, bag_size: 697
batch 319, loss: 0.8332, instance_loss: 0.2851, weighted_loss: 0.6688, label: 3, bag_size: 556
batch 339, loss: 1.8767, instance_loss: 0.5734, weighted_loss: 1.4857, label: 4, bag_size: 1235
batch 359, loss: 0.1283, instance_loss: 0.1880, weighted_loss: 0.1462, label: 3, bag_size: 19
batch 379, loss: 1.3025, instance_loss: 0.4413, weighted_loss: 1.0441, label: 1, bag_size: 651
batch 399, loss: 0.7022, instance_loss: 0.4434, weighted_loss: 0.6246, label: 2, bag_size: 351
batch 419, loss: 0.7663, instance_loss: 0.4370, weighted_loss: 0.6675, label: 2, bag_size: 1052
batch 439, loss: 0.6666, instance_loss: 0.3808, weighted_loss: 0.5809, label: 2, bag_size: 758
batch 459, loss: 0.9766, instance_loss: 0.3743, weighted_loss: 0.7959, label: 1, bag_size: 868
batch 479, loss: 1.4029, instance_loss: 0.4517, weighted_loss: 1.1175, label: 1, bag_size: 448
batch 499, loss: 0.1875, instance_loss: 0.1370, weighted_loss: 0.1723, label: 4, bag_size: 160
batch 519, loss: 1.6431, instance_loss: 0.5587, weighted_loss: 1.3178, label: 4, bag_size: 590
batch 539, loss: 0.7181, instance_loss: 0.3692, weighted_loss: 0.6134, label: 2, bag_size: 270


class 0 clustering acc 0.9958256880733944: correct 21709/21800
class 1 clustering acc 0.12064220183486239: correct 526/4360
Epoch: 3, train_loss: 1.0037, train_clustering_loss:  0.4123, train_error: 0.3596
class 0: acc 0.46846846846846846, correct 52/111
class 1: acc 0.6942148760330579, correct 84/121
class 2: acc 0.6974789915966386, correct 83/119
class 3: acc 0.7419354838709677, correct 69/93
class 4: acc 0.6039603960396039, correct 61/101

Val Set, val_loss: 1.0437, val_error: 0.3000, auc: 0.8280
class 0 clustering acc 0.9965: correct 1993/2000
class 1 clustering acc 0.07: correct 28/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.5625, correct 9/16
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
Validation loss decreased (1.069756 --> 1.043713).  Saving model ...


batch 19, loss: 0.8129, instance_loss: 0.4195, weighted_loss: 0.6949, label: 0, bag_size: 367
batch 39, loss: 0.5740, instance_loss: 0.3639, weighted_loss: 0.5110, label: 0, bag_size: 402
batch 59, loss: 0.1615, instance_loss: 0.0992, weighted_loss: 0.1428, label: 4, bag_size: 178
batch 79, loss: 0.7394, instance_loss: 0.3808, weighted_loss: 0.6318, label: 2, bag_size: 1410
batch 99, loss: 2.4210, instance_loss: 0.6828, weighted_loss: 1.8995, label: 3, bag_size: 706
batch 119, loss: 0.3606, instance_loss: 0.2165, weighted_loss: 0.3174, label: 1, bag_size: 636
batch 139, loss: 1.8741, instance_loss: 0.5760, weighted_loss: 1.4847, label: 0, bag_size: 1289
batch 159, loss: 0.3464, instance_loss: 0.2296, weighted_loss: 0.3114, label: 1, bag_size: 636
batch 179, loss: 0.7870, instance_loss: 0.3529, weighted_loss: 0.6568, label: 1, bag_size: 847
batch 199, loss: 0.1477, instance_loss: 0.1515, weighted_loss: 0.1489, label: 3, bag_size: 18
batch 219, loss: 0.0513, instance_loss: 0.0892, weighted_loss: 0.0627, label: 4, bag_size: 140
batch 239, loss: 0.9958, instance_loss: 0.4440, weighted_loss: 0.8302, label: 2, bag_size: 351
batch 259, loss: 0.1393, instance_loss: 0.1065, weighted_loss: 0.1295, label: 3, bag_size: 1559
batch 279, loss: 0.6453, instance_loss: 0.3146, weighted_loss: 0.5461, label: 3, bag_size: 936
batch 299, loss: 1.3330, instance_loss: 0.5542, weighted_loss: 1.0994, label: 4, bag_size: 656
batch 319, loss: 0.2953, instance_loss: 0.2409, weighted_loss: 0.2790, label: 3, bag_size: 31
batch 339, loss: 1.5376, instance_loss: 0.4429, weighted_loss: 1.2092, label: 1, bag_size: 487
batch 359, loss: 0.0662, instance_loss: 0.1293, weighted_loss: 0.0851, label: 3, bag_size: 26
batch 379, loss: 0.7676, instance_loss: 0.4519, weighted_loss: 0.6729, label: 0, bag_size: 1046
batch 399, loss: 0.9940, instance_loss: 0.5082, weighted_loss: 0.8483, label: 0, bag_size: 736
batch 419, loss: 1.0587, instance_loss: 0.4486, weighted_loss: 0.8757, label: 1, bag_size: 700
batch 439, loss: 0.8389, instance_loss: 0.4067, weighted_loss: 0.7092, label: 2, bag_size: 868
batch 459, loss: 0.5295, instance_loss: 0.3362, weighted_loss: 0.4715, label: 0, bag_size: 446
batch 479, loss: 1.9617, instance_loss: 0.5315, weighted_loss: 1.5327, label: 1, bag_size: 660
batch 499, loss: 0.1301, instance_loss: 0.0894, weighted_loss: 0.1179, label: 4, bag_size: 86
batch 519, loss: 1.1821, instance_loss: 0.5170, weighted_loss: 0.9826, label: 0, bag_size: 1086
batch 539, loss: 0.1183, instance_loss: 0.1197, weighted_loss: 0.1187, label: 1, bag_size: 1086


class 0 clustering acc 0.9935321100917431: correct 21659/21800
class 1 clustering acc 0.24518348623853212: correct 1069/4360
Epoch: 4, train_loss: 0.8691, train_clustering_loss:  0.3742, train_error: 0.3339
class 0: acc 0.6339285714285714, correct 71/112
class 1: acc 0.6532258064516129, correct 81/124
class 2: acc 0.4606741573033708, correct 41/89
class 3: acc 0.7927927927927928, correct 88/111
class 4: acc 0.7522935779816514, correct 82/109

Val Set, val_loss: 0.9352, val_error: 0.3600, auc: 0.8655
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.195: correct 78/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.8125, correct 13/16
class 2: acc 0.5238095238095238, correct 11/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
Validation loss decreased (1.043713 --> 0.935226).  Saving model ...


batch 19, loss: 0.8141, instance_loss: 0.4130, weighted_loss: 0.6937, label: 0, bag_size: 1517
batch 39, loss: 0.6374, instance_loss: 0.3998, weighted_loss: 0.5661, label: 0, bag_size: 1190
batch 59, loss: 0.9574, instance_loss: 0.3818, weighted_loss: 0.7848, label: 1, bag_size: 442
batch 79, loss: 0.5484, instance_loss: 0.4032, weighted_loss: 0.5048, label: 0, bag_size: 478
batch 99, loss: 0.5993, instance_loss: 0.3700, weighted_loss: 0.5305, label: 2, bag_size: 1200
batch 119, loss: 0.2143, instance_loss: 0.1216, weighted_loss: 0.1865, label: 4, bag_size: 148
batch 139, loss: 2.8821, instance_loss: 0.8116, weighted_loss: 2.2609, label: 3, bag_size: 200
batch 159, loss: 0.3523, instance_loss: 0.2041, weighted_loss: 0.3079, label: 1, bag_size: 1127
batch 179, loss: 2.1215, instance_loss: 0.6618, weighted_loss: 1.6836, label: 3, bag_size: 630
batch 199, loss: 0.2233, instance_loss: 0.1569, weighted_loss: 0.2033, label: 1, bag_size: 1127
batch 219, loss: 0.0930, instance_loss: 0.1524, weighted_loss: 0.1108, label: 4, bag_size: 114
batch 239, loss: 1.8206, instance_loss: 0.8727, weighted_loss: 1.5362, label: 0, bag_size: 114
batch 259, loss: 1.0747, instance_loss: 0.5845, weighted_loss: 0.9276, label: 3, bag_size: 849
batch 279, loss: 0.6431, instance_loss: 0.3974, weighted_loss: 0.5694, label: 0, bag_size: 432
batch 299, loss: 0.1346, instance_loss: 0.1944, weighted_loss: 0.1526, label: 4, bag_size: 20
batch 319, loss: 1.6743, instance_loss: 0.6295, weighted_loss: 1.3609, label: 1, bag_size: 867
batch 339, loss: 0.6210, instance_loss: 0.3816, weighted_loss: 0.5492, label: 1, bag_size: 533
batch 359, loss: 1.1243, instance_loss: 0.5444, weighted_loss: 0.9503, label: 2, bag_size: 636
batch 379, loss: 0.6039, instance_loss: 0.5592, weighted_loss: 0.5905, label: 0, bag_size: 116
batch 399, loss: 0.6289, instance_loss: 0.4259, weighted_loss: 0.5680, label: 0, bag_size: 424
batch 419, loss: 0.9614, instance_loss: 0.5070, weighted_loss: 0.8251, label: 2, bag_size: 1677
batch 439, loss: 1.1692, instance_loss: 0.4298, weighted_loss: 0.9474, label: 1, bag_size: 1096
batch 459, loss: 0.5132, instance_loss: 0.3835, weighted_loss: 0.4743, label: 2, bag_size: 2826
batch 479, loss: 0.5116, instance_loss: 0.3332, weighted_loss: 0.4581, label: 2, bag_size: 404
batch 499, loss: 0.7712, instance_loss: 0.3498, weighted_loss: 0.6448, label: 1, bag_size: 343
batch 519, loss: 0.0649, instance_loss: 0.0747, weighted_loss: 0.0678, label: 3, bag_size: 115
batch 539, loss: 0.5517, instance_loss: 0.3828, weighted_loss: 0.5011, label: 2, bag_size: 324


class 0 clustering acc 0.9922935779816514: correct 21632/21800
class 1 clustering acc 0.2353211009174312: correct 1026/4360
Epoch: 5, train_loss: 0.8287, train_clustering_loss:  0.3746, train_error: 0.3009
class 0: acc 0.6403508771929824, correct 73/114
class 1: acc 0.7087378640776699, correct 73/103
class 2: acc 0.6132075471698113, correct 65/106
class 3: acc 0.7843137254901961, correct 80/102
class 4: acc 0.75, correct 90/120

Val Set, val_loss: 0.9841, val_error: 0.2800, auc: 0.8844
class 0 clustering acc 0.992: correct 1984/2000
class 1 clustering acc 0.1025: correct 41/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7612, instance_loss: 0.3823, weighted_loss: 0.6476, label: 2, bag_size: 1128
batch 39, loss: 1.6760, instance_loss: 0.6016, weighted_loss: 1.3537, label: 4, bag_size: 625
batch 59, loss: 0.0865, instance_loss: 0.1460, weighted_loss: 0.1044, label: 3, bag_size: 20
batch 79, loss: 0.6476, instance_loss: 0.3704, weighted_loss: 0.5644, label: 2, bag_size: 469
batch 99, loss: 0.2691, instance_loss: 0.2170, weighted_loss: 0.2535, label: 1, bag_size: 346
batch 119, loss: 0.2091, instance_loss: 0.2462, weighted_loss: 0.2202, label: 3, bag_size: 28
batch 139, loss: 0.9121, instance_loss: 0.4220, weighted_loss: 0.7651, label: 1, bag_size: 269
batch 159, loss: 1.4538, instance_loss: 0.5357, weighted_loss: 1.1784, label: 2, bag_size: 934
batch 179, loss: 1.0757, instance_loss: 0.4642, weighted_loss: 0.8923, label: 2, bag_size: 474
batch 199, loss: 0.4132, instance_loss: 0.3692, weighted_loss: 0.4000, label: 2, bag_size: 916
batch 219, loss: 0.1630, instance_loss: 0.1384, weighted_loss: 0.1557, label: 1, bag_size: 1261
batch 239, loss: 1.5962, instance_loss: 0.7370, weighted_loss: 1.3385, label: 4, bag_size: 826
batch 259, loss: 1.2757, instance_loss: 0.5409, weighted_loss: 1.0553, label: 2, bag_size: 373
batch 279, loss: 1.2375, instance_loss: 0.4935, weighted_loss: 1.0143, label: 2, bag_size: 245
batch 299, loss: 3.2987, instance_loss: 0.8370, weighted_loss: 2.5602, label: 4, bag_size: 210
batch 319, loss: 0.9789, instance_loss: 0.3910, weighted_loss: 0.8025, label: 2, bag_size: 911
batch 339, loss: 0.2875, instance_loss: 0.2488, weighted_loss: 0.2759, label: 3, bag_size: 15
batch 359, loss: 0.0526, instance_loss: 0.0919, weighted_loss: 0.0644, label: 3, bag_size: 43
batch 379, loss: 1.2649, instance_loss: 0.4370, weighted_loss: 1.0166, label: 1, bag_size: 1144
batch 399, loss: 0.5971, instance_loss: 0.4034, weighted_loss: 0.5390, label: 4, bag_size: 20
batch 419, loss: 0.6204, instance_loss: 0.3908, weighted_loss: 0.5515, label: 0, bag_size: 718
batch 439, loss: 0.3285, instance_loss: 0.3048, weighted_loss: 0.3214, label: 0, bag_size: 1872
batch 459, loss: 1.2907, instance_loss: 0.3630, weighted_loss: 1.0124, label: 3, bag_size: 533
batch 479, loss: 1.4522, instance_loss: 0.5652, weighted_loss: 1.1861, label: 2, bag_size: 959
batch 499, loss: 0.4833, instance_loss: 0.3110, weighted_loss: 0.4316, label: 1, bag_size: 405
batch 519, loss: 0.2760, instance_loss: 0.2908, weighted_loss: 0.2804, label: 2, bag_size: 758
batch 539, loss: 0.2162, instance_loss: 0.2559, weighted_loss: 0.2281, label: 0, bag_size: 521


class 0 clustering acc 0.9936697247706422: correct 21662/21800
class 1 clustering acc 0.23853211009174313: correct 1040/4360
Epoch: 6, train_loss: 0.7076, train_clustering_loss:  0.3537, train_error: 0.2440
class 0: acc 0.76, correct 95/125
class 1: acc 0.6636363636363637, correct 73/110
class 2: acc 0.7586206896551724, correct 88/116
class 3: acc 0.8144329896907216, correct 79/97
class 4: acc 0.7938144329896907, correct 77/97

Val Set, val_loss: 0.8468, val_error: 0.3400, auc: 0.9110
class 0 clustering acc 0.995: correct 1990/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.625, correct 10/16
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
Validation loss decreased (0.935226 --> 0.846762).  Saving model ...


batch 19, loss: 2.0291, instance_loss: 0.5690, weighted_loss: 1.5910, label: 1, bag_size: 657
batch 39, loss: 0.0111, instance_loss: 0.0702, weighted_loss: 0.0289, label: 3, bag_size: 56
batch 59, loss: 0.9005, instance_loss: 0.4628, weighted_loss: 0.7692, label: 4, bag_size: 773
batch 79, loss: 0.4094, instance_loss: 0.2292, weighted_loss: 0.3554, label: 1, bag_size: 1426
batch 99, loss: 0.5859, instance_loss: 0.3286, weighted_loss: 0.5087, label: 1, bag_size: 474
batch 119, loss: 0.0775, instance_loss: 0.1506, weighted_loss: 0.0994, label: 3, bag_size: 18
batch 139, loss: 0.2545, instance_loss: 0.3840, weighted_loss: 0.2934, label: 4, bag_size: 1176
batch 159, loss: 0.4361, instance_loss: 0.3292, weighted_loss: 0.4041, label: 2, bag_size: 312
batch 179, loss: 1.7980, instance_loss: 0.5650, weighted_loss: 1.4281, label: 2, bag_size: 679
batch 199, loss: 0.5951, instance_loss: 0.3404, weighted_loss: 0.5187, label: 2, bag_size: 738
batch 219, loss: 0.2609, instance_loss: 0.1548, weighted_loss: 0.2291, label: 1, bag_size: 1277
batch 239, loss: 1.3787, instance_loss: 0.4717, weighted_loss: 1.1066, label: 2, bag_size: 1006
batch 259, loss: 0.1715, instance_loss: 0.3220, weighted_loss: 0.2167, label: 0, bag_size: 1301
batch 279, loss: 0.7736, instance_loss: 0.4037, weighted_loss: 0.6626, label: 1, bag_size: 860
batch 299, loss: 0.1626, instance_loss: 0.1497, weighted_loss: 0.1587, label: 1, bag_size: 903
batch 319, loss: 3.0512, instance_loss: 0.7626, weighted_loss: 2.3646, label: 3, bag_size: 343
batch 339, loss: 0.5005, instance_loss: 0.3596, weighted_loss: 0.4582, label: 2, bag_size: 913
batch 359, loss: 0.7539, instance_loss: 0.6073, weighted_loss: 0.7099, label: 0, bag_size: 118
batch 379, loss: 0.6312, instance_loss: 0.5192, weighted_loss: 0.5976, label: 0, bag_size: 128
batch 399, loss: 0.0918, instance_loss: 0.1828, weighted_loss: 0.1191, label: 0, bag_size: 898
batch 419, loss: 1.8161, instance_loss: 0.5043, weighted_loss: 1.4226, label: 3, bag_size: 1118
batch 439, loss: 0.0552, instance_loss: 0.0917, weighted_loss: 0.0662, label: 3, bag_size: 35
batch 459, loss: 2.1647, instance_loss: 0.8069, weighted_loss: 1.7574, label: 3, bag_size: 706
batch 479, loss: 0.8733, instance_loss: 0.4795, weighted_loss: 0.7552, label: 2, bag_size: 222
batch 499, loss: 0.2095, instance_loss: 0.1958, weighted_loss: 0.2054, label: 0, bag_size: 524
batch 519, loss: 0.6087, instance_loss: 0.3833, weighted_loss: 0.5411, label: 2, bag_size: 1235
batch 539, loss: 0.9381, instance_loss: 0.3553, weighted_loss: 0.7633, label: 4, bag_size: 63


class 0 clustering acc 0.991651376146789: correct 21618/21800
class 1 clustering acc 0.26788990825688075: correct 1168/4360
Epoch: 7, train_loss: 0.6741, train_clustering_loss:  0.3517, train_error: 0.2275
class 0: acc 0.8409090909090909, correct 111/132
class 1: acc 0.7068965517241379, correct 82/116
class 2: acc 0.6702127659574468, correct 63/94
class 3: acc 0.8, correct 80/100
class 4: acc 0.8252427184466019, correct 85/103

Val Set, val_loss: 0.7479, val_error: 0.2800, auc: 0.9110
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
Validation loss decreased (0.846762 --> 0.747863).  Saving model ...


batch 19, loss: 1.5966, instance_loss: 0.5357, weighted_loss: 1.2784, label: 0, bag_size: 371
batch 39, loss: 0.5066, instance_loss: 0.2798, weighted_loss: 0.4385, label: 4, bag_size: 1235
batch 59, loss: 0.8690, instance_loss: 0.3805, weighted_loss: 0.7224, label: 1, bag_size: 747
batch 79, loss: 1.2862, instance_loss: 0.7193, weighted_loss: 1.1161, label: 0, bag_size: 143
batch 99, loss: 0.3768, instance_loss: 0.2149, weighted_loss: 0.3282, label: 1, bag_size: 504
batch 119, loss: 2.9232, instance_loss: 0.6668, weighted_loss: 2.2463, label: 2, bag_size: 248
batch 139, loss: 1.5458, instance_loss: 0.6313, weighted_loss: 1.2715, label: 4, bag_size: 817
batch 159, loss: 0.8545, instance_loss: 0.4103, weighted_loss: 0.7212, label: 0, bag_size: 545
batch 179, loss: 0.4329, instance_loss: 0.3420, weighted_loss: 0.4056, label: 0, bag_size: 552
batch 199, loss: 0.2007, instance_loss: 0.2896, weighted_loss: 0.2273, label: 0, bag_size: 1247
batch 219, loss: 0.7319, instance_loss: 0.5491, weighted_loss: 0.6771, label: 0, bag_size: 116
batch 239, loss: 0.1028, instance_loss: 0.2008, weighted_loss: 0.1322, label: 0, bag_size: 1143
batch 259, loss: 0.1557, instance_loss: 0.1222, weighted_loss: 0.1456, label: 4, bag_size: 119
batch 279, loss: 1.8953, instance_loss: 0.5478, weighted_loss: 1.4911, label: 2, bag_size: 110
batch 299, loss: 0.2281, instance_loss: 0.3540, weighted_loss: 0.2659, label: 3, bag_size: 1291
batch 319, loss: 2.9711, instance_loss: 0.8451, weighted_loss: 2.3333, label: 1, bag_size: 867
batch 339, loss: 0.0602, instance_loss: 0.1168, weighted_loss: 0.0772, label: 3, bag_size: 33
batch 359, loss: 0.3761, instance_loss: 0.2587, weighted_loss: 0.3409, label: 0, bag_size: 552
batch 379, loss: 0.3518, instance_loss: 0.3241, weighted_loss: 0.3435, label: 0, bag_size: 446
batch 399, loss: 1.7326, instance_loss: 0.3953, weighted_loss: 1.3314, label: 0, bag_size: 759
batch 419, loss: 1.0644, instance_loss: 0.5822, weighted_loss: 0.9198, label: 4, bag_size: 663
batch 439, loss: 0.5890, instance_loss: 0.5122, weighted_loss: 0.5660, label: 4, bag_size: 663
batch 459, loss: 0.0094, instance_loss: 0.0524, weighted_loss: 0.0223, label: 3, bag_size: 46
batch 479, loss: 0.0646, instance_loss: 0.2269, weighted_loss: 0.1133, label: 3, bag_size: 18
batch 499, loss: 0.4191, instance_loss: 0.3111, weighted_loss: 0.3867, label: 2, bag_size: 324
batch 519, loss: 0.0113, instance_loss: 0.1586, weighted_loss: 0.0555, label: 3, bag_size: 18
batch 539, loss: 0.9389, instance_loss: 0.4515, weighted_loss: 0.7927, label: 1, bag_size: 747


class 0 clustering acc 0.9919266055045871: correct 21624/21800
class 1 clustering acc 0.3036697247706422: correct 1324/4360
Epoch: 8, train_loss: 0.6324, train_clustering_loss:  0.3417, train_error: 0.2422
class 0: acc 0.7352941176470589, correct 75/102
class 1: acc 0.7288135593220338, correct 86/118
class 2: acc 0.6605504587155964, correct 72/109
class 3: acc 0.8316831683168316, correct 84/101
class 4: acc 0.8347826086956521, correct 96/115

Val Set, val_loss: 0.7565, val_error: 0.2800, auc: 0.9145
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.1975: correct 79/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0945, instance_loss: 0.1367, weighted_loss: 0.1072, label: 3, bag_size: 97
batch 39, loss: 2.1958, instance_loss: 0.7178, weighted_loss: 1.7524, label: 2, bag_size: 1006
batch 59, loss: 1.8780, instance_loss: 0.5959, weighted_loss: 1.4934, label: 2, bag_size: 1259
batch 79, loss: 0.2986, instance_loss: 0.2088, weighted_loss: 0.2717, label: 1, bag_size: 944
batch 99, loss: 0.0372, instance_loss: 0.1224, weighted_loss: 0.0627, label: 3, bag_size: 28
batch 119, loss: 0.0477, instance_loss: 0.0703, weighted_loss: 0.0545, label: 4, bag_size: 130
batch 139, loss: 0.2000, instance_loss: 0.2352, weighted_loss: 0.2105, label: 0, bag_size: 1872
batch 159, loss: 0.3689, instance_loss: 0.2863, weighted_loss: 0.3441, label: 0, bag_size: 340
batch 179, loss: 0.2420, instance_loss: 0.2625, weighted_loss: 0.2482, label: 2, bag_size: 455
batch 199, loss: 0.0626, instance_loss: 0.0545, weighted_loss: 0.0602, label: 4, bag_size: 112
batch 219, loss: 1.4632, instance_loss: 0.4697, weighted_loss: 1.1652, label: 2, bag_size: 307
batch 239, loss: 0.4274, instance_loss: 0.3303, weighted_loss: 0.3983, label: 2, bag_size: 245
batch 259, loss: 3.4708, instance_loss: 0.8164, weighted_loss: 2.6745, label: 1, bag_size: 386
batch 279, loss: 0.1593, instance_loss: 0.2318, weighted_loss: 0.1811, label: 2, bag_size: 846
batch 299, loss: 2.3292, instance_loss: 0.6134, weighted_loss: 1.8144, label: 0, bag_size: 1527
batch 319, loss: 0.3622, instance_loss: 0.3113, weighted_loss: 0.3469, label: 2, bag_size: 1164
batch 339, loss: 1.0558, instance_loss: 0.4013, weighted_loss: 0.8595, label: 1, bag_size: 530
batch 359, loss: 0.5590, instance_loss: 0.3012, weighted_loss: 0.4816, label: 1, bag_size: 847
batch 379, loss: 0.3765, instance_loss: 0.3592, weighted_loss: 0.3713, label: 2, bag_size: 1058
batch 399, loss: 0.1731, instance_loss: 0.2528, weighted_loss: 0.1970, label: 1, bag_size: 533
batch 419, loss: 0.8143, instance_loss: 0.5133, weighted_loss: 0.7240, label: 2, bag_size: 932
batch 439, loss: 0.1008, instance_loss: 0.1571, weighted_loss: 0.1177, label: 0, bag_size: 446
batch 459, loss: 0.0119, instance_loss: 0.1394, weighted_loss: 0.0501, label: 3, bag_size: 18
batch 479, loss: 0.2208, instance_loss: 0.2968, weighted_loss: 0.2436, label: 2, bag_size: 314
batch 499, loss: 0.3358, instance_loss: 0.1540, weighted_loss: 0.2813, label: 1, bag_size: 1086
batch 519, loss: 0.0780, instance_loss: 0.2778, weighted_loss: 0.1380, label: 4, bag_size: 388
batch 539, loss: 0.3697, instance_loss: 0.3213, weighted_loss: 0.3552, label: 2, bag_size: 262


class 0 clustering acc 0.9913302752293578: correct 21611/21800
class 1 clustering acc 0.34243119266055044: correct 1493/4360
Epoch: 9, train_loss: 0.5981, train_clustering_loss:  0.3272, train_error: 0.2183
class 0: acc 0.8823529411764706, correct 90/102
class 1: acc 0.6454545454545455, correct 71/110
class 2: acc 0.7297297297297297, correct 81/111
class 3: acc 0.8333333333333334, correct 90/108
class 4: acc 0.8245614035087719, correct 94/114

Val Set, val_loss: 0.7018, val_error: 0.2600, auc: 0.9143
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
Validation loss decreased (0.747863 --> 0.701808).  Saving model ...


batch 19, loss: 0.2559, instance_loss: 0.2490, weighted_loss: 0.2538, label: 0, bag_size: 1190
batch 39, loss: 0.8678, instance_loss: 0.4133, weighted_loss: 0.7315, label: 1, bag_size: 139
batch 59, loss: 0.7246, instance_loss: 0.5523, weighted_loss: 0.6729, label: 3, bag_size: 849
batch 79, loss: 0.1019, instance_loss: 0.1205, weighted_loss: 0.1075, label: 3, bag_size: 1559
batch 99, loss: 0.5328, instance_loss: 0.3985, weighted_loss: 0.4925, label: 2, bag_size: 1439
batch 119, loss: 0.3100, instance_loss: 0.2286, weighted_loss: 0.2856, label: 1, bag_size: 949
batch 139, loss: 0.4525, instance_loss: 0.2658, weighted_loss: 0.3965, label: 1, bag_size: 598
batch 159, loss: 0.7527, instance_loss: 0.2980, weighted_loss: 0.6163, label: 1, bag_size: 399
batch 179, loss: 0.5537, instance_loss: 0.5516, weighted_loss: 0.5531, label: 0, bag_size: 128
batch 199, loss: 0.3454, instance_loss: 0.3421, weighted_loss: 0.3444, label: 4, bag_size: 24
batch 219, loss: 0.0287, instance_loss: 0.1663, weighted_loss: 0.0700, label: 3, bag_size: 143
batch 239, loss: 0.3637, instance_loss: 0.1562, weighted_loss: 0.3014, label: 1, bag_size: 869
batch 259, loss: 0.0407, instance_loss: 0.0968, weighted_loss: 0.0575, label: 0, bag_size: 524
batch 279, loss: 0.7769, instance_loss: 0.3635, weighted_loss: 0.6529, label: 0, bag_size: 381
batch 299, loss: 0.0563, instance_loss: 0.1186, weighted_loss: 0.0750, label: 3, bag_size: 29
batch 319, loss: 0.0148, instance_loss: 0.0406, weighted_loss: 0.0226, label: 3, bag_size: 143
batch 339, loss: 0.0632, instance_loss: 0.1569, weighted_loss: 0.0913, label: 0, bag_size: 246
batch 359, loss: 0.0575, instance_loss: 0.1339, weighted_loss: 0.0804, label: 3, bag_size: 19
batch 379, loss: 0.0469, instance_loss: 0.0856, weighted_loss: 0.0585, label: 3, bag_size: 94
batch 399, loss: 0.2457, instance_loss: 0.2323, weighted_loss: 0.2417, label: 1, bag_size: 1402
batch 419, loss: 1.2869, instance_loss: 0.5257, weighted_loss: 1.0585, label: 1, bag_size: 269
batch 439, loss: 0.7783, instance_loss: 0.4502, weighted_loss: 0.6798, label: 2, bag_size: 1139
batch 459, loss: 3.1460, instance_loss: 1.0426, weighted_loss: 2.5150, label: 2, bag_size: 1043
batch 479, loss: 0.5404, instance_loss: 0.3475, weighted_loss: 0.4826, label: 0, bag_size: 1247
batch 499, loss: 0.3109, instance_loss: 0.4456, weighted_loss: 0.3513, label: 4, bag_size: 646
batch 519, loss: 2.1373, instance_loss: 0.6336, weighted_loss: 1.6862, label: 1, bag_size: 1376
batch 539, loss: 0.7243, instance_loss: 0.4455, weighted_loss: 0.6407, label: 1, bag_size: 868


class 0 clustering acc 0.9911467889908256: correct 21607/21800
class 1 clustering acc 0.3559633027522936: correct 1552/4360
Epoch: 10, train_loss: 0.5323, train_clustering_loss:  0.3224, train_error: 0.1670
class 0: acc 0.859504132231405, correct 104/121
class 1: acc 0.7477477477477478, correct 83/111
class 2: acc 0.7524752475247525, correct 76/101
class 3: acc 0.9072164948453608, correct 88/97
class 4: acc 0.8956521739130435, correct 103/115

Val Set, val_loss: 0.7940, val_error: 0.3000, auc: 0.9168
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.5714285714285714, correct 12/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0399, instance_loss: 0.1523, weighted_loss: 0.0736, label: 3, bag_size: 18
batch 39, loss: 0.1488, instance_loss: 0.2620, weighted_loss: 0.1828, label: 0, bag_size: 1046
batch 59, loss: 0.7538, instance_loss: 0.6146, weighted_loss: 0.7120, label: 0, bag_size: 143
batch 79, loss: 0.2105, instance_loss: 0.3107, weighted_loss: 0.2405, label: 2, bag_size: 395
batch 99, loss: 0.0085, instance_loss: 0.0911, weighted_loss: 0.0333, label: 3, bag_size: 53
batch 119, loss: 0.8703, instance_loss: 0.7036, weighted_loss: 0.8203, label: 4, bag_size: 1357
batch 139, loss: 0.0510, instance_loss: 0.1887, weighted_loss: 0.0923, label: 4, bag_size: 123
batch 159, loss: 0.0320, instance_loss: 0.0928, weighted_loss: 0.0502, label: 3, bag_size: 18
batch 179, loss: 0.0023, instance_loss: 0.0306, weighted_loss: 0.0108, label: 3, bag_size: 56
batch 199, loss: 0.1530, instance_loss: 0.1293, weighted_loss: 0.1459, label: 4, bag_size: 202
batch 219, loss: 0.0484, instance_loss: 0.2271, weighted_loss: 0.1020, label: 3, bag_size: 16
batch 239, loss: 1.8437, instance_loss: 0.6640, weighted_loss: 1.4898, label: 0, bag_size: 282
batch 259, loss: 0.2445, instance_loss: 0.3846, weighted_loss: 0.2865, label: 4, bag_size: 17
batch 279, loss: 0.2841, instance_loss: 0.2057, weighted_loss: 0.2606, label: 1, bag_size: 696
batch 299, loss: 0.2029, instance_loss: 0.2633, weighted_loss: 0.2210, label: 0, bag_size: 630
batch 319, loss: 0.0232, instance_loss: 0.0773, weighted_loss: 0.0394, label: 3, bag_size: 63
batch 339, loss: 0.4529, instance_loss: 0.3379, weighted_loss: 0.4184, label: 0, bag_size: 413
batch 359, loss: 1.0437, instance_loss: 0.4864, weighted_loss: 0.8765, label: 1, bag_size: 269
batch 379, loss: 0.5994, instance_loss: 0.4603, weighted_loss: 0.5577, label: 0, bag_size: 800
batch 399, loss: 1.5693, instance_loss: 0.6632, weighted_loss: 1.2974, label: 2, bag_size: 120
batch 419, loss: 0.0693, instance_loss: 0.1262, weighted_loss: 0.0863, label: 0, bag_size: 1143
batch 439, loss: 1.0122, instance_loss: 0.4172, weighted_loss: 0.8337, label: 0, bag_size: 423
batch 459, loss: 0.4946, instance_loss: 0.6203, weighted_loss: 0.5323, label: 2, bag_size: 649
batch 479, loss: 0.5040, instance_loss: 0.3994, weighted_loss: 0.4727, label: 2, bag_size: 1058
batch 499, loss: 0.9017, instance_loss: 0.4481, weighted_loss: 0.7656, label: 2, bag_size: 748
batch 519, loss: 0.4791, instance_loss: 0.4070, weighted_loss: 0.4575, label: 2, bag_size: 508
batch 539, loss: 0.5370, instance_loss: 0.3684, weighted_loss: 0.4864, label: 4, bag_size: 20


class 0 clustering acc 0.9871100917431193: correct 21519/21800
class 1 clustering acc 0.38807339449541284: correct 1692/4360
Epoch: 11, train_loss: 0.5749, train_clustering_loss:  0.3239, train_error: 0.2147
class 0: acc 0.8636363636363636, correct 95/110
class 1: acc 0.7090909090909091, correct 78/110
class 2: acc 0.6276595744680851, correct 59/94
class 3: acc 0.8629032258064516, correct 107/124
class 4: acc 0.8317757009345794, correct 89/107

Val Set, val_loss: 0.7066, val_error: 0.3200, auc: 0.9168
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.24: correct 96/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.5238095238095238, correct 11/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0366, instance_loss: 0.0744, weighted_loss: 0.0479, label: 4, bag_size: 83
batch 39, loss: 0.0078, instance_loss: 0.0717, weighted_loss: 0.0270, label: 3, bag_size: 24
batch 59, loss: 0.0776, instance_loss: 0.3007, weighted_loss: 0.1446, label: 4, bag_size: 19
batch 79, loss: 0.0399, instance_loss: 0.0693, weighted_loss: 0.0487, label: 4, bag_size: 147
batch 99, loss: 0.0472, instance_loss: 0.0803, weighted_loss: 0.0572, label: 3, bag_size: 305
batch 119, loss: 0.1735, instance_loss: 0.2887, weighted_loss: 0.2080, label: 2, bag_size: 245
batch 139, loss: 0.0795, instance_loss: 0.4940, weighted_loss: 0.2039, label: 4, bag_size: 974
batch 159, loss: 0.7427, instance_loss: 0.4638, weighted_loss: 0.6590, label: 0, bag_size: 1196
batch 179, loss: 0.0145, instance_loss: 0.1086, weighted_loss: 0.0427, label: 3, bag_size: 43
batch 199, loss: 0.6450, instance_loss: 0.3979, weighted_loss: 0.5709, label: 2, bag_size: 1052
batch 219, loss: 0.7228, instance_loss: 0.4803, weighted_loss: 0.6501, label: 1, bag_size: 838
batch 239, loss: 0.0108, instance_loss: 0.0586, weighted_loss: 0.0251, label: 4, bag_size: 91
batch 259, loss: 0.0047, instance_loss: 0.0562, weighted_loss: 0.0202, label: 3, bag_size: 56
batch 279, loss: 0.8755, instance_loss: 0.7344, weighted_loss: 0.8332, label: 4, bag_size: 1360
batch 299, loss: 0.8361, instance_loss: 0.4903, weighted_loss: 0.7323, label: 2, bag_size: 1058
batch 319, loss: 0.3408, instance_loss: 0.4128, weighted_loss: 0.3624, label: 2, bag_size: 245
batch 339, loss: 0.1443, instance_loss: 0.2625, weighted_loss: 0.1798, label: 2, bag_size: 1242
batch 359, loss: 0.1605, instance_loss: 0.2528, weighted_loss: 0.1882, label: 4, bag_size: 23
batch 379, loss: 0.1463, instance_loss: 0.3727, weighted_loss: 0.2142, label: 0, bag_size: 1101
batch 399, loss: 0.0237, instance_loss: 0.0800, weighted_loss: 0.0406, label: 4, bag_size: 104
batch 419, loss: 0.0137, instance_loss: 0.1121, weighted_loss: 0.0432, label: 3, bag_size: 50
batch 439, loss: 0.0089, instance_loss: 0.0517, weighted_loss: 0.0218, label: 3, bag_size: 75
batch 459, loss: 1.5815, instance_loss: 0.6887, weighted_loss: 1.3137, label: 2, bag_size: 1400
batch 479, loss: 0.2728, instance_loss: 0.3844, weighted_loss: 0.3063, label: 2, bag_size: 314
batch 499, loss: 0.1893, instance_loss: 0.1482, weighted_loss: 0.1770, label: 3, bag_size: 1399
batch 519, loss: 0.0286, instance_loss: 0.1218, weighted_loss: 0.0566, label: 4, bag_size: 168
batch 539, loss: 0.2591, instance_loss: 0.6882, weighted_loss: 0.3879, label: 4, bag_size: 882


class 0 clustering acc 0.9896330275229358: correct 21574/21800
class 1 clustering acc 0.35825688073394496: correct 1562/4360
Epoch: 12, train_loss: 0.5021, train_clustering_loss:  0.3191, train_error: 0.1688
class 0: acc 0.89, correct 89/100
class 1: acc 0.7029702970297029, correct 71/101
class 2: acc 0.7798165137614679, correct 85/109
class 3: acc 0.8679245283018868, correct 92/106
class 4: acc 0.8992248062015504, correct 116/129

Val Set, val_loss: 0.6444, val_error: 0.2200, auc: 0.9314
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
Validation loss decreased (0.701808 --> 0.644418).  Saving model ...


batch 19, loss: 0.0389, instance_loss: 0.2617, weighted_loss: 0.1058, label: 4, bag_size: 646
batch 39, loss: 0.5010, instance_loss: 0.2755, weighted_loss: 0.4333, label: 1, bag_size: 1144
batch 59, loss: 0.0918, instance_loss: 0.1275, weighted_loss: 0.1025, label: 4, bag_size: 91
batch 79, loss: 0.0132, instance_loss: 0.1112, weighted_loss: 0.0426, label: 4, bag_size: 91
batch 99, loss: 0.1195, instance_loss: 0.1237, weighted_loss: 0.1207, label: 1, bag_size: 1086
batch 119, loss: 0.0352, instance_loss: 0.1626, weighted_loss: 0.0734, label: 3, bag_size: 18
batch 139, loss: 0.1972, instance_loss: 0.2699, weighted_loss: 0.2190, label: 0, bag_size: 410
batch 159, loss: 0.5959, instance_loss: 0.4032, weighted_loss: 0.5381, label: 3, bag_size: 697
batch 179, loss: 0.0681, instance_loss: 0.1549, weighted_loss: 0.0942, label: 4, bag_size: 40
batch 199, loss: 0.2055, instance_loss: 0.2819, weighted_loss: 0.2284, label: 0, bag_size: 255
batch 219, loss: 0.0773, instance_loss: 0.2370, weighted_loss: 0.1252, label: 4, bag_size: 94
batch 239, loss: 0.4875, instance_loss: 0.4354, weighted_loss: 0.4719, label: 1, bag_size: 818
batch 259, loss: 0.0097, instance_loss: 0.0680, weighted_loss: 0.0272, label: 3, bag_size: 46
batch 279, loss: 0.0411, instance_loss: 0.1131, weighted_loss: 0.0627, label: 1, bag_size: 828
batch 299, loss: 0.0253, instance_loss: 0.2620, weighted_loss: 0.0963, label: 4, bag_size: 24
batch 319, loss: 1.4622, instance_loss: 0.5510, weighted_loss: 1.1888, label: 0, bag_size: 759
batch 339, loss: 0.3911, instance_loss: 0.3919, weighted_loss: 0.3913, label: 2, bag_size: 508
batch 359, loss: 0.0447, instance_loss: 0.0885, weighted_loss: 0.0579, label: 3, bag_size: 28
batch 379, loss: 0.5209, instance_loss: 0.3612, weighted_loss: 0.4730, label: 1, bag_size: 1273
batch 399, loss: 2.0075, instance_loss: 0.6838, weighted_loss: 1.6104, label: 3, bag_size: 281
batch 419, loss: 0.0099, instance_loss: 0.0662, weighted_loss: 0.0268, label: 3, bag_size: 34
batch 439, loss: 0.2818, instance_loss: 0.5247, weighted_loss: 0.3547, label: 0, bag_size: 129
batch 459, loss: 0.0344, instance_loss: 0.1510, weighted_loss: 0.0694, label: 1, bag_size: 866
batch 479, loss: 0.0753, instance_loss: 0.0724, weighted_loss: 0.0745, label: 1, bag_size: 697
batch 499, loss: 0.2050, instance_loss: 0.2715, weighted_loss: 0.2249, label: 0, bag_size: 760
batch 519, loss: 0.3099, instance_loss: 0.2700, weighted_loss: 0.2980, label: 0, bag_size: 800
batch 539, loss: 1.2498, instance_loss: 0.5286, weighted_loss: 1.0334, label: 0, bag_size: 1065


class 0 clustering acc 0.9883944954128441: correct 21547/21800
class 1 clustering acc 0.3768348623853211: correct 1643/4360
Epoch: 13, train_loss: 0.5249, train_clustering_loss:  0.3163, train_error: 0.1761
class 0: acc 0.8932038834951457, correct 92/103
class 1: acc 0.7674418604651163, correct 99/129
class 2: acc 0.7739130434782608, correct 89/115
class 3: acc 0.8461538461538461, correct 77/91
class 4: acc 0.8598130841121495, correct 92/107

Val Set, val_loss: 0.7031, val_error: 0.3000, auc: 0.9221
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.2425: correct 97/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.5714285714285714, correct 12/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1811, instance_loss: 0.4602, weighted_loss: 0.2648, label: 4, bag_size: 882
batch 39, loss: 1.2688, instance_loss: 0.5677, weighted_loss: 1.0585, label: 2, bag_size: 110
batch 59, loss: 1.7170, instance_loss: 0.5352, weighted_loss: 1.3625, label: 2, bag_size: 1231
batch 79, loss: 0.1265, instance_loss: 0.2029, weighted_loss: 0.1494, label: 2, bag_size: 499
batch 99, loss: 0.1148, instance_loss: 0.2075, weighted_loss: 0.1426, label: 1, bag_size: 318
batch 119, loss: 1.7069, instance_loss: 0.5259, weighted_loss: 1.3526, label: 2, bag_size: 204
batch 139, loss: 1.4900, instance_loss: 0.5585, weighted_loss: 1.2105, label: 1, bag_size: 1197
batch 159, loss: 1.7706, instance_loss: 0.7258, weighted_loss: 1.4572, label: 2, bag_size: 1231
batch 179, loss: 0.0112, instance_loss: 0.1994, weighted_loss: 0.0677, label: 4, bag_size: 20
batch 199, loss: 0.0806, instance_loss: 0.2407, weighted_loss: 0.1286, label: 0, bag_size: 148
batch 219, loss: 0.9068, instance_loss: 0.4298, weighted_loss: 0.7637, label: 2, bag_size: 272
batch 239, loss: 0.7207, instance_loss: 0.4408, weighted_loss: 0.6367, label: 2, bag_size: 409
batch 259, loss: 0.0030, instance_loss: 0.0397, weighted_loss: 0.0140, label: 4, bag_size: 157
batch 279, loss: 0.2264, instance_loss: 0.2449, weighted_loss: 0.2320, label: 0, bag_size: 1332
batch 299, loss: 0.1486, instance_loss: 0.3283, weighted_loss: 0.2025, label: 0, bag_size: 515
batch 319, loss: 0.1652, instance_loss: 0.4153, weighted_loss: 0.2402, label: 4, bag_size: 20
batch 339, loss: 0.0627, instance_loss: 0.3691, weighted_loss: 0.1546, label: 3, bag_size: 17
batch 359, loss: 0.2594, instance_loss: 0.2983, weighted_loss: 0.2711, label: 2, bag_size: 1218
batch 379, loss: 0.5999, instance_loss: 0.4165, weighted_loss: 0.5449, label: 2, bag_size: 409
batch 399, loss: 0.0138, instance_loss: 0.0642, weighted_loss: 0.0289, label: 4, bag_size: 157
batch 419, loss: 0.0076, instance_loss: 0.0721, weighted_loss: 0.0269, label: 3, bag_size: 72
batch 439, loss: 0.2265, instance_loss: 0.2954, weighted_loss: 0.2472, label: 2, bag_size: 355
batch 459, loss: 1.5793, instance_loss: 0.7140, weighted_loss: 1.3197, label: 4, bag_size: 817
batch 479, loss: 1.8385, instance_loss: 0.6104, weighted_loss: 1.4700, label: 2, bag_size: 1677
batch 499, loss: 0.0690, instance_loss: 0.1754, weighted_loss: 0.1009, label: 4, bag_size: 40
batch 519, loss: 1.1532, instance_loss: 0.3270, weighted_loss: 0.9054, label: 3, bag_size: 1177
batch 539, loss: 0.0045, instance_loss: 0.0645, weighted_loss: 0.0225, label: 4, bag_size: 79


class 0 clustering acc 0.9917431192660551: correct 21620/21800
class 1 clustering acc 0.43142201834862387: correct 1881/4360
Epoch: 14, train_loss: 0.4282, train_clustering_loss:  0.2917, train_error: 0.1651
class 0: acc 0.8688524590163934, correct 106/122
class 1: acc 0.72, correct 72/100
class 2: acc 0.7454545454545455, correct 82/110
class 3: acc 0.9150943396226415, correct 97/106
class 4: acc 0.9158878504672897, correct 98/107

Val Set, val_loss: 0.8341, val_error: 0.3400, auc: 0.9135
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.2875: correct 115/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.8125, correct 13/16
class 2: acc 0.47619047619047616, correct 10/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1744, instance_loss: 0.1375, weighted_loss: 0.1633, label: 1, bag_size: 696
batch 39, loss: 0.0112, instance_loss: 0.0770, weighted_loss: 0.0309, label: 3, bag_size: 94
batch 59, loss: 0.0555, instance_loss: 0.3663, weighted_loss: 0.1487, label: 0, bag_size: 472
batch 79, loss: 3.2959, instance_loss: 0.6208, weighted_loss: 2.4934, label: 2, bag_size: 732
batch 99, loss: 0.4194, instance_loss: 0.2977, weighted_loss: 0.3829, label: 2, bag_size: 1133
batch 119, loss: 0.0237, instance_loss: 0.1530, weighted_loss: 0.0625, label: 1, bag_size: 1376
batch 139, loss: 1.8170, instance_loss: 0.6776, weighted_loss: 1.4752, label: 3, bag_size: 281
batch 159, loss: 0.2140, instance_loss: 0.6538, weighted_loss: 0.3460, label: 0, bag_size: 110
batch 179, loss: 0.0299, instance_loss: 0.0843, weighted_loss: 0.0462, label: 0, bag_size: 898
batch 199, loss: 0.1560, instance_loss: 0.1609, weighted_loss: 0.1575, label: 1, bag_size: 1325
batch 219, loss: 0.0144, instance_loss: 0.0753, weighted_loss: 0.0327, label: 0, bag_size: 239
batch 239, loss: 0.4789, instance_loss: 0.5493, weighted_loss: 0.5000, label: 0, bag_size: 163
batch 259, loss: 0.0050, instance_loss: 0.0730, weighted_loss: 0.0254, label: 4, bag_size: 140
batch 279, loss: 0.0549, instance_loss: 0.1319, weighted_loss: 0.0780, label: 1, bag_size: 938
batch 299, loss: 0.0449, instance_loss: 0.1056, weighted_loss: 0.0631, label: 4, bag_size: 211
batch 319, loss: 0.0961, instance_loss: 0.3494, weighted_loss: 0.1721, label: 0, bag_size: 110
batch 339, loss: 0.0347, instance_loss: 0.1051, weighted_loss: 0.0558, label: 3, bag_size: 35
batch 359, loss: 0.0857, instance_loss: 0.1840, weighted_loss: 0.1152, label: 1, bag_size: 834
batch 379, loss: 0.3412, instance_loss: 0.2887, weighted_loss: 0.3255, label: 1, bag_size: 533
batch 399, loss: 0.1440, instance_loss: 0.2736, weighted_loss: 0.1828, label: 0, bag_size: 1086
batch 419, loss: 0.0728, instance_loss: 0.2427, weighted_loss: 0.1238, label: 0, bag_size: 607
batch 439, loss: 0.0501, instance_loss: 0.1415, weighted_loss: 0.0775, label: 3, bag_size: 18
batch 459, loss: 0.9162, instance_loss: 0.6186, weighted_loss: 0.8269, label: 2, bag_size: 959
batch 479, loss: 1.5687, instance_loss: 0.7132, weighted_loss: 1.3121, label: 4, bag_size: 817
batch 499, loss: 0.0378, instance_loss: 0.0631, weighted_loss: 0.0454, label: 1, bag_size: 286
batch 519, loss: 0.0969, instance_loss: 0.1083, weighted_loss: 0.1003, label: 3, bag_size: 1559
batch 539, loss: 0.5802, instance_loss: 0.4496, weighted_loss: 0.5410, label: 0, bag_size: 1289


class 0 clustering acc 0.9882568807339449: correct 21544/21800
class 1 clustering acc 0.40894495412844034: correct 1783/4360
Epoch: 15, train_loss: 0.4772, train_clustering_loss:  0.3114, train_error: 0.1853
class 0: acc 0.9285714285714286, correct 104/112
class 1: acc 0.6902654867256637, correct 78/113
class 2: acc 0.7407407407407407, correct 80/108
class 3: acc 0.8773584905660378, correct 93/106
class 4: acc 0.839622641509434, correct 89/106

Val Set, val_loss: 1.0188, val_error: 0.3400, auc: 0.9200
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.5238095238095238, correct 11/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4927, instance_loss: 0.4052, weighted_loss: 0.4664, label: 2, bag_size: 1141
batch 39, loss: 1.8033, instance_loss: 0.9627, weighted_loss: 1.5511, label: 1, bag_size: 660
batch 59, loss: 0.2802, instance_loss: 0.3246, weighted_loss: 0.2935, label: 2, bag_size: 248
batch 79, loss: 0.1911, instance_loss: 0.4329, weighted_loss: 0.2636, label: 4, bag_size: 388
batch 99, loss: 0.8806, instance_loss: 0.5084, weighted_loss: 0.7690, label: 3, bag_size: 706
batch 119, loss: 0.3684, instance_loss: 0.3044, weighted_loss: 0.3492, label: 2, bag_size: 1052
batch 139, loss: 0.0106, instance_loss: 0.0726, weighted_loss: 0.0292, label: 0, bag_size: 1046
batch 159, loss: 0.0317, instance_loss: 0.0710, weighted_loss: 0.0435, label: 4, bag_size: 83
batch 179, loss: 0.0208, instance_loss: 0.0960, weighted_loss: 0.0434, label: 0, bag_size: 239
batch 199, loss: 0.2113, instance_loss: 0.2301, weighted_loss: 0.2170, label: 0, bag_size: 1517
batch 219, loss: 0.0177, instance_loss: 0.0825, weighted_loss: 0.0371, label: 0, bag_size: 898
batch 239, loss: 1.4162, instance_loss: 0.6113, weighted_loss: 1.1748, label: 1, bag_size: 1197
batch 259, loss: 1.3798, instance_loss: 0.5435, weighted_loss: 1.1289, label: 1, bag_size: 1197
batch 279, loss: 0.9958, instance_loss: 0.5832, weighted_loss: 0.8720, label: 4, bag_size: 366
batch 299, loss: 0.0641, instance_loss: 0.0894, weighted_loss: 0.0717, label: 0, bag_size: 521
batch 319, loss: 0.2690, instance_loss: 0.3680, weighted_loss: 0.2987, label: 2, bag_size: 730
batch 339, loss: 0.0216, instance_loss: 0.1308, weighted_loss: 0.0544, label: 4, bag_size: 48
batch 359, loss: 0.0942, instance_loss: 0.3726, weighted_loss: 0.1778, label: 0, bag_size: 155
batch 379, loss: 1.7354, instance_loss: 0.3877, weighted_loss: 1.3311, label: 1, bag_size: 651
batch 399, loss: 0.0143, instance_loss: 0.1110, weighted_loss: 0.0433, label: 4, bag_size: 211
batch 419, loss: 0.0232, instance_loss: 0.0644, weighted_loss: 0.0356, label: 4, bag_size: 123
batch 439, loss: 0.0052, instance_loss: 0.1927, weighted_loss: 0.0614, label: 3, bag_size: 20
batch 459, loss: 0.0048, instance_loss: 0.0998, weighted_loss: 0.0333, label: 3, bag_size: 20
batch 479, loss: 2.3406, instance_loss: 0.6935, weighted_loss: 1.8464, label: 4, bag_size: 1360
batch 499, loss: 0.0055, instance_loss: 0.0673, weighted_loss: 0.0240, label: 4, bag_size: 79
batch 519, loss: 0.7962, instance_loss: 0.5445, weighted_loss: 0.7207, label: 2, bag_size: 720
batch 539, loss: 0.2786, instance_loss: 0.2053, weighted_loss: 0.2566, label: 3, bag_size: 556


class 0 clustering acc 0.9887614678899083: correct 21555/21800
class 1 clustering acc 0.3878440366972477: correct 1691/4360
Epoch: 16, train_loss: 0.4664, train_clustering_loss:  0.3162, train_error: 0.1651
class 0: acc 0.8615384615384616, correct 112/130
class 1: acc 0.7040816326530612, correct 69/98
class 2: acc 0.7894736842105263, correct 90/114
class 3: acc 0.8932038834951457, correct 92/103
class 4: acc 0.92, correct 92/100

Val Set, val_loss: 0.7006, val_error: 0.2200, auc: 0.9310
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.3025: correct 121/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7144, instance_loss: 0.4068, weighted_loss: 0.6221, label: 1, bag_size: 470
batch 39, loss: 0.0401, instance_loss: 0.1753, weighted_loss: 0.0807, label: 0, bag_size: 607
batch 59, loss: 0.5999, instance_loss: 0.4767, weighted_loss: 0.5630, label: 2, bag_size: 1617
batch 79, loss: 0.0232, instance_loss: 0.1131, weighted_loss: 0.0502, label: 4, bag_size: 60
batch 99, loss: 0.5030, instance_loss: 0.6018, weighted_loss: 0.5326, label: 0, bag_size: 163
batch 119, loss: 0.0655, instance_loss: 0.3505, weighted_loss: 0.1510, label: 0, bag_size: 116
batch 139, loss: 0.1166, instance_loss: 0.3631, weighted_loss: 0.1905, label: 4, bag_size: 1002
batch 159, loss: 1.0669, instance_loss: 0.5332, weighted_loss: 0.9068, label: 1, bag_size: 917
batch 179, loss: 0.0101, instance_loss: 0.0500, weighted_loss: 0.0221, label: 3, bag_size: 56
batch 199, loss: 0.2190, instance_loss: 0.3152, weighted_loss: 0.2479, label: 2, bag_size: 684
batch 219, loss: 0.0133, instance_loss: 0.1766, weighted_loss: 0.0623, label: 4, bag_size: 26
batch 239, loss: 0.0080, instance_loss: 0.0856, weighted_loss: 0.0313, label: 4, bag_size: 192
batch 259, loss: 1.0490, instance_loss: 0.5000, weighted_loss: 0.8843, label: 4, bag_size: 366
batch 279, loss: 0.1128, instance_loss: 0.3073, weighted_loss: 0.1712, label: 3, bag_size: 16
batch 299, loss: 0.0263, instance_loss: 0.1465, weighted_loss: 0.0623, label: 0, bag_size: 1046
batch 319, loss: 0.0241, instance_loss: 0.1090, weighted_loss: 0.0496, label: 4, bag_size: 55
batch 339, loss: 0.3450, instance_loss: 0.2976, weighted_loss: 0.3308, label: 2, bag_size: 409
batch 359, loss: 0.5044, instance_loss: 0.3012, weighted_loss: 0.4434, label: 0, bag_size: 1101
batch 379, loss: 1.0815, instance_loss: 0.4341, weighted_loss: 0.8873, label: 4, bag_size: 297
batch 399, loss: 0.9138, instance_loss: 0.5146, weighted_loss: 0.7941, label: 2, bag_size: 471
batch 419, loss: 0.0054, instance_loss: 0.0311, weighted_loss: 0.0131, label: 3, bag_size: 56
batch 439, loss: 0.3224, instance_loss: 0.4955, weighted_loss: 0.3743, label: 0, bag_size: 118
batch 459, loss: 0.5873, instance_loss: 0.3696, weighted_loss: 0.5219, label: 2, bag_size: 1378
batch 479, loss: 0.2090, instance_loss: 0.2394, weighted_loss: 0.2181, label: 3, bag_size: 849
batch 499, loss: 0.9138, instance_loss: 0.4820, weighted_loss: 0.7843, label: 2, bag_size: 806
batch 519, loss: 1.1776, instance_loss: 0.5461, weighted_loss: 0.9881, label: 4, bag_size: 1337
batch 539, loss: 0.6031, instance_loss: 0.3603, weighted_loss: 0.5302, label: 1, bag_size: 959


class 0 clustering acc 0.9881192660550459: correct 21541/21800
class 1 clustering acc 0.405045871559633: correct 1766/4360
Epoch: 17, train_loss: 0.3663, train_clustering_loss:  0.3009, train_error: 0.1358
class 0: acc 0.9541284403669725, correct 104/109
class 1: acc 0.7307692307692307, correct 76/104
class 2: acc 0.794392523364486, correct 85/107
class 3: acc 0.9345794392523364, correct 100/107
class 4: acc 0.8983050847457628, correct 106/118

Val Set, val_loss: 0.6912, val_error: 0.2800, auc: 0.9243
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0051, instance_loss: 0.0173, weighted_loss: 0.0088, label: 3, bag_size: 66
batch 39, loss: 0.5098, instance_loss: 0.5368, weighted_loss: 0.5179, label: 4, bag_size: 826
batch 59, loss: 0.3295, instance_loss: 0.3579, weighted_loss: 0.3380, label: 2, bag_size: 632
batch 79, loss: 0.3021, instance_loss: 0.3481, weighted_loss: 0.3159, label: 2, bag_size: 259
batch 99, loss: 0.0213, instance_loss: 0.1837, weighted_loss: 0.0700, label: 4, bag_size: 35
batch 119, loss: 0.0125, instance_loss: 0.1579, weighted_loss: 0.0561, label: 4, bag_size: 28
batch 139, loss: 0.0209, instance_loss: 0.0983, weighted_loss: 0.0441, label: 0, bag_size: 1101
batch 159, loss: 0.0012, instance_loss: 0.0641, weighted_loss: 0.0200, label: 4, bag_size: 140
batch 179, loss: 0.0768, instance_loss: 0.2976, weighted_loss: 0.1431, label: 2, bag_size: 323
batch 199, loss: 0.0014, instance_loss: 0.1468, weighted_loss: 0.0450, label: 4, bag_size: 20
batch 219, loss: 0.0795, instance_loss: 0.3362, weighted_loss: 0.1565, label: 0, bag_size: 478
batch 239, loss: 0.1243, instance_loss: 0.2355, weighted_loss: 0.1576, label: 1, bag_size: 1127
batch 259, loss: 1.3280, instance_loss: 0.4015, weighted_loss: 1.0500, label: 1, bag_size: 1724
batch 279, loss: 0.0070, instance_loss: 0.0644, weighted_loss: 0.0242, label: 4, bag_size: 148
batch 299, loss: 1.0066, instance_loss: 0.4184, weighted_loss: 0.8301, label: 3, bag_size: 697
batch 319, loss: 2.8239, instance_loss: 0.6582, weighted_loss: 2.1742, label: 3, bag_size: 1380
batch 339, loss: 0.4781, instance_loss: 0.5186, weighted_loss: 0.4902, label: 4, bag_size: 366
batch 359, loss: 0.9109, instance_loss: 0.4015, weighted_loss: 0.7581, label: 1, bag_size: 530
batch 379, loss: 0.0023, instance_loss: 0.4226, weighted_loss: 0.1284, label: 4, bag_size: 823
batch 399, loss: 0.4669, instance_loss: 0.4147, weighted_loss: 0.4512, label: 1, bag_size: 487
batch 419, loss: 4.7037, instance_loss: 0.9057, weighted_loss: 3.5643, label: 1, bag_size: 386
batch 439, loss: 0.0523, instance_loss: 0.0769, weighted_loss: 0.0597, label: 3, bag_size: 43
batch 459, loss: 0.1976, instance_loss: 0.6243, weighted_loss: 0.3256, label: 1, bag_size: 657
batch 479, loss: 0.1535, instance_loss: 0.2296, weighted_loss: 0.1763, label: 0, bag_size: 800
batch 499, loss: 0.0421, instance_loss: 0.1835, weighted_loss: 0.0846, label: 3, bag_size: 18
batch 519, loss: 0.0022, instance_loss: 0.0332, weighted_loss: 0.0115, label: 3, bag_size: 105
batch 539, loss: 1.2797, instance_loss: 0.5128, weighted_loss: 1.0496, label: 2, bag_size: 1400


class 0 clustering acc 0.9882568807339449: correct 21544/21800
class 1 clustering acc 0.4279816513761468: correct 1866/4360
Epoch: 18, train_loss: 0.3894, train_clustering_loss:  0.3020, train_error: 0.1431
class 0: acc 0.9326923076923077, correct 97/104
class 1: acc 0.6808510638297872, correct 64/94
class 2: acc 0.7452830188679245, correct 79/106
class 3: acc 0.9210526315789473, correct 105/114
class 4: acc 0.9606299212598425, correct 122/127

Val Set, val_loss: 0.6877, val_error: 0.2200, auc: 0.9274
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.2925: correct 117/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.0404, instance_loss: 0.4503, weighted_loss: 0.8634, label: 4, bag_size: 590
batch 39, loss: 0.0155, instance_loss: 0.0314, weighted_loss: 0.0203, label: 4, bag_size: 157
batch 59, loss: 1.0168, instance_loss: 0.4224, weighted_loss: 0.8385, label: 1, bag_size: 348
batch 79, loss: 0.1056, instance_loss: 0.2082, weighted_loss: 0.1364, label: 3, bag_size: 21
batch 99, loss: 0.0242, instance_loss: 0.1235, weighted_loss: 0.0540, label: 4, bag_size: 47
batch 119, loss: 0.9734, instance_loss: 0.5444, weighted_loss: 0.8447, label: 2, bag_size: 120
batch 139, loss: 0.3960, instance_loss: 0.4327, weighted_loss: 0.4070, label: 0, bag_size: 718
batch 159, loss: 0.6843, instance_loss: 0.5368, weighted_loss: 0.6400, label: 2, bag_size: 537
batch 179, loss: 0.2847, instance_loss: 0.2938, weighted_loss: 0.2874, label: 2, bag_size: 684
batch 199, loss: 0.0121, instance_loss: 0.1239, weighted_loss: 0.0456, label: 3, bag_size: 27
batch 219, loss: 0.0033, instance_loss: 0.3414, weighted_loss: 0.1047, label: 4, bag_size: 823
batch 239, loss: 0.4776, instance_loss: 0.3920, weighted_loss: 0.4519, label: 1, bag_size: 470
batch 259, loss: 0.0303, instance_loss: 0.1545, weighted_loss: 0.0676, label: 0, bag_size: 1046
batch 279, loss: 0.1116, instance_loss: 0.2916, weighted_loss: 0.1656, label: 3, bag_size: 706
batch 299, loss: 1.1511, instance_loss: 0.3501, weighted_loss: 0.9108, label: 0, bag_size: 381
batch 319, loss: 0.0612, instance_loss: 0.3892, weighted_loss: 0.1596, label: 1, bag_size: 1014
batch 339, loss: 0.5588, instance_loss: 0.3223, weighted_loss: 0.4879, label: 1, bag_size: 696
batch 359, loss: 0.0021, instance_loss: 0.0420, weighted_loss: 0.0141, label: 3, bag_size: 56
batch 379, loss: 1.8867, instance_loss: 0.6993, weighted_loss: 1.5305, label: 1, bag_size: 838
batch 399, loss: 0.5264, instance_loss: 0.4508, weighted_loss: 0.5037, label: 1, bag_size: 1096
batch 419, loss: 0.1509, instance_loss: 0.1357, weighted_loss: 0.1464, label: 3, bag_size: 1399
batch 439, loss: 0.5886, instance_loss: 0.3984, weighted_loss: 0.5315, label: 2, bag_size: 1410
batch 459, loss: 0.0098, instance_loss: 0.1360, weighted_loss: 0.0477, label: 4, bag_size: 47
batch 479, loss: 0.1872, instance_loss: 0.3086, weighted_loss: 0.2236, label: 2, bag_size: 222
batch 499, loss: 0.0023, instance_loss: 0.0467, weighted_loss: 0.0156, label: 4, bag_size: 148
batch 519, loss: 0.2050, instance_loss: 0.1619, weighted_loss: 0.1921, label: 1, bag_size: 682
batch 539, loss: 0.1769, instance_loss: 0.3590, weighted_loss: 0.2315, label: 2, bag_size: 1139


class 0 clustering acc 0.9890825688073395: correct 21562/21800
class 1 clustering acc 0.4032110091743119: correct 1758/4360
Epoch: 19, train_loss: 0.3699, train_clustering_loss:  0.2992, train_error: 0.1394
class 0: acc 0.9, correct 81/90
class 1: acc 0.7894736842105263, correct 90/114
class 2: acc 0.788135593220339, correct 93/118
class 3: acc 0.9230769230769231, correct 108/117
class 4: acc 0.9150943396226415, correct 97/106

Val Set, val_loss: 0.6368, val_error: 0.2800, auc: 0.9277
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.3425: correct 137/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
Validation loss decreased (0.644418 --> 0.636820).  Saving model ...


batch 19, loss: 0.0818, instance_loss: 0.2501, weighted_loss: 0.1323, label: 2, bag_size: 907
batch 39, loss: 0.0624, instance_loss: 0.1356, weighted_loss: 0.0844, label: 0, bag_size: 476
batch 59, loss: 0.0490, instance_loss: 0.1423, weighted_loss: 0.0770, label: 0, bag_size: 1086
batch 79, loss: 2.6177, instance_loss: 0.6390, weighted_loss: 2.0241, label: 2, bag_size: 732
batch 99, loss: 0.0108, instance_loss: 0.1060, weighted_loss: 0.0394, label: 4, bag_size: 88
batch 119, loss: 0.3214, instance_loss: 0.2580, weighted_loss: 0.3023, label: 1, bag_size: 754
batch 139, loss: 0.0821, instance_loss: 0.1115, weighted_loss: 0.0910, label: 1, bag_size: 847
batch 159, loss: 0.5862, instance_loss: 0.3264, weighted_loss: 0.5082, label: 2, bag_size: 1200
batch 179, loss: 0.0496, instance_loss: 0.1788, weighted_loss: 0.0884, label: 2, bag_size: 626
batch 199, loss: 0.0034, instance_loss: 0.0756, weighted_loss: 0.0250, label: 4, bag_size: 72
batch 219, loss: 3.2658, instance_loss: 1.2714, weighted_loss: 2.6675, label: 2, bag_size: 1108
batch 239, loss: 0.1183, instance_loss: 0.1529, weighted_loss: 0.1287, label: 0, bag_size: 990
batch 259, loss: 0.1040, instance_loss: 0.1753, weighted_loss: 0.1254, label: 3, bag_size: 75
batch 279, loss: 0.3030, instance_loss: 0.3221, weighted_loss: 0.3088, label: 4, bag_size: 20
batch 299, loss: 0.0014, instance_loss: 0.3455, weighted_loss: 0.1046, label: 4, bag_size: 17
batch 319, loss: 0.1178, instance_loss: 0.3486, weighted_loss: 0.1871, label: 4, bag_size: 826
batch 339, loss: 0.1864, instance_loss: 0.2642, weighted_loss: 0.2097, label: 2, bag_size: 1155
batch 359, loss: 0.0068, instance_loss: 0.0417, weighted_loss: 0.0173, label: 4, bag_size: 78
batch 379, loss: 0.0178, instance_loss: 0.1344, weighted_loss: 0.0528, label: 3, bag_size: 21
batch 399, loss: 0.0134, instance_loss: 0.2847, weighted_loss: 0.0948, label: 4, bag_size: 19
batch 419, loss: 0.0108, instance_loss: 0.0762, weighted_loss: 0.0304, label: 4, bag_size: 79
batch 439, loss: 0.1878, instance_loss: 0.2340, weighted_loss: 0.2016, label: 0, bag_size: 200
batch 459, loss: 0.9863, instance_loss: 0.5580, weighted_loss: 0.8578, label: 1, bag_size: 1197
batch 479, loss: 0.0122, instance_loss: 0.1273, weighted_loss: 0.0467, label: 3, bag_size: 20
batch 499, loss: 0.0095, instance_loss: 0.0735, weighted_loss: 0.0287, label: 0, bag_size: 382
batch 519, loss: 0.0495, instance_loss: 0.3886, weighted_loss: 0.1512, label: 1, bag_size: 1014
batch 539, loss: 1.5262, instance_loss: 0.6565, weighted_loss: 1.2653, label: 1, bag_size: 308


class 0 clustering acc 0.9869724770642202: correct 21516/21800
class 1 clustering acc 0.40711009174311924: correct 1775/4360
Epoch: 20, train_loss: 0.3921, train_clustering_loss:  0.3078, train_error: 0.1358
class 0: acc 0.9210526315789473, correct 105/114
class 1: acc 0.7476635514018691, correct 80/107
class 2: acc 0.8253968253968254, correct 104/126
class 3: acc 0.94, correct 94/100
class 4: acc 0.8979591836734694, correct 88/98

Val Set, val_loss: 0.6128, val_error: 0.2200, auc: 0.9341
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
Validation loss decreased (0.636820 --> 0.612811).  Saving model ...


batch 19, loss: 0.0140, instance_loss: 0.1141, weighted_loss: 0.0441, label: 0, bag_size: 1018
batch 39, loss: 0.9715, instance_loss: 0.4714, weighted_loss: 0.8215, label: 0, bag_size: 1301
batch 59, loss: 0.1312, instance_loss: 0.2430, weighted_loss: 0.1647, label: 1, bag_size: 318
batch 79, loss: 0.2353, instance_loss: 0.2516, weighted_loss: 0.2402, label: 1, bag_size: 405
batch 99, loss: 0.2614, instance_loss: 0.3685, weighted_loss: 0.2935, label: 1, bag_size: 533
batch 119, loss: 0.0049, instance_loss: 0.0244, weighted_loss: 0.0108, label: 3, bag_size: 66
batch 139, loss: 0.0018, instance_loss: 0.0229, weighted_loss: 0.0081, label: 3, bag_size: 115
batch 159, loss: 0.1700, instance_loss: 0.1817, weighted_loss: 0.1735, label: 1, bag_size: 886
batch 179, loss: 0.6987, instance_loss: 0.6461, weighted_loss: 0.6829, label: 1, bag_size: 861
batch 199, loss: 0.3416, instance_loss: 0.2934, weighted_loss: 0.3271, label: 2, bag_size: 1164
batch 219, loss: 0.4771, instance_loss: 0.4443, weighted_loss: 0.4673, label: 0, bag_size: 1527
batch 239, loss: 0.2789, instance_loss: 0.3717, weighted_loss: 0.3068, label: 1, bag_size: 470
batch 259, loss: 0.0340, instance_loss: 0.1370, weighted_loss: 0.0649, label: 0, bag_size: 1247
batch 279, loss: 1.2830, instance_loss: 0.6011, weighted_loss: 1.0784, label: 1, bag_size: 1197
batch 299, loss: 0.0022, instance_loss: 0.0495, weighted_loss: 0.0164, label: 4, bag_size: 185
batch 319, loss: 0.1755, instance_loss: 0.1427, weighted_loss: 0.1657, label: 3, bag_size: 556
batch 339, loss: 0.0143, instance_loss: 0.1069, weighted_loss: 0.0421, label: 0, bag_size: 1046
batch 359, loss: 0.0093, instance_loss: 0.2064, weighted_loss: 0.0685, label: 4, bag_size: 24
batch 379, loss: 0.6991, instance_loss: 0.2926, weighted_loss: 0.5772, label: 1, bag_size: 1144
batch 399, loss: 0.8627, instance_loss: 0.4355, weighted_loss: 0.7345, label: 0, bag_size: 381
batch 419, loss: 0.0986, instance_loss: 0.1833, weighted_loss: 0.1240, label: 1, bag_size: 746
batch 439, loss: 0.0395, instance_loss: 0.1127, weighted_loss: 0.0614, label: 1, bag_size: 1191
batch 459, loss: 0.0156, instance_loss: 0.1277, weighted_loss: 0.0493, label: 0, bag_size: 1086
batch 479, loss: 1.2004, instance_loss: 0.3801, weighted_loss: 0.9543, label: 1, bag_size: 442
batch 499, loss: 0.0013, instance_loss: 0.2394, weighted_loss: 0.0727, label: 4, bag_size: 35
batch 519, loss: 1.6017, instance_loss: 0.6272, weighted_loss: 1.3094, label: 1, bag_size: 1799
batch 539, loss: 0.0124, instance_loss: 0.2709, weighted_loss: 0.0900, label: 3, bag_size: 1253


class 0 clustering acc 0.9872018348623853: correct 21521/21800
class 1 clustering acc 0.44380733944954126: correct 1935/4360
Epoch: 21, train_loss: 0.3699, train_clustering_loss:  0.2946, train_error: 0.1284
class 0: acc 0.9298245614035088, correct 106/114
class 1: acc 0.8035714285714286, correct 90/112
class 2: acc 0.7889908256880734, correct 86/109
class 3: acc 0.9532710280373832, correct 102/107
class 4: acc 0.883495145631068, correct 91/103

Val Set, val_loss: 0.8287, val_error: 0.3200, auc: 0.9096
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.2975: correct 119/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.5714285714285714, correct 12/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0164, instance_loss: 0.0703, weighted_loss: 0.0326, label: 0, bag_size: 1086
batch 39, loss: 0.0131, instance_loss: 0.1707, weighted_loss: 0.0604, label: 3, bag_size: 20
batch 59, loss: 0.0039, instance_loss: 0.1240, weighted_loss: 0.0399, label: 3, bag_size: 18
batch 79, loss: 0.6101, instance_loss: 0.4895, weighted_loss: 0.5739, label: 2, bag_size: 295
batch 99, loss: 0.0004, instance_loss: 0.2232, weighted_loss: 0.0672, label: 4, bag_size: 20
batch 119, loss: 0.1340, instance_loss: 0.1439, weighted_loss: 0.1370, label: 1, bag_size: 682
batch 139, loss: 0.0030, instance_loss: 0.1471, weighted_loss: 0.0462, label: 3, bag_size: 20
batch 159, loss: 0.0095, instance_loss: 0.0599, weighted_loss: 0.0247, label: 3, bag_size: 75
batch 179, loss: 0.0085, instance_loss: 0.0890, weighted_loss: 0.0327, label: 4, bag_size: 160
batch 199, loss: 0.7869, instance_loss: 0.5069, weighted_loss: 0.7029, label: 2, bag_size: 732
batch 219, loss: 0.1294, instance_loss: 0.3062, weighted_loss: 0.1824, label: 4, bag_size: 1235
batch 239, loss: 0.0877, instance_loss: 0.1909, weighted_loss: 0.1187, label: 2, bag_size: 913
batch 259, loss: 0.0044, instance_loss: 0.0498, weighted_loss: 0.0180, label: 4, bag_size: 39
batch 279, loss: 0.0477, instance_loss: 0.1686, weighted_loss: 0.0840, label: 0, bag_size: 760
batch 299, loss: 0.6909, instance_loss: 0.6089, weighted_loss: 0.6663, label: 4, bag_size: 366
batch 319, loss: 0.0887, instance_loss: 0.6007, weighted_loss: 0.2423, label: 4, bag_size: 882
batch 339, loss: 0.0419, instance_loss: 0.1419, weighted_loss: 0.0719, label: 2, bag_size: 480
batch 359, loss: 0.1066, instance_loss: 0.1986, weighted_loss: 0.1342, label: 2, bag_size: 1235
batch 379, loss: 0.8769, instance_loss: 0.3984, weighted_loss: 0.7333, label: 3, bag_size: 533
batch 399, loss: 0.8042, instance_loss: 0.5802, weighted_loss: 0.7370, label: 2, bag_size: 324
batch 419, loss: 0.4139, instance_loss: 0.3020, weighted_loss: 0.3803, label: 1, bag_size: 898
batch 439, loss: 0.3484, instance_loss: 0.2701, weighted_loss: 0.3249, label: 1, bag_size: 869
batch 459, loss: 0.0122, instance_loss: 0.1990, weighted_loss: 0.0683, label: 4, bag_size: 39
batch 479, loss: 0.9828, instance_loss: 0.4649, weighted_loss: 0.8274, label: 1, bag_size: 959
batch 499, loss: 1.1012, instance_loss: 0.8137, weighted_loss: 1.0149, label: 1, bag_size: 660
batch 519, loss: 0.2797, instance_loss: 0.4353, weighted_loss: 0.3263, label: 1, bag_size: 269
batch 539, loss: 0.0939, instance_loss: 0.1955, weighted_loss: 0.1244, label: 1, bag_size: 1402


class 0 clustering acc 0.9875688073394495: correct 21529/21800
class 1 clustering acc 0.4860091743119266: correct 2119/4360
Epoch: 22, train_loss: 0.3095, train_clustering_loss:  0.2770, train_error: 0.1101
class 0: acc 0.9357798165137615, correct 102/109
class 1: acc 0.8348623853211009, correct 91/109
class 2: acc 0.7983193277310925, correct 95/119
class 3: acc 0.9428571428571428, correct 99/105
class 4: acc 0.9514563106796117, correct 98/103

Val Set, val_loss: 0.8264, val_error: 0.3000, auc: 0.9194
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.35: correct 140/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.5714285714285714, correct 12/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0004, instance_loss: 0.0520, weighted_loss: 0.0159, label: 4, bag_size: 140
batch 39, loss: 0.0011, instance_loss: 0.1508, weighted_loss: 0.0460, label: 3, bag_size: 20
batch 59, loss: 0.1507, instance_loss: 0.2681, weighted_loss: 0.1859, label: 2, bag_size: 461
batch 79, loss: 0.0021, instance_loss: 0.0522, weighted_loss: 0.0171, label: 4, bag_size: 140
batch 99, loss: 0.2635, instance_loss: 0.2931, weighted_loss: 0.2724, label: 1, bag_size: 474
batch 119, loss: 0.1417, instance_loss: 0.2340, weighted_loss: 0.1694, label: 0, bag_size: 1196
batch 139, loss: 0.0136, instance_loss: 0.1342, weighted_loss: 0.0498, label: 3, bag_size: 18
batch 159, loss: 1.2004, instance_loss: 0.5369, weighted_loss: 1.0013, label: 2, bag_size: 679
batch 179, loss: 0.0379, instance_loss: 0.0472, weighted_loss: 0.0407, label: 1, bag_size: 834
batch 199, loss: 0.0070, instance_loss: 0.0372, weighted_loss: 0.0160, label: 0, bag_size: 1466
batch 219, loss: 0.2203, instance_loss: 0.2733, weighted_loss: 0.2362, label: 2, bag_size: 237
batch 239, loss: 0.0012, instance_loss: 0.0913, weighted_loss: 0.0282, label: 4, bag_size: 88
batch 259, loss: 0.3263, instance_loss: 0.2784, weighted_loss: 0.3120, label: 0, bag_size: 381
batch 279, loss: 1.4912, instance_loss: 0.4139, weighted_loss: 1.1680, label: 2, bag_size: 861
batch 299, loss: 0.0007, instance_loss: 0.0725, weighted_loss: 0.0223, label: 3, bag_size: 46
batch 319, loss: 0.0371, instance_loss: 0.0969, weighted_loss: 0.0551, label: 1, bag_size: 1261
batch 339, loss: 0.0237, instance_loss: 0.1324, weighted_loss: 0.0563, label: 3, bag_size: 28
batch 359, loss: 1.5014, instance_loss: 0.6408, weighted_loss: 1.2432, label: 0, bag_size: 423
batch 379, loss: 0.0063, instance_loss: 0.0642, weighted_loss: 0.0237, label: 0, bag_size: 402
batch 399, loss: 0.1540, instance_loss: 0.2466, weighted_loss: 0.1818, label: 2, bag_size: 567
batch 419, loss: 0.2177, instance_loss: 0.3573, weighted_loss: 0.2596, label: 2, bag_size: 732
batch 439, loss: 0.0399, instance_loss: 0.2497, weighted_loss: 0.1028, label: 0, bag_size: 478
batch 459, loss: 0.1165, instance_loss: 0.4069, weighted_loss: 0.2036, label: 3, bag_size: 1291
batch 479, loss: 0.0256, instance_loss: 0.1624, weighted_loss: 0.0666, label: 4, bag_size: 157
batch 499, loss: 0.0517, instance_loss: 0.1755, weighted_loss: 0.0888, label: 0, bag_size: 962
batch 519, loss: 0.0124, instance_loss: 0.1582, weighted_loss: 0.0561, label: 4, bag_size: 39
batch 539, loss: 0.6237, instance_loss: 0.4728, weighted_loss: 0.5784, label: 1, bag_size: 1273


class 0 clustering acc 0.9874311926605505: correct 21526/21800
class 1 clustering acc 0.4653669724770642: correct 2029/4360
Epoch: 23, train_loss: 0.3029, train_clustering_loss:  0.2819, train_error: 0.1101
class 0: acc 0.9479166666666666, correct 91/96
class 1: acc 0.8211382113821138, correct 101/123
class 2: acc 0.8288288288288288, correct 92/111
class 3: acc 0.9302325581395349, correct 80/86
class 4: acc 0.937984496124031, correct 121/129

Val Set, val_loss: 0.6468, val_error: 0.2200, auc: 0.9281
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.365: correct 146/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0028, instance_loss: 0.0691, weighted_loss: 0.0227, label: 3, bag_size: 48
batch 39, loss: 0.0003, instance_loss: 0.0464, weighted_loss: 0.0142, label: 3, bag_size: 24
batch 59, loss: 0.7047, instance_loss: 0.3865, weighted_loss: 0.6092, label: 2, bag_size: 271
batch 79, loss: 0.0440, instance_loss: 0.1036, weighted_loss: 0.0619, label: 1, bag_size: 346
batch 99, loss: 0.3863, instance_loss: 0.2043, weighted_loss: 0.3317, label: 1, bag_size: 847
batch 119, loss: 0.3958, instance_loss: 0.4623, weighted_loss: 0.4157, label: 2, bag_size: 1141
batch 139, loss: 0.0191, instance_loss: 0.1016, weighted_loss: 0.0438, label: 0, bag_size: 1133
batch 159, loss: 0.1803, instance_loss: 0.1772, weighted_loss: 0.1793, label: 1, bag_size: 598
batch 179, loss: 0.0004, instance_loss: 0.0289, weighted_loss: 0.0089, label: 3, bag_size: 105
batch 199, loss: 0.1660, instance_loss: 0.2685, weighted_loss: 0.1968, label: 2, bag_size: 1164
batch 219, loss: 0.0392, instance_loss: 0.0981, weighted_loss: 0.0569, label: 3, bag_size: 19
batch 239, loss: 0.0155, instance_loss: 0.0461, weighted_loss: 0.0247, label: 1, bag_size: 1277
batch 259, loss: 0.0065, instance_loss: 0.0462, weighted_loss: 0.0184, label: 3, bag_size: 60
batch 279, loss: 0.1055, instance_loss: 0.2941, weighted_loss: 0.1621, label: 4, bag_size: 1235
batch 299, loss: 0.0148, instance_loss: 0.0781, weighted_loss: 0.0338, label: 4, bag_size: 72
batch 319, loss: 0.2823, instance_loss: 0.4838, weighted_loss: 0.3427, label: 2, bag_size: 748
batch 339, loss: 0.0049, instance_loss: 0.1805, weighted_loss: 0.0576, label: 3, bag_size: 21
batch 359, loss: 0.0210, instance_loss: 0.2011, weighted_loss: 0.0750, label: 0, bag_size: 472
batch 379, loss: 0.0003, instance_loss: 0.0336, weighted_loss: 0.0103, label: 3, bag_size: 123
batch 399, loss: 0.0010, instance_loss: 0.0240, weighted_loss: 0.0079, label: 4, bag_size: 96
batch 419, loss: 0.1182, instance_loss: 0.2429, weighted_loss: 0.1556, label: 2, bag_size: 265
batch 439, loss: 0.2614, instance_loss: 0.6144, weighted_loss: 0.3673, label: 2, bag_size: 373
batch 459, loss: 0.0283, instance_loss: 0.1290, weighted_loss: 0.0585, label: 1, bag_size: 834
batch 479, loss: 0.0006, instance_loss: 0.0557, weighted_loss: 0.0171, label: 3, bag_size: 32
batch 499, loss: 0.0597, instance_loss: 0.1075, weighted_loss: 0.0741, label: 1, bag_size: 356
batch 519, loss: 0.1105, instance_loss: 0.2764, weighted_loss: 0.1603, label: 0, bag_size: 515
batch 539, loss: 0.0341, instance_loss: 0.1663, weighted_loss: 0.0738, label: 1, bag_size: 1127


class 0 clustering acc 0.9877064220183486: correct 21532/21800
class 1 clustering acc 0.4878440366972477: correct 2127/4360
Epoch: 24, train_loss: 0.2505, train_clustering_loss:  0.2699, train_error: 0.0807
class 0: acc 0.963302752293578, correct 105/109
class 1: acc 0.875, correct 112/128
class 2: acc 0.8571428571428571, correct 90/105
class 3: acc 0.9537037037037037, correct 103/108
class 4: acc 0.9578947368421052, correct 91/95

Val Set, val_loss: 0.6600, val_error: 0.2200, auc: 0.9327
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.39: correct 156/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 4 out of 20


batch 19, loss: 2.1766, instance_loss: 0.6370, weighted_loss: 1.7147, label: 1, bag_size: 1376
batch 39, loss: 0.0001, instance_loss: 0.0265, weighted_loss: 0.0080, label: 4, bag_size: 134
batch 59, loss: 0.0006, instance_loss: 0.0230, weighted_loss: 0.0073, label: 3, bag_size: 48
batch 79, loss: 0.0016, instance_loss: 0.6631, weighted_loss: 0.2000, label: 4, bag_size: 823
batch 99, loss: 0.4505, instance_loss: 0.2120, weighted_loss: 0.3790, label: 2, bag_size: 1281
batch 119, loss: 0.1222, instance_loss: 0.1271, weighted_loss: 0.1237, label: 1, bag_size: 1325
batch 139, loss: 0.0058, instance_loss: 0.1021, weighted_loss: 0.0347, label: 4, bag_size: 55
batch 159, loss: 0.0010, instance_loss: 0.0304, weighted_loss: 0.0098, label: 4, bag_size: 43
batch 179, loss: 0.0654, instance_loss: 0.0837, weighted_loss: 0.0709, label: 3, bag_size: 556
batch 199, loss: 0.1136, instance_loss: 0.2166, weighted_loss: 0.1445, label: 2, bag_size: 1215
batch 219, loss: 0.0232, instance_loss: 0.1997, weighted_loss: 0.0762, label: 2, bag_size: 419
batch 239, loss: 0.0923, instance_loss: 0.1071, weighted_loss: 0.0967, label: 3, bag_size: 556
batch 259, loss: 0.5882, instance_loss: 0.5372, weighted_loss: 0.5729, label: 2, bag_size: 408
batch 279, loss: 0.0595, instance_loss: 0.4405, weighted_loss: 0.1738, label: 0, bag_size: 129
batch 299, loss: 0.1584, instance_loss: 0.2321, weighted_loss: 0.1805, label: 2, bag_size: 806
batch 319, loss: 0.2463, instance_loss: 0.2618, weighted_loss: 0.2510, label: 2, bag_size: 878
batch 339, loss: 0.0026, instance_loss: 0.0211, weighted_loss: 0.0082, label: 4, bag_size: 91
batch 359, loss: 0.7100, instance_loss: 0.7120, weighted_loss: 0.7106, label: 2, bag_size: 373
batch 379, loss: 0.3376, instance_loss: 0.3297, weighted_loss: 0.3353, label: 4, bag_size: 1121
batch 399, loss: 0.4468, instance_loss: 0.3665, weighted_loss: 0.4227, label: 0, bag_size: 542
batch 419, loss: 0.0608, instance_loss: 0.6020, weighted_loss: 0.2231, label: 0, bag_size: 818
batch 439, loss: 0.1510, instance_loss: 0.3567, weighted_loss: 0.2127, label: 2, bag_size: 649
batch 459, loss: 0.1791, instance_loss: 0.2399, weighted_loss: 0.1974, label: 3, bag_size: 316
batch 479, loss: 0.1069, instance_loss: 0.2135, weighted_loss: 0.1389, label: 2, bag_size: 2081
batch 499, loss: 0.0015, instance_loss: 0.0420, weighted_loss: 0.0136, label: 0, bag_size: 898
batch 519, loss: 0.0019, instance_loss: 0.0885, weighted_loss: 0.0279, label: 4, bag_size: 88
batch 539, loss: 0.3696, instance_loss: 0.5617, weighted_loss: 0.4272, label: 2, bag_size: 518


class 0 clustering acc 0.9867431192660551: correct 21511/21800
class 1 clustering acc 0.48027522935779815: correct 2094/4360
Epoch: 25, train_loss: 0.2872, train_clustering_loss:  0.2795, train_error: 0.0936
class 0: acc 0.9385964912280702, correct 107/114
class 1: acc 0.8207547169811321, correct 87/106
class 2: acc 0.8545454545454545, correct 94/110
class 3: acc 0.9279279279279279, correct 103/111
class 4: acc 0.9903846153846154, correct 103/104

Val Set, val_loss: 0.6674, val_error: 0.2400, auc: 0.9198
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.3575: correct 143/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.6875, correct 11/16
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2054, instance_loss: 0.3102, weighted_loss: 0.2368, label: 2, bag_size: 932
batch 39, loss: 0.6197, instance_loss: 0.3086, weighted_loss: 0.5264, label: 1, bag_size: 1080
batch 59, loss: 0.3989, instance_loss: 0.6768, weighted_loss: 0.4823, label: 0, bag_size: 282
batch 79, loss: 2.1804, instance_loss: 0.5329, weighted_loss: 1.6861, label: 1, bag_size: 838
batch 99, loss: 0.0639, instance_loss: 0.2249, weighted_loss: 0.1122, label: 1, bag_size: 696
batch 119, loss: 0.1466, instance_loss: 0.2719, weighted_loss: 0.1842, label: 0, bag_size: 410
batch 139, loss: 0.0773, instance_loss: 0.2370, weighted_loss: 0.1252, label: 3, bag_size: 405
batch 159, loss: 0.2747, instance_loss: 0.2615, weighted_loss: 0.2708, label: 1, bag_size: 1144
batch 179, loss: 0.0158, instance_loss: 0.1162, weighted_loss: 0.0459, label: 0, bag_size: 800
batch 199, loss: 0.1857, instance_loss: 0.3375, weighted_loss: 0.2312, label: 1, bag_size: 867
batch 219, loss: 0.0005, instance_loss: 0.1126, weighted_loss: 0.0342, label: 4, bag_size: 91
batch 239, loss: 0.3943, instance_loss: 0.4414, weighted_loss: 0.4084, label: 1, bag_size: 470
batch 259, loss: 1.9445, instance_loss: 0.7832, weighted_loss: 1.5961, label: 2, bag_size: 500
batch 279, loss: 0.0204, instance_loss: 0.2602, weighted_loss: 0.0924, label: 4, bag_size: 790
batch 299, loss: 0.0150, instance_loss: 0.2185, weighted_loss: 0.0761, label: 3, bag_size: 15
batch 319, loss: 0.1727, instance_loss: 0.2762, weighted_loss: 0.2037, label: 2, bag_size: 848
batch 339, loss: 1.0538, instance_loss: 0.4069, weighted_loss: 0.8597, label: 1, bag_size: 867
batch 359, loss: 0.0009, instance_loss: 0.1381, weighted_loss: 0.0421, label: 3, bag_size: 18
batch 379, loss: 0.0072, instance_loss: 0.2479, weighted_loss: 0.0794, label: 4, bag_size: 24
batch 399, loss: 0.0814, instance_loss: 0.1269, weighted_loss: 0.0950, label: 1, bag_size: 682
batch 419, loss: 0.2628, instance_loss: 0.2740, weighted_loss: 0.2661, label: 0, bag_size: 432
batch 439, loss: 0.0166, instance_loss: 0.5248, weighted_loss: 0.1690, label: 4, bag_size: 974
batch 459, loss: 0.1022, instance_loss: 0.2589, weighted_loss: 0.1492, label: 0, bag_size: 413
batch 479, loss: 0.0857, instance_loss: 0.1741, weighted_loss: 0.1123, label: 0, bag_size: 1196
batch 499, loss: 0.0253, instance_loss: 0.1030, weighted_loss: 0.0486, label: 1, bag_size: 346
batch 519, loss: 0.0181, instance_loss: 0.5373, weighted_loss: 0.1739, label: 4, bag_size: 974
batch 539, loss: 0.0207, instance_loss: 0.3466, weighted_loss: 0.1185, label: 1, bag_size: 897


class 0 clustering acc 0.9877981651376146: correct 21534/21800
class 1 clustering acc 0.46490825688073395: correct 2027/4360
Epoch: 26, train_loss: 0.2695, train_clustering_loss:  0.2855, train_error: 0.0844
class 0: acc 0.9682539682539683, correct 122/126
class 1: acc 0.8247422680412371, correct 80/97
class 2: acc 0.8529411764705882, correct 87/102
class 3: acc 0.954954954954955, correct 106/111
class 4: acc 0.9541284403669725, correct 104/109

Val Set, val_loss: 0.8066, val_error: 0.3000, auc: 0.9233
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.3675: correct 147/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.5714285714285714, correct 12/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0973, instance_loss: 0.1783, weighted_loss: 0.1216, label: 0, bag_size: 552
batch 39, loss: 0.3299, instance_loss: 0.3310, weighted_loss: 0.3302, label: 2, bag_size: 1235
batch 59, loss: 0.1626, instance_loss: 0.2754, weighted_loss: 0.1965, label: 0, bag_size: 542
batch 79, loss: 0.0109, instance_loss: 0.2251, weighted_loss: 0.0751, label: 3, bag_size: 24
batch 99, loss: 0.0012, instance_loss: 0.1209, weighted_loss: 0.0371, label: 3, bag_size: 24
batch 119, loss: 0.8077, instance_loss: 0.7598, weighted_loss: 0.7933, label: 3, bag_size: 607
batch 139, loss: 2.3091, instance_loss: 0.5467, weighted_loss: 1.7804, label: 1, bag_size: 869
batch 159, loss: 0.0056, instance_loss: 0.4218, weighted_loss: 0.1305, label: 3, bag_size: 841
batch 179, loss: 0.0050, instance_loss: 0.3127, weighted_loss: 0.0973, label: 4, bag_size: 790
batch 199, loss: 0.0003, instance_loss: 0.1312, weighted_loss: 0.0396, label: 4, bag_size: 44
batch 219, loss: 0.0405, instance_loss: 0.5859, weighted_loss: 0.2041, label: 0, bag_size: 255
batch 239, loss: 0.0044, instance_loss: 0.1583, weighted_loss: 0.0505, label: 3, bag_size: 18
batch 259, loss: 3.3724, instance_loss: 0.8993, weighted_loss: 2.6305, label: 2, bag_size: 1178
batch 279, loss: 0.0381, instance_loss: 0.1716, weighted_loss: 0.0782, label: 2, bag_size: 1155
batch 299, loss: 0.0014, instance_loss: 0.0751, weighted_loss: 0.0235, label: 3, bag_size: 32
batch 319, loss: 0.4730, instance_loss: 0.6567, weighted_loss: 0.5281, label: 1, bag_size: 269
batch 339, loss: 0.0194, instance_loss: 0.5647, weighted_loss: 0.1830, label: 1, bag_size: 700
batch 359, loss: 0.0060, instance_loss: 0.1769, weighted_loss: 0.0572, label: 0, bag_size: 1046
batch 379, loss: 0.0044, instance_loss: 0.0385, weighted_loss: 0.0146, label: 0, bag_size: 521
batch 399, loss: 0.2099, instance_loss: 0.4041, weighted_loss: 0.2682, label: 4, bag_size: 817
batch 419, loss: 0.7206, instance_loss: 0.5726, weighted_loss: 0.6762, label: 1, bag_size: 651
batch 439, loss: 0.0552, instance_loss: 0.3374, weighted_loss: 0.1399, label: 4, bag_size: 826
batch 459, loss: 0.0643, instance_loss: 0.1562, weighted_loss: 0.0919, label: 0, bag_size: 800
batch 479, loss: 0.0017, instance_loss: 0.1639, weighted_loss: 0.0504, label: 4, bag_size: 86
batch 499, loss: 0.5419, instance_loss: 0.8278, weighted_loss: 0.6277, label: 1, bag_size: 860
batch 519, loss: 0.0066, instance_loss: 0.0832, weighted_loss: 0.0296, label: 4, bag_size: 55
batch 539, loss: 1.1161, instance_loss: 0.7722, weighted_loss: 1.0129, label: 1, bag_size: 308


class 0 clustering acc 0.9864220183486239: correct 21504/21800
class 1 clustering acc 0.5009174311926605: correct 2184/4360
Epoch: 27, train_loss: 0.2368, train_clustering_loss:  0.2720, train_error: 0.0716
class 0: acc 0.9819819819819819, correct 109/111
class 1: acc 0.8640776699029126, correct 89/103
class 2: acc 0.8870967741935484, correct 110/124
class 3: acc 0.96, correct 96/100
class 4: acc 0.9532710280373832, correct 102/107

Val Set, val_loss: 0.7330, val_error: 0.2400, auc: 0.9280
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.4125: correct 165/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0993, instance_loss: 0.7242, weighted_loss: 0.2868, label: 1, bag_size: 861
batch 39, loss: 0.0643, instance_loss: 0.3970, weighted_loss: 0.1641, label: 1, bag_size: 1014
batch 59, loss: 0.0015, instance_loss: 0.2668, weighted_loss: 0.0811, label: 3, bag_size: 18
batch 79, loss: 1.2199, instance_loss: 0.3215, weighted_loss: 0.9504, label: 4, bag_size: 646
batch 99, loss: 0.0186, instance_loss: 0.2753, weighted_loss: 0.0956, label: 0, bag_size: 122
batch 119, loss: 0.0007, instance_loss: 0.3928, weighted_loss: 0.1183, label: 4, bag_size: 823
batch 139, loss: 0.0255, instance_loss: 0.1930, weighted_loss: 0.0757, label: 0, bag_size: 114
batch 159, loss: 1.2523, instance_loss: 0.5227, weighted_loss: 1.0334, label: 4, bag_size: 754
batch 179, loss: 0.9302, instance_loss: 0.5927, weighted_loss: 0.8289, label: 1, bag_size: 917
batch 199, loss: 0.7107, instance_loss: 0.6799, weighted_loss: 0.7015, label: 1, bag_size: 293
batch 219, loss: 0.1679, instance_loss: 0.3573, weighted_loss: 0.2247, label: 0, bag_size: 163
batch 239, loss: 0.4851, instance_loss: 0.3508, weighted_loss: 0.4448, label: 2, bag_size: 1200
batch 259, loss: 0.0239, instance_loss: 0.5909, weighted_loss: 0.1940, label: 4, bag_size: 663
batch 279, loss: 0.0019, instance_loss: 0.1572, weighted_loss: 0.0485, label: 3, bag_size: 18
batch 299, loss: 0.0364, instance_loss: 0.2378, weighted_loss: 0.0968, label: 2, bag_size: 345
batch 319, loss: 0.3366, instance_loss: 0.4028, weighted_loss: 0.3564, label: 2, bag_size: 1139
batch 339, loss: 0.0392, instance_loss: 0.1153, weighted_loss: 0.0621, label: 0, bag_size: 476
batch 359, loss: 0.0750, instance_loss: 0.1624, weighted_loss: 0.1012, label: 2, bag_size: 935
batch 379, loss: 0.0621, instance_loss: 0.1821, weighted_loss: 0.0981, label: 2, bag_size: 499
batch 399, loss: 0.6301, instance_loss: 0.4811, weighted_loss: 0.5854, label: 0, bag_size: 437
batch 419, loss: 0.6979, instance_loss: 0.4734, weighted_loss: 0.6305, label: 1, bag_size: 530
batch 439, loss: 0.6448, instance_loss: 0.3392, weighted_loss: 0.5531, label: 3, bag_size: 343
batch 459, loss: 0.6539, instance_loss: 0.3706, weighted_loss: 0.5689, label: 4, bag_size: 1121
batch 479, loss: 0.1563, instance_loss: 0.3848, weighted_loss: 0.2249, label: 2, bag_size: 278
batch 499, loss: 0.0602, instance_loss: 0.1819, weighted_loss: 0.0967, label: 2, bag_size: 271
batch 519, loss: 0.0758, instance_loss: 0.3293, weighted_loss: 0.1518, label: 2, bag_size: 636
batch 539, loss: 0.0197, instance_loss: 0.1337, weighted_loss: 0.0539, label: 2, bag_size: 1788


class 0 clustering acc 0.9847706422018349: correct 21468/21800
class 1 clustering acc 0.5029816513761468: correct 2193/4360
Epoch: 28, train_loss: 0.2370, train_clustering_loss:  0.2784, train_error: 0.0789
class 0: acc 0.9313725490196079, correct 95/102
class 1: acc 0.8541666666666666, correct 82/96
class 2: acc 0.8770491803278688, correct 107/122
class 3: acc 0.9591836734693877, correct 94/98
class 4: acc 0.9763779527559056, correct 124/127

Val Set, val_loss: 0.6887, val_error: 0.2600, auc: 0.9326
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.3875: correct 155/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0547, instance_loss: 0.1063, weighted_loss: 0.0702, label: 3, bag_size: 1399
batch 39, loss: 0.1504, instance_loss: 0.5231, weighted_loss: 0.2622, label: 2, bag_size: 411
batch 59, loss: 0.3904, instance_loss: 0.3836, weighted_loss: 0.3884, label: 1, bag_size: 405
batch 79, loss: 1.2306, instance_loss: 0.5297, weighted_loss: 1.0203, label: 4, bag_size: 1337
batch 99, loss: 0.0329, instance_loss: 0.1365, weighted_loss: 0.0640, label: 0, bag_size: 338
batch 119, loss: 0.2142, instance_loss: 0.3129, weighted_loss: 0.2438, label: 2, bag_size: 356
batch 139, loss: 0.1363, instance_loss: 0.1223, weighted_loss: 0.1321, label: 3, bag_size: 316
batch 159, loss: 0.0660, instance_loss: 0.3359, weighted_loss: 0.1469, label: 0, bag_size: 143
batch 179, loss: 0.6127, instance_loss: 0.2957, weighted_loss: 0.5176, label: 4, bag_size: 20
batch 199, loss: 0.0010, instance_loss: 0.1626, weighted_loss: 0.0495, label: 4, bag_size: 1357
batch 219, loss: 0.0012, instance_loss: 0.0382, weighted_loss: 0.0123, label: 4, bag_size: 63
batch 239, loss: 0.0992, instance_loss: 0.1872, weighted_loss: 0.1256, label: 3, bag_size: 849
batch 259, loss: 0.0043, instance_loss: 0.3164, weighted_loss: 0.0979, label: 0, bag_size: 607
batch 279, loss: 0.6335, instance_loss: 0.4895, weighted_loss: 0.5903, label: 4, bag_size: 1474
batch 299, loss: 0.0007, instance_loss: 0.1198, weighted_loss: 0.0364, label: 3, bag_size: 20
batch 319, loss: 0.0063, instance_loss: 0.0803, weighted_loss: 0.0285, label: 4, bag_size: 110
batch 339, loss: 0.0998, instance_loss: 0.1073, weighted_loss: 0.1020, label: 3, bag_size: 316
batch 359, loss: 0.0013, instance_loss: 0.0606, weighted_loss: 0.0191, label: 3, bag_size: 123
batch 379, loss: 0.0065, instance_loss: 0.0563, weighted_loss: 0.0215, label: 3, bag_size: 87
batch 399, loss: 0.0210, instance_loss: 0.2336, weighted_loss: 0.0848, label: 1, bag_size: 318
batch 419, loss: 0.0101, instance_loss: 0.1110, weighted_loss: 0.0404, label: 3, bag_size: 27
batch 439, loss: 0.0031, instance_loss: 0.0372, weighted_loss: 0.0134, label: 4, bag_size: 63
batch 459, loss: 0.0004, instance_loss: 0.0236, weighted_loss: 0.0074, label: 3, bag_size: 43
batch 479, loss: 0.0032, instance_loss: 0.1537, weighted_loss: 0.0484, label: 4, bag_size: 40
batch 499, loss: 0.0207, instance_loss: 0.4028, weighted_loss: 0.1353, label: 1, bag_size: 1049
batch 519, loss: 0.0067, instance_loss: 0.0735, weighted_loss: 0.0268, label: 0, bag_size: 382
batch 539, loss: 2.3753, instance_loss: 0.7284, weighted_loss: 1.8812, label: 2, bag_size: 959


class 0 clustering acc 0.9848623853211009: correct 21470/21800
class 1 clustering acc 0.5114678899082569: correct 2230/4360
Epoch: 29, train_loss: 0.2192, train_clustering_loss:  0.2717, train_error: 0.0679
class 0: acc 0.981651376146789, correct 107/109
class 1: acc 0.8421052631578947, correct 80/95
class 2: acc 0.8823529411764706, correct 90/102
class 3: acc 0.983739837398374, correct 121/123
class 4: acc 0.9482758620689655, correct 110/116

Val Set, val_loss: 0.7291, val_error: 0.2000, auc: 0.9288
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.8095238095238095, correct 17/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0021, instance_loss: 0.1191, weighted_loss: 0.0372, label: 4, bag_size: 30
batch 39, loss: 0.2107, instance_loss: 0.3670, weighted_loss: 0.2576, label: 2, bag_size: 1052
batch 59, loss: 0.9629, instance_loss: 0.5666, weighted_loss: 0.8440, label: 2, bag_size: 194
batch 79, loss: 0.4890, instance_loss: 0.3567, weighted_loss: 0.4493, label: 2, bag_size: 806
batch 99, loss: 0.0655, instance_loss: 0.7860, weighted_loss: 0.2817, label: 3, bag_size: 607
batch 119, loss: 0.0385, instance_loss: 0.1894, weighted_loss: 0.0838, label: 0, bag_size: 990
batch 139, loss: 0.5908, instance_loss: 0.6415, weighted_loss: 0.6060, label: 1, bag_size: 1799
batch 159, loss: 0.7305, instance_loss: 0.5761, weighted_loss: 0.6842, label: 2, bag_size: 1677
batch 179, loss: 0.0229, instance_loss: 0.0969, weighted_loss: 0.0451, label: 0, bag_size: 1196
batch 199, loss: 0.2185, instance_loss: 0.4635, weighted_loss: 0.2920, label: 0, bag_size: 423
batch 219, loss: 0.2814, instance_loss: 0.3206, weighted_loss: 0.2932, label: 3, bag_size: 1019
batch 239, loss: 0.6269, instance_loss: 0.3346, weighted_loss: 0.5392, label: 2, bag_size: 828
batch 259, loss: 0.0042, instance_loss: 0.0429, weighted_loss: 0.0158, label: 3, bag_size: 78
batch 279, loss: 0.0243, instance_loss: 0.1850, weighted_loss: 0.0725, label: 0, bag_size: 246
batch 299, loss: 0.0066, instance_loss: 0.0692, weighted_loss: 0.0254, label: 1, bag_size: 1426
batch 319, loss: 0.4768, instance_loss: 0.2654, weighted_loss: 0.4134, label: 0, bag_size: 413
batch 339, loss: 0.0575, instance_loss: 0.5066, weighted_loss: 0.1922, label: 1, bag_size: 1255
batch 359, loss: 0.1003, instance_loss: 0.1631, weighted_loss: 0.1191, label: 4, bag_size: 40
batch 379, loss: 0.2859, instance_loss: 0.3446, weighted_loss: 0.3035, label: 1, bag_size: 1273
batch 399, loss: 0.0011, instance_loss: 0.0356, weighted_loss: 0.0115, label: 0, bag_size: 402
batch 419, loss: 0.0008, instance_loss: 0.1387, weighted_loss: 0.0422, label: 1, bag_size: 1376
batch 439, loss: 0.3216, instance_loss: 0.3499, weighted_loss: 0.3301, label: 1, bag_size: 1559
batch 459, loss: 0.0134, instance_loss: 0.2587, weighted_loss: 0.0870, label: 0, bag_size: 371
batch 479, loss: 0.0204, instance_loss: 0.1926, weighted_loss: 0.0721, label: 2, bag_size: 419
batch 499, loss: 0.0408, instance_loss: 0.1269, weighted_loss: 0.0666, label: 0, bag_size: 413
batch 519, loss: 0.0643, instance_loss: 0.3608, weighted_loss: 0.1532, label: 0, bag_size: 118
batch 539, loss: 0.0003, instance_loss: 0.0511, weighted_loss: 0.0155, label: 3, bag_size: 43


class 0 clustering acc 0.9853211009174312: correct 21480/21800
class 1 clustering acc 0.46215596330275227: correct 2015/4360
Epoch: 30, train_loss: 0.2262, train_clustering_loss:  0.2888, train_error: 0.0734
class 0: acc 0.9576271186440678, correct 113/118
class 1: acc 0.8951612903225806, correct 111/124
class 2: acc 0.8529411764705882, correct 87/102
class 3: acc 0.9545454545454546, correct 105/110
class 4: acc 0.978021978021978, correct 89/91

Val Set, val_loss: 0.6923, val_error: 0.2200, auc: 0.9263
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.37: correct 148/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0055, instance_loss: 0.0717, weighted_loss: 0.0254, label: 0, bag_size: 524
batch 39, loss: 0.0065, instance_loss: 0.0794, weighted_loss: 0.0284, label: 0, bag_size: 382
batch 59, loss: 0.0259, instance_loss: 0.0971, weighted_loss: 0.0473, label: 0, bag_size: 476
batch 79, loss: 0.0355, instance_loss: 0.2308, weighted_loss: 0.0941, label: 3, bag_size: 1118
batch 99, loss: 0.0018, instance_loss: 0.0357, weighted_loss: 0.0120, label: 4, bag_size: 101
batch 119, loss: 0.0048, instance_loss: 0.0724, weighted_loss: 0.0251, label: 0, bag_size: 1135
batch 139, loss: 0.0040, instance_loss: 0.2421, weighted_loss: 0.0755, label: 4, bag_size: 23
batch 159, loss: 0.0084, instance_loss: 0.0633, weighted_loss: 0.0249, label: 0, bag_size: 1872
batch 179, loss: 0.1387, instance_loss: 0.2991, weighted_loss: 0.1868, label: 0, bag_size: 868
batch 199, loss: 0.6232, instance_loss: 0.7012, weighted_loss: 0.6466, label: 3, bag_size: 281
batch 219, loss: 0.0038, instance_loss: 0.0329, weighted_loss: 0.0125, label: 0, bag_size: 921
batch 239, loss: 0.0008, instance_loss: 0.0448, weighted_loss: 0.0140, label: 4, bag_size: 83
batch 259, loss: 0.2745, instance_loss: 0.3629, weighted_loss: 0.3011, label: 3, bag_size: 343
batch 279, loss: 0.0002, instance_loss: 0.0407, weighted_loss: 0.0124, label: 4, bag_size: 174
batch 299, loss: 0.1542, instance_loss: 0.2319, weighted_loss: 0.1775, label: 2, bag_size: 259
batch 319, loss: 0.0288, instance_loss: 0.0888, weighted_loss: 0.0468, label: 1, bag_size: 886
batch 339, loss: 0.0108, instance_loss: 0.0815, weighted_loss: 0.0320, label: 4, bag_size: 162
batch 359, loss: 0.2665, instance_loss: 0.6083, weighted_loss: 0.3690, label: 1, bag_size: 293
batch 379, loss: 0.0224, instance_loss: 0.2729, weighted_loss: 0.0976, label: 1, bag_size: 1255
batch 399, loss: 0.0028, instance_loss: 0.0875, weighted_loss: 0.0282, label: 0, bag_size: 1101
batch 419, loss: 0.0047, instance_loss: 0.0900, weighted_loss: 0.0303, label: 0, bag_size: 410
batch 439, loss: 0.0039, instance_loss: 0.1645, weighted_loss: 0.0521, label: 3, bag_size: 21
batch 459, loss: 0.0149, instance_loss: 0.3007, weighted_loss: 0.1006, label: 4, bag_size: 711
batch 479, loss: 0.0127, instance_loss: 0.3646, weighted_loss: 0.1183, label: 4, bag_size: 24
batch 499, loss: 1.4248, instance_loss: 0.5047, weighted_loss: 1.1488, label: 2, bag_size: 750
batch 519, loss: 1.9813, instance_loss: 0.6610, weighted_loss: 1.5852, label: 3, bag_size: 1380
batch 539, loss: 0.1227, instance_loss: 0.2392, weighted_loss: 0.1577, label: 2, bag_size: 932


class 0 clustering acc 0.9861467889908256: correct 21498/21800
class 1 clustering acc 0.4892201834862385: correct 2133/4360
Epoch: 31, train_loss: 0.2286, train_clustering_loss:  0.2783, train_error: 0.0771
class 0: acc 0.9523809523809523, correct 100/105
class 1: acc 0.905982905982906, correct 106/117
class 2: acc 0.860655737704918, correct 105/122
class 3: acc 0.9705882352941176, correct 99/102
class 4: acc 0.9393939393939394, correct 93/99

Val Set, val_loss: 0.7616, val_error: 0.2200, auc: 0.9244
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.3625: correct 145/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0010, instance_loss: 0.0625, weighted_loss: 0.0195, label: 3, bag_size: 123
batch 39, loss: 0.0033, instance_loss: 0.0859, weighted_loss: 0.0281, label: 0, bag_size: 239
batch 59, loss: 0.0122, instance_loss: 0.1053, weighted_loss: 0.0401, label: 3, bag_size: 28
batch 79, loss: 0.0742, instance_loss: 0.4621, weighted_loss: 0.1906, label: 1, bag_size: 269
batch 99, loss: 0.0795, instance_loss: 0.5564, weighted_loss: 0.2226, label: 3, bag_size: 283
batch 119, loss: 0.0523, instance_loss: 0.1218, weighted_loss: 0.0731, label: 0, bag_size: 990
batch 139, loss: 0.1447, instance_loss: 0.4227, weighted_loss: 0.2281, label: 4, bag_size: 297
batch 159, loss: 0.0459, instance_loss: 0.2060, weighted_loss: 0.0939, label: 0, bag_size: 432
batch 179, loss: 0.6885, instance_loss: 0.6897, weighted_loss: 0.6889, label: 1, bag_size: 308
batch 199, loss: 0.3269, instance_loss: 0.6321, weighted_loss: 0.4185, label: 3, bag_size: 281
batch 219, loss: 0.0006, instance_loss: 0.1840, weighted_loss: 0.0556, label: 3, bag_size: 18
batch 239, loss: 0.1514, instance_loss: 0.2221, weighted_loss: 0.1726, label: 0, bag_size: 542
batch 259, loss: 0.1234, instance_loss: 0.2769, weighted_loss: 0.1695, label: 2, bag_size: 358
batch 279, loss: 0.1198, instance_loss: 0.6238, weighted_loss: 0.2710, label: 4, bag_size: 366
batch 299, loss: 0.0003, instance_loss: 0.0592, weighted_loss: 0.0180, label: 4, bag_size: 211
batch 319, loss: 0.0018, instance_loss: 0.0688, weighted_loss: 0.0219, label: 3, bag_size: 72
batch 339, loss: 0.0031, instance_loss: 0.1917, weighted_loss: 0.0597, label: 4, bag_size: 24
batch 359, loss: 0.0047, instance_loss: 0.1883, weighted_loss: 0.0598, label: 3, bag_size: 16
batch 379, loss: 0.0963, instance_loss: 0.3236, weighted_loss: 0.1645, label: 2, bag_size: 355
batch 399, loss: 0.7147, instance_loss: 0.5764, weighted_loss: 0.6733, label: 4, bag_size: 1337
batch 419, loss: 0.0027, instance_loss: 0.1130, weighted_loss: 0.0358, label: 0, bag_size: 1599
batch 439, loss: 0.0432, instance_loss: 0.1611, weighted_loss: 0.0785, label: 3, bag_size: 34
batch 459, loss: 0.2032, instance_loss: 0.3855, weighted_loss: 0.2579, label: 3, bag_size: 1019
batch 479, loss: 0.0084, instance_loss: 0.1506, weighted_loss: 0.0511, label: 2, bag_size: 419
batch 499, loss: 0.0250, instance_loss: 0.1489, weighted_loss: 0.0622, label: 2, bag_size: 809
batch 519, loss: 0.2064, instance_loss: 0.4160, weighted_loss: 0.2693, label: 0, bag_size: 200
batch 539, loss: 0.3560, instance_loss: 0.6504, weighted_loss: 0.4443, label: 1, bag_size: 917


class 0 clustering acc 0.984954128440367: correct 21472/21800
class 1 clustering acc 0.4745412844036697: correct 2069/4360
Epoch: 32, train_loss: 0.2218, train_clustering_loss:  0.2867, train_error: 0.0661
class 0: acc 0.9795918367346939, correct 96/98
class 1: acc 0.875, correct 98/112
class 2: acc 0.8529411764705882, correct 87/102
class 3: acc 0.9916666666666667, correct 119/120
class 4: acc 0.9646017699115044, correct 109/113

Val Set, val_loss: 0.8155, val_error: 0.3000, auc: 0.9134
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.3475: correct 139/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0025, instance_loss: 0.0940, weighted_loss: 0.0299, label: 0, bag_size: 524
batch 39, loss: 0.3540, instance_loss: 0.3850, weighted_loss: 0.3633, label: 0, bag_size: 424
batch 59, loss: 0.2297, instance_loss: 0.3083, weighted_loss: 0.2533, label: 1, bag_size: 399
batch 79, loss: 0.0501, instance_loss: 0.2780, weighted_loss: 0.1185, label: 1, bag_size: 696
batch 99, loss: 0.0396, instance_loss: 0.1265, weighted_loss: 0.0656, label: 4, bag_size: 38
batch 119, loss: 0.5711, instance_loss: 0.4924, weighted_loss: 0.5475, label: 4, bag_size: 590
batch 139, loss: 0.1683, instance_loss: 0.3150, weighted_loss: 0.2123, label: 1, bag_size: 1144
batch 159, loss: 0.1569, instance_loss: 0.3219, weighted_loss: 0.2064, label: 2, bag_size: 806
batch 179, loss: 0.0069, instance_loss: 0.1391, weighted_loss: 0.0466, label: 0, bag_size: 472
batch 199, loss: 0.0360, instance_loss: 0.1184, weighted_loss: 0.0607, label: 1, bag_size: 834
batch 219, loss: 0.9359, instance_loss: 0.6855, weighted_loss: 0.8608, label: 2, bag_size: 934
batch 239, loss: 0.0221, instance_loss: 0.4268, weighted_loss: 0.1435, label: 1, bag_size: 1049
batch 259, loss: 1.0233, instance_loss: 0.5858, weighted_loss: 0.8920, label: 2, bag_size: 110
batch 279, loss: 2.4195, instance_loss: 0.5508, weighted_loss: 1.8589, label: 1, bag_size: 1376
batch 299, loss: 0.3034, instance_loss: 0.4238, weighted_loss: 0.3395, label: 0, bag_size: 760
batch 319, loss: 0.0005, instance_loss: 0.0577, weighted_loss: 0.0177, label: 4, bag_size: 48
batch 339, loss: 0.5221, instance_loss: 0.4538, weighted_loss: 0.5016, label: 2, bag_size: 1133
batch 359, loss: 0.0004, instance_loss: 0.0329, weighted_loss: 0.0102, label: 4, bag_size: 130
batch 379, loss: 0.0205, instance_loss: 0.4398, weighted_loss: 0.1463, label: 0, bag_size: 116
batch 399, loss: 0.0297, instance_loss: 0.1518, weighted_loss: 0.0663, label: 3, bag_size: 24
batch 419, loss: 0.1168, instance_loss: 0.2461, weighted_loss: 0.1556, label: 0, bag_size: 432
batch 439, loss: 0.0009, instance_loss: 0.0531, weighted_loss: 0.0165, label: 4, bag_size: 107
batch 459, loss: 0.1068, instance_loss: 0.3373, weighted_loss: 0.1760, label: 1, bag_size: 530
batch 479, loss: 0.0005, instance_loss: 0.0309, weighted_loss: 0.0096, label: 3, bag_size: 43
batch 499, loss: 0.0253, instance_loss: 0.2322, weighted_loss: 0.0874, label: 2, bag_size: 1533
batch 519, loss: 0.6911, instance_loss: 0.6453, weighted_loss: 0.6774, label: 2, bag_size: 1178
batch 539, loss: 0.0020, instance_loss: 0.0391, weighted_loss: 0.0131, label: 4, bag_size: 79


class 0 clustering acc 0.9865137614678899: correct 21506/21800
class 1 clustering acc 0.518348623853211: correct 2260/4360
Epoch: 33, train_loss: 0.1376, train_clustering_loss:  0.2616, train_error: 0.0349
class 0: acc 0.9902912621359223, correct 102/103
class 1: acc 0.9423076923076923, correct 98/104
class 2: acc 0.9, correct 90/100
class 3: acc 1.0, correct 120/120
class 4: acc 0.9830508474576272, correct 116/118

Val Set, val_loss: 0.8126, val_error: 0.2200, auc: 0.9256
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.41: correct 164/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0013, instance_loss: 0.0179, weighted_loss: 0.0063, label: 4, bag_size: 114
batch 39, loss: 0.0014, instance_loss: 0.0526, weighted_loss: 0.0167, label: 4, bag_size: 47
batch 59, loss: 0.1778, instance_loss: 0.1130, weighted_loss: 0.1584, label: 1, bag_size: 1127
batch 79, loss: 0.0176, instance_loss: 0.9860, weighted_loss: 0.3081, label: 4, bag_size: 436
batch 99, loss: 0.0061, instance_loss: 0.0484, weighted_loss: 0.0188, label: 1, bag_size: 286
batch 119, loss: 0.7646, instance_loss: 0.6100, weighted_loss: 0.7182, label: 2, bag_size: 110
batch 139, loss: 0.0330, instance_loss: 0.2272, weighted_loss: 0.0913, label: 3, bag_size: 16
batch 159, loss: 0.0003, instance_loss: 0.2763, weighted_loss: 0.0831, label: 4, bag_size: 14
batch 179, loss: 0.2630, instance_loss: 0.4007, weighted_loss: 0.3043, label: 2, bag_size: 272
batch 199, loss: 0.0001, instance_loss: 0.0305, weighted_loss: 0.0092, label: 3, bag_size: 43
batch 219, loss: 0.0011, instance_loss: 0.0716, weighted_loss: 0.0222, label: 4, bag_size: 157
batch 239, loss: 0.0214, instance_loss: 0.1566, weighted_loss: 0.0620, label: 0, bag_size: 255
batch 259, loss: 0.0008, instance_loss: 0.0788, weighted_loss: 0.0242, label: 3, bag_size: 28
batch 279, loss: 0.4237, instance_loss: 0.4067, weighted_loss: 0.4186, label: 1, bag_size: 1273
batch 299, loss: 0.0390, instance_loss: 0.3625, weighted_loss: 0.1361, label: 0, bag_size: 962
batch 319, loss: 0.0060, instance_loss: 0.0718, weighted_loss: 0.0257, label: 0, bag_size: 1196
batch 339, loss: 0.0248, instance_loss: 0.1633, weighted_loss: 0.0663, label: 1, bag_size: 696
batch 359, loss: 0.0061, instance_loss: 0.0569, weighted_loss: 0.0213, label: 0, bag_size: 478
batch 379, loss: 0.1120, instance_loss: 0.2160, weighted_loss: 0.1432, label: 0, bag_size: 542
batch 399, loss: 0.0003, instance_loss: 0.1822, weighted_loss: 0.0548, label: 3, bag_size: 18
batch 419, loss: 0.0337, instance_loss: 0.3231, weighted_loss: 0.1205, label: 2, bag_size: 1416
batch 439, loss: 0.0280, instance_loss: 0.1143, weighted_loss: 0.0539, label: 1, bag_size: 1239
batch 459, loss: 0.1199, instance_loss: 0.6278, weighted_loss: 0.2723, label: 1, bag_size: 860
batch 479, loss: 0.0104, instance_loss: 0.0690, weighted_loss: 0.0280, label: 1, bag_size: 1277
batch 499, loss: 0.0007, instance_loss: 0.1210, weighted_loss: 0.0368, label: 4, bag_size: 88
batch 519, loss: 0.1224, instance_loss: 0.4420, weighted_loss: 0.2183, label: 0, bag_size: 120
batch 539, loss: 0.0012, instance_loss: 0.0463, weighted_loss: 0.0148, label: 3, bag_size: 28


class 0 clustering acc 0.9885779816513761: correct 21551/21800
class 1 clustering acc 0.5353211009174312: correct 2334/4360
Epoch: 34, train_loss: 0.1411, train_clustering_loss:  0.2529, train_error: 0.0440
class 0: acc 0.978021978021978, correct 89/91
class 1: acc 0.9279279279279279, correct 103/111
class 2: acc 0.926605504587156, correct 101/109
class 3: acc 0.984251968503937, correct 125/127
class 4: acc 0.9626168224299065, correct 103/107

Val Set, val_loss: 0.8685, val_error: 0.2800, auc: 0.9168
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.395: correct 158/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1268, instance_loss: 0.3433, weighted_loss: 0.1917, label: 2, bag_size: 278
batch 39, loss: 0.0117, instance_loss: 0.2849, weighted_loss: 0.0937, label: 2, bag_size: 638
batch 59, loss: 0.0007, instance_loss: 0.1600, weighted_loss: 0.0485, label: 3, bag_size: 20
batch 79, loss: 0.0010, instance_loss: 0.1710, weighted_loss: 0.0520, label: 3, bag_size: 50
batch 99, loss: 0.0252, instance_loss: 0.4092, weighted_loss: 0.1404, label: 4, bag_size: 928
batch 119, loss: 0.0024, instance_loss: 0.0771, weighted_loss: 0.0248, label: 4, bag_size: 60
batch 139, loss: 0.3967, instance_loss: 0.3535, weighted_loss: 0.3837, label: 2, bag_size: 986
batch 159, loss: 0.0694, instance_loss: 0.4238, weighted_loss: 0.1757, label: 4, bag_size: 656
batch 179, loss: 0.0101, instance_loss: 0.0789, weighted_loss: 0.0307, label: 0, bag_size: 1517
batch 199, loss: 1.1644, instance_loss: 0.4157, weighted_loss: 0.9398, label: 1, bag_size: 1144
batch 219, loss: 0.0010, instance_loss: 0.0589, weighted_loss: 0.0183, label: 4, bag_size: 211
batch 239, loss: 0.7934, instance_loss: 0.4716, weighted_loss: 0.6969, label: 3, bag_size: 405
batch 259, loss: 0.1652, instance_loss: 0.3243, weighted_loss: 0.2129, label: 1, bag_size: 1273
batch 279, loss: 0.0944, instance_loss: 0.2331, weighted_loss: 0.1360, label: 3, bag_size: 405
batch 299, loss: 0.0866, instance_loss: 0.8464, weighted_loss: 0.3146, label: 4, bag_size: 1331
batch 319, loss: 0.0049, instance_loss: 0.0463, weighted_loss: 0.0173, label: 3, bag_size: 94
batch 339, loss: 0.0020, instance_loss: 0.0565, weighted_loss: 0.0183, label: 0, bag_size: 921
batch 359, loss: 0.0136, instance_loss: 0.3405, weighted_loss: 0.1116, label: 0, bag_size: 129
batch 379, loss: 0.0002, instance_loss: 0.0380, weighted_loss: 0.0115, label: 3, bag_size: 24
batch 399, loss: 0.0693, instance_loss: 0.2112, weighted_loss: 0.1119, label: 2, bag_size: 292
batch 419, loss: 0.0226, instance_loss: 0.4543, weighted_loss: 0.1521, label: 0, bag_size: 118
batch 439, loss: 0.0008, instance_loss: 0.2345, weighted_loss: 0.0709, label: 4, bag_size: 20
batch 459, loss: 0.1241, instance_loss: 0.7531, weighted_loss: 0.3128, label: 3, bag_size: 1380
batch 479, loss: 0.0162, instance_loss: 0.2149, weighted_loss: 0.0758, label: 2, bag_size: 839
batch 499, loss: 0.0358, instance_loss: 0.1761, weighted_loss: 0.0779, label: 0, bag_size: 381
batch 519, loss: 0.1203, instance_loss: 0.5172, weighted_loss: 0.2394, label: 1, bag_size: 860
batch 539, loss: 0.0621, instance_loss: 0.3245, weighted_loss: 0.1408, label: 2, bag_size: 636


class 0 clustering acc 0.9856422018348624: correct 21487/21800
class 1 clustering acc 0.5123853211009174: correct 2234/4360
Epoch: 35, train_loss: 0.1735, train_clustering_loss:  0.2729, train_error: 0.0459
class 0: acc 0.989247311827957, correct 92/93
class 1: acc 0.9421487603305785, correct 114/121
class 2: acc 0.896551724137931, correct 104/116
class 3: acc 0.9611650485436893, correct 99/103
class 4: acc 0.9910714285714286, correct 111/112

Val Set, val_loss: 0.7697, val_error: 0.2600, auc: 0.9170
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.4175: correct 167/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.3150, instance_loss: 0.3068, weighted_loss: 0.3125, label: 2, bag_size: 271
batch 39, loss: 0.0477, instance_loss: 0.2467, weighted_loss: 0.1074, label: 2, bag_size: 589
batch 59, loss: 0.0002, instance_loss: 0.0539, weighted_loss: 0.0163, label: 4, bag_size: 140
batch 79, loss: 0.0846, instance_loss: 0.2197, weighted_loss: 0.1251, label: 2, bag_size: 525
batch 99, loss: 0.1714, instance_loss: 0.3238, weighted_loss: 0.2171, label: 2, bag_size: 271
batch 119, loss: 0.0359, instance_loss: 0.2661, weighted_loss: 0.1049, label: 0, bag_size: 117
batch 139, loss: 0.0833, instance_loss: 0.3233, weighted_loss: 0.1553, label: 2, bag_size: 508
batch 159, loss: 0.0067, instance_loss: 0.2416, weighted_loss: 0.0772, label: 0, bag_size: 120
batch 179, loss: 0.1573, instance_loss: 0.9263, weighted_loss: 0.3880, label: 3, bag_size: 211
batch 199, loss: 0.0050, instance_loss: 0.2006, weighted_loss: 0.0637, label: 4, bag_size: 35
batch 219, loss: 0.1210, instance_loss: 0.2877, weighted_loss: 0.1710, label: 2, bag_size: 525
batch 239, loss: 0.0388, instance_loss: 0.1676, weighted_loss: 0.0774, label: 1, bag_size: 949
batch 259, loss: 0.0096, instance_loss: 0.2034, weighted_loss: 0.0677, label: 0, bag_size: 114
batch 279, loss: 0.0006, instance_loss: 0.0375, weighted_loss: 0.0116, label: 0, bag_size: 385
batch 299, loss: 0.0092, instance_loss: 0.2154, weighted_loss: 0.0711, label: 3, bag_size: 16
batch 319, loss: 0.3662, instance_loss: 0.8381, weighted_loss: 0.5078, label: 4, bag_size: 511
batch 339, loss: 0.0421, instance_loss: 0.2580, weighted_loss: 0.1069, label: 4, bag_size: 773
batch 359, loss: 0.1036, instance_loss: 0.3685, weighted_loss: 0.1831, label: 1, bag_size: 1273
batch 379, loss: 0.0123, instance_loss: 0.2354, weighted_loss: 0.0793, label: 2, bag_size: 626
batch 399, loss: 0.0054, instance_loss: 0.0887, weighted_loss: 0.0304, label: 0, bag_size: 552
batch 419, loss: 0.0040, instance_loss: 0.0561, weighted_loss: 0.0197, label: 3, bag_size: 35
batch 439, loss: 0.0354, instance_loss: 0.2829, weighted_loss: 0.1097, label: 1, bag_size: 746
batch 459, loss: 0.1665, instance_loss: 0.3564, weighted_loss: 0.2234, label: 1, bag_size: 1559
batch 479, loss: 0.0496, instance_loss: 0.1073, weighted_loss: 0.0669, label: 2, bag_size: 455
batch 499, loss: 0.1916, instance_loss: 0.3837, weighted_loss: 0.2492, label: 2, bag_size: 194
batch 519, loss: 0.0008, instance_loss: 0.0817, weighted_loss: 0.0250, label: 0, bag_size: 616
batch 539, loss: 0.0142, instance_loss: 0.3033, weighted_loss: 0.1009, label: 2, bag_size: 411


class 0 clustering acc 0.984954128440367: correct 21472/21800
class 1 clustering acc 0.5240825688073395: correct 2285/4360
Epoch: 36, train_loss: 0.1275, train_clustering_loss:  0.2637, train_error: 0.0312
class 0: acc 1.0, correct 97/97
class 1: acc 0.9292035398230089, correct 105/113
class 2: acc 0.9380530973451328, correct 106/113
class 3: acc 0.9914529914529915, correct 116/117
class 4: acc 0.9904761904761905, correct 104/105

Val Set, val_loss: 0.9389, val_error: 0.2800, auc: 0.9179
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.4: correct 160/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0002, instance_loss: 0.0186, weighted_loss: 0.0057, label: 3, bag_size: 56
batch 39, loss: 0.0003, instance_loss: 0.0517, weighted_loss: 0.0157, label: 4, bag_size: 130
batch 59, loss: 0.2895, instance_loss: 0.6105, weighted_loss: 0.3858, label: 2, bag_size: 1178
batch 79, loss: 0.1589, instance_loss: 0.1520, weighted_loss: 0.1568, label: 1, bag_size: 1127
batch 99, loss: 0.0752, instance_loss: 0.1996, weighted_loss: 0.1125, label: 3, bag_size: 706
batch 119, loss: 0.0068, instance_loss: 0.1261, weighted_loss: 0.0426, label: 0, bag_size: 466
batch 139, loss: 0.0895, instance_loss: 0.5824, weighted_loss: 0.2374, label: 1, bag_size: 860
batch 159, loss: 0.3357, instance_loss: 0.3740, weighted_loss: 0.3472, label: 1, bag_size: 348
batch 179, loss: 0.1011, instance_loss: 0.5452, weighted_loss: 0.2343, label: 2, bag_size: 1378
batch 199, loss: 0.0029, instance_loss: 0.0854, weighted_loss: 0.0276, label: 4, bag_size: 211
batch 219, loss: 0.0002, instance_loss: 0.0801, weighted_loss: 0.0242, label: 4, bag_size: 182
batch 239, loss: 0.0458, instance_loss: 0.3007, weighted_loss: 0.1223, label: 2, bag_size: 508
batch 259, loss: 0.0563, instance_loss: 0.2141, weighted_loss: 0.1037, label: 2, bag_size: 684
batch 279, loss: 0.1263, instance_loss: 0.2283, weighted_loss: 0.1569, label: 1, bag_size: 869
batch 299, loss: 0.0196, instance_loss: 0.2157, weighted_loss: 0.0784, label: 1, bag_size: 754
batch 319, loss: 0.0423, instance_loss: 0.1229, weighted_loss: 0.0665, label: 0, bag_size: 630
batch 339, loss: 0.0382, instance_loss: 0.2087, weighted_loss: 0.0894, label: 2, bag_size: 324
batch 359, loss: 0.0306, instance_loss: 0.1538, weighted_loss: 0.0676, label: 2, bag_size: 1289
batch 379, loss: 0.1358, instance_loss: 0.5037, weighted_loss: 0.2462, label: 2, bag_size: 1050
batch 399, loss: 0.0250, instance_loss: 0.2003, weighted_loss: 0.0776, label: 2, bag_size: 400
batch 419, loss: 0.1401, instance_loss: 0.5162, weighted_loss: 0.2529, label: 2, bag_size: 1139
batch 439, loss: 0.0116, instance_loss: 0.2899, weighted_loss: 0.0951, label: 0, bag_size: 736
batch 459, loss: 0.0276, instance_loss: 0.1915, weighted_loss: 0.0768, label: 2, bag_size: 358
batch 479, loss: 0.0234, instance_loss: 0.1733, weighted_loss: 0.0684, label: 0, bag_size: 760
batch 499, loss: 0.0097, instance_loss: 0.1040, weighted_loss: 0.0380, label: 0, bag_size: 1190
batch 519, loss: 0.0007, instance_loss: 0.0937, weighted_loss: 0.0286, label: 3, bag_size: 18
batch 539, loss: 0.0409, instance_loss: 0.2582, weighted_loss: 0.1061, label: 4, bag_size: 636


class 0 clustering acc 0.9844036697247707: correct 21460/21800
class 1 clustering acc 0.5376146788990825: correct 2344/4360
Epoch: 37, train_loss: 0.1284, train_clustering_loss:  0.2707, train_error: 0.0349
class 0: acc 0.9896907216494846, correct 96/97
class 1: acc 0.944954128440367, correct 103/109
class 2: acc 0.9056603773584906, correct 96/106
class 3: acc 0.991304347826087, correct 114/115
class 4: acc 0.9915254237288136, correct 117/118

Val Set, val_loss: 0.8734, val_error: 0.2600, auc: 0.9170
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.36: correct 144/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0012, instance_loss: 0.0704, weighted_loss: 0.0220, label: 4, bag_size: 47
batch 39, loss: 0.0007, instance_loss: 0.2326, weighted_loss: 0.0703, label: 3, bag_size: 18
batch 59, loss: 0.0954, instance_loss: 0.2728, weighted_loss: 0.1486, label: 1, bag_size: 1144
batch 79, loss: 0.2541, instance_loss: 0.6272, weighted_loss: 0.3660, label: 3, bag_size: 230
batch 99, loss: 0.0189, instance_loss: 0.8216, weighted_loss: 0.2597, label: 4, bag_size: 1360
batch 119, loss: 0.0468, instance_loss: 0.3479, weighted_loss: 0.1371, label: 3, bag_size: 1118
batch 139, loss: 0.0539, instance_loss: 0.2111, weighted_loss: 0.1011, label: 0, bag_size: 1065
batch 159, loss: 0.0003, instance_loss: 0.0349, weighted_loss: 0.0106, label: 4, bag_size: 63
batch 179, loss: 0.1747, instance_loss: 0.3342, weighted_loss: 0.2225, label: 2, bag_size: 911
batch 199, loss: 0.1756, instance_loss: 0.2604, weighted_loss: 0.2010, label: 0, bag_size: 912
batch 219, loss: 0.1095, instance_loss: 0.6170, weighted_loss: 0.2618, label: 3, bag_size: 607
batch 239, loss: 0.0334, instance_loss: 0.2962, weighted_loss: 0.1123, label: 3, bag_size: 841
batch 259, loss: 0.0003, instance_loss: 0.0152, weighted_loss: 0.0048, label: 4, bag_size: 157
batch 279, loss: 0.0011, instance_loss: 0.1201, weighted_loss: 0.0368, label: 4, bag_size: 47
batch 299, loss: 0.0061, instance_loss: 0.1780, weighted_loss: 0.0576, label: 2, bag_size: 1218
batch 319, loss: 0.0403, instance_loss: 0.1742, weighted_loss: 0.0805, label: 2, bag_size: 404
batch 339, loss: 0.0065, instance_loss: 0.1246, weighted_loss: 0.0419, label: 3, bag_size: 23
batch 359, loss: 0.0124, instance_loss: 0.2300, weighted_loss: 0.0777, label: 0, bag_size: 255
batch 379, loss: 0.2292, instance_loss: 0.2559, weighted_loss: 0.2372, label: 2, bag_size: 312
batch 399, loss: 0.0006, instance_loss: 0.0862, weighted_loss: 0.0263, label: 4, bag_size: 24
batch 419, loss: 0.1180, instance_loss: 0.7807, weighted_loss: 0.3168, label: 3, bag_size: 211
batch 439, loss: 0.0571, instance_loss: 0.2722, weighted_loss: 0.1216, label: 2, bag_size: 730
batch 459, loss: 0.8453, instance_loss: 0.6980, weighted_loss: 0.8011, label: 4, bag_size: 1337
batch 479, loss: 0.0084, instance_loss: 0.1369, weighted_loss: 0.0470, label: 3, bag_size: 28
batch 499, loss: 0.0041, instance_loss: 0.0598, weighted_loss: 0.0208, label: 1, bag_size: 1277
batch 519, loss: 0.0302, instance_loss: 0.4051, weighted_loss: 0.1427, label: 0, bag_size: 1289
batch 539, loss: 0.4566, instance_loss: 0.7603, weighted_loss: 0.5477, label: 1, bag_size: 1799


class 0 clustering acc 0.9856422018348624: correct 21487/21800
class 1 clustering acc 0.5591743119266055: correct 2438/4360
Epoch: 38, train_loss: 0.1313, train_clustering_loss:  0.2511, train_error: 0.0349
class 0: acc 0.981651376146789, correct 107/109
class 1: acc 0.963302752293578, correct 105/109
class 2: acc 0.9074074074074074, correct 98/108
class 3: acc 0.9826086956521739, correct 113/115
class 4: acc 0.9903846153846154, correct 103/104

Val Set, val_loss: 0.8204, val_error: 0.2800, auc: 0.9222
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.405: correct 162/400
class 0: acc 0.5, correct 3/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0020, instance_loss: 0.0301, weighted_loss: 0.0104, label: 3, bag_size: 48
batch 39, loss: 0.0091, instance_loss: 0.7686, weighted_loss: 0.2369, label: 1, bag_size: 700
batch 59, loss: 0.0068, instance_loss: 0.1803, weighted_loss: 0.0589, label: 0, bag_size: 116
batch 79, loss: 0.0828, instance_loss: 0.2910, weighted_loss: 0.1452, label: 3, bag_size: 343
batch 99, loss: 0.0183, instance_loss: 0.1624, weighted_loss: 0.0615, label: 2, bag_size: 461
batch 119, loss: 2.4424, instance_loss: 0.9449, weighted_loss: 1.9931, label: 2, bag_size: 655
batch 139, loss: 0.0582, instance_loss: 0.4517, weighted_loss: 0.1763, label: 1, bag_size: 1096
batch 159, loss: 0.8000, instance_loss: 0.6315, weighted_loss: 0.7494, label: 2, bag_size: 629
batch 179, loss: 0.0533, instance_loss: 0.1998, weighted_loss: 0.0972, label: 1, bag_size: 746
batch 199, loss: 0.0106, instance_loss: 0.1280, weighted_loss: 0.0458, label: 2, bag_size: 636
batch 219, loss: 0.0102, instance_loss: 0.1303, weighted_loss: 0.0462, label: 0, bag_size: 375
batch 239, loss: 0.0250, instance_loss: 0.2819, weighted_loss: 0.1021, label: 4, bag_size: 1002
batch 259, loss: 0.0001, instance_loss: 0.0882, weighted_loss: 0.0265, label: 1, bag_size: 834
batch 279, loss: 0.0119, instance_loss: 0.1083, weighted_loss: 0.0408, label: 3, bag_size: 18
batch 299, loss: 0.0934, instance_loss: 0.3946, weighted_loss: 0.1838, label: 3, bag_size: 1253
batch 319, loss: 0.0111, instance_loss: 0.2630, weighted_loss: 0.0867, label: 4, bag_size: 773
batch 339, loss: 0.0031, instance_loss: 0.0545, weighted_loss: 0.0185, label: 1, bag_size: 1261
batch 359, loss: 0.9706, instance_loss: 0.2498, weighted_loss: 0.7543, label: 2, bag_size: 935
batch 379, loss: 0.0410, instance_loss: 0.7345, weighted_loss: 0.2490, label: 3, bag_size: 211
batch 399, loss: 0.0002, instance_loss: 0.0893, weighted_loss: 0.0269, label: 3, bag_size: 33
batch 419, loss: 0.0083, instance_loss: 0.1115, weighted_loss: 0.0393, label: 0, bag_size: 607
batch 439, loss: 0.0064, instance_loss: 0.0889, weighted_loss: 0.0311, label: 0, bag_size: 340
batch 459, loss: 2.3217, instance_loss: 0.8817, weighted_loss: 1.8897, label: 2, bag_size: 629
batch 479, loss: 0.0142, instance_loss: 0.2415, weighted_loss: 0.0824, label: 0, bag_size: 136
batch 499, loss: 0.0014, instance_loss: 0.1244, weighted_loss: 0.0383, label: 0, bag_size: 246
batch 519, loss: 0.1108, instance_loss: 0.4091, weighted_loss: 0.2003, label: 0, bag_size: 1065
batch 539, loss: 0.1507, instance_loss: 0.3254, weighted_loss: 0.2031, label: 2, bag_size: 265


class 0 clustering acc 0.9849082568807339: correct 21471/21800
class 1 clustering acc 0.5199541284403669: correct 2267/4360
Epoch: 39, train_loss: 0.1815, train_clustering_loss:  0.2734, train_error: 0.0477
class 0: acc 0.9747899159663865, correct 116/119
class 1: acc 0.9159663865546218, correct 109/119
class 2: acc 0.9090909090909091, correct 100/110
class 3: acc 0.9895833333333334, correct 95/96
class 4: acc 0.9801980198019802, correct 99/101

Val Set, val_loss: 1.0347, val_error: 0.3000, auc: 0.9081
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.3975: correct 159/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0360, instance_loss: 0.3516, weighted_loss: 0.1307, label: 0, bag_size: 118
batch 39, loss: 0.0016, instance_loss: 0.0573, weighted_loss: 0.0183, label: 4, bag_size: 79
batch 59, loss: 0.0150, instance_loss: 0.2599, weighted_loss: 0.0884, label: 0, bag_size: 110
batch 79, loss: 1.2913, instance_loss: 0.7503, weighted_loss: 1.1290, label: 1, bag_size: 1144
batch 99, loss: 0.1569, instance_loss: 0.2269, weighted_loss: 0.1779, label: 2, bag_size: 589
batch 119, loss: 0.0001, instance_loss: 0.0581, weighted_loss: 0.0175, label: 3, bag_size: 31
batch 139, loss: 0.0114, instance_loss: 0.1002, weighted_loss: 0.0380, label: 0, bag_size: 375
batch 159, loss: 0.0574, instance_loss: 0.7729, weighted_loss: 0.2720, label: 3, bag_size: 211
batch 179, loss: 0.0010, instance_loss: 0.1027, weighted_loss: 0.0315, label: 0, bag_size: 1599
batch 199, loss: 0.0472, instance_loss: 0.1199, weighted_loss: 0.0690, label: 4, bag_size: 86
batch 219, loss: 0.0410, instance_loss: 0.1748, weighted_loss: 0.0811, label: 2, bag_size: 907
batch 239, loss: 0.0023, instance_loss: 0.0454, weighted_loss: 0.0152, label: 0, bag_size: 1599
batch 259, loss: 0.0004, instance_loss: 0.0787, weighted_loss: 0.0239, label: 3, bag_size: 105
batch 279, loss: 0.0666, instance_loss: 0.6103, weighted_loss: 0.2297, label: 4, bag_size: 366
batch 299, loss: 0.0718, instance_loss: 0.9496, weighted_loss: 0.3351, label: 3, bag_size: 607
batch 319, loss: 0.0290, instance_loss: 0.1255, weighted_loss: 0.0579, label: 0, bag_size: 1086
batch 339, loss: 0.2081, instance_loss: 0.2231, weighted_loss: 0.2126, label: 2, bag_size: 806
batch 359, loss: 0.0020, instance_loss: 0.0548, weighted_loss: 0.0179, label: 3, bag_size: 32
batch 379, loss: 0.0170, instance_loss: 0.2294, weighted_loss: 0.0807, label: 0, bag_size: 432
batch 399, loss: 0.0009, instance_loss: 0.0179, weighted_loss: 0.0060, label: 3, bag_size: 41
batch 419, loss: 0.0000, instance_loss: 0.0340, weighted_loss: 0.0102, label: 3, bag_size: 143
batch 439, loss: 0.0217, instance_loss: 0.0591, weighted_loss: 0.0329, label: 4, bag_size: 55
batch 459, loss: 0.5208, instance_loss: 0.5600, weighted_loss: 0.5325, label: 2, bag_size: 1178
batch 479, loss: 0.2535, instance_loss: 0.3657, weighted_loss: 0.2872, label: 1, bag_size: 913
batch 499, loss: 0.0007, instance_loss: 0.0317, weighted_loss: 0.0100, label: 4, bag_size: 83
batch 519, loss: 0.0474, instance_loss: 0.1806, weighted_loss: 0.0874, label: 2, bag_size: 868
batch 539, loss: 1.4230, instance_loss: 0.6738, weighted_loss: 1.1982, label: 2, bag_size: 1400


class 0 clustering acc 0.9856880733944954: correct 21488/21800
class 1 clustering acc 0.5506880733944954: correct 2401/4360
Epoch: 40, train_loss: 0.1019, train_clustering_loss:  0.2575, train_error: 0.0312
class 0: acc 0.9905660377358491, correct 105/106
class 1: acc 0.9042553191489362, correct 85/94
class 2: acc 0.9401709401709402, correct 110/117
class 3: acc 1.0, correct 110/110
class 4: acc 1.0, correct 118/118

Val Set, val_loss: 0.9963, val_error: 0.2800, auc: 0.9098
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.395: correct 158/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 20 out of 20


batch 19, loss: 5.6314, instance_loss: 0.5340, weighted_loss: 4.1022, label: 2, bag_size: 1133
batch 39, loss: 0.0029, instance_loss: 0.0342, weighted_loss: 0.0123, label: 0, bag_size: 1301
batch 59, loss: 0.0003, instance_loss: 0.0219, weighted_loss: 0.0068, label: 3, bag_size: 115
batch 79, loss: 0.0264, instance_loss: 0.4407, weighted_loss: 0.1507, label: 1, bag_size: 648
batch 99, loss: 0.0141, instance_loss: 0.3379, weighted_loss: 0.1112, label: 4, bag_size: 20
batch 119, loss: 0.0108, instance_loss: 0.0730, weighted_loss: 0.0295, label: 4, bag_size: 211
batch 139, loss: 0.0334, instance_loss: 0.5586, weighted_loss: 0.1909, label: 1, bag_size: 269
batch 159, loss: 0.0018, instance_loss: 0.1125, weighted_loss: 0.0350, label: 0, bag_size: 1143
batch 179, loss: 0.0841, instance_loss: 0.6620, weighted_loss: 0.2575, label: 2, bag_size: 916
batch 199, loss: 0.0026, instance_loss: 0.0306, weighted_loss: 0.0110, label: 4, bag_size: 88
batch 219, loss: 0.9357, instance_loss: 0.4027, weighted_loss: 0.7758, label: 1, bag_size: 348
batch 239, loss: 0.0017, instance_loss: 0.0306, weighted_loss: 0.0103, label: 3, bag_size: 41
batch 259, loss: 0.0084, instance_loss: 0.0735, weighted_loss: 0.0279, label: 1, bag_size: 1426
batch 279, loss: 0.0002, instance_loss: 0.0644, weighted_loss: 0.0194, label: 3, bag_size: 21
batch 299, loss: 0.0023, instance_loss: 0.0297, weighted_loss: 0.0105, label: 4, bag_size: 137
batch 319, loss: 0.0524, instance_loss: 0.1874, weighted_loss: 0.0929, label: 2, bag_size: 1306
batch 339, loss: 0.0033, instance_loss: 0.2075, weighted_loss: 0.0646, label: 0, bag_size: 1332
batch 359, loss: 0.0028, instance_loss: 0.4207, weighted_loss: 0.1281, label: 1, bag_size: 786
batch 379, loss: 0.0068, instance_loss: 0.3770, weighted_loss: 0.1179, label: 2, bag_size: 655
batch 399, loss: 0.1806, instance_loss: 0.0414, weighted_loss: 0.1389, label: 3, bag_size: 97
batch 419, loss: 0.0298, instance_loss: 0.5303, weighted_loss: 0.1800, label: 1, bag_size: 786
batch 439, loss: 0.4291, instance_loss: 0.4892, weighted_loss: 0.4471, label: 1, bag_size: 1724
batch 459, loss: 0.0114, instance_loss: 0.0965, weighted_loss: 0.0369, label: 1, bag_size: 356
batch 479, loss: 0.0010, instance_loss: 0.0464, weighted_loss: 0.0146, label: 4, bag_size: 78
batch 499, loss: 0.0003, instance_loss: 0.0128, weighted_loss: 0.0040, label: 3, bag_size: 56
batch 519, loss: 0.0190, instance_loss: 0.2766, weighted_loss: 0.0963, label: 2, bag_size: 795
batch 539, loss: 0.1186, instance_loss: 0.5557, weighted_loss: 0.2497, label: 1, bag_size: 293


class 0 clustering acc 0.9843577981651376: correct 21459/21800
class 1 clustering acc 0.5105504587155963: correct 2226/4360
Epoch: 41, train_loss: 0.1575, train_clustering_loss:  0.2747, train_error: 0.0550
class 0: acc 0.9789473684210527, correct 93/95
class 1: acc 0.9166666666666666, correct 121/132
class 2: acc 0.865979381443299, correct 84/97
class 3: acc 0.9836065573770492, correct 120/122
class 4: acc 0.9797979797979798, correct 97/99

Val Set, val_loss: 1.0697, val_error: 0.3000, auc: 0.8917
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.3875: correct 155/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.75, correct 3/4
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0072, instance_loss: 0.1392, weighted_loss: 0.0468, label: 3, bag_size: 18
batch 39, loss: 0.0129, instance_loss: 0.1491, weighted_loss: 0.0538, label: 0, bag_size: 255
batch 59, loss: 0.3038, instance_loss: 0.3771, weighted_loss: 0.3258, label: 2, bag_size: 986
batch 79, loss: 0.0095, instance_loss: 0.1807, weighted_loss: 0.0608, label: 2, bag_size: 848
batch 99, loss: 0.0027, instance_loss: 0.3451, weighted_loss: 0.1054, label: 4, bag_size: 524
batch 119, loss: 0.0932, instance_loss: 0.0717, weighted_loss: 0.0867, label: 3, bag_size: 1559
batch 139, loss: 0.0128, instance_loss: 0.2956, weighted_loss: 0.0976, label: 3, bag_size: 936
batch 159, loss: 0.0241, instance_loss: 0.5565, weighted_loss: 0.1838, label: 0, bag_size: 1301
batch 179, loss: 0.1544, instance_loss: 0.4891, weighted_loss: 0.2548, label: 1, bag_size: 651
batch 199, loss: 0.0043, instance_loss: 0.1863, weighted_loss: 0.0589, label: 0, bag_size: 545
batch 219, loss: 0.8977, instance_loss: 0.3663, weighted_loss: 0.7383, label: 1, bag_size: 377
batch 239, loss: 0.0370, instance_loss: 0.2280, weighted_loss: 0.0943, label: 0, bag_size: 432
batch 259, loss: 0.0104, instance_loss: 0.1242, weighted_loss: 0.0445, label: 0, bag_size: 371
batch 279, loss: 0.0960, instance_loss: 0.5381, weighted_loss: 0.2286, label: 1, bag_size: 651
batch 299, loss: 0.1092, instance_loss: 0.3503, weighted_loss: 0.1815, label: 2, bag_size: 732
batch 319, loss: 0.0008, instance_loss: 0.1860, weighted_loss: 0.0564, label: 3, bag_size: 16
batch 339, loss: 0.0946, instance_loss: 0.3013, weighted_loss: 0.1566, label: 0, bag_size: 868
batch 359, loss: 0.0697, instance_loss: 0.4444, weighted_loss: 0.1821, label: 3, bag_size: 630
batch 379, loss: 0.0061, instance_loss: 0.0805, weighted_loss: 0.0284, label: 1, bag_size: 682
batch 399, loss: 0.0030, instance_loss: 0.3320, weighted_loss: 0.1017, label: 4, bag_size: 388
batch 419, loss: 2.3302, instance_loss: 0.5517, weighted_loss: 1.7966, label: 0, bag_size: 423
batch 439, loss: 0.0010, instance_loss: 0.1353, weighted_loss: 0.0413, label: 0, bag_size: 382
batch 459, loss: 0.0157, instance_loss: 0.6817, weighted_loss: 0.2155, label: 0, bag_size: 155
batch 479, loss: 0.0001, instance_loss: 0.0387, weighted_loss: 0.0117, label: 3, bag_size: 143
batch 499, loss: 0.0277, instance_loss: 0.3452, weighted_loss: 0.1230, label: 4, bag_size: 1235
batch 519, loss: 0.1562, instance_loss: 0.4305, weighted_loss: 0.2385, label: 0, bag_size: 163
batch 539, loss: 0.1522, instance_loss: 0.2237, weighted_loss: 0.1737, label: 0, bag_size: 437


class 0 clustering acc 0.9849082568807339: correct 21471/21800
class 1 clustering acc 0.5444954128440367: correct 2374/4360
Epoch: 42, train_loss: 0.1156, train_clustering_loss:  0.2671, train_error: 0.0294
class 0: acc 0.9801980198019802, correct 99/101
class 1: acc 0.9655172413793104, correct 112/116
class 2: acc 0.93, correct 93/100
class 3: acc 0.9916666666666667, correct 119/120
class 4: acc 0.9814814814814815, correct 106/108

Val Set, val_loss: 1.0019, val_error: 0.2600, auc: 0.9123
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.4225: correct 169/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0023, instance_loss: 0.0797, weighted_loss: 0.0255, label: 0, bag_size: 478
batch 39, loss: 0.0154, instance_loss: 0.2852, weighted_loss: 0.0963, label: 2, bag_size: 878
batch 59, loss: 0.0950, instance_loss: 0.4679, weighted_loss: 0.2069, label: 0, bag_size: 432
batch 79, loss: 0.0029, instance_loss: 0.1731, weighted_loss: 0.0540, label: 4, bag_size: 1121
batch 99, loss: 0.3353, instance_loss: 0.3346, weighted_loss: 0.3351, label: 2, bag_size: 1148
batch 119, loss: 0.0512, instance_loss: 0.3906, weighted_loss: 0.1530, label: 3, bag_size: 1250
batch 139, loss: 0.0050, instance_loss: 0.2519, weighted_loss: 0.0790, label: 4, bag_size: 20
batch 159, loss: 0.0342, instance_loss: 0.1425, weighted_loss: 0.0666, label: 1, bag_size: 598
batch 179, loss: 0.0057, instance_loss: 0.1125, weighted_loss: 0.0378, label: 0, bag_size: 255
batch 199, loss: 0.3261, instance_loss: 0.5538, weighted_loss: 0.3944, label: 2, bag_size: 1133
batch 219, loss: 0.0055, instance_loss: 0.0565, weighted_loss: 0.0208, label: 0, bag_size: 1517
batch 239, loss: 0.0091, instance_loss: 0.3359, weighted_loss: 0.1072, label: 1, bag_size: 818
batch 259, loss: 0.0015, instance_loss: 0.4350, weighted_loss: 0.1315, label: 0, bag_size: 122
batch 279, loss: 0.0335, instance_loss: 0.3750, weighted_loss: 0.1360, label: 4, bag_size: 524
batch 299, loss: 0.5167, instance_loss: 0.6273, weighted_loss: 0.5499, label: 2, bag_size: 878
batch 319, loss: 0.0002, instance_loss: 0.0483, weighted_loss: 0.0147, label: 0, bag_size: 239
batch 339, loss: 0.0030, instance_loss: 0.2222, weighted_loss: 0.0687, label: 0, bag_size: 117
batch 359, loss: 0.0030, instance_loss: 0.1416, weighted_loss: 0.0446, label: 0, bag_size: 466
batch 379, loss: 0.0001, instance_loss: 0.0852, weighted_loss: 0.0256, label: 3, bag_size: 50
batch 399, loss: 0.0665, instance_loss: 0.2838, weighted_loss: 0.1317, label: 0, bag_size: 800
batch 419, loss: 0.0082, instance_loss: 0.0935, weighted_loss: 0.0338, label: 1, bag_size: 1277
batch 439, loss: 0.9658, instance_loss: 0.4386, weighted_loss: 0.8076, label: 2, bag_size: 1006
batch 459, loss: 0.1396, instance_loss: 0.8126, weighted_loss: 0.3415, label: 1, bag_size: 660
batch 479, loss: 0.0400, instance_loss: 0.2123, weighted_loss: 0.0917, label: 1, bag_size: 754
batch 499, loss: 0.0068, instance_loss: 0.3742, weighted_loss: 0.1170, label: 1, bag_size: 867
batch 519, loss: 0.0008, instance_loss: 0.1118, weighted_loss: 0.0341, label: 3, bag_size: 21
batch 539, loss: 0.0424, instance_loss: 0.2339, weighted_loss: 0.0999, label: 4, bag_size: 38


class 0 clustering acc 0.9851834862385321: correct 21477/21800
class 1 clustering acc 0.5167431192660551: correct 2253/4360
Epoch: 43, train_loss: 0.1246, train_clustering_loss:  0.2712, train_error: 0.0385
class 0: acc 0.9504950495049505, correct 96/101
class 1: acc 0.9391304347826087, correct 108/115
class 2: acc 0.93, correct 93/100
class 3: acc 1.0, correct 99/99
class 4: acc 0.9846153846153847, correct 128/130

Val Set, val_loss: 0.9939, val_error: 0.2400, auc: 0.8955
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.445: correct 178/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0064, instance_loss: 0.0671, weighted_loss: 0.0246, label: 3, bag_size: 29
batch 39, loss: 0.0029, instance_loss: 0.0620, weighted_loss: 0.0207, label: 3, bag_size: 28
batch 59, loss: 0.0005, instance_loss: 0.0240, weighted_loss: 0.0076, label: 4, bag_size: 148
batch 79, loss: 0.0002, instance_loss: 0.1212, weighted_loss: 0.0365, label: 4, bag_size: 143
batch 99, loss: 0.0689, instance_loss: 0.2126, weighted_loss: 0.1120, label: 1, bag_size: 867
batch 119, loss: 0.0010, instance_loss: 0.0472, weighted_loss: 0.0149, label: 3, bag_size: 41
batch 139, loss: 0.6929, instance_loss: 0.5057, weighted_loss: 0.6367, label: 2, bag_size: 1653
batch 159, loss: 0.1498, instance_loss: 0.5484, weighted_loss: 0.2694, label: 2, bag_size: 471
batch 179, loss: 0.2199, instance_loss: 0.4095, weighted_loss: 0.2768, label: 1, bag_size: 1724
batch 199, loss: 0.2668, instance_loss: 0.3431, weighted_loss: 0.2897, label: 2, bag_size: 278
batch 219, loss: 0.0232, instance_loss: 0.2345, weighted_loss: 0.0866, label: 0, bag_size: 1133
batch 239, loss: 0.0376, instance_loss: 0.2393, weighted_loss: 0.0981, label: 2, bag_size: 1139
batch 259, loss: 0.0011, instance_loss: 0.0394, weighted_loss: 0.0126, label: 4, bag_size: 211
batch 279, loss: 0.0004, instance_loss: 0.0491, weighted_loss: 0.0150, label: 0, bag_size: 1599
batch 299, loss: 0.0027, instance_loss: 0.0957, weighted_loss: 0.0306, label: 1, bag_size: 1261
batch 319, loss: 0.2614, instance_loss: 0.2878, weighted_loss: 0.2693, label: 0, bag_size: 424
batch 339, loss: 0.0029, instance_loss: 0.2513, weighted_loss: 0.0774, label: 2, bag_size: 1200
batch 359, loss: 0.0005, instance_loss: 0.0598, weighted_loss: 0.0183, label: 3, bag_size: 37
batch 379, loss: 0.8045, instance_loss: 0.5670, weighted_loss: 0.7333, label: 4, bag_size: 754
batch 399, loss: 0.0074, instance_loss: 0.2999, weighted_loss: 0.0951, label: 0, bag_size: 1133
batch 419, loss: 0.0000, instance_loss: 0.0214, weighted_loss: 0.0064, label: 4, bag_size: 185
batch 439, loss: 0.0016, instance_loss: 0.0756, weighted_loss: 0.0238, label: 3, bag_size: 21
batch 459, loss: 0.0198, instance_loss: 0.2613, weighted_loss: 0.0922, label: 2, bag_size: 405
batch 479, loss: 0.3259, instance_loss: 0.3959, weighted_loss: 0.3469, label: 0, bag_size: 868
batch 499, loss: 0.1405, instance_loss: 0.2112, weighted_loss: 0.1617, label: 1, bag_size: 405
batch 519, loss: 0.0125, instance_loss: 0.2159, weighted_loss: 0.0735, label: 1, bag_size: 1402
batch 539, loss: 0.0225, instance_loss: 0.0984, weighted_loss: 0.0452, label: 1, bag_size: 886


class 0 clustering acc 0.9858256880733945: correct 21491/21800
class 1 clustering acc 0.531651376146789: correct 2318/4360
Epoch: 44, train_loss: 0.1137, train_clustering_loss:  0.2627, train_error: 0.0385
class 0: acc 0.9888888888888889, correct 89/90
class 1: acc 0.9391304347826087, correct 108/115
class 2: acc 0.9130434782608695, correct 105/115
class 3: acc 1.0, correct 126/126
class 4: acc 0.9696969696969697, correct 96/99

Val Set, val_loss: 1.0228, val_error: 0.2800, auc: 0.9095
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.425: correct 170/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0550, instance_loss: 0.0532, weighted_loss: 0.0545, label: 3, bag_size: 1172
batch 39, loss: 0.0033, instance_loss: 0.0855, weighted_loss: 0.0279, label: 0, bag_size: 518
batch 59, loss: 0.0093, instance_loss: 0.2764, weighted_loss: 0.0894, label: 1, bag_size: 533
batch 79, loss: 0.0122, instance_loss: 0.3190, weighted_loss: 0.1043, label: 0, bag_size: 155
batch 99, loss: 0.0153, instance_loss: 0.3183, weighted_loss: 0.1062, label: 3, bag_size: 200
batch 119, loss: 0.0000, instance_loss: 0.0804, weighted_loss: 0.0241, label: 4, bag_size: 125
batch 139, loss: 0.0274, instance_loss: 0.3381, weighted_loss: 0.1206, label: 4, bag_size: 974
batch 159, loss: 0.0739, instance_loss: 0.3004, weighted_loss: 0.1418, label: 2, bag_size: 222
batch 179, loss: 0.0843, instance_loss: 0.2953, weighted_loss: 0.1476, label: 2, bag_size: 1006
batch 199, loss: 0.0832, instance_loss: 0.6534, weighted_loss: 0.2543, label: 1, bag_size: 917
batch 219, loss: 0.6498, instance_loss: 0.6807, weighted_loss: 0.6591, label: 1, bag_size: 936
batch 239, loss: 0.0283, instance_loss: 0.3791, weighted_loss: 0.1336, label: 4, bag_size: 656
batch 259, loss: 0.0000, instance_loss: 0.1634, weighted_loss: 0.0490, label: 3, bag_size: 18
batch 279, loss: 0.0020, instance_loss: 0.0282, weighted_loss: 0.0098, label: 4, bag_size: 160
batch 299, loss: 0.0001, instance_loss: 0.1045, weighted_loss: 0.0315, label: 3, bag_size: 33
batch 319, loss: 0.0017, instance_loss: 0.1064, weighted_loss: 0.0331, label: 4, bag_size: 39
batch 339, loss: 0.0307, instance_loss: 0.3559, weighted_loss: 0.1283, label: 2, bag_size: 1677
batch 359, loss: 0.1700, instance_loss: 0.3664, weighted_loss: 0.2289, label: 2, bag_size: 1259
batch 379, loss: 0.0146, instance_loss: 0.0837, weighted_loss: 0.0353, label: 0, bag_size: 1247
batch 399, loss: 0.0014, instance_loss: 0.0886, weighted_loss: 0.0275, label: 0, bag_size: 1135
batch 419, loss: 0.6903, instance_loss: 0.7053, weighted_loss: 0.6948, label: 1, bag_size: 448
batch 439, loss: 0.0037, instance_loss: 0.4280, weighted_loss: 0.1310, label: 2, bag_size: 655
batch 459, loss: 0.0123, instance_loss: 0.0937, weighted_loss: 0.0368, label: 1, bag_size: 1277
batch 479, loss: 0.0001, instance_loss: 0.0332, weighted_loss: 0.0100, label: 3, bag_size: 105
batch 499, loss: 0.0004, instance_loss: 0.4984, weighted_loss: 0.1498, label: 3, bag_size: 841
batch 519, loss: 0.2276, instance_loss: 0.3549, weighted_loss: 0.2658, label: 0, bag_size: 718
batch 539, loss: 0.0081, instance_loss: 0.0756, weighted_loss: 0.0283, label: 3, bag_size: 66


class 0 clustering acc 0.9861926605504587: correct 21499/21800
class 1 clustering acc 0.5653669724770642: correct 2465/4360
Epoch: 45, train_loss: 0.0764, train_clustering_loss:  0.2489, train_error: 0.0202
class 0: acc 0.9818181818181818, correct 108/110
class 1: acc 0.9690721649484536, correct 94/97
class 2: acc 0.9397590361445783, correct 78/83
class 3: acc 1.0, correct 123/123
class 4: acc 0.9924242424242424, correct 131/132

Val Set, val_loss: 1.0764, val_error: 0.2800, auc: 0.9097
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.375: correct 150/400
class 0: acc 1.0, correct 6/6
class 1: acc 0.8125, correct 13/16
class 2: acc 0.5714285714285714, correct 12/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0688, instance_loss: 0.2622, weighted_loss: 0.1268, label: 2, bag_size: 259
batch 39, loss: 0.0174, instance_loss: 0.1293, weighted_loss: 0.0510, label: 1, bag_size: 399
batch 59, loss: 0.0181, instance_loss: 0.2571, weighted_loss: 0.0898, label: 2, bag_size: 1306
batch 79, loss: 0.0002, instance_loss: 0.2900, weighted_loss: 0.0872, label: 4, bag_size: 14
batch 99, loss: 0.0003, instance_loss: 0.0198, weighted_loss: 0.0061, label: 4, bag_size: 114
batch 119, loss: 0.0724, instance_loss: 0.2172, weighted_loss: 0.1158, label: 2, bag_size: 264
batch 139, loss: 0.0321, instance_loss: 0.5415, weighted_loss: 0.1849, label: 4, bag_size: 663
batch 159, loss: 0.0170, instance_loss: 0.3709, weighted_loss: 0.1231, label: 0, bag_size: 1289
batch 179, loss: 0.0636, instance_loss: 0.2834, weighted_loss: 0.1296, label: 0, bag_size: 718
batch 199, loss: 0.0078, instance_loss: 0.0509, weighted_loss: 0.0207, label: 4, bag_size: 39
batch 219, loss: 0.0148, instance_loss: 0.3743, weighted_loss: 0.1226, label: 0, bag_size: 120
batch 239, loss: 0.0020, instance_loss: 0.1065, weighted_loss: 0.0333, label: 1, bag_size: 1239
batch 259, loss: 0.0143, instance_loss: 0.2602, weighted_loss: 0.0881, label: 4, bag_size: 1121
batch 279, loss: 0.0028, instance_loss: 0.1310, weighted_loss: 0.0412, label: 0, bag_size: 1517
batch 299, loss: 0.0006, instance_loss: 0.2317, weighted_loss: 0.0700, label: 0, bag_size: 114
batch 319, loss: 0.0733, instance_loss: 0.1061, weighted_loss: 0.0831, label: 0, bag_size: 1018
batch 339, loss: 0.0552, instance_loss: 0.2467, weighted_loss: 0.1126, label: 0, bag_size: 868
batch 359, loss: 0.0051, instance_loss: 0.0906, weighted_loss: 0.0308, label: 3, bag_size: 18
batch 379, loss: 0.0711, instance_loss: 0.4134, weighted_loss: 0.1738, label: 0, bag_size: 129
batch 399, loss: 0.0378, instance_loss: 0.2495, weighted_loss: 0.1013, label: 2, bag_size: 525
batch 419, loss: 0.0051, instance_loss: 0.1811, weighted_loss: 0.0579, label: 2, bag_size: 1050
batch 439, loss: 0.0154, instance_loss: 0.3739, weighted_loss: 0.1230, label: 0, bag_size: 155
batch 459, loss: 0.0245, instance_loss: 0.1676, weighted_loss: 0.0674, label: 0, bag_size: 602
batch 479, loss: 0.0928, instance_loss: 0.5578, weighted_loss: 0.2323, label: 1, bag_size: 293
batch 499, loss: 0.0038, instance_loss: 0.0467, weighted_loss: 0.0166, label: 4, bag_size: 157
batch 519, loss: 0.0459, instance_loss: 0.8695, weighted_loss: 0.2930, label: 4, bag_size: 436
batch 539, loss: 0.0073, instance_loss: 0.3204, weighted_loss: 0.1013, label: 0, bag_size: 117


class 0 clustering acc 0.9840366972477064: correct 21452/21800
class 1 clustering acc 0.5155963302752293: correct 2248/4360
Epoch: 46, train_loss: 0.1077, train_clustering_loss:  0.2757, train_error: 0.0294
class 0: acc 0.9622641509433962, correct 102/106
class 1: acc 0.9745762711864406, correct 115/118
class 2: acc 0.940677966101695, correct 111/118
class 3: acc 0.9896907216494846, correct 96/97
class 4: acc 0.9905660377358491, correct 105/106

Val Set, val_loss: 1.0022, val_error: 0.2600, auc: 0.8995
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.4175: correct 167/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.9929, instance_loss: 0.6738, weighted_loss: 0.8972, label: 2, bag_size: 911
batch 39, loss: 0.3421, instance_loss: 0.5923, weighted_loss: 0.4171, label: 0, bag_size: 245
batch 59, loss: 0.1627, instance_loss: 0.6838, weighted_loss: 0.3190, label: 2, bag_size: 916
batch 79, loss: 0.0034, instance_loss: 0.0381, weighted_loss: 0.0138, label: 3, bag_size: 305
batch 99, loss: 0.0017, instance_loss: 0.2687, weighted_loss: 0.0818, label: 2, bag_size: 248
batch 119, loss: 0.0359, instance_loss: 0.2516, weighted_loss: 0.1006, label: 2, bag_size: 499
batch 139, loss: 0.0032, instance_loss: 0.1120, weighted_loss: 0.0358, label: 0, bag_size: 990
batch 159, loss: 0.0059, instance_loss: 0.2736, weighted_loss: 0.0862, label: 4, bag_size: 388
batch 179, loss: 0.0013, instance_loss: 0.4916, weighted_loss: 0.1484, label: 4, bag_size: 823
batch 199, loss: 0.0409, instance_loss: 0.2902, weighted_loss: 0.1157, label: 2, bag_size: 1235
batch 219, loss: 0.0031, instance_loss: 0.3451, weighted_loss: 0.1057, label: 0, bag_size: 371
batch 239, loss: 0.5215, instance_loss: 0.5075, weighted_loss: 0.5173, label: 1, bag_size: 747
batch 259, loss: 0.0002, instance_loss: 0.0734, weighted_loss: 0.0222, label: 3, bag_size: 18
batch 279, loss: 0.0021, instance_loss: 0.2034, weighted_loss: 0.0625, label: 0, bag_size: 990
batch 299, loss: 0.0006, instance_loss: 0.0362, weighted_loss: 0.0113, label: 4, bag_size: 123
batch 319, loss: 0.0122, instance_loss: 0.1835, weighted_loss: 0.0636, label: 1, bag_size: 697
batch 339, loss: 0.5790, instance_loss: 0.6377, weighted_loss: 0.5966, label: 3, bag_size: 630
batch 359, loss: 0.0109, instance_loss: 0.1676, weighted_loss: 0.0579, label: 2, bag_size: 400
batch 379, loss: 0.0917, instance_loss: 0.2404, weighted_loss: 0.1363, label: 0, bag_size: 381
batch 399, loss: 0.0613, instance_loss: 0.2947, weighted_loss: 0.1313, label: 1, bag_size: 959
batch 419, loss: 0.0120, instance_loss: 0.1217, weighted_loss: 0.0449, label: 3, bag_size: 20
batch 439, loss: 0.0018, instance_loss: 0.2102, weighted_loss: 0.0643, label: 2, bag_size: 400
batch 459, loss: 0.0007, instance_loss: 0.0258, weighted_loss: 0.0082, label: 0, bag_size: 518
batch 479, loss: 0.0047, instance_loss: 0.1963, weighted_loss: 0.0621, label: 2, bag_size: 848
batch 499, loss: 0.0072, instance_loss: 0.1085, weighted_loss: 0.0376, label: 1, bag_size: 682
batch 519, loss: 0.0162, instance_loss: 0.5252, weighted_loss: 0.1689, label: 1, bag_size: 1144
batch 539, loss: 0.1668, instance_loss: 0.3540, weighted_loss: 0.2230, label: 3, bag_size: 791


class 0 clustering acc 0.9855045871559633: correct 21484/21800
class 1 clustering acc 0.5394495412844037: correct 2352/4360
Epoch: 47, train_loss: 0.1031, train_clustering_loss:  0.2617, train_error: 0.0349
class 0: acc 0.9846153846153847, correct 128/130
class 1: acc 0.94, correct 94/100
class 2: acc 0.9090909090909091, correct 90/99
class 3: acc 1.0, correct 108/108
class 4: acc 0.9814814814814815, correct 106/108

Val Set, val_loss: 1.0516, val_error: 0.2400, auc: 0.9037
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.38: correct 152/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0088, instance_loss: 0.0397, weighted_loss: 0.0181, label: 3, bag_size: 1172
batch 39, loss: 0.3968, instance_loss: 0.4322, weighted_loss: 0.4074, label: 2, bag_size: 1617
batch 59, loss: 0.0010, instance_loss: 0.0644, weighted_loss: 0.0201, label: 3, bag_size: 16
batch 79, loss: 0.1113, instance_loss: 0.5091, weighted_loss: 0.2306, label: 0, bag_size: 118
batch 99, loss: 0.0293, instance_loss: 0.1502, weighted_loss: 0.0655, label: 2, bag_size: 1281
batch 119, loss: 0.0049, instance_loss: 0.2345, weighted_loss: 0.0738, label: 0, bag_size: 1086
batch 139, loss: 0.0425, instance_loss: 0.2426, weighted_loss: 0.1026, label: 2, bag_size: 347
batch 159, loss: 0.0010, instance_loss: 0.0688, weighted_loss: 0.0213, label: 4, bag_size: 91
batch 179, loss: 1.4367, instance_loss: 0.2312, weighted_loss: 1.0751, label: 2, bag_size: 1019
batch 199, loss: 0.0005, instance_loss: 0.1067, weighted_loss: 0.0324, label: 0, bag_size: 1133
batch 219, loss: 0.0029, instance_loss: 0.1681, weighted_loss: 0.0524, label: 0, bag_size: 545
batch 239, loss: 0.0004, instance_loss: 0.0690, weighted_loss: 0.0210, label: 4, bag_size: 20
batch 259, loss: 0.0021, instance_loss: 0.0487, weighted_loss: 0.0161, label: 4, bag_size: 148
batch 279, loss: 0.0477, instance_loss: 0.1433, weighted_loss: 0.0764, label: 1, bag_size: 1325
batch 299, loss: 0.0001, instance_loss: 0.5445, weighted_loss: 0.1634, label: 4, bag_size: 823
batch 319, loss: 0.0053, instance_loss: 0.2523, weighted_loss: 0.0794, label: 2, bag_size: 1677
batch 339, loss: 0.0024, instance_loss: 0.0616, weighted_loss: 0.0202, label: 0, bag_size: 552
batch 359, loss: 0.0112, instance_loss: 0.2650, weighted_loss: 0.0874, label: 1, bag_size: 898
batch 379, loss: 0.0204, instance_loss: 0.2296, weighted_loss: 0.0832, label: 2, bag_size: 264
batch 399, loss: 0.0027, instance_loss: 0.0672, weighted_loss: 0.0220, label: 0, bag_size: 1301
batch 419, loss: 2.5408, instance_loss: 0.4782, weighted_loss: 1.9220, label: 4, bag_size: 773
batch 439, loss: 0.0018, instance_loss: 0.0894, weighted_loss: 0.0281, label: 0, bag_size: 478
batch 459, loss: 0.0167, instance_loss: 0.4563, weighted_loss: 0.1486, label: 0, bag_size: 759
batch 479, loss: 0.0674, instance_loss: 0.1682, weighted_loss: 0.0976, label: 2, bag_size: 913
batch 499, loss: 0.6581, instance_loss: 0.4815, weighted_loss: 0.6051, label: 4, bag_size: 590
batch 519, loss: 0.0216, instance_loss: 0.3848, weighted_loss: 0.1306, label: 2, bag_size: 355
batch 539, loss: 0.0941, instance_loss: 0.1727, weighted_loss: 0.1177, label: 3, bag_size: 1177


class 0 clustering acc 0.9864678899082568: correct 21505/21800
class 1 clustering acc 0.5577981651376147: correct 2432/4360
Epoch: 48, train_loss: 0.1281, train_clustering_loss:  0.2518, train_error: 0.0385
class 0: acc 0.979381443298969, correct 95/97
class 1: acc 0.9292035398230089, correct 105/113
class 2: acc 0.9349593495934959, correct 115/123
class 3: acc 0.98, correct 98/100
class 4: acc 0.9910714285714286, correct 111/112

Val Set, val_loss: 1.1244, val_error: 0.2800, auc: 0.9047
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.395: correct 158/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7142857142857143, correct 15/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0023, instance_loss: 0.0876, weighted_loss: 0.0279, label: 0, bag_size: 1466
batch 39, loss: 0.0000, instance_loss: 0.0399, weighted_loss: 0.0120, label: 4, bag_size: 143
batch 59, loss: 0.0008, instance_loss: 0.0255, weighted_loss: 0.0082, label: 4, bag_size: 192
batch 79, loss: 0.1644, instance_loss: 0.1591, weighted_loss: 0.1628, label: 1, bag_size: 1325
batch 99, loss: 0.0001, instance_loss: 0.0692, weighted_loss: 0.0208, label: 4, bag_size: 182
batch 119, loss: 0.0031, instance_loss: 0.0893, weighted_loss: 0.0290, label: 3, bag_size: 23
batch 139, loss: 0.0859, instance_loss: 0.3508, weighted_loss: 0.1653, label: 0, bag_size: 245
batch 159, loss: 0.0018, instance_loss: 0.0338, weighted_loss: 0.0114, label: 3, bag_size: 37
batch 179, loss: 0.0010, instance_loss: 0.0268, weighted_loss: 0.0088, label: 4, bag_size: 86
batch 199, loss: 0.0002, instance_loss: 0.1110, weighted_loss: 0.0334, label: 4, bag_size: 130
batch 219, loss: 0.0003, instance_loss: 0.0255, weighted_loss: 0.0079, label: 4, bag_size: 83
batch 239, loss: 0.0117, instance_loss: 0.1146, weighted_loss: 0.0426, label: 3, bag_size: 1172
batch 259, loss: 0.0496, instance_loss: 0.5269, weighted_loss: 0.1928, label: 3, bag_size: 1250
batch 279, loss: 0.0943, instance_loss: 0.2200, weighted_loss: 0.1320, label: 1, bag_size: 405
batch 299, loss: 0.0041, instance_loss: 0.1910, weighted_loss: 0.0601, label: 3, bag_size: 21
batch 319, loss: 0.0283, instance_loss: 0.3420, weighted_loss: 0.1224, label: 3, bag_size: 791
batch 339, loss: 0.0051, instance_loss: 0.2190, weighted_loss: 0.0692, label: 1, bag_size: 754
batch 359, loss: 0.0076, instance_loss: 0.5250, weighted_loss: 0.1628, label: 4, bag_size: 675
batch 379, loss: 0.0015, instance_loss: 0.0476, weighted_loss: 0.0153, label: 0, bag_size: 446
batch 399, loss: 0.0073, instance_loss: 0.3433, weighted_loss: 0.1081, label: 2, bag_size: 411
batch 419, loss: 0.0001, instance_loss: 0.1480, weighted_loss: 0.0445, label: 3, bag_size: 26
batch 439, loss: 0.0007, instance_loss: 0.0323, weighted_loss: 0.0102, label: 4, bag_size: 211
batch 459, loss: 0.0006, instance_loss: 0.2490, weighted_loss: 0.0751, label: 4, bag_size: 24
batch 479, loss: 0.0045, instance_loss: 0.1643, weighted_loss: 0.0525, label: 0, bag_size: 990
batch 499, loss: 0.0003, instance_loss: 0.0385, weighted_loss: 0.0117, label: 3, bag_size: 20
batch 519, loss: 0.0498, instance_loss: 0.6082, weighted_loss: 0.2173, label: 3, bag_size: 317
batch 539, loss: 0.0092, instance_loss: 0.1985, weighted_loss: 0.0660, label: 2, bag_size: 499


class 0 clustering acc 0.9858715596330275: correct 21492/21800
class 1 clustering acc 0.5334862385321101: correct 2326/4360
Epoch: 49, train_loss: 0.0735, train_clustering_loss:  0.2619, train_error: 0.0165
class 0: acc 0.9770114942528736, correct 85/87
class 1: acc 0.9915254237288136, correct 117/118
class 2: acc 0.9545454545454546, correct 105/110
class 3: acc 0.990909090909091, correct 109/110
class 4: acc 1.0, correct 120/120

Val Set, val_loss: 1.1520, val_error: 0.3000, auc: 0.9028
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.41: correct 164/400
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0026, instance_loss: 0.0453, weighted_loss: 0.0154, label: 3, bag_size: 305
batch 39, loss: 0.0009, instance_loss: 0.1837, weighted_loss: 0.0557, label: 1, bag_size: 504
batch 59, loss: 0.0117, instance_loss: 0.2733, weighted_loss: 0.0902, label: 4, bag_size: 388
batch 79, loss: 0.0001, instance_loss: 0.0810, weighted_loss: 0.0243, label: 4, bag_size: 148
batch 99, loss: 0.0029, instance_loss: 0.0928, weighted_loss: 0.0299, label: 3, bag_size: 20
batch 119, loss: 0.0825, instance_loss: 0.5481, weighted_loss: 0.2222, label: 4, bag_size: 826
batch 139, loss: 0.0488, instance_loss: 0.2833, weighted_loss: 0.1192, label: 2, bag_size: 356
batch 159, loss: 0.0485, instance_loss: 0.4254, weighted_loss: 0.1616, label: 4, bag_size: 817
batch 179, loss: 0.0034, instance_loss: 0.0962, weighted_loss: 0.0313, label: 4, bag_size: 79
batch 199, loss: 0.0270, instance_loss: 0.2794, weighted_loss: 0.1027, label: 2, bag_size: 636
batch 219, loss: 0.0001, instance_loss: 0.0468, weighted_loss: 0.0141, label: 4, bag_size: 160
batch 239, loss: 0.0014, instance_loss: 0.0372, weighted_loss: 0.0121, label: 3, bag_size: 34
batch 259, loss: 0.0027, instance_loss: 0.0931, weighted_loss: 0.0298, label: 0, bag_size: 478
batch 279, loss: 0.3653, instance_loss: 0.4932, weighted_loss: 0.4037, label: 0, bag_size: 1065
batch 299, loss: 0.0191, instance_loss: 0.1191, weighted_loss: 0.0491, label: 1, bag_size: 828
batch 319, loss: 0.0064, instance_loss: 0.1392, weighted_loss: 0.0462, label: 2, bag_size: 1289
batch 339, loss: 0.0089, instance_loss: 0.4866, weighted_loss: 0.1522, label: 1, bag_size: 470
batch 359, loss: 0.0019, instance_loss: 0.0475, weighted_loss: 0.0156, label: 3, bag_size: 72
batch 379, loss: 0.0917, instance_loss: 0.6806, weighted_loss: 0.2684, label: 3, bag_size: 1380
batch 399, loss: 0.0012, instance_loss: 0.0667, weighted_loss: 0.0208, label: 3, bag_size: 55
batch 419, loss: 0.0010, instance_loss: 0.0745, weighted_loss: 0.0230, label: 0, bag_size: 1101
batch 439, loss: 0.1341, instance_loss: 0.4517, weighted_loss: 0.2294, label: 0, bag_size: 245
batch 459, loss: 0.0024, instance_loss: 0.0645, weighted_loss: 0.0210, label: 0, bag_size: 518
batch 479, loss: 0.0001, instance_loss: 0.1703, weighted_loss: 0.0512, label: 4, bag_size: 185
batch 499, loss: 0.0894, instance_loss: 0.3099, weighted_loss: 0.1555, label: 2, bag_size: 272
batch 519, loss: 0.1731, instance_loss: 0.2954, weighted_loss: 0.2098, label: 0, bag_size: 868
batch 539, loss: 0.2443, instance_loss: 0.3804, weighted_loss: 0.2851, label: 2, bag_size: 943


class 0 clustering acc 0.9845412844036697: correct 21463/21800
class 1 clustering acc 0.5591743119266055: correct 2438/4360
Epoch: 50, train_loss: 0.1024, train_clustering_loss:  0.2587, train_error: 0.0294
class 0: acc 1.0, correct 125/125
class 1: acc 0.9607843137254902, correct 98/102
class 2: acc 0.9313725490196079, correct 95/102
class 3: acc 0.9821428571428571, correct 110/112
class 4: acc 0.9711538461538461, correct 101/104

Val Set, val_loss: 1.1794, val_error: 0.2800, auc: 0.9003
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.375: correct 150/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.6666666666666666, correct 14/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0127, instance_loss: 0.1430, weighted_loss: 0.0518, label: 1, bag_size: 944
batch 39, loss: 0.0069, instance_loss: 0.2182, weighted_loss: 0.0703, label: 0, bag_size: 176
batch 59, loss: 0.0186, instance_loss: 0.5443, weighted_loss: 0.1763, label: 4, bag_size: 974
batch 79, loss: 0.0000, instance_loss: 0.1643, weighted_loss: 0.0493, label: 3, bag_size: 18
batch 99, loss: 0.0195, instance_loss: 0.2491, weighted_loss: 0.0884, label: 0, bag_size: 962
batch 119, loss: 0.0020, instance_loss: 0.2186, weighted_loss: 0.0670, label: 4, bag_size: 1235
batch 139, loss: 0.0702, instance_loss: 0.2249, weighted_loss: 0.1166, label: 4, bag_size: 297
batch 159, loss: 0.0000, instance_loss: 0.0731, weighted_loss: 0.0219, label: 4, bag_size: 134
batch 179, loss: 0.5995, instance_loss: 0.2290, weighted_loss: 0.4884, label: 2, bag_size: 500
batch 199, loss: 0.0381, instance_loss: 0.2627, weighted_loss: 0.1055, label: 2, bag_size: 878
batch 219, loss: 0.0221, instance_loss: 0.6457, weighted_loss: 0.2092, label: 1, bag_size: 875
batch 239, loss: 0.0081, instance_loss: 0.3732, weighted_loss: 0.1177, label: 2, bag_size: 204
batch 259, loss: 0.0030, instance_loss: 0.1289, weighted_loss: 0.0408, label: 0, bag_size: 255
batch 279, loss: 0.0513, instance_loss: 0.2296, weighted_loss: 0.1048, label: 0, bag_size: 424
batch 299, loss: 0.0086, instance_loss: 0.3661, weighted_loss: 0.1159, label: 3, bag_size: 706
batch 319, loss: 0.0470, instance_loss: 0.2748, weighted_loss: 0.1153, label: 1, bag_size: 470
batch 339, loss: 0.0495, instance_loss: 0.2126, weighted_loss: 0.0984, label: 3, bag_size: 1291
batch 359, loss: 0.0000, instance_loss: 0.0166, weighted_loss: 0.0050, label: 0, bag_size: 239
batch 379, loss: 0.0009, instance_loss: 0.3580, weighted_loss: 0.1080, label: 4, bag_size: 790
batch 399, loss: 0.0099, instance_loss: 0.0957, weighted_loss: 0.0357, label: 1, bag_size: 828
batch 419, loss: 0.0104, instance_loss: 0.1705, weighted_loss: 0.0584, label: 2, bag_size: 324
batch 439, loss: 0.0137, instance_loss: 0.2967, weighted_loss: 0.0986, label: 2, bag_size: 795
batch 459, loss: 0.0011, instance_loss: 0.3350, weighted_loss: 0.1012, label: 2, bag_size: 204
batch 479, loss: 0.0002, instance_loss: 0.0505, weighted_loss: 0.0153, label: 3, bag_size: 27
batch 499, loss: 0.0075, instance_loss: 0.2074, weighted_loss: 0.0675, label: 4, bag_size: 40
batch 519, loss: 0.0017, instance_loss: 0.1376, weighted_loss: 0.0425, label: 3, bag_size: 24
batch 539, loss: 0.0001, instance_loss: 0.0147, weighted_loss: 0.0045, label: 0, bag_size: 402


class 0 clustering acc 0.9855045871559633: correct 21484/21800
class 1 clustering acc 0.5506880733944954: correct 2401/4360
Epoch: 51, train_loss: 0.0804, train_clustering_loss:  0.2535, train_error: 0.0202
class 0: acc 0.9906542056074766, correct 106/107
class 1: acc 0.9844961240310077, correct 127/129
class 2: acc 0.9207920792079208, correct 93/101
class 3: acc 1.0, correct 110/110
class 4: acc 1.0, correct 98/98

Val Set, val_loss: 1.1702, val_error: 0.2400, auc: 0.8982
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.39: correct 156/400
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.75, correct 12/16
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 1.0, correct 4/4
EarlyStopping counter: 31 out of 20
Early stopping
Val error: 0.2200, ROC AUC: 0.9341
Test error: 0.3800, ROC AUC: 0.8071
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.5, correct 2/4
class 4: acc 0.3333333333333333, correct 1/3

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.5784, instance_loss: 1.2209, weighted_loss: 1.4711, label: 1, bag_size: 660
batch 39, loss: 1.4410, instance_loss: 1.0553, weighted_loss: 1.3253, label: 3, bag_size: 48
batch 59, loss: 1.3485, instance_loss: 0.8698, weighted_loss: 1.2049, label: 3, bag_size: 46
batch 79, loss: 1.7071, instance_loss: 0.7824, weighted_loss: 1.4297, label: 4, bag_size: 210
batch 99, loss: 1.4126, instance_loss: 0.6615, weighted_loss: 1.1872, label: 0, bag_size: 1301
batch 119, loss: 1.3563, instance_loss: 0.5398, weighted_loss: 1.1113, label: 3, bag_size: 48
batch 139, loss: 2.0162, instance_loss: 0.5503, weighted_loss: 1.5765, label: 2, bag_size: 120
batch 159, loss: 1.2740, instance_loss: 0.4979, weighted_loss: 1.0412, label: 4, bag_size: 17
batch 179, loss: 1.1430, instance_loss: 0.4917, weighted_loss: 0.9476, label: 4, bag_size: 148
batch 199, loss: 1.6285, instance_loss: 0.5000, weighted_loss: 1.2899, label: 4, bag_size: 542
batch 219, loss: 1.3402, instance_loss: 0.5198, weighted_loss: 1.0940, label: 1, bag_size: 534
batch 239, loss: 1.3032, instance_loss: 0.5150, weighted_loss: 1.0668, label: 1, bag_size: 838
batch 259, loss: 1.6100, instance_loss: 0.5058, weighted_loss: 1.2787, label: 3, bag_size: 1253
batch 279, loss: 1.9797, instance_loss: 0.5617, weighted_loss: 1.5543, label: 0, bag_size: 148
batch 299, loss: 1.4276, instance_loss: 0.5212, weighted_loss: 1.1557, label: 1, bag_size: 648
batch 319, loss: 1.5211, instance_loss: 0.4757, weighted_loss: 1.2075, label: 4, bag_size: 210
batch 339, loss: 1.5225, instance_loss: 0.5554, weighted_loss: 1.2324, label: 2, bag_size: 1348
batch 359, loss: 1.4041, instance_loss: 0.5337, weighted_loss: 1.1430, label: 2, bag_size: 500
batch 379, loss: 1.3422, instance_loss: 0.5068, weighted_loss: 1.0916, label: 2, bag_size: 286
batch 399, loss: 1.8770, instance_loss: 0.5156, weighted_loss: 1.4686, label: 4, bag_size: 625
batch 419, loss: 1.7314, instance_loss: 0.5575, weighted_loss: 1.3792, label: 2, bag_size: 323
batch 439, loss: 1.5256, instance_loss: 0.5185, weighted_loss: 1.2234, label: 1, bag_size: 945
batch 459, loss: 1.4546, instance_loss: 0.5235, weighted_loss: 1.1753, label: 2, bag_size: 1289
batch 479, loss: 1.2427, instance_loss: 0.4871, weighted_loss: 1.0160, label: 3, bag_size: 18
batch 499, loss: 1.5757, instance_loss: 0.5347, weighted_loss: 1.2634, label: 0, bag_size: 545
batch 519, loss: 0.5673, instance_loss: 0.4173, weighted_loss: 0.5223, label: 4, bag_size: 23
batch 539, loss: 1.3586, instance_loss: 0.4814, weighted_loss: 1.0954, label: 2, bag_size: 571


class 0 clustering acc 0.9926605504587156: correct 21640/21800
class 1 clustering acc 0.008256880733944955: correct 36/4360
Epoch: 0, train_loss: 1.4633, train_clustering_loss:  0.5984, train_error: 0.6183
class 0: acc 0.3113207547169811, correct 33/106
class 1: acc 0.3944954128440367, correct 43/109
class 2: acc 0.08602150537634409, correct 8/93
class 3: acc 0.4642857142857143, correct 52/112
class 4: acc 0.576, correct 72/125

Val Set, val_loss: 1.4018, val_error: 0.6800, auc: 0.7057
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/8
class 1: acc 1.0, correct 13/13
class 2: acc 0.05263157894736842, correct 1/19
class 3: acc 0.125, correct 1/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (inf --> 1.401838).  Saving model ...


batch 19, loss: 1.3396, instance_loss: 0.4964, weighted_loss: 1.0866, label: 2, bag_size: 499
batch 39, loss: 1.9548, instance_loss: 0.5247, weighted_loss: 1.5258, label: 3, bag_size: 630
batch 59, loss: 1.2507, instance_loss: 0.4999, weighted_loss: 1.0255, label: 1, bag_size: 1144
batch 79, loss: 0.9916, instance_loss: 0.4829, weighted_loss: 0.8390, label: 3, bag_size: 18
batch 99, loss: 1.3584, instance_loss: 0.5029, weighted_loss: 1.1018, label: 0, bag_size: 921
batch 119, loss: 1.4050, instance_loss: 0.5045, weighted_loss: 1.1349, label: 2, bag_size: 766
batch 139, loss: 1.9705, instance_loss: 0.5474, weighted_loss: 1.5436, label: 2, bag_size: 1108
batch 159, loss: 1.4118, instance_loss: 0.5010, weighted_loss: 1.1385, label: 2, bag_size: 262
batch 179, loss: 0.7320, instance_loss: 0.4168, weighted_loss: 0.6374, label: 3, bag_size: 53
batch 199, loss: 0.6966, instance_loss: 0.4358, weighted_loss: 0.6184, label: 3, bag_size: 20
batch 219, loss: 1.9880, instance_loss: 0.4893, weighted_loss: 1.5384, label: 3, bag_size: 1253
batch 239, loss: 0.4328, instance_loss: 0.3822, weighted_loss: 0.4176, label: 3, bag_size: 26
batch 259, loss: 1.2114, instance_loss: 0.3893, weighted_loss: 0.9648, label: 3, bag_size: 936
batch 279, loss: 1.3389, instance_loss: 0.4886, weighted_loss: 1.0838, label: 1, bag_size: 1172
batch 299, loss: 1.3026, instance_loss: 0.4686, weighted_loss: 1.0524, label: 2, bag_size: 948
batch 319, loss: 1.4793, instance_loss: 0.5049, weighted_loss: 1.1870, label: 0, bag_size: 760
batch 339, loss: 1.1529, instance_loss: 0.4809, weighted_loss: 0.9513, label: 0, bag_size: 933
batch 359, loss: 1.5302, instance_loss: 0.4766, weighted_loss: 1.2141, label: 1, bag_size: 448
batch 379, loss: 0.8588, instance_loss: 0.4681, weighted_loss: 0.7416, label: 3, bag_size: 35
batch 399, loss: 1.2931, instance_loss: 0.5612, weighted_loss: 1.0736, label: 2, bag_size: 1404
batch 419, loss: 0.2748, instance_loss: 0.1847, weighted_loss: 0.2478, label: 4, bag_size: 86
batch 439, loss: 1.2221, instance_loss: 0.4554, weighted_loss: 0.9921, label: 0, bag_size: 518
batch 459, loss: 1.1972, instance_loss: 0.4553, weighted_loss: 0.9746, label: 0, bag_size: 437
batch 479, loss: 1.1244, instance_loss: 0.4370, weighted_loss: 0.9182, label: 1, bag_size: 770
batch 499, loss: 2.1749, instance_loss: 0.5867, weighted_loss: 1.6985, label: 3, bag_size: 283
batch 519, loss: 1.7756, instance_loss: 0.5545, weighted_loss: 1.4093, label: 4, bag_size: 636
batch 539, loss: 0.7963, instance_loss: 0.3912, weighted_loss: 0.6748, label: 1, bag_size: 534


class 0 clustering acc 0.9988073394495413: correct 21774/21800
class 1 clustering acc 0.01834862385321101: correct 80/4360
Epoch: 1, train_loss: 1.2193, train_clustering_loss:  0.4636, train_error: 0.4606
class 0: acc 0.3853211009174312, correct 42/109
class 1: acc 0.6576576576576577, correct 73/111
class 2: acc 0.20430107526881722, correct 19/93
class 3: acc 0.7, correct 84/120
class 4: acc 0.6785714285714286, correct 76/112

Val Set, val_loss: 1.3538, val_error: 0.6400, auc: 0.7518
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.375, correct 3/8
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.0, correct 0/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (1.401838 --> 1.353769).  Saving model ...


batch 19, loss: 1.1905, instance_loss: 0.4955, weighted_loss: 0.9820, label: 2, bag_size: 1215
batch 39, loss: 1.2092, instance_loss: 0.4679, weighted_loss: 0.9868, label: 1, bag_size: 504
batch 59, loss: 2.6211, instance_loss: 0.6840, weighted_loss: 2.0400, label: 4, bag_size: 928
batch 79, loss: 0.5938, instance_loss: 0.4094, weighted_loss: 0.5385, label: 3, bag_size: 15
batch 99, loss: 0.9961, instance_loss: 0.5710, weighted_loss: 0.8686, label: 2, bag_size: 1050
batch 119, loss: 1.4403, instance_loss: 0.5182, weighted_loss: 1.1637, label: 0, bag_size: 807
batch 139, loss: 1.3147, instance_loss: 0.5081, weighted_loss: 1.0727, label: 2, bag_size: 373
batch 159, loss: 2.0513, instance_loss: 0.6039, weighted_loss: 1.6171, label: 3, bag_size: 200
batch 179, loss: 1.1455, instance_loss: 0.4440, weighted_loss: 0.9350, label: 2, bag_size: 323
batch 199, loss: 1.0094, instance_loss: 0.4324, weighted_loss: 0.8363, label: 2, bag_size: 868
batch 219, loss: 0.1791, instance_loss: 0.2919, weighted_loss: 0.2129, label: 3, bag_size: 56
batch 239, loss: 0.4129, instance_loss: 0.2928, weighted_loss: 0.3768, label: 4, bag_size: 23
batch 259, loss: 1.5972, instance_loss: 0.4821, weighted_loss: 1.2626, label: 1, bag_size: 657
batch 279, loss: 1.5960, instance_loss: 0.5696, weighted_loss: 1.2881, label: 0, bag_size: 990
batch 299, loss: 1.2700, instance_loss: 0.4689, weighted_loss: 1.0296, label: 0, bag_size: 552
batch 319, loss: 1.1095, instance_loss: 0.4440, weighted_loss: 0.9098, label: 0, bag_size: 255
batch 339, loss: 1.0994, instance_loss: 0.4230, weighted_loss: 0.8965, label: 1, bag_size: 897
batch 359, loss: 1.7720, instance_loss: 0.5318, weighted_loss: 1.4000, label: 0, bag_size: 282
batch 379, loss: 1.6187, instance_loss: 0.5736, weighted_loss: 1.3051, label: 0, bag_size: 1527
batch 399, loss: 1.1810, instance_loss: 0.4530, weighted_loss: 0.9626, label: 1, bag_size: 442
batch 419, loss: 0.2200, instance_loss: 0.1967, weighted_loss: 0.2130, label: 4, bag_size: 112
batch 439, loss: 1.1429, instance_loss: 0.4670, weighted_loss: 0.9401, label: 2, bag_size: 1047
batch 459, loss: 1.0544, instance_loss: 0.4605, weighted_loss: 0.8762, label: 0, bag_size: 423
batch 479, loss: 0.8818, instance_loss: 0.4071, weighted_loss: 0.7394, label: 0, bag_size: 255
batch 499, loss: 0.2673, instance_loss: 0.1843, weighted_loss: 0.2424, label: 4, bag_size: 148
batch 519, loss: 2.2253, instance_loss: 0.5966, weighted_loss: 1.7367, label: 4, bag_size: 542
batch 539, loss: 1.6374, instance_loss: 0.4836, weighted_loss: 1.2913, label: 1, bag_size: 838


class 0 clustering acc 0.9960091743119266: correct 21713/21800
class 1 clustering acc 0.10137614678899083: correct 442/4360
Epoch: 2, train_loss: 1.0606, train_clustering_loss:  0.4263, train_error: 0.4037
class 0: acc 0.3838383838383838, correct 38/99
class 1: acc 0.5294117647058824, correct 54/102
class 2: acc 0.6, correct 75/125
class 3: acc 0.8, correct 88/110
class 4: acc 0.6422018348623854, correct 70/109

Val Set, val_loss: 1.1799, val_error: 0.3800, auc: 0.8132
class 0 clustering acc 0.9925: correct 1985/2000
class 1 clustering acc 0.0425: correct 17/400
class 0: acc 0.5, correct 4/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.8421052631578947, correct 16/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (1.353769 --> 1.179902).  Saving model ...


batch 19, loss: 1.0698, instance_loss: 0.4783, weighted_loss: 0.8924, label: 0, bag_size: 371
batch 39, loss: 1.0462, instance_loss: 0.4629, weighted_loss: 0.8712, label: 0, bag_size: 801
batch 59, loss: 1.0412, instance_loss: 0.4172, weighted_loss: 0.8540, label: 2, bag_size: 1148
batch 79, loss: 2.7638, instance_loss: 0.7080, weighted_loss: 2.1471, label: 4, bag_size: 663
batch 99, loss: 0.4510, instance_loss: 0.3707, weighted_loss: 0.4269, label: 0, bag_size: 1133
batch 119, loss: 1.1049, instance_loss: 0.4635, weighted_loss: 0.9125, label: 2, bag_size: 935
batch 139, loss: 0.7737, instance_loss: 0.4140, weighted_loss: 0.6658, label: 2, bag_size: 868
batch 159, loss: 0.5854, instance_loss: 0.3151, weighted_loss: 0.5043, label: 3, bag_size: 556
batch 179, loss: 0.9845, instance_loss: 0.4429, weighted_loss: 0.8220, label: 1, bag_size: 1390
batch 199, loss: 0.1757, instance_loss: 0.1911, weighted_loss: 0.1804, label: 3, bag_size: 28
batch 219, loss: 0.8228, instance_loss: 0.4087, weighted_loss: 0.6986, label: 1, bag_size: 504
batch 239, loss: 0.8459, instance_loss: 0.4107, weighted_loss: 0.7154, label: 1, bag_size: 504
batch 259, loss: 1.9428, instance_loss: 0.5388, weighted_loss: 1.5216, label: 0, bag_size: 350
batch 279, loss: 2.0264, instance_loss: 0.6032, weighted_loss: 1.5994, label: 4, bag_size: 625
batch 299, loss: 1.1301, instance_loss: 0.4287, weighted_loss: 0.9197, label: 1, bag_size: 917
batch 319, loss: 1.6881, instance_loss: 0.4795, weighted_loss: 1.3255, label: 1, bag_size: 448
batch 339, loss: 0.8082, instance_loss: 0.3812, weighted_loss: 0.6801, label: 2, bag_size: 1164
batch 359, loss: 0.3444, instance_loss: 0.2271, weighted_loss: 0.3092, label: 4, bag_size: 78
batch 379, loss: 0.8869, instance_loss: 0.4849, weighted_loss: 0.7663, label: 0, bag_size: 1061
batch 399, loss: 0.9247, instance_loss: 0.4225, weighted_loss: 0.7740, label: 2, bag_size: 863
batch 419, loss: 0.9913, instance_loss: 0.4674, weighted_loss: 0.8342, label: 0, bag_size: 1190
batch 439, loss: 0.5726, instance_loss: 0.3550, weighted_loss: 0.5073, label: 0, bag_size: 518
batch 459, loss: 0.3685, instance_loss: 0.2646, weighted_loss: 0.3373, label: 1, bag_size: 696
batch 479, loss: 1.0363, instance_loss: 0.3916, weighted_loss: 0.8429, label: 1, bag_size: 1273
batch 499, loss: 0.2042, instance_loss: 0.1213, weighted_loss: 0.1793, label: 4, bag_size: 160
batch 519, loss: 1.5268, instance_loss: 0.4541, weighted_loss: 1.2050, label: 1, bag_size: 786
batch 539, loss: 1.1373, instance_loss: 0.4601, weighted_loss: 0.9341, label: 2, bag_size: 869


class 0 clustering acc 0.9957798165137615: correct 21708/21800
class 1 clustering acc 0.13876146788990826: correct 605/4360
Epoch: 3, train_loss: 0.9809, train_clustering_loss:  0.4091, train_error: 0.3725
class 0: acc 0.5901639344262295, correct 72/122
class 1: acc 0.5471698113207547, correct 58/106
class 2: acc 0.5714285714285714, correct 72/126
class 3: acc 0.801980198019802, correct 81/101
class 4: acc 0.6555555555555556, correct 59/90

Val Set, val_loss: 1.1615, val_error: 0.4800, auc: 0.8257
class 0 clustering acc 0.993: correct 1986/2000
class 1 clustering acc 0.0675: correct 27/400
class 0: acc 0.625, correct 5/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (1.179902 --> 1.161479).  Saving model ...


batch 19, loss: 0.6367, instance_loss: 0.4284, weighted_loss: 0.5742, label: 0, bag_size: 367
batch 39, loss: 1.8141, instance_loss: 0.6568, weighted_loss: 1.4669, label: 4, bag_size: 663
batch 59, loss: 0.0582, instance_loss: 0.1018, weighted_loss: 0.0713, label: 3, bag_size: 115
batch 79, loss: 2.4266, instance_loss: 0.5314, weighted_loss: 1.8580, label: 2, bag_size: 319
batch 99, loss: 0.5721, instance_loss: 0.3769, weighted_loss: 0.5135, label: 0, bag_size: 255
batch 119, loss: 0.4642, instance_loss: 0.2786, weighted_loss: 0.4085, label: 1, bag_size: 636
batch 139, loss: 1.6643, instance_loss: 0.5688, weighted_loss: 1.3357, label: 4, bag_size: 773
batch 159, loss: 1.3161, instance_loss: 0.5213, weighted_loss: 1.0777, label: 2, bag_size: 725
batch 179, loss: 0.8747, instance_loss: 0.3676, weighted_loss: 0.7226, label: 1, bag_size: 318
batch 199, loss: 0.1350, instance_loss: 0.1888, weighted_loss: 0.1512, label: 3, bag_size: 18
batch 219, loss: 0.1092, instance_loss: 0.1768, weighted_loss: 0.1295, label: 3, bag_size: 16
batch 239, loss: 0.8698, instance_loss: 0.4445, weighted_loss: 0.7422, label: 2, bag_size: 863
batch 259, loss: 0.7995, instance_loss: 0.4142, weighted_loss: 0.6839, label: 2, bag_size: 245
batch 279, loss: 0.7014, instance_loss: 0.3632, weighted_loss: 0.5999, label: 2, bag_size: 935
batch 299, loss: 1.0392, instance_loss: 0.4656, weighted_loss: 0.8671, label: 1, bag_size: 1096
batch 319, loss: 0.0696, instance_loss: 0.1616, weighted_loss: 0.0972, label: 4, bag_size: 63
batch 339, loss: 1.1610, instance_loss: 0.4653, weighted_loss: 0.9523, label: 2, bag_size: 330
batch 359, loss: 2.1499, instance_loss: 0.9531, weighted_loss: 1.7909, label: 0, bag_size: 128
batch 379, loss: 1.4233, instance_loss: 0.5382, weighted_loss: 1.1578, label: 2, bag_size: 3236
batch 399, loss: 0.9559, instance_loss: 0.3928, weighted_loss: 0.7870, label: 0, bag_size: 294
batch 419, loss: 0.7690, instance_loss: 0.3729, weighted_loss: 0.6502, label: 1, bag_size: 858
batch 439, loss: 0.4136, instance_loss: 0.3689, weighted_loss: 0.4002, label: 2, bag_size: 419
batch 459, loss: 2.1449, instance_loss: 0.6364, weighted_loss: 1.6924, label: 1, bag_size: 867
batch 479, loss: 0.3888, instance_loss: 0.3892, weighted_loss: 0.3889, label: 0, bag_size: 518
batch 499, loss: 0.1634, instance_loss: 0.2897, weighted_loss: 0.2013, label: 3, bag_size: 18
batch 519, loss: 1.1783, instance_loss: 0.4986, weighted_loss: 0.9744, label: 2, bag_size: 589
batch 539, loss: 1.6135, instance_loss: 0.6462, weighted_loss: 1.3233, label: 2, bag_size: 1677


class 0 clustering acc 0.9939908256880734: correct 21669/21800
class 1 clustering acc 0.2334862385321101: correct 1018/4360
Epoch: 4, train_loss: 0.8299, train_clustering_loss:  0.3752, train_error: 0.3064
class 0: acc 0.6929824561403509, correct 79/114
class 1: acc 0.6138613861386139, correct 62/101
class 2: acc 0.5700934579439252, correct 61/107
class 3: acc 0.84, correct 84/100
class 4: acc 0.7479674796747967, correct 92/123

Val Set, val_loss: 1.2035, val_error: 0.5200, auc: 0.8412
class 0 clustering acc 0.9905: correct 1981/2000
class 1 clustering acc 0.1575: correct 63/400
class 0: acc 0.5, correct 4/8
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.1395, instance_loss: 0.6707, weighted_loss: 1.6989, label: 3, bag_size: 1250
batch 39, loss: 1.9428, instance_loss: 0.5616, weighted_loss: 1.5284, label: 1, bag_size: 386
batch 59, loss: 0.3424, instance_loss: 0.2259, weighted_loss: 0.3074, label: 1, bag_size: 534
batch 79, loss: 0.2121, instance_loss: 0.2723, weighted_loss: 0.2302, label: 0, bag_size: 898
batch 99, loss: 0.7931, instance_loss: 0.3836, weighted_loss: 0.6702, label: 2, bag_size: 1215
batch 119, loss: 0.8159, instance_loss: 0.5802, weighted_loss: 0.7452, label: 0, bag_size: 129
batch 139, loss: 0.4957, instance_loss: 0.2861, weighted_loss: 0.4329, label: 1, bag_size: 945
batch 159, loss: 0.3208, instance_loss: 0.1686, weighted_loss: 0.2751, label: 1, bag_size: 1127
batch 179, loss: 0.4568, instance_loss: 0.2486, weighted_loss: 0.3944, label: 1, bag_size: 965
batch 199, loss: 0.2401, instance_loss: 0.1308, weighted_loss: 0.2073, label: 1, bag_size: 1127
batch 219, loss: 0.0197, instance_loss: 0.2036, weighted_loss: 0.0748, label: 3, bag_size: 18
batch 239, loss: 0.1952, instance_loss: 0.1036, weighted_loss: 0.1677, label: 4, bag_size: 185
batch 259, loss: 1.1685, instance_loss: 0.4971, weighted_loss: 0.9671, label: 2, bag_size: 120
batch 279, loss: 2.1541, instance_loss: 0.7023, weighted_loss: 1.7185, label: 3, bag_size: 200
batch 299, loss: 0.0254, instance_loss: 0.1667, weighted_loss: 0.0678, label: 3, bag_size: 20
batch 319, loss: 0.3749, instance_loss: 0.4302, weighted_loss: 0.3915, label: 0, bag_size: 616
batch 339, loss: 0.5923, instance_loss: 0.3439, weighted_loss: 0.5178, label: 2, bag_size: 986
batch 359, loss: 0.7251, instance_loss: 0.4599, weighted_loss: 0.6455, label: 4, bag_size: 1474
batch 379, loss: 1.6212, instance_loss: 0.8068, weighted_loss: 1.3769, label: 0, bag_size: 116
batch 399, loss: 1.5883, instance_loss: 0.4977, weighted_loss: 1.2611, label: 4, bag_size: 354
batch 419, loss: 3.0253, instance_loss: 0.6811, weighted_loss: 2.3220, label: 3, bag_size: 211
batch 439, loss: 1.1889, instance_loss: 0.4677, weighted_loss: 0.9726, label: 4, bag_size: 928
batch 459, loss: 0.3947, instance_loss: 0.3083, weighted_loss: 0.3688, label: 2, bag_size: 1448
batch 479, loss: 1.6364, instance_loss: 0.5390, weighted_loss: 1.3072, label: 4, bag_size: 947
batch 499, loss: 0.7933, instance_loss: 0.3951, weighted_loss: 0.6739, label: 2, bag_size: 1385
batch 519, loss: 0.0294, instance_loss: 0.1015, weighted_loss: 0.0511, label: 3, bag_size: 41
batch 539, loss: 0.8644, instance_loss: 0.4283, weighted_loss: 0.7336, label: 2, bag_size: 948


class 0 clustering acc 0.9927522935779817: correct 21642/21800
class 1 clustering acc 0.23853211009174313: correct 1040/4360
Epoch: 5, train_loss: 0.8164, train_clustering_loss:  0.3745, train_error: 0.3138
class 0: acc 0.6494845360824743, correct 63/97
class 1: acc 0.6160714285714286, correct 69/112
class 2: acc 0.6324786324786325, correct 74/117
class 3: acc 0.792, correct 99/125
class 4: acc 0.7340425531914894, correct 69/94

Val Set, val_loss: 1.0091, val_error: 0.4000, auc: 0.8369
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.1575: correct 63/400
class 0: acc 0.375, correct 3/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (1.161479 --> 1.009123).  Saving model ...


batch 19, loss: 0.4123, instance_loss: 0.3240, weighted_loss: 0.3858, label: 4, bag_size: 764
batch 39, loss: 0.5488, instance_loss: 0.4435, weighted_loss: 0.5172, label: 4, bag_size: 1002
batch 59, loss: 0.0932, instance_loss: 0.1410, weighted_loss: 0.1076, label: 3, bag_size: 27
batch 79, loss: 1.0502, instance_loss: 0.4448, weighted_loss: 0.8686, label: 1, bag_size: 648
batch 99, loss: 0.8611, instance_loss: 0.3940, weighted_loss: 0.7210, label: 1, bag_size: 343
batch 119, loss: 0.9017, instance_loss: 0.6865, weighted_loss: 0.8372, label: 0, bag_size: 163
batch 139, loss: 2.7518, instance_loss: 0.6387, weighted_loss: 2.1179, label: 2, bag_size: 319
batch 159, loss: 2.0065, instance_loss: 0.5778, weighted_loss: 1.5779, label: 0, bag_size: 1289
batch 179, loss: 0.7417, instance_loss: 0.3937, weighted_loss: 0.6373, label: 2, bag_size: 474
batch 199, loss: 2.6405, instance_loss: 0.8407, weighted_loss: 2.1006, label: 3, bag_size: 607
batch 219, loss: 2.1095, instance_loss: 0.6307, weighted_loss: 1.6659, label: 1, bag_size: 936
batch 239, loss: 1.3888, instance_loss: 0.5335, weighted_loss: 1.1322, label: 1, bag_size: 343
batch 259, loss: 0.5620, instance_loss: 0.4082, weighted_loss: 0.5159, label: 2, bag_size: 1139
batch 279, loss: 0.4930, instance_loss: 0.4010, weighted_loss: 0.4654, label: 4, bag_size: 1278
batch 299, loss: 0.3485, instance_loss: 0.2464, weighted_loss: 0.3179, label: 1, bag_size: 949
batch 319, loss: 0.5389, instance_loss: 0.3347, weighted_loss: 0.4777, label: 2, bag_size: 1289
batch 339, loss: 0.0284, instance_loss: 0.1680, weighted_loss: 0.0703, label: 3, bag_size: 50
batch 359, loss: 0.1702, instance_loss: 0.1733, weighted_loss: 0.1711, label: 4, bag_size: 40
batch 379, loss: 1.1745, instance_loss: 0.4548, weighted_loss: 0.9586, label: 1, bag_size: 1144
batch 399, loss: 0.0714, instance_loss: 0.2192, weighted_loss: 0.1157, label: 3, bag_size: 20
batch 419, loss: 0.3131, instance_loss: 0.3400, weighted_loss: 0.3212, label: 0, bag_size: 478
batch 439, loss: 2.0048, instance_loss: 0.6829, weighted_loss: 1.6082, label: 1, bag_size: 1376
batch 459, loss: 0.2445, instance_loss: 0.2598, weighted_loss: 0.2491, label: 1, bag_size: 697
batch 479, loss: 1.2428, instance_loss: 0.4882, weighted_loss: 1.0164, label: 2, bag_size: 500
batch 499, loss: 1.7420, instance_loss: 0.5167, weighted_loss: 1.3744, label: 2, bag_size: 542
batch 519, loss: 0.1734, instance_loss: 0.2437, weighted_loss: 0.1945, label: 0, bag_size: 518
batch 539, loss: 1.3616, instance_loss: 0.6230, weighted_loss: 1.1400, label: 3, bag_size: 791


class 0 clustering acc 0.9927064220183486: correct 21641/21800
class 1 clustering acc 0.23256880733944954: correct 1014/4360
Epoch: 6, train_loss: 0.7442, train_clustering_loss:  0.3681, train_error: 0.2789
class 0: acc 0.6568627450980392, correct 67/102
class 1: acc 0.5288461538461539, correct 55/104
class 2: acc 0.7333333333333333, correct 88/120
class 3: acc 0.8362068965517241, correct 97/116
class 4: acc 0.8349514563106796, correct 86/103

Val Set, val_loss: 1.0035, val_error: 0.4200, auc: 0.8436
class 0 clustering acc 0.993: correct 1986/2000
class 1 clustering acc 0.155: correct 62/400
class 0: acc 0.5, correct 4/8
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (1.009123 --> 1.003465).  Saving model ...


batch 19, loss: 1.1253, instance_loss: 0.5639, weighted_loss: 0.9569, label: 2, bag_size: 373
batch 39, loss: 0.0363, instance_loss: 0.2124, weighted_loss: 0.0891, label: 3, bag_size: 56
batch 59, loss: 0.6643, instance_loss: 0.3469, weighted_loss: 0.5691, label: 2, bag_size: 846
batch 79, loss: 2.1697, instance_loss: 0.5731, weighted_loss: 1.6907, label: 4, bag_size: 436
batch 99, loss: 0.5362, instance_loss: 0.4484, weighted_loss: 0.5099, label: 0, bag_size: 990
batch 119, loss: 0.2165, instance_loss: 0.1256, weighted_loss: 0.1892, label: 4, bag_size: 40
batch 139, loss: 0.4629, instance_loss: 0.2607, weighted_loss: 0.4023, label: 1, bag_size: 405
batch 159, loss: 0.5871, instance_loss: 0.2925, weighted_loss: 0.4987, label: 2, bag_size: 1700
batch 179, loss: 0.3016, instance_loss: 0.1456, weighted_loss: 0.2548, label: 3, bag_size: 405
batch 199, loss: 0.2685, instance_loss: 0.2513, weighted_loss: 0.2633, label: 0, bag_size: 552
batch 219, loss: 0.5232, instance_loss: 0.4079, weighted_loss: 0.4886, label: 0, bag_size: 1034
batch 239, loss: 0.8225, instance_loss: 0.3653, weighted_loss: 0.6853, label: 1, bag_size: 897
batch 259, loss: 0.7629, instance_loss: 0.4183, weighted_loss: 0.6595, label: 2, bag_size: 1404
batch 279, loss: 1.7321, instance_loss: 0.3837, weighted_loss: 1.3276, label: 0, bag_size: 381
batch 299, loss: 0.2071, instance_loss: 0.2110, weighted_loss: 0.2083, label: 1, bag_size: 903
batch 319, loss: 3.0713, instance_loss: 0.7322, weighted_loss: 2.3696, label: 3, bag_size: 281
batch 339, loss: 0.8637, instance_loss: 0.3895, weighted_loss: 0.7214, label: 3, bag_size: 697
batch 359, loss: 1.8284, instance_loss: 0.8817, weighted_loss: 1.5444, label: 0, bag_size: 118
batch 379, loss: 0.0760, instance_loss: 0.0823, weighted_loss: 0.0779, label: 4, bag_size: 148
batch 399, loss: 0.1401, instance_loss: 0.2631, weighted_loss: 0.1770, label: 0, bag_size: 1143
batch 419, loss: 2.2120, instance_loss: 0.4975, weighted_loss: 1.6976, label: 3, bag_size: 1118
batch 439, loss: 0.2490, instance_loss: 0.2681, weighted_loss: 0.2547, label: 3, bag_size: 18
batch 459, loss: 0.7790, instance_loss: 0.4821, weighted_loss: 0.6899, label: 0, bag_size: 255
batch 479, loss: 2.3859, instance_loss: 0.6768, weighted_loss: 1.8732, label: 0, bag_size: 801
batch 499, loss: 1.9473, instance_loss: 0.5658, weighted_loss: 1.5329, label: 2, bag_size: 1231
batch 519, loss: 0.3016, instance_loss: 0.1982, weighted_loss: 0.2706, label: 1, bag_size: 346
batch 539, loss: 0.0909, instance_loss: 0.4335, weighted_loss: 0.1937, label: 3, bag_size: 17


class 0 clustering acc 0.991788990825688: correct 21621/21800
class 1 clustering acc 0.26972477064220185: correct 1176/4360
Epoch: 7, train_loss: 0.6826, train_clustering_loss:  0.3516, train_error: 0.2495
class 0: acc 0.67, correct 67/100
class 1: acc 0.7232142857142857, correct 81/112
class 2: acc 0.6698113207547169, correct 71/106
class 3: acc 0.8403361344537815, correct 100/119
class 4: acc 0.8333333333333334, correct 90/108

Val Set, val_loss: 1.0428, val_error: 0.4400, auc: 0.8520
class 0 clustering acc 0.9945: correct 1989/2000
class 1 clustering acc 0.1625: correct 65/400
class 0: acc 0.625, correct 5/8
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9939, instance_loss: 0.4491, weighted_loss: 0.8304, label: 2, bag_size: 1617
batch 39, loss: 0.4503, instance_loss: 0.2642, weighted_loss: 0.3945, label: 3, bag_size: 1019
batch 59, loss: 0.7853, instance_loss: 0.4464, weighted_loss: 0.6836, label: 0, bag_size: 962
batch 79, loss: 0.0415, instance_loss: 0.1188, weighted_loss: 0.0647, label: 3, bag_size: 19
batch 99, loss: 0.6542, instance_loss: 0.3105, weighted_loss: 0.5511, label: 1, bag_size: 504
batch 119, loss: 0.2209, instance_loss: 0.1856, weighted_loss: 0.2103, label: 1, bag_size: 994
batch 139, loss: 0.3474, instance_loss: 0.2702, weighted_loss: 0.3242, label: 1, bag_size: 847
batch 159, loss: 0.7459, instance_loss: 0.5250, weighted_loss: 0.6796, label: 0, bag_size: 760
batch 179, loss: 0.4423, instance_loss: 0.2996, weighted_loss: 0.3995, label: 2, bag_size: 1569
batch 199, loss: 0.6340, instance_loss: 0.3530, weighted_loss: 0.5497, label: 2, bag_size: 409
batch 219, loss: 0.0569, instance_loss: 0.1803, weighted_loss: 0.0940, label: 3, bag_size: 35
batch 239, loss: 0.6722, instance_loss: 0.3890, weighted_loss: 0.5872, label: 1, bag_size: 925
batch 259, loss: 0.1197, instance_loss: 0.0743, weighted_loss: 0.1061, label: 4, bag_size: 119
batch 279, loss: 1.9741, instance_loss: 0.6758, weighted_loss: 1.5846, label: 2, bag_size: 732
batch 299, loss: 0.8117, instance_loss: 0.3706, weighted_loss: 0.6793, label: 4, bag_size: 947
batch 319, loss: 0.1441, instance_loss: 0.2308, weighted_loss: 0.1701, label: 0, bag_size: 616
batch 339, loss: 0.0460, instance_loss: 0.1573, weighted_loss: 0.0794, label: 3, bag_size: 33
batch 359, loss: 1.7153, instance_loss: 0.5384, weighted_loss: 1.3622, label: 1, bag_size: 377
batch 379, loss: 0.8092, instance_loss: 0.5399, weighted_loss: 0.7284, label: 1, bag_size: 867
batch 399, loss: 0.4261, instance_loss: 0.4825, weighted_loss: 0.4430, label: 1, bag_size: 1409
batch 419, loss: 0.4313, instance_loss: 0.1926, weighted_loss: 0.3597, label: 1, bag_size: 399
batch 439, loss: 0.5287, instance_loss: 0.3293, weighted_loss: 0.4689, label: 2, bag_size: 324
batch 459, loss: 0.0662, instance_loss: 0.2825, weighted_loss: 0.1311, label: 3, bag_size: 20
batch 479, loss: 0.0053, instance_loss: 0.0390, weighted_loss: 0.0154, label: 3, bag_size: 43
batch 499, loss: 1.1226, instance_loss: 0.4088, weighted_loss: 0.9085, label: 2, bag_size: 948
batch 519, loss: 0.0569, instance_loss: 0.0608, weighted_loss: 0.0581, label: 4, bag_size: 174
batch 539, loss: 1.9988, instance_loss: 0.6856, weighted_loss: 1.6049, label: 4, bag_size: 1360


class 0 clustering acc 0.9930275229357798: correct 21648/21800
class 1 clustering acc 0.28577981651376144: correct 1246/4360
Epoch: 8, train_loss: 0.6419, train_clustering_loss:  0.3408, train_error: 0.2459
class 0: acc 0.6770833333333334, correct 65/96
class 1: acc 0.7033898305084746, correct 83/118
class 2: acc 0.6612903225806451, correct 82/124
class 3: acc 0.8823529411764706, correct 75/85
class 4: acc 0.8688524590163934, correct 106/122

Val Set, val_loss: 1.0075, val_error: 0.4000, auc: 0.8682
class 0 clustering acc 0.9905: correct 1981/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0268, instance_loss: 0.1947, weighted_loss: 0.0772, label: 3, bag_size: 20
batch 39, loss: 1.3537, instance_loss: 0.4683, weighted_loss: 1.0881, label: 1, bag_size: 897
batch 59, loss: 0.2356, instance_loss: 0.2751, weighted_loss: 0.2474, label: 0, bag_size: 1247
batch 79, loss: 0.8375, instance_loss: 0.4048, weighted_loss: 0.7077, label: 1, bag_size: 1049
batch 99, loss: 0.0658, instance_loss: 0.1147, weighted_loss: 0.0805, label: 3, bag_size: 28
batch 119, loss: 0.0364, instance_loss: 0.0937, weighted_loss: 0.0536, label: 4, bag_size: 47
batch 139, loss: 0.6167, instance_loss: 0.4287, weighted_loss: 0.5603, label: 1, bag_size: 700
batch 159, loss: 0.2314, instance_loss: 0.2486, weighted_loss: 0.2366, label: 0, bag_size: 340
batch 179, loss: 1.8015, instance_loss: 0.6223, weighted_loss: 1.4478, label: 4, bag_size: 1331
batch 199, loss: 0.0109, instance_loss: 0.0375, weighted_loss: 0.0189, label: 3, bag_size: 72
batch 219, loss: 0.2041, instance_loss: 0.1506, weighted_loss: 0.1880, label: 1, bag_size: 1191
batch 239, loss: 0.3580, instance_loss: 0.5233, weighted_loss: 0.4076, label: 4, bag_size: 1278
batch 259, loss: 0.5944, instance_loss: 0.3615, weighted_loss: 0.5246, label: 0, bag_size: 990
batch 279, loss: 0.3255, instance_loss: 0.3085, weighted_loss: 0.3204, label: 1, bag_size: 614
batch 299, loss: 0.6412, instance_loss: 0.4393, weighted_loss: 0.5806, label: 2, bag_size: 405
batch 319, loss: 0.8386, instance_loss: 0.5797, weighted_loss: 0.7609, label: 2, bag_size: 518
batch 339, loss: 0.3624, instance_loss: 0.3416, weighted_loss: 0.3561, label: 0, bag_size: 807
batch 359, loss: 0.3531, instance_loss: 0.2817, weighted_loss: 0.3317, label: 1, bag_size: 318
batch 379, loss: 0.2776, instance_loss: 0.2712, weighted_loss: 0.2757, label: 0, bag_size: 1517
batch 399, loss: 0.1197, instance_loss: 0.4422, weighted_loss: 0.2164, label: 1, bag_size: 1152
batch 419, loss: 0.7246, instance_loss: 0.4065, weighted_loss: 0.6292, label: 2, bag_size: 357
batch 439, loss: 0.5816, instance_loss: 0.4425, weighted_loss: 0.5399, label: 1, bag_size: 867
batch 459, loss: 0.1892, instance_loss: 0.2881, weighted_loss: 0.2189, label: 4, bag_size: 86
batch 479, loss: 0.5699, instance_loss: 0.3883, weighted_loss: 0.5155, label: 2, bag_size: 314
batch 499, loss: 0.9139, instance_loss: 0.5230, weighted_loss: 0.7966, label: 2, bag_size: 1677
batch 519, loss: 0.2849, instance_loss: 0.2687, weighted_loss: 0.2800, label: 1, bag_size: 651
batch 539, loss: 1.0596, instance_loss: 0.3971, weighted_loss: 0.8608, label: 1, bag_size: 470


class 0 clustering acc 0.9917431192660551: correct 21620/21800
class 1 clustering acc 0.30596330275229355: correct 1334/4360
Epoch: 9, train_loss: 0.5850, train_clustering_loss:  0.3283, train_error: 0.2073
class 0: acc 0.803921568627451, correct 82/102
class 1: acc 0.717741935483871, correct 89/124
class 2: acc 0.719626168224299, correct 77/107
class 3: acc 0.897196261682243, correct 96/107
class 4: acc 0.8380952380952381, correct 88/105

Val Set, val_loss: 0.9805, val_error: 0.4200, auc: 0.8515
class 0 clustering acc 0.9915: correct 1983/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.5, correct 4/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (1.003465 --> 0.980476).  Saving model ...


batch 19, loss: 1.5122, instance_loss: 0.5893, weighted_loss: 1.2353, label: 1, bag_size: 386
batch 39, loss: 0.0635, instance_loss: 0.1306, weighted_loss: 0.0836, label: 0, bag_size: 402
batch 59, loss: 0.4848, instance_loss: 0.4137, weighted_loss: 0.4635, label: 3, bag_size: 849
batch 79, loss: 1.0274, instance_loss: 0.4800, weighted_loss: 0.8632, label: 2, bag_size: 741
batch 99, loss: 0.1530, instance_loss: 0.2446, weighted_loss: 0.1805, label: 0, bag_size: 542
batch 119, loss: 0.5689, instance_loss: 0.3416, weighted_loss: 0.5007, label: 0, bag_size: 410
batch 139, loss: 1.3830, instance_loss: 0.4666, weighted_loss: 1.1081, label: 2, bag_size: 384
batch 159, loss: 0.2468, instance_loss: 0.3260, weighted_loss: 0.2705, label: 0, bag_size: 1247
batch 179, loss: 1.0019, instance_loss: 0.7189, weighted_loss: 0.9170, label: 0, bag_size: 129
batch 199, loss: 0.0368, instance_loss: 0.1340, weighted_loss: 0.0660, label: 4, bag_size: 24
batch 219, loss: 0.0161, instance_loss: 0.2063, weighted_loss: 0.0732, label: 3, bag_size: 18
batch 239, loss: 0.2213, instance_loss: 0.1241, weighted_loss: 0.1922, label: 1, bag_size: 869
batch 259, loss: 1.4874, instance_loss: 0.5157, weighted_loss: 1.1959, label: 2, bag_size: 1231
batch 279, loss: 0.9371, instance_loss: 0.4806, weighted_loss: 0.8001, label: 2, bag_size: 508
batch 299, loss: 0.0293, instance_loss: 0.1805, weighted_loss: 0.0747, label: 4, bag_size: 26
batch 319, loss: 0.0352, instance_loss: 0.1739, weighted_loss: 0.0768, label: 3, bag_size: 18
batch 339, loss: 0.1081, instance_loss: 0.2190, weighted_loss: 0.1414, label: 0, bag_size: 1018
batch 359, loss: 0.0742, instance_loss: 0.1234, weighted_loss: 0.0890, label: 4, bag_size: 78
batch 379, loss: 0.0405, instance_loss: 0.0620, weighted_loss: 0.0470, label: 4, bag_size: 192
batch 399, loss: 1.4642, instance_loss: 0.4792, weighted_loss: 1.1687, label: 1, bag_size: 838
batch 419, loss: 0.5408, instance_loss: 0.5398, weighted_loss: 0.5405, label: 0, bag_size: 515
batch 439, loss: 0.4343, instance_loss: 0.3375, weighted_loss: 0.4053, label: 2, bag_size: 400
batch 459, loss: 2.8051, instance_loss: 0.7143, weighted_loss: 2.1779, label: 2, bag_size: 194
batch 479, loss: 0.8000, instance_loss: 0.4261, weighted_loss: 0.6878, label: 2, bag_size: 409
batch 499, loss: 0.5794, instance_loss: 0.4478, weighted_loss: 0.5399, label: 2, bag_size: 1069
batch 519, loss: 0.0923, instance_loss: 0.1834, weighted_loss: 0.1196, label: 0, bag_size: 1517
batch 539, loss: 0.1548, instance_loss: 0.1481, weighted_loss: 0.1528, label: 1, bag_size: 696


class 0 clustering acc 0.991697247706422: correct 21619/21800
class 1 clustering acc 0.4153669724770642: correct 1811/4360
Epoch: 10, train_loss: 0.4797, train_clustering_loss:  0.2932, train_error: 0.1761
class 0: acc 0.7959183673469388, correct 78/98
class 1: acc 0.7413793103448276, correct 86/116
class 2: acc 0.776595744680851, correct 73/94
class 3: acc 0.8706896551724138, correct 101/116
class 4: acc 0.9173553719008265, correct 111/121

Val Set, val_loss: 1.0384, val_error: 0.4200, auc: 0.8699
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.25: correct 100/400
class 0: acc 0.625, correct 5/8
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0229, instance_loss: 0.1320, weighted_loss: 0.0556, label: 3, bag_size: 18
batch 39, loss: 0.3156, instance_loss: 0.2683, weighted_loss: 0.3014, label: 2, bag_size: 461
batch 59, loss: 0.0066, instance_loss: 0.1235, weighted_loss: 0.0417, label: 3, bag_size: 19
batch 79, loss: 0.1398, instance_loss: 0.3316, weighted_loss: 0.1973, label: 0, bag_size: 1086
batch 99, loss: 0.2412, instance_loss: 0.3966, weighted_loss: 0.2878, label: 4, bag_size: 14
batch 119, loss: 0.1541, instance_loss: 0.1643, weighted_loss: 0.1572, label: 0, bag_size: 1579
batch 139, loss: 0.1063, instance_loss: 0.2557, weighted_loss: 0.1511, label: 4, bag_size: 29
batch 159, loss: 0.0015, instance_loss: 0.0466, weighted_loss: 0.0151, label: 3, bag_size: 43
batch 179, loss: 0.0025, instance_loss: 0.0543, weighted_loss: 0.0180, label: 3, bag_size: 56
batch 199, loss: 0.0548, instance_loss: 0.0764, weighted_loss: 0.0613, label: 4, bag_size: 202
batch 219, loss: 0.0171, instance_loss: 0.1583, weighted_loss: 0.0595, label: 3, bag_size: 16
batch 239, loss: 0.5159, instance_loss: 0.4416, weighted_loss: 0.4936, label: 1, bag_size: 818
batch 259, loss: 0.1589, instance_loss: 0.1868, weighted_loss: 0.1673, label: 4, bag_size: 143
batch 279, loss: 0.6524, instance_loss: 0.3678, weighted_loss: 0.5670, label: 0, bag_size: 350
batch 299, loss: 0.1163, instance_loss: 0.2622, weighted_loss: 0.1601, label: 0, bag_size: 1133
batch 319, loss: 0.0268, instance_loss: 0.0814, weighted_loss: 0.0432, label: 3, bag_size: 63
batch 339, loss: 0.3538, instance_loss: 0.3303, weighted_loss: 0.3467, label: 0, bag_size: 413
batch 359, loss: 0.1413, instance_loss: 0.2325, weighted_loss: 0.1687, label: 0, bag_size: 515
batch 379, loss: 2.2151, instance_loss: 0.6113, weighted_loss: 1.7340, label: 1, bag_size: 875
batch 399, loss: 0.0859, instance_loss: 0.2014, weighted_loss: 0.1206, label: 3, bag_size: 1291
batch 419, loss: 0.2623, instance_loss: 0.4159, weighted_loss: 0.3083, label: 1, bag_size: 925
batch 439, loss: 0.9381, instance_loss: 0.3759, weighted_loss: 0.7695, label: 1, bag_size: 1049
batch 459, loss: 0.6211, instance_loss: 0.3628, weighted_loss: 0.5436, label: 2, bag_size: 1150
batch 479, loss: 0.1220, instance_loss: 0.1956, weighted_loss: 0.1441, label: 0, bag_size: 1517
batch 499, loss: 1.9402, instance_loss: 0.8040, weighted_loss: 1.5994, label: 3, bag_size: 283
batch 519, loss: 2.3126, instance_loss: 0.8321, weighted_loss: 1.8684, label: 3, bag_size: 281
batch 539, loss: 0.4957, instance_loss: 0.2968, weighted_loss: 0.4360, label: 4, bag_size: 20


class 0 clustering acc 0.9878440366972477: correct 21535/21800
class 1 clustering acc 0.3456422018348624: correct 1507/4360
Epoch: 11, train_loss: 0.5441, train_clustering_loss:  0.3329, train_error: 0.1963
class 0: acc 0.8503937007874016, correct 108/127
class 1: acc 0.7010309278350515, correct 68/97
class 2: acc 0.6702127659574468, correct 63/94
class 3: acc 0.8833333333333333, correct 106/120
class 4: acc 0.8691588785046729, correct 93/107

Val Set, val_loss: 0.9630, val_error: 0.3800, auc: 0.8562
class 0 clustering acc 0.992: correct 1984/2000
class 1 clustering acc 0.215: correct 86/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (0.980476 --> 0.963017).  Saving model ...


batch 19, loss: 0.0053, instance_loss: 0.0933, weighted_loss: 0.0317, label: 4, bag_size: 140
batch 39, loss: 0.0238, instance_loss: 0.0999, weighted_loss: 0.0467, label: 4, bag_size: 150
batch 59, loss: 0.0169, instance_loss: 0.1081, weighted_loss: 0.0443, label: 3, bag_size: 20
batch 79, loss: 0.0032, instance_loss: 0.0547, weighted_loss: 0.0187, label: 3, bag_size: 23
batch 99, loss: 0.2386, instance_loss: 0.2492, weighted_loss: 0.2418, label: 2, bag_size: 347
batch 119, loss: 0.5009, instance_loss: 0.3656, weighted_loss: 0.4603, label: 4, bag_size: 1278
batch 139, loss: 0.0006, instance_loss: 0.2947, weighted_loss: 0.0889, label: 4, bag_size: 1002
batch 159, loss: 0.0448, instance_loss: 0.1193, weighted_loss: 0.0672, label: 0, bag_size: 402
batch 179, loss: 0.0076, instance_loss: 0.2127, weighted_loss: 0.0691, label: 3, bag_size: 18
batch 199, loss: 0.1340, instance_loss: 0.1873, weighted_loss: 0.1500, label: 0, bag_size: 1190
batch 219, loss: 2.0701, instance_loss: 0.5535, weighted_loss: 1.6151, label: 2, bag_size: 1231
batch 239, loss: 0.0232, instance_loss: 0.1491, weighted_loss: 0.0610, label: 4, bag_size: 91
batch 259, loss: 0.0060, instance_loss: 0.0363, weighted_loss: 0.0150, label: 3, bag_size: 56
batch 279, loss: 0.2272, instance_loss: 0.1466, weighted_loss: 0.2030, label: 1, bag_size: 1086
batch 299, loss: 0.0724, instance_loss: 0.3582, weighted_loss: 0.1582, label: 3, bag_size: 1250
batch 319, loss: 0.1619, instance_loss: 0.2950, weighted_loss: 0.2018, label: 4, bag_size: 1278
batch 339, loss: 0.9812, instance_loss: 0.4079, weighted_loss: 0.8092, label: 1, bag_size: 959
batch 359, loss: 0.0892, instance_loss: 0.2252, weighted_loss: 0.1300, label: 4, bag_size: 23
batch 379, loss: 0.2221, instance_loss: 0.4319, weighted_loss: 0.2850, label: 4, bag_size: 1176
batch 399, loss: 0.0173, instance_loss: 0.1029, weighted_loss: 0.0430, label: 3, bag_size: 63
batch 419, loss: 0.0151, instance_loss: 0.1337, weighted_loss: 0.0507, label: 3, bag_size: 53
batch 439, loss: 0.0195, instance_loss: 0.0798, weighted_loss: 0.0376, label: 3, bag_size: 75
batch 459, loss: 0.6007, instance_loss: 0.3811, weighted_loss: 0.5348, label: 0, bag_size: 912
batch 479, loss: 0.1993, instance_loss: 0.0972, weighted_loss: 0.1687, label: 3, bag_size: 1399
batch 499, loss: 0.0572, instance_loss: 0.0932, weighted_loss: 0.0680, label: 3, bag_size: 1399
batch 519, loss: 0.0218, instance_loss: 0.1749, weighted_loss: 0.0677, label: 3, bag_size: 18
batch 539, loss: 0.8337, instance_loss: 0.4198, weighted_loss: 0.7095, label: 0, bag_size: 736


class 0 clustering acc 0.9910091743119266: correct 21604/21800
class 1 clustering acc 0.35275229357798166: correct 1538/4360
Epoch: 12, train_loss: 0.4908, train_clustering_loss:  0.3187, train_error: 0.1908
class 0: acc 0.8113207547169812, correct 86/106
class 1: acc 0.7117117117117117, correct 79/111
class 2: acc 0.7075471698113207, correct 75/106
class 3: acc 0.9159663865546218, correct 109/119
class 4: acc 0.8932038834951457, correct 92/103

Val Set, val_loss: 0.9973, val_error: 0.4200, auc: 0.8707
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5926, instance_loss: 0.5831, weighted_loss: 0.5898, label: 2, bag_size: 1069
batch 39, loss: 0.1418, instance_loss: 0.1942, weighted_loss: 0.1575, label: 2, bag_size: 455
batch 59, loss: 0.0095, instance_loss: 0.0533, weighted_loss: 0.0226, label: 3, bag_size: 54
batch 79, loss: 0.0188, instance_loss: 0.0280, weighted_loss: 0.0215, label: 3, bag_size: 54
batch 99, loss: 0.8941, instance_loss: 0.5974, weighted_loss: 0.8051, label: 2, bag_size: 1677
batch 119, loss: 0.0075, instance_loss: 0.2480, weighted_loss: 0.0797, label: 3, bag_size: 18
batch 139, loss: 1.9810, instance_loss: 0.6374, weighted_loss: 1.5780, label: 1, bag_size: 1376
batch 159, loss: 0.6560, instance_loss: 0.4986, weighted_loss: 0.6088, label: 1, bag_size: 917
batch 179, loss: 0.0084, instance_loss: 0.0532, weighted_loss: 0.0218, label: 3, bag_size: 23
batch 199, loss: 0.4079, instance_loss: 0.3401, weighted_loss: 0.3875, label: 2, bag_size: 2826
batch 219, loss: 0.0299, instance_loss: 0.0611, weighted_loss: 0.0393, label: 3, bag_size: 60
batch 239, loss: 0.7285, instance_loss: 0.2972, weighted_loss: 0.5991, label: 1, bag_size: 968
batch 259, loss: 0.0063, instance_loss: 0.1653, weighted_loss: 0.0540, label: 3, bag_size: 20
batch 279, loss: 0.8841, instance_loss: 0.3972, weighted_loss: 0.7380, label: 1, bag_size: 377
batch 299, loss: 0.2140, instance_loss: 0.3102, weighted_loss: 0.2429, label: 4, bag_size: 24
batch 319, loss: 0.5652, instance_loss: 0.4907, weighted_loss: 0.5429, label: 1, bag_size: 1409
batch 339, loss: 2.2042, instance_loss: 0.7791, weighted_loss: 1.7767, label: 3, bag_size: 281
batch 359, loss: 0.0206, instance_loss: 0.0775, weighted_loss: 0.0377, label: 3, bag_size: 28
batch 379, loss: 0.0117, instance_loss: 0.1664, weighted_loss: 0.0581, label: 4, bag_size: 39
batch 399, loss: 0.0943, instance_loss: 0.2793, weighted_loss: 0.1498, label: 2, bag_size: 2826
batch 419, loss: 0.0044, instance_loss: 0.1094, weighted_loss: 0.0359, label: 3, bag_size: 34
batch 439, loss: 0.0041, instance_loss: 0.0719, weighted_loss: 0.0245, label: 3, bag_size: 24
batch 459, loss: 1.4321, instance_loss: 0.4040, weighted_loss: 1.1236, label: 2, bag_size: 676
batch 479, loss: 0.0272, instance_loss: 0.1228, weighted_loss: 0.0559, label: 0, bag_size: 1466
batch 499, loss: 0.0961, instance_loss: 0.1620, weighted_loss: 0.1159, label: 3, bag_size: 451
batch 519, loss: 0.2086, instance_loss: 0.2274, weighted_loss: 0.2143, label: 2, bag_size: 2081
batch 539, loss: 0.2717, instance_loss: 0.2623, weighted_loss: 0.2689, label: 2, bag_size: 614


class 0 clustering acc 0.9909174311926605: correct 21602/21800
class 1 clustering acc 0.3346330275229358: correct 1459/4360
Epoch: 13, train_loss: 0.5206, train_clustering_loss:  0.3280, train_error: 0.1872
class 0: acc 0.8557692307692307, correct 89/104
class 1: acc 0.6785714285714286, correct 76/112
class 2: acc 0.7479674796747967, correct 92/123
class 3: acc 0.9108910891089109, correct 92/101
class 4: acc 0.8952380952380953, correct 94/105

Val Set, val_loss: 1.0267, val_error: 0.4200, auc: 0.8582
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.2525: correct 101/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8377, instance_loss: 0.4121, weighted_loss: 0.7100, label: 0, bag_size: 736
batch 39, loss: 0.2783, instance_loss: 0.2864, weighted_loss: 0.2807, label: 0, bag_size: 1196
batch 59, loss: 0.1553, instance_loss: 0.1251, weighted_loss: 0.1462, label: 3, bag_size: 316
batch 79, loss: 0.6315, instance_loss: 0.3961, weighted_loss: 0.5608, label: 1, bag_size: 405
batch 99, loss: 1.5376, instance_loss: 0.3323, weighted_loss: 1.1760, label: 2, bag_size: 323
batch 119, loss: 0.1023, instance_loss: 0.2605, weighted_loss: 0.1498, label: 1, bag_size: 890
batch 139, loss: 1.3338, instance_loss: 0.4771, weighted_loss: 1.0768, label: 1, bag_size: 1197
batch 159, loss: 0.1182, instance_loss: 0.1700, weighted_loss: 0.1338, label: 3, bag_size: 316
batch 179, loss: 0.2848, instance_loss: 0.5812, weighted_loss: 0.3737, label: 0, bag_size: 176
batch 199, loss: 0.0587, instance_loss: 0.3103, weighted_loss: 0.1342, label: 0, bag_size: 148
batch 219, loss: 0.3782, instance_loss: 0.3649, weighted_loss: 0.3742, label: 2, bag_size: 1788
batch 239, loss: 0.0904, instance_loss: 0.1105, weighted_loss: 0.0964, label: 1, bag_size: 682
batch 259, loss: 0.1144, instance_loss: 0.2504, weighted_loss: 0.1552, label: 4, bag_size: 20
batch 279, loss: 0.3841, instance_loss: 0.3835, weighted_loss: 0.3839, label: 2, bag_size: 1141
batch 299, loss: 0.5906, instance_loss: 0.3414, weighted_loss: 0.5158, label: 0, bag_size: 718
batch 319, loss: 0.0023, instance_loss: 0.1804, weighted_loss: 0.0557, label: 3, bag_size: 18
batch 339, loss: 0.0070, instance_loss: 0.0353, weighted_loss: 0.0155, label: 3, bag_size: 66
batch 359, loss: 0.3808, instance_loss: 0.3122, weighted_loss: 0.3602, label: 2, bag_size: 271
batch 379, loss: 0.1588, instance_loss: 0.1792, weighted_loss: 0.1649, label: 1, bag_size: 682
batch 399, loss: 0.2690, instance_loss: 0.1593, weighted_loss: 0.2361, label: 4, bag_size: 20
batch 419, loss: 0.0085, instance_loss: 0.0611, weighted_loss: 0.0243, label: 3, bag_size: 72
batch 439, loss: 0.2770, instance_loss: 0.3031, weighted_loss: 0.2848, label: 2, bag_size: 655
batch 459, loss: 0.7726, instance_loss: 0.3831, weighted_loss: 0.6558, label: 1, bag_size: 847
batch 479, loss: 0.0781, instance_loss: 0.2233, weighted_loss: 0.1217, label: 4, bag_size: 1235
batch 499, loss: 0.0219, instance_loss: 0.1033, weighted_loss: 0.0464, label: 4, bag_size: 162
batch 519, loss: 0.0687, instance_loss: 0.3403, weighted_loss: 0.1502, label: 4, bag_size: 823
batch 539, loss: 0.0256, instance_loss: 0.0965, weighted_loss: 0.0469, label: 4, bag_size: 143


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.4206422018348624: correct 1834/4360
Epoch: 14, train_loss: 0.4384, train_clustering_loss:  0.2917, train_error: 0.1615
class 0: acc 0.9122807017543859, correct 104/114
class 1: acc 0.7142857142857143, correct 80/112
class 2: acc 0.7029702970297029, correct 71/101
class 3: acc 0.908256880733945, correct 99/109
class 4: acc 0.944954128440367, correct 103/109

Val Set, val_loss: 0.9769, val_error: 0.4200, auc: 0.8642
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2745, instance_loss: 0.2640, weighted_loss: 0.2713, label: 0, bag_size: 350
batch 39, loss: 0.0083, instance_loss: 0.1128, weighted_loss: 0.0397, label: 4, bag_size: 192
batch 59, loss: 0.0937, instance_loss: 0.2146, weighted_loss: 0.1300, label: 0, bag_size: 1135
batch 79, loss: 0.5766, instance_loss: 0.3529, weighted_loss: 0.5095, label: 0, bag_size: 912
batch 99, loss: 1.1532, instance_loss: 0.7544, weighted_loss: 1.0336, label: 3, bag_size: 671
batch 119, loss: 0.0292, instance_loss: 0.0729, weighted_loss: 0.0423, label: 0, bag_size: 552
batch 139, loss: 0.4254, instance_loss: 0.3049, weighted_loss: 0.3892, label: 2, bag_size: 265
batch 159, loss: 0.0044, instance_loss: 0.1534, weighted_loss: 0.0491, label: 4, bag_size: 182
batch 179, loss: 2.0441, instance_loss: 0.6431, weighted_loss: 1.6238, label: 2, bag_size: 511
batch 199, loss: 0.1984, instance_loss: 0.3678, weighted_loss: 0.2492, label: 2, bag_size: 396
batch 219, loss: 0.5030, instance_loss: 0.2681, weighted_loss: 0.4325, label: 2, bag_size: 913
batch 239, loss: 0.0010, instance_loss: 0.0467, weighted_loss: 0.0147, label: 4, bag_size: 157
batch 259, loss: 0.0162, instance_loss: 0.0854, weighted_loss: 0.0369, label: 4, bag_size: 44
batch 279, loss: 0.1859, instance_loss: 0.2254, weighted_loss: 0.1977, label: 2, bag_size: 1123
batch 299, loss: 0.0318, instance_loss: 0.1046, weighted_loss: 0.0536, label: 4, bag_size: 211
batch 319, loss: 0.0081, instance_loss: 0.0970, weighted_loss: 0.0348, label: 4, bag_size: 182
batch 339, loss: 0.0586, instance_loss: 0.3157, weighted_loss: 0.1357, label: 3, bag_size: 18
batch 359, loss: 1.7598, instance_loss: 0.5609, weighted_loss: 1.4002, label: 2, bag_size: 967
batch 379, loss: 0.1301, instance_loss: 0.2711, weighted_loss: 0.1724, label: 1, bag_size: 1152
batch 399, loss: 0.5028, instance_loss: 0.4238, weighted_loss: 0.4791, label: 2, bag_size: 589
batch 419, loss: 1.7880, instance_loss: 0.5822, weighted_loss: 1.4263, label: 1, bag_size: 1172
batch 439, loss: 0.0071, instance_loss: 0.2244, weighted_loss: 0.0723, label: 3, bag_size: 18
batch 459, loss: 0.8961, instance_loss: 0.4760, weighted_loss: 0.7701, label: 2, bag_size: 500
batch 479, loss: 0.8228, instance_loss: 0.3654, weighted_loss: 0.6856, label: 1, bag_size: 847
batch 499, loss: 0.5330, instance_loss: 0.5441, weighted_loss: 0.5363, label: 1, bag_size: 269
batch 519, loss: 0.3430, instance_loss: 0.3425, weighted_loss: 0.3429, label: 2, bag_size: 741
batch 539, loss: 0.3135, instance_loss: 0.4183, weighted_loss: 0.3449, label: 4, bag_size: 773


class 0 clustering acc 0.9886238532110092: correct 21552/21800
class 1 clustering acc 0.3665137614678899: correct 1598/4360
Epoch: 15, train_loss: 0.4849, train_clustering_loss:  0.3223, train_error: 0.1615
class 0: acc 0.8811881188118812, correct 89/101
class 1: acc 0.6846846846846847, correct 76/111
class 2: acc 0.7768595041322314, correct 94/121
class 3: acc 0.9159663865546218, correct 109/119
class 4: acc 0.956989247311828, correct 89/93

Val Set, val_loss: 0.9561, val_error: 0.3400, auc: 0.8583
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.265: correct 106/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
Validation loss decreased (0.963017 --> 0.956131).  Saving model ...


batch 19, loss: 0.3498, instance_loss: 0.3805, weighted_loss: 0.3590, label: 2, bag_size: 411
batch 39, loss: 0.0213, instance_loss: 0.0519, weighted_loss: 0.0305, label: 0, bag_size: 518
batch 59, loss: 0.6642, instance_loss: 0.3243, weighted_loss: 0.5623, label: 1, bag_size: 913
batch 79, loss: 0.0822, instance_loss: 0.1505, weighted_loss: 0.1027, label: 0, bag_size: 375
batch 99, loss: 1.3526, instance_loss: 0.5095, weighted_loss: 1.0997, label: 2, bag_size: 110
batch 119, loss: 0.0432, instance_loss: 0.0916, weighted_loss: 0.0578, label: 0, bag_size: 1190
batch 139, loss: 0.6711, instance_loss: 0.4465, weighted_loss: 0.6037, label: 2, bag_size: 3236
batch 159, loss: 0.0479, instance_loss: 0.1195, weighted_loss: 0.0694, label: 4, bag_size: 44
batch 179, loss: 0.1914, instance_loss: 0.2663, weighted_loss: 0.2138, label: 2, bag_size: 913
batch 199, loss: 0.2130, instance_loss: 0.5668, weighted_loss: 0.3191, label: 3, bag_size: 1250
batch 219, loss: 3.0179, instance_loss: 0.6667, weighted_loss: 2.3125, label: 2, bag_size: 511
batch 239, loss: 1.7065, instance_loss: 0.5369, weighted_loss: 1.3556, label: 1, bag_size: 1197
batch 259, loss: 0.0572, instance_loss: 0.2233, weighted_loss: 0.1071, label: 4, bag_size: 636
batch 279, loss: 1.5619, instance_loss: 0.7353, weighted_loss: 1.3139, label: 4, bag_size: 366
batch 299, loss: 0.0242, instance_loss: 0.0727, weighted_loss: 0.0387, label: 0, bag_size: 521
batch 319, loss: 0.5233, instance_loss: 0.3966, weighted_loss: 0.4853, label: 2, bag_size: 2703
batch 339, loss: 0.1311, instance_loss: 0.3451, weighted_loss: 0.1953, label: 0, bag_size: 120
batch 359, loss: 0.1034, instance_loss: 0.3092, weighted_loss: 0.1651, label: 0, bag_size: 155
batch 379, loss: 0.0838, instance_loss: 0.1779, weighted_loss: 0.1120, label: 0, bag_size: 1061
batch 399, loss: 0.0800, instance_loss: 0.1998, weighted_loss: 0.1159, label: 4, bag_size: 211
batch 419, loss: 0.0004, instance_loss: 0.1092, weighted_loss: 0.0330, label: 4, bag_size: 30
batch 439, loss: 0.0082, instance_loss: 0.1669, weighted_loss: 0.0558, label: 3, bag_size: 20
batch 459, loss: 0.0012, instance_loss: 0.1820, weighted_loss: 0.0555, label: 3, bag_size: 20
batch 479, loss: 0.0759, instance_loss: 0.0718, weighted_loss: 0.0747, label: 1, bag_size: 1086
batch 499, loss: 0.0267, instance_loss: 0.1154, weighted_loss: 0.0533, label: 4, bag_size: 143
batch 519, loss: 0.0123, instance_loss: 0.0578, weighted_loss: 0.0260, label: 0, bag_size: 239
batch 539, loss: 0.1798, instance_loss: 0.3641, weighted_loss: 0.2351, label: 1, bag_size: 1014


class 0 clustering acc 0.991651376146789: correct 21618/21800
class 1 clustering acc 0.4298165137614679: correct 1874/4360
Epoch: 16, train_loss: 0.4002, train_clustering_loss:  0.2917, train_error: 0.1284
class 0: acc 0.9133858267716536, correct 116/127
class 1: acc 0.7924528301886793, correct 84/106
class 2: acc 0.7766990291262136, correct 80/103
class 3: acc 0.9803921568627451, correct 100/102
class 4: acc 0.8878504672897196, correct 95/107

Val Set, val_loss: 1.1863, val_error: 0.4400, auc: 0.8518
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0584, instance_loss: 0.4324, weighted_loss: 0.1706, label: 2, bag_size: 750
batch 39, loss: 2.7206, instance_loss: 0.6526, weighted_loss: 2.1002, label: 1, bag_size: 1172
batch 59, loss: 0.1338, instance_loss: 0.2095, weighted_loss: 0.1565, label: 2, bag_size: 499
batch 79, loss: 0.0588, instance_loss: 0.1760, weighted_loss: 0.0940, label: 4, bag_size: 60
batch 99, loss: 0.0031, instance_loss: 0.0593, weighted_loss: 0.0199, label: 4, bag_size: 157
batch 119, loss: 0.0138, instance_loss: 0.0898, weighted_loss: 0.0366, label: 3, bag_size: 35
batch 139, loss: 0.0208, instance_loss: 0.1579, weighted_loss: 0.0619, label: 4, bag_size: 388
batch 159, loss: 0.2455, instance_loss: 0.2440, weighted_loss: 0.2450, label: 2, bag_size: 262
batch 179, loss: 0.0008, instance_loss: 0.0398, weighted_loss: 0.0125, label: 3, bag_size: 56
batch 199, loss: 0.3941, instance_loss: 0.3673, weighted_loss: 0.3861, label: 2, bag_size: 632
batch 219, loss: 0.0308, instance_loss: 0.1338, weighted_loss: 0.0617, label: 3, bag_size: 16
batch 239, loss: 0.0011, instance_loss: 0.1319, weighted_loss: 0.0404, label: 4, bag_size: 192
batch 259, loss: 0.9087, instance_loss: 0.4089, weighted_loss: 0.7587, label: 1, bag_size: 887
batch 279, loss: 0.0242, instance_loss: 0.1488, weighted_loss: 0.0616, label: 3, bag_size: 16
batch 299, loss: 0.0960, instance_loss: 0.1665, weighted_loss: 0.1171, label: 1, bag_size: 1402
batch 319, loss: 0.0102, instance_loss: 0.0795, weighted_loss: 0.0310, label: 3, bag_size: 60
batch 339, loss: 0.0678, instance_loss: 0.1211, weighted_loss: 0.0838, label: 1, bag_size: 682
batch 359, loss: 0.1816, instance_loss: 0.5033, weighted_loss: 0.2782, label: 4, bag_size: 1176
batch 379, loss: 0.3637, instance_loss: 0.3467, weighted_loss: 0.3586, label: 2, bag_size: 399
batch 399, loss: 0.1655, instance_loss: 0.3499, weighted_loss: 0.2208, label: 2, bag_size: 245
batch 419, loss: 0.0023, instance_loss: 0.1333, weighted_loss: 0.0416, label: 3, bag_size: 16
batch 439, loss: 0.0548, instance_loss: 0.3137, weighted_loss: 0.1324, label: 0, bag_size: 118
batch 459, loss: 1.0743, instance_loss: 0.4686, weighted_loss: 0.8926, label: 2, bag_size: 1378
batch 479, loss: 0.5050, instance_loss: 0.4867, weighted_loss: 0.4995, label: 3, bag_size: 849
batch 499, loss: 0.0732, instance_loss: 0.1058, weighted_loss: 0.0830, label: 1, bag_size: 938
batch 519, loss: 0.0851, instance_loss: 0.1155, weighted_loss: 0.0942, label: 0, bag_size: 1255
batch 539, loss: 0.0642, instance_loss: 0.1417, weighted_loss: 0.0874, label: 1, bag_size: 938


class 0 clustering acc 0.9887614678899083: correct 21555/21800
class 1 clustering acc 0.45573394495412844: correct 1987/4360
Epoch: 17, train_loss: 0.4058, train_clustering_loss:  0.2881, train_error: 0.1505
class 0: acc 0.9017857142857143, correct 101/112
class 1: acc 0.7387387387387387, correct 82/111
class 2: acc 0.7549019607843137, correct 77/102
class 3: acc 0.9339622641509434, correct 99/106
class 4: acc 0.9122807017543859, correct 104/114

Val Set, val_loss: 1.0216, val_error: 0.4000, auc: 0.8668
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0095, instance_loss: 0.3812, weighted_loss: 0.1210, label: 3, bag_size: 16
batch 39, loss: 0.4185, instance_loss: 0.3771, weighted_loss: 0.4061, label: 1, bag_size: 343
batch 59, loss: 0.1504, instance_loss: 0.1928, weighted_loss: 0.1631, label: 2, bag_size: 270
batch 79, loss: 0.2889, instance_loss: 0.3995, weighted_loss: 0.3220, label: 2, bag_size: 1416
batch 99, loss: 0.1580, instance_loss: 0.1701, weighted_loss: 0.1616, label: 4, bag_size: 35
batch 119, loss: 0.0276, instance_loss: 0.2088, weighted_loss: 0.0819, label: 4, bag_size: 114
batch 139, loss: 0.2945, instance_loss: 0.3836, weighted_loss: 0.3212, label: 4, bag_size: 1176
batch 159, loss: 0.0237, instance_loss: 0.0932, weighted_loss: 0.0445, label: 4, bag_size: 44
batch 179, loss: 0.4736, instance_loss: 0.2944, weighted_loss: 0.4198, label: 2, bag_size: 408
batch 199, loss: 0.0026, instance_loss: 0.1569, weighted_loss: 0.0489, label: 3, bag_size: 20
batch 219, loss: 0.0072, instance_loss: 0.0607, weighted_loss: 0.0233, label: 0, bag_size: 898
batch 239, loss: 0.2060, instance_loss: 0.2346, weighted_loss: 0.2146, label: 1, bag_size: 1127
batch 259, loss: 0.5401, instance_loss: 0.5540, weighted_loss: 0.5443, label: 2, bag_size: 1218
batch 279, loss: 0.1811, instance_loss: 0.5768, weighted_loss: 0.2998, label: 0, bag_size: 129
batch 299, loss: 1.6327, instance_loss: 0.5820, weighted_loss: 1.3175, label: 1, bag_size: 917
batch 319, loss: 0.8839, instance_loss: 0.5892, weighted_loss: 0.7955, label: 4, bag_size: 542
batch 339, loss: 0.6407, instance_loss: 0.3981, weighted_loss: 0.5679, label: 1, bag_size: 887
batch 359, loss: 0.7292, instance_loss: 0.4499, weighted_loss: 0.6454, label: 4, bag_size: 297
batch 379, loss: 0.4560, instance_loss: 0.3460, weighted_loss: 0.4230, label: 1, bag_size: 898
batch 399, loss: 0.4812, instance_loss: 0.2794, weighted_loss: 0.4207, label: 1, bag_size: 598
batch 419, loss: 0.5580, instance_loss: 0.2714, weighted_loss: 0.4720, label: 2, bag_size: 1404
batch 439, loss: 0.0011, instance_loss: 0.2641, weighted_loss: 0.0800, label: 3, bag_size: 18
batch 459, loss: 0.0505, instance_loss: 0.2850, weighted_loss: 0.1209, label: 2, bag_size: 373
batch 479, loss: 2.1080, instance_loss: 0.6666, weighted_loss: 1.6756, label: 1, bag_size: 875
batch 499, loss: 0.0007, instance_loss: 0.0543, weighted_loss: 0.0168, label: 3, bag_size: 43
batch 519, loss: 0.0148, instance_loss: 0.1479, weighted_loss: 0.0547, label: 3, bag_size: 18
batch 539, loss: 0.4958, instance_loss: 0.3217, weighted_loss: 0.4436, label: 0, bag_size: 912


class 0 clustering acc 0.9878899082568807: correct 21536/21800
class 1 clustering acc 0.47660550458715595: correct 2078/4360
Epoch: 18, train_loss: 0.3642, train_clustering_loss:  0.2796, train_error: 0.1248
class 0: acc 0.8773584905660378, correct 93/106
class 1: acc 0.6931818181818182, correct 61/88
class 2: acc 0.8376068376068376, correct 98/117
class 3: acc 0.9622641509433962, correct 102/106
class 4: acc 0.9609375, correct 123/128

Val Set, val_loss: 1.1026, val_error: 0.4600, auc: 0.8642
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.8704, instance_loss: 0.6797, weighted_loss: 1.5132, label: 1, bag_size: 786
batch 39, loss: 0.0050, instance_loss: 0.0568, weighted_loss: 0.0205, label: 4, bag_size: 168
batch 59, loss: 0.3101, instance_loss: 0.2953, weighted_loss: 0.3057, label: 2, bag_size: 682
batch 79, loss: 0.0091, instance_loss: 0.1643, weighted_loss: 0.0557, label: 4, bag_size: 40
batch 99, loss: 0.0032, instance_loss: 0.1178, weighted_loss: 0.0376, label: 3, bag_size: 21
batch 119, loss: 0.1013, instance_loss: 0.2433, weighted_loss: 0.1439, label: 3, bag_size: 1291
batch 139, loss: 0.2413, instance_loss: 0.3338, weighted_loss: 0.2691, label: 0, bag_size: 478
batch 159, loss: 0.2917, instance_loss: 0.2485, weighted_loss: 0.2788, label: 2, bag_size: 399
batch 179, loss: 1.6778, instance_loss: 0.7739, weighted_loss: 1.4066, label: 2, bag_size: 518
batch 199, loss: 0.0058, instance_loss: 0.0431, weighted_loss: 0.0170, label: 3, bag_size: 143
batch 219, loss: 0.2032, instance_loss: 0.3344, weighted_loss: 0.2425, label: 1, bag_size: 898
batch 239, loss: 0.2004, instance_loss: 0.1268, weighted_loss: 0.1784, label: 4, bag_size: 764
batch 259, loss: 0.0515, instance_loss: 0.1995, weighted_loss: 0.0959, label: 2, bag_size: 461
batch 279, loss: 0.2224, instance_loss: 0.2997, weighted_loss: 0.2456, label: 0, bag_size: 255
batch 299, loss: 0.4240, instance_loss: 0.4412, weighted_loss: 0.4292, label: 2, bag_size: 508
batch 319, loss: 0.2932, instance_loss: 0.3795, weighted_loss: 0.3191, label: 1, bag_size: 1273
batch 339, loss: 0.3232, instance_loss: 0.2726, weighted_loss: 0.3080, label: 0, bag_size: 350
batch 359, loss: 0.0089, instance_loss: 0.1209, weighted_loss: 0.0425, label: 3, bag_size: 56
batch 379, loss: 0.0113, instance_loss: 0.0627, weighted_loss: 0.0267, label: 0, bag_size: 239
batch 399, loss: 0.4268, instance_loss: 0.4229, weighted_loss: 0.4256, label: 4, bag_size: 928
batch 419, loss: 0.6175, instance_loss: 0.4023, weighted_loss: 0.5529, label: 2, bag_size: 259
batch 439, loss: 1.0827, instance_loss: 0.5624, weighted_loss: 0.9266, label: 1, bag_size: 786
batch 459, loss: 0.0181, instance_loss: 0.1604, weighted_loss: 0.0608, label: 3, bag_size: 21
batch 479, loss: 1.3936, instance_loss: 0.4962, weighted_loss: 1.1244, label: 0, bag_size: 801
batch 499, loss: 0.0004, instance_loss: 0.0542, weighted_loss: 0.0165, label: 3, bag_size: 24
batch 519, loss: 0.1033, instance_loss: 0.2479, weighted_loss: 0.1467, label: 4, bag_size: 1474
batch 539, loss: 0.1237, instance_loss: 0.3015, weighted_loss: 0.1770, label: 2, bag_size: 400


class 0 clustering acc 0.988165137614679: correct 21542/21800
class 1 clustering acc 0.43830275229357796: correct 1911/4360
Epoch: 19, train_loss: 0.3647, train_clustering_loss:  0.2910, train_error: 0.1266
class 0: acc 0.9484536082474226, correct 92/97
class 1: acc 0.7410714285714286, correct 83/112
class 2: acc 0.8151260504201681, correct 97/119
class 3: acc 0.9285714285714286, correct 104/112
class 4: acc 0.9523809523809523, correct 100/105

Val Set, val_loss: 1.1236, val_error: 0.4600, auc: 0.8649
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4780, instance_loss: 0.3007, weighted_loss: 0.4248, label: 2, bag_size: 1514
batch 39, loss: 0.0345, instance_loss: 0.0507, weighted_loss: 0.0393, label: 1, bag_size: 1086
batch 59, loss: 0.6539, instance_loss: 0.3617, weighted_loss: 0.5662, label: 1, bag_size: 747
batch 79, loss: 0.5857, instance_loss: 0.3301, weighted_loss: 0.5090, label: 0, bag_size: 912
batch 99, loss: 0.0666, instance_loss: 0.3790, weighted_loss: 0.1603, label: 0, bag_size: 122
batch 119, loss: 0.1216, instance_loss: 0.1634, weighted_loss: 0.1341, label: 0, bag_size: 350
batch 139, loss: 0.0489, instance_loss: 0.1490, weighted_loss: 0.0789, label: 0, bag_size: 1301
batch 159, loss: 0.4039, instance_loss: 0.3509, weighted_loss: 0.3880, label: 2, bag_size: 1215
batch 179, loss: 0.0168, instance_loss: 0.1084, weighted_loss: 0.0443, label: 3, bag_size: 821
batch 199, loss: 0.0009, instance_loss: 0.0945, weighted_loss: 0.0290, label: 4, bag_size: 104
batch 219, loss: 3.6409, instance_loss: 1.4183, weighted_loss: 2.9741, label: 2, bag_size: 1108
batch 239, loss: 0.1800, instance_loss: 0.2217, weighted_loss: 0.1925, label: 0, bag_size: 381
batch 259, loss: 0.0082, instance_loss: 0.0675, weighted_loss: 0.0260, label: 3, bag_size: 75
batch 279, loss: 0.0163, instance_loss: 0.1181, weighted_loss: 0.0468, label: 3, bag_size: 20
batch 299, loss: 0.0140, instance_loss: 0.0801, weighted_loss: 0.0338, label: 4, bag_size: 143
batch 319, loss: 1.0903, instance_loss: 0.4482, weighted_loss: 0.8977, label: 1, bag_size: 343
batch 339, loss: 0.5227, instance_loss: 0.2986, weighted_loss: 0.4555, label: 1, bag_size: 913
batch 359, loss: 0.2786, instance_loss: 0.2409, weighted_loss: 0.2673, label: 4, bag_size: 19
batch 379, loss: 0.0453, instance_loss: 0.3003, weighted_loss: 0.1218, label: 3, bag_size: 15
batch 399, loss: 0.0022, instance_loss: 0.1781, weighted_loss: 0.0550, label: 3, bag_size: 20
batch 419, loss: 0.0037, instance_loss: 0.0824, weighted_loss: 0.0273, label: 4, bag_size: 143
batch 439, loss: 0.3011, instance_loss: 0.1521, weighted_loss: 0.2564, label: 1, bag_size: 356
batch 459, loss: 0.2731, instance_loss: 0.4928, weighted_loss: 0.3390, label: 1, bag_size: 1197
batch 479, loss: 0.0060, instance_loss: 0.1049, weighted_loss: 0.0357, label: 3, bag_size: 27
batch 499, loss: 0.9181, instance_loss: 0.3771, weighted_loss: 0.7558, label: 2, bag_size: 1133
batch 519, loss: 0.4902, instance_loss: 0.4630, weighted_loss: 0.4821, label: 1, bag_size: 1273
batch 539, loss: 1.0856, instance_loss: 0.4818, weighted_loss: 0.9045, label: 2, bag_size: 720


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.43761467889908257: correct 1908/4360
Epoch: 20, train_loss: 0.3724, train_clustering_loss:  0.2948, train_error: 0.1358
class 0: acc 0.9426229508196722, correct 115/122
class 1: acc 0.7523809523809524, correct 79/105
class 2: acc 0.7572815533980582, correct 78/103
class 3: acc 0.9391304347826087, correct 108/115
class 4: acc 0.91, correct 91/100

Val Set, val_loss: 1.0076, val_error: 0.3800, auc: 0.8614
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.305: correct 122/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.3165, instance_loss: 0.2888, weighted_loss: 0.3082, label: 2, bag_size: 471
batch 39, loss: 0.4837, instance_loss: 0.4631, weighted_loss: 0.4775, label: 1, bag_size: 474
batch 59, loss: 0.4764, instance_loss: 0.4887, weighted_loss: 0.4801, label: 2, bag_size: 323
batch 79, loss: 0.0321, instance_loss: 0.1241, weighted_loss: 0.0597, label: 0, bag_size: 1196
batch 99, loss: 1.5147, instance_loss: 0.6226, weighted_loss: 1.2471, label: 2, bag_size: 986
batch 119, loss: 0.0024, instance_loss: 0.0522, weighted_loss: 0.0174, label: 4, bag_size: 101
batch 139, loss: 0.5862, instance_loss: 0.6092, weighted_loss: 0.5931, label: 0, bag_size: 109
batch 159, loss: 0.2737, instance_loss: 0.6527, weighted_loss: 0.3874, label: 3, bag_size: 317
batch 179, loss: 0.5395, instance_loss: 0.5709, weighted_loss: 0.5489, label: 1, bag_size: 1197
batch 199, loss: 0.2701, instance_loss: 0.5255, weighted_loss: 0.3467, label: 2, bag_size: 518
batch 219, loss: 1.4111, instance_loss: 0.5923, weighted_loss: 1.1654, label: 1, bag_size: 868
batch 239, loss: 0.0060, instance_loss: 0.0763, weighted_loss: 0.0271, label: 4, bag_size: 764
batch 259, loss: 0.9320, instance_loss: 0.3602, weighted_loss: 0.7605, label: 2, bag_size: 1235
batch 279, loss: 0.0261, instance_loss: 0.1770, weighted_loss: 0.0714, label: 4, bag_size: 636
batch 299, loss: 0.0036, instance_loss: 0.1861, weighted_loss: 0.0584, label: 4, bag_size: 20
batch 319, loss: 0.1570, instance_loss: 0.3124, weighted_loss: 0.2036, label: 1, bag_size: 1014
batch 339, loss: 0.0159, instance_loss: 0.1911, weighted_loss: 0.0685, label: 2, bag_size: 461
batch 359, loss: 0.0503, instance_loss: 0.3315, weighted_loss: 0.1347, label: 0, bag_size: 118
batch 379, loss: 0.1141, instance_loss: 0.1742, weighted_loss: 0.1321, label: 2, bag_size: 455
batch 399, loss: 0.5486, instance_loss: 0.4480, weighted_loss: 0.5184, label: 2, bag_size: 508
batch 419, loss: 0.2409, instance_loss: 0.4406, weighted_loss: 0.3008, label: 2, bag_size: 411
batch 439, loss: 0.0410, instance_loss: 0.0831, weighted_loss: 0.0537, label: 0, bag_size: 1190
batch 459, loss: 0.7885, instance_loss: 0.4075, weighted_loss: 0.6742, label: 2, bag_size: 941
batch 479, loss: 0.1462, instance_loss: 0.2053, weighted_loss: 0.1639, label: 1, bag_size: 534
batch 499, loss: 0.0033, instance_loss: 0.1319, weighted_loss: 0.0419, label: 4, bag_size: 35
batch 519, loss: 1.0781, instance_loss: 0.6660, weighted_loss: 0.9545, label: 1, bag_size: 1799
batch 539, loss: 0.0222, instance_loss: 0.3724, weighted_loss: 0.1273, label: 3, bag_size: 1253


class 0 clustering acc 0.9878440366972477: correct 21535/21800
class 1 clustering acc 0.4635321100917431: correct 2021/4360
Epoch: 21, train_loss: 0.2808, train_clustering_loss:  0.2798, train_error: 0.0917
class 0: acc 0.963963963963964, correct 107/111
class 1: acc 0.8041237113402062, correct 78/97
class 2: acc 0.8416666666666667, correct 101/120
class 3: acc 0.9646017699115044, correct 109/113
class 4: acc 0.9615384615384616, correct 100/104

Val Set, val_loss: 1.0452, val_error: 0.4000, auc: 0.8719
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.3025: correct 121/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3447, instance_loss: 0.1880, weighted_loss: 0.2977, label: 2, bag_size: 941
batch 39, loss: 0.0068, instance_loss: 0.1330, weighted_loss: 0.0447, label: 3, bag_size: 94
batch 59, loss: 0.0241, instance_loss: 0.0830, weighted_loss: 0.0417, label: 3, bag_size: 29
batch 79, loss: 0.0604, instance_loss: 0.2456, weighted_loss: 0.1159, label: 3, bag_size: 849
batch 99, loss: 0.0245, instance_loss: 0.1792, weighted_loss: 0.0709, label: 3, bag_size: 20
batch 119, loss: 1.3350, instance_loss: 0.4454, weighted_loss: 1.0681, label: 2, bag_size: 272
batch 139, loss: 0.0345, instance_loss: 0.3387, weighted_loss: 0.1257, label: 0, bag_size: 176
batch 159, loss: 0.0044, instance_loss: 0.1007, weighted_loss: 0.0333, label: 3, bag_size: 75
batch 179, loss: 0.0123, instance_loss: 0.0535, weighted_loss: 0.0246, label: 4, bag_size: 160
batch 199, loss: 0.2915, instance_loss: 0.3274, weighted_loss: 0.3023, label: 0, bag_size: 912
batch 219, loss: 0.2769, instance_loss: 0.3002, weighted_loss: 0.2839, label: 3, bag_size: 1019
batch 239, loss: 0.6938, instance_loss: 0.5816, weighted_loss: 0.6602, label: 0, bag_size: 1065
batch 259, loss: 0.0174, instance_loss: 0.0749, weighted_loss: 0.0346, label: 4, bag_size: 137
batch 279, loss: 0.0800, instance_loss: 0.2127, weighted_loss: 0.1198, label: 0, bag_size: 736
batch 299, loss: 0.3036, instance_loss: 0.5762, weighted_loss: 0.3854, label: 4, bag_size: 366
batch 319, loss: 0.0396, instance_loss: 0.2669, weighted_loss: 0.1078, label: 2, bag_size: 784
batch 339, loss: 1.4207, instance_loss: 0.6373, weighted_loss: 1.1857, label: 3, bag_size: 281
batch 359, loss: 0.0757, instance_loss: 0.1224, weighted_loss: 0.0898, label: 1, bag_size: 346
batch 379, loss: 0.0217, instance_loss: 0.1266, weighted_loss: 0.0532, label: 1, bag_size: 697
batch 399, loss: 0.1607, instance_loss: 0.5023, weighted_loss: 0.2632, label: 2, bag_size: 324
batch 419, loss: 0.1578, instance_loss: 0.2353, weighted_loss: 0.1811, label: 0, bag_size: 800
batch 439, loss: 0.1557, instance_loss: 0.1552, weighted_loss: 0.1555, label: 1, bag_size: 869
batch 459, loss: 0.0025, instance_loss: 0.0802, weighted_loss: 0.0258, label: 4, bag_size: 137
batch 479, loss: 1.0719, instance_loss: 0.4112, weighted_loss: 0.8737, label: 2, bag_size: 806
batch 499, loss: 0.0652, instance_loss: 0.1881, weighted_loss: 0.1021, label: 0, bag_size: 1046
batch 519, loss: 0.0984, instance_loss: 0.1181, weighted_loss: 0.1043, label: 0, bag_size: 515
batch 539, loss: 0.5058, instance_loss: 0.5638, weighted_loss: 0.5232, label: 1, bag_size: 838


class 0 clustering acc 0.9872935779816514: correct 21523/21800
class 1 clustering acc 0.4724770642201835: correct 2060/4360
Epoch: 22, train_loss: 0.3830, train_clustering_loss:  0.2886, train_error: 0.1431
class 0: acc 0.8869565217391304, correct 102/115
class 1: acc 0.7368421052631579, correct 84/114
class 2: acc 0.7982456140350878, correct 91/114
class 3: acc 0.9484536082474226, correct 92/97
class 4: acc 0.9333333333333333, correct 98/105

Val Set, val_loss: 1.2265, val_error: 0.4600, auc: 0.8661
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.29: correct 116/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0054, instance_loss: 0.2515, weighted_loss: 0.0792, label: 3, bag_size: 16
batch 39, loss: 0.0145, instance_loss: 0.0827, weighted_loss: 0.0350, label: 3, bag_size: 27
batch 59, loss: 0.3564, instance_loss: 0.3037, weighted_loss: 0.3406, label: 1, bag_size: 838
batch 79, loss: 0.0015, instance_loss: 0.0598, weighted_loss: 0.0190, label: 4, bag_size: 44
batch 99, loss: 0.3994, instance_loss: 0.4811, weighted_loss: 0.4239, label: 1, bag_size: 860
batch 119, loss: 2.5741, instance_loss: 0.4303, weighted_loss: 1.9309, label: 0, bag_size: 630
batch 139, loss: 0.0045, instance_loss: 0.0873, weighted_loss: 0.0293, label: 3, bag_size: 20
batch 159, loss: 0.0583, instance_loss: 0.0966, weighted_loss: 0.0698, label: 3, bag_size: 405
batch 179, loss: 0.1890, instance_loss: 0.3875, weighted_loss: 0.2486, label: 4, bag_size: 1278
batch 199, loss: 0.1648, instance_loss: 0.5297, weighted_loss: 0.2743, label: 1, bag_size: 778
batch 219, loss: 0.6394, instance_loss: 0.8546, weighted_loss: 0.7039, label: 4, bag_size: 210
batch 239, loss: 0.0435, instance_loss: 0.3743, weighted_loss: 0.1427, label: 0, bag_size: 122
batch 259, loss: 0.4074, instance_loss: 0.3897, weighted_loss: 0.4021, label: 2, bag_size: 508
batch 279, loss: 0.0157, instance_loss: 0.0918, weighted_loss: 0.0385, label: 0, bag_size: 933
batch 299, loss: 0.0045, instance_loss: 0.2073, weighted_loss: 0.0653, label: 3, bag_size: 20
batch 319, loss: 0.4250, instance_loss: 0.8136, weighted_loss: 0.5416, label: 1, bag_size: 936
batch 339, loss: 0.2455, instance_loss: 0.5059, weighted_loss: 0.3236, label: 0, bag_size: 163
batch 359, loss: 0.8747, instance_loss: 0.6453, weighted_loss: 0.8059, label: 0, bag_size: 423
batch 379, loss: 0.0253, instance_loss: 0.6297, weighted_loss: 0.2066, label: 4, bag_size: 663
batch 399, loss: 0.2652, instance_loss: 0.2840, weighted_loss: 0.2708, label: 2, bag_size: 1259
batch 419, loss: 0.2421, instance_loss: 0.1824, weighted_loss: 0.2242, label: 0, bag_size: 912
batch 439, loss: 0.0035, instance_loss: 0.0333, weighted_loss: 0.0124, label: 0, bag_size: 898
batch 459, loss: 0.0076, instance_loss: 0.3518, weighted_loss: 0.1109, label: 4, bag_size: 947
batch 479, loss: 0.0044, instance_loss: 0.3167, weighted_loss: 0.0981, label: 4, bag_size: 20
batch 499, loss: 0.0850, instance_loss: 0.1510, weighted_loss: 0.1048, label: 0, bag_size: 759
batch 519, loss: 0.0832, instance_loss: 0.2163, weighted_loss: 0.1231, label: 4, bag_size: 137
batch 539, loss: 0.0163, instance_loss: 0.1723, weighted_loss: 0.0631, label: 4, bag_size: 130


class 0 clustering acc 0.9873853211009175: correct 21525/21800
class 1 clustering acc 0.4628440366972477: correct 2018/4360
Epoch: 23, train_loss: 0.2949, train_clustering_loss:  0.2859, train_error: 0.0972
class 0: acc 0.9010989010989011, correct 82/91
class 1: acc 0.8230088495575221, correct 93/113
class 2: acc 0.8692307692307693, correct 113/130
class 3: acc 0.9693877551020408, correct 95/98
class 4: acc 0.9646017699115044, correct 109/113

Val Set, val_loss: 1.0021, val_error: 0.4000, auc: 0.8699
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.3525: correct 141/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0018, instance_loss: 0.0468, weighted_loss: 0.0153, label: 4, bag_size: 78
batch 39, loss: 0.0325, instance_loss: 0.1728, weighted_loss: 0.0746, label: 4, bag_size: 20
batch 59, loss: 0.1048, instance_loss: 0.3683, weighted_loss: 0.1838, label: 0, bag_size: 1135
batch 79, loss: 0.5463, instance_loss: 0.3269, weighted_loss: 0.4805, label: 2, bag_size: 571
batch 99, loss: 0.0266, instance_loss: 0.2103, weighted_loss: 0.0817, label: 1, bag_size: 318
batch 119, loss: 0.2648, instance_loss: 0.4655, weighted_loss: 0.3250, label: 2, bag_size: 411
batch 139, loss: 0.1203, instance_loss: 0.4635, weighted_loss: 0.2233, label: 1, bag_size: 319
batch 159, loss: 0.0823, instance_loss: 0.5486, weighted_loss: 0.2222, label: 2, bag_size: 916
batch 179, loss: 0.0156, instance_loss: 0.1124, weighted_loss: 0.0446, label: 3, bag_size: 18
batch 199, loss: 0.1463, instance_loss: 0.5251, weighted_loss: 0.2599, label: 2, bag_size: 518
batch 219, loss: 0.0014, instance_loss: 0.0320, weighted_loss: 0.0106, label: 3, bag_size: 48
batch 239, loss: 0.0375, instance_loss: 0.0794, weighted_loss: 0.0500, label: 0, bag_size: 1034
batch 259, loss: 0.0194, instance_loss: 0.1177, weighted_loss: 0.0489, label: 4, bag_size: 123
batch 279, loss: 0.1908, instance_loss: 0.3349, weighted_loss: 0.2340, label: 2, bag_size: 1164
batch 299, loss: 0.0028, instance_loss: 0.0885, weighted_loss: 0.0285, label: 4, bag_size: 104
batch 319, loss: 0.7962, instance_loss: 0.8474, weighted_loss: 0.8115, label: 3, bag_size: 283
batch 339, loss: 0.0054, instance_loss: 0.0659, weighted_loss: 0.0235, label: 4, bag_size: 162
batch 359, loss: 0.0525, instance_loss: 0.1814, weighted_loss: 0.0912, label: 0, bag_size: 1135
batch 379, loss: 0.0005, instance_loss: 0.0624, weighted_loss: 0.0190, label: 3, bag_size: 105
batch 399, loss: 0.0051, instance_loss: 0.0357, weighted_loss: 0.0143, label: 3, bag_size: 56
batch 419, loss: 0.1108, instance_loss: 0.4964, weighted_loss: 0.2265, label: 4, bag_size: 656
batch 439, loss: 0.0530, instance_loss: 0.1900, weighted_loss: 0.0941, label: 2, bag_size: 247
batch 459, loss: 0.0731, instance_loss: 0.2639, weighted_loss: 0.1303, label: 4, bag_size: 1278
batch 479, loss: 0.0274, instance_loss: 0.1981, weighted_loss: 0.0786, label: 4, bag_size: 24
batch 499, loss: 0.0795, instance_loss: 0.4342, weighted_loss: 0.1859, label: 1, bag_size: 818
batch 519, loss: 0.0584, instance_loss: 0.2106, weighted_loss: 0.1041, label: 2, bag_size: 286
batch 539, loss: 0.0047, instance_loss: 0.1580, weighted_loss: 0.0507, label: 1, bag_size: 1127


class 0 clustering acc 0.9872477064220183: correct 21522/21800
class 1 clustering acc 0.4596330275229358: correct 2004/4360
Epoch: 24, train_loss: 0.3007, train_clustering_loss:  0.2934, train_error: 0.1101
class 0: acc 0.9186991869918699, correct 113/123
class 1: acc 0.8285714285714286, correct 87/105
class 2: acc 0.8, correct 88/110
class 3: acc 0.954954954954955, correct 106/111
class 4: acc 0.9479166666666666, correct 91/96

Val Set, val_loss: 1.1076, val_error: 0.4200, auc: 0.8749
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.355: correct 142/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0371, instance_loss: 0.1131, weighted_loss: 0.0599, label: 0, bag_size: 1517
batch 39, loss: 0.0004, instance_loss: 0.2363, weighted_loss: 0.0711, label: 4, bag_size: 38
batch 59, loss: 0.0041, instance_loss: 0.2526, weighted_loss: 0.0787, label: 4, bag_size: 19
batch 79, loss: 1.5002, instance_loss: 0.3339, weighted_loss: 1.1503, label: 2, bag_size: 1180
batch 99, loss: 0.9944, instance_loss: 0.5997, weighted_loss: 0.8760, label: 1, bag_size: 868
batch 119, loss: 0.5542, instance_loss: 0.4722, weighted_loss: 0.5296, label: 2, bag_size: 396
batch 139, loss: 0.0051, instance_loss: 0.2252, weighted_loss: 0.0711, label: 4, bag_size: 94
batch 159, loss: 0.0026, instance_loss: 0.3011, weighted_loss: 0.0921, label: 3, bag_size: 24
batch 179, loss: 3.0177, instance_loss: 0.6977, weighted_loss: 2.3217, label: 1, bag_size: 448
batch 199, loss: 0.0356, instance_loss: 0.1465, weighted_loss: 0.0689, label: 0, bag_size: 921
batch 219, loss: 0.0361, instance_loss: 0.1922, weighted_loss: 0.0829, label: 2, bag_size: 636
batch 239, loss: 0.1411, instance_loss: 0.3520, weighted_loss: 0.2044, label: 1, bag_size: 1014
batch 259, loss: 0.0067, instance_loss: 0.0401, weighted_loss: 0.0167, label: 0, bag_size: 521
batch 279, loss: 0.0001, instance_loss: 0.0736, weighted_loss: 0.0221, label: 4, bag_size: 150
batch 299, loss: 0.0678, instance_loss: 0.1282, weighted_loss: 0.0859, label: 1, bag_size: 938
batch 319, loss: 1.0263, instance_loss: 0.5520, weighted_loss: 0.8840, label: 2, bag_size: 629
batch 339, loss: 0.0044, instance_loss: 0.0305, weighted_loss: 0.0122, label: 3, bag_size: 54
batch 359, loss: 0.4518, instance_loss: 0.4947, weighted_loss: 0.4646, label: 2, bag_size: 247
batch 379, loss: 0.0133, instance_loss: 0.0929, weighted_loss: 0.0372, label: 3, bag_size: 1172
batch 399, loss: 0.0688, instance_loss: 0.1538, weighted_loss: 0.0943, label: 0, bag_size: 542
batch 419, loss: 0.0789, instance_loss: 0.2100, weighted_loss: 0.1182, label: 4, bag_size: 1121
batch 439, loss: 0.2382, instance_loss: 0.2737, weighted_loss: 0.2489, label: 2, bag_size: 1150
batch 459, loss: 0.1319, instance_loss: 0.3571, weighted_loss: 0.1995, label: 3, bag_size: 697
batch 479, loss: 1.9508, instance_loss: 0.5693, weighted_loss: 1.5364, label: 0, bag_size: 245
batch 499, loss: 0.0108, instance_loss: 0.0563, weighted_loss: 0.0244, label: 0, bag_size: 1143
batch 519, loss: 0.0030, instance_loss: 0.0627, weighted_loss: 0.0209, label: 3, bag_size: 55
batch 539, loss: 0.0049, instance_loss: 0.0489, weighted_loss: 0.0181, label: 0, bag_size: 360


class 0 clustering acc 0.9878899082568807: correct 21536/21800
class 1 clustering acc 0.506651376146789: correct 2209/4360
Epoch: 25, train_loss: 0.2654, train_clustering_loss:  0.2686, train_error: 0.0972
class 0: acc 0.9368421052631579, correct 89/95
class 1: acc 0.7961165048543689, correct 82/103
class 2: acc 0.8, correct 80/100
class 3: acc 0.975, correct 117/120
class 4: acc 0.9763779527559056, correct 124/127

Val Set, val_loss: 1.1178, val_error: 0.4200, auc: 0.8681
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.345: correct 138/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2122, instance_loss: 0.2700, weighted_loss: 0.2295, label: 2, bag_size: 357
batch 39, loss: 0.3327, instance_loss: 0.4414, weighted_loss: 0.3654, label: 1, bag_size: 1080
batch 59, loss: 0.0861, instance_loss: 0.3243, weighted_loss: 0.1575, label: 2, bag_size: 1410
batch 79, loss: 0.0074, instance_loss: 0.0544, weighted_loss: 0.0215, label: 0, bag_size: 239
batch 99, loss: 0.4954, instance_loss: 0.3955, weighted_loss: 0.4654, label: 0, bag_size: 350
batch 119, loss: 0.0509, instance_loss: 0.1630, weighted_loss: 0.0845, label: 0, bag_size: 1872
batch 139, loss: 0.0573, instance_loss: 0.1713, weighted_loss: 0.0915, label: 1, bag_size: 790
batch 159, loss: 0.1201, instance_loss: 0.1590, weighted_loss: 0.1318, label: 2, bag_size: 455
batch 179, loss: 0.0654, instance_loss: 0.1986, weighted_loss: 0.1054, label: 2, bag_size: 2081
batch 199, loss: 0.0087, instance_loss: 0.0403, weighted_loss: 0.0182, label: 0, bag_size: 616
batch 219, loss: 0.0016, instance_loss: 0.0573, weighted_loss: 0.0183, label: 3, bag_size: 54
batch 239, loss: 0.2407, instance_loss: 0.4442, weighted_loss: 0.3017, label: 4, bag_size: 817
batch 259, loss: 0.1395, instance_loss: 0.2284, weighted_loss: 0.1662, label: 0, bag_size: 800
batch 279, loss: 0.8849, instance_loss: 0.5164, weighted_loss: 0.7744, label: 0, bag_size: 1065
batch 299, loss: 0.0016, instance_loss: 0.0555, weighted_loss: 0.0177, label: 3, bag_size: 50
batch 319, loss: 0.0541, instance_loss: 0.2967, weighted_loss: 0.1269, label: 2, bag_size: 292
batch 339, loss: 0.0074, instance_loss: 0.0237, weighted_loss: 0.0123, label: 0, bag_size: 616
batch 359, loss: 0.0003, instance_loss: 0.1093, weighted_loss: 0.0330, label: 3, bag_size: 34
batch 379, loss: 0.0002, instance_loss: 0.2287, weighted_loss: 0.0688, label: 4, bag_size: 24
batch 399, loss: 0.3733, instance_loss: 0.2596, weighted_loss: 0.3392, label: 2, bag_size: 272
batch 419, loss: 0.4375, instance_loss: 0.4698, weighted_loss: 0.4472, label: 3, bag_size: 200
batch 439, loss: 0.0001, instance_loss: 0.3187, weighted_loss: 0.0957, label: 4, bag_size: 1002
batch 459, loss: 0.2151, instance_loss: 0.2455, weighted_loss: 0.2242, label: 0, bag_size: 413
batch 479, loss: 0.0537, instance_loss: 0.1705, weighted_loss: 0.0887, label: 0, bag_size: 630
batch 499, loss: 0.1374, instance_loss: 0.2771, weighted_loss: 0.1793, label: 2, bag_size: 571
batch 519, loss: 0.0037, instance_loss: 0.2659, weighted_loss: 0.0824, label: 4, bag_size: 1002
batch 539, loss: 0.5360, instance_loss: 0.2573, weighted_loss: 0.4524, label: 1, bag_size: 356


class 0 clustering acc 0.9886238532110092: correct 21552/21800
class 1 clustering acc 0.4988532110091743: correct 2175/4360
Epoch: 26, train_loss: 0.2718, train_clustering_loss:  0.2733, train_error: 0.0844
class 0: acc 0.9401709401709402, correct 110/117
class 1: acc 0.8387096774193549, correct 78/93
class 2: acc 0.8317757009345794, correct 89/107
class 3: acc 0.9545454545454546, correct 105/110
class 4: acc 0.9915254237288136, correct 117/118

Val Set, val_loss: 1.1488, val_error: 0.4200, auc: 0.8567
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.3025: correct 121/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1320, instance_loss: 0.4972, weighted_loss: 0.2416, label: 0, bag_size: 552
batch 39, loss: 0.1477, instance_loss: 0.1965, weighted_loss: 0.1623, label: 1, bag_size: 682
batch 59, loss: 0.0876, instance_loss: 0.1716, weighted_loss: 0.1128, label: 0, bag_size: 542
batch 79, loss: 0.0011, instance_loss: 0.0272, weighted_loss: 0.0089, label: 3, bag_size: 43
batch 99, loss: 0.0002, instance_loss: 0.0761, weighted_loss: 0.0229, label: 4, bag_size: 150
batch 119, loss: 1.0530, instance_loss: 0.6255, weighted_loss: 0.9247, label: 1, bag_size: 875
batch 139, loss: 0.0598, instance_loss: 0.1310, weighted_loss: 0.0812, label: 1, bag_size: 869
batch 159, loss: 0.3008, instance_loss: 0.3248, weighted_loss: 0.3080, label: 2, bag_size: 682
batch 179, loss: 0.4961, instance_loss: 0.5560, weighted_loss: 0.5141, label: 0, bag_size: 1065
batch 199, loss: 0.0037, instance_loss: 0.3731, weighted_loss: 0.1145, label: 3, bag_size: 16
batch 219, loss: 0.1517, instance_loss: 0.2051, weighted_loss: 0.1678, label: 1, bag_size: 858
batch 239, loss: 0.0027, instance_loss: 0.1897, weighted_loss: 0.0588, label: 3, bag_size: 18
batch 259, loss: 0.1020, instance_loss: 0.1573, weighted_loss: 0.1186, label: 2, bag_size: 1039
batch 279, loss: 0.1953, instance_loss: 0.2889, weighted_loss: 0.2234, label: 1, bag_size: 913
batch 299, loss: 0.0005, instance_loss: 0.1049, weighted_loss: 0.0318, label: 3, bag_size: 32
batch 319, loss: 0.1132, instance_loss: 0.1049, weighted_loss: 0.1107, label: 0, bag_size: 515
batch 339, loss: 0.3144, instance_loss: 0.3259, weighted_loss: 0.3178, label: 2, bag_size: 1400
batch 359, loss: 0.1347, instance_loss: 0.2256, weighted_loss: 0.1620, label: 2, bag_size: 3236
batch 379, loss: 0.0906, instance_loss: 0.3326, weighted_loss: 0.1632, label: 3, bag_size: 791
batch 399, loss: 0.0164, instance_loss: 0.1093, weighted_loss: 0.0443, label: 2, bag_size: 848
batch 419, loss: 0.4210, instance_loss: 0.2903, weighted_loss: 0.3818, label: 0, bag_size: 1061
batch 439, loss: 0.1024, instance_loss: 0.1702, weighted_loss: 0.1227, label: 2, bag_size: 1164
batch 459, loss: 0.7748, instance_loss: 0.4684, weighted_loss: 0.6829, label: 1, bag_size: 875
batch 479, loss: 0.0430, instance_loss: 0.2439, weighted_loss: 0.1032, label: 3, bag_size: 18
batch 499, loss: 0.5682, instance_loss: 0.4164, weighted_loss: 0.5227, label: 1, bag_size: 1724
batch 519, loss: 0.0004, instance_loss: 0.0562, weighted_loss: 0.0171, label: 4, bag_size: 94
batch 539, loss: 1.2959, instance_loss: 0.6831, weighted_loss: 1.1121, label: 2, bag_size: 720


class 0 clustering acc 0.9867431192660551: correct 21511/21800
class 1 clustering acc 0.49243119266055047: correct 2147/4360
Epoch: 27, train_loss: 0.2736, train_clustering_loss:  0.2809, train_error: 0.0844
class 0: acc 0.9345794392523364, correct 100/107
class 1: acc 0.8378378378378378, correct 93/111
class 2: acc 0.8583333333333333, correct 103/120
class 3: acc 0.9821428571428571, correct 110/112
class 4: acc 0.9789473684210527, correct 93/95

Val Set, val_loss: 1.2754, val_error: 0.4600, auc: 0.8477
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.2875: correct 115/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2627, instance_loss: 0.5236, weighted_loss: 0.3410, label: 1, bag_size: 1197
batch 39, loss: 0.1495, instance_loss: 0.3368, weighted_loss: 0.2057, label: 1, bag_size: 1273
batch 59, loss: 0.0097, instance_loss: 0.0929, weighted_loss: 0.0347, label: 4, bag_size: 110
batch 79, loss: 0.6729, instance_loss: 0.5682, weighted_loss: 0.6415, label: 2, bag_size: 1069
batch 99, loss: 0.0001, instance_loss: 0.1241, weighted_loss: 0.0373, label: 4, bag_size: 48
batch 119, loss: 0.1079, instance_loss: 0.3050, weighted_loss: 0.1670, label: 1, bag_size: 898
batch 139, loss: 0.0001, instance_loss: 0.0226, weighted_loss: 0.0068, label: 4, bag_size: 185
batch 159, loss: 0.1514, instance_loss: 0.4414, weighted_loss: 0.2384, label: 4, bag_size: 754
batch 179, loss: 0.0737, instance_loss: 0.2519, weighted_loss: 0.1271, label: 2, bag_size: 262
batch 199, loss: 0.0408, instance_loss: 0.1507, weighted_loss: 0.0738, label: 1, bag_size: 690
batch 219, loss: 0.0001, instance_loss: 0.0702, weighted_loss: 0.0212, label: 4, bag_size: 157
batch 239, loss: 0.4743, instance_loss: 0.3812, weighted_loss: 0.4463, label: 2, bag_size: 1215
batch 259, loss: 0.1282, instance_loss: 0.3301, weighted_loss: 0.1888, label: 1, bag_size: 442
batch 279, loss: 0.0031, instance_loss: 0.0388, weighted_loss: 0.0138, label: 3, bag_size: 29
batch 299, loss: 0.0046, instance_loss: 0.0425, weighted_loss: 0.0160, label: 0, bag_size: 731
batch 319, loss: 0.4307, instance_loss: 0.4446, weighted_loss: 0.4349, label: 2, bag_size: 1139
batch 339, loss: 0.4141, instance_loss: 0.6618, weighted_loss: 0.4884, label: 4, bag_size: 511
batch 359, loss: 0.2341, instance_loss: 0.2765, weighted_loss: 0.2468, label: 2, bag_size: 1259
batch 379, loss: 0.1030, instance_loss: 0.1822, weighted_loss: 0.1268, label: 2, bag_size: 270
batch 399, loss: 0.1207, instance_loss: 0.5002, weighted_loss: 0.2346, label: 3, bag_size: 230
batch 419, loss: 0.0473, instance_loss: 0.4053, weighted_loss: 0.1547, label: 4, bag_size: 297
batch 439, loss: 0.2034, instance_loss: 0.1609, weighted_loss: 0.1907, label: 2, bag_size: 1019
batch 459, loss: 0.0400, instance_loss: 0.1689, weighted_loss: 0.0787, label: 1, bag_size: 1191
batch 479, loss: 1.3735, instance_loss: 0.6792, weighted_loss: 1.1652, label: 2, bag_size: 345
batch 499, loss: 0.0225, instance_loss: 0.0863, weighted_loss: 0.0416, label: 0, bag_size: 1872
batch 519, loss: 0.0245, instance_loss: 0.2804, weighted_loss: 0.1013, label: 4, bag_size: 1474
batch 539, loss: 0.6702, instance_loss: 0.4794, weighted_loss: 0.6129, label: 0, bag_size: 1257


class 0 clustering acc 0.9873394495412844: correct 21524/21800
class 1 clustering acc 0.4809633027522936: correct 2097/4360
Epoch: 28, train_loss: 0.2360, train_clustering_loss:  0.2785, train_error: 0.0807
class 0: acc 0.9320388349514563, correct 96/103
class 1: acc 0.883495145631068, correct 91/103
class 2: acc 0.8558558558558559, correct 95/111
class 3: acc 0.9454545454545454, correct 104/110
class 4: acc 0.9745762711864406, correct 115/118

Val Set, val_loss: 1.0971, val_error: 0.3800, auc: 0.8677
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.3175: correct 127/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.625, correct 5/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0197, instance_loss: 0.0717, weighted_loss: 0.0353, label: 3, bag_size: 1399
batch 39, loss: 0.2474, instance_loss: 0.2449, weighted_loss: 0.2467, label: 1, bag_size: 1144
batch 59, loss: 0.0221, instance_loss: 0.1293, weighted_loss: 0.0543, label: 0, bag_size: 1196
batch 79, loss: 0.0171, instance_loss: 0.1923, weighted_loss: 0.0697, label: 0, bag_size: 1255
batch 99, loss: 0.0774, instance_loss: 0.4161, weighted_loss: 0.1790, label: 1, bag_size: 1255
batch 119, loss: 0.5208, instance_loss: 0.3985, weighted_loss: 0.4841, label: 0, bag_size: 801
batch 139, loss: 0.1593, instance_loss: 0.2024, weighted_loss: 0.1723, label: 3, bag_size: 697
batch 159, loss: 0.0042, instance_loss: 0.0363, weighted_loss: 0.0138, label: 3, bag_size: 48
batch 179, loss: 0.0038, instance_loss: 0.1601, weighted_loss: 0.0507, label: 3, bag_size: 20
batch 199, loss: 0.0337, instance_loss: 0.0692, weighted_loss: 0.0443, label: 0, bag_size: 1579
batch 219, loss: 0.0003, instance_loss: 0.0579, weighted_loss: 0.0176, label: 3, bag_size: 66
batch 239, loss: 0.6610, instance_loss: 0.3400, weighted_loss: 0.5647, label: 3, bag_size: 849
batch 259, loss: 0.9612, instance_loss: 0.6937, weighted_loss: 0.8810, label: 1, bag_size: 1172
batch 279, loss: 0.2394, instance_loss: 0.2823, weighted_loss: 0.2523, label: 2, bag_size: 358
batch 299, loss: 0.0007, instance_loss: 0.1826, weighted_loss: 0.0553, label: 3, bag_size: 20
batch 319, loss: 0.0037, instance_loss: 0.1054, weighted_loss: 0.0342, label: 4, bag_size: 110
batch 339, loss: 0.1727, instance_loss: 0.2016, weighted_loss: 0.1814, label: 0, bag_size: 545
batch 359, loss: 0.0075, instance_loss: 0.0824, weighted_loss: 0.0300, label: 3, bag_size: 37
batch 379, loss: 0.0021, instance_loss: 0.1183, weighted_loss: 0.0369, label: 3, bag_size: 87
batch 399, loss: 0.1414, instance_loss: 0.4441, weighted_loss: 0.2322, label: 2, bag_size: 323
batch 419, loss: 0.0044, instance_loss: 0.0214, weighted_loss: 0.0095, label: 3, bag_size: 143
batch 439, loss: 0.0007, instance_loss: 0.0197, weighted_loss: 0.0064, label: 3, bag_size: 66
batch 459, loss: 0.0026, instance_loss: 0.1577, weighted_loss: 0.0491, label: 4, bag_size: 40
batch 479, loss: 0.0028, instance_loss: 0.1450, weighted_loss: 0.0455, label: 3, bag_size: 23
batch 499, loss: 0.0022, instance_loss: 0.2003, weighted_loss: 0.0616, label: 1, bag_size: 1376
batch 519, loss: 0.2732, instance_loss: 0.3765, weighted_loss: 0.3042, label: 2, bag_size: 264
batch 539, loss: 0.3169, instance_loss: 0.4125, weighted_loss: 0.3456, label: 2, bag_size: 500


class 0 clustering acc 0.9871100917431193: correct 21519/21800
class 1 clustering acc 0.49977064220183487: correct 2179/4360
Epoch: 29, train_loss: 0.2297, train_clustering_loss:  0.2719, train_error: 0.0881
class 0: acc 0.9313725490196079, correct 95/102
class 1: acc 0.7722772277227723, correct 78/101
class 2: acc 0.8623853211009175, correct 94/109
class 3: acc 0.9833333333333333, correct 118/120
class 4: acc 0.9911504424778761, correct 112/113

Val Set, val_loss: 1.0949, val_error: 0.4200, auc: 0.8650
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0010, instance_loss: 0.1647, weighted_loss: 0.0501, label: 4, bag_size: 29
batch 39, loss: 0.0394, instance_loss: 0.2038, weighted_loss: 0.0887, label: 0, bag_size: 1190
batch 59, loss: 0.0070, instance_loss: 0.1576, weighted_loss: 0.0522, label: 1, bag_size: 945
batch 79, loss: 0.0125, instance_loss: 0.0994, weighted_loss: 0.0386, label: 1, bag_size: 938
batch 99, loss: 0.3890, instance_loss: 0.3737, weighted_loss: 0.3844, label: 1, bag_size: 875
batch 119, loss: 1.7317, instance_loss: 0.5773, weighted_loss: 1.3854, label: 2, bag_size: 237
batch 139, loss: 0.2649, instance_loss: 0.5265, weighted_loss: 0.3434, label: 1, bag_size: 1799
batch 159, loss: 0.1165, instance_loss: 0.3647, weighted_loss: 0.1910, label: 4, bag_size: 1235
batch 179, loss: 0.0037, instance_loss: 0.0190, weighted_loss: 0.0083, label: 0, bag_size: 402
batch 199, loss: 0.8080, instance_loss: 0.3650, weighted_loss: 0.6751, label: 1, bag_size: 1049
batch 219, loss: 0.0603, instance_loss: 0.7001, weighted_loss: 0.2523, label: 1, bag_size: 651
batch 239, loss: 0.4483, instance_loss: 0.3565, weighted_loss: 0.4207, label: 1, bag_size: 102
batch 259, loss: 0.0075, instance_loss: 0.0888, weighted_loss: 0.0319, label: 4, bag_size: 211
batch 279, loss: 0.0071, instance_loss: 0.0669, weighted_loss: 0.0251, label: 0, bag_size: 1599
batch 299, loss: 0.3726, instance_loss: 0.6902, weighted_loss: 0.4679, label: 4, bag_size: 436
batch 319, loss: 0.0572, instance_loss: 0.1914, weighted_loss: 0.0974, label: 0, bag_size: 413
batch 339, loss: 0.0165, instance_loss: 0.0557, weighted_loss: 0.0283, label: 0, bag_size: 1046
batch 359, loss: 0.0001, instance_loss: 0.1532, weighted_loss: 0.0460, label: 4, bag_size: 134
batch 379, loss: 0.0005, instance_loss: 0.0457, weighted_loss: 0.0141, label: 4, bag_size: 130
batch 399, loss: 0.0276, instance_loss: 0.5423, weighted_loss: 0.1820, label: 4, bag_size: 663
batch 419, loss: 0.0129, instance_loss: 0.0752, weighted_loss: 0.0316, label: 0, bag_size: 552
batch 439, loss: 0.1386, instance_loss: 0.3988, weighted_loss: 0.2167, label: 1, bag_size: 747
batch 459, loss: 0.3382, instance_loss: 0.4615, weighted_loss: 0.3752, label: 2, bag_size: 1700
batch 479, loss: 0.0936, instance_loss: 0.2256, weighted_loss: 0.1332, label: 2, bag_size: 636
batch 499, loss: 0.1672, instance_loss: 0.1889, weighted_loss: 0.1737, label: 0, bag_size: 413
batch 519, loss: 0.0702, instance_loss: 0.3580, weighted_loss: 0.1565, label: 0, bag_size: 118
batch 539, loss: 0.0000, instance_loss: 0.1277, weighted_loss: 0.0383, label: 4, bag_size: 147


class 0 clustering acc 0.9878899082568807: correct 21536/21800
class 1 clustering acc 0.47293577981651375: correct 2062/4360
Epoch: 30, train_loss: 0.2441, train_clustering_loss:  0.2819, train_error: 0.0881
class 0: acc 0.9491525423728814, correct 112/118
class 1: acc 0.8421052631578947, correct 96/114
class 2: acc 0.819047619047619, correct 86/105
class 3: acc 0.9805825242718447, correct 101/103
class 4: acc 0.9714285714285714, correct 102/105

Val Set, val_loss: 1.0725, val_error: 0.4000, auc: 0.8767
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.3: correct 120/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 4/8
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0754, instance_loss: 0.0802, weighted_loss: 0.0768, label: 4, bag_size: 790
batch 39, loss: 0.1210, instance_loss: 0.2413, weighted_loss: 0.1571, label: 2, bag_size: 1133
batch 59, loss: 0.1166, instance_loss: 0.5461, weighted_loss: 0.2454, label: 4, bag_size: 511
batch 79, loss: 0.0475, instance_loss: 0.3436, weighted_loss: 0.1363, label: 3, bag_size: 1118
batch 99, loss: 0.0019, instance_loss: 0.2069, weighted_loss: 0.0634, label: 3, bag_size: 16
batch 119, loss: 0.0591, instance_loss: 0.3352, weighted_loss: 0.1419, label: 1, bag_size: 1559
batch 139, loss: 0.0001, instance_loss: 0.0798, weighted_loss: 0.0240, label: 4, bag_size: 23
batch 159, loss: 1.7274, instance_loss: 0.5572, weighted_loss: 1.3764, label: 1, bag_size: 1376
batch 179, loss: 0.3253, instance_loss: 0.6228, weighted_loss: 0.4145, label: 4, bag_size: 1337
batch 199, loss: 0.1032, instance_loss: 0.2536, weighted_loss: 0.1483, label: 2, bag_size: 265
batch 219, loss: 0.0853, instance_loss: 0.1776, weighted_loss: 0.1130, label: 0, bag_size: 371
batch 239, loss: 0.0006, instance_loss: 0.0921, weighted_loss: 0.0281, label: 4, bag_size: 44
batch 259, loss: 0.4937, instance_loss: 0.7420, weighted_loss: 0.5682, label: 3, bag_size: 281
batch 279, loss: 0.0006, instance_loss: 0.1174, weighted_loss: 0.0356, label: 3, bag_size: 123
batch 299, loss: 0.4580, instance_loss: 0.3572, weighted_loss: 0.4277, label: 2, bag_size: 1416
batch 319, loss: 0.3870, instance_loss: 0.5277, weighted_loss: 0.4292, label: 3, bag_size: 317
batch 339, loss: 0.0011, instance_loss: 0.1572, weighted_loss: 0.0479, label: 4, bag_size: 38
batch 359, loss: 0.0676, instance_loss: 0.1282, weighted_loss: 0.0858, label: 1, bag_size: 690
batch 379, loss: 0.0427, instance_loss: 0.1565, weighted_loss: 0.0768, label: 0, bag_size: 1046
batch 399, loss: 0.0285, instance_loss: 0.2446, weighted_loss: 0.0933, label: 4, bag_size: 1176
batch 419, loss: 0.7451, instance_loss: 0.5512, weighted_loss: 0.6869, label: 1, bag_size: 1376
batch 439, loss: 0.0014, instance_loss: 0.1804, weighted_loss: 0.0551, label: 3, bag_size: 18
batch 459, loss: 0.0242, instance_loss: 0.1907, weighted_loss: 0.0742, label: 2, bag_size: 471
batch 479, loss: 0.0057, instance_loss: 0.2412, weighted_loss: 0.0764, label: 4, bag_size: 24
batch 499, loss: 0.0110, instance_loss: 0.0397, weighted_loss: 0.0196, label: 3, bag_size: 556
batch 519, loss: 0.0810, instance_loss: 0.5350, weighted_loss: 0.2172, label: 4, bag_size: 542
batch 539, loss: 0.0332, instance_loss: 0.2498, weighted_loss: 0.0982, label: 2, bag_size: 357


class 0 clustering acc 0.9885321100917431: correct 21550/21800
class 1 clustering acc 0.48073394495412847: correct 2096/4360
Epoch: 31, train_loss: 0.1780, train_clustering_loss:  0.2696, train_error: 0.0514
class 0: acc 0.9821428571428571, correct 110/112
class 1: acc 0.8585858585858586, correct 85/99
class 2: acc 0.908256880733945, correct 99/109
class 3: acc 0.9823008849557522, correct 111/113
class 4: acc 1.0, correct 112/112

Val Set, val_loss: 1.1264, val_error: 0.3800, auc: 0.8784
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.3275: correct 131/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0917, weighted_loss: 0.0276, label: 3, bag_size: 105
batch 39, loss: 0.0117, instance_loss: 0.0736, weighted_loss: 0.0303, label: 3, bag_size: 316
batch 59, loss: 0.1189, instance_loss: 0.5693, weighted_loss: 0.2540, label: 0, bag_size: 163
batch 79, loss: 0.0072, instance_loss: 0.0737, weighted_loss: 0.0271, label: 0, bag_size: 515
batch 99, loss: 0.0040, instance_loss: 0.2135, weighted_loss: 0.0669, label: 4, bag_size: 711
batch 119, loss: 0.1969, instance_loss: 0.2503, weighted_loss: 0.2129, label: 0, bag_size: 381
batch 139, loss: 0.0403, instance_loss: 0.2236, weighted_loss: 0.0953, label: 2, bag_size: 701
batch 159, loss: 0.0970, instance_loss: 0.5893, weighted_loss: 0.2447, label: 3, bag_size: 200
batch 179, loss: 0.3541, instance_loss: 0.3351, weighted_loss: 0.3484, label: 1, bag_size: 838
batch 199, loss: 0.0358, instance_loss: 0.2250, weighted_loss: 0.0926, label: 2, bag_size: 2826
batch 219, loss: 0.0001, instance_loss: 0.0589, weighted_loss: 0.0177, label: 4, bag_size: 174
batch 239, loss: 0.1888, instance_loss: 0.5064, weighted_loss: 0.2841, label: 1, bag_size: 1144
batch 259, loss: 0.0659, instance_loss: 0.4464, weighted_loss: 0.1800, label: 2, bag_size: 110
batch 279, loss: 0.5015, instance_loss: 0.6616, weighted_loss: 0.5495, label: 4, bag_size: 366
batch 299, loss: 0.0003, instance_loss: 0.0577, weighted_loss: 0.0175, label: 4, bag_size: 211
batch 319, loss: 0.0015, instance_loss: 0.1122, weighted_loss: 0.0347, label: 3, bag_size: 18
batch 339, loss: 0.0003, instance_loss: 0.1464, weighted_loss: 0.0441, label: 4, bag_size: 24
batch 359, loss: 0.0006, instance_loss: 0.1831, weighted_loss: 0.0554, label: 3, bag_size: 16
batch 379, loss: 0.7629, instance_loss: 0.2624, weighted_loss: 0.6127, label: 1, bag_size: 598
batch 399, loss: 0.0035, instance_loss: 0.0547, weighted_loss: 0.0189, label: 0, bag_size: 933
batch 419, loss: 0.0054, instance_loss: 0.0490, weighted_loss: 0.0184, label: 0, bag_size: 1235
batch 439, loss: 0.0026, instance_loss: 0.2787, weighted_loss: 0.0854, label: 0, bag_size: 116
batch 459, loss: 0.1202, instance_loss: 0.2710, weighted_loss: 0.1655, label: 3, bag_size: 405
batch 479, loss: 0.1077, instance_loss: 0.2694, weighted_loss: 0.1562, label: 2, bag_size: 636
batch 499, loss: 0.0039, instance_loss: 0.0526, weighted_loss: 0.0185, label: 1, bag_size: 1261
batch 519, loss: 0.1505, instance_loss: 0.1544, weighted_loss: 0.1516, label: 1, bag_size: 356
batch 539, loss: 0.6225, instance_loss: 0.5680, weighted_loss: 0.6062, label: 2, bag_size: 784


class 0 clustering acc 0.9858715596330275: correct 21492/21800
class 1 clustering acc 0.5084862385321101: correct 2217/4360
Epoch: 32, train_loss: 0.1933, train_clustering_loss:  0.2728, train_error: 0.0734
class 0: acc 0.9306930693069307, correct 94/101
class 1: acc 0.8403361344537815, correct 100/119
class 2: acc 0.87, correct 87/100
class 3: acc 0.9911504424778761, correct 112/113
class 4: acc 1.0, correct 112/112

Val Set, val_loss: 1.2018, val_error: 0.4200, auc: 0.8769
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.34: correct 136/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.0, correct 0/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 2.2507, instance_loss: 0.8360, weighted_loss: 1.8263, label: 2, bag_size: 1231
batch 39, loss: 0.5970, instance_loss: 0.4305, weighted_loss: 0.5470, label: 0, bag_size: 868
batch 59, loss: 0.1326, instance_loss: 0.1437, weighted_loss: 0.1359, label: 0, bag_size: 1247
batch 79, loss: 0.1193, instance_loss: 0.2469, weighted_loss: 0.1576, label: 0, bag_size: 350
batch 99, loss: 0.0000, instance_loss: 0.1380, weighted_loss: 0.0414, label: 4, bag_size: 128
batch 119, loss: 0.2690, instance_loss: 0.5524, weighted_loss: 0.3540, label: 1, bag_size: 786
batch 139, loss: 0.0460, instance_loss: 0.1417, weighted_loss: 0.0747, label: 2, bag_size: 455
batch 159, loss: 0.0074, instance_loss: 0.1618, weighted_loss: 0.0537, label: 1, bag_size: 938
batch 179, loss: 0.0059, instance_loss: 0.0391, weighted_loss: 0.0159, label: 0, bag_size: 1135
batch 199, loss: 0.0260, instance_loss: 0.2493, weighted_loss: 0.0930, label: 4, bag_size: 1278
batch 219, loss: 0.1360, instance_loss: 0.3560, weighted_loss: 0.2020, label: 0, bag_size: 1289
batch 239, loss: 0.3966, instance_loss: 0.3633, weighted_loss: 0.3866, label: 2, bag_size: 525
batch 259, loss: 0.0213, instance_loss: 0.2446, weighted_loss: 0.0883, label: 0, bag_size: 1196
batch 279, loss: 0.0216, instance_loss: 0.0808, weighted_loss: 0.0393, label: 0, bag_size: 1517
batch 299, loss: 0.0205, instance_loss: 0.1408, weighted_loss: 0.0566, label: 3, bag_size: 451
batch 319, loss: 0.1084, instance_loss: 0.2652, weighted_loss: 0.1555, label: 0, bag_size: 120
batch 339, loss: 0.2738, instance_loss: 0.3151, weighted_loss: 0.2862, label: 3, bag_size: 1019
batch 359, loss: 0.0046, instance_loss: 0.1496, weighted_loss: 0.0481, label: 4, bag_size: 47
batch 379, loss: 0.0019, instance_loss: 0.0818, weighted_loss: 0.0259, label: 3, bag_size: 35
batch 399, loss: 0.0006, instance_loss: 0.2360, weighted_loss: 0.0712, label: 3, bag_size: 18
batch 419, loss: 2.1096, instance_loss: 0.6670, weighted_loss: 1.6768, label: 2, bag_size: 194
batch 439, loss: 0.0042, instance_loss: 0.0894, weighted_loss: 0.0297, label: 4, bag_size: 107
batch 459, loss: 0.0317, instance_loss: 0.4807, weighted_loss: 0.1664, label: 4, bag_size: 297
batch 479, loss: 0.0007, instance_loss: 0.2882, weighted_loss: 0.0870, label: 3, bag_size: 18
batch 499, loss: 0.3191, instance_loss: 0.2905, weighted_loss: 0.3105, label: 1, bag_size: 533
batch 519, loss: 0.1213, instance_loss: 0.2482, weighted_loss: 0.1594, label: 2, bag_size: 1281
batch 539, loss: 0.0043, instance_loss: 0.0830, weighted_loss: 0.0279, label: 4, bag_size: 43


class 0 clustering acc 0.9883944954128441: correct 21547/21800
class 1 clustering acc 0.5224770642201835: correct 2278/4360
Epoch: 33, train_loss: 0.1847, train_clustering_loss:  0.2616, train_error: 0.0679
class 0: acc 0.9444444444444444, correct 102/108
class 1: acc 0.8484848484848485, correct 84/99
class 2: acc 0.8653846153846154, correct 90/104
class 3: acc 0.9831932773109243, correct 117/119
class 4: acc 1.0, correct 115/115

Val Set, val_loss: 1.1955, val_error: 0.4200, auc: 0.8674
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.355: correct 142/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.3106, instance_loss: 0.2607, weighted_loss: 0.2956, label: 3, bag_size: 18
batch 39, loss: 0.0011, instance_loss: 0.1447, weighted_loss: 0.0441, label: 3, bag_size: 21
batch 59, loss: 0.0785, instance_loss: 0.1565, weighted_loss: 0.1019, label: 1, bag_size: 1127
batch 79, loss: 0.1209, instance_loss: 0.3209, weighted_loss: 0.1809, label: 2, bag_size: 317
batch 99, loss: 0.2451, instance_loss: 0.6722, weighted_loss: 0.3732, label: 1, bag_size: 269
batch 119, loss: 0.0111, instance_loss: 0.1689, weighted_loss: 0.0585, label: 0, bag_size: 1196
batch 139, loss: 0.0000, instance_loss: 0.0178, weighted_loss: 0.0053, label: 4, bag_size: 72
batch 159, loss: 0.0000, instance_loss: 0.0227, weighted_loss: 0.0068, label: 4, bag_size: 140
batch 179, loss: 0.0734, instance_loss: 0.2639, weighted_loss: 0.1306, label: 2, bag_size: 1788
batch 199, loss: 0.0002, instance_loss: 0.0825, weighted_loss: 0.0249, label: 4, bag_size: 40
batch 219, loss: 0.0002, instance_loss: 0.1106, weighted_loss: 0.0333, label: 4, bag_size: 168
batch 239, loss: 0.1978, instance_loss: 0.2349, weighted_loss: 0.2089, label: 1, bag_size: 858
batch 259, loss: 0.0000, instance_loss: 0.1129, weighted_loss: 0.0339, label: 3, bag_size: 28
batch 279, loss: 0.0001, instance_loss: 0.0463, weighted_loss: 0.0140, label: 4, bag_size: 130
batch 299, loss: 0.3793, instance_loss: 0.4624, weighted_loss: 0.4042, label: 0, bag_size: 759
batch 319, loss: 0.1735, instance_loss: 0.2987, weighted_loss: 0.2110, label: 0, bag_size: 630
batch 339, loss: 0.2050, instance_loss: 0.2437, weighted_loss: 0.2166, label: 0, bag_size: 350
batch 359, loss: 0.0014, instance_loss: 0.0392, weighted_loss: 0.0127, label: 0, bag_size: 898
batch 379, loss: 0.0187, instance_loss: 0.0632, weighted_loss: 0.0320, label: 0, bag_size: 542
batch 399, loss: 0.0000, instance_loss: 0.0212, weighted_loss: 0.0064, label: 4, bag_size: 174
batch 419, loss: 0.0079, instance_loss: 0.1773, weighted_loss: 0.0588, label: 1, bag_size: 866
batch 439, loss: 0.0060, instance_loss: 0.0519, weighted_loss: 0.0198, label: 0, bag_size: 921
batch 459, loss: 0.7949, instance_loss: 0.4119, weighted_loss: 0.6800, label: 1, bag_size: 1724
batch 479, loss: 0.0084, instance_loss: 0.1372, weighted_loss: 0.0470, label: 0, bag_size: 1034
batch 499, loss: 0.0080, instance_loss: 0.2200, weighted_loss: 0.0716, label: 0, bag_size: 122
batch 519, loss: 0.0004, instance_loss: 0.0792, weighted_loss: 0.0241, label: 4, bag_size: 51
batch 539, loss: 0.4796, instance_loss: 0.4067, weighted_loss: 0.4577, label: 0, bag_size: 148


class 0 clustering acc 0.9861009174311927: correct 21497/21800
class 1 clustering acc 0.5295871559633027: correct 2309/4360
Epoch: 34, train_loss: 0.1719, train_clustering_loss:  0.2569, train_error: 0.0587
class 0: acc 0.9915254237288136, correct 117/118
class 1: acc 0.9065420560747663, correct 97/107
class 2: acc 0.8333333333333334, correct 80/96
class 3: acc 0.9711538461538461, correct 101/104
class 4: acc 0.9833333333333333, correct 118/120

Val Set, val_loss: 1.3563, val_error: 0.4200, auc: 0.8549
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.325: correct 130/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.9463, instance_loss: 0.4501, weighted_loss: 1.4975, label: 2, bag_size: 345
batch 39, loss: 0.0477, instance_loss: 0.2481, weighted_loss: 0.1078, label: 2, bag_size: 1416
batch 59, loss: 0.0002, instance_loss: 0.1584, weighted_loss: 0.0477, label: 3, bag_size: 26
batch 79, loss: 0.0013, instance_loss: 0.1003, weighted_loss: 0.0310, label: 3, bag_size: 53
batch 99, loss: 0.0091, instance_loss: 0.0818, weighted_loss: 0.0309, label: 0, bag_size: 1018
batch 119, loss: 0.1329, instance_loss: 0.0930, weighted_loss: 0.1209, label: 4, bag_size: 60
batch 139, loss: 0.5719, instance_loss: 0.4169, weighted_loss: 0.5254, label: 2, bag_size: 1378
batch 159, loss: 0.5970, instance_loss: 0.4235, weighted_loss: 0.5450, label: 1, bag_size: 1096
batch 179, loss: 0.1000, instance_loss: 0.3145, weighted_loss: 0.1644, label: 4, bag_size: 1357
batch 199, loss: 0.1677, instance_loss: 0.5028, weighted_loss: 0.2682, label: 1, bag_size: 1144
batch 219, loss: 0.0009, instance_loss: 0.0406, weighted_loss: 0.0128, label: 4, bag_size: 211
batch 239, loss: 0.0381, instance_loss: 0.2226, weighted_loss: 0.0935, label: 1, bag_size: 790
batch 259, loss: 0.0013, instance_loss: 0.1550, weighted_loss: 0.0474, label: 4, bag_size: 130
batch 279, loss: 0.0576, instance_loss: 0.1528, weighted_loss: 0.0861, label: 1, bag_size: 790
batch 299, loss: 0.1216, instance_loss: 0.3284, weighted_loss: 0.1837, label: 2, bag_size: 777
batch 319, loss: 0.0001, instance_loss: 0.0668, weighted_loss: 0.0201, label: 4, bag_size: 192
batch 339, loss: 0.2784, instance_loss: 0.3076, weighted_loss: 0.2872, label: 0, bag_size: 371
batch 359, loss: 0.0000, instance_loss: 0.0990, weighted_loss: 0.0297, label: 3, bag_size: 24
batch 379, loss: 0.0052, instance_loss: 0.1801, weighted_loss: 0.0576, label: 4, bag_size: 20
batch 399, loss: 0.0421, instance_loss: 0.1784, weighted_loss: 0.0830, label: 2, bag_size: 323
batch 419, loss: 0.0070, instance_loss: 0.2073, weighted_loss: 0.0671, label: 0, bag_size: 118
batch 439, loss: 0.0019, instance_loss: 0.1177, weighted_loss: 0.0367, label: 3, bag_size: 20
batch 459, loss: 0.1529, instance_loss: 0.4685, weighted_loss: 0.2476, label: 4, bag_size: 542
batch 479, loss: 2.2800, instance_loss: 0.6340, weighted_loss: 1.7862, label: 2, bag_size: 943
batch 499, loss: 0.3059, instance_loss: 0.9217, weighted_loss: 0.4907, label: 4, bag_size: 210
batch 519, loss: 1.1710, instance_loss: 0.5273, weighted_loss: 0.9779, label: 1, bag_size: 1724
batch 539, loss: 0.0114, instance_loss: 0.2209, weighted_loss: 0.0743, label: 4, bag_size: 1474


class 0 clustering acc 0.9861467889908256: correct 21498/21800
class 1 clustering acc 0.5419724770642201: correct 2363/4360
Epoch: 35, train_loss: 0.2065, train_clustering_loss:  0.2607, train_error: 0.0642
class 0: acc 0.9649122807017544, correct 110/114
class 1: acc 0.8762886597938144, correct 85/97
class 2: acc 0.8583333333333333, correct 103/120
class 3: acc 0.9894736842105263, correct 94/95
class 4: acc 0.9915966386554622, correct 118/119

Val Set, val_loss: 1.4696, val_error: 0.4400, auc: 0.8454
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.375, correct 3/8
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0068, instance_loss: 0.0951, weighted_loss: 0.0333, label: 0, bag_size: 1135
batch 39, loss: 0.5092, instance_loss: 0.3837, weighted_loss: 0.4716, label: 0, bag_size: 962
batch 59, loss: 0.0045, instance_loss: 0.2414, weighted_loss: 0.0756, label: 3, bag_size: 16
batch 79, loss: 0.0558, instance_loss: 0.1662, weighted_loss: 0.0889, label: 1, bag_size: 828
batch 99, loss: 0.0225, instance_loss: 0.1281, weighted_loss: 0.0542, label: 0, bag_size: 1135
batch 119, loss: 0.0190, instance_loss: 0.2887, weighted_loss: 0.0999, label: 0, bag_size: 117
batch 139, loss: 0.4047, instance_loss: 0.7902, weighted_loss: 0.5203, label: 3, bag_size: 281
batch 159, loss: 0.0005, instance_loss: 0.0697, weighted_loss: 0.0213, label: 4, bag_size: 51
batch 179, loss: 0.1544, instance_loss: 0.3925, weighted_loss: 0.2258, label: 0, bag_size: 1332
batch 199, loss: 0.0033, instance_loss: 0.1347, weighted_loss: 0.0427, label: 4, bag_size: 35
batch 219, loss: 0.1463, instance_loss: 0.1645, weighted_loss: 0.1518, label: 1, bag_size: 828
batch 239, loss: 0.0474, instance_loss: 0.2721, weighted_loss: 0.1148, label: 0, bag_size: 410
batch 259, loss: 0.0000, instance_loss: 0.0112, weighted_loss: 0.0034, label: 4, bag_size: 185
batch 279, loss: 0.0068, instance_loss: 0.2942, weighted_loss: 0.0930, label: 3, bag_size: 1253
batch 299, loss: 0.0009, instance_loss: 0.0930, weighted_loss: 0.0285, label: 4, bag_size: 55
batch 319, loss: 0.0284, instance_loss: 0.2991, weighted_loss: 0.1096, label: 4, bag_size: 625
batch 339, loss: 0.0087, instance_loss: 0.1845, weighted_loss: 0.0614, label: 2, bag_size: 846
batch 359, loss: 0.0010, instance_loss: 0.0356, weighted_loss: 0.0114, label: 4, bag_size: 130
batch 379, loss: 0.0072, instance_loss: 0.2814, weighted_loss: 0.0895, label: 3, bag_size: 821
batch 399, loss: 0.0151, instance_loss: 0.1687, weighted_loss: 0.0612, label: 0, bag_size: 338
batch 419, loss: 0.0005, instance_loss: 0.0412, weighted_loss: 0.0127, label: 3, bag_size: 35
batch 439, loss: 0.0343, instance_loss: 0.1369, weighted_loss: 0.0651, label: 2, bag_size: 809
batch 459, loss: 0.7808, instance_loss: 0.4861, weighted_loss: 0.6924, label: 1, bag_size: 747
batch 479, loss: 0.0500, instance_loss: 0.5968, weighted_loss: 0.2141, label: 4, bag_size: 1331
batch 499, loss: 0.0106, instance_loss: 0.1839, weighted_loss: 0.0626, label: 1, bag_size: 945
batch 519, loss: 0.0013, instance_loss: 0.0182, weighted_loss: 0.0063, label: 0, bag_size: 1599
batch 539, loss: 0.0987, instance_loss: 0.3892, weighted_loss: 0.1859, label: 2, bag_size: 204


class 0 clustering acc 0.9878440366972477: correct 21535/21800
class 1 clustering acc 0.5194954128440367: correct 2265/4360
Epoch: 36, train_loss: 0.1476, train_clustering_loss:  0.2623, train_error: 0.0459
class 0: acc 0.9831932773109243, correct 117/119
class 1: acc 0.9081632653061225, correct 89/98
class 2: acc 0.8942307692307693, correct 93/104
class 3: acc 0.9714285714285714, correct 102/105
class 4: acc 1.0, correct 119/119

Val Set, val_loss: 1.1892, val_error: 0.4000, auc: 0.8637
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.3625: correct 145/400
class 0: acc 0.75, correct 6/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0010, instance_loss: 0.0976, weighted_loss: 0.0300, label: 3, bag_size: 56
batch 39, loss: 0.0001, instance_loss: 0.0790, weighted_loss: 0.0237, label: 4, bag_size: 47
batch 59, loss: 0.0404, instance_loss: 0.1712, weighted_loss: 0.0797, label: 2, bag_size: 1281
batch 79, loss: 0.8341, instance_loss: 0.4474, weighted_loss: 0.7181, label: 2, bag_size: 1043
batch 99, loss: 0.0026, instance_loss: 0.1172, weighted_loss: 0.0370, label: 0, bag_size: 255
batch 119, loss: 0.6975, instance_loss: 0.3335, weighted_loss: 0.5883, label: 2, bag_size: 986
batch 139, loss: 0.8040, instance_loss: 0.4734, weighted_loss: 0.7048, label: 1, bag_size: 1724
batch 159, loss: 0.0064, instance_loss: 0.0734, weighted_loss: 0.0265, label: 3, bag_size: 1069
batch 179, loss: 0.0867, instance_loss: 0.1362, weighted_loss: 0.1016, label: 1, bag_size: 994
batch 199, loss: 0.0008, instance_loss: 0.0687, weighted_loss: 0.0212, label: 4, bag_size: 211
batch 219, loss: 0.0014, instance_loss: 0.1495, weighted_loss: 0.0458, label: 4, bag_size: 19
batch 239, loss: 0.2966, instance_loss: 0.8095, weighted_loss: 0.4505, label: 3, bag_size: 281
batch 259, loss: 0.0016, instance_loss: 0.1869, weighted_loss: 0.0572, label: 2, bag_size: 632
batch 279, loss: 0.0535, instance_loss: 0.2750, weighted_loss: 0.1199, label: 1, bag_size: 869
batch 299, loss: 0.0545, instance_loss: 0.2000, weighted_loss: 0.0982, label: 0, bag_size: 350
batch 319, loss: 0.0079, instance_loss: 0.1482, weighted_loss: 0.0500, label: 0, bag_size: 1133
batch 339, loss: 1.3997, instance_loss: 0.6978, weighted_loss: 1.1891, label: 2, bag_size: 948
batch 359, loss: 0.1170, instance_loss: 0.3272, weighted_loss: 0.1801, label: 1, bag_size: 614
batch 379, loss: 0.1127, instance_loss: 0.3215, weighted_loss: 0.1753, label: 2, bag_size: 1050
batch 399, loss: 0.0070, instance_loss: 0.2253, weighted_loss: 0.0725, label: 2, bag_size: 400
batch 419, loss: 0.3163, instance_loss: 0.4992, weighted_loss: 0.3712, label: 2, bag_size: 1139
batch 439, loss: 0.0431, instance_loss: 0.6320, weighted_loss: 0.2198, label: 4, bag_size: 675
batch 459, loss: 0.0066, instance_loss: 0.4901, weighted_loss: 0.1517, label: 2, bag_size: 110
batch 479, loss: 0.0835, instance_loss: 0.1390, weighted_loss: 0.1001, label: 0, bag_size: 736
batch 499, loss: 2.3374, instance_loss: 0.7367, weighted_loss: 1.8572, label: 1, bag_size: 386
batch 519, loss: 0.0002, instance_loss: 0.0850, weighted_loss: 0.0256, label: 4, bag_size: 174
batch 539, loss: 0.0879, instance_loss: 0.5908, weighted_loss: 0.2387, label: 3, bag_size: 671


class 0 clustering acc 0.9870183486238532: correct 21517/21800
class 1 clustering acc 0.566743119266055: correct 2471/4360
Epoch: 37, train_loss: 0.1329, train_clustering_loss:  0.2461, train_error: 0.0404
class 0: acc 0.9830508474576272, correct 116/118
class 1: acc 0.8977272727272727, correct 79/88
class 2: acc 0.9137931034482759, correct 106/116
class 3: acc 1.0, correct 118/118
class 4: acc 0.9904761904761905, correct 104/105

Val Set, val_loss: 1.1382, val_error: 0.4000, auc: 0.8757
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.38: correct 152/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0003, instance_loss: 0.2046, weighted_loss: 0.0616, label: 3, bag_size: 21
batch 39, loss: 0.0003, instance_loss: 0.0389, weighted_loss: 0.0119, label: 3, bag_size: 123
batch 59, loss: 0.0033, instance_loss: 0.0719, weighted_loss: 0.0239, label: 1, bag_size: 1261
batch 79, loss: 0.0565, instance_loss: 0.5302, weighted_loss: 0.1986, label: 3, bag_size: 230
batch 99, loss: 0.0367, instance_loss: 0.1087, weighted_loss: 0.0583, label: 1, bag_size: 1086
batch 119, loss: 0.0084, instance_loss: 0.1322, weighted_loss: 0.0455, label: 0, bag_size: 437
batch 139, loss: 0.0243, instance_loss: 0.1462, weighted_loss: 0.0609, label: 0, bag_size: 545
batch 159, loss: 0.0038, instance_loss: 0.1886, weighted_loss: 0.0593, label: 3, bag_size: 17
batch 179, loss: 0.0081, instance_loss: 0.5027, weighted_loss: 0.1565, label: 3, bag_size: 283
batch 199, loss: 0.0103, instance_loss: 0.3159, weighted_loss: 0.1020, label: 3, bag_size: 630
batch 219, loss: 0.3245, instance_loss: 0.5935, weighted_loss: 0.4052, label: 1, bag_size: 875
batch 239, loss: 0.0284, instance_loss: 0.3807, weighted_loss: 0.1341, label: 3, bag_size: 706
batch 259, loss: 0.0000, instance_loss: 0.0600, weighted_loss: 0.0180, label: 3, bag_size: 143
batch 279, loss: 0.0000, instance_loss: 0.0793, weighted_loss: 0.0238, label: 3, bag_size: 21
batch 299, loss: 0.3394, instance_loss: 0.1982, weighted_loss: 0.2970, label: 2, bag_size: 271
batch 319, loss: 0.0053, instance_loss: 0.4209, weighted_loss: 0.1299, label: 4, bag_size: 947
batch 339, loss: 0.0096, instance_loss: 0.2401, weighted_loss: 0.0788, label: 0, bag_size: 143
batch 359, loss: 0.1126, instance_loss: 0.2138, weighted_loss: 0.1429, label: 2, bag_size: 2826
batch 379, loss: 0.1018, instance_loss: 0.3035, weighted_loss: 0.1623, label: 2, bag_size: 499
batch 399, loss: 0.0001, instance_loss: 0.2915, weighted_loss: 0.0875, label: 4, bag_size: 24
batch 419, loss: 0.0551, instance_loss: 0.3657, weighted_loss: 0.1483, label: 0, bag_size: 1332
batch 439, loss: 0.2745, instance_loss: 0.3100, weighted_loss: 0.2851, label: 2, bag_size: 2703
batch 459, loss: 0.0098, instance_loss: 0.1402, weighted_loss: 0.0489, label: 0, bag_size: 1255
batch 479, loss: 0.0565, instance_loss: 0.4382, weighted_loss: 0.1710, label: 0, bag_size: 163
batch 499, loss: 0.0249, instance_loss: 0.1020, weighted_loss: 0.0480, label: 0, bag_size: 1034
batch 519, loss: 0.0288, instance_loss: 0.2884, weighted_loss: 0.1067, label: 4, bag_size: 773
batch 539, loss: 0.2133, instance_loss: 0.6216, weighted_loss: 0.3358, label: 1, bag_size: 1799


class 0 clustering acc 0.9859174311926605: correct 21493/21800
class 1 clustering acc 0.5339449541284403: correct 2328/4360
Epoch: 38, train_loss: 0.1640, train_clustering_loss:  0.2621, train_error: 0.0532
class 0: acc 0.9459459459459459, correct 105/111
class 1: acc 0.8878504672897196, correct 95/107
class 2: acc 0.9210526315789473, correct 105/114
class 3: acc 0.9818181818181818, correct 108/110
class 4: acc 1.0, correct 103/103

Val Set, val_loss: 1.2559, val_error: 0.4000, auc: 0.8714
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.37: correct 148/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0124, instance_loss: 0.2115, weighted_loss: 0.0722, label: 4, bag_size: 19
batch 39, loss: 0.2918, instance_loss: 0.5457, weighted_loss: 0.3679, label: 2, bag_size: 1400
batch 59, loss: 0.0004, instance_loss: 0.0655, weighted_loss: 0.0199, label: 3, bag_size: 35
batch 79, loss: 0.2887, instance_loss: 0.7391, weighted_loss: 0.4238, label: 3, bag_size: 281
batch 99, loss: 0.5743, instance_loss: 0.6391, weighted_loss: 0.5938, label: 1, bag_size: 838
batch 119, loss: 1.0983, instance_loss: 0.3446, weighted_loss: 0.8722, label: 2, bag_size: 330
batch 139, loss: 0.0912, instance_loss: 0.1788, weighted_loss: 0.1175, label: 1, bag_size: 534
batch 159, loss: 0.1567, instance_loss: 0.2143, weighted_loss: 0.1740, label: 0, bag_size: 200
batch 179, loss: 0.0725, instance_loss: 0.2148, weighted_loss: 0.1152, label: 2, bag_size: 809
batch 199, loss: 0.1108, instance_loss: 0.2730, weighted_loss: 0.1595, label: 1, bag_size: 530
batch 219, loss: 0.2178, instance_loss: 0.1826, weighted_loss: 0.2072, label: 1, bag_size: 1144
batch 239, loss: 0.0012, instance_loss: 0.2118, weighted_loss: 0.0644, label: 4, bag_size: 388
batch 259, loss: 0.0108, instance_loss: 0.3057, weighted_loss: 0.0993, label: 4, bag_size: 1278
batch 279, loss: 0.0003, instance_loss: 0.1064, weighted_loss: 0.0322, label: 3, bag_size: 20
batch 299, loss: 0.0079, instance_loss: 0.3077, weighted_loss: 0.0978, label: 3, bag_size: 1253
batch 319, loss: 0.0660, instance_loss: 0.1633, weighted_loss: 0.0952, label: 2, bag_size: 1289
batch 339, loss: 0.1090, instance_loss: 0.7457, weighted_loss: 0.3000, label: 1, bag_size: 936
batch 359, loss: 0.0076, instance_loss: 0.3057, weighted_loss: 0.0970, label: 1, bag_size: 399
batch 379, loss: 0.0269, instance_loss: 0.2626, weighted_loss: 0.0976, label: 0, bag_size: 1332
batch 399, loss: 0.0001, instance_loss: 0.0481, weighted_loss: 0.0145, label: 3, bag_size: 33
batch 419, loss: 0.0642, instance_loss: 0.6738, weighted_loss: 0.2471, label: 4, bag_size: 663
batch 439, loss: 0.0267, instance_loss: 0.1009, weighted_loss: 0.0490, label: 0, bag_size: 340
batch 459, loss: 0.0354, instance_loss: 0.1262, weighted_loss: 0.0626, label: 0, bag_size: 200
batch 479, loss: 0.0077, instance_loss: 0.2941, weighted_loss: 0.0937, label: 3, bag_size: 24
batch 499, loss: 0.0033, instance_loss: 0.0314, weighted_loss: 0.0118, label: 0, bag_size: 1018
batch 519, loss: 0.0379, instance_loss: 0.1362, weighted_loss: 0.0674, label: 0, bag_size: 545
batch 539, loss: 0.2084, instance_loss: 0.6632, weighted_loss: 0.3449, label: 4, bag_size: 656


class 0 clustering acc 0.985137614678899: correct 21476/21800
class 1 clustering acc 0.5348623853211009: correct 2332/4360
Epoch: 39, train_loss: 0.1339, train_clustering_loss:  0.2639, train_error: 0.0385
class 0: acc 0.975609756097561, correct 120/123
class 1: acc 0.9459459459459459, correct 105/111
class 2: acc 0.9083333333333333, correct 109/120
class 3: acc 0.989247311827957, correct 92/93
class 4: acc 1.0, correct 98/98

Val Set, val_loss: 1.3553, val_error: 0.4200, auc: 0.8661
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.375: correct 150/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0022, instance_loss: 0.2508, weighted_loss: 0.0767, label: 0, bag_size: 118
batch 39, loss: 0.0002, instance_loss: 0.0739, weighted_loss: 0.0223, label: 4, bag_size: 143
batch 59, loss: 0.0008, instance_loss: 0.1241, weighted_loss: 0.0378, label: 3, bag_size: 18
batch 79, loss: 0.1198, instance_loss: 0.5109, weighted_loss: 0.2371, label: 1, bag_size: 1144
batch 99, loss: 0.0376, instance_loss: 0.1579, weighted_loss: 0.0737, label: 0, bag_size: 962
batch 119, loss: 0.0014, instance_loss: 0.0448, weighted_loss: 0.0144, label: 4, bag_size: 63
batch 139, loss: 0.0110, instance_loss: 0.0917, weighted_loss: 0.0352, label: 1, bag_size: 1144
batch 159, loss: 0.0227, instance_loss: 0.4818, weighted_loss: 0.1604, label: 0, bag_size: 1332
batch 179, loss: 0.0151, instance_loss: 0.1067, weighted_loss: 0.0426, label: 1, bag_size: 1325
batch 199, loss: 0.0006, instance_loss: 0.0910, weighted_loss: 0.0277, label: 3, bag_size: 53
batch 219, loss: 0.1261, instance_loss: 0.1637, weighted_loss: 0.1374, label: 2, bag_size: 1514
batch 239, loss: 0.0500, instance_loss: 0.1195, weighted_loss: 0.0708, label: 0, bag_size: 1235
batch 259, loss: 0.0013, instance_loss: 0.1108, weighted_loss: 0.0341, label: 3, bag_size: 18
batch 279, loss: 0.1648, instance_loss: 0.4958, weighted_loss: 0.2641, label: 1, bag_size: 887
batch 299, loss: 0.5920, instance_loss: 0.6166, weighted_loss: 0.5994, label: 1, bag_size: 875
batch 319, loss: 0.0405, instance_loss: 0.2182, weighted_loss: 0.0938, label: 2, bag_size: 589
batch 339, loss: 0.0056, instance_loss: 0.1446, weighted_loss: 0.0473, label: 1, bag_size: 938
batch 359, loss: 0.0000, instance_loss: 0.0845, weighted_loss: 0.0254, label: 3, bag_size: 32
batch 379, loss: 2.6749, instance_loss: 0.7426, weighted_loss: 2.0952, label: 2, bag_size: 194
batch 399, loss: 0.0021, instance_loss: 0.2057, weighted_loss: 0.0632, label: 0, bag_size: 109
batch 419, loss: 0.0021, instance_loss: 0.2336, weighted_loss: 0.0716, label: 3, bag_size: 18
batch 439, loss: 0.0002, instance_loss: 0.0243, weighted_loss: 0.0075, label: 4, bag_size: 94
batch 459, loss: 0.0326, instance_loss: 0.1109, weighted_loss: 0.0561, label: 2, bag_size: 1281
batch 479, loss: 0.0015, instance_loss: 0.0593, weighted_loss: 0.0188, label: 0, bag_size: 607
batch 499, loss: 0.0020, instance_loss: 0.0565, weighted_loss: 0.0183, label: 4, bag_size: 44
batch 519, loss: 0.0320, instance_loss: 0.1366, weighted_loss: 0.0634, label: 2, bag_size: 419
batch 539, loss: 0.0879, instance_loss: 0.1220, weighted_loss: 0.0981, label: 0, bag_size: 912


class 0 clustering acc 0.9855504587155963: correct 21485/21800
class 1 clustering acc 0.5706422018348624: correct 2488/4360
Epoch: 40, train_loss: 0.1181, train_clustering_loss:  0.2514, train_error: 0.0404
class 0: acc 0.9345794392523364, correct 100/107
class 1: acc 0.9285714285714286, correct 91/98
class 2: acc 0.9514563106796117, correct 98/103
class 3: acc 0.9752066115702479, correct 118/121
class 4: acc 1.0, correct 116/116

Val Set, val_loss: 1.3731, val_error: 0.4600, auc: 0.8685
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.3475: correct 139/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0456, instance_loss: 0.1809, weighted_loss: 0.0862, label: 3, bag_size: 1019
batch 39, loss: 0.0716, instance_loss: 0.2620, weighted_loss: 0.1288, label: 2, bag_size: 1404
batch 59, loss: 0.0001, instance_loss: 0.1068, weighted_loss: 0.0321, label: 3, bag_size: 41
batch 79, loss: 0.0218, instance_loss: 0.0674, weighted_loss: 0.0355, label: 0, bag_size: 807
batch 99, loss: 0.0006, instance_loss: 0.0652, weighted_loss: 0.0200, label: 3, bag_size: 20
batch 119, loss: 0.0003, instance_loss: 0.1596, weighted_loss: 0.0481, label: 3, bag_size: 18
batch 139, loss: 0.0118, instance_loss: 0.0551, weighted_loss: 0.0248, label: 0, bag_size: 515
batch 159, loss: 0.0476, instance_loss: 0.3673, weighted_loss: 0.1435, label: 1, bag_size: 925
batch 179, loss: 0.0321, instance_loss: 0.5627, weighted_loss: 0.1913, label: 3, bag_size: 607
batch 199, loss: 0.0051, instance_loss: 0.2508, weighted_loss: 0.0788, label: 0, bag_size: 122
batch 219, loss: 0.0029, instance_loss: 0.0517, weighted_loss: 0.0175, label: 3, bag_size: 1069
batch 239, loss: 0.0007, instance_loss: 0.1044, weighted_loss: 0.0319, label: 0, bag_size: 109
batch 259, loss: 0.0967, instance_loss: 0.5729, weighted_loss: 0.2395, label: 4, bag_size: 436
batch 279, loss: 0.0003, instance_loss: 0.1777, weighted_loss: 0.0535, label: 3, bag_size: 18
batch 299, loss: 0.0003, instance_loss: 0.2660, weighted_loss: 0.0800, label: 3, bag_size: 15
batch 319, loss: 0.3084, instance_loss: 0.3639, weighted_loss: 0.3251, label: 1, bag_size: 1080
batch 339, loss: 0.0009, instance_loss: 0.2704, weighted_loss: 0.0818, label: 4, bag_size: 388
batch 359, loss: 0.0079, instance_loss: 0.0635, weighted_loss: 0.0246, label: 3, bag_size: 305
batch 379, loss: 0.0117, instance_loss: 0.3385, weighted_loss: 0.1097, label: 2, bag_size: 330
batch 399, loss: 0.0164, instance_loss: 0.1192, weighted_loss: 0.0472, label: 4, bag_size: 20
batch 419, loss: 0.0008, instance_loss: 0.0461, weighted_loss: 0.0144, label: 3, bag_size: 305
batch 439, loss: 0.0431, instance_loss: 0.2022, weighted_loss: 0.0908, label: 1, bag_size: 949
batch 459, loss: 0.0064, instance_loss: 0.4260, weighted_loss: 0.1323, label: 1, bag_size: 818
batch 479, loss: 0.0027, instance_loss: 0.1983, weighted_loss: 0.0614, label: 4, bag_size: 19
batch 499, loss: 0.0007, instance_loss: 0.0278, weighted_loss: 0.0088, label: 3, bag_size: 56
batch 519, loss: 0.2006, instance_loss: 0.4340, weighted_loss: 0.2706, label: 2, bag_size: 934
batch 539, loss: 0.0617, instance_loss: 0.1723, weighted_loss: 0.0949, label: 0, bag_size: 630


class 0 clustering acc 0.984954128440367: correct 21472/21800
class 1 clustering acc 0.5612385321100918: correct 2447/4360
Epoch: 41, train_loss: 0.1308, train_clustering_loss:  0.2518, train_error: 0.0385
class 0: acc 0.9626168224299065, correct 103/107
class 1: acc 0.944954128440367, correct 103/109
class 2: acc 0.91, correct 91/100
class 3: acc 0.9919354838709677, correct 123/124
class 4: acc 0.9904761904761905, correct 104/105

Val Set, val_loss: 1.3842, val_error: 0.3600, auc: 0.8522
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.4175: correct 167/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0017, instance_loss: 0.1274, weighted_loss: 0.0394, label: 3, bag_size: 18
batch 39, loss: 0.0081, instance_loss: 0.1305, weighted_loss: 0.0448, label: 1, bag_size: 858
batch 59, loss: 0.1056, instance_loss: 0.2601, weighted_loss: 0.1520, label: 2, bag_size: 1378
batch 79, loss: 0.0132, instance_loss: 0.1690, weighted_loss: 0.0599, label: 2, bag_size: 292
batch 99, loss: 0.0173, instance_loss: 0.1138, weighted_loss: 0.0463, label: 1, bag_size: 682
batch 119, loss: 0.0869, instance_loss: 0.3507, weighted_loss: 0.1660, label: 2, bag_size: 741
batch 139, loss: 0.0176, instance_loss: 0.1176, weighted_loss: 0.0476, label: 2, bag_size: 935
batch 159, loss: 0.1287, instance_loss: 0.5127, weighted_loss: 0.2439, label: 1, bag_size: 474
batch 179, loss: 0.1726, instance_loss: 0.2519, weighted_loss: 0.1964, label: 0, bag_size: 1061
batch 199, loss: 0.0135, instance_loss: 0.0889, weighted_loss: 0.0361, label: 0, bag_size: 760
batch 219, loss: 2.8711, instance_loss: 0.9142, weighted_loss: 2.2840, label: 1, bag_size: 660
batch 239, loss: 1.8250, instance_loss: 0.6536, weighted_loss: 1.4736, label: 2, bag_size: 194
batch 259, loss: 0.1124, instance_loss: 0.2902, weighted_loss: 0.1657, label: 2, bag_size: 1617
batch 279, loss: 0.2266, instance_loss: 0.1874, weighted_loss: 0.2148, label: 0, bag_size: 1061
batch 299, loss: 0.0029, instance_loss: 0.0861, weighted_loss: 0.0278, label: 1, bag_size: 690
batch 319, loss: 0.0082, instance_loss: 0.2066, weighted_loss: 0.0677, label: 0, bag_size: 120
batch 339, loss: 0.1641, instance_loss: 0.5308, weighted_loss: 0.2741, label: 4, bag_size: 1337
batch 359, loss: 0.0188, instance_loss: 0.1367, weighted_loss: 0.0542, label: 1, bag_size: 965
batch 379, loss: 0.5327, instance_loss: 0.4222, weighted_loss: 0.4995, label: 2, bag_size: 272
batch 399, loss: 0.0073, instance_loss: 0.6251, weighted_loss: 0.1926, label: 1, bag_size: 651
batch 419, loss: 0.5673, instance_loss: 0.4127, weighted_loss: 0.5209, label: 1, bag_size: 1049
batch 439, loss: 0.0815, instance_loss: 0.3701, weighted_loss: 0.1681, label: 2, bag_size: 264
batch 459, loss: 0.0013, instance_loss: 0.2511, weighted_loss: 0.0763, label: 0, bag_size: 155
batch 479, loss: 0.0165, instance_loss: 0.2443, weighted_loss: 0.0848, label: 3, bag_size: 18
batch 499, loss: 0.0436, instance_loss: 0.2806, weighted_loss: 0.1147, label: 2, bag_size: 1164
batch 519, loss: 0.0000, instance_loss: 0.0398, weighted_loss: 0.0119, label: 4, bag_size: 157
batch 539, loss: 0.6964, instance_loss: 0.3330, weighted_loss: 0.5874, label: 0, bag_size: 437


class 0 clustering acc 0.983440366972477: correct 21439/21800
class 1 clustering acc 0.5589449541284404: correct 2437/4360
Epoch: 42, train_loss: 0.1296, train_clustering_loss:  0.2578, train_error: 0.0294
class 0: acc 0.9809523809523809, correct 103/105
class 1: acc 0.967741935483871, correct 120/124
class 2: acc 0.9310344827586207, correct 108/116
class 3: acc 0.9807692307692307, correct 102/104
class 4: acc 1.0, correct 96/96

Val Set, val_loss: 1.2965, val_error: 0.4000, auc: 0.8669
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.3875: correct 155/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0013, instance_loss: 0.0398, weighted_loss: 0.0129, label: 0, bag_size: 898
batch 39, loss: 0.3671, instance_loss: 0.4627, weighted_loss: 0.3958, label: 2, bag_size: 629
batch 59, loss: 1.3023, instance_loss: 0.7354, weighted_loss: 1.1322, label: 2, bag_size: 194
batch 79, loss: 0.0108, instance_loss: 0.0359, weighted_loss: 0.0183, label: 3, bag_size: 1172
batch 99, loss: 0.0141, instance_loss: 0.1619, weighted_loss: 0.0584, label: 3, bag_size: 451
batch 119, loss: 0.0180, instance_loss: 0.2495, weighted_loss: 0.0875, label: 2, bag_size: 1215
batch 139, loss: 0.0019, instance_loss: 0.0889, weighted_loss: 0.0280, label: 3, bag_size: 20
batch 159, loss: 0.1154, instance_loss: 0.2922, weighted_loss: 0.1684, label: 2, bag_size: 384
batch 179, loss: 0.0170, instance_loss: 0.1610, weighted_loss: 0.0602, label: 2, bag_size: 2826
batch 199, loss: 0.0292, instance_loss: 0.6091, weighted_loss: 0.2032, label: 3, bag_size: 671
batch 219, loss: 0.0903, instance_loss: 0.4887, weighted_loss: 0.2098, label: 3, bag_size: 1250
batch 239, loss: 0.0210, instance_loss: 0.2402, weighted_loss: 0.0868, label: 1, bag_size: 968
batch 259, loss: 0.0002, instance_loss: 0.0592, weighted_loss: 0.0179, label: 4, bag_size: 48
batch 279, loss: 0.0031, instance_loss: 0.3646, weighted_loss: 0.1116, label: 2, bag_size: 636
batch 299, loss: 1.3212, instance_loss: 0.5098, weighted_loss: 1.0778, label: 2, bag_size: 629
batch 319, loss: 0.0023, instance_loss: 0.1285, weighted_loss: 0.0401, label: 2, bag_size: 913
batch 339, loss: 0.0031, instance_loss: 0.1224, weighted_loss: 0.0389, label: 0, bag_size: 117
batch 359, loss: 0.1978, instance_loss: 0.3299, weighted_loss: 0.2374, label: 2, bag_size: 986
batch 379, loss: 0.0004, instance_loss: 0.1874, weighted_loss: 0.0565, label: 3, bag_size: 53
batch 399, loss: 0.0254, instance_loss: 0.1317, weighted_loss: 0.0573, label: 2, bag_size: 2081
batch 419, loss: 0.1185, instance_loss: 0.1995, weighted_loss: 0.1428, label: 0, bag_size: 1034
batch 439, loss: 0.0523, instance_loss: 0.3159, weighted_loss: 0.1314, label: 1, bag_size: 897
batch 459, loss: 0.0017, instance_loss: 0.0387, weighted_loss: 0.0128, label: 0, bag_size: 518
batch 479, loss: 0.7501, instance_loss: 0.6216, weighted_loss: 0.7115, label: 2, bag_size: 307
batch 499, loss: 0.0057, instance_loss: 0.0569, weighted_loss: 0.0211, label: 0, bag_size: 616
batch 519, loss: 0.0005, instance_loss: 0.1666, weighted_loss: 0.0503, label: 3, bag_size: 18
batch 539, loss: 0.0000, instance_loss: 0.0825, weighted_loss: 0.0248, label: 4, bag_size: 128


class 0 clustering acc 0.9868807339449541: correct 21514/21800
class 1 clustering acc 0.5431192660550459: correct 2368/4360
Epoch: 43, train_loss: 0.1577, train_clustering_loss:  0.2631, train_error: 0.0532
class 0: acc 0.9252336448598131, correct 99/107
class 1: acc 0.9285714285714286, correct 91/98
class 2: acc 0.905511811023622, correct 115/127
class 3: acc 1.0, correct 118/118
class 4: acc 0.9789473684210527, correct 93/95

Val Set, val_loss: 1.3148, val_error: 0.4200, auc: 0.8685
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0074, instance_loss: 0.0448, weighted_loss: 0.0186, label: 3, bag_size: 29
batch 39, loss: 0.0001, instance_loss: 0.0846, weighted_loss: 0.0255, label: 3, bag_size: 28
batch 59, loss: 0.0021, instance_loss: 0.2036, weighted_loss: 0.0626, label: 0, bag_size: 129
batch 79, loss: 0.0033, instance_loss: 0.2216, weighted_loss: 0.0688, label: 0, bag_size: 136
batch 99, loss: 0.0017, instance_loss: 0.0241, weighted_loss: 0.0085, label: 0, bag_size: 616
batch 119, loss: 0.0029, instance_loss: 0.1538, weighted_loss: 0.0482, label: 0, bag_size: 109
batch 139, loss: 0.0173, instance_loss: 0.2385, weighted_loss: 0.0837, label: 2, bag_size: 542
batch 159, loss: 0.0162, instance_loss: 0.2820, weighted_loss: 0.0959, label: 2, bag_size: 766
batch 179, loss: 0.0036, instance_loss: 0.1550, weighted_loss: 0.0490, label: 1, bag_size: 949
batch 199, loss: 1.1129, instance_loss: 0.5572, weighted_loss: 0.9462, label: 2, bag_size: 345
batch 219, loss: 0.0071, instance_loss: 0.5458, weighted_loss: 0.1687, label: 1, bag_size: 319
batch 239, loss: 0.5699, instance_loss: 0.4976, weighted_loss: 0.5482, label: 2, bag_size: 1139
batch 259, loss: 0.0000, instance_loss: 0.0414, weighted_loss: 0.0124, label: 4, bag_size: 211
batch 279, loss: 0.0307, instance_loss: 0.0471, weighted_loss: 0.0356, label: 0, bag_size: 1235
batch 299, loss: 0.0642, instance_loss: 0.7565, weighted_loss: 0.2719, label: 1, bag_size: 936
batch 319, loss: 0.1681, instance_loss: 0.3355, weighted_loss: 0.2183, label: 0, bag_size: 868
batch 339, loss: 0.0551, instance_loss: 0.3536, weighted_loss: 0.1446, label: 2, bag_size: 1215
batch 359, loss: 0.0000, instance_loss: 0.0600, weighted_loss: 0.0180, label: 3, bag_size: 105
batch 379, loss: 0.1114, instance_loss: 0.5619, weighted_loss: 0.2466, label: 4, bag_size: 754
batch 399, loss: 0.0701, instance_loss: 0.4435, weighted_loss: 0.1821, label: 1, bag_size: 319
batch 419, loss: 0.0001, instance_loss: 0.1284, weighted_loss: 0.0386, label: 4, bag_size: 20
batch 439, loss: 0.0046, instance_loss: 0.1490, weighted_loss: 0.0479, label: 3, bag_size: 18
batch 459, loss: 0.0200, instance_loss: 0.1908, weighted_loss: 0.0712, label: 1, bag_size: 754
batch 479, loss: 0.1303, instance_loss: 0.5613, weighted_loss: 0.2596, label: 4, bag_size: 1337
batch 499, loss: 0.0057, instance_loss: 0.1431, weighted_loss: 0.0469, label: 0, bag_size: 1196
batch 519, loss: 0.0078, instance_loss: 0.1554, weighted_loss: 0.0521, label: 0, bag_size: 524
batch 539, loss: 0.0163, instance_loss: 0.5321, weighted_loss: 0.1711, label: 3, bag_size: 317


class 0 clustering acc 0.9868807339449541: correct 21514/21800
class 1 clustering acc 0.5979357798165138: correct 2607/4360
Epoch: 44, train_loss: 0.0812, train_clustering_loss:  0.2300, train_error: 0.0183
class 0: acc 1.0, correct 118/118
class 1: acc 0.967479674796748, correct 119/123
class 2: acc 0.9494949494949495, correct 94/99
class 3: acc 0.9900990099009901, correct 100/101
class 4: acc 1.0, correct 104/104

Val Set, val_loss: 1.6401, val_error: 0.4600, auc: 0.8467
class 0 clustering acc 0.966: correct 1932/2000
class 1 clustering acc 0.39: correct 156/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0060, instance_loss: 0.0404, weighted_loss: 0.0163, label: 1, bag_size: 847
batch 39, loss: 0.0021, instance_loss: 0.1015, weighted_loss: 0.0319, label: 1, bag_size: 1402
batch 59, loss: 0.0008, instance_loss: 0.3118, weighted_loss: 0.0941, label: 1, bag_size: 1152
batch 79, loss: 0.0073, instance_loss: 0.3394, weighted_loss: 0.1069, label: 0, bag_size: 155
batch 99, loss: 0.0035, instance_loss: 0.3736, weighted_loss: 0.1146, label: 2, bag_size: 750
batch 119, loss: 0.0003, instance_loss: 0.0373, weighted_loss: 0.0114, label: 4, bag_size: 125
batch 139, loss: 0.0000, instance_loss: 0.2304, weighted_loss: 0.0691, label: 4, bag_size: 1002
batch 159, loss: 0.2257, instance_loss: 0.3741, weighted_loss: 0.2702, label: 0, bag_size: 801
batch 179, loss: 0.2347, instance_loss: 0.2187, weighted_loss: 0.2299, label: 1, bag_size: 897
batch 199, loss: 0.0208, instance_loss: 0.3724, weighted_loss: 0.1263, label: 2, bag_size: 784
batch 219, loss: 0.1717, instance_loss: 0.8159, weighted_loss: 0.3650, label: 4, bag_size: 1331
batch 239, loss: 0.0499, instance_loss: 0.3208, weighted_loss: 0.1311, label: 1, bag_size: 1096
batch 259, loss: 0.0000, instance_loss: 0.1603, weighted_loss: 0.0481, label: 3, bag_size: 18
batch 279, loss: 0.0001, instance_loss: 0.0450, weighted_loss: 0.0135, label: 4, bag_size: 160
batch 299, loss: 0.0000, instance_loss: 0.0314, weighted_loss: 0.0094, label: 3, bag_size: 33
batch 319, loss: 0.0109, instance_loss: 0.0400, weighted_loss: 0.0196, label: 4, bag_size: 137
batch 339, loss: 2.3321, instance_loss: 0.4685, weighted_loss: 1.7730, label: 4, bag_size: 1235
batch 359, loss: 0.0312, instance_loss: 0.1228, weighted_loss: 0.0587, label: 0, bag_size: 1247
batch 379, loss: 0.1006, instance_loss: 0.3864, weighted_loss: 0.1863, label: 2, bag_size: 409
batch 399, loss: 0.0519, instance_loss: 0.3402, weighted_loss: 0.1384, label: 1, bag_size: 1559
batch 419, loss: 0.0001, instance_loss: 0.0603, weighted_loss: 0.0182, label: 4, bag_size: 167
batch 439, loss: 0.0009, instance_loss: 0.2264, weighted_loss: 0.0686, label: 2, bag_size: 330
batch 459, loss: 0.0156, instance_loss: 0.0796, weighted_loss: 0.0348, label: 0, bag_size: 1034
batch 479, loss: 0.0053, instance_loss: 0.0962, weighted_loss: 0.0326, label: 3, bag_size: 18
batch 499, loss: 0.0299, instance_loss: 0.2819, weighted_loss: 0.1055, label: 3, bag_size: 706
batch 519, loss: 0.0145, instance_loss: 0.1810, weighted_loss: 0.0644, label: 0, bag_size: 478
batch 539, loss: 0.0000, instance_loss: 0.1190, weighted_loss: 0.0357, label: 4, bag_size: 101


class 0 clustering acc 0.9863302752293578: correct 21502/21800
class 1 clustering acc 0.5770642201834862: correct 2516/4360
Epoch: 45, train_loss: 0.1136, train_clustering_loss:  0.2480, train_error: 0.0275
class 0: acc 1.0, correct 94/94
class 1: acc 0.9591836734693877, correct 94/98
class 2: acc 0.9150943396226415, correct 97/106
class 3: acc 0.9925925925925926, correct 134/135
class 4: acc 0.9910714285714286, correct 111/112

Val Set, val_loss: 1.3730, val_error: 0.4200, auc: 0.8583
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.3675: correct 147/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.625, correct 5/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0861, instance_loss: 0.2966, weighted_loss: 0.1493, label: 2, bag_size: 1416
batch 39, loss: 0.2794, instance_loss: 0.2662, weighted_loss: 0.2754, label: 0, bag_size: 1247
batch 59, loss: 0.2366, instance_loss: 0.2090, weighted_loss: 0.2283, label: 2, bag_size: 1306
batch 79, loss: 0.0000, instance_loss: 0.0356, weighted_loss: 0.0107, label: 4, bag_size: 140
batch 99, loss: 0.0013, instance_loss: 0.2531, weighted_loss: 0.0768, label: 3, bag_size: 18
batch 119, loss: 0.0270, instance_loss: 0.2536, weighted_loss: 0.0950, label: 2, bag_size: 355
batch 139, loss: 0.0222, instance_loss: 0.4272, weighted_loss: 0.1437, label: 1, bag_size: 442
batch 159, loss: 0.0062, instance_loss: 0.3618, weighted_loss: 0.1129, label: 4, bag_size: 773
batch 179, loss: 0.0057, instance_loss: 0.1769, weighted_loss: 0.0571, label: 0, bag_size: 478
batch 199, loss: 0.0054, instance_loss: 0.1268, weighted_loss: 0.0418, label: 4, bag_size: 137
batch 219, loss: 0.0053, instance_loss: 0.0658, weighted_loss: 0.0234, label: 4, bag_size: 91
batch 239, loss: 0.0049, instance_loss: 0.0513, weighted_loss: 0.0188, label: 0, bag_size: 921
batch 259, loss: 0.0309, instance_loss: 0.1228, weighted_loss: 0.0585, label: 3, bag_size: 1172
batch 279, loss: 0.0352, instance_loss: 0.8051, weighted_loss: 0.2662, label: 3, bag_size: 1250
batch 299, loss: 0.0000, instance_loss: 0.0473, weighted_loss: 0.0142, label: 4, bag_size: 185
batch 319, loss: 0.1017, instance_loss: 0.3022, weighted_loss: 0.1618, label: 2, bag_size: 471
batch 339, loss: 0.0979, instance_loss: 0.6026, weighted_loss: 0.2493, label: 4, bag_size: 1337
batch 359, loss: 0.0012, instance_loss: 0.0908, weighted_loss: 0.0281, label: 3, bag_size: 18
batch 379, loss: 0.0000, instance_loss: 0.0331, weighted_loss: 0.0099, label: 3, bag_size: 24
batch 399, loss: 0.0326, instance_loss: 0.1479, weighted_loss: 0.0672, label: 1, bag_size: 828
batch 419, loss: 0.1516, instance_loss: 0.3766, weighted_loss: 0.2191, label: 2, bag_size: 1050
batch 439, loss: 0.3408, instance_loss: 0.3511, weighted_loss: 0.3439, label: 0, bag_size: 155
batch 459, loss: 0.0014, instance_loss: 0.0192, weighted_loss: 0.0067, label: 0, bag_size: 602
batch 479, loss: 0.0365, instance_loss: 0.2314, weighted_loss: 0.0950, label: 0, bag_size: 630
batch 499, loss: 0.0000, instance_loss: 0.0783, weighted_loss: 0.0235, label: 4, bag_size: 157
batch 519, loss: 0.0116, instance_loss: 0.2659, weighted_loss: 0.0879, label: 2, bag_size: 1039
batch 539, loss: 0.0012, instance_loss: 0.1913, weighted_loss: 0.0582, label: 0, bag_size: 117


class 0 clustering acc 0.9846330275229358: correct 21465/21800
class 1 clustering acc 0.5451834862385321: correct 2377/4360
Epoch: 46, train_loss: 0.1132, train_clustering_loss:  0.2647, train_error: 0.0367
class 0: acc 0.9719626168224299, correct 104/107
class 1: acc 0.9661016949152542, correct 114/118
class 2: acc 0.905982905982906, correct 106/117
class 3: acc 0.9894736842105263, correct 94/95
class 4: acc 0.9907407407407407, correct 107/108

Val Set, val_loss: 1.5644, val_error: 0.4800, auc: 0.8466
class 0 clustering acc 0.9655: correct 1931/2000
class 1 clustering acc 0.3775: correct 151/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.375, correct 3/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0156, instance_loss: 0.6963, weighted_loss: 0.2198, label: 3, bag_size: 283
batch 39, loss: 0.0018, instance_loss: 0.0720, weighted_loss: 0.0228, label: 0, bag_size: 607
batch 59, loss: 0.7396, instance_loss: 0.8489, weighted_loss: 0.7724, label: 3, bag_size: 607
batch 79, loss: 0.0554, instance_loss: 0.1449, weighted_loss: 0.0823, label: 2, bag_size: 347
batch 99, loss: 0.0812, instance_loss: 0.2091, weighted_loss: 0.1196, label: 1, bag_size: 913
batch 119, loss: 0.0049, instance_loss: 0.2367, weighted_loss: 0.0744, label: 1, bag_size: 846
batch 139, loss: 0.0617, instance_loss: 0.2545, weighted_loss: 0.1196, label: 0, bag_size: 381
batch 159, loss: 0.0064, instance_loss: 0.5436, weighted_loss: 0.1675, label: 1, bag_size: 651
batch 179, loss: 0.0035, instance_loss: 0.2225, weighted_loss: 0.0692, label: 1, bag_size: 898
batch 199, loss: 0.0077, instance_loss: 0.0485, weighted_loss: 0.0200, label: 1, bag_size: 346
batch 219, loss: 0.0042, instance_loss: 0.3304, weighted_loss: 0.1020, label: 2, bag_size: 312
batch 239, loss: 0.0145, instance_loss: 0.0424, weighted_loss: 0.0229, label: 0, bag_size: 962
batch 259, loss: 0.0115, instance_loss: 0.1244, weighted_loss: 0.0454, label: 4, bag_size: 86
batch 279, loss: 0.1876, instance_loss: 0.2844, weighted_loss: 0.2167, label: 0, bag_size: 381
batch 299, loss: 0.0000, instance_loss: 0.2099, weighted_loss: 0.0630, label: 4, bag_size: 30
batch 319, loss: 0.0002, instance_loss: 0.0132, weighted_loss: 0.0041, label: 0, bag_size: 1466
batch 339, loss: 0.0107, instance_loss: 0.2175, weighted_loss: 0.0727, label: 1, bag_size: 965
batch 359, loss: 0.0067, instance_loss: 0.1265, weighted_loss: 0.0426, label: 2, bag_size: 400
batch 379, loss: 0.0256, instance_loss: 0.3633, weighted_loss: 0.1269, label: 2, bag_size: 508
batch 399, loss: 0.0947, instance_loss: 0.2839, weighted_loss: 0.1515, label: 2, bag_size: 806
batch 419, loss: 0.0517, instance_loss: 0.2171, weighted_loss: 0.1013, label: 4, bag_size: 17
batch 439, loss: 0.0010, instance_loss: 0.0300, weighted_loss: 0.0097, label: 0, bag_size: 602
batch 459, loss: 0.0023, instance_loss: 0.1432, weighted_loss: 0.0446, label: 1, bag_size: 1402
batch 479, loss: 0.0068, instance_loss: 0.2485, weighted_loss: 0.0793, label: 2, bag_size: 292
batch 499, loss: 0.0853, instance_loss: 0.3210, weighted_loss: 0.1560, label: 2, bag_size: 272
batch 519, loss: 0.3445, instance_loss: 0.7784, weighted_loss: 0.4747, label: 1, bag_size: 1144
batch 539, loss: 0.0281, instance_loss: 0.5961, weighted_loss: 0.1985, label: 3, bag_size: 791


class 0 clustering acc 0.9834862385321101: correct 21440/21800
class 1 clustering acc 0.5713302752293578: correct 2491/4360
Epoch: 47, train_loss: 0.0872, train_clustering_loss:  0.2580, train_error: 0.0220
class 0: acc 1.0, correct 115/115
class 1: acc 0.9834710743801653, correct 119/121
class 2: acc 0.9074074074074074, correct 98/108
class 3: acc 1.0, correct 90/90
class 4: acc 1.0, correct 111/111

Val Set, val_loss: 1.4817, val_error: 0.4400, auc: 0.8578
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.3975: correct 159/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.25, correct 2/8
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.1118, instance_loss: 0.2481, weighted_loss: 0.1527, label: 1, bag_size: 1191
batch 39, loss: 0.0078, instance_loss: 0.1864, weighted_loss: 0.0614, label: 2, bag_size: 499
batch 59, loss: 0.0001, instance_loss: 0.0722, weighted_loss: 0.0217, label: 4, bag_size: 40
batch 79, loss: 0.0616, instance_loss: 0.2296, weighted_loss: 0.1120, label: 0, bag_size: 118
batch 99, loss: 0.0668, instance_loss: 0.2461, weighted_loss: 0.1206, label: 0, bag_size: 1527
batch 119, loss: 0.0430, instance_loss: 0.1649, weighted_loss: 0.0796, label: 2, bag_size: 941
batch 139, loss: 0.0010, instance_loss: 0.0400, weighted_loss: 0.0127, label: 0, bag_size: 1143
batch 159, loss: 0.0011, instance_loss: 0.0163, weighted_loss: 0.0056, label: 3, bag_size: 54
batch 179, loss: 0.0162, instance_loss: 0.3092, weighted_loss: 0.1041, label: 4, bag_size: 354
batch 199, loss: 0.0282, instance_loss: 0.4890, weighted_loss: 0.1664, label: 1, bag_size: 319
batch 219, loss: 2.0182, instance_loss: 0.6650, weighted_loss: 1.6122, label: 0, bag_size: 760
batch 239, loss: 0.0001, instance_loss: 0.2746, weighted_loss: 0.0825, label: 3, bag_size: 20
batch 259, loss: 0.0041, instance_loss: 0.1731, weighted_loss: 0.0548, label: 0, bag_size: 129
batch 279, loss: 0.0520, instance_loss: 0.2464, weighted_loss: 0.1103, label: 2, bag_size: 396
batch 299, loss: 0.3053, instance_loss: 0.3999, weighted_loss: 0.3337, label: 1, bag_size: 898
batch 319, loss: 0.1242, instance_loss: 0.3735, weighted_loss: 0.1990, label: 4, bag_size: 1235
batch 339, loss: 0.0113, instance_loss: 0.1612, weighted_loss: 0.0563, label: 0, bag_size: 338
batch 359, loss: 0.0175, instance_loss: 0.1289, weighted_loss: 0.0509, label: 0, bag_size: 800
batch 379, loss: 0.0314, instance_loss: 0.4972, weighted_loss: 0.1712, label: 1, bag_size: 487
batch 399, loss: 0.0207, instance_loss: 0.2594, weighted_loss: 0.0923, label: 1, bag_size: 474
batch 419, loss: 0.0065, instance_loss: 0.1524, weighted_loss: 0.0502, label: 2, bag_size: 846
batch 439, loss: 0.0006, instance_loss: 0.0514, weighted_loss: 0.0158, label: 0, bag_size: 898
batch 459, loss: 0.1151, instance_loss: 0.6156, weighted_loss: 0.2653, label: 1, bag_size: 1409
batch 479, loss: 0.0207, instance_loss: 0.2392, weighted_loss: 0.0863, label: 3, bag_size: 697
batch 499, loss: 0.0912, instance_loss: 0.5313, weighted_loss: 0.2232, label: 1, bag_size: 786
batch 519, loss: 0.0120, instance_loss: 0.2783, weighted_loss: 0.0919, label: 2, bag_size: 655
batch 539, loss: 0.2444, instance_loss: 0.3716, weighted_loss: 0.2826, label: 2, bag_size: 384


class 0 clustering acc 0.9852293577981651: correct 21478/21800
class 1 clustering acc 0.5646788990825689: correct 2462/4360
Epoch: 48, train_loss: 0.1044, train_clustering_loss:  0.2579, train_error: 0.0275
class 0: acc 0.9736842105263158, correct 111/114
class 1: acc 0.9607843137254902, correct 98/102
class 2: acc 0.9272727272727272, correct 102/110
class 3: acc 1.0, correct 122/122
class 4: acc 1.0, correct 97/97

Val Set, val_loss: 1.2975, val_error: 0.4400, auc: 0.8719
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.38: correct 152/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0297, instance_loss: 0.4544, weighted_loss: 0.1571, label: 1, bag_size: 778
batch 39, loss: 0.0019, instance_loss: 0.2057, weighted_loss: 0.0631, label: 0, bag_size: 136
batch 59, loss: 0.0000, instance_loss: 0.1285, weighted_loss: 0.0385, label: 3, bag_size: 18
batch 79, loss: 0.0196, instance_loss: 0.3144, weighted_loss: 0.1081, label: 2, bag_size: 252
batch 99, loss: 0.0004, instance_loss: 0.2296, weighted_loss: 0.0691, label: 4, bag_size: 19
batch 119, loss: 0.0009, instance_loss: 0.1787, weighted_loss: 0.0542, label: 0, bag_size: 143
batch 139, loss: 0.0050, instance_loss: 0.3191, weighted_loss: 0.0992, label: 3, bag_size: 936
batch 159, loss: 0.0000, instance_loss: 0.0227, weighted_loss: 0.0068, label: 3, bag_size: 105
batch 179, loss: 0.0001, instance_loss: 0.0681, weighted_loss: 0.0205, label: 3, bag_size: 53
batch 199, loss: 0.0001, instance_loss: 0.0648, weighted_loss: 0.0195, label: 4, bag_size: 47
batch 219, loss: 0.0000, instance_loss: 0.0835, weighted_loss: 0.0251, label: 4, bag_size: 44
batch 239, loss: 0.0115, instance_loss: 0.1359, weighted_loss: 0.0488, label: 1, bag_size: 1191
batch 259, loss: 0.0018, instance_loss: 0.3127, weighted_loss: 0.0951, label: 4, bag_size: 1357
batch 279, loss: 0.0009, instance_loss: 0.0212, weighted_loss: 0.0070, label: 0, bag_size: 1196
batch 299, loss: 0.0000, instance_loss: 0.0753, weighted_loss: 0.0226, label: 4, bag_size: 162
batch 319, loss: 0.0604, instance_loss: 0.4323, weighted_loss: 0.1720, label: 3, bag_size: 791
batch 339, loss: 0.0148, instance_loss: 0.3293, weighted_loss: 0.1092, label: 2, bag_size: 307
batch 359, loss: 0.6140, instance_loss: 0.4829, weighted_loss: 0.5747, label: 4, bag_size: 817
batch 379, loss: 0.0165, instance_loss: 0.3175, weighted_loss: 0.1068, label: 1, bag_size: 867
batch 399, loss: 0.0255, instance_loss: 0.3433, weighted_loss: 0.1209, label: 1, bag_size: 1144
batch 419, loss: 0.0013, instance_loss: 0.2506, weighted_loss: 0.0761, label: 0, bag_size: 128
batch 439, loss: 0.0000, instance_loss: 0.0377, weighted_loss: 0.0113, label: 4, bag_size: 211
batch 459, loss: 0.0007, instance_loss: 0.1686, weighted_loss: 0.0511, label: 4, bag_size: 24
batch 479, loss: 0.0201, instance_loss: 0.1386, weighted_loss: 0.0557, label: 0, bag_size: 381
batch 499, loss: 0.0000, instance_loss: 0.0539, weighted_loss: 0.0162, label: 3, bag_size: 26
batch 519, loss: 0.0167, instance_loss: 0.1464, weighted_loss: 0.0556, label: 1, bag_size: 1277
batch 539, loss: 0.2947, instance_loss: 0.4155, weighted_loss: 0.3309, label: 1, bag_size: 405


class 0 clustering acc 0.988165137614679: correct 21542/21800
class 1 clustering acc 0.5855504587155963: correct 2553/4360
Epoch: 49, train_loss: 0.0858, train_clustering_loss:  0.2397, train_error: 0.0220
class 0: acc 0.990990990990991, correct 110/111
class 1: acc 0.9809523809523809, correct 103/105
class 2: acc 0.95, correct 95/100
class 3: acc 0.9814814814814815, correct 106/108
class 4: acc 0.9834710743801653, correct 119/121

Val Set, val_loss: 1.3567, val_error: 0.3800, auc: 0.8776
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.42: correct 168/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.375, correct 3/8
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.1977, instance_loss: 0.2455, weighted_loss: 0.2120, label: 2, bag_size: 868
batch 39, loss: 0.0235, instance_loss: 0.1744, weighted_loss: 0.0688, label: 1, bag_size: 504
batch 59, loss: 0.0082, instance_loss: 0.1594, weighted_loss: 0.0536, label: 0, bag_size: 375
batch 79, loss: 0.0212, instance_loss: 0.2227, weighted_loss: 0.0816, label: 0, bag_size: 129
batch 99, loss: 0.0758, instance_loss: 0.3590, weighted_loss: 0.1608, label: 0, bag_size: 176
batch 119, loss: 0.0121, instance_loss: 0.2142, weighted_loss: 0.0727, label: 2, bag_size: 1164
batch 139, loss: 0.2221, instance_loss: 0.4637, weighted_loss: 0.2946, label: 0, bag_size: 801
batch 159, loss: 0.3555, instance_loss: 0.2297, weighted_loss: 0.3178, label: 1, bag_size: 847
batch 179, loss: 0.0001, instance_loss: 0.0291, weighted_loss: 0.0088, label: 4, bag_size: 143
batch 199, loss: 0.0127, instance_loss: 0.4202, weighted_loss: 0.1350, label: 4, bag_size: 1474
batch 219, loss: 0.0016, instance_loss: 0.0207, weighted_loss: 0.0074, label: 4, bag_size: 160
batch 239, loss: 0.0006, instance_loss: 0.2084, weighted_loss: 0.0629, label: 0, bag_size: 116
batch 259, loss: 0.0005, instance_loss: 0.0370, weighted_loss: 0.0114, label: 0, bag_size: 898
batch 279, loss: 0.0145, instance_loss: 0.1853, weighted_loss: 0.0658, label: 0, bag_size: 545
batch 299, loss: 0.1864, instance_loss: 0.3974, weighted_loss: 0.2497, label: 1, bag_size: 377
batch 319, loss: 0.0043, instance_loss: 0.1555, weighted_loss: 0.0496, label: 1, bag_size: 614
batch 339, loss: 0.1482, instance_loss: 0.4716, weighted_loss: 0.2452, label: 4, bag_size: 675
batch 359, loss: 0.0006, instance_loss: 0.1240, weighted_loss: 0.0376, label: 3, bag_size: 18
batch 379, loss: 0.0283, instance_loss: 0.6170, weighted_loss: 0.2049, label: 4, bag_size: 542
batch 399, loss: 0.0033, instance_loss: 0.2186, weighted_loss: 0.0679, label: 0, bag_size: 122
batch 419, loss: 0.0046, instance_loss: 0.2843, weighted_loss: 0.0885, label: 4, bag_size: 1176
batch 439, loss: 0.0109, instance_loss: 0.2275, weighted_loss: 0.0758, label: 0, bag_size: 607
batch 459, loss: 0.0050, instance_loss: 0.1570, weighted_loss: 0.0506, label: 1, bag_size: 1402
batch 479, loss: 0.0003, instance_loss: 0.0100, weighted_loss: 0.0032, label: 3, bag_size: 97
batch 499, loss: 0.0616, instance_loss: 0.3381, weighted_loss: 0.1446, label: 2, bag_size: 358
batch 519, loss: 0.0153, instance_loss: 0.4422, weighted_loss: 0.1434, label: 4, bag_size: 1337
batch 539, loss: 0.0077, instance_loss: 0.1764, weighted_loss: 0.0583, label: 2, bag_size: 499


class 0 clustering acc 0.9861009174311927: correct 21497/21800
class 1 clustering acc 0.5630733944954128: correct 2455/4360
Epoch: 50, train_loss: 0.0777, train_clustering_loss:  0.2542, train_error: 0.0220
class 0: acc 0.9719626168224299, correct 104/107
class 1: acc 0.9369369369369369, correct 104/111
class 2: acc 0.9824561403508771, correct 112/114
class 3: acc 1.0, correct 109/109
class 4: acc 1.0, correct 104/104

Val Set, val_loss: 1.4222, val_error: 0.3800, auc: 0.8773
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.3875: correct 155/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.375, correct 3/8
class 4: acc 1.0, correct 2/2
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0142, instance_loss: 0.3541, weighted_loss: 0.1161, label: 1, bag_size: 1049
batch 39, loss: 0.0000, instance_loss: 0.0131, weighted_loss: 0.0039, label: 4, bag_size: 157
batch 59, loss: 0.0000, instance_loss: 0.2941, weighted_loss: 0.0882, label: 4, bag_size: 1002
batch 79, loss: 0.0000, instance_loss: 0.0471, weighted_loss: 0.0141, label: 4, bag_size: 83
batch 99, loss: 0.0077, instance_loss: 0.6485, weighted_loss: 0.1999, label: 4, bag_size: 1360
batch 119, loss: 0.0312, instance_loss: 0.1858, weighted_loss: 0.0776, label: 2, bag_size: 1164
batch 139, loss: 0.0121, instance_loss: 0.1754, weighted_loss: 0.0611, label: 2, bag_size: 701
batch 159, loss: 0.0001, instance_loss: 0.2045, weighted_loss: 0.0614, label: 4, bag_size: 38
batch 179, loss: 0.0346, instance_loss: 0.1606, weighted_loss: 0.0724, label: 0, bag_size: 800
batch 199, loss: 0.0025, instance_loss: 0.1564, weighted_loss: 0.0486, label: 2, bag_size: 471
batch 219, loss: 0.1389, instance_loss: 0.2991, weighted_loss: 0.1869, label: 2, bag_size: 248
batch 239, loss: 0.0102, instance_loss: 0.1521, weighted_loss: 0.0527, label: 1, bag_size: 890
batch 259, loss: 0.0328, instance_loss: 0.2638, weighted_loss: 0.1021, label: 1, bag_size: 858
batch 279, loss: 0.6223, instance_loss: 0.4031, weighted_loss: 0.5566, label: 0, bag_size: 868
batch 299, loss: 0.1924, instance_loss: 0.3724, weighted_loss: 0.2464, label: 2, bag_size: 110
batch 319, loss: 0.0007, instance_loss: 0.0678, weighted_loss: 0.0208, label: 4, bag_size: 764
batch 339, loss: 0.0047, instance_loss: 0.3794, weighted_loss: 0.1171, label: 4, bag_size: 947
batch 359, loss: 0.0281, instance_loss: 0.1652, weighted_loss: 0.0692, label: 3, bag_size: 316
batch 379, loss: 0.0697, instance_loss: 0.3421, weighted_loss: 0.1514, label: 0, bag_size: 1065
batch 399, loss: 0.3538, instance_loss: 0.4181, weighted_loss: 0.3731, label: 1, bag_size: 377
batch 419, loss: 0.0831, instance_loss: 0.4255, weighted_loss: 0.1858, label: 2, bag_size: 948
batch 439, loss: 0.2555, instance_loss: 0.5342, weighted_loss: 0.3391, label: 2, bag_size: 934
batch 459, loss: 0.0245, instance_loss: 0.1348, weighted_loss: 0.0576, label: 1, bag_size: 890
batch 479, loss: 0.0001, instance_loss: 0.0218, weighted_loss: 0.0066, label: 3, bag_size: 143
batch 499, loss: 0.0200, instance_loss: 0.1140, weighted_loss: 0.0482, label: 4, bag_size: 162
batch 519, loss: 0.0028, instance_loss: 0.0346, weighted_loss: 0.0123, label: 3, bag_size: 43
batch 539, loss: 0.0799, instance_loss: 0.7194, weighted_loss: 0.2718, label: 4, bag_size: 663


class 0 clustering acc 0.9843577981651376: correct 21459/21800
class 1 clustering acc 0.5467889908256881: correct 2384/4360
Epoch: 51, train_loss: 0.1032, train_clustering_loss:  0.2611, train_error: 0.0257
class 0: acc 0.970873786407767, correct 100/103
class 1: acc 0.9734513274336283, correct 110/113
class 2: acc 0.9365079365079365, correct 118/126
class 3: acc 1.0, correct 95/95
class 4: acc 1.0, correct 108/108

Val Set, val_loss: 1.2521, val_error: 0.3600, auc: 0.8804
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.3575: correct 143/400
class 0: acc 0.875, correct 7/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.5, correct 4/8
class 4: acc 0.5, correct 1/2
EarlyStopping counter: 36 out of 20
Early stopping
Val error: 0.3400, ROC AUC: 0.8583
Test error: 0.2600, ROC AUC: 0.8984
class 0: acc 0.7, correct 7/10
class 1: acc 0.7, correct 7/10
class 2: acc 0.8636363636363636, correct 19/22
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.6, correct 3/5

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6541, instance_loss: 1.2203, weighted_loss: 1.5239, label: 2, bag_size: 1167
batch 39, loss: 1.5824, instance_loss: 1.0767, weighted_loss: 1.4306, label: 3, bag_size: 48
batch 59, loss: 1.4796, instance_loss: 0.8531, weighted_loss: 1.2916, label: 3, bag_size: 46
batch 79, loss: 1.5871, instance_loss: 0.6129, weighted_loss: 1.2948, label: 2, bag_size: 1218
batch 99, loss: 1.5547, instance_loss: 0.5622, weighted_loss: 1.2570, label: 0, bag_size: 1190
batch 119, loss: 1.5552, instance_loss: 0.5819, weighted_loss: 1.2632, label: 3, bag_size: 48
batch 139, loss: 1.6875, instance_loss: 0.5616, weighted_loss: 1.3497, label: 2, bag_size: 1569
batch 159, loss: 1.4066, instance_loss: 0.5404, weighted_loss: 1.1467, label: 4, bag_size: 17
batch 179, loss: 1.8798, instance_loss: 0.5585, weighted_loss: 1.4834, label: 0, bag_size: 129
batch 199, loss: 1.5307, instance_loss: 0.4946, weighted_loss: 1.2199, label: 3, bag_size: 841
batch 219, loss: 1.7178, instance_loss: 0.5305, weighted_loss: 1.3616, label: 0, bag_size: 756
batch 239, loss: 1.9598, instance_loss: 0.5984, weighted_loss: 1.5514, label: 2, bag_size: 913
batch 259, loss: 1.5704, instance_loss: 0.5339, weighted_loss: 1.2594, label: 0, bag_size: 552
batch 279, loss: 1.5787, instance_loss: 0.5283, weighted_loss: 1.2636, label: 0, bag_size: 148
batch 299, loss: 1.1824, instance_loss: 0.5201, weighted_loss: 0.9838, label: 0, bag_size: 1143
batch 319, loss: 1.7512, instance_loss: 0.5450, weighted_loss: 1.3894, label: 2, bag_size: 1218
batch 339, loss: 1.3757, instance_loss: 0.5069, weighted_loss: 1.1150, label: 1, bag_size: 1426
batch 359, loss: 1.4375, instance_loss: 0.5163, weighted_loss: 1.1611, label: 2, bag_size: 248
batch 379, loss: 1.3771, instance_loss: 0.5195, weighted_loss: 1.1198, label: 2, bag_size: 1410
batch 399, loss: 2.2808, instance_loss: 0.5450, weighted_loss: 1.7600, label: 4, bag_size: 511
batch 419, loss: 1.7245, instance_loss: 0.5320, weighted_loss: 1.3667, label: 1, bag_size: 535
batch 439, loss: 1.4577, instance_loss: 0.4895, weighted_loss: 1.1673, label: 2, bag_size: 194
batch 459, loss: 1.3104, instance_loss: 0.5146, weighted_loss: 1.0716, label: 2, bag_size: 278
batch 479, loss: 0.5535, instance_loss: 0.4068, weighted_loss: 0.5095, label: 4, bag_size: 178
batch 499, loss: 1.3784, instance_loss: 0.4909, weighted_loss: 1.1122, label: 2, bag_size: 1148
batch 519, loss: 0.6365, instance_loss: 0.4346, weighted_loss: 0.5760, label: 4, bag_size: 23
batch 539, loss: 1.8148, instance_loss: 0.5346, weighted_loss: 1.4307, label: 2, bag_size: 943


class 0 clustering acc 0.9938532110091743: correct 21666/21800
class 1 clustering acc 0.005275229357798165: correct 23/4360
Epoch: 0, train_loss: 1.4740, train_clustering_loss:  0.5908, train_error: 0.6440
class 0: acc 0.4083333333333333, correct 49/120
class 1: acc 0.3173076923076923, correct 33/104
class 2: acc 0.09183673469387756, correct 9/98
class 3: acc 0.3620689655172414, correct 42/116
class 4: acc 0.5700934579439252, correct 61/107

Val Set, val_loss: 1.3814, val_error: 0.5600, auc: 0.7525
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.0, correct 0/17
class 3: acc 0.75, correct 3/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (inf --> 1.381441).  Saving model ...


batch 19, loss: 1.3280, instance_loss: 0.4996, weighted_loss: 1.0795, label: 2, bag_size: 638
batch 39, loss: 1.4856, instance_loss: 0.5275, weighted_loss: 1.1982, label: 1, bag_size: 1096
batch 59, loss: 1.5010, instance_loss: 0.5190, weighted_loss: 1.2064, label: 1, bag_size: 1144
batch 79, loss: 0.9785, instance_loss: 0.4835, weighted_loss: 0.8300, label: 3, bag_size: 50
batch 99, loss: 1.3850, instance_loss: 0.4819, weighted_loss: 1.1140, label: 2, bag_size: 499
batch 119, loss: 1.3272, instance_loss: 0.4705, weighted_loss: 1.0702, label: 2, bag_size: 252
batch 139, loss: 1.3285, instance_loss: 0.4843, weighted_loss: 1.0753, label: 1, bag_size: 778
batch 159, loss: 1.6252, instance_loss: 0.5315, weighted_loss: 1.2971, label: 0, bag_size: 294
batch 179, loss: 0.8198, instance_loss: 0.4757, weighted_loss: 0.7166, label: 3, bag_size: 18
batch 199, loss: 0.6280, instance_loss: 0.4543, weighted_loss: 0.5759, label: 3, bag_size: 20
batch 219, loss: 1.4754, instance_loss: 0.5138, weighted_loss: 1.1869, label: 0, bag_size: 552
batch 239, loss: 2.2289, instance_loss: 0.6785, weighted_loss: 1.7637, label: 0, bag_size: 128
batch 259, loss: 1.3172, instance_loss: 0.4811, weighted_loss: 1.0664, label: 2, bag_size: 1235
batch 279, loss: 2.3186, instance_loss: 0.5041, weighted_loss: 1.7743, label: 3, bag_size: 1380
batch 299, loss: 1.2044, instance_loss: 0.4744, weighted_loss: 0.9854, label: 0, bag_size: 653
batch 319, loss: 1.4647, instance_loss: 0.4689, weighted_loss: 1.1660, label: 3, bag_size: 451
batch 339, loss: 0.9457, instance_loss: 0.4724, weighted_loss: 0.8037, label: 1, bag_size: 442
batch 359, loss: 1.6276, instance_loss: 0.5252, weighted_loss: 1.2969, label: 4, bag_size: 764
batch 379, loss: 2.2744, instance_loss: 0.6895, weighted_loss: 1.7989, label: 0, bag_size: 116
batch 399, loss: 0.7792, instance_loss: 0.4077, weighted_loss: 0.6678, label: 1, bag_size: 474
batch 419, loss: 0.6609, instance_loss: 0.4429, weighted_loss: 0.5955, label: 3, bag_size: 15
batch 439, loss: 0.6678, instance_loss: 0.4054, weighted_loss: 0.5891, label: 1, bag_size: 711
batch 459, loss: 1.2768, instance_loss: 0.5007, weighted_loss: 1.0440, label: 2, bag_size: 404
batch 479, loss: 1.4495, instance_loss: 0.5408, weighted_loss: 1.1769, label: 2, bag_size: 748
batch 499, loss: 1.2551, instance_loss: 0.5055, weighted_loss: 1.0302, label: 0, bag_size: 1190
batch 519, loss: 1.6530, instance_loss: 0.5419, weighted_loss: 1.3196, label: 4, bag_size: 636
batch 539, loss: 1.4887, instance_loss: 0.5164, weighted_loss: 1.1970, label: 2, bag_size: 373


class 0 clustering acc 0.9990825688073395: correct 21780/21800
class 1 clustering acc 0.0213302752293578: correct 93/4360
Epoch: 1, train_loss: 1.2251, train_clustering_loss:  0.4627, train_error: 0.5083
class 0: acc 0.18095238095238095, correct 19/105
class 1: acc 0.6446280991735537, correct 78/121
class 2: acc 0.2549019607843137, correct 26/102
class 3: acc 0.6504854368932039, correct 67/103
class 4: acc 0.6842105263157895, correct 78/114

Val Set, val_loss: 1.3374, val_error: 0.6200, auc: 0.8129
class 0 clustering acc 0.9965: correct 1993/2000
class 1 clustering acc 0.0325: correct 13/400
class 0: acc 0.0, correct 0/11
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.0, correct 0/17
class 3: acc 0.75, correct 3/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.381441 --> 1.337371).  Saving model ...


batch 19, loss: 1.6342, instance_loss: 0.5453, weighted_loss: 1.3075, label: 0, bag_size: 371
batch 39, loss: 1.5412, instance_loss: 0.5300, weighted_loss: 1.2378, label: 0, bag_size: 423
batch 59, loss: 1.4292, instance_loss: 0.5132, weighted_loss: 1.1544, label: 2, bag_size: 373
batch 79, loss: 0.1261, instance_loss: 0.1318, weighted_loss: 0.1278, label: 4, bag_size: 39
batch 99, loss: 1.7619, instance_loss: 0.4533, weighted_loss: 1.3694, label: 3, bag_size: 1253
batch 119, loss: 1.4387, instance_loss: 0.4729, weighted_loss: 1.1490, label: 1, bag_size: 925
batch 139, loss: 0.3215, instance_loss: 0.2797, weighted_loss: 0.3090, label: 3, bag_size: 1559
batch 159, loss: 1.2306, instance_loss: 0.4853, weighted_loss: 1.0070, label: 0, bag_size: 432
batch 179, loss: 1.1290, instance_loss: 0.3915, weighted_loss: 0.9078, label: 1, bag_size: 535
batch 199, loss: 1.3757, instance_loss: 0.4823, weighted_loss: 1.1077, label: 0, bag_size: 718
batch 219, loss: 0.1605, instance_loss: 0.1408, weighted_loss: 0.1546, label: 4, bag_size: 96
batch 239, loss: 0.2581, instance_loss: 0.2159, weighted_loss: 0.2455, label: 4, bag_size: 23
batch 259, loss: 1.3161, instance_loss: 0.4916, weighted_loss: 1.0688, label: 0, bag_size: 801
batch 279, loss: 1.1319, instance_loss: 0.4588, weighted_loss: 0.9300, label: 2, bag_size: 1404
batch 299, loss: 1.1788, instance_loss: 0.4726, weighted_loss: 0.9669, label: 2, bag_size: 758
batch 319, loss: 1.3034, instance_loss: 0.4822, weighted_loss: 1.0571, label: 0, bag_size: 424
batch 339, loss: 0.8770, instance_loss: 0.4409, weighted_loss: 0.7462, label: 2, bag_size: 471
batch 359, loss: 1.3114, instance_loss: 0.5117, weighted_loss: 1.0715, label: 0, bag_size: 731
batch 379, loss: 1.9928, instance_loss: 0.5932, weighted_loss: 1.5729, label: 0, bag_size: 1527
batch 399, loss: 1.3275, instance_loss: 0.4403, weighted_loss: 1.0613, label: 1, bag_size: 319
batch 419, loss: 0.1347, instance_loss: 0.1213, weighted_loss: 0.1306, label: 4, bag_size: 112
batch 439, loss: 1.5417, instance_loss: 0.5764, weighted_loss: 1.2521, label: 3, bag_size: 791
batch 459, loss: 1.0564, instance_loss: 0.3960, weighted_loss: 0.8583, label: 1, bag_size: 377
batch 479, loss: 1.4568, instance_loss: 0.5339, weighted_loss: 1.1800, label: 0, bag_size: 424
batch 499, loss: 0.0727, instance_loss: 0.1984, weighted_loss: 0.1104, label: 3, bag_size: 24
batch 519, loss: 2.0939, instance_loss: 0.6480, weighted_loss: 1.6601, label: 4, bag_size: 1474
batch 539, loss: 0.7786, instance_loss: 0.4429, weighted_loss: 0.6779, label: 2, bag_size: 913


class 0 clustering acc 0.9955963302752293: correct 21704/21800
class 1 clustering acc 0.10871559633027524: correct 474/4360
Epoch: 2, train_loss: 1.0863, train_clustering_loss:  0.4275, train_error: 0.4128
class 0: acc 0.3118279569892473, correct 29/93
class 1: acc 0.7704918032786885, correct 94/122
class 2: acc 0.4392523364485981, correct 47/107
class 3: acc 0.6568627450980392, correct 67/102
class 4: acc 0.6859504132231405, correct 83/121

Val Set, val_loss: 1.0750, val_error: 0.4000, auc: 0.8404
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.055: correct 22/400
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 0.75, correct 3/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.337371 --> 1.074962).  Saving model ...


batch 19, loss: 0.8983, instance_loss: 0.4309, weighted_loss: 0.7581, label: 2, bag_size: 621
batch 39, loss: 1.1902, instance_loss: 0.4732, weighted_loss: 0.9751, label: 2, bag_size: 977
batch 59, loss: 1.1846, instance_loss: 0.4310, weighted_loss: 0.9585, label: 1, bag_size: 470
batch 79, loss: 1.6227, instance_loss: 0.6145, weighted_loss: 1.3203, label: 4, bag_size: 646
batch 99, loss: 2.3050, instance_loss: 0.6159, weighted_loss: 1.7983, label: 3, bag_size: 630
batch 119, loss: 0.8547, instance_loss: 0.3688, weighted_loss: 0.7089, label: 1, bag_size: 346
batch 139, loss: 0.8426, instance_loss: 0.4362, weighted_loss: 0.7207, label: 0, bag_size: 718
batch 159, loss: 1.4972, instance_loss: 0.5160, weighted_loss: 1.2029, label: 2, bag_size: 1128
batch 179, loss: 0.9869, instance_loss: 0.3740, weighted_loss: 0.8031, label: 1, bag_size: 959
batch 199, loss: 0.1526, instance_loss: 0.2386, weighted_loss: 0.1784, label: 3, bag_size: 28
batch 219, loss: 1.3869, instance_loss: 0.5094, weighted_loss: 1.1236, label: 2, bag_size: 1231
batch 239, loss: 1.1745, instance_loss: 0.4939, weighted_loss: 0.9703, label: 2, bag_size: 1231
batch 259, loss: 1.2911, instance_loss: 0.5311, weighted_loss: 1.0631, label: 0, bag_size: 350
batch 279, loss: 2.3090, instance_loss: 0.6028, weighted_loss: 1.7972, label: 4, bag_size: 511
batch 299, loss: 1.5325, instance_loss: 0.5504, weighted_loss: 1.2379, label: 0, bag_size: 736
batch 319, loss: 0.7265, instance_loss: 0.4518, weighted_loss: 0.6441, label: 4, bag_size: 764
batch 339, loss: 1.0426, instance_loss: 0.4383, weighted_loss: 0.8613, label: 3, bag_size: 1019
batch 359, loss: 0.2830, instance_loss: 0.1855, weighted_loss: 0.2537, label: 4, bag_size: 78
batch 379, loss: 0.8772, instance_loss: 0.4768, weighted_loss: 0.7571, label: 0, bag_size: 1061
batch 399, loss: 0.5993, instance_loss: 0.4272, weighted_loss: 0.5477, label: 0, bag_size: 478
batch 419, loss: 1.4450, instance_loss: 0.5147, weighted_loss: 1.1659, label: 0, bag_size: 1190
batch 439, loss: 0.4550, instance_loss: 0.3852, weighted_loss: 0.4341, label: 0, bag_size: 524
batch 459, loss: 2.0853, instance_loss: 0.5480, weighted_loss: 1.6241, label: 0, bag_size: 818
batch 479, loss: 2.1342, instance_loss: 0.6003, weighted_loss: 1.6741, label: 2, bag_size: 358
batch 499, loss: 0.2188, instance_loss: 0.1414, weighted_loss: 0.1956, label: 4, bag_size: 160
batch 519, loss: 1.5492, instance_loss: 0.4867, weighted_loss: 1.2305, label: 1, bag_size: 435
batch 539, loss: 1.8993, instance_loss: 0.6013, weighted_loss: 1.5099, label: 0, bag_size: 1196


class 0 clustering acc 0.9951834862385321: correct 21695/21800
class 1 clustering acc 0.13486238532110092: correct 588/4360
Epoch: 3, train_loss: 0.9912, train_clustering_loss:  0.4157, train_error: 0.3798
class 0: acc 0.6230769230769231, correct 81/130
class 1: acc 0.6605504587155964, correct 72/109
class 2: acc 0.41818181818181815, correct 46/110
class 3: acc 0.7373737373737373, correct 73/99
class 4: acc 0.6804123711340206, correct 66/97

Val Set, val_loss: 0.9015, val_error: 0.3400, auc: 0.9145
class 0 clustering acc 0.997: correct 1994/2000
class 1 clustering acc 0.0525: correct 21/400
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 0.75, correct 3/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.074962 --> 0.901500).  Saving model ...


batch 19, loss: 1.2798, instance_loss: 0.5191, weighted_loss: 1.0516, label: 0, bag_size: 1034
batch 39, loss: 0.7319, instance_loss: 0.4392, weighted_loss: 0.6441, label: 0, bag_size: 1133
batch 59, loss: 0.0395, instance_loss: 0.1385, weighted_loss: 0.0692, label: 3, bag_size: 41
batch 79, loss: 1.6184, instance_loss: 0.4706, weighted_loss: 1.2741, label: 1, bag_size: 269
batch 99, loss: 0.5009, instance_loss: 0.4126, weighted_loss: 0.4744, label: 0, bag_size: 424
batch 119, loss: 1.0034, instance_loss: 0.4574, weighted_loss: 0.8396, label: 2, bag_size: 400
batch 139, loss: 2.3463, instance_loss: 0.6860, weighted_loss: 1.8482, label: 3, bag_size: 283
batch 159, loss: 0.9572, instance_loss: 0.4334, weighted_loss: 0.8001, label: 2, bag_size: 400
batch 179, loss: 0.7326, instance_loss: 0.3841, weighted_loss: 0.6280, label: 2, bag_size: 323
batch 199, loss: 0.2284, instance_loss: 0.2470, weighted_loss: 0.2340, label: 3, bag_size: 18
batch 219, loss: 0.0592, instance_loss: 0.0826, weighted_loss: 0.0662, label: 4, bag_size: 83
batch 239, loss: 0.4390, instance_loss: 0.4261, weighted_loss: 0.4351, label: 0, bag_size: 478
batch 259, loss: 0.7353, instance_loss: 0.3799, weighted_loss: 0.6287, label: 2, bag_size: 252
batch 279, loss: 0.7495, instance_loss: 0.3540, weighted_loss: 0.6309, label: 1, bag_size: 346
batch 299, loss: 0.8373, instance_loss: 0.4274, weighted_loss: 0.7143, label: 0, bag_size: 1255
batch 319, loss: 0.2004, instance_loss: 0.2826, weighted_loss: 0.2250, label: 4, bag_size: 28
batch 339, loss: 0.7622, instance_loss: 0.4650, weighted_loss: 0.6731, label: 2, bag_size: 1180
batch 359, loss: 0.0756, instance_loss: 0.0827, weighted_loss: 0.0778, label: 4, bag_size: 148
batch 379, loss: 1.2533, instance_loss: 0.5051, weighted_loss: 1.0289, label: 2, bag_size: 1006
batch 399, loss: 0.5479, instance_loss: 0.2733, weighted_loss: 0.4655, label: 1, bag_size: 847
batch 419, loss: 0.7265, instance_loss: 0.4249, weighted_loss: 0.6361, label: 2, bag_size: 2826
batch 439, loss: 0.2943, instance_loss: 0.4233, weighted_loss: 0.3330, label: 0, bag_size: 478
batch 459, loss: 0.5576, instance_loss: 0.4844, weighted_loss: 0.5356, label: 0, bag_size: 976
batch 479, loss: 0.8041, instance_loss: 0.3790, weighted_loss: 0.6765, label: 1, bag_size: 711
batch 499, loss: 0.0751, instance_loss: 0.1311, weighted_loss: 0.0919, label: 3, bag_size: 50
batch 519, loss: 0.3990, instance_loss: 0.3874, weighted_loss: 0.3955, label: 0, bag_size: 1135
batch 539, loss: 2.6583, instance_loss: 0.6638, weighted_loss: 2.0600, label: 4, bag_size: 511


class 0 clustering acc 0.9955045871559633: correct 21702/21800
class 1 clustering acc 0.24288990825688073: correct 1059/4360
Epoch: 4, train_loss: 0.8381, train_clustering_loss:  0.3726, train_error: 0.3174
class 0: acc 0.6972477064220184, correct 76/109
class 1: acc 0.5619047619047619, correct 59/105
class 2: acc 0.5943396226415094, correct 63/106
class 3: acc 0.7407407407407407, correct 80/108
class 4: acc 0.8034188034188035, correct 94/117

Val Set, val_loss: 1.0258, val_error: 0.3400, auc: 0.9157
class 0 clustering acc 0.9925: correct 1985/2000
class 1 clustering acc 0.1025: correct 41/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.29411764705882354, correct 5/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2400, instance_loss: 0.4915, weighted_loss: 1.0155, label: 2, bag_size: 687
batch 39, loss: 2.0901, instance_loss: 0.5288, weighted_loss: 1.6217, label: 1, bag_size: 386
batch 59, loss: 0.3776, instance_loss: 0.3867, weighted_loss: 0.3803, label: 0, bag_size: 756
batch 79, loss: 0.0963, instance_loss: 0.1175, weighted_loss: 0.1027, label: 3, bag_size: 305
batch 99, loss: 1.0818, instance_loss: 0.5127, weighted_loss: 0.9111, label: 2, bag_size: 1235
batch 119, loss: 0.1397, instance_loss: 0.1366, weighted_loss: 0.1388, label: 4, bag_size: 150
batch 139, loss: 1.6136, instance_loss: 0.5445, weighted_loss: 1.2929, label: 2, bag_size: 194
batch 159, loss: 0.6640, instance_loss: 0.4633, weighted_loss: 0.6038, label: 0, bag_size: 367
batch 179, loss: 0.3737, instance_loss: 0.2345, weighted_loss: 0.3320, label: 1, bag_size: 534
batch 199, loss: 0.6297, instance_loss: 0.4947, weighted_loss: 0.5892, label: 0, bag_size: 367
batch 219, loss: 0.0994, instance_loss: 0.2665, weighted_loss: 0.1495, label: 3, bag_size: 18
batch 239, loss: 0.6718, instance_loss: 0.5743, weighted_loss: 0.6426, label: 0, bag_size: 114
batch 259, loss: 0.5714, instance_loss: 0.3819, weighted_loss: 0.5146, label: 2, bag_size: 1569
batch 279, loss: 1.4733, instance_loss: 0.5523, weighted_loss: 1.1970, label: 2, bag_size: 1043
batch 299, loss: 0.0840, instance_loss: 0.2900, weighted_loss: 0.1458, label: 4, bag_size: 20
batch 319, loss: 0.1308, instance_loss: 0.1177, weighted_loss: 0.1269, label: 3, bag_size: 1559
batch 339, loss: 0.2958, instance_loss: 0.2231, weighted_loss: 0.2740, label: 1, bag_size: 994
batch 359, loss: 0.6744, instance_loss: 0.3524, weighted_loss: 0.5778, label: 2, bag_size: 1385
batch 379, loss: 0.9899, instance_loss: 0.6914, weighted_loss: 0.9004, label: 0, bag_size: 116
batch 399, loss: 1.3383, instance_loss: 0.5228, weighted_loss: 1.0937, label: 2, bag_size: 828
batch 419, loss: 2.8155, instance_loss: 0.6417, weighted_loss: 2.1634, label: 3, bag_size: 211
batch 439, loss: 1.1976, instance_loss: 0.4416, weighted_loss: 0.9708, label: 2, bag_size: 373
batch 459, loss: 2.9505, instance_loss: 0.7588, weighted_loss: 2.2930, label: 4, bag_size: 1337
batch 479, loss: 0.7109, instance_loss: 0.3412, weighted_loss: 0.6000, label: 2, bag_size: 1050
batch 499, loss: 0.8998, instance_loss: 0.4853, weighted_loss: 0.7755, label: 0, bag_size: 570
batch 519, loss: 0.0824, instance_loss: 0.0981, weighted_loss: 0.0871, label: 4, bag_size: 60
batch 539, loss: 0.6636, instance_loss: 0.4840, weighted_loss: 0.6097, label: 0, bag_size: 653


class 0 clustering acc 0.9943577981651376: correct 21677/21800
class 1 clustering acc 0.2486238532110092: correct 1084/4360
Epoch: 5, train_loss: 0.8152, train_clustering_loss:  0.3735, train_error: 0.3193
class 0: acc 0.5684210526315789, correct 54/95
class 1: acc 0.6636363636363637, correct 73/110
class 2: acc 0.584, correct 73/125
class 3: acc 0.7767857142857143, correct 87/112
class 4: acc 0.8155339805825242, correct 84/103

Val Set, val_loss: 1.0141, val_error: 0.3400, auc: 0.9086
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.13: correct 52/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.4117647058823529, correct 7/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9846, instance_loss: 0.4408, weighted_loss: 0.8214, label: 1, bag_size: 470
batch 39, loss: 0.8880, instance_loss: 0.4233, weighted_loss: 0.7486, label: 2, bag_size: 1133
batch 59, loss: 0.0359, instance_loss: 0.1252, weighted_loss: 0.0627, label: 3, bag_size: 20
batch 79, loss: 0.1901, instance_loss: 0.2731, weighted_loss: 0.2150, label: 0, bag_size: 1143
batch 99, loss: 0.5075, instance_loss: 0.4217, weighted_loss: 0.4818, label: 0, bag_size: 1101
batch 119, loss: 0.1035, instance_loss: 0.1707, weighted_loss: 0.1237, label: 3, bag_size: 28
batch 139, loss: 0.4305, instance_loss: 0.2596, weighted_loss: 0.3792, label: 1, bag_size: 356
batch 159, loss: 1.6229, instance_loss: 0.5228, weighted_loss: 1.2928, label: 0, bag_size: 1289
batch 179, loss: 1.1735, instance_loss: 0.4769, weighted_loss: 0.9645, label: 2, bag_size: 474
batch 199, loss: 0.6430, instance_loss: 0.4214, weighted_loss: 0.5765, label: 2, bag_size: 1155
batch 219, loss: 1.7221, instance_loss: 0.5599, weighted_loss: 1.3734, label: 4, bag_size: 1331
batch 239, loss: 0.2528, instance_loss: 0.3781, weighted_loss: 0.2904, label: 0, bag_size: 1101
batch 259, loss: 0.6235, instance_loss: 0.4175, weighted_loss: 0.5617, label: 3, bag_size: 230
batch 279, loss: 0.6296, instance_loss: 0.3730, weighted_loss: 0.5526, label: 2, bag_size: 317
batch 299, loss: 0.5955, instance_loss: 0.3711, weighted_loss: 0.5282, label: 2, bag_size: 1289
batch 319, loss: 0.7406, instance_loss: 0.4355, weighted_loss: 0.6491, label: 2, bag_size: 278
batch 339, loss: 0.1678, instance_loss: 0.2424, weighted_loss: 0.1901, label: 3, bag_size: 21
batch 359, loss: 0.0131, instance_loss: 0.0853, weighted_loss: 0.0348, label: 3, bag_size: 43
batch 379, loss: 0.9386, instance_loss: 0.4066, weighted_loss: 0.7790, label: 2, bag_size: 222
batch 399, loss: 0.1368, instance_loss: 0.2521, weighted_loss: 0.1714, label: 4, bag_size: 178
batch 419, loss: 0.7575, instance_loss: 0.4671, weighted_loss: 0.6704, label: 0, bag_size: 718
batch 439, loss: 1.4421, instance_loss: 0.4854, weighted_loss: 1.1551, label: 3, bag_size: 1250
batch 459, loss: 0.7436, instance_loss: 0.4412, weighted_loss: 0.6529, label: 2, bag_size: 391
batch 479, loss: 0.3654, instance_loss: 0.2931, weighted_loss: 0.3437, label: 2, bag_size: 1514
batch 499, loss: 2.7092, instance_loss: 0.6505, weighted_loss: 2.0916, label: 1, bag_size: 293
batch 519, loss: 0.2693, instance_loss: 0.3236, weighted_loss: 0.2856, label: 0, bag_size: 524
batch 539, loss: 0.7227, instance_loss: 0.4312, weighted_loss: 0.6353, label: 0, bag_size: 466


class 0 clustering acc 0.9937155963302752: correct 21663/21800
class 1 clustering acc 0.21192660550458717: correct 924/4360
Epoch: 6, train_loss: 0.7612, train_clustering_loss:  0.3772, train_error: 0.2587
class 0: acc 0.7538461538461538, correct 98/130
class 1: acc 0.6631578947368421, correct 63/95
class 2: acc 0.717948717948718, correct 84/117
class 3: acc 0.782608695652174, correct 90/115
class 4: acc 0.7840909090909091, correct 69/88

Val Set, val_loss: 0.9016, val_error: 0.3200, auc: 0.9251
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.175: correct 70/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.35294117647058826, correct 6/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9954, instance_loss: 0.4812, weighted_loss: 0.8411, label: 0, bag_size: 801
batch 39, loss: 0.1830, instance_loss: 0.1411, weighted_loss: 0.1704, label: 4, bag_size: 96
batch 59, loss: 0.3194, instance_loss: 0.3396, weighted_loss: 0.3254, label: 2, bag_size: 846
batch 79, loss: 1.3015, instance_loss: 0.4648, weighted_loss: 1.0505, label: 2, bag_size: 1178
batch 99, loss: 1.6542, instance_loss: 0.5002, weighted_loss: 1.3080, label: 0, bag_size: 990
batch 119, loss: 0.1135, instance_loss: 0.1768, weighted_loss: 0.1324, label: 3, bag_size: 18
batch 139, loss: 2.0257, instance_loss: 0.5817, weighted_loss: 1.5925, label: 0, bag_size: 1257
batch 159, loss: 0.2425, instance_loss: 0.1644, weighted_loss: 0.2191, label: 3, bag_size: 1399
batch 179, loss: 0.5165, instance_loss: 0.2638, weighted_loss: 0.4407, label: 1, bag_size: 746
batch 199, loss: 0.3193, instance_loss: 0.3574, weighted_loss: 0.3307, label: 2, bag_size: 758
batch 219, loss: 0.1598, instance_loss: 0.1200, weighted_loss: 0.1479, label: 1, bag_size: 1277
batch 239, loss: 0.9269, instance_loss: 0.4612, weighted_loss: 0.7872, label: 2, bag_size: 471
batch 259, loss: 0.3799, instance_loss: 0.3258, weighted_loss: 0.3637, label: 1, bag_size: 474
batch 279, loss: 3.7080, instance_loss: 0.8630, weighted_loss: 2.8545, label: 4, bag_size: 210
batch 299, loss: 1.4474, instance_loss: 0.4539, weighted_loss: 1.1494, label: 2, bag_size: 373
batch 319, loss: 0.8253, instance_loss: 0.4333, weighted_loss: 0.7077, label: 2, bag_size: 869
batch 339, loss: 2.2111, instance_loss: 0.4818, weighted_loss: 1.6923, label: 0, bag_size: 760
batch 359, loss: 0.7911, instance_loss: 0.3877, weighted_loss: 0.6701, label: 4, bag_size: 24
batch 379, loss: 0.3258, instance_loss: 0.5350, weighted_loss: 0.3885, label: 0, bag_size: 129
batch 399, loss: 0.6221, instance_loss: 0.3720, weighted_loss: 0.5470, label: 2, bag_size: 868
batch 419, loss: 0.4368, instance_loss: 0.3866, weighted_loss: 0.4218, label: 4, bag_size: 947
batch 439, loss: 0.2538, instance_loss: 0.4092, weighted_loss: 0.3004, label: 0, bag_size: 114
batch 459, loss: 0.8617, instance_loss: 0.4354, weighted_loss: 0.7338, label: 0, bag_size: 424
batch 479, loss: 0.9065, instance_loss: 0.4297, weighted_loss: 0.7634, label: 2, bag_size: 356
batch 499, loss: 1.3238, instance_loss: 0.5126, weighted_loss: 1.0804, label: 0, bag_size: 545
batch 519, loss: 0.4524, instance_loss: 0.3723, weighted_loss: 0.4284, label: 1, bag_size: 1646
batch 539, loss: 0.2924, instance_loss: 0.2479, weighted_loss: 0.2790, label: 4, bag_size: 63


class 0 clustering acc 0.9933944954128441: correct 21656/21800
class 1 clustering acc 0.2564220183486238: correct 1118/4360
Epoch: 7, train_loss: 0.7281, train_clustering_loss:  0.3630, train_error: 0.2679
class 0: acc 0.7610619469026548, correct 86/113
class 1: acc 0.6864406779661016, correct 81/118
class 2: acc 0.6190476190476191, correct 65/105
class 3: acc 0.7962962962962963, correct 86/108
class 4: acc 0.801980198019802, correct 81/101

Val Set, val_loss: 0.8372, val_error: 0.3000, auc: 0.9305
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.14: correct 56/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.5294117647058824, correct 9/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (0.901500 --> 0.837177).  Saving model ...


batch 19, loss: 0.3192, instance_loss: 0.2133, weighted_loss: 0.2874, label: 3, bag_size: 1399
batch 39, loss: 0.1622, instance_loss: 0.2468, weighted_loss: 0.1876, label: 4, bag_size: 388
batch 59, loss: 1.2889, instance_loss: 0.4022, weighted_loss: 1.0229, label: 1, bag_size: 1559
batch 79, loss: 0.0384, instance_loss: 0.1265, weighted_loss: 0.0648, label: 3, bag_size: 19
batch 99, loss: 1.9922, instance_loss: 0.6153, weighted_loss: 1.5791, label: 2, bag_size: 1231
batch 119, loss: 0.4824, instance_loss: 0.3456, weighted_loss: 0.4413, label: 2, bag_size: 910
batch 139, loss: 0.4388, instance_loss: 0.3608, weighted_loss: 0.4154, label: 2, bag_size: 292
batch 159, loss: 0.1743, instance_loss: 0.1029, weighted_loss: 0.1528, label: 3, bag_size: 451
batch 179, loss: 1.0885, instance_loss: 0.5456, weighted_loss: 0.9256, label: 0, bag_size: 423
batch 199, loss: 0.5582, instance_loss: 0.3701, weighted_loss: 0.5017, label: 2, bag_size: 1164
batch 219, loss: 0.6382, instance_loss: 0.6521, weighted_loss: 0.6423, label: 0, bag_size: 116
batch 239, loss: 0.9477, instance_loss: 0.3967, weighted_loss: 0.7824, label: 2, bag_size: 419
batch 259, loss: 0.0854, instance_loss: 0.1322, weighted_loss: 0.0994, label: 4, bag_size: 30
batch 279, loss: 1.7925, instance_loss: 0.6141, weighted_loss: 1.4390, label: 2, bag_size: 1400
batch 299, loss: 0.8247, instance_loss: 0.3715, weighted_loss: 0.6888, label: 2, bag_size: 1050
batch 319, loss: 0.1563, instance_loss: 0.2795, weighted_loss: 0.1933, label: 0, bag_size: 1599
batch 339, loss: 0.0497, instance_loss: 0.1407, weighted_loss: 0.0770, label: 3, bag_size: 33
batch 359, loss: 0.5228, instance_loss: 0.3256, weighted_loss: 0.4637, label: 2, bag_size: 461
batch 379, loss: 0.3424, instance_loss: 0.3627, weighted_loss: 0.3485, label: 0, bag_size: 976
batch 399, loss: 0.0628, instance_loss: 0.1075, weighted_loss: 0.0762, label: 1, bag_size: 1086
batch 419, loss: 0.2681, instance_loss: 0.2096, weighted_loss: 0.2506, label: 1, bag_size: 682
batch 439, loss: 1.0830, instance_loss: 0.6802, weighted_loss: 0.9622, label: 2, bag_size: 636
batch 459, loss: 0.0482, instance_loss: 0.2148, weighted_loss: 0.0982, label: 3, bag_size: 20
batch 479, loss: 0.1447, instance_loss: 0.1963, weighted_loss: 0.1602, label: 3, bag_size: 18
batch 499, loss: 0.7974, instance_loss: 0.4976, weighted_loss: 0.7074, label: 0, bag_size: 653
batch 519, loss: 0.0433, instance_loss: 0.1123, weighted_loss: 0.0640, label: 3, bag_size: 123
batch 539, loss: 0.9696, instance_loss: 0.4407, weighted_loss: 0.8109, label: 2, bag_size: 589


class 0 clustering acc 0.9936697247706422: correct 21662/21800
class 1 clustering acc 0.2873853211009174: correct 1253/4360
Epoch: 8, train_loss: 0.6420, train_clustering_loss:  0.3410, train_error: 0.2275
class 0: acc 0.8421052631578947, correct 96/114
class 1: acc 0.6754385964912281, correct 77/114
class 2: acc 0.7, correct 77/110
class 3: acc 0.8316831683168316, correct 84/101
class 4: acc 0.8207547169811321, correct 87/106

Val Set, val_loss: 0.7564, val_error: 0.2800, auc: 0.9286
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.5294117647058824, correct 9/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
Validation loss decreased (0.837177 --> 0.756378).  Saving model ...


batch 19, loss: 0.0139, instance_loss: 0.0748, weighted_loss: 0.0322, label: 3, bag_size: 97
batch 39, loss: 0.5911, instance_loss: 0.3800, weighted_loss: 0.5278, label: 2, bag_size: 471
batch 59, loss: 0.6499, instance_loss: 0.3826, weighted_loss: 0.5697, label: 1, bag_size: 343
batch 79, loss: 0.9001, instance_loss: 0.3683, weighted_loss: 0.7405, label: 1, bag_size: 377
batch 99, loss: 0.0826, instance_loss: 0.2305, weighted_loss: 0.1269, label: 3, bag_size: 28
batch 119, loss: 0.9988, instance_loss: 0.4158, weighted_loss: 0.8239, label: 1, bag_size: 1273
batch 139, loss: 0.0730, instance_loss: 0.2425, weighted_loss: 0.1238, label: 4, bag_size: 1357
batch 159, loss: 3.7763, instance_loss: 1.3433, weighted_loss: 3.0464, label: 2, bag_size: 1108
batch 179, loss: 1.4058, instance_loss: 0.5069, weighted_loss: 1.1362, label: 2, bag_size: 777
batch 199, loss: 0.0291, instance_loss: 0.0705, weighted_loss: 0.0415, label: 4, bag_size: 112
batch 219, loss: 0.1185, instance_loss: 0.1410, weighted_loss: 0.1253, label: 1, bag_size: 847
batch 239, loss: 0.2009, instance_loss: 0.2881, weighted_loss: 0.2270, label: 2, bag_size: 317
batch 259, loss: 0.2371, instance_loss: 0.2657, weighted_loss: 0.2457, label: 2, bag_size: 1404
batch 279, loss: 0.5002, instance_loss: 0.2582, weighted_loss: 0.4276, label: 1, bag_size: 1651
batch 299, loss: 2.7576, instance_loss: 0.6848, weighted_loss: 2.1357, label: 0, bag_size: 818
batch 319, loss: 0.4048, instance_loss: 0.3882, weighted_loss: 0.3998, label: 0, bag_size: 570
batch 339, loss: 0.3022, instance_loss: 0.2757, weighted_loss: 0.2942, label: 1, bag_size: 925
batch 359, loss: 0.5408, instance_loss: 0.3592, weighted_loss: 0.4863, label: 2, bag_size: 408
batch 379, loss: 0.4806, instance_loss: 0.3000, weighted_loss: 0.4264, label: 0, bag_size: 1579
batch 399, loss: 0.1966, instance_loss: 0.1777, weighted_loss: 0.1909, label: 1, bag_size: 994
batch 419, loss: 0.2912, instance_loss: 0.2935, weighted_loss: 0.2919, label: 3, bag_size: 1253
batch 439, loss: 0.0582, instance_loss: 0.1954, weighted_loss: 0.0993, label: 0, bag_size: 616
batch 459, loss: 0.0537, instance_loss: 0.1699, weighted_loss: 0.0886, label: 3, bag_size: 21
batch 479, loss: 0.9831, instance_loss: 0.5276, weighted_loss: 0.8465, label: 2, bag_size: 358
batch 499, loss: 0.0812, instance_loss: 0.1113, weighted_loss: 0.0902, label: 1, bag_size: 1086
batch 519, loss: 0.4495, instance_loss: 0.3850, weighted_loss: 0.4301, label: 1, bag_size: 651
batch 539, loss: 2.2394, instance_loss: 0.7933, weighted_loss: 1.8056, label: 4, bag_size: 817


class 0 clustering acc 0.9910091743119266: correct 21604/21800
class 1 clustering acc 0.3121559633027523: correct 1361/4360
Epoch: 9, train_loss: 0.5848, train_clustering_loss:  0.3318, train_error: 0.2000
class 0: acc 0.8888888888888888, correct 112/126
class 1: acc 0.7735849056603774, correct 82/106
class 2: acc 0.6153846153846154, correct 64/104
class 3: acc 0.8431372549019608, correct 86/102
class 4: acc 0.8598130841121495, correct 92/107

Val Set, val_loss: 0.7382, val_error: 0.2000, auc: 0.9374
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.19: correct 76/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
Validation loss decreased (0.756378 --> 0.738226).  Saving model ...


batch 19, loss: 3.1796, instance_loss: 0.6063, weighted_loss: 2.4076, label: 1, bag_size: 386
batch 39, loss: 0.5905, instance_loss: 0.3353, weighted_loss: 0.5140, label: 2, bag_size: 774
batch 59, loss: 0.4306, instance_loss: 0.3144, weighted_loss: 0.3958, label: 2, bag_size: 1569
batch 79, loss: 0.7886, instance_loss: 0.3875, weighted_loss: 0.6683, label: 2, bag_size: 396
batch 99, loss: 0.8634, instance_loss: 0.4105, weighted_loss: 0.7275, label: 1, bag_size: 657
batch 119, loss: 0.1885, instance_loss: 0.4610, weighted_loss: 0.2703, label: 1, bag_size: 700
batch 139, loss: 2.8821, instance_loss: 0.8804, weighted_loss: 2.2816, label: 3, bag_size: 607
batch 159, loss: 0.6505, instance_loss: 0.4117, weighted_loss: 0.5789, label: 1, bag_size: 343
batch 179, loss: 0.0046, instance_loss: 0.1165, weighted_loss: 0.0381, label: 3, bag_size: 24
batch 199, loss: 0.1351, instance_loss: 0.3101, weighted_loss: 0.1876, label: 4, bag_size: 24
batch 219, loss: 0.0580, instance_loss: 0.1718, weighted_loss: 0.0921, label: 4, bag_size: 168
batch 239, loss: 0.4490, instance_loss: 0.3881, weighted_loss: 0.4308, label: 2, bag_size: 1053
batch 259, loss: 0.3959, instance_loss: 0.3597, weighted_loss: 0.3850, label: 0, bag_size: 545
batch 279, loss: 0.1012, instance_loss: 0.1087, weighted_loss: 0.1035, label: 1, bag_size: 949
batch 299, loss: 0.0268, instance_loss: 0.1721, weighted_loss: 0.0704, label: 4, bag_size: 26
batch 319, loss: 0.0549, instance_loss: 0.2497, weighted_loss: 0.1133, label: 4, bag_size: 168
batch 339, loss: 0.0624, instance_loss: 0.2035, weighted_loss: 0.1047, label: 0, bag_size: 1235
batch 359, loss: 0.2623, instance_loss: 0.2178, weighted_loss: 0.2489, label: 4, bag_size: 78
batch 379, loss: 0.0614, instance_loss: 0.1071, weighted_loss: 0.0751, label: 3, bag_size: 94
batch 399, loss: 0.1662, instance_loss: 0.2795, weighted_loss: 0.2002, label: 2, bag_size: 913
batch 419, loss: 0.3329, instance_loss: 0.1866, weighted_loss: 0.2890, label: 1, bag_size: 356
batch 439, loss: 1.0950, instance_loss: 0.5493, weighted_loss: 0.9313, label: 3, bag_size: 230
batch 459, loss: 0.1649, instance_loss: 0.1261, weighted_loss: 0.1533, label: 1, bag_size: 1127
batch 479, loss: 0.1889, instance_loss: 0.2440, weighted_loss: 0.2054, label: 2, bag_size: 1164
batch 499, loss: 0.4918, instance_loss: 0.5489, weighted_loss: 0.5089, label: 4, bag_size: 1474
batch 519, loss: 0.1164, instance_loss: 0.2501, weighted_loss: 0.1565, label: 2, bag_size: 1215
batch 539, loss: 2.6091, instance_loss: 0.6295, weighted_loss: 2.0152, label: 0, bag_size: 818


class 0 clustering acc 0.9930275229357798: correct 21648/21800
class 1 clustering acc 0.31238532110091743: correct 1362/4360
Epoch: 10, train_loss: 0.5912, train_clustering_loss:  0.3317, train_error: 0.2202
class 0: acc 0.8198198198198198, correct 91/111
class 1: acc 0.6504854368932039, correct 67/103
class 2: acc 0.7950819672131147, correct 97/122
class 3: acc 0.7755102040816326, correct 76/98
class 4: acc 0.8468468468468469, correct 94/111

Val Set, val_loss: 0.6825, val_error: 0.2000, auc: 0.9378
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.75, correct 3/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (0.738226 --> 0.682519).  Saving model ...


batch 19, loss: 0.0647, instance_loss: 0.1989, weighted_loss: 0.1049, label: 3, bag_size: 18
batch 39, loss: 0.0733, instance_loss: 0.1299, weighted_loss: 0.0903, label: 0, bag_size: 524
batch 59, loss: 0.0084, instance_loss: 0.0850, weighted_loss: 0.0314, label: 3, bag_size: 19
batch 79, loss: 0.1541, instance_loss: 0.1374, weighted_loss: 0.1491, label: 1, bag_size: 636
batch 99, loss: 0.0177, instance_loss: 0.1366, weighted_loss: 0.0534, label: 3, bag_size: 50
batch 119, loss: 1.0676, instance_loss: 0.5412, weighted_loss: 0.9097, label: 3, bag_size: 360
batch 139, loss: 0.0226, instance_loss: 0.0550, weighted_loss: 0.0323, label: 4, bag_size: 123
batch 159, loss: 0.0166, instance_loss: 0.1410, weighted_loss: 0.0539, label: 3, bag_size: 18
batch 179, loss: 0.0632, instance_loss: 0.1314, weighted_loss: 0.0837, label: 4, bag_size: 96
batch 199, loss: 0.0218, instance_loss: 0.0688, weighted_loss: 0.0359, label: 4, bag_size: 202
batch 219, loss: 0.0468, instance_loss: 0.1471, weighted_loss: 0.0769, label: 3, bag_size: 16
batch 239, loss: 0.0814, instance_loss: 0.1218, weighted_loss: 0.0935, label: 1, bag_size: 286
batch 259, loss: 0.0625, instance_loss: 0.1482, weighted_loss: 0.0882, label: 4, bag_size: 143
batch 279, loss: 0.2857, instance_loss: 0.3243, weighted_loss: 0.2973, label: 0, bag_size: 350
batch 299, loss: 0.0803, instance_loss: 0.1086, weighted_loss: 0.0888, label: 0, bag_size: 446
batch 319, loss: 0.0563, instance_loss: 0.2076, weighted_loss: 0.1017, label: 4, bag_size: 125
batch 339, loss: 0.4397, instance_loss: 0.2958, weighted_loss: 0.3965, label: 2, bag_size: 324
batch 359, loss: 0.1996, instance_loss: 0.1623, weighted_loss: 0.1884, label: 1, bag_size: 356
batch 379, loss: 0.3759, instance_loss: 0.4020, weighted_loss: 0.3837, label: 3, bag_size: 936
batch 399, loss: 0.7304, instance_loss: 0.3028, weighted_loss: 0.6021, label: 1, bag_size: 504
batch 419, loss: 0.4051, instance_loss: 0.2742, weighted_loss: 0.3658, label: 2, bag_size: 419
batch 439, loss: 1.7368, instance_loss: 0.5658, weighted_loss: 1.3855, label: 1, bag_size: 377
batch 459, loss: 0.5278, instance_loss: 0.3710, weighted_loss: 0.4808, label: 1, bag_size: 648
batch 479, loss: 0.2664, instance_loss: 0.2966, weighted_loss: 0.2755, label: 0, bag_size: 1579
batch 499, loss: 0.4656, instance_loss: 0.2903, weighted_loss: 0.4130, label: 0, bag_size: 1190
batch 519, loss: 0.1064, instance_loss: 0.1543, weighted_loss: 0.1208, label: 0, bag_size: 1872
batch 539, loss: 0.0114, instance_loss: 0.3121, weighted_loss: 0.1016, label: 4, bag_size: 20


class 0 clustering acc 0.993165137614679: correct 21651/21800
class 1 clustering acc 0.3694954128440367: correct 1611/4360
Epoch: 11, train_loss: 0.5306, train_clustering_loss:  0.3138, train_error: 0.1890
class 0: acc 0.9043478260869565, correct 104/115
class 1: acc 0.6344086021505376, correct 59/93
class 2: acc 0.7549019607843137, correct 77/102
class 3: acc 0.888, correct 111/125
class 4: acc 0.8272727272727273, correct 91/110

Val Set, val_loss: 0.8051, val_error: 0.3200, auc: 0.9365
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.275: correct 110/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.35294117647058826, correct 6/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0068, instance_loss: 0.1830, weighted_loss: 0.0596, label: 3, bag_size: 18
batch 39, loss: 0.0116, instance_loss: 0.1017, weighted_loss: 0.0387, label: 3, bag_size: 20
batch 59, loss: 0.0156, instance_loss: 0.1733, weighted_loss: 0.0629, label: 3, bag_size: 20
batch 79, loss: 0.0747, instance_loss: 0.2160, weighted_loss: 0.1171, label: 4, bag_size: 147
batch 99, loss: 0.0182, instance_loss: 0.0409, weighted_loss: 0.0250, label: 3, bag_size: 305
batch 119, loss: 0.1728, instance_loss: 0.3434, weighted_loss: 0.2240, label: 2, bag_size: 317
batch 139, loss: 0.2653, instance_loss: 0.3074, weighted_loss: 0.2779, label: 4, bag_size: 1002
batch 159, loss: 0.0468, instance_loss: 0.1101, weighted_loss: 0.0658, label: 1, bag_size: 690
batch 179, loss: 0.0138, instance_loss: 0.0543, weighted_loss: 0.0260, label: 4, bag_size: 174
batch 199, loss: 0.4801, instance_loss: 0.3421, weighted_loss: 0.4387, label: 0, bag_size: 1190
batch 219, loss: 0.8856, instance_loss: 0.4285, weighted_loss: 0.7485, label: 3, bag_size: 697
batch 239, loss: 0.1836, instance_loss: 0.3697, weighted_loss: 0.2394, label: 0, bag_size: 120
batch 259, loss: 0.0375, instance_loss: 0.0657, weighted_loss: 0.0460, label: 4, bag_size: 119
batch 279, loss: 0.1895, instance_loss: 0.2616, weighted_loss: 0.2111, label: 0, bag_size: 476
batch 299, loss: 0.2038, instance_loss: 0.2516, weighted_loss: 0.2181, label: 0, bag_size: 1579
batch 319, loss: 0.1562, instance_loss: 0.2563, weighted_loss: 0.1862, label: 2, bag_size: 317
batch 339, loss: 2.2395, instance_loss: 0.5891, weighted_loss: 1.7444, label: 2, bag_size: 120
batch 359, loss: 1.0305, instance_loss: 0.3461, weighted_loss: 0.8252, label: 4, bag_size: 23
batch 379, loss: 1.4132, instance_loss: 0.5491, weighted_loss: 1.1540, label: 3, bag_size: 305
batch 399, loss: 0.0102, instance_loss: 0.0467, weighted_loss: 0.0212, label: 4, bag_size: 125
batch 419, loss: 0.0078, instance_loss: 0.1450, weighted_loss: 0.0490, label: 3, bag_size: 18
batch 439, loss: 0.0073, instance_loss: 0.0540, weighted_loss: 0.0213, label: 3, bag_size: 75
batch 459, loss: 1.4603, instance_loss: 0.8786, weighted_loss: 1.2858, label: 3, bag_size: 1167
batch 479, loss: 1.3617, instance_loss: 0.5638, weighted_loss: 1.1223, label: 2, bag_size: 676
batch 499, loss: 2.1784, instance_loss: 0.7316, weighted_loss: 1.7444, label: 4, bag_size: 366
batch 519, loss: 0.0605, instance_loss: 0.1709, weighted_loss: 0.0936, label: 4, bag_size: 168
batch 539, loss: 0.9361, instance_loss: 0.3802, weighted_loss: 0.7693, label: 0, bag_size: 294


class 0 clustering acc 0.9903669724770642: correct 21590/21800
class 1 clustering acc 0.37293577981651377: correct 1626/4360
Epoch: 12, train_loss: 0.5389, train_clustering_loss:  0.3234, train_error: 0.1982
class 0: acc 0.8484848484848485, correct 84/99
class 1: acc 0.7327586206896551, correct 85/116
class 2: acc 0.7227722772277227, correct 73/101
class 3: acc 0.8448275862068966, correct 98/116
class 4: acc 0.8584070796460177, correct 97/113

Val Set, val_loss: 0.6340, val_error: 0.2000, auc: 0.9441
class 0 clustering acc 0.9935: correct 1987/2000
class 1 clustering acc 0.185: correct 74/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (0.682519 --> 0.634024).  Saving model ...


batch 19, loss: 0.1635, instance_loss: 0.4357, weighted_loss: 0.2451, label: 4, bag_size: 1474
batch 39, loss: 0.0176, instance_loss: 0.0960, weighted_loss: 0.0411, label: 0, bag_size: 1012
batch 59, loss: 0.0819, instance_loss: 0.1181, weighted_loss: 0.0927, label: 4, bag_size: 51
batch 79, loss: 0.0301, instance_loss: 0.1041, weighted_loss: 0.0523, label: 4, bag_size: 51
batch 99, loss: 3.0556, instance_loss: 0.7261, weighted_loss: 2.3567, label: 4, bag_size: 511
batch 119, loss: 0.0234, instance_loss: 0.2021, weighted_loss: 0.0770, label: 3, bag_size: 18
batch 139, loss: 0.2326, instance_loss: 0.4300, weighted_loss: 0.2918, label: 3, bag_size: 1250
batch 159, loss: 0.2640, instance_loss: 0.2858, weighted_loss: 0.2705, label: 0, bag_size: 736
batch 179, loss: 0.1023, instance_loss: 0.2208, weighted_loss: 0.1379, label: 4, bag_size: 40
batch 199, loss: 0.6131, instance_loss: 0.3740, weighted_loss: 0.5413, label: 2, bag_size: 265
batch 219, loss: 0.1952, instance_loss: 0.1115, weighted_loss: 0.1701, label: 4, bag_size: 55
batch 239, loss: 2.1594, instance_loss: 0.6235, weighted_loss: 1.6986, label: 1, bag_size: 435
batch 259, loss: 0.0219, instance_loss: 0.2083, weighted_loss: 0.0778, label: 3, bag_size: 20
batch 279, loss: 1.1982, instance_loss: 0.5015, weighted_loss: 0.9892, label: 2, bag_size: 3236
batch 299, loss: 0.1395, instance_loss: 0.2996, weighted_loss: 0.1875, label: 4, bag_size: 24
batch 319, loss: 0.0774, instance_loss: 0.1383, weighted_loss: 0.0957, label: 1, bag_size: 1086
batch 339, loss: 0.1524, instance_loss: 0.1884, weighted_loss: 0.1632, label: 0, bag_size: 1872
batch 359, loss: 0.0355, instance_loss: 0.0965, weighted_loss: 0.0538, label: 3, bag_size: 28
batch 379, loss: 2.2575, instance_loss: 0.6171, weighted_loss: 1.7654, label: 1, bag_size: 448
batch 399, loss: 0.4172, instance_loss: 0.3114, weighted_loss: 0.3855, label: 2, bag_size: 265
batch 419, loss: 0.0197, instance_loss: 0.1444, weighted_loss: 0.0571, label: 3, bag_size: 34
batch 439, loss: 0.1424, instance_loss: 0.1252, weighted_loss: 0.1372, label: 4, bag_size: 150
batch 459, loss: 1.9382, instance_loss: 0.4903, weighted_loss: 1.5039, label: 4, bag_size: 297
batch 479, loss: 2.6698, instance_loss: 0.7148, weighted_loss: 2.0833, label: 1, bag_size: 1799
batch 499, loss: 0.2189, instance_loss: 0.1431, weighted_loss: 0.1961, label: 1, bag_size: 320
batch 519, loss: 0.7947, instance_loss: 0.5339, weighted_loss: 0.7165, label: 0, bag_size: 607
batch 539, loss: 0.3142, instance_loss: 0.5137, weighted_loss: 0.3741, label: 2, bag_size: 784


class 0 clustering acc 0.991605504587156: correct 21617/21800
class 1 clustering acc 0.35756880733944957: correct 1559/4360
Epoch: 13, train_loss: 0.5524, train_clustering_loss:  0.3257, train_error: 0.2018
class 0: acc 0.8468468468468469, correct 94/111
class 1: acc 0.7010309278350515, correct 68/97
class 2: acc 0.6756756756756757, correct 75/111
class 3: acc 0.8888888888888888, correct 96/108
class 4: acc 0.864406779661017, correct 102/118

Val Set, val_loss: 0.6997, val_error: 0.2200, auc: 0.9303
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3857, instance_loss: 0.7934, weighted_loss: 0.5080, label: 4, bag_size: 675
batch 39, loss: 1.6114, instance_loss: 0.6210, weighted_loss: 1.3143, label: 2, bag_size: 1400
batch 59, loss: 1.3525, instance_loss: 0.4491, weighted_loss: 1.0815, label: 1, bag_size: 917
batch 79, loss: 1.7636, instance_loss: 0.4443, weighted_loss: 1.3678, label: 0, bag_size: 1257
batch 99, loss: 1.3589, instance_loss: 0.5778, weighted_loss: 1.1246, label: 1, bag_size: 535
batch 119, loss: 2.0245, instance_loss: 0.6859, weighted_loss: 1.6229, label: 4, bag_size: 1331
batch 139, loss: 0.6152, instance_loss: 0.4022, weighted_loss: 0.5513, label: 4, bag_size: 636
batch 159, loss: 0.8567, instance_loss: 0.4063, weighted_loss: 0.7216, label: 1, bag_size: 917
batch 179, loss: 0.0124, instance_loss: 0.2141, weighted_loss: 0.0729, label: 4, bag_size: 20
batch 199, loss: 0.0680, instance_loss: 0.3043, weighted_loss: 0.1389, label: 0, bag_size: 148
batch 219, loss: 2.4416, instance_loss: 0.5012, weighted_loss: 1.8595, label: 3, bag_size: 305
batch 239, loss: 0.4825, instance_loss: 0.3944, weighted_loss: 0.4560, label: 4, bag_size: 542
batch 259, loss: 0.0050, instance_loss: 0.0785, weighted_loss: 0.0270, label: 4, bag_size: 157
batch 279, loss: 0.2601, instance_loss: 0.1927, weighted_loss: 0.2399, label: 1, bag_size: 746
batch 299, loss: 1.5814, instance_loss: 0.6822, weighted_loss: 1.3116, label: 4, bag_size: 590
batch 319, loss: 0.0430, instance_loss: 0.0571, weighted_loss: 0.0473, label: 4, bag_size: 178
batch 339, loss: 0.2777, instance_loss: 0.3147, weighted_loss: 0.2888, label: 3, bag_size: 17
batch 359, loss: 0.1906, instance_loss: 0.2482, weighted_loss: 0.2079, label: 0, bag_size: 1872
batch 379, loss: 0.7138, instance_loss: 0.3936, weighted_loss: 0.6177, label: 2, bag_size: 684
batch 399, loss: 0.0443, instance_loss: 0.1173, weighted_loss: 0.0662, label: 4, bag_size: 157
batch 419, loss: 0.0064, instance_loss: 0.0462, weighted_loss: 0.0183, label: 3, bag_size: 72
batch 439, loss: 0.7591, instance_loss: 0.3745, weighted_loss: 0.6438, label: 2, bag_size: 384
batch 459, loss: 0.1968, instance_loss: 0.2583, weighted_loss: 0.2153, label: 2, bag_size: 292
batch 479, loss: 2.9305, instance_loss: 0.7977, weighted_loss: 2.2907, label: 3, bag_size: 211
batch 499, loss: 0.0135, instance_loss: 0.1800, weighted_loss: 0.0634, label: 3, bag_size: 16
batch 519, loss: 0.9949, instance_loss: 0.3411, weighted_loss: 0.7987, label: 1, bag_size: 898
batch 539, loss: 0.0189, instance_loss: 0.0363, weighted_loss: 0.0241, label: 4, bag_size: 143


class 0 clustering acc 0.9909633027522936: correct 21603/21800
class 1 clustering acc 0.3676605504587156: correct 1603/4360
Epoch: 14, train_loss: 0.5080, train_clustering_loss:  0.3158, train_error: 0.1780
class 0: acc 0.868421052631579, correct 99/114
class 1: acc 0.6788990825688074, correct 74/109
class 2: acc 0.7589285714285714, correct 85/112
class 3: acc 0.9150943396226415, correct 97/106
class 4: acc 0.8942307692307693, correct 93/104

Val Set, val_loss: 0.6746, val_error: 0.3000, auc: 0.9445
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.3175: correct 127/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.4117647058823529, correct 7/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0910, instance_loss: 0.2426, weighted_loss: 0.1365, label: 0, bag_size: 350
batch 39, loss: 0.0397, instance_loss: 0.0488, weighted_loss: 0.0424, label: 4, bag_size: 192
batch 59, loss: 0.0829, instance_loss: 0.0699, weighted_loss: 0.0790, label: 1, bag_size: 636
batch 79, loss: 1.2231, instance_loss: 0.7337, weighted_loss: 1.0763, label: 3, bag_size: 1167
batch 99, loss: 2.0417, instance_loss: 0.5560, weighted_loss: 1.5960, label: 2, bag_size: 355
batch 119, loss: 0.3215, instance_loss: 0.3492, weighted_loss: 0.3298, label: 2, bag_size: 758
batch 139, loss: 2.5874, instance_loss: 0.6149, weighted_loss: 1.9956, label: 0, bag_size: 868
batch 159, loss: 0.0259, instance_loss: 0.0899, weighted_loss: 0.0451, label: 3, bag_size: 105
batch 179, loss: 0.0075, instance_loss: 0.0657, weighted_loss: 0.0250, label: 0, bag_size: 898
batch 199, loss: 3.1941, instance_loss: 0.8241, weighted_loss: 2.4831, label: 4, bag_size: 436
batch 219, loss: 0.6849, instance_loss: 0.4573, weighted_loss: 0.6166, label: 1, bag_size: 917
batch 239, loss: 0.0088, instance_loss: 0.0683, weighted_loss: 0.0267, label: 4, bag_size: 157
batch 259, loss: 0.0345, instance_loss: 0.2465, weighted_loss: 0.0981, label: 4, bag_size: 14
batch 279, loss: 0.1865, instance_loss: 0.2286, weighted_loss: 0.1991, label: 0, bag_size: 413
batch 299, loss: 0.0139, instance_loss: 0.1166, weighted_loss: 0.0447, label: 4, bag_size: 211
batch 319, loss: 0.0257, instance_loss: 0.1210, weighted_loss: 0.0543, label: 3, bag_size: 105
batch 339, loss: 0.4908, instance_loss: 0.4350, weighted_loss: 0.4740, label: 0, bag_size: 114
batch 359, loss: 0.6042, instance_loss: 0.3736, weighted_loss: 0.5350, label: 2, bag_size: 1039
batch 379, loss: 0.7715, instance_loss: 0.4783, weighted_loss: 0.6835, label: 2, bag_size: 795
batch 399, loss: 0.3156, instance_loss: 0.3732, weighted_loss: 0.3329, label: 0, bag_size: 1135
batch 419, loss: 0.5730, instance_loss: 0.3668, weighted_loss: 0.5112, label: 3, bag_size: 1380
batch 439, loss: 0.0855, instance_loss: 0.2191, weighted_loss: 0.1256, label: 3, bag_size: 18
batch 459, loss: 0.2198, instance_loss: 0.2775, weighted_loss: 0.2371, label: 2, bag_size: 1514
batch 479, loss: 0.1094, instance_loss: 0.1990, weighted_loss: 0.1362, label: 2, bag_size: 292
batch 499, loss: 0.9928, instance_loss: 0.4242, weighted_loss: 0.8223, label: 1, bag_size: 897
batch 519, loss: 0.7144, instance_loss: 0.4639, weighted_loss: 0.6392, label: 2, bag_size: 396
batch 539, loss: 0.5570, instance_loss: 0.3341, weighted_loss: 0.4901, label: 0, bag_size: 1190


class 0 clustering acc 0.991605504587156: correct 21617/21800
class 1 clustering acc 0.3944954128440367: correct 1720/4360
Epoch: 15, train_loss: 0.4903, train_clustering_loss:  0.3024, train_error: 0.1835
class 0: acc 0.8991596638655462, correct 107/119
class 1: acc 0.7589285714285714, correct 85/112
class 2: acc 0.696078431372549, correct 71/102
class 3: acc 0.87, correct 87/100
class 4: acc 0.8482142857142857, correct 95/112

Val Set, val_loss: 0.6296, val_error: 0.2400, auc: 0.9455
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.245: correct 98/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
Validation loss decreased (0.634024 --> 0.629561).  Saving model ...


batch 19, loss: 0.5856, instance_loss: 0.4018, weighted_loss: 0.5305, label: 2, bag_size: 411
batch 39, loss: 0.0318, instance_loss: 0.1035, weighted_loss: 0.0533, label: 0, bag_size: 524
batch 59, loss: 2.6337, instance_loss: 0.7177, weighted_loss: 2.0589, label: 1, bag_size: 1172
batch 79, loss: 0.2131, instance_loss: 0.2383, weighted_loss: 0.2207, label: 0, bag_size: 375
batch 99, loss: 0.1949, instance_loss: 0.2336, weighted_loss: 0.2065, label: 2, bag_size: 1019
batch 119, loss: 0.2108, instance_loss: 0.2471, weighted_loss: 0.2217, label: 0, bag_size: 1190
batch 139, loss: 1.0306, instance_loss: 0.5144, weighted_loss: 0.8758, label: 2, bag_size: 1006
batch 159, loss: 0.0135, instance_loss: 0.4231, weighted_loss: 0.1363, label: 4, bag_size: 14
batch 179, loss: 0.7054, instance_loss: 0.4891, weighted_loss: 0.6405, label: 1, bag_size: 917
batch 199, loss: 0.2004, instance_loss: 0.2578, weighted_loss: 0.2176, label: 0, bag_size: 1579
batch 219, loss: 0.0082, instance_loss: 0.0488, weighted_loss: 0.0204, label: 0, bag_size: 898
batch 239, loss: 0.1552, instance_loss: 0.2399, weighted_loss: 0.1806, label: 4, bag_size: 636
batch 259, loss: 0.0704, instance_loss: 0.2073, weighted_loss: 0.1114, label: 4, bag_size: 636
batch 279, loss: 0.3951, instance_loss: 0.3819, weighted_loss: 0.3912, label: 2, bag_size: 537
batch 299, loss: 0.0750, instance_loss: 0.2524, weighted_loss: 0.1283, label: 0, bag_size: 466
batch 319, loss: 0.3831, instance_loss: 0.3951, weighted_loss: 0.3867, label: 2, bag_size: 883
batch 339, loss: 0.0061, instance_loss: 0.0633, weighted_loss: 0.0232, label: 4, bag_size: 48
batch 359, loss: 0.0696, instance_loss: 0.3681, weighted_loss: 0.1591, label: 0, bag_size: 155
batch 379, loss: 0.0471, instance_loss: 0.1715, weighted_loss: 0.0844, label: 0, bag_size: 1061
batch 399, loss: 0.1311, instance_loss: 0.1077, weighted_loss: 0.1241, label: 4, bag_size: 211
batch 419, loss: 0.0360, instance_loss: 0.0773, weighted_loss: 0.0484, label: 3, bag_size: 60
batch 439, loss: 0.0057, instance_loss: 0.2229, weighted_loss: 0.0708, label: 3, bag_size: 20
batch 459, loss: 0.0091, instance_loss: 0.1245, weighted_loss: 0.0438, label: 3, bag_size: 20
batch 479, loss: 0.1467, instance_loss: 0.3041, weighted_loss: 0.1939, label: 0, bag_size: 476
batch 499, loss: 0.0022, instance_loss: 0.0555, weighted_loss: 0.0182, label: 4, bag_size: 143
batch 519, loss: 0.6426, instance_loss: 0.4164, weighted_loss: 0.5747, label: 0, bag_size: 1065
batch 539, loss: 0.2789, instance_loss: 0.2229, weighted_loss: 0.2621, label: 1, bag_size: 945


class 0 clustering acc 0.9888532110091743: correct 21557/21800
class 1 clustering acc 0.38692660550458713: correct 1687/4360
Epoch: 16, train_loss: 0.4165, train_clustering_loss:  0.3050, train_error: 0.1486
class 0: acc 0.927007299270073, correct 127/137
class 1: acc 0.7524752475247525, correct 76/101
class 2: acc 0.75, correct 81/108
class 3: acc 0.8936170212765957, correct 84/94
class 4: acc 0.9142857142857143, correct 96/105

Val Set, val_loss: 0.8428, val_error: 0.3000, auc: 0.9429
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.5294117647058824, correct 9/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7532, instance_loss: 0.5740, weighted_loss: 0.6995, label: 3, bag_size: 200
batch 39, loss: 1.8384, instance_loss: 0.5490, weighted_loss: 1.4516, label: 3, bag_size: 1380
batch 59, loss: 0.2077, instance_loss: 0.3622, weighted_loss: 0.2541, label: 2, bag_size: 638
batch 79, loss: 0.0005, instance_loss: 0.0395, weighted_loss: 0.0122, label: 3, bag_size: 56
batch 99, loss: 0.1734, instance_loss: 0.5127, weighted_loss: 0.2752, label: 0, bag_size: 163
batch 119, loss: 0.0084, instance_loss: 0.0816, weighted_loss: 0.0304, label: 3, bag_size: 35
batch 139, loss: 2.3007, instance_loss: 0.4418, weighted_loss: 1.7430, label: 2, bag_size: 600
batch 159, loss: 0.8210, instance_loss: 0.3426, weighted_loss: 0.6775, label: 0, bag_size: 294
batch 179, loss: 0.0451, instance_loss: 0.1764, weighted_loss: 0.0845, label: 4, bag_size: 119
batch 199, loss: 0.1100, instance_loss: 0.4638, weighted_loss: 0.2162, label: 4, bag_size: 1176
batch 219, loss: 0.0186, instance_loss: 0.1762, weighted_loss: 0.0659, label: 3, bag_size: 16
batch 239, loss: 0.2058, instance_loss: 0.1870, weighted_loss: 0.2002, label: 4, bag_size: 192
batch 259, loss: 0.5429, instance_loss: 0.3741, weighted_loss: 0.4923, label: 2, bag_size: 537
batch 279, loss: 0.0533, instance_loss: 0.1764, weighted_loss: 0.0903, label: 3, bag_size: 16
batch 299, loss: 0.0185, instance_loss: 0.0730, weighted_loss: 0.0348, label: 0, bag_size: 239
batch 319, loss: 0.0176, instance_loss: 0.1227, weighted_loss: 0.0492, label: 4, bag_size: 55
batch 339, loss: 1.0537, instance_loss: 0.4042, weighted_loss: 0.8588, label: 2, bag_size: 684
batch 359, loss: 0.5200, instance_loss: 0.5398, weighted_loss: 0.5260, label: 3, bag_size: 706
batch 379, loss: 0.2070, instance_loss: 0.2420, weighted_loss: 0.2175, label: 1, bag_size: 530
batch 399, loss: 2.1481, instance_loss: 0.5076, weighted_loss: 1.6559, label: 2, bag_size: 252
batch 419, loss: 0.0179, instance_loss: 0.0500, weighted_loss: 0.0275, label: 4, bag_size: 96
batch 439, loss: 0.1469, instance_loss: 0.5876, weighted_loss: 0.2791, label: 0, bag_size: 118
batch 459, loss: 0.1271, instance_loss: 0.2590, weighted_loss: 0.1666, label: 2, bag_size: 910
batch 479, loss: 0.3304, instance_loss: 0.2629, weighted_loss: 0.3101, label: 2, bag_size: 1569
batch 499, loss: 1.2260, instance_loss: 0.6632, weighted_loss: 1.0572, label: 2, bag_size: 295
batch 519, loss: 0.5572, instance_loss: 0.2084, weighted_loss: 0.4525, label: 1, bag_size: 442
batch 539, loss: 0.0615, instance_loss: 0.3432, weighted_loss: 0.1460, label: 3, bag_size: 849


class 0 clustering acc 0.9893119266055046: correct 21567/21800
class 1 clustering acc 0.41009174311926605: correct 1788/4360
Epoch: 17, train_loss: 0.4088, train_clustering_loss:  0.3000, train_error: 0.1358
class 0: acc 0.9224137931034483, correct 107/116
class 1: acc 0.7962962962962963, correct 86/108
class 2: acc 0.7570093457943925, correct 81/107
class 3: acc 0.9238095238095239, correct 97/105
class 4: acc 0.9174311926605505, correct 100/109

Val Set, val_loss: 0.6996, val_error: 0.2800, auc: 0.9427
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0068, instance_loss: 0.0650, weighted_loss: 0.0243, label: 3, bag_size: 66
batch 39, loss: 0.5608, instance_loss: 0.3046, weighted_loss: 0.4839, label: 0, bag_size: 1101
batch 59, loss: 1.3650, instance_loss: 0.4720, weighted_loss: 1.0971, label: 0, bag_size: 1257
batch 79, loss: 0.1692, instance_loss: 0.2444, weighted_loss: 0.1918, label: 2, bag_size: 701
batch 99, loss: 0.0091, instance_loss: 0.0734, weighted_loss: 0.0284, label: 3, bag_size: 54
batch 119, loss: 0.1274, instance_loss: 0.1371, weighted_loss: 0.1303, label: 4, bag_size: 28
batch 139, loss: 0.1568, instance_loss: 0.4721, weighted_loss: 0.2514, label: 3, bag_size: 706
batch 159, loss: 0.0016, instance_loss: 0.2832, weighted_loss: 0.0861, label: 4, bag_size: 14
batch 179, loss: 0.2591, instance_loss: 0.3169, weighted_loss: 0.2764, label: 3, bag_size: 791
batch 199, loss: 0.0017, instance_loss: 0.1773, weighted_loss: 0.0544, label: 4, bag_size: 20
batch 219, loss: 0.0531, instance_loss: 0.1209, weighted_loss: 0.0734, label: 3, bag_size: 305
batch 239, loss: 0.0430, instance_loss: 0.1539, weighted_loss: 0.0763, label: 0, bag_size: 367
batch 259, loss: 2.5836, instance_loss: 0.9070, weighted_loss: 2.0806, label: 3, bag_size: 281
batch 279, loss: 0.0005, instance_loss: 0.0900, weighted_loss: 0.0274, label: 3, bag_size: 24
batch 299, loss: 0.8875, instance_loss: 0.4779, weighted_loss: 0.7646, label: 0, bag_size: 736
batch 319, loss: 0.8958, instance_loss: 0.4750, weighted_loss: 0.7696, label: 3, bag_size: 841
batch 339, loss: 3.5074, instance_loss: 0.5160, weighted_loss: 2.6100, label: 2, bag_size: 537
batch 359, loss: 0.1752, instance_loss: 0.3246, weighted_loss: 0.2200, label: 1, bag_size: 925
batch 379, loss: 0.4385, instance_loss: 0.2612, weighted_loss: 0.3853, label: 2, bag_size: 2081
batch 399, loss: 1.9870, instance_loss: 0.7507, weighted_loss: 1.6161, label: 2, bag_size: 959
batch 419, loss: 0.0592, instance_loss: 0.2202, weighted_loss: 0.1075, label: 1, bag_size: 474
batch 439, loss: 0.0033, instance_loss: 0.0162, weighted_loss: 0.0072, label: 4, bag_size: 174
batch 459, loss: 0.6341, instance_loss: 0.5651, weighted_loss: 0.6134, label: 0, bag_size: 801
batch 479, loss: 0.0264, instance_loss: 0.3163, weighted_loss: 0.1134, label: 3, bag_size: 936
batch 499, loss: 0.0301, instance_loss: 0.1446, weighted_loss: 0.0645, label: 3, bag_size: 18
batch 519, loss: 0.0226, instance_loss: 0.0688, weighted_loss: 0.0364, label: 4, bag_size: 182
batch 539, loss: 0.9091, instance_loss: 0.4892, weighted_loss: 0.7831, label: 4, bag_size: 1337


class 0 clustering acc 0.9898165137614678: correct 21578/21800
class 1 clustering acc 0.42752293577981654: correct 1864/4360
Epoch: 18, train_loss: 0.4082, train_clustering_loss:  0.2947, train_error: 0.1394
class 0: acc 0.8725490196078431, correct 89/102
class 1: acc 0.78, correct 78/100
class 2: acc 0.8148148148148148, correct 88/108
class 3: acc 0.9401709401709402, correct 110/117
class 4: acc 0.8813559322033898, correct 104/118

Val Set, val_loss: 0.8520, val_error: 0.2800, auc: 0.9412
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 3.0894, instance_loss: 0.7799, weighted_loss: 2.3966, label: 1, bag_size: 435
batch 39, loss: 0.0124, instance_loss: 0.0469, weighted_loss: 0.0228, label: 4, bag_size: 157
batch 59, loss: 0.0033, instance_loss: 0.0563, weighted_loss: 0.0192, label: 0, bag_size: 360
batch 79, loss: 0.1173, instance_loss: 0.1676, weighted_loss: 0.1324, label: 4, bag_size: 44
batch 99, loss: 0.0063, instance_loss: 0.0834, weighted_loss: 0.0295, label: 4, bag_size: 130
batch 119, loss: 0.0999, instance_loss: 0.1150, weighted_loss: 0.1044, label: 1, bag_size: 504
batch 139, loss: 0.0861, instance_loss: 0.2073, weighted_loss: 0.1224, label: 2, bag_size: 286
batch 159, loss: 0.1755, instance_loss: 0.2456, weighted_loss: 0.1965, label: 1, bag_size: 530
batch 179, loss: 0.0279, instance_loss: 0.2049, weighted_loss: 0.0810, label: 4, bag_size: 1176
batch 199, loss: 0.0009, instance_loss: 0.0312, weighted_loss: 0.0100, label: 4, bag_size: 157
batch 219, loss: 2.6832, instance_loss: 0.8619, weighted_loss: 2.1368, label: 1, bag_size: 875
batch 239, loss: 1.3901, instance_loss: 0.6304, weighted_loss: 1.1622, label: 3, bag_size: 200
batch 259, loss: 0.1035, instance_loss: 0.1552, weighted_loss: 0.1190, label: 0, bag_size: 524
batch 279, loss: 0.1492, instance_loss: 0.2248, weighted_loss: 0.1719, label: 0, bag_size: 424
batch 299, loss: 0.1531, instance_loss: 0.1754, weighted_loss: 0.1598, label: 1, bag_size: 949
batch 319, loss: 0.1358, instance_loss: 0.4823, weighted_loss: 0.2397, label: 2, bag_size: 358
batch 339, loss: 0.0738, instance_loss: 0.1619, weighted_loss: 0.1002, label: 0, bag_size: 350
batch 359, loss: 0.0219, instance_loss: 0.0613, weighted_loss: 0.0337, label: 4, bag_size: 96
batch 379, loss: 0.1695, instance_loss: 0.4259, weighted_loss: 0.2464, label: 3, bag_size: 697
batch 399, loss: 0.1172, instance_loss: 0.2894, weighted_loss: 0.1688, label: 0, bag_size: 616
batch 419, loss: 2.1920, instance_loss: 0.7714, weighted_loss: 1.7658, label: 4, bag_size: 366
batch 439, loss: 1.2041, instance_loss: 0.5054, weighted_loss: 0.9945, label: 1, bag_size: 269
batch 459, loss: 0.0066, instance_loss: 0.0301, weighted_loss: 0.0136, label: 4, bag_size: 130
batch 479, loss: 1.3107, instance_loss: 0.5599, weighted_loss: 1.0855, label: 2, bag_size: 356
batch 499, loss: 0.0132, instance_loss: 0.0831, weighted_loss: 0.0341, label: 4, bag_size: 150
batch 519, loss: 0.3471, instance_loss: 0.3232, weighted_loss: 0.3399, label: 1, bag_size: 348
batch 539, loss: 0.3317, instance_loss: 0.5312, weighted_loss: 0.3916, label: 3, bag_size: 230


class 0 clustering acc 0.9874770642201834: correct 21527/21800
class 1 clustering acc 0.42660550458715596: correct 1860/4360
Epoch: 19, train_loss: 0.3920, train_clustering_loss:  0.2955, train_error: 0.1303
class 0: acc 0.9256198347107438, correct 112/121
class 1: acc 0.7653061224489796, correct 75/98
class 2: acc 0.8032786885245902, correct 98/122
class 3: acc 0.9306930693069307, correct 94/101
class 4: acc 0.9223300970873787, correct 95/103

Val Set, val_loss: 0.7220, val_error: 0.2800, auc: 0.9425
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.3075: correct 123/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1575, instance_loss: 0.3419, weighted_loss: 0.2128, label: 0, bag_size: 607
batch 39, loss: 0.1747, instance_loss: 0.2771, weighted_loss: 0.2054, label: 0, bag_size: 476
batch 59, loss: 0.1134, instance_loss: 0.2002, weighted_loss: 0.1394, label: 0, bag_size: 1135
batch 79, loss: 0.6203, instance_loss: 0.8284, weighted_loss: 0.6827, label: 3, bag_size: 1167
batch 99, loss: 0.0045, instance_loss: 0.1886, weighted_loss: 0.0597, label: 4, bag_size: 128
batch 119, loss: 0.0426, instance_loss: 0.0717, weighted_loss: 0.0513, label: 3, bag_size: 1172
batch 139, loss: 0.1380, instance_loss: 0.3027, weighted_loss: 0.1874, label: 0, bag_size: 1301
batch 159, loss: 0.2584, instance_loss: 0.3557, weighted_loss: 0.2876, label: 2, bag_size: 1235
batch 179, loss: 0.1698, instance_loss: 0.2446, weighted_loss: 0.1922, label: 1, bag_size: 867
batch 199, loss: 0.0169, instance_loss: 0.0649, weighted_loss: 0.0313, label: 4, bag_size: 104
batch 219, loss: 0.2893, instance_loss: 0.5319, weighted_loss: 0.3621, label: 1, bag_size: 778
batch 239, loss: 3.5943, instance_loss: 0.8279, weighted_loss: 2.7643, label: 4, bag_size: 210
batch 259, loss: 0.0027, instance_loss: 0.0794, weighted_loss: 0.0257, label: 3, bag_size: 75
batch 279, loss: 0.0056, instance_loss: 0.0900, weighted_loss: 0.0309, label: 4, bag_size: 178
batch 299, loss: 0.0048, instance_loss: 0.0415, weighted_loss: 0.0158, label: 4, bag_size: 143
batch 319, loss: 0.0074, instance_loss: 0.0494, weighted_loss: 0.0200, label: 0, bag_size: 1101
batch 339, loss: 0.1327, instance_loss: 0.2624, weighted_loss: 0.1716, label: 2, bag_size: 324
batch 359, loss: 0.7639, instance_loss: 0.2592, weighted_loss: 0.6125, label: 4, bag_size: 19
batch 379, loss: 0.0044, instance_loss: 0.1752, weighted_loss: 0.0556, label: 4, bag_size: 47
batch 399, loss: 0.0052, instance_loss: 0.1805, weighted_loss: 0.0578, label: 3, bag_size: 20
batch 419, loss: 0.0022, instance_loss: 0.0287, weighted_loss: 0.0102, label: 4, bag_size: 143
batch 439, loss: 0.3652, instance_loss: 0.2882, weighted_loss: 0.3421, label: 1, bag_size: 897
batch 459, loss: 0.0936, instance_loss: 0.1579, weighted_loss: 0.1129, label: 0, bag_size: 382
batch 479, loss: 0.0598, instance_loss: 0.2066, weighted_loss: 0.1038, label: 0, bag_size: 176
batch 499, loss: 0.3818, instance_loss: 0.3581, weighted_loss: 0.3747, label: 2, bag_size: 264
batch 519, loss: 0.1439, instance_loss: 0.4223, weighted_loss: 0.2274, label: 2, bag_size: 358
batch 539, loss: 0.0026, instance_loss: 0.1312, weighted_loss: 0.0412, label: 4, bag_size: 790


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.45114678899082566: correct 1967/4360
Epoch: 20, train_loss: 0.3538, train_clustering_loss:  0.2844, train_error: 0.1266
class 0: acc 0.9338842975206612, correct 113/121
class 1: acc 0.8482142857142857, correct 95/112
class 2: acc 0.811965811965812, correct 95/117
class 3: acc 0.8953488372093024, correct 77/86
class 4: acc 0.8807339449541285, correct 96/109

Val Set, val_loss: 0.7882, val_error: 0.2800, auc: 0.9357
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.33: correct 132/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1112, instance_loss: 0.1284, weighted_loss: 0.1164, label: 1, bag_size: 1426
batch 39, loss: 0.1316, instance_loss: 0.3144, weighted_loss: 0.1865, label: 1, bag_size: 474
batch 59, loss: 0.9599, instance_loss: 0.4603, weighted_loss: 0.8100, label: 1, bag_size: 535
batch 79, loss: 1.5485, instance_loss: 0.6149, weighted_loss: 1.2684, label: 2, bag_size: 732
batch 99, loss: 0.0559, instance_loss: 0.1058, weighted_loss: 0.0709, label: 1, bag_size: 994
batch 119, loss: 0.1004, instance_loss: 0.1991, weighted_loss: 0.1300, label: 3, bag_size: 17
batch 139, loss: 0.0278, instance_loss: 0.1094, weighted_loss: 0.0523, label: 4, bag_size: 60
batch 159, loss: 0.0548, instance_loss: 0.1198, weighted_loss: 0.0743, label: 0, bag_size: 340
batch 179, loss: 0.0101, instance_loss: 0.0663, weighted_loss: 0.0270, label: 0, bag_size: 382
batch 199, loss: 0.1623, instance_loss: 0.2814, weighted_loss: 0.1980, label: 0, bag_size: 570
batch 219, loss: 1.1923, instance_loss: 0.4668, weighted_loss: 0.9746, label: 1, bag_size: 868
batch 239, loss: 0.4904, instance_loss: 0.2782, weighted_loss: 0.4267, label: 1, bag_size: 470
batch 259, loss: 0.0816, instance_loss: 0.2885, weighted_loss: 0.1437, label: 0, bag_size: 653
batch 279, loss: 0.0615, instance_loss: 0.2333, weighted_loss: 0.1130, label: 4, bag_size: 636
batch 299, loss: 0.0001, instance_loss: 0.0140, weighted_loss: 0.0043, label: 4, bag_size: 185
batch 319, loss: 0.0433, instance_loss: 0.1485, weighted_loss: 0.0749, label: 1, bag_size: 945
batch 339, loss: 0.0318, instance_loss: 0.1507, weighted_loss: 0.0675, label: 0, bag_size: 524
batch 359, loss: 0.0780, instance_loss: 0.3565, weighted_loss: 0.1616, label: 4, bag_size: 24
batch 379, loss: 0.0391, instance_loss: 0.1567, weighted_loss: 0.0744, label: 0, bag_size: 1012
batch 399, loss: 0.1086, instance_loss: 0.1931, weighted_loss: 0.1339, label: 1, bag_size: 949
batch 419, loss: 1.6442, instance_loss: 0.5754, weighted_loss: 1.3236, label: 2, bag_size: 411
batch 439, loss: 0.0057, instance_loss: 0.0359, weighted_loss: 0.0148, label: 0, bag_size: 982
batch 459, loss: 0.6236, instance_loss: 0.4380, weighted_loss: 0.5679, label: 2, bag_size: 725
batch 479, loss: 0.0413, instance_loss: 0.1676, weighted_loss: 0.0792, label: 0, bag_size: 756
batch 499, loss: 0.0215, instance_loss: 0.0605, weighted_loss: 0.0332, label: 3, bag_size: 54
batch 519, loss: 0.5344, instance_loss: 0.4422, weighted_loss: 0.5068, label: 1, bag_size: 1197
batch 539, loss: 0.0292, instance_loss: 0.1636, weighted_loss: 0.0695, label: 0, bag_size: 552


class 0 clustering acc 0.990137614678899: correct 21585/21800
class 1 clustering acc 0.44128440366972477: correct 1924/4360
Epoch: 21, train_loss: 0.4095, train_clustering_loss:  0.2921, train_error: 0.1376
class 0: acc 0.8796296296296297, correct 95/108
class 1: acc 0.8672566371681416, correct 98/113
class 2: acc 0.7433628318584071, correct 84/113
class 3: acc 0.8725490196078431, correct 89/102
class 4: acc 0.9541284403669725, correct 104/109

Val Set, val_loss: 0.6735, val_error: 0.2800, auc: 0.9441
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.31: correct 124/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.5294117647058824, correct 9/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2109, instance_loss: 0.4140, weighted_loss: 0.2718, label: 2, bag_size: 725
batch 39, loss: 0.0025, instance_loss: 0.1863, weighted_loss: 0.0576, label: 3, bag_size: 20
batch 59, loss: 0.0198, instance_loss: 0.0741, weighted_loss: 0.0361, label: 3, bag_size: 29
batch 79, loss: 0.2506, instance_loss: 0.5364, weighted_loss: 0.3363, label: 4, bag_size: 754
batch 99, loss: 0.0077, instance_loss: 0.2319, weighted_loss: 0.0749, label: 4, bag_size: 20
batch 119, loss: 0.2729, instance_loss: 0.1950, weighted_loss: 0.2495, label: 1, bag_size: 348
batch 139, loss: 0.0066, instance_loss: 0.0831, weighted_loss: 0.0296, label: 3, bag_size: 20
batch 159, loss: 0.0056, instance_loss: 0.0629, weighted_loss: 0.0228, label: 3, bag_size: 75
batch 179, loss: 0.0125, instance_loss: 0.0463, weighted_loss: 0.0226, label: 4, bag_size: 160
batch 199, loss: 0.1108, instance_loss: 0.7093, weighted_loss: 0.2904, label: 3, bag_size: 1167
batch 219, loss: 0.4458, instance_loss: 0.3101, weighted_loss: 0.4051, label: 4, bag_size: 388
batch 239, loss: 0.1277, instance_loss: 0.1590, weighted_loss: 0.1371, label: 0, bag_size: 760
batch 259, loss: 0.0062, instance_loss: 0.0191, weighted_loss: 0.0101, label: 4, bag_size: 130
batch 279, loss: 0.8259, instance_loss: 0.7094, weighted_loss: 0.7910, label: 4, bag_size: 675
batch 299, loss: 0.2056, instance_loss: 0.3034, weighted_loss: 0.2349, label: 2, bag_size: 537
batch 319, loss: 0.3192, instance_loss: 0.2017, weighted_loss: 0.2840, label: 0, bag_size: 294
batch 339, loss: 0.1929, instance_loss: 0.1547, weighted_loss: 0.1814, label: 0, bag_size: 424
batch 359, loss: 0.0832, instance_loss: 0.5048, weighted_loss: 0.2097, label: 1, bag_size: 1646
batch 379, loss: 1.0496, instance_loss: 0.5083, weighted_loss: 0.8872, label: 1, bag_size: 861
batch 399, loss: 0.0031, instance_loss: 0.0785, weighted_loss: 0.0257, label: 1, bag_size: 1376
batch 419, loss: 1.8372, instance_loss: 0.7062, weighted_loss: 1.4979, label: 0, bag_size: 245
batch 439, loss: 0.1627, instance_loss: 0.2759, weighted_loss: 0.1967, label: 2, bag_size: 1053
batch 459, loss: 0.0029, instance_loss: 0.0189, weighted_loss: 0.0077, label: 4, bag_size: 130
batch 479, loss: 0.1277, instance_loss: 0.3239, weighted_loss: 0.1866, label: 3, bag_size: 849
batch 499, loss: 0.3489, instance_loss: 0.3669, weighted_loss: 0.3543, label: 1, bag_size: 711
batch 519, loss: 0.0641, instance_loss: 0.1517, weighted_loss: 0.0904, label: 1, bag_size: 356
batch 539, loss: 0.1686, instance_loss: 0.2445, weighted_loss: 0.1914, label: 2, bag_size: 913


class 0 clustering acc 0.98848623853211: correct 21549/21800
class 1 clustering acc 0.4577981651376147: correct 1996/4360
Epoch: 22, train_loss: 0.3663, train_clustering_loss:  0.2849, train_error: 0.1376
class 0: acc 0.9174311926605505, correct 100/109
class 1: acc 0.7678571428571429, correct 86/112
class 2: acc 0.7868852459016393, correct 96/122
class 3: acc 0.9375, correct 105/112
class 4: acc 0.9222222222222223, correct 83/90

Val Set, val_loss: 0.6966, val_error: 0.2600, auc: 0.9447
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.275: correct 110/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0024, instance_loss: 0.0708, weighted_loss: 0.0229, label: 4, bag_size: 83
batch 39, loss: 0.0118, instance_loss: 0.0702, weighted_loss: 0.0293, label: 3, bag_size: 20
batch 59, loss: 0.0744, instance_loss: 0.2518, weighted_loss: 0.1276, label: 2, bag_size: 913
batch 79, loss: 0.0083, instance_loss: 0.5821, weighted_loss: 0.1805, label: 4, bag_size: 14
batch 99, loss: 0.0631, instance_loss: 0.1672, weighted_loss: 0.0943, label: 0, bag_size: 990
batch 119, loss: 0.1265, instance_loss: 0.1588, weighted_loss: 0.1362, label: 1, bag_size: 690
batch 139, loss: 0.0071, instance_loss: 0.0757, weighted_loss: 0.0277, label: 3, bag_size: 26
batch 159, loss: 0.0300, instance_loss: 0.0720, weighted_loss: 0.0426, label: 3, bag_size: 405
batch 179, loss: 1.0074, instance_loss: 0.3664, weighted_loss: 0.8151, label: 2, bag_size: 317
batch 199, loss: 0.2159, instance_loss: 0.2486, weighted_loss: 0.2257, label: 3, bag_size: 533
batch 219, loss: 0.8144, instance_loss: 0.4750, weighted_loss: 0.7126, label: 2, bag_size: 1218
batch 239, loss: 0.0074, instance_loss: 0.1663, weighted_loss: 0.0551, label: 4, bag_size: 38
batch 259, loss: 0.1090, instance_loss: 0.1519, weighted_loss: 0.1219, label: 1, bag_size: 949
batch 279, loss: 0.0948, instance_loss: 0.2379, weighted_loss: 0.1377, label: 0, bag_size: 1255
batch 299, loss: 0.0013, instance_loss: 0.3533, weighted_loss: 0.1069, label: 4, bag_size: 17
batch 319, loss: 0.7343, instance_loss: 0.5016, weighted_loss: 0.6645, label: 4, bag_size: 1331
batch 339, loss: 0.0098, instance_loss: 0.0893, weighted_loss: 0.0336, label: 3, bag_size: 28
batch 359, loss: 1.4665, instance_loss: 0.4614, weighted_loss: 1.1650, label: 1, bag_size: 377
batch 379, loss: 0.1930, instance_loss: 0.2076, weighted_loss: 0.1974, label: 0, bag_size: 1133
batch 399, loss: 0.0881, instance_loss: 0.1810, weighted_loss: 0.1160, label: 2, bag_size: 839
batch 419, loss: 0.0890, instance_loss: 0.4708, weighted_loss: 0.2035, label: 3, bag_size: 1167
batch 439, loss: 0.3459, instance_loss: 0.3879, weighted_loss: 0.3585, label: 2, bag_size: 758
batch 459, loss: 0.3156, instance_loss: 0.3046, weighted_loss: 0.3123, label: 2, bag_size: 1050
batch 479, loss: 0.0007, instance_loss: 0.0408, weighted_loss: 0.0127, label: 4, bag_size: 157
batch 499, loss: 0.1518, instance_loss: 0.2922, weighted_loss: 0.1939, label: 0, bag_size: 962
batch 519, loss: 0.0003, instance_loss: 0.0250, weighted_loss: 0.0077, label: 4, bag_size: 130
batch 539, loss: 0.6880, instance_loss: 0.4918, weighted_loss: 0.6292, label: 1, bag_size: 448


class 0 clustering acc 0.9898623853211009: correct 21579/21800
class 1 clustering acc 0.43486238532110094: correct 1896/4360
Epoch: 23, train_loss: 0.3846, train_clustering_loss:  0.2975, train_error: 0.1321
class 0: acc 0.912621359223301, correct 94/103
class 1: acc 0.7706422018348624, correct 84/109
class 2: acc 0.7747747747747747, correct 86/111
class 3: acc 0.9411764705882353, correct 96/102
class 4: acc 0.9416666666666667, correct 113/120

Val Set, val_loss: 0.7016, val_error: 0.3000, auc: 0.9455
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.3375: correct 135/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.47058823529411764, correct 8/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0025, instance_loss: 0.0505, weighted_loss: 0.0169, label: 4, bag_size: 78
batch 39, loss: 0.0275, instance_loss: 0.1351, weighted_loss: 0.0598, label: 3, bag_size: 20
batch 59, loss: 0.0179, instance_loss: 0.0802, weighted_loss: 0.0366, label: 0, bag_size: 602
batch 79, loss: 0.2366, instance_loss: 0.4514, weighted_loss: 0.3011, label: 2, bag_size: 1197
batch 99, loss: 0.1296, instance_loss: 0.2719, weighted_loss: 0.1723, label: 2, bag_size: 323
batch 119, loss: 1.1978, instance_loss: 0.4779, weighted_loss: 0.9818, label: 2, bag_size: 411
batch 139, loss: 0.0290, instance_loss: 0.1148, weighted_loss: 0.0547, label: 1, bag_size: 534
batch 159, loss: 0.0838, instance_loss: 0.2395, weighted_loss: 0.1305, label: 2, bag_size: 907
batch 179, loss: 0.0162, instance_loss: 0.2495, weighted_loss: 0.0862, label: 4, bag_size: 19
batch 199, loss: 0.2041, instance_loss: 0.2996, weighted_loss: 0.2328, label: 0, bag_size: 570
batch 219, loss: 0.0019, instance_loss: 0.1127, weighted_loss: 0.0352, label: 3, bag_size: 48
batch 239, loss: 0.0245, instance_loss: 0.0829, weighted_loss: 0.0420, label: 1, bag_size: 1277
batch 259, loss: 0.0052, instance_loss: 0.1470, weighted_loss: 0.0478, label: 4, bag_size: 94
batch 279, loss: 0.2347, instance_loss: 0.2180, weighted_loss: 0.2297, label: 3, bag_size: 1019
batch 299, loss: 0.0024, instance_loss: 0.0366, weighted_loss: 0.0127, label: 4, bag_size: 104
batch 319, loss: 0.2776, instance_loss: 0.2704, weighted_loss: 0.2755, label: 0, bag_size: 1190
batch 339, loss: 0.0140, instance_loss: 0.0903, weighted_loss: 0.0369, label: 4, bag_size: 44
batch 359, loss: 0.0651, instance_loss: 0.1060, weighted_loss: 0.0774, label: 1, bag_size: 636
batch 379, loss: 0.0142, instance_loss: 0.1981, weighted_loss: 0.0694, label: 0, bag_size: 110
batch 399, loss: 0.0072, instance_loss: 0.1243, weighted_loss: 0.0423, label: 4, bag_size: 119
batch 419, loss: 0.1348, instance_loss: 0.6211, weighted_loss: 0.2807, label: 1, bag_size: 102
batch 439, loss: 0.1008, instance_loss: 0.1661, weighted_loss: 0.1204, label: 1, bag_size: 1426
batch 459, loss: 0.0436, instance_loss: 0.2078, weighted_loss: 0.0929, label: 2, bag_size: 317
batch 479, loss: 0.0066, instance_loss: 0.0589, weighted_loss: 0.0223, label: 3, bag_size: 32
batch 499, loss: 0.0260, instance_loss: 0.0511, weighted_loss: 0.0335, label: 1, bag_size: 286
batch 519, loss: 0.2052, instance_loss: 0.3828, weighted_loss: 0.2585, label: 4, bag_size: 590
batch 539, loss: 0.0512, instance_loss: 0.2165, weighted_loss: 0.1008, label: 0, bag_size: 367


class 0 clustering acc 0.9911009174311927: correct 21606/21800
class 1 clustering acc 0.481651376146789: correct 2100/4360
Epoch: 24, train_loss: 0.3225, train_clustering_loss:  0.2739, train_error: 0.1266
class 0: acc 0.925, correct 111/120
class 1: acc 0.8315789473684211, correct 79/95
class 2: acc 0.7592592592592593, correct 82/108
class 3: acc 0.9217391304347826, correct 106/115
class 4: acc 0.9158878504672897, correct 98/107

Val Set, val_loss: 0.8100, val_error: 0.3200, auc: 0.9428
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.305: correct 122/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1688, instance_loss: 0.3043, weighted_loss: 0.2094, label: 2, bag_size: 1215
batch 39, loss: 0.0267, instance_loss: 0.1108, weighted_loss: 0.0519, label: 4, bag_size: 40
batch 59, loss: 0.0221, instance_loss: 0.2503, weighted_loss: 0.0906, label: 4, bag_size: 19
batch 79, loss: 1.0609, instance_loss: 0.5117, weighted_loss: 0.8961, label: 1, bag_size: 875
batch 99, loss: 0.1760, instance_loss: 0.3423, weighted_loss: 0.2259, label: 1, bag_size: 868
batch 119, loss: 0.0048, instance_loss: 0.6531, weighted_loss: 0.1993, label: 4, bag_size: 436
batch 139, loss: 0.0013, instance_loss: 0.0508, weighted_loss: 0.0161, label: 4, bag_size: 55
batch 159, loss: 0.0212, instance_loss: 0.1662, weighted_loss: 0.0647, label: 3, bag_size: 24
batch 179, loss: 0.0018, instance_loss: 0.0614, weighted_loss: 0.0197, label: 4, bag_size: 764
batch 199, loss: 0.3435, instance_loss: 0.3434, weighted_loss: 0.3435, label: 2, bag_size: 1700
batch 219, loss: 0.0030, instance_loss: 0.0376, weighted_loss: 0.0134, label: 0, bag_size: 898
batch 239, loss: 0.0870, instance_loss: 0.1770, weighted_loss: 0.1140, label: 1, bag_size: 945
batch 259, loss: 1.6034, instance_loss: 0.2493, weighted_loss: 1.1971, label: 0, bag_size: 466
batch 279, loss: 0.1209, instance_loss: 0.1887, weighted_loss: 0.1412, label: 4, bag_size: 20
batch 299, loss: 0.9218, instance_loss: 0.4887, weighted_loss: 0.7919, label: 2, bag_size: 295
batch 319, loss: 0.0095, instance_loss: 0.2484, weighted_loss: 0.0812, label: 1, bag_size: 614
batch 339, loss: 0.0314, instance_loss: 0.1336, weighted_loss: 0.0621, label: 4, bag_size: 51
batch 359, loss: 0.0502, instance_loss: 0.0996, weighted_loss: 0.0650, label: 1, bag_size: 1426
batch 379, loss: 0.0268, instance_loss: 0.0580, weighted_loss: 0.0362, label: 1, bag_size: 1191
batch 399, loss: 0.2234, instance_loss: 0.5468, weighted_loss: 0.3204, label: 1, bag_size: 657
batch 419, loss: 0.1305, instance_loss: 0.2369, weighted_loss: 0.1624, label: 4, bag_size: 1121
batch 439, loss: 0.1295, instance_loss: 0.2800, weighted_loss: 0.1747, label: 1, bag_size: 648
batch 459, loss: 0.5287, instance_loss: 0.2886, weighted_loss: 0.4567, label: 2, bag_size: 1148
batch 479, loss: 0.2946, instance_loss: 0.6863, weighted_loss: 0.4121, label: 4, bag_size: 663
batch 499, loss: 0.2750, instance_loss: 0.3310, weighted_loss: 0.2918, label: 2, bag_size: 868
batch 519, loss: 0.0080, instance_loss: 0.1021, weighted_loss: 0.0362, label: 4, bag_size: 38
batch 539, loss: 0.1262, instance_loss: 0.2033, weighted_loss: 0.1493, label: 1, bag_size: 405


class 0 clustering acc 0.9893577981651376: correct 21568/21800
class 1 clustering acc 0.49839449541284403: correct 2173/4360
Epoch: 25, train_loss: 0.2447, train_clustering_loss:  0.2590, train_error: 0.0862
class 0: acc 0.9369369369369369, correct 104/111
class 1: acc 0.8807339449541285, correct 96/109
class 2: acc 0.839622641509434, correct 89/106
class 3: acc 0.9514563106796117, correct 98/103
class 4: acc 0.9568965517241379, correct 111/116

Val Set, val_loss: 0.7178, val_error: 0.2000, auc: 0.9322
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.38: correct 152/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0312, instance_loss: 0.4148, weighted_loss: 0.1463, label: 3, bag_size: 1253
batch 39, loss: 0.3726, instance_loss: 0.3313, weighted_loss: 0.3602, label: 3, bag_size: 1118
batch 59, loss: 0.0149, instance_loss: 0.0575, weighted_loss: 0.0277, label: 1, bag_size: 286
batch 79, loss: 0.4817, instance_loss: 0.3429, weighted_loss: 0.4400, label: 3, bag_size: 697
batch 99, loss: 0.0902, instance_loss: 0.2226, weighted_loss: 0.1299, label: 0, bag_size: 350
batch 119, loss: 0.0280, instance_loss: 0.1394, weighted_loss: 0.0614, label: 0, bag_size: 1517
batch 139, loss: 0.0399, instance_loss: 0.1168, weighted_loss: 0.0630, label: 1, bag_size: 790
batch 159, loss: 0.2437, instance_loss: 0.5694, weighted_loss: 0.3414, label: 1, bag_size: 936
batch 179, loss: 0.0075, instance_loss: 0.2775, weighted_loss: 0.0885, label: 3, bag_size: 936
batch 199, loss: 0.0276, instance_loss: 0.0568, weighted_loss: 0.0363, label: 3, bag_size: 1559
batch 219, loss: 0.0032, instance_loss: 0.0721, weighted_loss: 0.0239, label: 4, bag_size: 51
batch 239, loss: 0.1051, instance_loss: 0.1483, weighted_loss: 0.1181, label: 1, bag_size: 288
batch 259, loss: 0.2010, instance_loss: 0.2452, weighted_loss: 0.2142, label: 1, bag_size: 913
batch 279, loss: 0.0360, instance_loss: 0.4197, weighted_loss: 0.1511, label: 4, bag_size: 882
batch 299, loss: 0.0008, instance_loss: 0.0329, weighted_loss: 0.0104, label: 4, bag_size: 137
batch 319, loss: 0.2337, instance_loss: 0.2819, weighted_loss: 0.2482, label: 2, bag_size: 1047
batch 339, loss: 0.0031, instance_loss: 0.0417, weighted_loss: 0.0147, label: 0, bag_size: 1599
batch 359, loss: 0.0124, instance_loss: 0.1408, weighted_loss: 0.0509, label: 3, bag_size: 34
batch 379, loss: 0.0018, instance_loss: 0.3747, weighted_loss: 0.1137, label: 4, bag_size: 24
batch 399, loss: 0.3759, instance_loss: 0.2398, weighted_loss: 0.3351, label: 1, bag_size: 348
batch 419, loss: 1.9438, instance_loss: 0.8007, weighted_loss: 1.6009, label: 2, bag_size: 1043
batch 439, loss: 0.0063, instance_loss: 0.1712, weighted_loss: 0.0558, label: 4, bag_size: 1002
batch 459, loss: 0.1042, instance_loss: 0.4527, weighted_loss: 0.2088, label: 4, bag_size: 754
batch 479, loss: 0.4362, instance_loss: 0.2879, weighted_loss: 0.3917, label: 0, bag_size: 912
batch 499, loss: 1.2246, instance_loss: 0.5398, weighted_loss: 1.0192, label: 2, bag_size: 943
batch 519, loss: 0.0002, instance_loss: 0.1109, weighted_loss: 0.0334, label: 4, bag_size: 1002
batch 539, loss: 0.0221, instance_loss: 0.2004, weighted_loss: 0.0756, label: 0, bag_size: 731


class 0 clustering acc 0.9887155963302753: correct 21554/21800
class 1 clustering acc 0.5096330275229358: correct 2222/4360
Epoch: 26, train_loss: 0.2695, train_clustering_loss:  0.2645, train_error: 0.0881
class 0: acc 0.9487179487179487, correct 111/117
class 1: acc 0.8541666666666666, correct 82/96
class 2: acc 0.8490566037735849, correct 90/106
class 3: acc 0.9245283018867925, correct 98/106
class 4: acc 0.9666666666666667, correct 116/120

Val Set, val_loss: 0.8289, val_error: 0.2800, auc: 0.9396
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.3325: correct 133/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1284, instance_loss: 0.1766, weighted_loss: 0.1428, label: 1, bag_size: 944
batch 39, loss: 1.8607, instance_loss: 0.4946, weighted_loss: 1.4509, label: 2, bag_size: 684
batch 59, loss: 0.5585, instance_loss: 0.7190, weighted_loss: 0.6066, label: 1, bag_size: 657
batch 79, loss: 0.0080, instance_loss: 0.0615, weighted_loss: 0.0240, label: 3, bag_size: 43
batch 99, loss: 0.0054, instance_loss: 0.0899, weighted_loss: 0.0307, label: 3, bag_size: 20
batch 119, loss: 0.4975, instance_loss: 0.3213, weighted_loss: 0.4446, label: 1, bag_size: 913
batch 139, loss: 0.1141, instance_loss: 0.2702, weighted_loss: 0.1609, label: 2, bag_size: 1053
batch 159, loss: 0.0008, instance_loss: 0.0686, weighted_loss: 0.0211, label: 0, bag_size: 360
batch 179, loss: 0.0205, instance_loss: 0.1463, weighted_loss: 0.0582, label: 0, bag_size: 760
batch 199, loss: 0.0042, instance_loss: 0.0362, weighted_loss: 0.0138, label: 4, bag_size: 83
batch 219, loss: 0.9381, instance_loss: 0.5872, weighted_loss: 0.8329, label: 2, bag_size: 803
batch 239, loss: 0.0007, instance_loss: 0.1021, weighted_loss: 0.0311, label: 3, bag_size: 18
batch 259, loss: 1.0386, instance_loss: 0.5996, weighted_loss: 0.9069, label: 1, bag_size: 446
batch 279, loss: 0.1681, instance_loss: 0.2692, weighted_loss: 0.1984, label: 2, bag_size: 324
batch 299, loss: 0.0030, instance_loss: 0.0459, weighted_loss: 0.0158, label: 3, bag_size: 32
batch 319, loss: 0.9512, instance_loss: 0.6931, weighted_loss: 0.8738, label: 0, bag_size: 282
batch 339, loss: 0.0749, instance_loss: 0.2317, weighted_loss: 0.1220, label: 1, bag_size: 858
batch 359, loss: 0.3418, instance_loss: 0.3850, weighted_loss: 0.3547, label: 2, bag_size: 1006
batch 379, loss: 0.1324, instance_loss: 0.2215, weighted_loss: 0.1591, label: 0, bag_size: 466
batch 399, loss: 0.5384, instance_loss: 0.4891, weighted_loss: 0.5236, label: 2, bag_size: 323
batch 419, loss: 0.2735, instance_loss: 0.2491, weighted_loss: 0.2662, label: 0, bag_size: 1061
batch 439, loss: 0.0030, instance_loss: 0.0586, weighted_loss: 0.0197, label: 0, bag_size: 1101
batch 459, loss: 0.1629, instance_loss: 0.4072, weighted_loss: 0.2362, label: 3, bag_size: 936
batch 479, loss: 0.0007, instance_loss: 0.0602, weighted_loss: 0.0185, label: 3, bag_size: 50
batch 499, loss: 1.5103, instance_loss: 0.9454, weighted_loss: 1.3408, label: 4, bag_size: 210
batch 519, loss: 0.0025, instance_loss: 0.2176, weighted_loss: 0.0670, label: 3, bag_size: 16
batch 539, loss: 0.0015, instance_loss: 0.0602, weighted_loss: 0.0191, label: 4, bag_size: 790


class 0 clustering acc 0.9886238532110092: correct 21552/21800
class 1 clustering acc 0.49426605504587157: correct 2155/4360
Epoch: 27, train_loss: 0.2900, train_clustering_loss:  0.2749, train_error: 0.1083
class 0: acc 0.912621359223301, correct 94/103
class 1: acc 0.8378378378378378, correct 93/111
class 2: acc 0.8448275862068966, correct 98/116
class 3: acc 0.9583333333333334, correct 115/120
class 4: acc 0.9052631578947369, correct 86/95

Val Set, val_loss: 0.8317, val_error: 0.3000, auc: 0.9434
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.3575: correct 143/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.47058823529411764, correct 8/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0099, instance_loss: 0.1342, weighted_loss: 0.0471, label: 0, bag_size: 382
batch 39, loss: 0.0307, instance_loss: 0.0423, weighted_loss: 0.0342, label: 3, bag_size: 556
batch 59, loss: 0.0009, instance_loss: 0.1168, weighted_loss: 0.0357, label: 3, bag_size: 18
batch 79, loss: 0.0390, instance_loss: 0.5458, weighted_loss: 0.1911, label: 4, bag_size: 1474
batch 99, loss: 0.0083, instance_loss: 0.2009, weighted_loss: 0.0661, label: 0, bag_size: 122
batch 119, loss: 1.0370, instance_loss: 0.7865, weighted_loss: 0.9619, label: 1, bag_size: 875
batch 139, loss: 0.1183, instance_loss: 0.3959, weighted_loss: 0.2016, label: 0, bag_size: 114
batch 159, loss: 0.0022, instance_loss: 0.0711, weighted_loss: 0.0229, label: 1, bag_size: 1376
batch 179, loss: 0.0237, instance_loss: 0.1057, weighted_loss: 0.0483, label: 0, bag_size: 294
batch 199, loss: 0.0673, instance_loss: 0.2158, weighted_loss: 0.1118, label: 2, bag_size: 1448
batch 219, loss: 0.0079, instance_loss: 0.2508, weighted_loss: 0.0808, label: 0, bag_size: 163
batch 239, loss: 0.1037, instance_loss: 0.2302, weighted_loss: 0.1416, label: 2, bag_size: 1235
batch 259, loss: 0.0365, instance_loss: 0.4584, weighted_loss: 0.1631, label: 1, bag_size: 867
batch 279, loss: 0.0101, instance_loss: 0.0517, weighted_loss: 0.0226, label: 3, bag_size: 29
batch 299, loss: 0.2795, instance_loss: 0.3350, weighted_loss: 0.2961, label: 2, bag_size: 1006
batch 319, loss: 0.0540, instance_loss: 0.2990, weighted_loss: 0.1275, label: 3, bag_size: 230
batch 339, loss: 0.0615, instance_loss: 0.1964, weighted_loss: 0.1020, label: 0, bag_size: 759
batch 359, loss: 0.1370, instance_loss: 0.2705, weighted_loss: 0.1770, label: 2, bag_size: 839
batch 379, loss: 0.4899, instance_loss: 0.4098, weighted_loss: 0.4658, label: 0, bag_size: 1257
batch 399, loss: 0.0988, instance_loss: 0.1942, weighted_loss: 0.1274, label: 2, bag_size: 1123
batch 419, loss: 0.1377, instance_loss: 0.4036, weighted_loss: 0.2175, label: 1, bag_size: 648
batch 439, loss: 1.2414, instance_loss: 0.4911, weighted_loss: 1.0163, label: 1, bag_size: 139
batch 459, loss: 0.0531, instance_loss: 0.1578, weighted_loss: 0.0845, label: 1, bag_size: 1191
batch 479, loss: 0.1710, instance_loss: 0.3517, weighted_loss: 0.2252, label: 2, bag_size: 878
batch 499, loss: 0.0287, instance_loss: 0.1763, weighted_loss: 0.0730, label: 0, bag_size: 1517
batch 519, loss: 0.0905, instance_loss: 0.2315, weighted_loss: 0.1328, label: 2, bag_size: 1385
batch 539, loss: 3.0081, instance_loss: 0.7076, weighted_loss: 2.3179, label: 3, bag_size: 281


class 0 clustering acc 0.9873853211009175: correct 21525/21800
class 1 clustering acc 0.5176605504587156: correct 2257/4360
Epoch: 28, train_loss: 0.2616, train_clustering_loss:  0.2641, train_error: 0.1009
class 0: acc 0.9256198347107438, correct 112/121
class 1: acc 0.8395061728395061, correct 68/81
class 2: acc 0.8547008547008547, correct 100/117
class 3: acc 0.9074074074074074, correct 98/108
class 4: acc 0.9491525423728814, correct 112/118

Val Set, val_loss: 0.7868, val_error: 0.2800, auc: 0.9371
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.5422, instance_loss: 0.6936, weighted_loss: 0.5876, label: 4, bag_size: 366
batch 39, loss: 0.3623, instance_loss: 0.3453, weighted_loss: 0.3572, label: 2, bag_size: 204
batch 59, loss: 2.1698, instance_loss: 0.5806, weighted_loss: 1.6930, label: 2, bag_size: 732
batch 79, loss: 0.2268, instance_loss: 0.2685, weighted_loss: 0.2393, label: 1, bag_size: 442
batch 99, loss: 0.0885, instance_loss: 0.2056, weighted_loss: 0.1237, label: 1, bag_size: 1402
batch 119, loss: 0.0537, instance_loss: 0.2590, weighted_loss: 0.1153, label: 2, bag_size: 977
batch 139, loss: 0.6502, instance_loss: 0.3904, weighted_loss: 0.5723, label: 0, bag_size: 760
batch 159, loss: 0.0023, instance_loss: 0.1062, weighted_loss: 0.0335, label: 3, bag_size: 48
batch 179, loss: 0.0015, instance_loss: 0.1644, weighted_loss: 0.0504, label: 3, bag_size: 18
batch 199, loss: 0.7967, instance_loss: 0.6406, weighted_loss: 0.7499, label: 3, bag_size: 360
batch 219, loss: 0.0025, instance_loss: 0.0631, weighted_loss: 0.0207, label: 4, bag_size: 63
batch 239, loss: 0.2384, instance_loss: 0.3346, weighted_loss: 0.2673, label: 2, bag_size: 202
batch 259, loss: 0.0798, instance_loss: 0.4056, weighted_loss: 0.1775, label: 3, bag_size: 1380
batch 279, loss: 0.1022, instance_loss: 0.1608, weighted_loss: 0.1198, label: 2, bag_size: 480
batch 299, loss: 0.0032, instance_loss: 0.1029, weighted_loss: 0.0331, label: 3, bag_size: 20
batch 319, loss: 0.0121, instance_loss: 0.0458, weighted_loss: 0.0222, label: 4, bag_size: 110
batch 339, loss: 0.4623, instance_loss: 0.3375, weighted_loss: 0.4248, label: 2, bag_size: 1148
batch 359, loss: 0.0106, instance_loss: 0.2353, weighted_loss: 0.0780, label: 0, bag_size: 110
batch 379, loss: 0.0086, instance_loss: 0.0337, weighted_loss: 0.0161, label: 3, bag_size: 87
batch 399, loss: 0.0913, instance_loss: 0.3327, weighted_loss: 0.1637, label: 1, bag_size: 535
batch 419, loss: 0.0006, instance_loss: 0.0368, weighted_loss: 0.0114, label: 3, bag_size: 27
batch 439, loss: 0.0026, instance_loss: 0.1682, weighted_loss: 0.0523, label: 4, bag_size: 63
batch 459, loss: 0.0009, instance_loss: 0.0391, weighted_loss: 0.0124, label: 3, bag_size: 43
batch 479, loss: 0.0009, instance_loss: 0.0914, weighted_loss: 0.0281, label: 4, bag_size: 40
batch 499, loss: 0.0312, instance_loss: 0.4524, weighted_loss: 0.1576, label: 1, bag_size: 1255
batch 519, loss: 0.2340, instance_loss: 0.2984, weighted_loss: 0.2533, label: 2, bag_size: 264
batch 539, loss: 0.0785, instance_loss: 0.1725, weighted_loss: 0.1067, label: 2, bag_size: 1514


class 0 clustering acc 0.985137614678899: correct 21476/21800
class 1 clustering acc 0.501834862385321: correct 2188/4360
Epoch: 29, train_loss: 0.2837, train_clustering_loss:  0.2824, train_error: 0.0917
class 0: acc 0.9306930693069307, correct 94/101
class 1: acc 0.8556701030927835, correct 83/97
class 2: acc 0.8706896551724138, correct 101/116
class 3: acc 0.9196428571428571, correct 103/112
class 4: acc 0.957983193277311, correct 114/119

Val Set, val_loss: 0.8838, val_error: 0.3000, auc: 0.9446
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.335: correct 134/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0008, instance_loss: 0.0632, weighted_loss: 0.0195, label: 4, bag_size: 30
batch 39, loss: 0.1502, instance_loss: 0.1877, weighted_loss: 0.1614, label: 0, bag_size: 1190
batch 59, loss: 0.4481, instance_loss: 0.3940, weighted_loss: 0.4318, label: 0, bag_size: 432
batch 79, loss: 0.9303, instance_loss: 0.4257, weighted_loss: 0.7789, label: 2, bag_size: 295
batch 99, loss: 0.3276, instance_loss: 0.2956, weighted_loss: 0.3180, label: 1, bag_size: 913
batch 119, loss: 0.3227, instance_loss: 0.5212, weighted_loss: 0.3823, label: 1, bag_size: 860
batch 139, loss: 0.5339, instance_loss: 0.5087, weighted_loss: 0.5263, label: 1, bag_size: 861
batch 159, loss: 0.1505, instance_loss: 0.8139, weighted_loss: 0.3495, label: 3, bag_size: 211
batch 179, loss: 0.0501, instance_loss: 0.1028, weighted_loss: 0.0659, label: 1, bag_size: 690
batch 199, loss: 0.5539, instance_loss: 0.4105, weighted_loss: 0.5109, label: 1, bag_size: 377
batch 219, loss: 0.1327, instance_loss: 0.4681, weighted_loss: 0.2334, label: 1, bag_size: 651
batch 239, loss: 0.0320, instance_loss: 0.3756, weighted_loss: 0.1351, label: 2, bag_size: 626
batch 259, loss: 0.0076, instance_loss: 0.1156, weighted_loss: 0.0400, label: 3, bag_size: 78
batch 279, loss: 0.0207, instance_loss: 0.1060, weighted_loss: 0.0463, label: 0, bag_size: 1235
batch 299, loss: 0.3444, instance_loss: 0.3640, weighted_loss: 0.3503, label: 4, bag_size: 1278
batch 319, loss: 0.1523, instance_loss: 0.2191, weighted_loss: 0.1723, label: 2, bag_size: 324
batch 339, loss: 0.2625, instance_loss: 0.2234, weighted_loss: 0.2508, label: 1, bag_size: 838
batch 359, loss: 0.0062, instance_loss: 0.2529, weighted_loss: 0.0802, label: 3, bag_size: 21
batch 379, loss: 2.3090, instance_loss: 0.5776, weighted_loss: 1.7895, label: 1, bag_size: 448
batch 399, loss: 0.0451, instance_loss: 0.1713, weighted_loss: 0.0829, label: 0, bag_size: 1133
batch 419, loss: 0.0225, instance_loss: 0.1768, weighted_loss: 0.0688, label: 0, bag_size: 1046
batch 439, loss: 0.0137, instance_loss: 0.1475, weighted_loss: 0.0539, label: 0, bag_size: 1135
batch 459, loss: 0.0719, instance_loss: 0.1482, weighted_loss: 0.0948, label: 3, bag_size: 1399
batch 479, loss: 0.0005, instance_loss: 0.0505, weighted_loss: 0.0155, label: 0, bag_size: 898
batch 499, loss: 0.7200, instance_loss: 0.4535, weighted_loss: 0.6400, label: 2, bag_size: 324
batch 519, loss: 0.0616, instance_loss: 0.3514, weighted_loss: 0.1485, label: 0, bag_size: 118
batch 539, loss: 0.0004, instance_loss: 0.1186, weighted_loss: 0.0359, label: 4, bag_size: 40


class 0 clustering acc 0.9874770642201834: correct 21527/21800
class 1 clustering acc 0.4860091743119266: correct 2119/4360
Epoch: 30, train_loss: 0.2395, train_clustering_loss:  0.2766, train_error: 0.0826
class 0: acc 0.963963963963964, correct 107/111
class 1: acc 0.873015873015873, correct 110/126
class 2: acc 0.8494623655913979, correct 79/93
class 3: acc 0.9504950495049505, correct 96/101
class 4: acc 0.9473684210526315, correct 108/114

Val Set, val_loss: 0.8394, val_error: 0.3200, auc: 0.9273
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.0496, instance_loss: 0.3889, weighted_loss: 0.8514, label: 0, bag_size: 545
batch 39, loss: 0.2943, instance_loss: 0.3667, weighted_loss: 0.3160, label: 2, bag_size: 264
batch 59, loss: 0.0583, instance_loss: 0.3018, weighted_loss: 0.1313, label: 0, bag_size: 759
batch 79, loss: 0.0088, instance_loss: 0.4652, weighted_loss: 0.1457, label: 4, bag_size: 947
batch 99, loss: 0.0022, instance_loss: 0.0148, weighted_loss: 0.0060, label: 3, bag_size: 66
batch 119, loss: 0.2926, instance_loss: 0.2451, weighted_loss: 0.2783, label: 2, bag_size: 395
batch 139, loss: 0.0034, instance_loss: 0.3276, weighted_loss: 0.1007, label: 4, bag_size: 23
batch 159, loss: 0.1219, instance_loss: 0.5349, weighted_loss: 0.2458, label: 3, bag_size: 1250
batch 179, loss: 0.0956, instance_loss: 0.5026, weighted_loss: 0.2177, label: 1, bag_size: 102
batch 199, loss: 0.1251, instance_loss: 0.2011, weighted_loss: 0.1479, label: 2, bag_size: 265
batch 219, loss: 0.1900, instance_loss: 0.3615, weighted_loss: 0.2414, label: 2, bag_size: 470
batch 239, loss: 0.0003, instance_loss: 0.3962, weighted_loss: 0.1191, label: 4, bag_size: 14
batch 259, loss: 0.5239, instance_loss: 0.3618, weighted_loss: 0.4753, label: 1, bag_size: 139
batch 279, loss: 0.0008, instance_loss: 0.0479, weighted_loss: 0.0149, label: 3, bag_size: 37
batch 299, loss: 0.0266, instance_loss: 0.1570, weighted_loss: 0.0657, label: 2, bag_size: 701
batch 319, loss: 0.2104, instance_loss: 0.1329, weighted_loss: 0.1872, label: 0, bag_size: 340
batch 339, loss: 0.0029, instance_loss: 0.0993, weighted_loss: 0.0318, label: 4, bag_size: 40
batch 359, loss: 0.1076, instance_loss: 0.2330, weighted_loss: 0.1452, label: 2, bag_size: 1448
batch 379, loss: 0.5695, instance_loss: 0.3359, weighted_loss: 0.4994, label: 1, bag_size: 838
batch 399, loss: 0.0911, instance_loss: 0.4567, weighted_loss: 0.2008, label: 3, bag_size: 706
batch 419, loss: 0.3675, instance_loss: 0.6384, weighted_loss: 0.4488, label: 3, bag_size: 1250
batch 439, loss: 0.0001, instance_loss: 0.0784, weighted_loss: 0.0236, label: 4, bag_size: 137
batch 459, loss: 0.0043, instance_loss: 0.2993, weighted_loss: 0.0928, label: 1, bag_size: 614
batch 479, loss: 0.0007, instance_loss: 0.2895, weighted_loss: 0.0874, label: 4, bag_size: 24
batch 499, loss: 0.1162, instance_loss: 0.3955, weighted_loss: 0.2000, label: 2, bag_size: 1128
batch 519, loss: 0.0618, instance_loss: 0.5858, weighted_loss: 0.2190, label: 4, bag_size: 1474
batch 539, loss: 0.0144, instance_loss: 0.3101, weighted_loss: 0.1031, label: 3, bag_size: 1253


class 0 clustering acc 0.9875688073394495: correct 21529/21800
class 1 clustering acc 0.5027522935779817: correct 2192/4360
Epoch: 31, train_loss: 0.2352, train_clustering_loss:  0.2665, train_error: 0.0771
class 0: acc 0.9745762711864406, correct 115/118
class 1: acc 0.8787878787878788, correct 87/99
class 2: acc 0.8608695652173913, correct 99/115
class 3: acc 0.9519230769230769, correct 99/104
class 4: acc 0.944954128440367, correct 103/109

Val Set, val_loss: 0.9885, val_error: 0.3200, auc: 0.9348
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.365: correct 146/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.5294117647058824, correct 9/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0401, instance_loss: 0.2332, weighted_loss: 0.0980, label: 0, bag_size: 110
batch 39, loss: 0.4173, instance_loss: 0.5852, weighted_loss: 0.4677, label: 1, bag_size: 917
batch 59, loss: 0.0052, instance_loss: 0.1036, weighted_loss: 0.0347, label: 3, bag_size: 28
batch 79, loss: 0.0390, instance_loss: 0.0739, weighted_loss: 0.0495, label: 1, bag_size: 356
batch 99, loss: 0.0029, instance_loss: 0.4193, weighted_loss: 0.1278, label: 4, bag_size: 711
batch 119, loss: 0.9398, instance_loss: 0.6586, weighted_loss: 0.8554, label: 4, bag_size: 210
batch 139, loss: 0.0448, instance_loss: 0.3303, weighted_loss: 0.1305, label: 1, bag_size: 530
batch 159, loss: 2.1244, instance_loss: 0.9569, weighted_loss: 1.7742, label: 2, bag_size: 1043
batch 179, loss: 0.0024, instance_loss: 0.1158, weighted_loss: 0.0364, label: 4, bag_size: 790
batch 199, loss: 0.1022, instance_loss: 0.2084, weighted_loss: 0.1340, label: 2, bag_size: 265
batch 219, loss: 0.0002, instance_loss: 0.0676, weighted_loss: 0.0204, label: 4, bag_size: 174
batch 239, loss: 0.0846, instance_loss: 0.5650, weighted_loss: 0.2287, label: 1, bag_size: 657
batch 259, loss: 0.0429, instance_loss: 0.1620, weighted_loss: 0.0786, label: 2, bag_size: 1019
batch 279, loss: 0.0463, instance_loss: 0.2342, weighted_loss: 0.1026, label: 4, bag_size: 297
batch 299, loss: 0.0007, instance_loss: 0.0760, weighted_loss: 0.0233, label: 4, bag_size: 211
batch 319, loss: 0.0018, instance_loss: 0.0507, weighted_loss: 0.0165, label: 3, bag_size: 72
batch 339, loss: 0.0006, instance_loss: 0.2644, weighted_loss: 0.0798, label: 4, bag_size: 24
batch 359, loss: 0.0020, instance_loss: 0.1175, weighted_loss: 0.0366, label: 0, bag_size: 122
batch 379, loss: 0.4436, instance_loss: 0.4041, weighted_loss: 0.4318, label: 2, bag_size: 384
batch 399, loss: 0.0128, instance_loss: 0.1453, weighted_loss: 0.0525, label: 1, bag_size: 442
batch 419, loss: 0.0786, instance_loss: 0.2549, weighted_loss: 0.1315, label: 2, bag_size: 766
batch 439, loss: 0.0108, instance_loss: 0.1353, weighted_loss: 0.0481, label: 3, bag_size: 34
batch 459, loss: 0.1481, instance_loss: 0.1122, weighted_loss: 0.1373, label: 3, bag_size: 405
batch 479, loss: 0.0007, instance_loss: 0.0198, weighted_loss: 0.0064, label: 0, bag_size: 898
batch 499, loss: 0.0329, instance_loss: 0.1666, weighted_loss: 0.0730, label: 0, bag_size: 1012
batch 519, loss: 0.6307, instance_loss: 0.3722, weighted_loss: 0.5532, label: 1, bag_size: 897
batch 539, loss: 0.0717, instance_loss: 0.1342, weighted_loss: 0.0905, label: 0, bag_size: 294


class 0 clustering acc 0.9877522935779817: correct 21533/21800
class 1 clustering acc 0.528211009174312: correct 2303/4360
Epoch: 32, train_loss: 0.2565, train_clustering_loss:  0.2645, train_error: 0.0899
class 0: acc 0.963963963963964, correct 107/111
class 1: acc 0.896551724137931, correct 104/116
class 2: acc 0.8064516129032258, correct 75/93
class 3: acc 0.9310344827586207, correct 108/116
class 4: acc 0.9357798165137615, correct 102/109

Val Set, val_loss: 0.7406, val_error: 0.2600, auc: 0.9443
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.3825: correct 153/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1183, instance_loss: 0.2821, weighted_loss: 0.1674, label: 0, bag_size: 545
batch 39, loss: 0.0032, instance_loss: 0.0338, weighted_loss: 0.0124, label: 0, bag_size: 402
batch 59, loss: 0.3727, instance_loss: 0.3337, weighted_loss: 0.3610, label: 1, bag_size: 343
batch 79, loss: 0.0273, instance_loss: 0.1589, weighted_loss: 0.0668, label: 0, bag_size: 350
batch 99, loss: 0.0010, instance_loss: 0.0442, weighted_loss: 0.0140, label: 4, bag_size: 162
batch 119, loss: 0.4126, instance_loss: 0.4517, weighted_loss: 0.4244, label: 1, bag_size: 435
batch 139, loss: 0.0869, instance_loss: 0.4730, weighted_loss: 0.2028, label: 1, bag_size: 936
batch 159, loss: 0.7859, instance_loss: 0.5632, weighted_loss: 0.7191, label: 2, bag_size: 295
batch 179, loss: 0.0374, instance_loss: 0.1254, weighted_loss: 0.0638, label: 1, bag_size: 636
batch 199, loss: 0.0569, instance_loss: 0.1998, weighted_loss: 0.0997, label: 2, bag_size: 1039
batch 219, loss: 0.3493, instance_loss: 0.4419, weighted_loss: 0.3771, label: 0, bag_size: 1289
batch 239, loss: 0.7671, instance_loss: 0.8309, weighted_loss: 0.7863, label: 1, bag_size: 660
batch 259, loss: 0.8187, instance_loss: 0.6793, weighted_loss: 0.7769, label: 2, bag_size: 1400
batch 279, loss: 0.0372, instance_loss: 0.1908, weighted_loss: 0.0833, label: 2, bag_size: 1215
batch 299, loss: 0.0457, instance_loss: 0.0828, weighted_loss: 0.0568, label: 1, bag_size: 320
batch 319, loss: 0.0015, instance_loss: 0.0609, weighted_loss: 0.0194, label: 4, bag_size: 48
batch 339, loss: 0.0139, instance_loss: 0.2159, weighted_loss: 0.0745, label: 4, bag_size: 388
batch 359, loss: 0.0003, instance_loss: 0.0337, weighted_loss: 0.0103, label: 4, bag_size: 167
batch 379, loss: 0.0214, instance_loss: 0.2159, weighted_loss: 0.0798, label: 0, bag_size: 116
batch 399, loss: 0.0021, instance_loss: 0.2067, weighted_loss: 0.0635, label: 3, bag_size: 18
batch 419, loss: 0.0041, instance_loss: 0.1881, weighted_loss: 0.0593, label: 1, bag_size: 1127
batch 439, loss: 0.0022, instance_loss: 0.0395, weighted_loss: 0.0134, label: 4, bag_size: 107
batch 459, loss: 0.0816, instance_loss: 0.3005, weighted_loss: 0.1473, label: 1, bag_size: 648
batch 479, loss: 0.0006, instance_loss: 0.0280, weighted_loss: 0.0088, label: 4, bag_size: 174
batch 499, loss: 0.3462, instance_loss: 0.4014, weighted_loss: 0.3628, label: 2, bag_size: 1378
batch 519, loss: 0.1086, instance_loss: 0.1036, weighted_loss: 0.1071, label: 0, bag_size: 1527
batch 539, loss: 0.0831, instance_loss: 0.0533, weighted_loss: 0.0742, label: 4, bag_size: 43


class 0 clustering acc 0.9871559633027523: correct 21520/21800
class 1 clustering acc 0.5119266055045871: correct 2232/4360
Epoch: 33, train_loss: 0.2336, train_clustering_loss:  0.2674, train_error: 0.0642
class 0: acc 0.9099099099099099, correct 101/111
class 1: acc 0.9215686274509803, correct 94/102
class 2: acc 0.8952380952380953, correct 94/105
class 3: acc 0.9807692307692307, correct 102/104
class 4: acc 0.967479674796748, correct 119/123

Val Set, val_loss: 0.7860, val_error: 0.2600, auc: 0.9450
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.36: correct 144/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0035, instance_loss: 0.0387, weighted_loss: 0.0141, label: 4, bag_size: 114
batch 39, loss: 0.0013, instance_loss: 0.0192, weighted_loss: 0.0066, label: 4, bag_size: 39
batch 59, loss: 0.0358, instance_loss: 0.0976, weighted_loss: 0.0543, label: 0, bag_size: 367
batch 79, loss: 0.0251, instance_loss: 0.1729, weighted_loss: 0.0694, label: 2, bag_size: 1281
batch 99, loss: 0.0305, instance_loss: 0.1335, weighted_loss: 0.0614, label: 0, bag_size: 200
batch 119, loss: 0.4933, instance_loss: 0.4685, weighted_loss: 0.4859, label: 2, bag_size: 1400
batch 139, loss: 0.0023, instance_loss: 0.0297, weighted_loss: 0.0106, label: 4, bag_size: 72
batch 159, loss: 0.0098, instance_loss: 0.0902, weighted_loss: 0.0339, label: 3, bag_size: 18
batch 179, loss: 1.5263, instance_loss: 0.5579, weighted_loss: 1.2358, label: 3, bag_size: 305
batch 199, loss: 0.0003, instance_loss: 0.0193, weighted_loss: 0.0060, label: 3, bag_size: 43
batch 219, loss: 0.0016, instance_loss: 0.0308, weighted_loss: 0.0104, label: 3, bag_size: 143
batch 239, loss: 1.5929, instance_loss: 0.7743, weighted_loss: 1.3473, label: 2, bag_size: 803
batch 259, loss: 0.0008, instance_loss: 0.0537, weighted_loss: 0.0167, label: 3, bag_size: 28
batch 279, loss: 1.7833, instance_loss: 0.6941, weighted_loss: 1.4565, label: 1, bag_size: 448
batch 299, loss: 0.0969, instance_loss: 0.2263, weighted_loss: 0.1357, label: 0, bag_size: 962
batch 319, loss: 0.5557, instance_loss: 0.3479, weighted_loss: 0.4933, label: 0, bag_size: 912
batch 339, loss: 0.0416, instance_loss: 0.2317, weighted_loss: 0.0987, label: 0, bag_size: 350
batch 359, loss: 1.1006, instance_loss: 0.4560, weighted_loss: 0.9072, label: 2, bag_size: 758
batch 379, loss: 0.1516, instance_loss: 0.6116, weighted_loss: 0.2896, label: 1, bag_size: 657
batch 399, loss: 0.0000, instance_loss: 0.0245, weighted_loss: 0.0074, label: 4, bag_size: 174
batch 419, loss: 0.0274, instance_loss: 0.1645, weighted_loss: 0.0685, label: 2, bag_size: 399
batch 439, loss: 0.2742, instance_loss: 0.2658, weighted_loss: 0.2717, label: 2, bag_size: 499
batch 459, loss: 0.5709, instance_loss: 0.7650, weighted_loss: 0.6291, label: 4, bag_size: 210
batch 479, loss: 0.1669, instance_loss: 0.3288, weighted_loss: 0.2154, label: 0, bag_size: 1034
batch 499, loss: 0.0030, instance_loss: 0.1034, weighted_loss: 0.0331, label: 4, bag_size: 128
batch 519, loss: 0.0010, instance_loss: 0.1655, weighted_loss: 0.0503, label: 3, bag_size: 16
batch 539, loss: 0.0006, instance_loss: 0.0489, weighted_loss: 0.0151, label: 3, bag_size: 28


class 0 clustering acc 0.9882568807339449: correct 21544/21800
class 1 clustering acc 0.5518348623853211: correct 2406/4360
Epoch: 34, train_loss: 0.1762, train_clustering_loss:  0.2495, train_error: 0.0550
class 0: acc 0.9826086956521739, correct 113/115
class 1: acc 0.9107142857142857, correct 102/112
class 2: acc 0.9042553191489362, correct 85/94
class 3: acc 0.9423076923076923, correct 98/104
class 4: acc 0.975, correct 117/120

Val Set, val_loss: 0.8389, val_error: 0.2400, auc: 0.9356
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.385: correct 154/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0531, instance_loss: 0.1836, weighted_loss: 0.0922, label: 2, bag_size: 878
batch 39, loss: 0.0207, instance_loss: 0.1475, weighted_loss: 0.0587, label: 2, bag_size: 701
batch 59, loss: 0.0059, instance_loss: 0.3427, weighted_loss: 0.1070, label: 0, bag_size: 128
batch 79, loss: 0.0229, instance_loss: 0.1368, weighted_loss: 0.0570, label: 3, bag_size: 15
batch 99, loss: 0.0095, instance_loss: 0.0901, weighted_loss: 0.0337, label: 0, bag_size: 1235
batch 119, loss: 0.0006, instance_loss: 0.0262, weighted_loss: 0.0083, label: 3, bag_size: 56
batch 139, loss: 0.0669, instance_loss: 0.2752, weighted_loss: 0.1294, label: 2, bag_size: 730
batch 159, loss: 0.2258, instance_loss: 0.4644, weighted_loss: 0.2974, label: 1, bag_size: 1096
batch 179, loss: 0.3611, instance_loss: 0.3592, weighted_loss: 0.3605, label: 2, bag_size: 687
batch 199, loss: 0.0549, instance_loss: 0.3239, weighted_loss: 0.1356, label: 2, bag_size: 222
batch 219, loss: 0.0036, instance_loss: 0.0973, weighted_loss: 0.0317, label: 4, bag_size: 211
batch 239, loss: 0.0496, instance_loss: 0.1279, weighted_loss: 0.0731, label: 1, bag_size: 790
batch 259, loss: 0.0590, instance_loss: 0.2759, weighted_loss: 0.1241, label: 1, bag_size: 1014
batch 279, loss: 0.0195, instance_loss: 0.0875, weighted_loss: 0.0399, label: 1, bag_size: 790
batch 299, loss: 0.0706, instance_loss: 0.1931, weighted_loss: 0.1074, label: 0, bag_size: 542
batch 319, loss: 0.0006, instance_loss: 0.0567, weighted_loss: 0.0174, label: 3, bag_size: 94
batch 339, loss: 0.0415, instance_loss: 0.1490, weighted_loss: 0.0737, label: 2, bag_size: 470
batch 359, loss: 0.0016, instance_loss: 0.2318, weighted_loss: 0.0706, label: 4, bag_size: 20
batch 379, loss: 0.0106, instance_loss: 0.0400, weighted_loss: 0.0195, label: 3, bag_size: 20
batch 399, loss: 0.0315, instance_loss: 0.3280, weighted_loss: 0.1205, label: 1, bag_size: 535
batch 419, loss: 0.0278, instance_loss: 0.3643, weighted_loss: 0.1287, label: 0, bag_size: 118
batch 439, loss: 0.0004, instance_loss: 0.2718, weighted_loss: 0.0818, label: 4, bag_size: 20
batch 459, loss: 0.3511, instance_loss: 0.2380, weighted_loss: 0.3172, label: 3, bag_size: 841
batch 479, loss: 0.1959, instance_loss: 0.2085, weighted_loss: 0.1997, label: 3, bag_size: 841
batch 499, loss: 0.2167, instance_loss: 0.3128, weighted_loss: 0.2455, label: 2, bag_size: 1218
batch 519, loss: 0.3862, instance_loss: 0.8387, weighted_loss: 0.5220, label: 4, bag_size: 210
batch 539, loss: 0.0701, instance_loss: 0.2373, weighted_loss: 0.1203, label: 2, bag_size: 1385


class 0 clustering acc 0.9887155963302753: correct 21554/21800
class 1 clustering acc 0.5144495412844037: correct 2243/4360
Epoch: 35, train_loss: 0.2092, train_clustering_loss:  0.2608, train_error: 0.0587
class 0: acc 0.9875, correct 79/80
class 1: acc 0.8771929824561403, correct 100/114
class 2: acc 0.9104477611940298, correct 122/134
class 3: acc 0.9739130434782609, correct 112/115
class 4: acc 0.9803921568627451, correct 100/102

Val Set, val_loss: 0.8347, val_error: 0.2800, auc: 0.9326
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.3625: correct 145/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0057, instance_loss: 0.1063, weighted_loss: 0.0359, label: 0, bag_size: 602
batch 39, loss: 0.0775, instance_loss: 0.3093, weighted_loss: 0.1470, label: 1, bag_size: 1559
batch 59, loss: 0.0028, instance_loss: 0.0973, weighted_loss: 0.0311, label: 4, bag_size: 83
batch 79, loss: 0.0050, instance_loss: 0.1586, weighted_loss: 0.0511, label: 0, bag_size: 1046
batch 99, loss: 0.0156, instance_loss: 0.0804, weighted_loss: 0.0351, label: 0, bag_size: 602
batch 119, loss: 0.1412, instance_loss: 0.2543, weighted_loss: 0.1751, label: 0, bag_size: 117
batch 139, loss: 0.0012, instance_loss: 0.0328, weighted_loss: 0.0107, label: 0, bag_size: 1872
batch 159, loss: 0.0129, instance_loss: 0.1694, weighted_loss: 0.0599, label: 0, bag_size: 120
batch 179, loss: 0.0000, instance_loss: 0.2164, weighted_loss: 0.0649, label: 4, bag_size: 1002
batch 199, loss: 0.0089, instance_loss: 0.0259, weighted_loss: 0.0140, label: 3, bag_size: 54
batch 219, loss: 0.0039, instance_loss: 0.0968, weighted_loss: 0.0318, label: 0, bag_size: 1046
batch 239, loss: 0.0100, instance_loss: 0.5231, weighted_loss: 0.1640, label: 1, bag_size: 700
batch 259, loss: 0.0039, instance_loss: 0.2687, weighted_loss: 0.0834, label: 3, bag_size: 18
batch 279, loss: 0.0026, instance_loss: 0.0675, weighted_loss: 0.0220, label: 0, bag_size: 552
batch 299, loss: 0.0059, instance_loss: 0.3202, weighted_loss: 0.1002, label: 3, bag_size: 16
batch 319, loss: 0.0952, instance_loss: 0.2695, weighted_loss: 0.1475, label: 4, bag_size: 625
batch 339, loss: 0.0933, instance_loss: 0.1688, weighted_loss: 0.1159, label: 2, bag_size: 846
batch 359, loss: 1.5487, instance_loss: 0.6355, weighted_loss: 1.2748, label: 1, bag_size: 448
batch 379, loss: 0.0144, instance_loss: 0.3796, weighted_loss: 0.1239, label: 4, bag_size: 928
batch 399, loss: 0.0014, instance_loss: 0.0362, weighted_loss: 0.0118, label: 0, bag_size: 518
batch 419, loss: 0.0373, instance_loss: 0.1599, weighted_loss: 0.0741, label: 3, bag_size: 35
batch 439, loss: 0.0869, instance_loss: 0.2818, weighted_loss: 0.1454, label: 2, bag_size: 809
batch 459, loss: 0.0060, instance_loss: 0.1886, weighted_loss: 0.0607, label: 0, bag_size: 1135
batch 479, loss: 0.0725, instance_loss: 0.1722, weighted_loss: 0.1024, label: 2, bag_size: 461
batch 499, loss: 0.1657, instance_loss: 0.4056, weighted_loss: 0.2377, label: 0, bag_size: 432
batch 519, loss: 0.0789, instance_loss: 0.1251, weighted_loss: 0.0927, label: 1, bag_size: 1325
batch 539, loss: 0.2722, instance_loss: 0.3377, weighted_loss: 0.2919, label: 2, bag_size: 204


class 0 clustering acc 0.9865596330275229: correct 21507/21800
class 1 clustering acc 0.5337155963302752: correct 2327/4360
Epoch: 36, train_loss: 0.1857, train_clustering_loss:  0.2556, train_error: 0.0661
class 0: acc 0.9732142857142857, correct 109/112
class 1: acc 0.8727272727272727, correct 96/110
class 2: acc 0.8909090909090909, correct 98/110
class 3: acc 0.946236559139785, correct 88/93
class 4: acc 0.9833333333333333, correct 118/120

Val Set, val_loss: 0.7274, val_error: 0.2400, auc: 0.9399
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.435: correct 174/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.75, correct 3/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0084, instance_loss: 0.0496, weighted_loss: 0.0207, label: 4, bag_size: 119
batch 39, loss: 0.0000, instance_loss: 0.0156, weighted_loss: 0.0047, label: 4, bag_size: 167
batch 59, loss: 0.0473, instance_loss: 0.1690, weighted_loss: 0.0838, label: 0, bag_size: 1527
batch 79, loss: 0.0106, instance_loss: 0.1815, weighted_loss: 0.0618, label: 1, bag_size: 1127
batch 99, loss: 0.0225, instance_loss: 0.0953, weighted_loss: 0.0444, label: 2, bag_size: 1019
batch 119, loss: 0.1109, instance_loss: 0.1617, weighted_loss: 0.1261, label: 1, bag_size: 994
batch 139, loss: 1.0321, instance_loss: 0.8779, weighted_loss: 0.9859, label: 4, bag_size: 210
batch 159, loss: 0.0026, instance_loss: 0.0308, weighted_loss: 0.0110, label: 0, bag_size: 360
batch 179, loss: 0.0204, instance_loss: 0.1628, weighted_loss: 0.0631, label: 2, bag_size: 910
batch 199, loss: 0.0017, instance_loss: 0.1018, weighted_loss: 0.0317, label: 4, bag_size: 211
batch 219, loss: 0.0005, instance_loss: 0.0919, weighted_loss: 0.0279, label: 3, bag_size: 26
batch 239, loss: 0.0560, instance_loss: 0.1302, weighted_loss: 0.0783, label: 0, bag_size: 1872
batch 259, loss: 0.0019, instance_loss: 0.1487, weighted_loss: 0.0459, label: 4, bag_size: 1176
batch 279, loss: 0.0756, instance_loss: 0.2175, weighted_loss: 0.1182, label: 1, bag_size: 869
batch 299, loss: 0.1055, instance_loss: 0.0970, weighted_loss: 0.1029, label: 3, bag_size: 1172
batch 319, loss: 0.0584, instance_loss: 0.0985, weighted_loss: 0.0704, label: 0, bag_size: 446
batch 339, loss: 0.0059, instance_loss: 0.0493, weighted_loss: 0.0190, label: 0, bag_size: 653
batch 359, loss: 0.0870, instance_loss: 0.2582, weighted_loss: 0.1383, label: 2, bag_size: 345
batch 379, loss: 0.4374, instance_loss: 0.4624, weighted_loss: 0.4449, label: 2, bag_size: 324
batch 399, loss: 0.0515, instance_loss: 0.4539, weighted_loss: 0.1722, label: 3, bag_size: 230
batch 419, loss: 0.2350, instance_loss: 0.4504, weighted_loss: 0.2996, label: 3, bag_size: 230
batch 439, loss: 0.0475, instance_loss: 0.0952, weighted_loss: 0.0618, label: 1, bag_size: 288
batch 459, loss: 0.0160, instance_loss: 0.1062, weighted_loss: 0.0430, label: 2, bag_size: 1019
batch 479, loss: 0.0224, instance_loss: 0.6408, weighted_loss: 0.2080, label: 4, bag_size: 675
batch 499, loss: 1.4533, instance_loss: 0.5689, weighted_loss: 1.1880, label: 1, bag_size: 386
batch 519, loss: 0.0006, instance_loss: 0.0161, weighted_loss: 0.0052, label: 4, bag_size: 174
batch 539, loss: 0.2448, instance_loss: 0.6503, weighted_loss: 0.3665, label: 3, bag_size: 671


class 0 clustering acc 0.9867431192660551: correct 21511/21800
class 1 clustering acc 0.561697247706422: correct 2449/4360
Epoch: 37, train_loss: 0.1810, train_clustering_loss:  0.2474, train_error: 0.0642
class 0: acc 0.9421487603305785, correct 114/121
class 1: acc 0.9479166666666666, correct 91/96
class 2: acc 0.8596491228070176, correct 98/114
class 3: acc 0.9519230769230769, correct 99/104
class 4: acc 0.9818181818181818, correct 108/110

Val Set, val_loss: 0.8412, val_error: 0.2600, auc: 0.9364
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.3825: correct 153/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0033, instance_loss: 0.0321, weighted_loss: 0.0120, label: 4, bag_size: 39
batch 39, loss: 0.0017, instance_loss: 0.0845, weighted_loss: 0.0266, label: 3, bag_size: 123
batch 59, loss: 0.0177, instance_loss: 0.1077, weighted_loss: 0.0447, label: 0, bag_size: 1012
batch 79, loss: 0.1157, instance_loss: 0.3224, weighted_loss: 0.1777, label: 2, bag_size: 806
batch 99, loss: 0.0070, instance_loss: 0.0897, weighted_loss: 0.0318, label: 0, bag_size: 476
batch 119, loss: 0.0940, instance_loss: 0.3626, weighted_loss: 0.1745, label: 4, bag_size: 947
batch 139, loss: 0.0204, instance_loss: 0.4219, weighted_loss: 0.1408, label: 2, bag_size: 784
batch 159, loss: 0.0000, instance_loss: 0.1212, weighted_loss: 0.0364, label: 3, bag_size: 31
batch 179, loss: 0.0563, instance_loss: 0.3005, weighted_loss: 0.1296, label: 0, bag_size: 1190
batch 199, loss: 0.1434, instance_loss: 0.4450, weighted_loss: 0.2339, label: 1, bag_size: 1096
batch 219, loss: 0.1662, instance_loss: 0.2542, weighted_loss: 0.1926, label: 1, bag_size: 913
batch 239, loss: 0.0135, instance_loss: 0.3035, weighted_loss: 0.1005, label: 3, bag_size: 343
batch 259, loss: 0.0002, instance_loss: 0.0102, weighted_loss: 0.0032, label: 4, bag_size: 157
batch 279, loss: 0.0135, instance_loss: 0.0491, weighted_loss: 0.0241, label: 4, bag_size: 39
batch 299, loss: 0.0038, instance_loss: 0.0391, weighted_loss: 0.0144, label: 0, bag_size: 1872
batch 319, loss: 0.0975, instance_loss: 0.2274, weighted_loss: 0.1364, label: 2, bag_size: 1050
batch 339, loss: 0.0023, instance_loss: 0.0422, weighted_loss: 0.0143, label: 3, bag_size: 23
batch 359, loss: 0.5544, instance_loss: 0.5826, weighted_loss: 0.5628, label: 2, bag_size: 803
batch 379, loss: 0.0715, instance_loss: 0.3586, weighted_loss: 0.1576, label: 2, bag_size: 638
batch 399, loss: 0.0020, instance_loss: 0.0489, weighted_loss: 0.0161, label: 4, bag_size: 24
batch 419, loss: 0.3589, instance_loss: 0.7276, weighted_loss: 0.4695, label: 2, bag_size: 679
batch 439, loss: 1.4960, instance_loss: 0.4856, weighted_loss: 1.1929, label: 2, bag_size: 883
batch 459, loss: 0.0119, instance_loss: 0.2717, weighted_loss: 0.0898, label: 1, bag_size: 442
batch 479, loss: 0.0048, instance_loss: 0.1280, weighted_loss: 0.0417, label: 3, bag_size: 28
batch 499, loss: 0.0499, instance_loss: 0.2118, weighted_loss: 0.0985, label: 0, bag_size: 1034
batch 519, loss: 0.1478, instance_loss: 0.6078, weighted_loss: 0.2858, label: 3, bag_size: 283
batch 539, loss: 0.3055, instance_loss: 0.7081, weighted_loss: 0.4263, label: 1, bag_size: 861


class 0 clustering acc 0.9864678899082568: correct 21505/21800
class 1 clustering acc 0.5747706422018348: correct 2506/4360
Epoch: 38, train_loss: 0.1474, train_clustering_loss:  0.2432, train_error: 0.0422
class 0: acc 0.9823008849557522, correct 111/113
class 1: acc 0.9230769230769231, correct 108/117
class 2: acc 0.92, correct 92/100
class 3: acc 0.9611650485436893, correct 99/103
class 4: acc 1.0, correct 112/112

Val Set, val_loss: 0.9724, val_error: 0.2800, auc: 0.9322
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.335: correct 134/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0245, instance_loss: 0.2657, weighted_loss: 0.0969, label: 4, bag_size: 19
batch 39, loss: 0.0090, instance_loss: 0.1759, weighted_loss: 0.0591, label: 1, bag_size: 858
batch 59, loss: 0.0007, instance_loss: 0.5951, weighted_loss: 0.1790, label: 0, bag_size: 116
batch 79, loss: 0.2468, instance_loss: 0.4295, weighted_loss: 0.3016, label: 1, bag_size: 139
batch 99, loss: 0.0004, instance_loss: 0.0970, weighted_loss: 0.0294, label: 4, bag_size: 790
batch 119, loss: 0.2400, instance_loss: 0.2703, weighted_loss: 0.2491, label: 1, bag_size: 898
batch 139, loss: 0.0575, instance_loss: 0.3944, weighted_loss: 0.1585, label: 2, bag_size: 373
batch 159, loss: 0.5983, instance_loss: 0.5305, weighted_loss: 0.5780, label: 2, bag_size: 629
batch 179, loss: 0.0500, instance_loss: 0.1654, weighted_loss: 0.0847, label: 2, bag_size: 809
batch 199, loss: 0.8368, instance_loss: 0.3253, weighted_loss: 0.6833, label: 2, bag_size: 511
batch 219, loss: 0.0983, instance_loss: 0.2486, weighted_loss: 0.1434, label: 1, bag_size: 1144
batch 239, loss: 0.0272, instance_loss: 0.3424, weighted_loss: 0.1217, label: 2, bag_size: 600
batch 259, loss: 0.0228, instance_loss: 0.1408, weighted_loss: 0.0582, label: 2, bag_size: 317
batch 279, loss: 0.0006, instance_loss: 0.1085, weighted_loss: 0.0330, label: 3, bag_size: 26
batch 299, loss: 0.0028, instance_loss: 0.0684, weighted_loss: 0.0225, label: 0, bag_size: 552
batch 319, loss: 0.0694, instance_loss: 0.3676, weighted_loss: 0.1588, label: 2, bag_size: 278
batch 339, loss: 0.0766, instance_loss: 0.3148, weighted_loss: 0.1481, label: 2, bag_size: 461
batch 359, loss: 0.0314, instance_loss: 0.1289, weighted_loss: 0.0607, label: 1, bag_size: 682
batch 379, loss: 0.0992, instance_loss: 0.6383, weighted_loss: 0.2609, label: 2, bag_size: 679
batch 399, loss: 0.0018, instance_loss: 0.0353, weighted_loss: 0.0118, label: 3, bag_size: 33
batch 419, loss: 0.0024, instance_loss: 0.1143, weighted_loss: 0.0360, label: 4, bag_size: 646
batch 439, loss: 3.2912, instance_loss: 1.0843, weighted_loss: 2.6291, label: 2, bag_size: 1108
batch 459, loss: 0.4075, instance_loss: 0.5050, weighted_loss: 0.4367, label: 2, bag_size: 629
batch 479, loss: 0.0036, instance_loss: 0.2327, weighted_loss: 0.0723, label: 3, bag_size: 24
batch 499, loss: 0.0176, instance_loss: 0.1311, weighted_loss: 0.0517, label: 0, bag_size: 1235
batch 519, loss: 0.0450, instance_loss: 0.2523, weighted_loss: 0.1072, label: 2, bag_size: 262
batch 539, loss: 0.1282, instance_loss: 0.4159, weighted_loss: 0.2145, label: 1, bag_size: 102


class 0 clustering acc 0.9862844036697248: correct 21501/21800
class 1 clustering acc 0.5587155963302752: correct 2436/4360
Epoch: 39, train_loss: 0.1496, train_clustering_loss:  0.2550, train_error: 0.0440
class 0: acc 0.9906542056074766, correct 106/107
class 1: acc 0.9761904761904762, correct 123/126
class 2: acc 0.8879310344827587, correct 103/116
class 3: acc 0.9655172413793104, correct 84/87
class 4: acc 0.963302752293578, correct 105/109

Val Set, val_loss: 0.7462, val_error: 0.2400, auc: 0.9426
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.4125: correct 165/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0467, instance_loss: 0.3425, weighted_loss: 0.1355, label: 0, bag_size: 118
batch 39, loss: 0.0000, instance_loss: 0.0148, weighted_loss: 0.0045, label: 4, bag_size: 143
batch 59, loss: 0.0008, instance_loss: 0.0124, weighted_loss: 0.0043, label: 4, bag_size: 182
batch 79, loss: 0.0427, instance_loss: 0.3834, weighted_loss: 0.1449, label: 2, bag_size: 222
batch 99, loss: 0.1615, instance_loss: 0.2791, weighted_loss: 0.1968, label: 1, bag_size: 1559
batch 119, loss: 0.0013, instance_loss: 0.0555, weighted_loss: 0.0175, label: 3, bag_size: 31
batch 139, loss: 0.0694, instance_loss: 0.1722, weighted_loss: 0.1002, label: 1, bag_size: 1144
batch 159, loss: 0.0972, instance_loss: 0.1753, weighted_loss: 0.1206, label: 3, bag_size: 1019
batch 179, loss: 0.1240, instance_loss: 0.3906, weighted_loss: 0.2040, label: 2, bag_size: 766
batch 199, loss: 0.0018, instance_loss: 0.0923, weighted_loss: 0.0290, label: 3, bag_size: 18
batch 219, loss: 0.0030, instance_loss: 0.0760, weighted_loss: 0.0249, label: 0, bag_size: 607
batch 239, loss: 0.1577, instance_loss: 0.4335, weighted_loss: 0.2404, label: 2, bag_size: 766
batch 259, loss: 0.0002, instance_loss: 0.0197, weighted_loss: 0.0061, label: 4, bag_size: 182
batch 279, loss: 0.3256, instance_loss: 0.2363, weighted_loss: 0.2988, label: 0, bag_size: 807
batch 299, loss: 0.6376, instance_loss: 0.3237, weighted_loss: 0.5434, label: 1, bag_size: 913
batch 319, loss: 0.0013, instance_loss: 0.0869, weighted_loss: 0.0270, label: 0, bag_size: 1135
batch 339, loss: 0.6588, instance_loss: 0.4342, weighted_loss: 0.5914, label: 2, bag_size: 295
batch 359, loss: 0.0008, instance_loss: 0.0308, weighted_loss: 0.0098, label: 3, bag_size: 32
batch 379, loss: 0.0072, instance_loss: 0.1720, weighted_loss: 0.0566, label: 1, bag_size: 1127
batch 399, loss: 0.0009, instance_loss: 0.1962, weighted_loss: 0.0595, label: 3, bag_size: 16
batch 419, loss: 0.0003, instance_loss: 0.0178, weighted_loss: 0.0056, label: 3, bag_size: 143
batch 439, loss: 0.0001, instance_loss: 0.0326, weighted_loss: 0.0098, label: 4, bag_size: 55
batch 459, loss: 1.0561, instance_loss: 0.4322, weighted_loss: 0.8689, label: 0, bag_size: 1527
batch 479, loss: 0.0154, instance_loss: 0.0729, weighted_loss: 0.0327, label: 1, bag_size: 346
batch 499, loss: 0.0063, instance_loss: 0.5230, weighted_loss: 0.1613, label: 4, bag_size: 14
batch 519, loss: 0.0226, instance_loss: 0.1850, weighted_loss: 0.0713, label: 0, bag_size: 478
batch 539, loss: 0.0713, instance_loss: 0.5782, weighted_loss: 0.2234, label: 3, bag_size: 1167


class 0 clustering acc 0.9875229357798165: correct 21528/21800
class 1 clustering acc 0.5444954128440367: correct 2374/4360
Epoch: 40, train_loss: 0.1787, train_clustering_loss:  0.2570, train_error: 0.0532
class 0: acc 0.9741379310344828, correct 113/116
class 1: acc 0.9532710280373832, correct 102/107
class 2: acc 0.8695652173913043, correct 80/92
class 3: acc 0.9649122807017544, correct 110/114
class 4: acc 0.9568965517241379, correct 111/116

Val Set, val_loss: 0.9179, val_error: 0.3600, auc: 0.9453
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.3675: correct 147/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.35294117647058826, correct 6/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.6879, instance_loss: 0.3344, weighted_loss: 0.5819, label: 4, bag_size: 388
batch 39, loss: 0.0063, instance_loss: 0.2378, weighted_loss: 0.0757, label: 1, bag_size: 474
batch 59, loss: 0.0037, instance_loss: 0.0789, weighted_loss: 0.0263, label: 4, bag_size: 60
batch 79, loss: 0.6582, instance_loss: 0.4740, weighted_loss: 0.6030, label: 2, bag_size: 511
batch 99, loss: 0.0007, instance_loss: 0.0382, weighted_loss: 0.0120, label: 4, bag_size: 178
batch 119, loss: 0.0002, instance_loss: 0.0433, weighted_loss: 0.0131, label: 4, bag_size: 211
batch 139, loss: 0.0110, instance_loss: 0.1048, weighted_loss: 0.0391, label: 1, bag_size: 356
batch 159, loss: 0.0129, instance_loss: 0.1504, weighted_loss: 0.0542, label: 2, bag_size: 419
batch 179, loss: 0.0086, instance_loss: 0.1486, weighted_loss: 0.0506, label: 2, bag_size: 248
batch 199, loss: 0.0013, instance_loss: 0.2090, weighted_loss: 0.0636, label: 4, bag_size: 128
batch 219, loss: 0.0005, instance_loss: 0.0186, weighted_loss: 0.0060, label: 0, bag_size: 360
batch 239, loss: 0.0010, instance_loss: 0.0450, weighted_loss: 0.0142, label: 4, bag_size: 60
batch 259, loss: 0.0023, instance_loss: 0.1460, weighted_loss: 0.0454, label: 4, bag_size: 1278
batch 279, loss: 0.0005, instance_loss: 0.0497, weighted_loss: 0.0153, label: 4, bag_size: 137
batch 299, loss: 0.0007, instance_loss: 0.0501, weighted_loss: 0.0155, label: 4, bag_size: 47
batch 319, loss: 0.0264, instance_loss: 0.1736, weighted_loss: 0.0706, label: 2, bag_size: 1242
batch 339, loss: 0.0453, instance_loss: 0.2784, weighted_loss: 0.1153, label: 2, bag_size: 1141
batch 359, loss: 0.0586, instance_loss: 0.4000, weighted_loss: 0.1610, label: 1, bag_size: 786
batch 379, loss: 0.0376, instance_loss: 0.1596, weighted_loss: 0.0742, label: 1, bag_size: 898
batch 399, loss: 0.0011, instance_loss: 0.0156, weighted_loss: 0.0055, label: 3, bag_size: 97
batch 419, loss: 0.0751, instance_loss: 0.4466, weighted_loss: 0.1866, label: 1, bag_size: 786
batch 439, loss: 0.2371, instance_loss: 0.6444, weighted_loss: 0.3593, label: 3, bag_size: 281
batch 459, loss: 0.0037, instance_loss: 0.0512, weighted_loss: 0.0180, label: 1, bag_size: 286
batch 479, loss: 0.0204, instance_loss: 0.2323, weighted_loss: 0.0839, label: 4, bag_size: 19
batch 499, loss: 0.0132, instance_loss: 0.0449, weighted_loss: 0.0227, label: 4, bag_size: 96
batch 519, loss: 0.0395, instance_loss: 0.1979, weighted_loss: 0.0870, label: 2, bag_size: 2703
batch 539, loss: 0.4924, instance_loss: 0.3588, weighted_loss: 0.4523, label: 0, bag_size: 912


class 0 clustering acc 0.9884403669724771: correct 21548/21800
class 1 clustering acc 0.569954128440367: correct 2485/4360
Epoch: 41, train_loss: 0.1584, train_clustering_loss:  0.2424, train_error: 0.0514
class 0: acc 0.9782608695652174, correct 90/92
class 1: acc 0.9310344827586207, correct 108/116
class 2: acc 0.8608695652173913, correct 99/115
class 3: acc 0.9819819819819819, correct 109/111
class 4: acc 1.0, correct 111/111

Val Set, val_loss: 0.7440, val_error: 0.1800, auc: 0.9430
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.4: correct 160/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0251, instance_loss: 0.1703, weighted_loss: 0.0687, label: 3, bag_size: 18
batch 39, loss: 0.0172, instance_loss: 0.2414, weighted_loss: 0.0845, label: 2, bag_size: 2826
batch 59, loss: 0.1204, instance_loss: 0.2937, weighted_loss: 0.1724, label: 2, bag_size: 730
batch 79, loss: 0.0382, instance_loss: 0.2877, weighted_loss: 0.1130, label: 2, bag_size: 1047
batch 99, loss: 0.0543, instance_loss: 0.3505, weighted_loss: 0.1431, label: 4, bag_size: 542
batch 119, loss: 0.0015, instance_loss: 0.0880, weighted_loss: 0.0274, label: 1, bag_size: 834
batch 139, loss: 0.0410, instance_loss: 0.1226, weighted_loss: 0.0655, label: 1, bag_size: 346
batch 159, loss: 0.3191, instance_loss: 0.4649, weighted_loss: 0.3629, label: 1, bag_size: 386
batch 179, loss: 0.2674, instance_loss: 0.4009, weighted_loss: 0.3075, label: 0, bag_size: 1061
batch 199, loss: 0.0159, instance_loss: 0.0563, weighted_loss: 0.0280, label: 3, bag_size: 451
batch 219, loss: 0.9624, instance_loss: 0.6380, weighted_loss: 0.8651, label: 2, bag_size: 720
batch 239, loss: 1.0494, instance_loss: 0.7094, weighted_loss: 0.9474, label: 2, bag_size: 1043
batch 259, loss: 0.0287, instance_loss: 0.1558, weighted_loss: 0.0668, label: 2, bag_size: 314
batch 279, loss: 0.1363, instance_loss: 0.3404, weighted_loss: 0.1975, label: 0, bag_size: 1061
batch 299, loss: 0.9618, instance_loss: 0.6903, weighted_loss: 0.8804, label: 3, bag_size: 1167
batch 319, loss: 0.0001, instance_loss: 0.2923, weighted_loss: 0.0878, label: 3, bag_size: 16
batch 339, loss: 0.1707, instance_loss: 0.5213, weighted_loss: 0.2758, label: 4, bag_size: 663
batch 359, loss: 0.0000, instance_loss: 0.0267, weighted_loss: 0.0080, label: 0, bag_size: 976
batch 379, loss: 0.6430, instance_loss: 0.2805, weighted_loss: 0.5342, label: 1, bag_size: 348
batch 399, loss: 0.0288, instance_loss: 0.5858, weighted_loss: 0.1959, label: 1, bag_size: 651
batch 419, loss: 0.4155, instance_loss: 0.4576, weighted_loss: 0.4281, label: 1, bag_size: 377
batch 439, loss: 0.0701, instance_loss: 0.2512, weighted_loss: 0.1244, label: 2, bag_size: 264
batch 459, loss: 0.0018, instance_loss: 0.1103, weighted_loss: 0.0344, label: 0, bag_size: 155
batch 479, loss: 0.0005, instance_loss: 0.0340, weighted_loss: 0.0106, label: 3, bag_size: 143
batch 499, loss: 0.0427, instance_loss: 0.1918, weighted_loss: 0.0875, label: 3, bag_size: 1019
batch 519, loss: 0.0065, instance_loss: 0.3677, weighted_loss: 0.1148, label: 0, bag_size: 163
batch 539, loss: 0.9747, instance_loss: 0.4875, weighted_loss: 0.8285, label: 4, bag_size: 947


class 0 clustering acc 0.9885321100917431: correct 21550/21800
class 1 clustering acc 0.573394495412844: correct 2500/4360
Epoch: 42, train_loss: 0.1380, train_clustering_loss:  0.2417, train_error: 0.0495
class 0: acc 0.9736842105263158, correct 111/114
class 1: acc 0.9444444444444444, correct 102/108
class 2: acc 0.918918918918919, correct 102/111
class 3: acc 0.9714285714285714, correct 102/105
class 4: acc 0.9439252336448598, correct 101/107

Val Set, val_loss: 0.9920, val_error: 0.2800, auc: 0.9320
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.3625: correct 145/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0102, instance_loss: 0.0665, weighted_loss: 0.0271, label: 3, bag_size: 305
batch 39, loss: 0.0009, instance_loss: 0.3094, weighted_loss: 0.0935, label: 1, bag_size: 614
batch 59, loss: 0.2379, instance_loss: 0.4624, weighted_loss: 0.3053, label: 2, bag_size: 1043
batch 79, loss: 0.0160, instance_loss: 0.0913, weighted_loss: 0.0386, label: 1, bag_size: 1191
batch 99, loss: 0.8626, instance_loss: 0.1436, weighted_loss: 0.6469, label: 1, bag_size: 320
batch 119, loss: 0.0018, instance_loss: 0.0566, weighted_loss: 0.0182, label: 0, bag_size: 371
batch 139, loss: 0.0021, instance_loss: 0.0240, weighted_loss: 0.0086, label: 4, bag_size: 178
batch 159, loss: 0.4665, instance_loss: 0.5996, weighted_loss: 0.5064, label: 3, bag_size: 607
batch 179, loss: 0.0552, instance_loss: 0.2088, weighted_loss: 0.1013, label: 2, bag_size: 265
batch 199, loss: 0.1765, instance_loss: 0.3712, weighted_loss: 0.2349, label: 2, bag_size: 355
batch 219, loss: 0.0351, instance_loss: 0.2382, weighted_loss: 0.0960, label: 0, bag_size: 1579
batch 239, loss: 2.5719, instance_loss: 0.7017, weighted_loss: 2.0109, label: 1, bag_size: 435
batch 259, loss: 0.0064, instance_loss: 0.3633, weighted_loss: 0.1135, label: 0, bag_size: 122
batch 279, loss: 0.0541, instance_loss: 0.3025, weighted_loss: 0.1287, label: 4, bag_size: 542
batch 299, loss: 0.0045, instance_loss: 0.3875, weighted_loss: 0.1194, label: 1, bag_size: 614
batch 319, loss: 0.0081, instance_loss: 0.0872, weighted_loss: 0.0318, label: 2, bag_size: 614
batch 339, loss: 0.0075, instance_loss: 0.3000, weighted_loss: 0.0953, label: 0, bag_size: 117
batch 359, loss: 0.0124, instance_loss: 0.0732, weighted_loss: 0.0306, label: 1, bag_size: 994
batch 379, loss: 0.0011, instance_loss: 0.0963, weighted_loss: 0.0297, label: 3, bag_size: 18
batch 399, loss: 0.0466, instance_loss: 0.2778, weighted_loss: 0.1159, label: 0, bag_size: 607
batch 419, loss: 0.0005, instance_loss: 0.0645, weighted_loss: 0.0197, label: 1, bag_size: 1277
batch 439, loss: 0.0042, instance_loss: 0.0871, weighted_loss: 0.0291, label: 0, bag_size: 1174
batch 459, loss: 0.0011, instance_loss: 0.1199, weighted_loss: 0.0367, label: 0, bag_size: 524
batch 479, loss: 0.0625, instance_loss: 0.1517, weighted_loss: 0.0893, label: 3, bag_size: 1172
batch 499, loss: 0.0010, instance_loss: 0.0637, weighted_loss: 0.0198, label: 0, bag_size: 1599
batch 519, loss: 0.0001, instance_loss: 0.0524, weighted_loss: 0.0158, label: 4, bag_size: 137
batch 539, loss: 0.0010, instance_loss: 0.0870, weighted_loss: 0.0268, label: 4, bag_size: 162


class 0 clustering acc 0.9857339449541285: correct 21489/21800
class 1 clustering acc 0.5626146788990826: correct 2453/4360
Epoch: 43, train_loss: 0.1401, train_clustering_loss:  0.2573, train_error: 0.0459
class 0: acc 0.979381443298969, correct 95/97
class 1: acc 0.9278350515463918, correct 90/97
class 2: acc 0.907563025210084, correct 108/119
class 3: acc 0.9831932773109243, correct 117/119
class 4: acc 0.9734513274336283, correct 110/113

Val Set, val_loss: 0.8664, val_error: 0.2600, auc: 0.9306
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.4125: correct 165/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0026, instance_loss: 0.0174, weighted_loss: 0.0071, label: 3, bag_size: 29
batch 39, loss: 0.0001, instance_loss: 0.0706, weighted_loss: 0.0213, label: 3, bag_size: 28
batch 59, loss: 0.0002, instance_loss: 0.0268, weighted_loss: 0.0082, label: 4, bag_size: 150
batch 79, loss: 0.0090, instance_loss: 0.2611, weighted_loss: 0.0846, label: 0, bag_size: 136
batch 99, loss: 0.0002, instance_loss: 0.0194, weighted_loss: 0.0060, label: 0, bag_size: 1599
batch 119, loss: 0.0002, instance_loss: 0.0585, weighted_loss: 0.0177, label: 4, bag_size: 60
batch 139, loss: 1.3061, instance_loss: 0.6353, weighted_loss: 1.1049, label: 1, bag_size: 293
batch 159, loss: 0.0288, instance_loss: 0.2585, weighted_loss: 0.0977, label: 2, bag_size: 252
batch 179, loss: 0.6263, instance_loss: 0.7967, weighted_loss: 0.6774, label: 3, bag_size: 281
batch 199, loss: 0.0271, instance_loss: 0.4486, weighted_loss: 0.1536, label: 2, bag_size: 878
batch 219, loss: 0.0095, instance_loss: 0.3413, weighted_loss: 0.1091, label: 4, bag_size: 928
batch 239, loss: 0.1005, instance_loss: 0.3628, weighted_loss: 0.1792, label: 3, bag_size: 230
batch 259, loss: 0.0007, instance_loss: 0.0417, weighted_loss: 0.0130, label: 3, bag_size: 78
batch 279, loss: 0.0131, instance_loss: 0.2649, weighted_loss: 0.0886, label: 2, bag_size: 245
batch 299, loss: 0.1423, instance_loss: 0.5472, weighted_loss: 0.2638, label: 4, bag_size: 1331
batch 319, loss: 0.0005, instance_loss: 0.0283, weighted_loss: 0.0089, label: 0, bag_size: 402
batch 339, loss: 0.2389, instance_loss: 0.3822, weighted_loss: 0.2819, label: 2, bag_size: 1235
batch 359, loss: 0.0017, instance_loss: 0.1395, weighted_loss: 0.0431, label: 0, bag_size: 110
batch 379, loss: 0.0003, instance_loss: 0.1272, weighted_loss: 0.0384, label: 1, bag_size: 1376
batch 399, loss: 0.0155, instance_loss: 0.4225, weighted_loss: 0.1376, label: 4, bag_size: 928
batch 419, loss: 0.0001, instance_loss: 0.0180, weighted_loss: 0.0054, label: 4, bag_size: 185
batch 439, loss: 0.0013, instance_loss: 0.0985, weighted_loss: 0.0305, label: 4, bag_size: 47
batch 459, loss: 0.0016, instance_loss: 0.1502, weighted_loss: 0.0462, label: 1, bag_size: 696
batch 479, loss: 0.1182, instance_loss: 0.5458, weighted_loss: 0.2465, label: 4, bag_size: 663
batch 499, loss: 0.2363, instance_loss: 0.7698, weighted_loss: 0.3964, label: 2, bag_size: 732
batch 519, loss: 0.0106, instance_loss: 0.1727, weighted_loss: 0.0592, label: 3, bag_size: 316
batch 539, loss: 0.0253, instance_loss: 0.1797, weighted_loss: 0.0717, label: 0, bag_size: 340


class 0 clustering acc 0.9874311926605505: correct 21526/21800
class 1 clustering acc 0.580045871559633: correct 2529/4360
Epoch: 44, train_loss: 0.1163, train_clustering_loss:  0.2447, train_error: 0.0349
class 0: acc 0.9763779527559056, correct 124/127
class 1: acc 0.9433962264150944, correct 100/106
class 2: acc 0.9207920792079208, correct 93/101
class 3: acc 0.98989898989899, correct 98/99
class 4: acc 0.9910714285714286, correct 111/112

Val Set, val_loss: 0.7285, val_error: 0.2800, auc: 0.9414
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.4025: correct 161/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0008, instance_loss: 0.0405, weighted_loss: 0.0127, label: 1, bag_size: 847
batch 39, loss: 0.0008, instance_loss: 0.2020, weighted_loss: 0.0612, label: 0, bag_size: 239
batch 59, loss: 0.1764, instance_loss: 0.3709, weighted_loss: 0.2347, label: 2, bag_size: 795
batch 79, loss: 0.0213, instance_loss: 0.2045, weighted_loss: 0.0762, label: 0, bag_size: 155
batch 99, loss: 1.9439, instance_loss: 0.7476, weighted_loss: 1.5850, label: 2, bag_size: 194
batch 119, loss: 0.0003, instance_loss: 0.0440, weighted_loss: 0.0134, label: 4, bag_size: 91
batch 139, loss: 1.2313, instance_loss: 0.2223, weighted_loss: 0.9286, label: 4, bag_size: 1002
batch 159, loss: 0.0890, instance_loss: 0.5957, weighted_loss: 0.2410, label: 2, bag_size: 356
batch 179, loss: 0.0360, instance_loss: 0.3655, weighted_loss: 0.1348, label: 2, bag_size: 471
batch 199, loss: 0.0174, instance_loss: 0.1839, weighted_loss: 0.0673, label: 0, bag_size: 294
batch 219, loss: 2.5580, instance_loss: 0.7892, weighted_loss: 2.0274, label: 2, bag_size: 777
batch 239, loss: 0.0580, instance_loss: 0.2512, weighted_loss: 0.1160, label: 0, bag_size: 1255
batch 259, loss: 0.0002, instance_loss: 0.1127, weighted_loss: 0.0339, label: 3, bag_size: 18
batch 279, loss: 0.0006, instance_loss: 0.0570, weighted_loss: 0.0175, label: 4, bag_size: 160
batch 299, loss: 0.0001, instance_loss: 0.0591, weighted_loss: 0.0178, label: 3, bag_size: 33
batch 319, loss: 0.0002, instance_loss: 0.0116, weighted_loss: 0.0036, label: 4, bag_size: 130
batch 339, loss: 0.0537, instance_loss: 0.8037, weighted_loss: 0.2787, label: 3, bag_size: 211
batch 359, loss: 0.1618, instance_loss: 0.2823, weighted_loss: 0.1980, label: 1, bag_size: 343
batch 379, loss: 0.0486, instance_loss: 0.2764, weighted_loss: 0.1170, label: 2, bag_size: 1164
batch 399, loss: 0.0477, instance_loss: 0.2739, weighted_loss: 0.1156, label: 0, bag_size: 472
batch 419, loss: 0.1603, instance_loss: 0.2644, weighted_loss: 0.1915, label: 1, bag_size: 1014
batch 439, loss: 0.1854, instance_loss: 0.2077, weighted_loss: 0.1921, label: 1, bag_size: 898
batch 459, loss: 0.0058, instance_loss: 0.0295, weighted_loss: 0.0129, label: 1, bag_size: 1277
batch 479, loss: 0.0012, instance_loss: 0.0251, weighted_loss: 0.0084, label: 4, bag_size: 182
batch 499, loss: 0.0264, instance_loss: 0.1971, weighted_loss: 0.0776, label: 3, bag_size: 343
batch 519, loss: 0.1055, instance_loss: 0.3272, weighted_loss: 0.1720, label: 0, bag_size: 718
batch 539, loss: 0.0184, instance_loss: 0.2663, weighted_loss: 0.0928, label: 3, bag_size: 17


class 0 clustering acc 0.9882110091743119: correct 21543/21800
class 1 clustering acc 0.5555045871559633: correct 2422/4360
Epoch: 45, train_loss: 0.1492, train_clustering_loss:  0.2477, train_error: 0.0404
class 0: acc 0.9727272727272728, correct 107/110
class 1: acc 0.9560439560439561, correct 87/91
class 2: acc 0.900990099009901, correct 91/101
class 3: acc 0.9818181818181818, correct 108/110
class 4: acc 0.9774436090225563, correct 130/133

Val Set, val_loss: 0.8382, val_error: 0.2600, auc: 0.9464
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.3725: correct 149/400
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0469, instance_loss: 0.2682, weighted_loss: 0.1133, label: 2, bag_size: 701
batch 39, loss: 0.4247, instance_loss: 0.3486, weighted_loss: 0.4018, label: 1, bag_size: 343
batch 59, loss: 0.0635, instance_loss: 0.2617, weighted_loss: 0.1230, label: 2, bag_size: 1242
batch 79, loss: 0.0049, instance_loss: 0.1612, weighted_loss: 0.0518, label: 3, bag_size: 18
batch 99, loss: 0.0001, instance_loss: 0.0535, weighted_loss: 0.0161, label: 4, bag_size: 114
batch 119, loss: 0.0358, instance_loss: 0.2374, weighted_loss: 0.0963, label: 2, bag_size: 655
batch 139, loss: 0.0048, instance_loss: 0.3732, weighted_loss: 0.1153, label: 1, bag_size: 867
batch 159, loss: 0.1910, instance_loss: 0.7819, weighted_loss: 0.3683, label: 3, bag_size: 283
batch 179, loss: 0.0658, instance_loss: 0.3488, weighted_loss: 0.1507, label: 0, bag_size: 718
batch 199, loss: 0.0000, instance_loss: 0.0773, weighted_loss: 0.0232, label: 4, bag_size: 130
batch 219, loss: 0.0047, instance_loss: 0.2215, weighted_loss: 0.0698, label: 0, bag_size: 120
batch 239, loss: 0.0312, instance_loss: 0.2686, weighted_loss: 0.1024, label: 2, bag_size: 1700
batch 259, loss: 0.0464, instance_loss: 0.1137, weighted_loss: 0.0666, label: 1, bag_size: 1191
batch 279, loss: 0.1020, instance_loss: 0.3882, weighted_loss: 0.1879, label: 2, bag_size: 687
batch 299, loss: 0.0178, instance_loss: 0.2155, weighted_loss: 0.0771, label: 0, bag_size: 114
batch 319, loss: 0.0226, instance_loss: 0.2336, weighted_loss: 0.0859, label: 2, bag_size: 741
batch 339, loss: 0.2871, instance_loss: 0.6155, weighted_loss: 0.3856, label: 4, bag_size: 663
batch 359, loss: 0.0088, instance_loss: 0.0629, weighted_loss: 0.0250, label: 3, bag_size: 18
batch 379, loss: 0.0001, instance_loss: 0.0246, weighted_loss: 0.0074, label: 4, bag_size: 150
batch 399, loss: 0.0205, instance_loss: 0.1560, weighted_loss: 0.0612, label: 0, bag_size: 518
batch 419, loss: 0.0740, instance_loss: 0.3180, weighted_loss: 0.1472, label: 2, bag_size: 324
batch 439, loss: 0.0201, instance_loss: 0.2825, weighted_loss: 0.0989, label: 0, bag_size: 155
batch 459, loss: 0.0695, instance_loss: 0.4838, weighted_loss: 0.1937, label: 1, bag_size: 1390
batch 479, loss: 0.0830, instance_loss: 0.1847, weighted_loss: 0.1135, label: 0, bag_size: 912
batch 499, loss: 0.0001, instance_loss: 0.0700, weighted_loss: 0.0211, label: 4, bag_size: 157
batch 519, loss: 0.1727, instance_loss: 0.4754, weighted_loss: 0.2635, label: 1, bag_size: 446
batch 539, loss: 0.0073, instance_loss: 0.1562, weighted_loss: 0.0520, label: 0, bag_size: 117


class 0 clustering acc 0.9883944954128441: correct 21547/21800
class 1 clustering acc 0.5527522935779816: correct 2410/4360
Epoch: 46, train_loss: 0.1263, train_clustering_loss:  0.2500, train_error: 0.0330
class 0: acc 0.984, correct 123/125
class 1: acc 0.9523809523809523, correct 100/105
class 2: acc 0.9426229508196722, correct 115/122
class 3: acc 0.9895833333333334, correct 95/96
class 4: acc 0.9690721649484536, correct 94/97

Val Set, val_loss: 0.8743, val_error: 0.2800, auc: 0.9368
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.4375: correct 175/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0425, instance_loss: 0.2325, weighted_loss: 0.0995, label: 0, bag_size: 1190
batch 39, loss: 0.0041, instance_loss: 0.1093, weighted_loss: 0.0357, label: 4, bag_size: 524
batch 59, loss: 0.0045, instance_loss: 0.1057, weighted_loss: 0.0349, label: 2, bag_size: 1155
batch 79, loss: 0.0042, instance_loss: 0.0501, weighted_loss: 0.0180, label: 3, bag_size: 305
batch 99, loss: 0.3504, instance_loss: 0.7189, weighted_loss: 0.4610, label: 1, bag_size: 1172
batch 119, loss: 0.1902, instance_loss: 0.4953, weighted_loss: 0.2817, label: 2, bag_size: 1416
batch 139, loss: 0.1393, instance_loss: 0.8261, weighted_loss: 0.3454, label: 4, bag_size: 210
batch 159, loss: 0.1294, instance_loss: 0.4595, weighted_loss: 0.2285, label: 1, bag_size: 651
batch 179, loss: 0.0941, instance_loss: 0.5925, weighted_loss: 0.2436, label: 1, bag_size: 875
batch 199, loss: 0.0040, instance_loss: 0.3719, weighted_loss: 0.1144, label: 1, bag_size: 1646
batch 219, loss: 0.1254, instance_loss: 0.2149, weighted_loss: 0.1523, label: 2, bag_size: 314
batch 239, loss: 0.0094, instance_loss: 0.3297, weighted_loss: 0.1055, label: 1, bag_size: 1559
batch 259, loss: 0.0010, instance_loss: 0.1037, weighted_loss: 0.0318, label: 3, bag_size: 15
batch 279, loss: 0.0896, instance_loss: 0.8140, weighted_loss: 0.3069, label: 4, bag_size: 210
batch 299, loss: 0.0006, instance_loss: 0.0201, weighted_loss: 0.0065, label: 4, bag_size: 123
batch 319, loss: 1.0659, instance_loss: 0.6521, weighted_loss: 0.9417, label: 1, bag_size: 1799
batch 339, loss: 0.0216, instance_loss: 0.1002, weighted_loss: 0.0452, label: 1, bag_size: 534
batch 359, loss: 0.1019, instance_loss: 0.5123, weighted_loss: 0.2250, label: 3, bag_size: 230
batch 379, loss: 0.0094, instance_loss: 0.1488, weighted_loss: 0.0512, label: 1, bag_size: 949
batch 399, loss: 0.0536, instance_loss: 0.2551, weighted_loss: 0.1140, label: 3, bag_size: 849
batch 419, loss: 0.0002, instance_loss: 0.3151, weighted_loss: 0.0947, label: 4, bag_size: 17
batch 439, loss: 0.0415, instance_loss: 0.7318, weighted_loss: 0.2486, label: 1, bag_size: 1390
batch 459, loss: 0.0015, instance_loss: 0.0808, weighted_loss: 0.0253, label: 0, bag_size: 239
batch 479, loss: 0.0129, instance_loss: 0.1969, weighted_loss: 0.0681, label: 2, bag_size: 408
batch 499, loss: 0.1587, instance_loss: 0.2366, weighted_loss: 0.1821, label: 1, bag_size: 348
batch 519, loss: 0.0570, instance_loss: 0.3009, weighted_loss: 0.1302, label: 2, bag_size: 222
batch 539, loss: 0.1057, instance_loss: 0.3486, weighted_loss: 0.1786, label: 1, bag_size: 533


class 0 clustering acc 0.9860091743119266: correct 21495/21800
class 1 clustering acc 0.5536697247706422: correct 2414/4360
Epoch: 47, train_loss: 0.1061, train_clustering_loss:  0.2606, train_error: 0.0404
class 0: acc 0.9907407407407407, correct 107/108
class 1: acc 0.9279279279279279, correct 103/111
class 2: acc 0.9230769230769231, correct 108/117
class 3: acc 0.9680851063829787, correct 91/94
class 4: acc 0.991304347826087, correct 114/115

Val Set, val_loss: 0.8636, val_error: 0.2400, auc: 0.9311
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0463, weighted_loss: 0.0140, label: 1, bag_size: 847
batch 39, loss: 0.0243, instance_loss: 0.2296, weighted_loss: 0.0859, label: 2, bag_size: 638
batch 59, loss: 0.0002, instance_loss: 0.0820, weighted_loss: 0.0247, label: 4, bag_size: 44
batch 79, loss: 0.0140, instance_loss: 0.3618, weighted_loss: 0.1183, label: 0, bag_size: 118
batch 99, loss: 0.1057, instance_loss: 0.5230, weighted_loss: 0.2309, label: 1, bag_size: 868
batch 119, loss: 0.0063, instance_loss: 0.3510, weighted_loss: 0.1097, label: 2, bag_size: 725
batch 139, loss: 0.0309, instance_loss: 0.2549, weighted_loss: 0.0981, label: 2, bag_size: 351
batch 159, loss: 0.0011, instance_loss: 0.0429, weighted_loss: 0.0136, label: 4, bag_size: 51
batch 179, loss: 0.5056, instance_loss: 0.5761, weighted_loss: 0.5268, label: 0, bag_size: 868
batch 199, loss: 0.0009, instance_loss: 0.1496, weighted_loss: 0.0455, label: 1, bag_size: 534
batch 219, loss: 0.0313, instance_loss: 0.1893, weighted_loss: 0.0787, label: 3, bag_size: 451
batch 239, loss: 0.0000, instance_loss: 0.1224, weighted_loss: 0.0367, label: 4, bag_size: 20
batch 259, loss: 0.0003, instance_loss: 0.0176, weighted_loss: 0.0055, label: 4, bag_size: 150
batch 279, loss: 0.0649, instance_loss: 0.8399, weighted_loss: 0.2974, label: 4, bag_size: 436
batch 299, loss: 0.1258, instance_loss: 0.7721, weighted_loss: 0.3197, label: 1, bag_size: 875
batch 319, loss: 0.1505, instance_loss: 0.8788, weighted_loss: 0.3690, label: 3, bag_size: 211
batch 339, loss: 0.0033, instance_loss: 0.0549, weighted_loss: 0.0188, label: 0, bag_size: 518
batch 359, loss: 0.1813, instance_loss: 0.7343, weighted_loss: 0.3472, label: 0, bag_size: 245
batch 379, loss: 0.0021, instance_loss: 0.2811, weighted_loss: 0.0858, label: 2, bag_size: 655
batch 399, loss: 0.1845, instance_loss: 0.4065, weighted_loss: 0.2511, label: 1, bag_size: 386
batch 419, loss: 0.0214, instance_loss: 0.1964, weighted_loss: 0.0739, label: 2, bag_size: 846
batch 439, loss: 0.1741, instance_loss: 0.4901, weighted_loss: 0.2689, label: 2, bag_size: 758
batch 459, loss: 0.1687, instance_loss: 0.1697, weighted_loss: 0.1690, label: 1, bag_size: 1086
batch 479, loss: 0.0319, instance_loss: 0.2437, weighted_loss: 0.0954, label: 0, bag_size: 760
batch 499, loss: 0.3606, instance_loss: 0.7423, weighted_loss: 0.4751, label: 1, bag_size: 269
batch 519, loss: 0.2372, instance_loss: 0.2233, weighted_loss: 0.2330, label: 3, bag_size: 1177
batch 539, loss: 0.2417, instance_loss: 0.4718, weighted_loss: 0.3108, label: 3, bag_size: 607


class 0 clustering acc 0.9869724770642202: correct 21516/21800
class 1 clustering acc 0.5481651376146789: correct 2390/4360
Epoch: 48, train_loss: 0.1047, train_clustering_loss:  0.2529, train_error: 0.0275
class 0: acc 0.9555555555555556, correct 86/90
class 1: acc 0.9797979797979798, correct 97/99
class 2: acc 0.9461538461538461, correct 123/130
class 3: acc 1.0, correct 111/111
class 4: acc 0.9826086956521739, correct 113/115

Val Set, val_loss: 0.9053, val_error: 0.2400, auc: 0.9362
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.415: correct 166/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 1.0, correct 4/4
class 4: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.3524, instance_loss: 0.3108, weighted_loss: 0.3400, label: 3, bag_size: 533
batch 39, loss: 0.0167, instance_loss: 0.1945, weighted_loss: 0.0701, label: 0, bag_size: 136
batch 59, loss: 0.0003, instance_loss: 0.0661, weighted_loss: 0.0200, label: 4, bag_size: 192
batch 79, loss: 0.9065, instance_loss: 0.6442, weighted_loss: 0.8278, label: 2, bag_size: 1178
batch 99, loss: 0.0004, instance_loss: 0.0532, weighted_loss: 0.0162, label: 3, bag_size: 26
batch 119, loss: 0.0019, instance_loss: 0.0647, weighted_loss: 0.0207, label: 3, bag_size: 23
batch 139, loss: 1.0673, instance_loss: 0.3597, weighted_loss: 0.8551, label: 2, bag_size: 1235
batch 159, loss: 0.0001, instance_loss: 0.0097, weighted_loss: 0.0030, label: 3, bag_size: 105
batch 179, loss: 0.0001, instance_loss: 0.0826, weighted_loss: 0.0249, label: 3, bag_size: 18
batch 199, loss: 0.0135, instance_loss: 0.3896, weighted_loss: 0.1263, label: 1, bag_size: 1273
batch 219, loss: 0.0000, instance_loss: 0.3395, weighted_loss: 0.1019, label: 4, bag_size: 14
batch 239, loss: 0.0001, instance_loss: 0.0735, weighted_loss: 0.0221, label: 1, bag_size: 847
batch 259, loss: 0.0261, instance_loss: 0.1995, weighted_loss: 0.0781, label: 0, bag_size: 371
batch 279, loss: 0.0926, instance_loss: 0.4568, weighted_loss: 0.2018, label: 2, bag_size: 1400
batch 299, loss: 0.0009, instance_loss: 0.0935, weighted_loss: 0.0287, label: 3, bag_size: 16
batch 319, loss: 0.3179, instance_loss: 0.1952, weighted_loss: 0.2811, label: 1, bag_size: 533
batch 339, loss: 0.0053, instance_loss: 0.0464, weighted_loss: 0.0177, label: 3, bag_size: 1172
batch 359, loss: 0.0021, instance_loss: 0.1823, weighted_loss: 0.0562, label: 1, bag_size: 318
batch 379, loss: 0.0001, instance_loss: 0.0462, weighted_loss: 0.0139, label: 0, bag_size: 616
batch 399, loss: 0.4695, instance_loss: 0.4531, weighted_loss: 0.4646, label: 2, bag_size: 204
batch 419, loss: 0.0001, instance_loss: 0.0316, weighted_loss: 0.0095, label: 4, bag_size: 148
batch 439, loss: 0.0020, instance_loss: 0.0886, weighted_loss: 0.0280, label: 4, bag_size: 211
batch 459, loss: 0.1519, instance_loss: 0.1895, weighted_loss: 0.1632, label: 4, bag_size: 24
batch 479, loss: 0.0644, instance_loss: 0.8337, weighted_loss: 0.2952, label: 4, bag_size: 210
batch 499, loss: 0.0001, instance_loss: 0.0305, weighted_loss: 0.0092, label: 4, bag_size: 148
batch 519, loss: 0.0036, instance_loss: 0.4063, weighted_loss: 0.1244, label: 3, bag_size: 317
batch 539, loss: 0.1298, instance_loss: 0.4443, weighted_loss: 0.2241, label: 0, bag_size: 1257


class 0 clustering acc 0.9872018348623853: correct 21521/21800
class 1 clustering acc 0.5830275229357799: correct 2542/4360
Epoch: 49, train_loss: 0.1016, train_clustering_loss:  0.2454, train_error: 0.0275
class 0: acc 0.9826086956521739, correct 113/115
class 1: acc 0.9813084112149533, correct 105/107
class 2: acc 0.918918918918919, correct 102/111
class 3: acc 0.9900990099009901, correct 100/101
class 4: acc 0.990990990990991, correct 110/111

Val Set, val_loss: 0.8224, val_error: 0.2400, auc: 0.9412
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.4475: correct 179/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.1709, instance_loss: 0.3479, weighted_loss: 0.2240, label: 0, bag_size: 718
batch 39, loss: 0.5413, instance_loss: 0.4220, weighted_loss: 0.5055, label: 0, bag_size: 423
batch 59, loss: 0.0132, instance_loss: 0.1418, weighted_loss: 0.0518, label: 0, bag_size: 375
batch 79, loss: 0.0003, instance_loss: 0.0192, weighted_loss: 0.0060, label: 4, bag_size: 150
batch 99, loss: 0.0098, instance_loss: 0.0630, weighted_loss: 0.0258, label: 3, bag_size: 20
batch 119, loss: 0.0002, instance_loss: 0.1192, weighted_loss: 0.0359, label: 0, bag_size: 1101
batch 139, loss: 0.0455, instance_loss: 0.3361, weighted_loss: 0.1327, label: 2, bag_size: 977
batch 159, loss: 0.0042, instance_loss: 0.1373, weighted_loss: 0.0441, label: 2, bag_size: 292
batch 179, loss: 0.0005, instance_loss: 0.0178, weighted_loss: 0.0057, label: 4, bag_size: 143
batch 199, loss: 0.0656, instance_loss: 0.1981, weighted_loss: 0.1053, label: 2, bag_size: 1385
batch 219, loss: 0.0005, instance_loss: 0.0400, weighted_loss: 0.0124, label: 4, bag_size: 160
batch 239, loss: 0.0009, instance_loss: 0.0632, weighted_loss: 0.0196, label: 3, bag_size: 34
batch 259, loss: 0.1077, instance_loss: 0.3861, weighted_loss: 0.1912, label: 2, bag_size: 758
batch 279, loss: 0.0157, instance_loss: 0.1857, weighted_loss: 0.0667, label: 2, bag_size: 262
batch 299, loss: 0.0024, instance_loss: 0.1168, weighted_loss: 0.0367, label: 2, bag_size: 461
batch 319, loss: 0.0666, instance_loss: 0.1949, weighted_loss: 0.1051, label: 2, bag_size: 345
batch 339, loss: 0.0293, instance_loss: 0.0988, weighted_loss: 0.0502, label: 1, bag_size: 288
batch 359, loss: 0.0014, instance_loss: 0.0848, weighted_loss: 0.0264, label: 3, bag_size: 18
batch 379, loss: 0.0304, instance_loss: 0.5687, weighted_loss: 0.1919, label: 4, bag_size: 1474
batch 399, loss: 0.0002, instance_loss: 0.0181, weighted_loss: 0.0056, label: 4, bag_size: 128
batch 419, loss: 0.0029, instance_loss: 0.3378, weighted_loss: 0.1034, label: 3, bag_size: 706
batch 439, loss: 0.0007, instance_loss: 0.0926, weighted_loss: 0.0282, label: 4, bag_size: 524
batch 459, loss: 0.0002, instance_loss: 0.0707, weighted_loss: 0.0213, label: 0, bag_size: 239
batch 479, loss: 0.0001, instance_loss: 0.0298, weighted_loss: 0.0090, label: 4, bag_size: 185
batch 499, loss: 1.3804, instance_loss: 0.6885, weighted_loss: 1.1729, label: 3, bag_size: 305
batch 519, loss: 0.0906, instance_loss: 0.5960, weighted_loss: 0.2422, label: 4, bag_size: 663
batch 539, loss: 0.0017, instance_loss: 0.4223, weighted_loss: 0.1279, label: 3, bag_size: 706


class 0 clustering acc 0.986605504587156: correct 21508/21800
class 1 clustering acc 0.5444954128440367: correct 2374/4360
Epoch: 50, train_loss: 0.0996, train_clustering_loss:  0.2566, train_error: 0.0220
class 0: acc 1.0, correct 117/117
class 1: acc 0.967032967032967, correct 88/91
class 2: acc 0.957983193277311, correct 114/119
class 3: acc 0.9826086956521739, correct 113/115
class 4: acc 0.9805825242718447, correct 101/103

Val Set, val_loss: 1.0951, val_error: 0.2400, auc: 0.9237
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.4: correct 160/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0042, instance_loss: 0.4462, weighted_loss: 0.1368, label: 1, bag_size: 1255
batch 39, loss: 0.0000, instance_loss: 0.0411, weighted_loss: 0.0123, label: 3, bag_size: 27
batch 59, loss: 0.0005, instance_loss: 0.2184, weighted_loss: 0.0659, label: 4, bag_size: 1002
batch 79, loss: 0.0005, instance_loss: 0.0467, weighted_loss: 0.0144, label: 3, bag_size: 53
batch 99, loss: 0.0520, instance_loss: 0.2904, weighted_loss: 0.1235, label: 2, bag_size: 589
batch 119, loss: 0.0346, instance_loss: 0.1682, weighted_loss: 0.0747, label: 3, bag_size: 1019
batch 139, loss: 0.0090, instance_loss: 0.1447, weighted_loss: 0.0497, label: 0, bag_size: 807
batch 159, loss: 0.0029, instance_loss: 0.0535, weighted_loss: 0.0181, label: 4, bag_size: 40
batch 179, loss: 0.0999, instance_loss: 0.7723, weighted_loss: 0.3016, label: 0, bag_size: 245
batch 199, loss: 0.0032, instance_loss: 0.2705, weighted_loss: 0.0834, label: 1, bag_size: 614
batch 219, loss: 0.0125, instance_loss: 0.0900, weighted_loss: 0.0357, label: 2, bag_size: 935
batch 239, loss: 0.0190, instance_loss: 0.5563, weighted_loss: 0.1802, label: 1, bag_size: 936
batch 259, loss: 0.0167, instance_loss: 0.2254, weighted_loss: 0.0793, label: 2, bag_size: 2826
batch 279, loss: 0.0007, instance_loss: 0.0258, weighted_loss: 0.0082, label: 0, bag_size: 402
batch 299, loss: 0.0033, instance_loss: 0.0892, weighted_loss: 0.0291, label: 2, bag_size: 1019
batch 319, loss: 0.0489, instance_loss: 0.5122, weighted_loss: 0.1879, label: 3, bag_size: 200
batch 339, loss: 0.0742, instance_loss: 0.2743, weighted_loss: 0.1342, label: 2, bag_size: 932
batch 359, loss: 0.6600, instance_loss: 0.5958, weighted_loss: 0.6408, label: 1, bag_size: 917
batch 379, loss: 0.1554, instance_loss: 0.4922, weighted_loss: 0.2564, label: 4, bag_size: 882
batch 399, loss: 0.4645, instance_loss: 0.8048, weighted_loss: 0.5666, label: 2, bag_size: 3236
batch 419, loss: 0.0004, instance_loss: 0.1208, weighted_loss: 0.0366, label: 0, bag_size: 653
batch 439, loss: 0.0241, instance_loss: 0.1631, weighted_loss: 0.0658, label: 2, bag_size: 2703
batch 459, loss: 0.0105, instance_loss: 0.5616, weighted_loss: 0.1758, label: 1, bag_size: 936
batch 479, loss: 0.0002, instance_loss: 0.0408, weighted_loss: 0.0124, label: 3, bag_size: 27
batch 499, loss: 0.0009, instance_loss: 0.0909, weighted_loss: 0.0279, label: 3, bag_size: 16
batch 519, loss: 0.0001, instance_loss: 0.1486, weighted_loss: 0.0447, label: 3, bag_size: 18
batch 539, loss: 0.0059, instance_loss: 0.1511, weighted_loss: 0.0494, label: 0, bag_size: 1133


class 0 clustering acc 0.985137614678899: correct 21476/21800
class 1 clustering acc 0.5619266055045872: correct 2450/4360
Epoch: 51, train_loss: 0.0887, train_clustering_loss:  0.2506, train_error: 0.0312
class 0: acc 1.0, correct 104/104
class 1: acc 0.9568965517241379, correct 111/116
class 2: acc 0.9298245614035088, correct 106/114
class 3: acc 0.970873786407767, correct 100/103
class 4: acc 0.9907407407407407, correct 107/108

Val Set, val_loss: 0.8445, val_error: 0.3200, auc: 0.9435
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.385: correct 154/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.47058823529411764, correct 8/17
class 3: acc 1.0, correct 4/4
class 4: acc 1.0, correct 3/3
EarlyStopping counter: 36 out of 20
Early stopping
Val error: 0.2400, ROC AUC: 0.9455
Test error: 0.3000, ROC AUC: 0.9255
class 0: acc 0.875, correct 7/8
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.9130434782608695, correct 21/23
class 3: acc 1.0, correct 1/1
class 4: acc 0.16666666666666666, correct 1/6

Training Fold 5!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.3980, instance_loss: 1.1879, weighted_loss: 1.3350, label: 0, bag_size: 524
batch 39, loss: 1.3764, instance_loss: 0.9886, weighted_loss: 1.2601, label: 0, bag_size: 143
batch 59, loss: 1.3612, instance_loss: 0.7739, weighted_loss: 1.1850, label: 4, bag_size: 78
batch 79, loss: 2.0012, instance_loss: 0.5913, weighted_loss: 1.5782, label: 1, bag_size: 860
batch 99, loss: 2.1641, instance_loss: 0.5952, weighted_loss: 1.6934, label: 1, bag_size: 754
batch 119, loss: 1.7663, instance_loss: 0.5839, weighted_loss: 1.4116, label: 0, bag_size: 143
batch 139, loss: 1.3932, instance_loss: 0.5258, weighted_loss: 1.1330, label: 4, bag_size: 754
batch 159, loss: 1.8538, instance_loss: 0.5979, weighted_loss: 1.4770, label: 3, bag_size: 46
batch 179, loss: 1.7469, instance_loss: 0.6208, weighted_loss: 1.4091, label: 3, bag_size: 20
batch 199, loss: 1.5380, instance_loss: 0.5276, weighted_loss: 1.2349, label: 2, bag_size: 839
batch 219, loss: 1.4896, instance_loss: 0.5366, weighted_loss: 1.2037, label: 1, bag_size: 319
batch 239, loss: 1.7818, instance_loss: 0.5684, weighted_loss: 1.4178, label: 0, bag_size: 545
batch 259, loss: 1.7727, instance_loss: 0.5687, weighted_loss: 1.4115, label: 0, bag_size: 338
batch 279, loss: 2.2753, instance_loss: 0.5977, weighted_loss: 1.7720, label: 0, bag_size: 148
batch 299, loss: 1.7475, instance_loss: 0.5410, weighted_loss: 1.3856, label: 1, bag_size: 648
batch 319, loss: 1.5803, instance_loss: 0.5256, weighted_loss: 1.2639, label: 1, bag_size: 860
batch 339, loss: 1.7313, instance_loss: 0.5311, weighted_loss: 1.3713, label: 0, bag_size: 976
batch 359, loss: 1.9098, instance_loss: 0.5328, weighted_loss: 1.4967, label: 4, bag_size: 823
batch 379, loss: 1.4211, instance_loss: 0.5394, weighted_loss: 1.1566, label: 1, bag_size: 968
batch 399, loss: 1.4158, instance_loss: 0.5160, weighted_loss: 1.1459, label: 0, bag_size: 759
batch 419, loss: 1.3380, instance_loss: 0.5100, weighted_loss: 1.0896, label: 0, bag_size: 466
batch 439, loss: 1.5162, instance_loss: 0.4858, weighted_loss: 1.2071, label: 4, bag_size: 764
batch 459, loss: 1.7370, instance_loss: 0.5515, weighted_loss: 1.3813, label: 2, bag_size: 878
batch 479, loss: 0.5385, instance_loss: 0.3862, weighted_loss: 0.4928, label: 4, bag_size: 150
batch 499, loss: 1.2817, instance_loss: 0.4960, weighted_loss: 1.0460, label: 1, bag_size: 470
batch 519, loss: 0.7645, instance_loss: 0.4389, weighted_loss: 0.6668, label: 3, bag_size: 28
batch 539, loss: 1.2824, instance_loss: 0.5202, weighted_loss: 1.0538, label: 1, bag_size: 346


class 0 clustering acc 0.9966055045871559: correct 21726/21800
class 1 clustering acc 0.00022935779816513763: correct 1/4360
Epoch: 0, train_loss: 1.4549, train_clustering_loss:  0.5881, train_error: 0.6495
class 0: acc 0.30275229357798167, correct 33/109
class 1: acc 0.24210526315789474, correct 23/95
class 2: acc 0.3157894736842105, correct 36/114
class 3: acc 0.25925925925925924, correct 28/108
class 4: acc 0.5966386554621849, correct 71/119

Val Set, val_loss: 1.3535, val_error: 0.4800, auc: 0.7617
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/9
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 1.0, correct 19/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.42857142857142855, correct 3/7
Validation loss decreased (inf --> 1.353466).  Saving model ...


batch 19, loss: 1.1159, instance_loss: 0.4949, weighted_loss: 0.9296, label: 1, bag_size: 846
batch 39, loss: 2.7166, instance_loss: 0.5991, weighted_loss: 2.0813, label: 4, bag_size: 1337
batch 59, loss: 1.3478, instance_loss: 0.4929, weighted_loss: 1.0914, label: 2, bag_size: 1024
batch 79, loss: 0.3711, instance_loss: 0.3190, weighted_loss: 0.3554, label: 4, bag_size: 83
batch 99, loss: 0.9371, instance_loss: 0.4347, weighted_loss: 0.7864, label: 2, bag_size: 687
batch 119, loss: 1.4271, instance_loss: 0.5162, weighted_loss: 1.1538, label: 0, bag_size: 1599
batch 139, loss: 2.5692, instance_loss: 0.6165, weighted_loss: 1.9834, label: 3, bag_size: 317
batch 159, loss: 2.4772, instance_loss: 0.5863, weighted_loss: 1.9099, label: 4, bag_size: 817
batch 179, loss: 0.1589, instance_loss: 0.1929, weighted_loss: 0.1691, label: 4, bag_size: 83
batch 199, loss: 0.1510, instance_loss: 0.2294, weighted_loss: 0.1745, label: 4, bag_size: 23
batch 219, loss: 1.0543, instance_loss: 0.4684, weighted_loss: 0.8785, label: 1, bag_size: 828
batch 239, loss: 0.8614, instance_loss: 0.4493, weighted_loss: 0.7378, label: 3, bag_size: 18
batch 259, loss: 1.4651, instance_loss: 0.5302, weighted_loss: 1.1846, label: 0, bag_size: 245
batch 279, loss: 1.2289, instance_loss: 0.4993, weighted_loss: 1.0100, label: 0, bag_size: 607
batch 299, loss: 0.7669, instance_loss: 0.4185, weighted_loss: 0.6624, label: 1, bag_size: 399
batch 319, loss: 0.8258, instance_loss: 0.4119, weighted_loss: 0.7016, label: 1, bag_size: 320
batch 339, loss: 1.0693, instance_loss: 0.4609, weighted_loss: 0.8868, label: 1, bag_size: 102
batch 359, loss: 1.0331, instance_loss: 0.4184, weighted_loss: 0.8487, label: 1, bag_size: 1273
batch 379, loss: 2.4262, instance_loss: 0.8342, weighted_loss: 1.9486, label: 0, bag_size: 116
batch 399, loss: 1.7804, instance_loss: 0.5488, weighted_loss: 1.4109, label: 2, bag_size: 1052
batch 419, loss: 0.3442, instance_loss: 0.3593, weighted_loss: 0.3487, label: 3, bag_size: 18
batch 439, loss: 1.4111, instance_loss: 0.5310, weighted_loss: 1.1471, label: 2, bag_size: 1231
batch 459, loss: 1.8790, instance_loss: 0.5621, weighted_loss: 1.4839, label: 4, bag_size: 947
batch 479, loss: 2.1610, instance_loss: 0.5586, weighted_loss: 1.6803, label: 3, bag_size: 283
batch 499, loss: 1.0457, instance_loss: 0.4762, weighted_loss: 0.8749, label: 2, bag_size: 846
batch 519, loss: 1.7409, instance_loss: 0.4601, weighted_loss: 1.3567, label: 3, bag_size: 533
batch 539, loss: 1.8600, instance_loss: 0.5382, weighted_loss: 1.4635, label: 3, bag_size: 821


class 0 clustering acc 0.9980275229357798: correct 21757/21800
class 1 clustering acc 0.05802752293577982: correct 253/4360
Epoch: 1, train_loss: 1.1737, train_clustering_loss:  0.4494, train_error: 0.4477
class 0: acc 0.10869565217391304, correct 10/92
class 1: acc 0.5849056603773585, correct 62/106
class 2: acc 0.6, correct 69/115
class 3: acc 0.6442307692307693, correct 67/104
class 4: acc 0.7265625, correct 93/128

Val Set, val_loss: 1.2615, val_error: 0.5400, auc: 0.7671
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.04: correct 16/400
class 0: acc 0.0, correct 0/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.42857142857142855, correct 3/7
Validation loss decreased (1.353466 --> 1.261475).  Saving model ...


batch 19, loss: 1.2396, instance_loss: 0.5087, weighted_loss: 1.0203, label: 0, bag_size: 1517
batch 39, loss: 0.6877, instance_loss: 0.3436, weighted_loss: 0.5844, label: 1, bag_size: 944
batch 59, loss: 1.9503, instance_loss: 0.5692, weighted_loss: 1.5359, label: 3, bag_size: 821
batch 79, loss: 0.4465, instance_loss: 0.3550, weighted_loss: 0.4190, label: 3, bag_size: 50
batch 99, loss: 1.4066, instance_loss: 0.5105, weighted_loss: 1.1378, label: 0, bag_size: 423
batch 119, loss: 1.0571, instance_loss: 0.4807, weighted_loss: 0.8842, label: 0, bag_size: 807
batch 139, loss: 1.5112, instance_loss: 0.4474, weighted_loss: 1.1921, label: 1, bag_size: 867
batch 159, loss: 1.0085, instance_loss: 0.4547, weighted_loss: 0.8424, label: 2, bag_size: 750
batch 179, loss: 1.2236, instance_loss: 0.4687, weighted_loss: 0.9971, label: 0, bag_size: 466
batch 199, loss: 0.9818, instance_loss: 0.4572, weighted_loss: 0.8244, label: 0, bag_size: 478
batch 219, loss: 2.0965, instance_loss: 0.8576, weighted_loss: 1.7248, label: 0, bag_size: 109
batch 239, loss: 0.4387, instance_loss: 0.3612, weighted_loss: 0.4155, label: 4, bag_size: 23
batch 259, loss: 0.6591, instance_loss: 0.4004, weighted_loss: 0.5815, label: 2, bag_size: 222
batch 279, loss: 0.2578, instance_loss: 0.2757, weighted_loss: 0.2632, label: 1, bag_size: 847
batch 299, loss: 1.6323, instance_loss: 0.4798, weighted_loss: 1.2865, label: 1, bag_size: 308
batch 319, loss: 2.8941, instance_loss: 0.7389, weighted_loss: 2.2475, label: 3, bag_size: 343
batch 339, loss: 0.9453, instance_loss: 0.4547, weighted_loss: 0.7982, label: 0, bag_size: 731
batch 359, loss: 0.4542, instance_loss: 0.3155, weighted_loss: 0.4126, label: 1, bag_size: 286
batch 379, loss: 0.2829, instance_loss: 0.2555, weighted_loss: 0.2747, label: 1, bag_size: 834
batch 399, loss: 3.6763, instance_loss: 0.8402, weighted_loss: 2.8255, label: 3, bag_size: 630
batch 419, loss: 0.1204, instance_loss: 0.2015, weighted_loss: 0.1447, label: 3, bag_size: 31
batch 439, loss: 0.9513, instance_loss: 0.3784, weighted_loss: 0.7794, label: 1, bag_size: 533
batch 459, loss: 1.4438, instance_loss: 0.4595, weighted_loss: 1.1485, label: 1, bag_size: 377
batch 479, loss: 2.5956, instance_loss: 0.6763, weighted_loss: 2.0198, label: 3, bag_size: 343
batch 499, loss: 0.1058, instance_loss: 0.1816, weighted_loss: 0.1285, label: 3, bag_size: 26
batch 519, loss: 1.1789, instance_loss: 0.3691, weighted_loss: 0.9359, label: 3, bag_size: 1380
batch 539, loss: 1.1289, instance_loss: 0.4909, weighted_loss: 0.9375, label: 0, bag_size: 545


class 0 clustering acc 0.9959633027522936: correct 21712/21800
class 1 clustering acc 0.13944954128440368: correct 608/4360
Epoch: 2, train_loss: 1.0429, train_clustering_loss:  0.4145, train_error: 0.4000
class 0: acc 0.3, correct 30/100
class 1: acc 0.6724137931034483, correct 78/116
class 2: acc 0.5636363636363636, correct 62/110
class 3: acc 0.7798165137614679, correct 85/109
class 4: acc 0.6545454545454545, correct 72/110

Val Set, val_loss: 1.2212, val_error: 0.5200, auc: 0.7792
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.085: correct 34/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.42857142857142855, correct 3/7
Validation loss decreased (1.261475 --> 1.221220).  Saving model ...


batch 19, loss: 1.1188, instance_loss: 0.4967, weighted_loss: 0.9322, label: 2, bag_size: 312
batch 39, loss: 0.6957, instance_loss: 0.3996, weighted_loss: 0.6069, label: 2, bag_size: 977
batch 59, loss: 1.0891, instance_loss: 0.3915, weighted_loss: 0.8798, label: 1, bag_size: 320
batch 79, loss: 1.7560, instance_loss: 0.4464, weighted_loss: 1.3631, label: 3, bag_size: 936
batch 99, loss: 2.6636, instance_loss: 0.7262, weighted_loss: 2.0823, label: 4, bag_size: 656
batch 119, loss: 1.5170, instance_loss: 0.5039, weighted_loss: 1.2131, label: 3, bag_size: 936
batch 139, loss: 0.7613, instance_loss: 0.4449, weighted_loss: 0.6664, label: 0, bag_size: 478
batch 159, loss: 0.5205, instance_loss: 0.4029, weighted_loss: 0.4853, label: 1, bag_size: 1014
batch 179, loss: 0.9304, instance_loss: 0.4209, weighted_loss: 0.7775, label: 2, bag_size: 806
batch 199, loss: 0.0877, instance_loss: 0.1905, weighted_loss: 0.1185, label: 3, bag_size: 20
batch 219, loss: 0.4575, instance_loss: 0.2987, weighted_loss: 0.4098, label: 1, bag_size: 944
batch 239, loss: 0.3784, instance_loss: 0.2513, weighted_loss: 0.3403, label: 1, bag_size: 944
batch 259, loss: 1.8077, instance_loss: 0.4522, weighted_loss: 1.4010, label: 1, bag_size: 446
batch 279, loss: 0.8749, instance_loss: 0.4370, weighted_loss: 0.7435, label: 0, bag_size: 759
batch 299, loss: 1.8149, instance_loss: 0.5423, weighted_loss: 1.4331, label: 4, bag_size: 675
batch 319, loss: 1.5316, instance_loss: 0.4581, weighted_loss: 1.2095, label: 1, bag_size: 1273
batch 339, loss: 0.9847, instance_loss: 0.4399, weighted_loss: 0.8213, label: 0, bag_size: 1332
batch 359, loss: 0.0652, instance_loss: 0.1626, weighted_loss: 0.0944, label: 3, bag_size: 19
batch 379, loss: 0.8050, instance_loss: 0.4603, weighted_loss: 0.7016, label: 0, bag_size: 1061
batch 399, loss: 0.6484, instance_loss: 0.4429, weighted_loss: 0.5868, label: 0, bag_size: 898
batch 419, loss: 0.4661, instance_loss: 0.2549, weighted_loss: 0.4027, label: 1, bag_size: 754
batch 439, loss: 1.4334, instance_loss: 0.5262, weighted_loss: 1.1612, label: 4, bag_size: 790
batch 459, loss: 1.7258, instance_loss: 0.5566, weighted_loss: 1.3750, label: 2, bag_size: 967
batch 479, loss: 0.1338, instance_loss: 0.1051, weighted_loss: 0.1252, label: 4, bag_size: 130
batch 499, loss: 0.1279, instance_loss: 0.0863, weighted_loss: 0.1154, label: 4, bag_size: 160
batch 519, loss: 2.2641, instance_loss: 0.6010, weighted_loss: 1.7651, label: 2, bag_size: 319
batch 539, loss: 1.9139, instance_loss: 0.5958, weighted_loss: 1.5185, label: 0, bag_size: 1257


class 0 clustering acc 0.9939449541284404: correct 21668/21800
class 1 clustering acc 0.17454128440366973: correct 761/4360
Epoch: 3, train_loss: 0.9535, train_clustering_loss:  0.4012, train_error: 0.3284
class 0: acc 0.6186440677966102, correct 73/118
class 1: acc 0.6476190476190476, correct 68/105
class 2: acc 0.624, correct 78/125
class 3: acc 0.7789473684210526, correct 74/95
class 4: acc 0.7156862745098039, correct 73/102

Val Set, val_loss: 1.1732, val_error: 0.5400, auc: 0.7853
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.0825: correct 33/400
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.42857142857142855, correct 3/7
Validation loss decreased (1.221220 --> 1.173240).  Saving model ...


batch 19, loss: 3.6596, instance_loss: 0.8594, weighted_loss: 2.8196, label: 3, bag_size: 200
batch 39, loss: 0.2649, instance_loss: 0.2094, weighted_loss: 0.2482, label: 1, bag_size: 690
batch 59, loss: 0.1753, instance_loss: 0.2018, weighted_loss: 0.1833, label: 3, bag_size: 20
batch 79, loss: 1.0632, instance_loss: 0.4391, weighted_loss: 0.8760, label: 0, bag_size: 515
batch 99, loss: 3.2129, instance_loss: 0.7577, weighted_loss: 2.4763, label: 3, bag_size: 343
batch 119, loss: 0.7832, instance_loss: 0.3895, weighted_loss: 0.6651, label: 2, bag_size: 400
batch 139, loss: 0.7344, instance_loss: 0.4002, weighted_loss: 0.6341, label: 2, bag_size: 278
batch 159, loss: 0.5215, instance_loss: 0.3909, weighted_loss: 0.4823, label: 0, bag_size: 602
batch 179, loss: 2.5533, instance_loss: 0.6939, weighted_loss: 1.9955, label: 3, bag_size: 791
batch 199, loss: 0.2811, instance_loss: 0.1441, weighted_loss: 0.2400, label: 4, bag_size: 211
batch 219, loss: 0.0941, instance_loss: 0.0802, weighted_loss: 0.0899, label: 4, bag_size: 162
batch 239, loss: 0.6309, instance_loss: 0.4220, weighted_loss: 0.5682, label: 0, bag_size: 898
batch 259, loss: 1.2036, instance_loss: 0.4854, weighted_loss: 0.9881, label: 0, bag_size: 1018
batch 279, loss: 1.1682, instance_loss: 0.3975, weighted_loss: 0.9370, label: 3, bag_size: 936
batch 299, loss: 2.3750, instance_loss: 0.7038, weighted_loss: 1.8736, label: 4, bag_size: 1337
batch 319, loss: 0.1146, instance_loss: 0.0699, weighted_loss: 0.1012, label: 4, bag_size: 101
batch 339, loss: 0.2452, instance_loss: 0.1545, weighted_loss: 0.2180, label: 1, bag_size: 937
batch 359, loss: 0.2158, instance_loss: 0.2747, weighted_loss: 0.2335, label: 4, bag_size: 19
batch 379, loss: 0.8733, instance_loss: 0.4346, weighted_loss: 0.7417, label: 2, bag_size: 913
batch 399, loss: 0.6290, instance_loss: 0.3857, weighted_loss: 0.5560, label: 2, bag_size: 323
batch 419, loss: 0.5108, instance_loss: 0.3789, weighted_loss: 0.4712, label: 0, bag_size: 424
batch 439, loss: 1.1799, instance_loss: 0.4403, weighted_loss: 0.9580, label: 2, bag_size: 863
batch 459, loss: 0.4668, instance_loss: 0.3879, weighted_loss: 0.4431, label: 0, bag_size: 1255
batch 479, loss: 1.7631, instance_loss: 0.5444, weighted_loss: 1.3975, label: 2, bag_size: 1231
batch 499, loss: 0.1015, instance_loss: 0.0644, weighted_loss: 0.0904, label: 4, bag_size: 83
batch 519, loss: 1.0784, instance_loss: 0.4621, weighted_loss: 0.8935, label: 2, bag_size: 725
batch 539, loss: 0.8597, instance_loss: 0.4347, weighted_loss: 0.7322, label: 0, bag_size: 759


class 0 clustering acc 0.9922477064220183: correct 21631/21800
class 1 clustering acc 0.25137614678899084: correct 1096/4360
Epoch: 4, train_loss: 0.8450, train_clustering_loss:  0.3743, train_error: 0.2862
class 0: acc 0.6833333333333333, correct 82/120
class 1: acc 0.6476190476190476, correct 68/105
class 2: acc 0.6605504587155964, correct 72/109
class 3: acc 0.7722772277227723, correct 78/101
class 4: acc 0.8090909090909091, correct 89/110

Val Set, val_loss: 1.1208, val_error: 0.4600, auc: 0.8101
class 0 clustering acc 0.9995: correct 1999/2000
class 1 clustering acc 0.0825: correct 33/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.42857142857142855, correct 3/7
Validation loss decreased (1.173240 --> 1.120753).  Saving model ...


batch 19, loss: 0.6443, instance_loss: 0.3823, weighted_loss: 0.5657, label: 1, bag_size: 700
batch 39, loss: 0.3440, instance_loss: 0.1610, weighted_loss: 0.2891, label: 3, bag_size: 1172
batch 59, loss: 0.3855, instance_loss: 0.2670, weighted_loss: 0.3500, label: 3, bag_size: 821
batch 79, loss: 1.0141, instance_loss: 0.4303, weighted_loss: 0.8390, label: 2, bag_size: 351
batch 99, loss: 0.7352, instance_loss: 0.4236, weighted_loss: 0.6418, label: 2, bag_size: 1200
batch 119, loss: 1.1432, instance_loss: 0.6582, weighted_loss: 0.9977, label: 0, bag_size: 128
batch 139, loss: 0.7907, instance_loss: 0.5044, weighted_loss: 0.7048, label: 4, bag_size: 764
batch 159, loss: 0.6471, instance_loss: 0.3367, weighted_loss: 0.5540, label: 1, bag_size: 470
batch 179, loss: 0.6037, instance_loss: 0.3793, weighted_loss: 0.5364, label: 0, bag_size: 933
batch 199, loss: 0.7293, instance_loss: 0.3619, weighted_loss: 0.6191, label: 1, bag_size: 470
batch 219, loss: 0.2688, instance_loss: 0.2346, weighted_loss: 0.2586, label: 3, bag_size: 17
batch 239, loss: 1.0377, instance_loss: 0.7550, weighted_loss: 0.9529, label: 0, bag_size: 114
batch 259, loss: 1.7616, instance_loss: 0.5321, weighted_loss: 1.3928, label: 4, bag_size: 754
batch 279, loss: 0.8507, instance_loss: 0.3518, weighted_loss: 0.7010, label: 1, bag_size: 945
batch 299, loss: 0.0289, instance_loss: 0.1258, weighted_loss: 0.0580, label: 3, bag_size: 20
batch 319, loss: 2.2072, instance_loss: 0.7253, weighted_loss: 1.7626, label: 1, bag_size: 867
batch 339, loss: 0.7875, instance_loss: 0.3099, weighted_loss: 0.6442, label: 3, bag_size: 952
batch 359, loss: 1.1463, instance_loss: 0.4659, weighted_loss: 0.9422, label: 0, bag_size: 653
batch 379, loss: 0.8299, instance_loss: 0.6915, weighted_loss: 0.7884, label: 0, bag_size: 116
batch 399, loss: 0.7799, instance_loss: 0.4538, weighted_loss: 0.6820, label: 0, bag_size: 1196
batch 419, loss: 2.4877, instance_loss: 0.6359, weighted_loss: 1.9322, label: 4, bag_size: 974
batch 439, loss: 1.2507, instance_loss: 0.5780, weighted_loss: 1.0489, label: 3, bag_size: 821
batch 459, loss: 1.5654, instance_loss: 0.5850, weighted_loss: 1.2713, label: 4, bag_size: 354
batch 479, loss: 0.5536, instance_loss: 0.3484, weighted_loss: 0.4920, label: 0, bag_size: 552
batch 499, loss: 0.5874, instance_loss: 0.3514, weighted_loss: 0.5166, label: 2, bag_size: 1164
batch 519, loss: 0.0534, instance_loss: 0.1273, weighted_loss: 0.0756, label: 3, bag_size: 18
batch 539, loss: 0.8128, instance_loss: 0.4194, weighted_loss: 0.6948, label: 2, bag_size: 324


class 0 clustering acc 0.993165137614679: correct 21651/21800
class 1 clustering acc 0.24174311926605505: correct 1054/4360
Epoch: 5, train_loss: 0.7963, train_clustering_loss:  0.3694, train_error: 0.2844
class 0: acc 0.6557377049180327, correct 80/122
class 1: acc 0.7019230769230769, correct 73/104
class 2: acc 0.6422018348623854, correct 70/109
class 3: acc 0.8773584905660378, correct 93/106
class 4: acc 0.7115384615384616, correct 74/104

Val Set, val_loss: 1.1231, val_error: 0.4400, auc: 0.8061
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.115: correct 46/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7286, instance_loss: 0.4891, weighted_loss: 0.6568, label: 2, bag_size: 358
batch 39, loss: 2.1901, instance_loss: 0.6046, weighted_loss: 1.7144, label: 3, bag_size: 211
batch 59, loss: 0.0312, instance_loss: 0.0935, weighted_loss: 0.0499, label: 3, bag_size: 20
batch 79, loss: 1.1188, instance_loss: 0.4347, weighted_loss: 0.9136, label: 1, bag_size: 648
batch 99, loss: 0.9071, instance_loss: 0.5010, weighted_loss: 0.7853, label: 4, bag_size: 826
batch 119, loss: 1.0286, instance_loss: 0.7371, weighted_loss: 0.9411, label: 0, bag_size: 163
batch 139, loss: 0.5093, instance_loss: 0.3705, weighted_loss: 0.4676, label: 0, bag_size: 515
batch 159, loss: 0.1170, instance_loss: 0.1107, weighted_loss: 0.1151, label: 1, bag_size: 369
batch 179, loss: 2.0545, instance_loss: 0.5908, weighted_loss: 1.6154, label: 2, bag_size: 474
batch 199, loss: 0.8016, instance_loss: 0.3856, weighted_loss: 0.6768, label: 2, bag_size: 384
batch 219, loss: 0.3789, instance_loss: 0.2442, weighted_loss: 0.3385, label: 1, bag_size: 890
batch 239, loss: 1.2966, instance_loss: 0.5799, weighted_loss: 1.0816, label: 4, bag_size: 826
batch 259, loss: 0.3148, instance_loss: 0.3278, weighted_loss: 0.3187, label: 0, bag_size: 437
batch 279, loss: 0.3148, instance_loss: 0.1974, weighted_loss: 0.2795, label: 1, bag_size: 1325
batch 299, loss: 1.4384, instance_loss: 0.4550, weighted_loss: 1.1434, label: 1, bag_size: 1724
batch 319, loss: 0.3199, instance_loss: 0.3548, weighted_loss: 0.3304, label: 2, bag_size: 846
batch 339, loss: 0.0724, instance_loss: 0.1034, weighted_loss: 0.0817, label: 3, bag_size: 53
batch 359, loss: 0.0117, instance_loss: 0.0683, weighted_loss: 0.0287, label: 3, bag_size: 43
batch 379, loss: 1.1136, instance_loss: 0.4964, weighted_loss: 0.9284, label: 1, bag_size: 657
batch 399, loss: 0.0662, instance_loss: 0.0620, weighted_loss: 0.0650, label: 4, bag_size: 150
batch 419, loss: 1.7265, instance_loss: 0.6465, weighted_loss: 1.4025, label: 2, bag_size: 758
batch 439, loss: 0.4646, instance_loss: 0.3458, weighted_loss: 0.4290, label: 0, bag_size: 410
batch 459, loss: 0.7552, instance_loss: 0.4617, weighted_loss: 0.6672, label: 0, bag_size: 340
batch 479, loss: 1.3836, instance_loss: 0.5342, weighted_loss: 1.1288, label: 4, bag_size: 823
batch 499, loss: 1.3439, instance_loss: 0.4756, weighted_loss: 1.0834, label: 1, bag_size: 700
batch 519, loss: 0.5684, instance_loss: 0.3930, weighted_loss: 0.5158, label: 4, bag_size: 790
batch 539, loss: 0.3855, instance_loss: 0.2402, weighted_loss: 0.3419, label: 1, bag_size: 994


class 0 clustering acc 0.9941284403669725: correct 21672/21800
class 1 clustering acc 0.2639908256880734: correct 1151/4360
Epoch: 6, train_loss: 0.7078, train_clustering_loss:  0.3573, train_error: 0.2422
class 0: acc 0.7984496124031008, correct 103/129
class 1: acc 0.6981132075471698, correct 74/106
class 2: acc 0.6767676767676768, correct 67/99
class 3: acc 0.83, correct 83/100
class 4: acc 0.7747747747747747, correct 86/111

Val Set, val_loss: 1.0841, val_error: 0.4200, auc: 0.8155
class 0 clustering acc 0.9975: correct 1995/2000
class 1 clustering acc 0.105: correct 42/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
Validation loss decreased (1.120753 --> 1.084080).  Saving model ...


batch 19, loss: 0.6334, instance_loss: 0.3626, weighted_loss: 0.5522, label: 2, bag_size: 707
batch 39, loss: 0.5121, instance_loss: 0.5686, weighted_loss: 0.5291, label: 0, bag_size: 109
batch 59, loss: 0.7598, instance_loss: 0.4519, weighted_loss: 0.6674, label: 2, bag_size: 878
batch 79, loss: 0.9917, instance_loss: 0.4650, weighted_loss: 0.8337, label: 2, bag_size: 471
batch 99, loss: 0.1307, instance_loss: 0.1039, weighted_loss: 0.1227, label: 1, bag_size: 847
batch 119, loss: 0.0741, instance_loss: 0.1701, weighted_loss: 0.1029, label: 3, bag_size: 18
batch 139, loss: 1.0301, instance_loss: 0.4421, weighted_loss: 0.8537, label: 2, bag_size: 682
batch 159, loss: 0.7237, instance_loss: 0.4007, weighted_loss: 0.6268, label: 2, bag_size: 499
batch 179, loss: 0.8718, instance_loss: 0.4245, weighted_loss: 0.7376, label: 2, bag_size: 600
batch 199, loss: 0.8040, instance_loss: 0.4061, weighted_loss: 0.6847, label: 0, bag_size: 1046
batch 219, loss: 0.9642, instance_loss: 0.4261, weighted_loss: 0.8028, label: 0, bag_size: 432
batch 239, loss: 0.2611, instance_loss: 0.3559, weighted_loss: 0.2895, label: 0, bag_size: 731
batch 259, loss: 0.9938, instance_loss: 0.4569, weighted_loss: 0.8327, label: 2, bag_size: 1052
batch 279, loss: 0.7326, instance_loss: 0.3965, weighted_loss: 0.6318, label: 0, bag_size: 990
batch 299, loss: 0.4057, instance_loss: 0.2942, weighted_loss: 0.3723, label: 1, bag_size: 1080
batch 319, loss: 1.5624, instance_loss: 0.5534, weighted_loss: 1.2597, label: 2, bag_size: 1653
batch 339, loss: 1.0805, instance_loss: 0.5148, weighted_loss: 0.9108, label: 0, bag_size: 736
batch 359, loss: 0.0746, instance_loss: 0.3039, weighted_loss: 0.1434, label: 4, bag_size: 24
batch 379, loss: 0.0085, instance_loss: 0.1098, weighted_loss: 0.0389, label: 3, bag_size: 26
batch 399, loss: 0.0767, instance_loss: 0.1820, weighted_loss: 0.1083, label: 0, bag_size: 1143
batch 419, loss: 0.7546, instance_loss: 0.3847, weighted_loss: 0.6436, label: 4, bag_size: 947
batch 439, loss: 0.2454, instance_loss: 0.4121, weighted_loss: 0.2954, label: 0, bag_size: 114
batch 459, loss: 1.5813, instance_loss: 0.6054, weighted_loss: 1.2886, label: 3, bag_size: 343
batch 479, loss: 0.8120, instance_loss: 0.4402, weighted_loss: 0.7005, label: 2, bag_size: 356
batch 499, loss: 0.7420, instance_loss: 0.7040, weighted_loss: 0.7306, label: 4, bag_size: 882
batch 519, loss: 0.3858, instance_loss: 0.3450, weighted_loss: 0.3735, label: 2, bag_size: 1235
batch 539, loss: 0.3119, instance_loss: 0.2007, weighted_loss: 0.2786, label: 4, bag_size: 55


class 0 clustering acc 0.9924770642201834: correct 21636/21800
class 1 clustering acc 0.29357798165137616: correct 1280/4360
Epoch: 7, train_loss: 0.6354, train_clustering_loss:  0.3448, train_error: 0.2183
class 0: acc 0.8620689655172413, correct 100/116
class 1: acc 0.6814159292035398, correct 77/113
class 2: acc 0.6274509803921569, correct 64/102
class 3: acc 0.8938053097345132, correct 101/113
class 4: acc 0.8316831683168316, correct 84/101

Val Set, val_loss: 1.1685, val_error: 0.4400, auc: 0.8210
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9920, instance_loss: 0.6297, weighted_loss: 1.5833, label: 3, bag_size: 360
batch 39, loss: 0.6461, instance_loss: 0.3388, weighted_loss: 0.5539, label: 0, bag_size: 1332
batch 59, loss: 1.9544, instance_loss: 0.5304, weighted_loss: 1.5272, label: 1, bag_size: 1559
batch 79, loss: 1.2376, instance_loss: 0.7938, weighted_loss: 1.1045, label: 0, bag_size: 143
batch 99, loss: 0.3098, instance_loss: 0.2228, weighted_loss: 0.2837, label: 1, bag_size: 944
batch 119, loss: 1.4664, instance_loss: 0.5496, weighted_loss: 1.1914, label: 0, bag_size: 1289
batch 139, loss: 0.1077, instance_loss: 0.2024, weighted_loss: 0.1361, label: 0, bag_size: 521
batch 159, loss: 0.5607, instance_loss: 0.2929, weighted_loss: 0.4804, label: 1, bag_size: 320
batch 179, loss: 1.5740, instance_loss: 0.5784, weighted_loss: 1.2753, label: 1, bag_size: 1049
batch 199, loss: 0.2208, instance_loss: 0.2831, weighted_loss: 0.2395, label: 0, bag_size: 1247
batch 219, loss: 0.1022, instance_loss: 0.1425, weighted_loss: 0.1143, label: 3, bag_size: 35
batch 239, loss: 0.4385, instance_loss: 0.3328, weighted_loss: 0.4068, label: 2, bag_size: 636
batch 259, loss: 0.0109, instance_loss: 0.1474, weighted_loss: 0.0518, label: 3, bag_size: 16
batch 279, loss: 2.4343, instance_loss: 0.6425, weighted_loss: 1.8967, label: 3, bag_size: 281
batch 299, loss: 0.6620, instance_loss: 0.3423, weighted_loss: 0.5661, label: 0, bag_size: 552
batch 319, loss: 0.6547, instance_loss: 0.2950, weighted_loss: 0.5468, label: 1, bag_size: 965
batch 339, loss: 0.0431, instance_loss: 0.2141, weighted_loss: 0.0944, label: 3, bag_size: 33
batch 359, loss: 1.2964, instance_loss: 0.5606, weighted_loss: 1.0757, label: 2, bag_size: 1167
batch 379, loss: 0.5959, instance_loss: 0.3815, weighted_loss: 0.5316, label: 0, bag_size: 1255
batch 399, loss: 0.3025, instance_loss: 0.2967, weighted_loss: 0.3007, label: 0, bag_size: 476
batch 419, loss: 0.4924, instance_loss: 0.7927, weighted_loss: 0.5825, label: 4, bag_size: 663
batch 439, loss: 0.2967, instance_loss: 0.6817, weighted_loss: 0.4122, label: 4, bag_size: 663
batch 459, loss: 0.2182, instance_loss: 0.2951, weighted_loss: 0.2412, label: 4, bag_size: 19
batch 479, loss: 0.0943, instance_loss: 0.2126, weighted_loss: 0.1298, label: 3, bag_size: 18
batch 499, loss: 0.6082, instance_loss: 0.3683, weighted_loss: 0.5362, label: 2, bag_size: 324
batch 519, loss: 0.0263, instance_loss: 0.2770, weighted_loss: 0.1015, label: 3, bag_size: 18
batch 539, loss: 0.2504, instance_loss: 0.2547, weighted_loss: 0.2517, label: 2, bag_size: 941


class 0 clustering acc 0.9915596330275229: correct 21616/21800
class 1 clustering acc 0.31261467889908257: correct 1363/4360
Epoch: 8, train_loss: 0.6479, train_clustering_loss:  0.3437, train_error: 0.2330
class 0: acc 0.8067226890756303, correct 96/119
class 1: acc 0.6764705882352942, correct 69/102
class 2: acc 0.7264150943396226, correct 77/106
class 3: acc 0.7870370370370371, correct 85/108
class 4: acc 0.8272727272727273, correct 91/110

Val Set, val_loss: 1.1161, val_error: 0.4400, auc: 0.8354
class 0 clustering acc 0.993: correct 1986/2000
class 1 clustering acc 0.14: correct 56/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0394, instance_loss: 0.1184, weighted_loss: 0.0631, label: 3, bag_size: 97
batch 39, loss: 0.2469, instance_loss: 0.3180, weighted_loss: 0.2682, label: 0, bag_size: 731
batch 59, loss: 0.9238, instance_loss: 0.4471, weighted_loss: 0.7808, label: 2, bag_size: 1259
batch 79, loss: 0.9236, instance_loss: 0.5127, weighted_loss: 0.8003, label: 1, bag_size: 1255
batch 99, loss: 0.1413, instance_loss: 0.1488, weighted_loss: 0.1436, label: 3, bag_size: 28
batch 119, loss: 0.0636, instance_loss: 0.0739, weighted_loss: 0.0667, label: 4, bag_size: 137
batch 139, loss: 0.1605, instance_loss: 0.2137, weighted_loss: 0.1765, label: 0, bag_size: 410
batch 159, loss: 0.0650, instance_loss: 0.1824, weighted_loss: 0.1002, label: 0, bag_size: 367
batch 179, loss: 1.5646, instance_loss: 0.6372, weighted_loss: 1.2864, label: 1, bag_size: 936
batch 199, loss: 0.0756, instance_loss: 0.1334, weighted_loss: 0.0929, label: 3, bag_size: 31
batch 219, loss: 0.3662, instance_loss: 0.3973, weighted_loss: 0.3756, label: 2, bag_size: 405
batch 239, loss: 0.1437, instance_loss: 0.1807, weighted_loss: 0.1548, label: 1, bag_size: 1325
batch 259, loss: 0.0875, instance_loss: 0.1073, weighted_loss: 0.0934, label: 1, bag_size: 847
batch 279, loss: 0.9805, instance_loss: 0.4568, weighted_loss: 0.8234, label: 0, bag_size: 1174
batch 299, loss: 2.2568, instance_loss: 0.8252, weighted_loss: 1.8273, label: 2, bag_size: 1178
batch 319, loss: 1.3278, instance_loss: 0.5563, weighted_loss: 1.0963, label: 1, bag_size: 1646
batch 339, loss: 0.2573, instance_loss: 0.2540, weighted_loss: 0.2563, label: 0, bag_size: 807
batch 359, loss: 1.8983, instance_loss: 0.6999, weighted_loss: 1.5388, label: 3, bag_size: 791
batch 379, loss: 3.0896, instance_loss: 0.6997, weighted_loss: 2.3726, label: 1, bag_size: 1376
batch 399, loss: 0.3866, instance_loss: 0.2582, weighted_loss: 0.3480, label: 2, bag_size: 2703
batch 419, loss: 0.1319, instance_loss: 0.1813, weighted_loss: 0.1467, label: 1, bag_size: 944
batch 439, loss: 0.4277, instance_loss: 0.2698, weighted_loss: 0.3803, label: 1, bag_size: 442
batch 459, loss: 0.0403, instance_loss: 0.2345, weighted_loss: 0.0986, label: 3, bag_size: 18
batch 479, loss: 0.5769, instance_loss: 0.2909, weighted_loss: 0.4911, label: 3, bag_size: 1399
batch 499, loss: 0.8057, instance_loss: 0.4100, weighted_loss: 0.6870, label: 0, bag_size: 759
batch 519, loss: 0.3985, instance_loss: 0.2625, weighted_loss: 0.3577, label: 3, bag_size: 405
batch 539, loss: 0.3213, instance_loss: 0.2912, weighted_loss: 0.3122, label: 1, bag_size: 318


class 0 clustering acc 0.9914220183486239: correct 21613/21800
class 1 clustering acc 0.3272935779816514: correct 1427/4360
Epoch: 9, train_loss: 0.5560, train_clustering_loss:  0.3279, train_error: 0.1890
class 0: acc 0.8620689655172413, correct 100/116
class 1: acc 0.75, correct 81/108
class 2: acc 0.7692307692307693, correct 90/117
class 3: acc 0.8380952380952381, correct 88/105
class 4: acc 0.8383838383838383, correct 83/99

Val Set, val_loss: 1.0595, val_error: 0.4800, auc: 0.8275
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.1625: correct 65/400
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
Validation loss decreased (1.084080 --> 1.059498).  Saving model ...


batch 19, loss: 0.1016, instance_loss: 0.0782, weighted_loss: 0.0946, label: 3, bag_size: 1172
batch 39, loss: 1.9498, instance_loss: 0.8061, weighted_loss: 1.6067, label: 2, bag_size: 732
batch 59, loss: 2.1001, instance_loss: 0.6811, weighted_loss: 1.6744, label: 2, bag_size: 324
batch 79, loss: 0.2373, instance_loss: 0.2760, weighted_loss: 0.2489, label: 0, bag_size: 1018
batch 99, loss: 0.1720, instance_loss: 0.2470, weighted_loss: 0.1945, label: 0, bag_size: 542
batch 119, loss: 3.7721, instance_loss: 0.9609, weighted_loss: 2.9288, label: 3, bag_size: 281
batch 139, loss: 0.7023, instance_loss: 0.4384, weighted_loss: 0.6232, label: 2, bag_size: 655
batch 159, loss: 0.3202, instance_loss: 0.1631, weighted_loss: 0.2731, label: 1, bag_size: 399
batch 179, loss: 0.0444, instance_loss: 0.1388, weighted_loss: 0.0727, label: 3, bag_size: 26
batch 199, loss: 0.3268, instance_loss: 0.2659, weighted_loss: 0.3085, label: 4, bag_size: 24
batch 219, loss: 0.0549, instance_loss: 0.2569, weighted_loss: 0.1155, label: 4, bag_size: 168
batch 239, loss: 0.3316, instance_loss: 0.3701, weighted_loss: 0.3431, label: 2, bag_size: 1053
batch 259, loss: 0.3628, instance_loss: 0.7614, weighted_loss: 0.4824, label: 4, bag_size: 882
batch 279, loss: 0.8921, instance_loss: 0.4208, weighted_loss: 0.7507, label: 2, bag_size: 237
batch 299, loss: 0.0417, instance_loss: 0.0753, weighted_loss: 0.0518, label: 3, bag_size: 75
batch 319, loss: 0.0165, instance_loss: 0.0670, weighted_loss: 0.0317, label: 4, bag_size: 168
batch 339, loss: 0.7224, instance_loss: 0.3992, weighted_loss: 0.6254, label: 4, bag_size: 928
batch 359, loss: 0.1414, instance_loss: 0.1360, weighted_loss: 0.1398, label: 3, bag_size: 19
batch 379, loss: 0.0253, instance_loss: 0.0752, weighted_loss: 0.0403, label: 4, bag_size: 192
batch 399, loss: 0.9924, instance_loss: 0.4052, weighted_loss: 0.8163, label: 0, bag_size: 545
batch 419, loss: 0.4479, instance_loss: 0.4440, weighted_loss: 0.4467, label: 1, bag_size: 818
batch 439, loss: 0.4559, instance_loss: 0.3996, weighted_loss: 0.4390, label: 3, bag_size: 230
batch 459, loss: 0.4165, instance_loss: 0.2849, weighted_loss: 0.3770, label: 1, bag_size: 945
batch 479, loss: 0.1293, instance_loss: 0.1808, weighted_loss: 0.1448, label: 0, bag_size: 1247
batch 499, loss: 2.2351, instance_loss: 0.4954, weighted_loss: 1.7132, label: 3, bag_size: 1380
batch 519, loss: 0.0214, instance_loss: 0.0931, weighted_loss: 0.0429, label: 0, bag_size: 1872
batch 539, loss: 1.2926, instance_loss: 0.5145, weighted_loss: 1.0591, label: 2, bag_size: 967


class 0 clustering acc 0.9905045871559633: correct 21593/21800
class 1 clustering acc 0.3759174311926605: correct 1639/4360
Epoch: 10, train_loss: 0.5809, train_clustering_loss:  0.3209, train_error: 0.2037
class 0: acc 0.7766990291262136, correct 80/103
class 1: acc 0.7378640776699029, correct 76/103
class 2: acc 0.7181818181818181, correct 79/110
class 3: acc 0.8865979381443299, correct 86/97
class 4: acc 0.8560606060606061, correct 113/132

Val Set, val_loss: 1.0793, val_error: 0.4800, auc: 0.8428
class 0 clustering acc 0.9925: correct 1985/2000
class 1 clustering acc 0.1475: correct 59/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0125, instance_loss: 0.0665, weighted_loss: 0.0287, label: 4, bag_size: 110
batch 39, loss: 0.0592, instance_loss: 0.1845, weighted_loss: 0.0968, label: 2, bag_size: 913
batch 59, loss: 1.8142, instance_loss: 0.8136, weighted_loss: 1.5140, label: 0, bag_size: 143
batch 79, loss: 1.1036, instance_loss: 0.4486, weighted_loss: 0.9071, label: 2, bag_size: 271
batch 99, loss: 0.0378, instance_loss: 0.1015, weighted_loss: 0.0569, label: 4, bag_size: 140
batch 119, loss: 0.1069, instance_loss: 0.2673, weighted_loss: 0.1550, label: 2, bag_size: 1215
batch 139, loss: 0.0437, instance_loss: 0.0863, weighted_loss: 0.0564, label: 4, bag_size: 96
batch 159, loss: 0.0278, instance_loss: 0.1590, weighted_loss: 0.0672, label: 3, bag_size: 18
batch 179, loss: 0.4351, instance_loss: 0.6814, weighted_loss: 0.5090, label: 0, bag_size: 109
batch 199, loss: 0.0739, instance_loss: 0.1132, weighted_loss: 0.0857, label: 3, bag_size: 18
batch 219, loss: 0.0226, instance_loss: 0.0583, weighted_loss: 0.0333, label: 3, bag_size: 72
batch 239, loss: 0.6855, instance_loss: 0.3829, weighted_loss: 0.5947, label: 2, bag_size: 1410
batch 259, loss: 0.2050, instance_loss: 0.4949, weighted_loss: 0.2919, label: 4, bag_size: 17
batch 279, loss: 1.4564, instance_loss: 0.5593, weighted_loss: 1.1873, label: 1, bag_size: 446
batch 299, loss: 0.3765, instance_loss: 0.3736, weighted_loss: 0.3756, label: 4, bag_size: 656
batch 319, loss: 0.0318, instance_loss: 0.0684, weighted_loss: 0.0428, label: 4, bag_size: 26
batch 339, loss: 1.4617, instance_loss: 0.5316, weighted_loss: 1.1827, label: 2, bag_size: 1231
batch 359, loss: 0.0652, instance_loss: 0.3572, weighted_loss: 0.1528, label: 1, bag_size: 818
batch 379, loss: 3.7845, instance_loss: 1.1137, weighted_loss: 2.9832, label: 3, bag_size: 607
batch 399, loss: 0.5249, instance_loss: 0.4547, weighted_loss: 0.5039, label: 4, bag_size: 754
batch 419, loss: 0.3447, instance_loss: 0.3270, weighted_loss: 0.3394, label: 2, bag_size: 636
batch 439, loss: 0.6324, instance_loss: 0.3270, weighted_loss: 0.5408, label: 1, bag_size: 1255
batch 459, loss: 0.4950, instance_loss: 0.3411, weighted_loss: 0.4488, label: 2, bag_size: 1150
batch 479, loss: 2.1595, instance_loss: 0.5941, weighted_loss: 1.6899, label: 1, bag_size: 1376
batch 499, loss: 0.3588, instance_loss: 0.3698, weighted_loss: 0.3621, label: 2, bag_size: 1289
batch 519, loss: 4.2953, instance_loss: 0.9155, weighted_loss: 3.2813, label: 4, bag_size: 210
batch 539, loss: 0.0189, instance_loss: 0.2883, weighted_loss: 0.0997, label: 4, bag_size: 20


class 0 clustering acc 0.9899082568807339: correct 21580/21800
class 1 clustering acc 0.3688073394495413: correct 1608/4360
Epoch: 11, train_loss: 0.5441, train_clustering_loss:  0.3203, train_error: 0.2092
class 0: acc 0.797979797979798, correct 79/99
class 1: acc 0.7094017094017094, correct 83/117
class 2: acc 0.7115384615384616, correct 74/104
class 3: acc 0.8736842105263158, correct 83/95
class 4: acc 0.8615384615384616, correct 112/130

Val Set, val_loss: 1.1301, val_error: 0.4200, auc: 0.8334
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.18: correct 72/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2545, instance_loss: 0.2268, weighted_loss: 0.2462, label: 4, bag_size: 40
batch 39, loss: 0.2523, instance_loss: 0.5646, weighted_loss: 0.3460, label: 0, bag_size: 129
batch 59, loss: 0.0907, instance_loss: 0.3068, weighted_loss: 0.1555, label: 4, bag_size: 19
batch 79, loss: 0.0236, instance_loss: 0.0744, weighted_loss: 0.0389, label: 4, bag_size: 147
batch 99, loss: 0.0289, instance_loss: 0.1328, weighted_loss: 0.0601, label: 0, bag_size: 478
batch 119, loss: 0.2635, instance_loss: 0.2107, weighted_loss: 0.2476, label: 1, bag_size: 1325
batch 139, loss: 0.3947, instance_loss: 0.4749, weighted_loss: 0.4188, label: 4, bag_size: 1235
batch 159, loss: 0.1846, instance_loss: 0.1911, weighted_loss: 0.1866, label: 1, bag_size: 858
batch 179, loss: 0.0411, instance_loss: 0.0912, weighted_loss: 0.0562, label: 3, bag_size: 43
batch 199, loss: 0.1632, instance_loss: 0.1634, weighted_loss: 0.1633, label: 1, bag_size: 754
batch 219, loss: 0.2021, instance_loss: 0.5680, weighted_loss: 0.3119, label: 4, bag_size: 882
batch 239, loss: 0.0109, instance_loss: 0.0475, weighted_loss: 0.0219, label: 4, bag_size: 104
batch 259, loss: 0.0404, instance_loss: 0.1145, weighted_loss: 0.0626, label: 4, bag_size: 60
batch 279, loss: 1.0068, instance_loss: 0.4264, weighted_loss: 0.8327, label: 0, bag_size: 962
batch 299, loss: 1.7035, instance_loss: 0.6122, weighted_loss: 1.3761, label: 1, bag_size: 1376
batch 319, loss: 0.1435, instance_loss: 0.1284, weighted_loss: 0.1390, label: 1, bag_size: 1325
batch 339, loss: 0.3952, instance_loss: 0.3428, weighted_loss: 0.3795, label: 0, bag_size: 413
batch 359, loss: 0.0694, instance_loss: 0.1645, weighted_loss: 0.0980, label: 3, bag_size: 28
batch 379, loss: 1.3700, instance_loss: 0.4958, weighted_loss: 1.1077, label: 2, bag_size: 272
batch 399, loss: 0.0327, instance_loss: 0.0680, weighted_loss: 0.0433, label: 3, bag_size: 29
batch 419, loss: 0.0214, instance_loss: 0.3410, weighted_loss: 0.1173, label: 4, bag_size: 14
batch 439, loss: 0.0074, instance_loss: 0.0891, weighted_loss: 0.0319, label: 4, bag_size: 63
batch 459, loss: 0.4858, instance_loss: 0.3471, weighted_loss: 0.4442, label: 2, bag_size: 265
batch 479, loss: 0.2130, instance_loss: 0.3092, weighted_loss: 0.2419, label: 2, bag_size: 638
batch 499, loss: 2.5443, instance_loss: 0.7130, weighted_loss: 1.9949, label: 2, bag_size: 259
batch 519, loss: 0.0115, instance_loss: 0.1756, weighted_loss: 0.0607, label: 4, bag_size: 168
batch 539, loss: 0.4114, instance_loss: 0.2237, weighted_loss: 0.3551, label: 1, bag_size: 847


class 0 clustering acc 0.9904587155963303: correct 21592/21800
class 1 clustering acc 0.3628440366972477: correct 1582/4360
Epoch: 12, train_loss: 0.5283, train_clustering_loss:  0.3222, train_error: 0.1927
class 0: acc 0.8686868686868687, correct 86/99
class 1: acc 0.6896551724137931, correct 80/116
class 2: acc 0.711340206185567, correct 69/97
class 3: acc 0.8392857142857143, correct 94/112
class 4: acc 0.9173553719008265, correct 111/121

Val Set, val_loss: 1.0722, val_error: 0.4200, auc: 0.8518
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.155: correct 62/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2566, instance_loss: 0.4823, weighted_loss: 0.3243, label: 3, bag_size: 1380
batch 39, loss: 0.1552, instance_loss: 0.2373, weighted_loss: 0.1798, label: 2, bag_size: 455
batch 59, loss: 0.0061, instance_loss: 0.0553, weighted_loss: 0.0209, label: 4, bag_size: 72
batch 79, loss: 0.0047, instance_loss: 0.0374, weighted_loss: 0.0145, label: 4, bag_size: 104
batch 99, loss: 0.4353, instance_loss: 0.3209, weighted_loss: 0.4010, label: 0, bag_size: 759
batch 119, loss: 0.0178, instance_loss: 0.0991, weighted_loss: 0.0422, label: 4, bag_size: 211
batch 139, loss: 0.1226, instance_loss: 0.2294, weighted_loss: 0.1547, label: 0, bag_size: 410
batch 159, loss: 1.3763, instance_loss: 0.5828, weighted_loss: 1.1383, label: 4, bag_size: 675
batch 179, loss: 0.0792, instance_loss: 0.3178, weighted_loss: 0.1508, label: 4, bag_size: 40
batch 199, loss: 1.1094, instance_loss: 0.4043, weighted_loss: 0.8978, label: 1, bag_size: 139
batch 219, loss: 0.0073, instance_loss: 0.1604, weighted_loss: 0.0533, label: 4, bag_size: 29
batch 239, loss: 0.8832, instance_loss: 0.4077, weighted_loss: 0.7406, label: 1, bag_size: 786
batch 259, loss: 0.0170, instance_loss: 0.0377, weighted_loss: 0.0232, label: 3, bag_size: 46
batch 279, loss: 0.6112, instance_loss: 0.2574, weighted_loss: 0.5051, label: 1, bag_size: 711
batch 299, loss: 0.0480, instance_loss: 0.2504, weighted_loss: 0.1087, label: 4, bag_size: 24
batch 319, loss: 0.1958, instance_loss: 0.2970, weighted_loss: 0.2261, label: 0, bag_size: 476
batch 339, loss: 3.1126, instance_loss: 0.7839, weighted_loss: 2.4139, label: 4, bag_size: 210
batch 359, loss: 0.0194, instance_loss: 0.0917, weighted_loss: 0.0410, label: 3, bag_size: 28
batch 379, loss: 0.0229, instance_loss: 0.1503, weighted_loss: 0.0611, label: 4, bag_size: 47
batch 399, loss: 1.6583, instance_loss: 0.4679, weighted_loss: 1.3012, label: 1, bag_size: 139
batch 419, loss: 0.0650, instance_loss: 0.2576, weighted_loss: 0.1228, label: 3, bag_size: 34
batch 439, loss: 0.1718, instance_loss: 0.5442, weighted_loss: 0.2835, label: 0, bag_size: 128
batch 459, loss: 0.9918, instance_loss: 0.5773, weighted_loss: 0.8675, label: 4, bag_size: 366
batch 479, loss: 0.1272, instance_loss: 0.1149, weighted_loss: 0.1235, label: 1, bag_size: 886
batch 499, loss: 0.1381, instance_loss: 0.1372, weighted_loss: 0.1378, label: 1, bag_size: 288
batch 519, loss: 0.1808, instance_loss: 0.2624, weighted_loss: 0.2053, label: 2, bag_size: 907
batch 539, loss: 0.7407, instance_loss: 0.3647, weighted_loss: 0.6279, label: 0, bag_size: 294


class 0 clustering acc 0.9904128440366973: correct 21591/21800
class 1 clustering acc 0.4087155963302752: correct 1782/4360
Epoch: 13, train_loss: 0.4872, train_clustering_loss:  0.3017, train_error: 0.1706
class 0: acc 0.8679245283018868, correct 92/106
class 1: acc 0.7833333333333333, correct 94/120
class 2: acc 0.7019230769230769, correct 73/104
class 3: acc 0.9230769230769231, correct 96/104
class 4: acc 0.8738738738738738, correct 97/111

Val Set, val_loss: 1.0980, val_error: 0.4000, auc: 0.8304
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.205: correct 82/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2271, instance_loss: 0.1914, weighted_loss: 0.2164, label: 1, bag_size: 847
batch 39, loss: 1.3709, instance_loss: 0.6381, weighted_loss: 1.1511, label: 0, bag_size: 255
batch 59, loss: 0.4125, instance_loss: 0.3768, weighted_loss: 0.4018, label: 2, bag_size: 784
batch 79, loss: 0.4690, instance_loss: 0.3451, weighted_loss: 0.4318, label: 2, bag_size: 358
batch 99, loss: 0.1234, instance_loss: 0.2525, weighted_loss: 0.1621, label: 0, bag_size: 466
batch 119, loss: 0.0096, instance_loss: 0.1081, weighted_loss: 0.0392, label: 0, bag_size: 1012
batch 139, loss: 0.1475, instance_loss: 0.0866, weighted_loss: 0.1292, label: 1, bag_size: 697
batch 159, loss: 0.5177, instance_loss: 0.3316, weighted_loss: 0.4619, label: 2, bag_size: 784
batch 179, loss: 0.0200, instance_loss: 0.0817, weighted_loss: 0.0385, label: 3, bag_size: 20
batch 199, loss: 0.0167, instance_loss: 0.0751, weighted_loss: 0.0342, label: 3, bag_size: 28
batch 219, loss: 0.3390, instance_loss: 0.1587, weighted_loss: 0.2849, label: 3, bag_size: 841
batch 239, loss: 0.2332, instance_loss: 0.3797, weighted_loss: 0.2771, label: 4, bag_size: 524
batch 259, loss: 0.0335, instance_loss: 0.0712, weighted_loss: 0.0448, label: 4, bag_size: 157
batch 279, loss: 0.4429, instance_loss: 0.4015, weighted_loss: 0.4305, label: 4, bag_size: 388
batch 299, loss: 0.1951, instance_loss: 0.2779, weighted_loss: 0.2200, label: 1, bag_size: 968
batch 319, loss: 0.0286, instance_loss: 0.2206, weighted_loss: 0.0862, label: 4, bag_size: 150
batch 339, loss: 0.0425, instance_loss: 0.1026, weighted_loss: 0.0605, label: 4, bag_size: 94
batch 359, loss: 0.7422, instance_loss: 0.3834, weighted_loss: 0.6346, label: 2, bag_size: 508
batch 379, loss: 0.0285, instance_loss: 0.3430, weighted_loss: 0.1228, label: 4, bag_size: 524
batch 399, loss: 0.0093, instance_loss: 0.1396, weighted_loss: 0.0484, label: 4, bag_size: 20
batch 419, loss: 0.0636, instance_loss: 0.2025, weighted_loss: 0.1053, label: 4, bag_size: 28
batch 439, loss: 1.8213, instance_loss: 0.6931, weighted_loss: 1.4828, label: 3, bag_size: 671
batch 459, loss: 0.0446, instance_loss: 0.1489, weighted_loss: 0.0759, label: 0, bag_size: 521
batch 479, loss: 0.1926, instance_loss: 0.4232, weighted_loss: 0.2618, label: 4, bag_size: 974
batch 499, loss: 0.0036, instance_loss: 0.1206, weighted_loss: 0.0387, label: 4, bag_size: 128
batch 519, loss: 0.8884, instance_loss: 0.6060, weighted_loss: 0.8037, label: 2, bag_size: 355
batch 539, loss: 0.0047, instance_loss: 0.0770, weighted_loss: 0.0264, label: 4, bag_size: 79


class 0 clustering acc 0.9896788990825688: correct 21575/21800
class 1 clustering acc 0.4286697247706422: correct 1869/4360
Epoch: 14, train_loss: 0.4879, train_clustering_loss:  0.3053, train_error: 0.1872
class 0: acc 0.8761904761904762, correct 92/105
class 1: acc 0.7154471544715447, correct 88/123
class 2: acc 0.6774193548387096, correct 63/93
class 3: acc 0.8350515463917526, correct 81/97
class 4: acc 0.937007874015748, correct 119/127

Val Set, val_loss: 1.0738, val_error: 0.4200, auc: 0.8384
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.195: correct 78/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.8139, instance_loss: 0.5624, weighted_loss: 1.4385, label: 0, bag_size: 1527
batch 39, loss: 0.0392, instance_loss: 0.1041, weighted_loss: 0.0586, label: 4, bag_size: 192
batch 59, loss: 0.2263, instance_loss: 0.1924, weighted_loss: 0.2161, label: 1, bag_size: 903
batch 79, loss: 0.4799, instance_loss: 0.3556, weighted_loss: 0.4426, label: 2, bag_size: 265
batch 99, loss: 0.9869, instance_loss: 0.5021, weighted_loss: 0.8414, label: 1, bag_size: 1197
batch 119, loss: 1.3856, instance_loss: 0.5582, weighted_loss: 1.1374, label: 1, bag_size: 308
batch 139, loss: 0.4627, instance_loss: 0.4155, weighted_loss: 0.4485, label: 2, bag_size: 542
batch 159, loss: 0.0057, instance_loss: 0.1137, weighted_loss: 0.0381, label: 3, bag_size: 37
batch 179, loss: 0.0418, instance_loss: 0.1568, weighted_loss: 0.0763, label: 0, bag_size: 1143
batch 199, loss: 0.3118, instance_loss: 0.3782, weighted_loss: 0.3317, label: 2, bag_size: 1348
batch 219, loss: 0.5083, instance_loss: 0.3593, weighted_loss: 0.4636, label: 2, bag_size: 1148
batch 239, loss: 0.0165, instance_loss: 0.1946, weighted_loss: 0.0699, label: 4, bag_size: 157
batch 259, loss: 0.0349, instance_loss: 0.0880, weighted_loss: 0.0509, label: 4, bag_size: 162
batch 279, loss: 0.2859, instance_loss: 0.2384, weighted_loss: 0.2717, label: 2, bag_size: 1569
batch 299, loss: 0.0846, instance_loss: 0.1121, weighted_loss: 0.0929, label: 3, bag_size: 78
batch 319, loss: 0.0025, instance_loss: 0.0946, weighted_loss: 0.0302, label: 3, bag_size: 37
batch 339, loss: 0.0676, instance_loss: 0.5131, weighted_loss: 0.2012, label: 0, bag_size: 114
batch 359, loss: 0.5327, instance_loss: 0.3537, weighted_loss: 0.4790, label: 2, bag_size: 741
batch 379, loss: 0.2584, instance_loss: 0.2971, weighted_loss: 0.2700, label: 2, bag_size: 2703
batch 399, loss: 0.4557, instance_loss: 0.3402, weighted_loss: 0.4210, label: 2, bag_size: 725
batch 419, loss: 0.0361, instance_loss: 0.0712, weighted_loss: 0.0467, label: 0, bag_size: 607
batch 439, loss: 0.0034, instance_loss: 0.0362, weighted_loss: 0.0132, label: 4, bag_size: 110
batch 459, loss: 0.0725, instance_loss: 0.2905, weighted_loss: 0.1379, label: 4, bag_size: 823
batch 479, loss: 0.0535, instance_loss: 0.1111, weighted_loss: 0.0708, label: 0, bag_size: 521
batch 499, loss: 1.2702, instance_loss: 0.5721, weighted_loss: 1.0607, label: 1, bag_size: 269
batch 519, loss: 0.0874, instance_loss: 0.1773, weighted_loss: 0.1144, label: 0, bag_size: 1018
batch 539, loss: 0.1934, instance_loss: 0.3279, weighted_loss: 0.2337, label: 2, bag_size: 278


class 0 clustering acc 0.9895412844036697: correct 21572/21800
class 1 clustering acc 0.4103211009174312: correct 1789/4360
Epoch: 15, train_loss: 0.4330, train_clustering_loss:  0.3012, train_error: 0.1505
class 0: acc 0.905982905982906, correct 106/117
class 1: acc 0.7222222222222222, correct 78/108
class 2: acc 0.8018018018018018, correct 89/111
class 3: acc 0.8910891089108911, correct 90/101
class 4: acc 0.9259259259259259, correct 100/108

Val Set, val_loss: 1.0906, val_error: 0.4200, auc: 0.8435
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0676, instance_loss: 0.2195, weighted_loss: 0.1132, label: 0, bag_size: 375
batch 39, loss: 0.3006, instance_loss: 0.3473, weighted_loss: 0.3146, label: 4, bag_size: 790
batch 59, loss: 0.2992, instance_loss: 0.3300, weighted_loss: 0.3085, label: 2, bag_size: 248
batch 79, loss: 0.1346, instance_loss: 0.1675, weighted_loss: 0.1444, label: 3, bag_size: 405
batch 99, loss: 0.1964, instance_loss: 0.4211, weighted_loss: 0.2638, label: 3, bag_size: 343
batch 119, loss: 0.3818, instance_loss: 0.2449, weighted_loss: 0.3407, label: 1, bag_size: 754
batch 139, loss: 0.1157, instance_loss: 0.2521, weighted_loss: 0.1566, label: 2, bag_size: 913
batch 159, loss: 0.0362, instance_loss: 0.1980, weighted_loss: 0.0847, label: 4, bag_size: 40
batch 179, loss: 0.4875, instance_loss: 0.2821, weighted_loss: 0.4259, label: 2, bag_size: 1148
batch 199, loss: 1.6264, instance_loss: 0.8137, weighted_loss: 1.3826, label: 1, bag_size: 1376
batch 219, loss: 0.0534, instance_loss: 0.1303, weighted_loss: 0.0765, label: 0, bag_size: 1143
batch 239, loss: 0.3486, instance_loss: 0.1875, weighted_loss: 0.3003, label: 1, bag_size: 697
batch 259, loss: 0.1310, instance_loss: 0.1004, weighted_loss: 0.1218, label: 1, bag_size: 697
batch 279, loss: 1.8721, instance_loss: 0.7117, weighted_loss: 1.5240, label: 4, bag_size: 366
batch 299, loss: 1.8587, instance_loss: 0.6269, weighted_loss: 1.4891, label: 2, bag_size: 248
batch 319, loss: 0.1284, instance_loss: 0.4106, weighted_loss: 0.2131, label: 4, bag_size: 773
batch 339, loss: 0.0183, instance_loss: 0.0420, weighted_loss: 0.0254, label: 3, bag_size: 54
batch 359, loss: 0.0033, instance_loss: 0.0548, weighted_loss: 0.0188, label: 3, bag_size: 28
batch 379, loss: 0.2089, instance_loss: 0.1858, weighted_loss: 0.2020, label: 1, bag_size: 790
batch 399, loss: 0.0360, instance_loss: 0.0985, weighted_loss: 0.0547, label: 3, bag_size: 78
batch 419, loss: 0.0207, instance_loss: 0.0644, weighted_loss: 0.0338, label: 4, bag_size: 96
batch 439, loss: 0.0026, instance_loss: 0.0606, weighted_loss: 0.0200, label: 3, bag_size: 20
batch 459, loss: 0.0073, instance_loss: 0.1467, weighted_loss: 0.0491, label: 3, bag_size: 20
batch 479, loss: 0.2812, instance_loss: 0.3154, weighted_loss: 0.2915, label: 0, bag_size: 962
batch 499, loss: 0.5871, instance_loss: 0.4138, weighted_loss: 0.5351, label: 4, bag_size: 17
batch 519, loss: 0.3733, instance_loss: 0.4802, weighted_loss: 0.4054, label: 1, bag_size: 917
batch 539, loss: 2.1016, instance_loss: 0.6791, weighted_loss: 1.6748, label: 1, bag_size: 448


class 0 clustering acc 0.9893119266055046: correct 21567/21800
class 1 clustering acc 0.41467889908256883: correct 1808/4360
Epoch: 16, train_loss: 0.4153, train_clustering_loss:  0.3032, train_error: 0.1505
class 0: acc 0.9081632653061225, correct 89/98
class 1: acc 0.7570093457943925, correct 81/107
class 2: acc 0.7522935779816514, correct 82/109
class 3: acc 0.896, correct 112/125
class 4: acc 0.9339622641509434, correct 99/106

Val Set, val_loss: 1.1881, val_error: 0.3800, auc: 0.8445
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2283, instance_loss: 0.1103, weighted_loss: 0.1929, label: 3, bag_size: 556
batch 39, loss: 0.4634, instance_loss: 0.2974, weighted_loss: 0.4136, label: 0, bag_size: 607
batch 59, loss: 0.3394, instance_loss: 0.2780, weighted_loss: 0.3210, label: 1, bag_size: 846
batch 79, loss: 0.0196, instance_loss: 0.0641, weighted_loss: 0.0329, label: 3, bag_size: 41
batch 99, loss: 0.0138, instance_loss: 0.1190, weighted_loss: 0.0454, label: 4, bag_size: 157
batch 119, loss: 0.0945, instance_loss: 0.1070, weighted_loss: 0.0983, label: 3, bag_size: 35
batch 139, loss: 0.3050, instance_loss: 0.1517, weighted_loss: 0.2590, label: 3, bag_size: 1019
batch 159, loss: 0.1295, instance_loss: 0.3808, weighted_loss: 0.2049, label: 4, bag_size: 817
batch 179, loss: 0.0718, instance_loss: 0.4539, weighted_loss: 0.1864, label: 0, bag_size: 109
batch 199, loss: 0.5795, instance_loss: 0.6611, weighted_loss: 0.6040, label: 4, bag_size: 542
batch 219, loss: 0.0318, instance_loss: 0.0459, weighted_loss: 0.0360, label: 4, bag_size: 112
batch 239, loss: 0.0418, instance_loss: 0.1396, weighted_loss: 0.0711, label: 4, bag_size: 192
batch 259, loss: 0.7241, instance_loss: 0.5009, weighted_loss: 0.6571, label: 1, bag_size: 887
batch 279, loss: 0.0038, instance_loss: 0.0325, weighted_loss: 0.0124, label: 3, bag_size: 72
batch 299, loss: 0.0601, instance_loss: 0.1254, weighted_loss: 0.0797, label: 3, bag_size: 316
batch 319, loss: 0.0034, instance_loss: 0.1236, weighted_loss: 0.0394, label: 4, bag_size: 29
batch 339, loss: 0.3181, instance_loss: 0.5080, weighted_loss: 0.3751, label: 4, bag_size: 524
batch 359, loss: 0.0749, instance_loss: 0.1523, weighted_loss: 0.0981, label: 0, bag_size: 1101
batch 379, loss: 0.3084, instance_loss: 0.3110, weighted_loss: 0.3092, label: 2, bag_size: 399
batch 399, loss: 0.0119, instance_loss: 0.1362, weighted_loss: 0.0492, label: 0, bag_size: 1599
batch 419, loss: 0.1258, instance_loss: 0.5988, weighted_loss: 0.2677, label: 0, bag_size: 109
batch 439, loss: 0.0379, instance_loss: 0.3771, weighted_loss: 0.1397, label: 4, bag_size: 24
batch 459, loss: 1.1933, instance_loss: 0.5536, weighted_loss: 1.0014, label: 0, bag_size: 1289
batch 479, loss: 1.6928, instance_loss: 0.5208, weighted_loss: 1.3412, label: 2, bag_size: 324
batch 499, loss: 0.4110, instance_loss: 0.3196, weighted_loss: 0.3836, label: 2, bag_size: 932
batch 519, loss: 4.1282, instance_loss: 0.8564, weighted_loss: 3.1467, label: 4, bag_size: 663
batch 539, loss: 1.0217, instance_loss: 0.3581, weighted_loss: 0.8226, label: 2, bag_size: 1050


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.42637614678899083: correct 1859/4360
Epoch: 17, train_loss: 0.4255, train_clustering_loss:  0.3001, train_error: 0.1578
class 0: acc 0.8842975206611571, correct 107/121
class 1: acc 0.7128712871287128, correct 72/101
class 2: acc 0.7788461538461539, correct 81/104
class 3: acc 0.907563025210084, correct 108/119
class 4: acc 0.91, correct 91/100

Val Set, val_loss: 0.9844, val_error: 0.3800, auc: 0.8664
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.22: correct 88/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
Validation loss decreased (1.059498 --> 0.984383).  Saving model ...


batch 19, loss: 0.0198, instance_loss: 0.0427, weighted_loss: 0.0267, label: 3, bag_size: 60
batch 39, loss: 0.7953, instance_loss: 0.4632, weighted_loss: 0.6957, label: 4, bag_size: 826
batch 59, loss: 0.3764, instance_loss: 0.3184, weighted_loss: 0.3590, label: 0, bag_size: 570
batch 79, loss: 0.0713, instance_loss: 0.2453, weighted_loss: 0.1235, label: 1, bag_size: 866
batch 99, loss: 0.0614, instance_loss: 0.2072, weighted_loss: 0.1052, label: 3, bag_size: 16
batch 119, loss: 0.0027, instance_loss: 0.0858, weighted_loss: 0.0276, label: 4, bag_size: 101
batch 139, loss: 0.0206, instance_loss: 0.0794, weighted_loss: 0.0382, label: 0, bag_size: 1101
batch 159, loss: 0.0074, instance_loss: 0.1000, weighted_loss: 0.0352, label: 4, bag_size: 40
batch 179, loss: 0.5928, instance_loss: 0.5241, weighted_loss: 0.5722, label: 1, bag_size: 533
batch 199, loss: 0.0004, instance_loss: 0.2033, weighted_loss: 0.0613, label: 4, bag_size: 20
batch 219, loss: 0.1454, instance_loss: 0.2970, weighted_loss: 0.1909, label: 2, bag_size: 351
batch 239, loss: 0.5112, instance_loss: 0.3425, weighted_loss: 0.4606, label: 1, bag_size: 470
batch 259, loss: 0.4099, instance_loss: 0.2482, weighted_loss: 0.3614, label: 0, bag_size: 381
batch 279, loss: 0.0066, instance_loss: 0.0888, weighted_loss: 0.0312, label: 3, bag_size: 26
batch 299, loss: 1.3968, instance_loss: 0.6412, weighted_loss: 1.1701, label: 4, bag_size: 675
batch 319, loss: 0.6843, instance_loss: 0.3332, weighted_loss: 0.5789, label: 2, bag_size: 839
batch 339, loss: 1.4108, instance_loss: 0.5188, weighted_loss: 1.1432, label: 1, bag_size: 887
batch 359, loss: 0.1135, instance_loss: 0.5139, weighted_loss: 0.2336, label: 4, bag_size: 297
batch 379, loss: 0.4094, instance_loss: 0.2869, weighted_loss: 0.3727, label: 2, bag_size: 330
batch 399, loss: 0.0322, instance_loss: 0.0578, weighted_loss: 0.0399, label: 1, bag_size: 937
batch 419, loss: 0.3733, instance_loss: 0.3728, weighted_loss: 0.3731, label: 2, bag_size: 1052
batch 439, loss: 0.0142, instance_loss: 0.0348, weighted_loss: 0.0204, label: 3, bag_size: 43
batch 459, loss: 0.0280, instance_loss: 0.2342, weighted_loss: 0.0899, label: 2, bag_size: 707
batch 479, loss: 4.1639, instance_loss: 1.0075, weighted_loss: 3.2170, label: 3, bag_size: 607
batch 499, loss: 0.0452, instance_loss: 0.1536, weighted_loss: 0.0777, label: 3, bag_size: 18
batch 519, loss: 0.0472, instance_loss: 0.2595, weighted_loss: 0.1109, label: 0, bag_size: 110
batch 539, loss: 0.6282, instance_loss: 0.3724, weighted_loss: 0.5515, label: 4, bag_size: 354


class 0 clustering acc 0.9873394495412844: correct 21524/21800
class 1 clustering acc 0.4665137614678899: correct 2034/4360
Epoch: 18, train_loss: 0.3558, train_clustering_loss:  0.2844, train_error: 0.1229
class 0: acc 0.9724770642201835, correct 106/109
class 1: acc 0.723404255319149, correct 68/94
class 2: acc 0.8205128205128205, correct 96/117
class 3: acc 0.9292035398230089, correct 105/113
class 4: acc 0.9196428571428571, correct 103/112

Val Set, val_loss: 1.1161, val_error: 0.4600, auc: 0.8307
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.2711, instance_loss: 0.6612, weighted_loss: 1.7882, label: 2, bag_size: 319
batch 39, loss: 0.0693, instance_loss: 0.1423, weighted_loss: 0.0912, label: 4, bag_size: 157
batch 59, loss: 0.5128, instance_loss: 0.3463, weighted_loss: 0.4628, label: 1, bag_size: 242
batch 79, loss: 0.0693, instance_loss: 0.2072, weighted_loss: 0.1107, label: 4, bag_size: 38
batch 99, loss: 0.0030, instance_loss: 0.1217, weighted_loss: 0.0386, label: 3, bag_size: 18
batch 119, loss: 0.2015, instance_loss: 0.5216, weighted_loss: 0.2976, label: 4, bag_size: 754
batch 139, loss: 1.1119, instance_loss: 0.5519, weighted_loss: 0.9439, label: 2, bag_size: 758
batch 159, loss: 0.0777, instance_loss: 0.1421, weighted_loss: 0.0970, label: 2, bag_size: 399
batch 179, loss: 1.0505, instance_loss: 0.5202, weighted_loss: 0.8914, label: 1, bag_size: 1646
batch 199, loss: 0.0104, instance_loss: 0.0332, weighted_loss: 0.0172, label: 4, bag_size: 157
batch 219, loss: 0.1975, instance_loss: 0.4880, weighted_loss: 0.2847, label: 2, bag_size: 330
batch 239, loss: 0.1244, instance_loss: 0.0860, weighted_loss: 0.1129, label: 3, bag_size: 556
batch 259, loss: 0.1332, instance_loss: 0.1833, weighted_loss: 0.1482, label: 2, bag_size: 913
batch 279, loss: 0.3582, instance_loss: 0.3806, weighted_loss: 0.3649, label: 3, bag_size: 343
batch 299, loss: 0.2080, instance_loss: 0.2554, weighted_loss: 0.2222, label: 2, bag_size: 237
batch 319, loss: 0.0076, instance_loss: 0.0447, weighted_loss: 0.0188, label: 4, bag_size: 130
batch 339, loss: 2.0493, instance_loss: 0.7275, weighted_loss: 1.6527, label: 1, bag_size: 446
batch 359, loss: 0.0427, instance_loss: 0.3462, weighted_loss: 0.1337, label: 0, bag_size: 109
batch 379, loss: 1.8481, instance_loss: 0.4571, weighted_loss: 1.4308, label: 1, bag_size: 917
batch 399, loss: 0.0626, instance_loss: 0.1347, weighted_loss: 0.0842, label: 1, bag_size: 442
batch 419, loss: 0.2542, instance_loss: 0.3881, weighted_loss: 0.2944, label: 2, bag_size: 259
batch 439, loss: 0.2143, instance_loss: 0.2926, weighted_loss: 0.2378, label: 0, bag_size: 515
batch 459, loss: 0.0152, instance_loss: 0.1470, weighted_loss: 0.0547, label: 3, bag_size: 18
batch 479, loss: 1.6365, instance_loss: 0.5770, weighted_loss: 1.3187, label: 2, bag_size: 356
batch 499, loss: 0.0977, instance_loss: 0.4098, weighted_loss: 0.1913, label: 0, bag_size: 128
batch 519, loss: 0.1507, instance_loss: 0.2663, weighted_loss: 0.1854, label: 1, bag_size: 343
batch 539, loss: 0.4357, instance_loss: 0.4471, weighted_loss: 0.4391, label: 3, bag_size: 230


class 0 clustering acc 0.986651376146789: correct 21509/21800
class 1 clustering acc 0.4442660550458716: correct 1937/4360
Epoch: 19, train_loss: 0.3794, train_clustering_loss:  0.2989, train_error: 0.1413
class 0: acc 0.9122807017543859, correct 104/114
class 1: acc 0.8091603053435115, correct 106/131
class 2: acc 0.7685185185185185, correct 83/108
class 3: acc 0.9, correct 81/90
class 4: acc 0.9215686274509803, correct 94/102

Val Set, val_loss: 1.2011, val_error: 0.4200, auc: 0.8262
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0679, instance_loss: 0.2218, weighted_loss: 0.1141, label: 2, bag_size: 907
batch 39, loss: 0.2595, instance_loss: 0.3445, weighted_loss: 0.2850, label: 0, bag_size: 962
batch 59, loss: 0.0218, instance_loss: 0.0697, weighted_loss: 0.0362, label: 0, bag_size: 1135
batch 79, loss: 0.2238, instance_loss: 0.2721, weighted_loss: 0.2383, label: 2, bag_size: 265
batch 99, loss: 0.0131, instance_loss: 0.2218, weighted_loss: 0.0757, label: 3, bag_size: 16
batch 119, loss: 0.8240, instance_loss: 0.4216, weighted_loss: 0.7033, label: 0, bag_size: 1527
batch 139, loss: 0.2750, instance_loss: 0.2432, weighted_loss: 0.2654, label: 1, bag_size: 754
batch 159, loss: 0.3880, instance_loss: 0.3435, weighted_loss: 0.3746, label: 2, bag_size: 1200
batch 179, loss: 0.0587, instance_loss: 0.1325, weighted_loss: 0.0809, label: 0, bag_size: 446
batch 199, loss: 0.0030, instance_loss: 0.0922, weighted_loss: 0.0298, label: 3, bag_size: 18
batch 219, loss: 0.7103, instance_loss: 0.6095, weighted_loss: 0.6801, label: 3, bag_size: 317
batch 239, loss: 0.1677, instance_loss: 0.2692, weighted_loss: 0.1981, label: 2, bag_size: 1404
batch 259, loss: 0.0126, instance_loss: 0.2213, weighted_loss: 0.0752, label: 4, bag_size: 63
batch 279, loss: 0.0031, instance_loss: 0.0807, weighted_loss: 0.0264, label: 4, bag_size: 150
batch 299, loss: 0.0033, instance_loss: 0.3752, weighted_loss: 0.1149, label: 4, bag_size: 17
batch 319, loss: 0.4095, instance_loss: 0.4239, weighted_loss: 0.4138, label: 4, bag_size: 826
batch 339, loss: 0.3408, instance_loss: 0.2620, weighted_loss: 0.3172, label: 2, bag_size: 1200
batch 359, loss: 0.0007, instance_loss: 0.0763, weighted_loss: 0.0234, label: 4, bag_size: 78
batch 379, loss: 0.0075, instance_loss: 0.1314, weighted_loss: 0.0447, label: 4, bag_size: 86
batch 399, loss: 0.0236, instance_loss: 0.2991, weighted_loss: 0.1062, label: 4, bag_size: 19
batch 419, loss: 0.0195, instance_loss: 0.3903, weighted_loss: 0.1308, label: 4, bag_size: 17
batch 439, loss: 2.2553, instance_loss: 0.7515, weighted_loss: 1.8042, label: 0, bag_size: 282
batch 459, loss: 0.1062, instance_loss: 0.0718, weighted_loss: 0.0959, label: 1, bag_size: 697
batch 479, loss: 0.0171, instance_loss: 0.2310, weighted_loss: 0.0813, label: 0, bag_size: 176
batch 499, loss: 0.5196, instance_loss: 0.3593, weighted_loss: 0.4715, label: 2, bag_size: 391
batch 519, loss: 0.0044, instance_loss: 0.0860, weighted_loss: 0.0289, label: 4, bag_size: 130
batch 539, loss: 1.0035, instance_loss: 0.4311, weighted_loss: 0.8318, label: 0, bag_size: 1065


class 0 clustering acc 0.988165137614679: correct 21542/21800
class 1 clustering acc 0.4555045871559633: correct 1986/4360
Epoch: 20, train_loss: 0.3332, train_clustering_loss:  0.2833, train_error: 0.1064
class 0: acc 0.8785046728971962, correct 94/107
class 1: acc 0.8623853211009175, correct 94/109
class 2: acc 0.8403361344537815, correct 100/119
class 3: acc 0.9591836734693877, correct 94/98
class 4: acc 0.9375, correct 105/112

Val Set, val_loss: 1.1305, val_error: 0.3800, auc: 0.8599
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0070, instance_loss: 0.0565, weighted_loss: 0.0218, label: 0, bag_size: 246
batch 39, loss: 0.0584, instance_loss: 0.1039, weighted_loss: 0.0720, label: 1, bag_size: 1191
batch 59, loss: 0.4458, instance_loss: 0.4814, weighted_loss: 0.4565, label: 0, bag_size: 466
batch 79, loss: 0.0641, instance_loss: 0.2268, weighted_loss: 0.1129, label: 0, bag_size: 255
batch 99, loss: 0.3045, instance_loss: 0.1064, weighted_loss: 0.2451, label: 3, bag_size: 952
batch 119, loss: 0.0053, instance_loss: 0.0706, weighted_loss: 0.0249, label: 4, bag_size: 94
batch 139, loss: 0.0144, instance_loss: 0.1341, weighted_loss: 0.0503, label: 4, bag_size: 178
batch 159, loss: 0.0637, instance_loss: 0.1498, weighted_loss: 0.0895, label: 0, bag_size: 367
batch 179, loss: 0.0044, instance_loss: 0.0539, weighted_loss: 0.0192, label: 0, bag_size: 1466
batch 199, loss: 0.3364, instance_loss: 0.3543, weighted_loss: 0.3418, label: 1, bag_size: 1646
batch 219, loss: 0.1760, instance_loss: 0.7384, weighted_loss: 0.3447, label: 4, bag_size: 436
batch 239, loss: 0.4367, instance_loss: 0.3987, weighted_loss: 0.4253, label: 2, bag_size: 358
batch 259, loss: 0.6376, instance_loss: 0.3973, weighted_loss: 0.5655, label: 2, bag_size: 324
batch 279, loss: 0.0516, instance_loss: 0.0486, weighted_loss: 0.0507, label: 1, bag_size: 697
batch 299, loss: 0.0044, instance_loss: 0.0361, weighted_loss: 0.0139, label: 3, bag_size: 97
batch 319, loss: 1.0279, instance_loss: 0.5961, weighted_loss: 0.8984, label: 1, bag_size: 448
batch 339, loss: 0.3002, instance_loss: 0.2517, weighted_loss: 0.2856, label: 2, bag_size: 913
batch 359, loss: 0.0109, instance_loss: 0.2649, weighted_loss: 0.0871, label: 4, bag_size: 24
batch 379, loss: 0.0317, instance_loss: 0.1902, weighted_loss: 0.0793, label: 2, bag_size: 455
batch 399, loss: 0.3134, instance_loss: 0.2963, weighted_loss: 0.3082, label: 2, bag_size: 237
batch 419, loss: 0.1091, instance_loss: 0.2229, weighted_loss: 0.1433, label: 0, bag_size: 375
batch 439, loss: 0.0307, instance_loss: 0.1075, weighted_loss: 0.0537, label: 1, bag_size: 696
batch 459, loss: 0.2595, instance_loss: 0.3757, weighted_loss: 0.2944, label: 2, bag_size: 395
batch 479, loss: 0.1415, instance_loss: 0.2648, weighted_loss: 0.1785, label: 3, bag_size: 821
batch 499, loss: 0.0864, instance_loss: 0.1647, weighted_loss: 0.1099, label: 3, bag_size: 16
batch 519, loss: 1.4456, instance_loss: 0.5152, weighted_loss: 1.1665, label: 1, bag_size: 778
batch 539, loss: 0.0819, instance_loss: 0.1472, weighted_loss: 0.1015, label: 1, bag_size: 828


class 0 clustering acc 0.9878440366972477: correct 21535/21800
class 1 clustering acc 0.47958715596330276: correct 2091/4360
Epoch: 21, train_loss: 0.3290, train_clustering_loss:  0.2846, train_error: 0.1193
class 0: acc 0.9183673469387755, correct 90/98
class 1: acc 0.7982456140350878, correct 91/114
class 2: acc 0.8073394495412844, correct 88/109
class 3: acc 0.9464285714285714, correct 106/112
class 4: acc 0.9375, correct 105/112

Val Set, val_loss: 1.1516, val_error: 0.4000, auc: 0.8504
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1877, instance_loss: 0.2737, weighted_loss: 0.2135, label: 2, bag_size: 725
batch 39, loss: 0.0167, instance_loss: 0.1552, weighted_loss: 0.0583, label: 3, bag_size: 20
batch 59, loss: 0.0523, instance_loss: 0.1361, weighted_loss: 0.0775, label: 3, bag_size: 75
batch 79, loss: 0.1055, instance_loss: 0.3703, weighted_loss: 0.1850, label: 3, bag_size: 1253
batch 99, loss: 0.0065, instance_loss: 0.2958, weighted_loss: 0.0932, label: 4, bag_size: 20
batch 119, loss: 0.3768, instance_loss: 0.6302, weighted_loss: 0.4528, label: 2, bag_size: 636
batch 139, loss: 0.0228, instance_loss: 0.0713, weighted_loss: 0.0373, label: 3, bag_size: 20
batch 159, loss: 0.0064, instance_loss: 0.2596, weighted_loss: 0.0824, label: 4, bag_size: 63
batch 179, loss: 0.0197, instance_loss: 0.0976, weighted_loss: 0.0431, label: 4, bag_size: 160
batch 199, loss: 0.2744, instance_loss: 0.3167, weighted_loss: 0.2871, label: 2, bag_size: 265
batch 219, loss: 1.1607, instance_loss: 0.5367, weighted_loss: 0.9735, label: 2, bag_size: 679
batch 239, loss: 0.1313, instance_loss: 0.3310, weighted_loss: 0.1912, label: 0, bag_size: 736
batch 259, loss: 0.0063, instance_loss: 0.1766, weighted_loss: 0.0574, label: 3, bag_size: 18
batch 279, loss: 0.2950, instance_loss: 0.1916, weighted_loss: 0.2640, label: 1, bag_size: 288
batch 299, loss: 1.3841, instance_loss: 0.6897, weighted_loss: 1.1758, label: 1, bag_size: 887
batch 319, loss: 0.2173, instance_loss: 0.2321, weighted_loss: 0.2218, label: 1, bag_size: 847
batch 339, loss: 0.1422, instance_loss: 0.1658, weighted_loss: 0.1493, label: 2, bag_size: 270
batch 359, loss: 0.2028, instance_loss: 0.2663, weighted_loss: 0.2218, label: 2, bag_size: 1235
batch 379, loss: 0.0453, instance_loss: 0.1939, weighted_loss: 0.0899, label: 0, bag_size: 340
batch 399, loss: 0.0357, instance_loss: 0.1080, weighted_loss: 0.0574, label: 0, bag_size: 552
batch 419, loss: 1.3542, instance_loss: 0.5193, weighted_loss: 1.1037, label: 2, bag_size: 959
batch 439, loss: 0.1623, instance_loss: 0.2855, weighted_loss: 0.1993, label: 2, bag_size: 1053
batch 459, loss: 0.0043, instance_loss: 0.1081, weighted_loss: 0.0354, label: 3, bag_size: 18
batch 479, loss: 0.0704, instance_loss: 0.2484, weighted_loss: 0.1238, label: 0, bag_size: 413
batch 499, loss: 0.0013, instance_loss: 0.0377, weighted_loss: 0.0122, label: 0, bag_size: 239
batch 519, loss: 0.0073, instance_loss: 0.4353, weighted_loss: 0.1357, label: 1, bag_size: 818
batch 539, loss: 0.1279, instance_loss: 0.2151, weighted_loss: 0.1541, label: 0, bag_size: 545


class 0 clustering acc 0.9875688073394495: correct 21529/21800
class 1 clustering acc 0.5178899082568807: correct 2258/4360
Epoch: 22, train_loss: 0.3193, train_clustering_loss:  0.2685, train_error: 0.1229
class 0: acc 0.9026548672566371, correct 102/113
class 1: acc 0.7870370370370371, correct 85/108
class 2: acc 0.7916666666666666, correct 95/120
class 3: acc 0.9591836734693877, correct 94/98
class 4: acc 0.9622641509433962, correct 102/106

Val Set, val_loss: 1.0787, val_error: 0.3800, auc: 0.8562
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0022, instance_loss: 0.0217, weighted_loss: 0.0081, label: 4, bag_size: 162
batch 39, loss: 0.0019, instance_loss: 0.0695, weighted_loss: 0.0222, label: 3, bag_size: 20
batch 59, loss: 0.3509, instance_loss: 0.2043, weighted_loss: 0.3069, label: 3, bag_size: 697
batch 79, loss: 0.0044, instance_loss: 0.1572, weighted_loss: 0.0502, label: 4, bag_size: 40
batch 99, loss: 0.0522, instance_loss: 0.2684, weighted_loss: 0.1170, label: 0, bag_size: 1301
batch 119, loss: 0.0513, instance_loss: 0.1536, weighted_loss: 0.0820, label: 1, bag_size: 858
batch 139, loss: 0.0312, instance_loss: 0.0669, weighted_loss: 0.0419, label: 4, bag_size: 182
batch 159, loss: 0.2194, instance_loss: 0.1462, weighted_loss: 0.1974, label: 1, bag_size: 746
batch 179, loss: 0.0941, instance_loss: 0.1714, weighted_loss: 0.1173, label: 1, bag_size: 1325
batch 199, loss: 0.1884, instance_loss: 0.6592, weighted_loss: 0.3297, label: 3, bag_size: 317
batch 219, loss: 0.3912, instance_loss: 0.3010, weighted_loss: 0.3642, label: 1, bag_size: 860
batch 239, loss: 0.0030, instance_loss: 0.1588, weighted_loss: 0.0497, label: 3, bag_size: 16
batch 259, loss: 0.1914, instance_loss: 0.2256, weighted_loss: 0.2017, label: 2, bag_size: 237
batch 279, loss: 0.1766, instance_loss: 0.4093, weighted_loss: 0.2464, label: 1, bag_size: 102
batch 299, loss: 0.0015, instance_loss: 0.0146, weighted_loss: 0.0054, label: 3, bag_size: 46
batch 319, loss: 0.0195, instance_loss: 0.1710, weighted_loss: 0.0650, label: 1, bag_size: 890
batch 339, loss: 0.0092, instance_loss: 0.0924, weighted_loss: 0.0342, label: 3, bag_size: 28
batch 359, loss: 0.8863, instance_loss: 0.4403, weighted_loss: 0.7525, label: 1, bag_size: 377
batch 379, loss: 0.8355, instance_loss: 0.4262, weighted_loss: 0.7127, label: 2, bag_size: 774
batch 399, loss: 0.4733, instance_loss: 0.2994, weighted_loss: 0.4212, label: 2, bag_size: 567
batch 419, loss: 0.1500, instance_loss: 0.2224, weighted_loss: 0.1717, label: 2, bag_size: 265
batch 439, loss: 0.0044, instance_loss: 0.0586, weighted_loss: 0.0207, label: 0, bag_size: 898
batch 459, loss: 0.1080, instance_loss: 0.2374, weighted_loss: 0.1468, label: 0, bag_size: 552
batch 479, loss: 0.0024, instance_loss: 0.2112, weighted_loss: 0.0650, label: 4, bag_size: 20
batch 499, loss: 0.1681, instance_loss: 0.3636, weighted_loss: 0.2267, label: 1, bag_size: 747
batch 519, loss: 0.0122, instance_loss: 0.1799, weighted_loss: 0.0625, label: 3, bag_size: 18
batch 539, loss: 0.0440, instance_loss: 0.0459, weighted_loss: 0.0445, label: 4, bag_size: 39


class 0 clustering acc 0.9867431192660551: correct 21511/21800
class 1 clustering acc 0.5034403669724771: correct 2195/4360
Epoch: 23, train_loss: 0.3121, train_clustering_loss:  0.2782, train_error: 0.1064
class 0: acc 0.8952380952380953, correct 94/105
class 1: acc 0.8198198198198198, correct 91/111
class 2: acc 0.8288288288288288, correct 92/111
class 3: acc 0.9405940594059405, correct 95/101
class 4: acc 0.9829059829059829, correct 115/117

Val Set, val_loss: 1.2422, val_error: 0.4400, auc: 0.8412
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.3175: correct 127/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0008, instance_loss: 0.1608, weighted_loss: 0.0488, label: 3, bag_size: 48
batch 39, loss: 0.0469, instance_loss: 0.5393, weighted_loss: 0.1947, label: 0, bag_size: 129
batch 59, loss: 0.2515, instance_loss: 0.1823, weighted_loss: 0.2307, label: 1, bag_size: 903
batch 79, loss: 0.0521, instance_loss: 0.0700, weighted_loss: 0.0575, label: 1, bag_size: 346
batch 99, loss: 0.2538, instance_loss: 0.4055, weighted_loss: 0.2993, label: 3, bag_size: 791
batch 119, loss: 0.4327, instance_loss: 0.4440, weighted_loss: 0.4361, label: 1, bag_size: 651
batch 139, loss: 0.0064, instance_loss: 0.0716, weighted_loss: 0.0259, label: 0, bag_size: 933
batch 159, loss: 0.1252, instance_loss: 0.2254, weighted_loss: 0.1553, label: 3, bag_size: 1177
batch 179, loss: 0.0044, instance_loss: 0.0259, weighted_loss: 0.0108, label: 3, bag_size: 105
batch 199, loss: 1.3295, instance_loss: 0.5648, weighted_loss: 1.1001, label: 1, bag_size: 1646
batch 219, loss: 0.0059, instance_loss: 0.0993, weighted_loss: 0.0339, label: 3, bag_size: 19
batch 239, loss: 0.1689, instance_loss: 0.3096, weighted_loss: 0.2111, label: 0, bag_size: 432
batch 259, loss: 0.0171, instance_loss: 0.0850, weighted_loss: 0.0375, label: 4, bag_size: 119
batch 279, loss: 0.6403, instance_loss: 0.2936, weighted_loss: 0.5363, label: 0, bag_size: 1332
batch 299, loss: 0.0070, instance_loss: 0.0888, weighted_loss: 0.0316, label: 3, bag_size: 18
batch 319, loss: 0.1685, instance_loss: 0.2663, weighted_loss: 0.1978, label: 2, bag_size: 1289
batch 339, loss: 0.0313, instance_loss: 0.2575, weighted_loss: 0.0991, label: 4, bag_size: 128
batch 359, loss: 0.1656, instance_loss: 0.2159, weighted_loss: 0.1807, label: 1, bag_size: 903
batch 379, loss: 0.0110, instance_loss: 0.0290, weighted_loss: 0.0164, label: 3, bag_size: 123
batch 399, loss: 0.0161, instance_loss: 0.1084, weighted_loss: 0.0438, label: 4, bag_size: 60
batch 419, loss: 0.6990, instance_loss: 0.4768, weighted_loss: 0.6324, label: 0, bag_size: 868
batch 439, loss: 0.0042, instance_loss: 0.0412, weighted_loss: 0.0153, label: 0, bag_size: 246
batch 459, loss: 0.1222, instance_loss: 0.2161, weighted_loss: 0.1504, label: 1, bag_size: 1325
batch 479, loss: 0.0023, instance_loss: 0.0465, weighted_loss: 0.0156, label: 3, bag_size: 32
batch 499, loss: 0.0988, instance_loss: 0.4401, weighted_loss: 0.2012, label: 4, bag_size: 590
batch 519, loss: 0.0981, instance_loss: 0.2796, weighted_loss: 0.1525, label: 1, bag_size: 968
batch 539, loss: 0.4245, instance_loss: 0.3646, weighted_loss: 0.4066, label: 1, bag_size: 470


class 0 clustering acc 0.9853669724770642: correct 21481/21800
class 1 clustering acc 0.48876146788990826: correct 2131/4360
Epoch: 24, train_loss: 0.2976, train_clustering_loss:  0.2809, train_error: 0.0972
class 0: acc 0.9416666666666667, correct 113/120
class 1: acc 0.8532110091743119, correct 93/109
class 2: acc 0.7904761904761904, correct 83/105
class 3: acc 0.9519230769230769, correct 99/104
class 4: acc 0.9719626168224299, correct 104/107

Val Set, val_loss: 1.1162, val_error: 0.4200, auc: 0.8574
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0018, instance_loss: 0.0459, weighted_loss: 0.0150, label: 0, bag_size: 1872
batch 39, loss: 0.0208, instance_loss: 0.3576, weighted_loss: 0.1218, label: 0, bag_size: 122
batch 59, loss: 0.0070, instance_loss: 0.0855, weighted_loss: 0.0305, label: 4, bag_size: 78
batch 79, loss: 0.2875, instance_loss: 0.2615, weighted_loss: 0.2797, label: 1, bag_size: 598
batch 99, loss: 0.0776, instance_loss: 0.2723, weighted_loss: 0.1360, label: 2, bag_size: 252
batch 119, loss: 0.0018, instance_loss: 0.0306, weighted_loss: 0.0105, label: 0, bag_size: 1599
batch 139, loss: 0.0001, instance_loss: 0.1557, weighted_loss: 0.0468, label: 4, bag_size: 30
batch 159, loss: 0.0044, instance_loss: 0.1041, weighted_loss: 0.0343, label: 4, bag_size: 43
batch 179, loss: 0.4616, instance_loss: 0.3941, weighted_loss: 0.4414, label: 1, bag_size: 1273
batch 199, loss: 0.0493, instance_loss: 0.1424, weighted_loss: 0.0772, label: 0, bag_size: 1579
batch 219, loss: 0.0101, instance_loss: 0.0783, weighted_loss: 0.0306, label: 0, bag_size: 1143
batch 239, loss: 0.4648, instance_loss: 0.7165, weighted_loss: 0.5403, label: 1, bag_size: 448
batch 259, loss: 2.1462, instance_loss: 0.6091, weighted_loss: 1.6851, label: 2, bag_size: 248
batch 279, loss: 0.0033, instance_loss: 0.1341, weighted_loss: 0.0426, label: 4, bag_size: 148
batch 299, loss: 1.3611, instance_loss: 0.4538, weighted_loss: 1.0889, label: 2, bag_size: 1050
batch 319, loss: 0.2078, instance_loss: 0.2987, weighted_loss: 0.2351, label: 2, bag_size: 471
batch 339, loss: 0.0002, instance_loss: 0.0189, weighted_loss: 0.0058, label: 4, bag_size: 104
batch 359, loss: 0.0064, instance_loss: 0.0720, weighted_loss: 0.0261, label: 0, bag_size: 246
batch 379, loss: 2.1883, instance_loss: 0.5191, weighted_loss: 1.6875, label: 1, bag_size: 868
batch 399, loss: 1.2907, instance_loss: 0.6438, weighted_loss: 1.0966, label: 1, bag_size: 1144
batch 419, loss: 0.1985, instance_loss: 0.2313, weighted_loss: 0.2083, label: 2, bag_size: 1281
batch 439, loss: 0.3799, instance_loss: 0.2915, weighted_loss: 0.3534, label: 2, bag_size: 1150
batch 459, loss: 0.0378, instance_loss: 0.2070, weighted_loss: 0.0886, label: 3, bag_size: 451
batch 479, loss: 0.0520, instance_loss: 0.1376, weighted_loss: 0.0777, label: 2, bag_size: 1514
batch 499, loss: 0.0148, instance_loss: 0.1014, weighted_loss: 0.0407, label: 0, bag_size: 1143
batch 519, loss: 0.0173, instance_loss: 0.1800, weighted_loss: 0.0662, label: 3, bag_size: 16
batch 539, loss: 0.0175, instance_loss: 0.2001, weighted_loss: 0.0723, label: 0, bag_size: 570


class 0 clustering acc 0.9857339449541285: correct 21489/21800
class 1 clustering acc 0.5064220183486239: correct 2208/4360
Epoch: 25, train_loss: 0.2877, train_clustering_loss:  0.2774, train_error: 0.1083
class 0: acc 0.9107142857142857, correct 102/112
class 1: acc 0.782608695652174, correct 72/92
class 2: acc 0.8661417322834646, correct 110/127
class 3: acc 0.9396551724137931, correct 109/116
class 4: acc 0.9489795918367347, correct 93/98

Val Set, val_loss: 1.1143, val_error: 0.4800, auc: 0.8604
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.2875: correct 115/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.9971, instance_loss: 0.5787, weighted_loss: 0.8716, label: 0, bag_size: 423
batch 39, loss: 0.0299, instance_loss: 0.2311, weighted_loss: 0.0902, label: 3, bag_size: 1118
batch 59, loss: 0.1309, instance_loss: 0.5093, weighted_loss: 0.2444, label: 2, bag_size: 1410
batch 79, loss: 0.0098, instance_loss: 0.8107, weighted_loss: 0.2501, label: 4, bag_size: 882
batch 99, loss: 2.4648, instance_loss: 0.7163, weighted_loss: 1.9402, label: 1, bag_size: 446
batch 119, loss: 0.3707, instance_loss: 0.3253, weighted_loss: 0.3571, label: 2, bag_size: 1289
batch 139, loss: 0.0472, instance_loss: 0.1441, weighted_loss: 0.0762, label: 1, bag_size: 790
batch 159, loss: 0.0243, instance_loss: 0.1109, weighted_loss: 0.0503, label: 2, bag_size: 455
batch 179, loss: 2.2102, instance_loss: 0.8602, weighted_loss: 1.8052, label: 3, bag_size: 607
batch 199, loss: 0.2831, instance_loss: 0.2360, weighted_loss: 0.2690, label: 1, bag_size: 867
batch 219, loss: 0.0011, instance_loss: 0.0657, weighted_loss: 0.0205, label: 4, bag_size: 72
batch 239, loss: 0.5640, instance_loss: 0.4065, weighted_loss: 0.5168, label: 2, bag_size: 1047
batch 259, loss: 0.1216, instance_loss: 0.2070, weighted_loss: 0.1472, label: 2, bag_size: 1180
batch 279, loss: 1.0947, instance_loss: 0.3606, weighted_loss: 0.8745, label: 0, bag_size: 736
batch 299, loss: 0.0052, instance_loss: 0.0411, weighted_loss: 0.0160, label: 3, bag_size: 53
batch 319, loss: 0.2553, instance_loss: 0.3175, weighted_loss: 0.2740, label: 2, bag_size: 1533
batch 339, loss: 0.1197, instance_loss: 0.2154, weighted_loss: 0.1485, label: 1, bag_size: 965
batch 359, loss: 0.0027, instance_loss: 0.1206, weighted_loss: 0.0380, label: 3, bag_size: 34
batch 379, loss: 0.0005, instance_loss: 0.3638, weighted_loss: 0.1095, label: 4, bag_size: 24
batch 399, loss: 0.0740, instance_loss: 0.1999, weighted_loss: 0.1117, label: 1, bag_size: 343
batch 419, loss: 0.0892, instance_loss: 0.1843, weighted_loss: 0.1177, label: 1, bag_size: 945
batch 439, loss: 0.1225, instance_loss: 0.3253, weighted_loss: 0.1833, label: 4, bag_size: 1235
batch 459, loss: 1.7368, instance_loss: 0.6781, weighted_loss: 1.4192, label: 2, bag_size: 1231
batch 479, loss: 0.0633, instance_loss: 0.1793, weighted_loss: 0.0981, label: 1, bag_size: 858
batch 499, loss: 0.0367, instance_loss: 0.0910, weighted_loss: 0.0530, label: 1, bag_size: 346
batch 519, loss: 0.1554, instance_loss: 0.2549, weighted_loss: 0.1853, label: 4, bag_size: 1235
batch 539, loss: 0.0186, instance_loss: 0.0470, weighted_loss: 0.0272, label: 1, bag_size: 286


class 0 clustering acc 0.9852752293577982: correct 21479/21800
class 1 clustering acc 0.49862385321100916: correct 2174/4360
Epoch: 26, train_loss: 0.2725, train_clustering_loss:  0.2819, train_error: 0.1046
class 0: acc 0.9150943396226415, correct 97/106
class 1: acc 0.8558558558558559, correct 95/111
class 2: acc 0.8058252427184466, correct 83/103
class 3: acc 0.9298245614035088, correct 106/114
class 4: acc 0.963963963963964, correct 107/111

Val Set, val_loss: 1.1261, val_error: 0.3800, auc: 0.8520
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0754, instance_loss: 0.4323, weighted_loss: 0.1825, label: 1, bag_size: 1049
batch 39, loss: 0.0406, instance_loss: 0.2341, weighted_loss: 0.0987, label: 2, bag_size: 1235
batch 59, loss: 1.1743, instance_loss: 0.6675, weighted_loss: 1.0223, label: 1, bag_size: 1144
batch 79, loss: 0.0429, instance_loss: 0.1311, weighted_loss: 0.0694, label: 3, bag_size: 24
batch 99, loss: 0.0039, instance_loss: 0.1802, weighted_loss: 0.0568, label: 0, bag_size: 129
batch 119, loss: 0.2553, instance_loss: 0.4374, weighted_loss: 0.3099, label: 2, bag_size: 500
batch 139, loss: 0.1832, instance_loss: 0.3688, weighted_loss: 0.2389, label: 2, bag_size: 1053
batch 159, loss: 0.6482, instance_loss: 0.3770, weighted_loss: 0.5668, label: 1, bag_size: 242
batch 179, loss: 0.0710, instance_loss: 0.3841, weighted_loss: 0.1649, label: 0, bag_size: 736
batch 199, loss: 0.0043, instance_loss: 0.0593, weighted_loss: 0.0208, label: 4, bag_size: 162
batch 219, loss: 0.1936, instance_loss: 0.3440, weighted_loss: 0.2387, label: 0, bag_size: 424
batch 239, loss: 0.0001, instance_loss: 0.0467, weighted_loss: 0.0141, label: 4, bag_size: 114
batch 259, loss: 0.0277, instance_loss: 0.0918, weighted_loss: 0.0470, label: 1, bag_size: 834
batch 279, loss: 0.0672, instance_loss: 0.2609, weighted_loss: 0.1253, label: 2, bag_size: 1200
batch 299, loss: 0.0082, instance_loss: 0.0731, weighted_loss: 0.0277, label: 4, bag_size: 160
batch 319, loss: 0.0016, instance_loss: 0.3055, weighted_loss: 0.0928, label: 1, bag_size: 818
batch 339, loss: 0.8679, instance_loss: 0.7492, weighted_loss: 0.8323, label: 3, bag_size: 281
batch 359, loss: 0.2719, instance_loss: 0.2040, weighted_loss: 0.2515, label: 2, bag_size: 913
batch 379, loss: 0.0142, instance_loss: 0.0702, weighted_loss: 0.0310, label: 1, bag_size: 994
batch 399, loss: 0.0126, instance_loss: 0.0467, weighted_loss: 0.0228, label: 0, bag_size: 521
batch 419, loss: 0.1406, instance_loss: 0.2742, weighted_loss: 0.1807, label: 0, bag_size: 1061
batch 439, loss: 2.0465, instance_loss: 0.6907, weighted_loss: 1.6397, label: 4, bag_size: 826
batch 459, loss: 2.9989, instance_loss: 1.0745, weighted_loss: 2.4216, label: 3, bag_size: 607
batch 479, loss: 0.0014, instance_loss: 0.0689, weighted_loss: 0.0216, label: 4, bag_size: 83
batch 499, loss: 0.1134, instance_loss: 0.1792, weighted_loss: 0.1331, label: 0, bag_size: 990
batch 519, loss: 0.0007, instance_loss: 0.1487, weighted_loss: 0.0451, label: 4, bag_size: 30
batch 539, loss: 0.9141, instance_loss: 0.4461, weighted_loss: 0.7737, label: 0, bag_size: 1065


class 0 clustering acc 0.9851834862385321: correct 21477/21800
class 1 clustering acc 0.511697247706422: correct 2231/4360
Epoch: 27, train_loss: 0.2552, train_clustering_loss:  0.2694, train_error: 0.0881
class 0: acc 0.9385964912280702, correct 107/114
class 1: acc 0.8416666666666667, correct 101/120
class 2: acc 0.8849557522123894, correct 100/113
class 3: acc 0.9509803921568627, correct 97/102
class 4: acc 0.9583333333333334, correct 92/96

Val Set, val_loss: 1.1977, val_error: 0.4200, auc: 0.8606
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.275: correct 110/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0016, instance_loss: 0.0548, weighted_loss: 0.0176, label: 0, bag_size: 1466
batch 39, loss: 0.0019, instance_loss: 0.0535, weighted_loss: 0.0174, label: 4, bag_size: 167
batch 59, loss: 0.0018, instance_loss: 0.0822, weighted_loss: 0.0259, label: 3, bag_size: 18
batch 79, loss: 0.0349, instance_loss: 0.7578, weighted_loss: 0.2518, label: 3, bag_size: 1380
batch 99, loss: 0.0081, instance_loss: 0.1638, weighted_loss: 0.0548, label: 4, bag_size: 51
batch 119, loss: 0.0355, instance_loss: 0.2783, weighted_loss: 0.1084, label: 2, bag_size: 330
batch 139, loss: 0.0086, instance_loss: 0.1541, weighted_loss: 0.0523, label: 0, bag_size: 114
batch 159, loss: 0.0146, instance_loss: 0.0975, weighted_loss: 0.0395, label: 0, bag_size: 552
batch 179, loss: 0.1950, instance_loss: 0.3381, weighted_loss: 0.2379, label: 4, bag_size: 817
batch 199, loss: 0.1380, instance_loss: 0.3048, weighted_loss: 0.1880, label: 2, bag_size: 803
batch 219, loss: 0.0249, instance_loss: 0.2936, weighted_loss: 0.1055, label: 0, bag_size: 163
batch 239, loss: 0.9098, instance_loss: 0.3203, weighted_loss: 0.7329, label: 2, bag_size: 1200
batch 259, loss: 0.0106, instance_loss: 0.1038, weighted_loss: 0.0385, label: 0, bag_size: 446
batch 279, loss: 0.0044, instance_loss: 0.0924, weighted_loss: 0.0308, label: 3, bag_size: 75
batch 299, loss: 1.2267, instance_loss: 0.5833, weighted_loss: 1.0337, label: 2, bag_size: 629
batch 319, loss: 0.4044, instance_loss: 0.4434, weighted_loss: 0.4161, label: 3, bag_size: 230
batch 339, loss: 0.0385, instance_loss: 0.6195, weighted_loss: 0.2128, label: 4, bag_size: 1360
batch 359, loss: 0.0479, instance_loss: 0.1599, weighted_loss: 0.0815, label: 2, bag_size: 935
batch 379, loss: 0.0725, instance_loss: 0.2218, weighted_loss: 0.1173, label: 2, bag_size: 358
batch 399, loss: 0.0707, instance_loss: 0.1888, weighted_loss: 0.1061, label: 2, bag_size: 404
batch 419, loss: 0.0641, instance_loss: 0.4331, weighted_loss: 0.1748, label: 4, bag_size: 297
batch 439, loss: 0.0298, instance_loss: 0.2202, weighted_loss: 0.0869, label: 1, bag_size: 405
batch 459, loss: 0.7032, instance_loss: 0.4977, weighted_loss: 0.6415, label: 1, bag_size: 868
batch 479, loss: 0.0063, instance_loss: 0.2351, weighted_loss: 0.0749, label: 1, bag_size: 614
batch 499, loss: 1.3113, instance_loss: 0.8961, weighted_loss: 1.1867, label: 3, bag_size: 281
batch 519, loss: 0.0025, instance_loss: 0.0468, weighted_loss: 0.0158, label: 0, bag_size: 653
batch 539, loss: 0.0212, instance_loss: 0.0214, weighted_loss: 0.0212, label: 3, bag_size: 1069


class 0 clustering acc 0.9835321100917431: correct 21441/21800
class 1 clustering acc 0.5350917431192661: correct 2333/4360
Epoch: 28, train_loss: 0.1852, train_clustering_loss:  0.2685, train_error: 0.0679
class 0: acc 0.9619047619047619, correct 101/105
class 1: acc 0.8461538461538461, correct 77/91
class 2: acc 0.8803418803418803, correct 103/117
class 3: acc 0.9646017699115044, correct 109/113
class 4: acc 0.9915966386554622, correct 118/119

Val Set, val_loss: 1.1439, val_error: 0.3800, auc: 0.8558
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.305: correct 122/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1378, instance_loss: 0.2993, weighted_loss: 0.1862, label: 2, bag_size: 259
batch 39, loss: 2.6573, instance_loss: 0.5103, weighted_loss: 2.0132, label: 1, bag_size: 1144
batch 59, loss: 0.0062, instance_loss: 0.1230, weighted_loss: 0.0412, label: 0, bag_size: 255
batch 79, loss: 0.1090, instance_loss: 0.6278, weighted_loss: 0.2646, label: 4, bag_size: 663
batch 99, loss: 0.0080, instance_loss: 0.0928, weighted_loss: 0.0334, label: 0, bag_size: 524
batch 119, loss: 0.1071, instance_loss: 0.1073, weighted_loss: 0.1072, label: 2, bag_size: 977
batch 139, loss: 0.0266, instance_loss: 0.1549, weighted_loss: 0.0651, label: 3, bag_size: 451
batch 159, loss: 0.0053, instance_loss: 0.1180, weighted_loss: 0.0391, label: 3, bag_size: 19
batch 179, loss: 0.0015, instance_loss: 0.0872, weighted_loss: 0.0272, label: 3, bag_size: 24
batch 199, loss: 0.0398, instance_loss: 0.2177, weighted_loss: 0.0931, label: 2, bag_size: 1215
batch 219, loss: 0.0088, instance_loss: 0.1527, weighted_loss: 0.0520, label: 4, bag_size: 55
batch 239, loss: 0.1181, instance_loss: 0.2952, weighted_loss: 0.1712, label: 2, bag_size: 324
batch 259, loss: 0.0993, instance_loss: 0.2146, weighted_loss: 0.1339, label: 0, bag_size: 607
batch 279, loss: 0.2287, instance_loss: 0.2201, weighted_loss: 0.2261, label: 3, bag_size: 841
batch 299, loss: 0.0004, instance_loss: 0.1833, weighted_loss: 0.0553, label: 3, bag_size: 20
batch 319, loss: 0.0036, instance_loss: 0.0685, weighted_loss: 0.0231, label: 4, bag_size: 110
batch 339, loss: 0.7363, instance_loss: 0.5384, weighted_loss: 0.6769, label: 1, bag_size: 470
batch 359, loss: 0.0019, instance_loss: 0.1306, weighted_loss: 0.0405, label: 3, bag_size: 123
batch 379, loss: 0.0199, instance_loss: 0.1306, weighted_loss: 0.0531, label: 3, bag_size: 87
batch 399, loss: 5.7230, instance_loss: 0.5855, weighted_loss: 4.1817, label: 0, bag_size: 466
batch 419, loss: 0.0069, instance_loss: 0.0661, weighted_loss: 0.0247, label: 4, bag_size: 157
batch 439, loss: 0.0023, instance_loss: 0.1904, weighted_loss: 0.0587, label: 4, bag_size: 55
batch 459, loss: 0.0005, instance_loss: 0.0340, weighted_loss: 0.0105, label: 3, bag_size: 43
batch 479, loss: 0.0062, instance_loss: 0.2015, weighted_loss: 0.0648, label: 4, bag_size: 40
batch 499, loss: 0.0919, instance_loss: 0.6081, weighted_loss: 0.2468, label: 1, bag_size: 660
batch 519, loss: 0.2203, instance_loss: 0.2680, weighted_loss: 0.2346, label: 2, bag_size: 391
batch 539, loss: 0.0524, instance_loss: 0.6709, weighted_loss: 0.2380, label: 4, bag_size: 823


class 0 clustering acc 0.9864678899082568: correct 21505/21800
class 1 clustering acc 0.5284403669724771: correct 2304/4360
Epoch: 29, train_loss: 0.2173, train_clustering_loss:  0.2647, train_error: 0.0606
class 0: acc 0.9478260869565217, correct 109/115
class 1: acc 0.8910891089108911, correct 90/101
class 2: acc 0.9, correct 99/110
class 3: acc 0.9545454545454546, correct 105/110
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 1.3118, val_error: 0.4000, auc: 0.8434
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.2725: correct 109/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0007, instance_loss: 0.0213, weighted_loss: 0.0069, label: 3, bag_size: 56
batch 39, loss: 0.0549, instance_loss: 0.2489, weighted_loss: 0.1131, label: 1, bag_size: 754
batch 59, loss: 0.0077, instance_loss: 0.2261, weighted_loss: 0.0732, label: 4, bag_size: 764
batch 79, loss: 0.2975, instance_loss: 0.2510, weighted_loss: 0.2835, label: 2, bag_size: 932
batch 99, loss: 0.0746, instance_loss: 0.3270, weighted_loss: 0.1503, label: 2, bag_size: 500
batch 119, loss: 0.1292, instance_loss: 0.1820, weighted_loss: 0.1451, label: 1, bag_size: 474
batch 139, loss: 0.7206, instance_loss: 0.4961, weighted_loss: 0.6533, label: 1, bag_size: 778
batch 159, loss: 0.0162, instance_loss: 0.2369, weighted_loss: 0.0825, label: 4, bag_size: 974
batch 179, loss: 0.8948, instance_loss: 0.5935, weighted_loss: 0.8044, label: 2, bag_size: 1400
batch 199, loss: 0.0835, instance_loss: 0.4430, weighted_loss: 0.1913, label: 1, bag_size: 1255
batch 219, loss: 0.0181, instance_loss: 0.0626, weighted_loss: 0.0315, label: 3, bag_size: 405
batch 239, loss: 0.2017, instance_loss: 0.4791, weighted_loss: 0.2850, label: 2, bag_size: 774
batch 259, loss: 0.0076, instance_loss: 0.0961, weighted_loss: 0.0341, label: 3, bag_size: 78
batch 279, loss: 0.0300, instance_loss: 0.0798, weighted_loss: 0.0449, label: 1, bag_size: 534
batch 299, loss: 0.0348, instance_loss: 0.1677, weighted_loss: 0.0747, label: 0, bag_size: 1235
batch 319, loss: 2.0941, instance_loss: 0.7231, weighted_loss: 1.6828, label: 0, bag_size: 423
batch 339, loss: 0.0009, instance_loss: 0.0855, weighted_loss: 0.0262, label: 0, bag_size: 239
batch 359, loss: 0.0075, instance_loss: 0.0723, weighted_loss: 0.0270, label: 3, bag_size: 55
batch 379, loss: 0.0047, instance_loss: 0.0931, weighted_loss: 0.0312, label: 4, bag_size: 47
batch 399, loss: 0.0103, instance_loss: 0.1125, weighted_loss: 0.0409, label: 1, bag_size: 690
batch 419, loss: 1.4904, instance_loss: 0.7011, weighted_loss: 1.2536, label: 1, bag_size: 308
batch 439, loss: 0.0214, instance_loss: 0.2724, weighted_loss: 0.0967, label: 0, bag_size: 1135
batch 459, loss: 0.0623, instance_loss: 0.3887, weighted_loss: 0.1602, label: 3, bag_size: 360
batch 479, loss: 0.1157, instance_loss: 0.2185, weighted_loss: 0.1466, label: 2, bag_size: 469
batch 499, loss: 0.5535, instance_loss: 0.5041, weighted_loss: 0.5387, label: 0, bag_size: 423
batch 519, loss: 0.0161, instance_loss: 0.2337, weighted_loss: 0.0814, label: 0, bag_size: 118
batch 539, loss: 0.0007, instance_loss: 0.0270, weighted_loss: 0.0086, label: 3, bag_size: 43


class 0 clustering acc 0.9857798165137615: correct 21490/21800
class 1 clustering acc 0.5204128440366973: correct 2269/4360
Epoch: 30, train_loss: 0.2019, train_clustering_loss:  0.2719, train_error: 0.0569
class 0: acc 0.9292035398230089, correct 105/113
class 1: acc 0.8877551020408163, correct 87/98
class 2: acc 0.953125, correct 122/128
class 3: acc 0.9705882352941176, correct 99/102
class 4: acc 0.9711538461538461, correct 101/104

Val Set, val_loss: 1.3546, val_error: 0.4000, auc: 0.8445
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0039, instance_loss: 0.1234, weighted_loss: 0.0397, label: 0, bag_size: 760
batch 39, loss: 0.1821, instance_loss: 0.2105, weighted_loss: 0.1906, label: 2, bag_size: 391
batch 59, loss: 0.0326, instance_loss: 0.3671, weighted_loss: 0.1330, label: 4, bag_size: 1360
batch 79, loss: 0.0016, instance_loss: 0.1443, weighted_loss: 0.0444, label: 4, bag_size: 947
batch 99, loss: 0.0032, instance_loss: 0.0201, weighted_loss: 0.0083, label: 3, bag_size: 60
batch 119, loss: 0.0085, instance_loss: 0.1166, weighted_loss: 0.0409, label: 0, bag_size: 472
batch 139, loss: 0.0047, instance_loss: 0.3018, weighted_loss: 0.0939, label: 4, bag_size: 23
batch 159, loss: 0.8086, instance_loss: 0.4162, weighted_loss: 0.6909, label: 0, bag_size: 410
batch 179, loss: 0.0778, instance_loss: 0.1795, weighted_loss: 0.1083, label: 2, bag_size: 828
batch 199, loss: 1.1683, instance_loss: 0.6963, weighted_loss: 1.0267, label: 1, bag_size: 139
batch 219, loss: 0.0063, instance_loss: 0.0773, weighted_loss: 0.0276, label: 0, bag_size: 921
batch 239, loss: 0.0048, instance_loss: 0.0902, weighted_loss: 0.0304, label: 4, bag_size: 40
batch 259, loss: 0.1317, instance_loss: 0.3017, weighted_loss: 0.1827, label: 2, bag_size: 1653
batch 279, loss: 0.0011, instance_loss: 0.1034, weighted_loss: 0.0318, label: 4, bag_size: 174
batch 299, loss: 0.0293, instance_loss: 0.3960, weighted_loss: 0.1393, label: 2, bag_size: 1416
batch 319, loss: 0.0120, instance_loss: 0.1158, weighted_loss: 0.0431, label: 0, bag_size: 367
batch 339, loss: 0.0028, instance_loss: 0.4737, weighted_loss: 0.1441, label: 0, bag_size: 122
batch 359, loss: 0.1498, instance_loss: 0.4495, weighted_loss: 0.2397, label: 2, bag_size: 803
batch 379, loss: 0.0014, instance_loss: 0.0719, weighted_loss: 0.0225, label: 0, bag_size: 239
batch 399, loss: 1.4509, instance_loss: 0.4022, weighted_loss: 1.1363, label: 2, bag_size: 272
batch 419, loss: 0.0246, instance_loss: 0.1258, weighted_loss: 0.0549, label: 0, bag_size: 410
batch 439, loss: 0.0113, instance_loss: 0.1540, weighted_loss: 0.0541, label: 4, bag_size: 86
batch 459, loss: 0.3938, instance_loss: 0.5008, weighted_loss: 0.4259, label: 2, bag_size: 471
batch 479, loss: 0.0018, instance_loss: 0.0302, weighted_loss: 0.0104, label: 3, bag_size: 32
batch 499, loss: 0.0632, instance_loss: 0.3396, weighted_loss: 0.1461, label: 1, bag_size: 1014
batch 519, loss: 0.0078, instance_loss: 0.5255, weighted_loss: 0.1631, label: 3, bag_size: 1380
batch 539, loss: 0.3408, instance_loss: 0.3300, weighted_loss: 0.3375, label: 0, bag_size: 423


class 0 clustering acc 0.9854128440366973: correct 21482/21800
class 1 clustering acc 0.5256880733944954: correct 2292/4360
Epoch: 31, train_loss: 0.1967, train_clustering_loss:  0.2746, train_error: 0.0624
class 0: acc 0.9727272727272728, correct 107/110
class 1: acc 0.8712871287128713, correct 88/101
class 2: acc 0.8938053097345132, correct 101/113
class 3: acc 0.9583333333333334, correct 92/96
class 4: acc 0.984, correct 123/125

Val Set, val_loss: 1.1978, val_error: 0.4200, auc: 0.8671
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0022, instance_loss: 0.1017, weighted_loss: 0.0321, label: 3, bag_size: 123
batch 39, loss: 0.1093, instance_loss: 0.2615, weighted_loss: 0.1549, label: 2, bag_size: 262
batch 59, loss: 0.2228, instance_loss: 0.6008, weighted_loss: 0.3362, label: 0, bag_size: 163
batch 79, loss: 0.0008, instance_loss: 0.2268, weighted_loss: 0.0686, label: 1, bag_size: 818
batch 99, loss: 0.0160, instance_loss: 0.2276, weighted_loss: 0.0795, label: 2, bag_size: 345
batch 119, loss: 0.0269, instance_loss: 0.1405, weighted_loss: 0.0610, label: 2, bag_size: 1404
batch 139, loss: 0.0236, instance_loss: 0.2384, weighted_loss: 0.0881, label: 2, bag_size: 701
batch 159, loss: 0.0349, instance_loss: 0.2608, weighted_loss: 0.1026, label: 1, bag_size: 945
batch 179, loss: 0.1162, instance_loss: 0.2235, weighted_loss: 0.1484, label: 3, bag_size: 697
batch 199, loss: 0.4429, instance_loss: 0.4925, weighted_loss: 0.4577, label: 1, bag_size: 139
batch 219, loss: 0.0027, instance_loss: 0.0766, weighted_loss: 0.0249, label: 3, bag_size: 43
batch 239, loss: 0.5533, instance_loss: 0.3462, weighted_loss: 0.4911, label: 1, bag_size: 1144
batch 259, loss: 0.0568, instance_loss: 0.2524, weighted_loss: 0.1155, label: 2, bag_size: 480
batch 279, loss: 0.5046, instance_loss: 0.6974, weighted_loss: 0.5624, label: 4, bag_size: 366
batch 299, loss: 0.0068, instance_loss: 0.0552, weighted_loss: 0.0213, label: 3, bag_size: 78
batch 319, loss: 0.0080, instance_loss: 0.1911, weighted_loss: 0.0629, label: 4, bag_size: 28
batch 339, loss: 0.3902, instance_loss: 0.2685, weighted_loss: 0.3537, label: 4, bag_size: 24
batch 359, loss: 0.0008, instance_loss: 0.1092, weighted_loss: 0.0333, label: 4, bag_size: 91
batch 379, loss: 0.2431, instance_loss: 0.6013, weighted_loss: 0.3505, label: 3, bag_size: 671
batch 399, loss: 0.0552, instance_loss: 0.5149, weighted_loss: 0.1931, label: 4, bag_size: 663
batch 419, loss: 0.0040, instance_loss: 0.0403, weighted_loss: 0.0149, label: 0, bag_size: 616
batch 439, loss: 0.0050, instance_loss: 0.4329, weighted_loss: 0.1334, label: 0, bag_size: 116
batch 459, loss: 0.0936, instance_loss: 0.0852, weighted_loss: 0.0911, label: 1, bag_size: 746
batch 479, loss: 0.0580, instance_loss: 0.1941, weighted_loss: 0.0988, label: 2, bag_size: 469
batch 499, loss: 0.0021, instance_loss: 0.0604, weighted_loss: 0.0196, label: 1, bag_size: 1261
batch 519, loss: 1.0646, instance_loss: 0.6285, weighted_loss: 0.9337, label: 0, bag_size: 282
batch 539, loss: 0.0995, instance_loss: 0.3560, weighted_loss: 0.1765, label: 4, bag_size: 817


class 0 clustering acc 0.9868807339449541: correct 21514/21800
class 1 clustering acc 0.5222477064220183: correct 2277/4360
Epoch: 32, train_loss: 0.2053, train_clustering_loss:  0.2686, train_error: 0.0807
class 0: acc 0.9583333333333334, correct 92/96
class 1: acc 0.8636363636363636, correct 95/110
class 2: acc 0.8584070796460177, correct 97/113
class 3: acc 0.9516129032258065, correct 118/124
class 4: acc 0.9705882352941176, correct 99/102

Val Set, val_loss: 1.2520, val_error: 0.4000, auc: 0.8407
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.2775: correct 111/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0253, instance_loss: 0.2502, weighted_loss: 0.0928, label: 0, bag_size: 760
batch 39, loss: 0.3275, instance_loss: 0.5759, weighted_loss: 0.4020, label: 1, bag_size: 293
batch 59, loss: 0.0528, instance_loss: 0.2477, weighted_loss: 0.1113, label: 1, bag_size: 399
batch 79, loss: 0.5771, instance_loss: 0.6237, weighted_loss: 0.5911, label: 1, bag_size: 446
batch 99, loss: 0.0011, instance_loss: 0.0973, weighted_loss: 0.0300, label: 3, bag_size: 16
batch 119, loss: 5.0061, instance_loss: 1.0003, weighted_loss: 3.8044, label: 2, bag_size: 319
batch 139, loss: 0.0306, instance_loss: 0.1099, weighted_loss: 0.0544, label: 2, bag_size: 455
batch 159, loss: 0.5310, instance_loss: 0.3393, weighted_loss: 0.4735, label: 2, bag_size: 1050
batch 179, loss: 0.2078, instance_loss: 0.2171, weighted_loss: 0.2106, label: 1, bag_size: 903
batch 199, loss: 0.0307, instance_loss: 0.2258, weighted_loss: 0.0892, label: 2, bag_size: 741
batch 219, loss: 0.0171, instance_loss: 0.0602, weighted_loss: 0.0300, label: 1, bag_size: 369
batch 239, loss: 0.0084, instance_loss: 0.1734, weighted_loss: 0.0579, label: 0, bag_size: 1046
batch 259, loss: 0.0487, instance_loss: 0.2345, weighted_loss: 0.1044, label: 0, bag_size: 255
batch 279, loss: 0.0464, instance_loss: 0.5621, weighted_loss: 0.2011, label: 1, bag_size: 1376
batch 299, loss: 0.0159, instance_loss: 0.1047, weighted_loss: 0.0425, label: 1, bag_size: 288
batch 319, loss: 0.0337, instance_loss: 0.0779, weighted_loss: 0.0470, label: 3, bag_size: 54
batch 339, loss: 1.6533, instance_loss: 0.5358, weighted_loss: 1.3180, label: 2, bag_size: 679
batch 359, loss: 0.0007, instance_loss: 0.0674, weighted_loss: 0.0207, label: 4, bag_size: 137
batch 379, loss: 0.0056, instance_loss: 0.1684, weighted_loss: 0.0544, label: 3, bag_size: 35
batch 399, loss: 0.1090, instance_loss: 0.1826, weighted_loss: 0.1311, label: 3, bag_size: 24
batch 419, loss: 0.1711, instance_loss: 0.2336, weighted_loss: 0.1899, label: 1, bag_size: 945
batch 439, loss: 0.0021, instance_loss: 0.1455, weighted_loss: 0.0451, label: 0, bag_size: 118
batch 459, loss: 0.0658, instance_loss: 0.4221, weighted_loss: 0.1727, label: 4, bag_size: 297
batch 479, loss: 0.0190, instance_loss: 0.0509, weighted_loss: 0.0286, label: 3, bag_size: 43
batch 499, loss: 0.1257, instance_loss: 0.2882, weighted_loss: 0.1744, label: 2, bag_size: 910
batch 519, loss: 0.0039, instance_loss: 0.1107, weighted_loss: 0.0359, label: 1, bag_size: 834
batch 539, loss: 0.0009, instance_loss: 0.0283, weighted_loss: 0.0091, label: 4, bag_size: 79


class 0 clustering acc 0.9853211009174312: correct 21480/21800
class 1 clustering acc 0.5254587155963303: correct 2291/4360
Epoch: 33, train_loss: 0.2100, train_clustering_loss:  0.2679, train_error: 0.0679
class 0: acc 0.9306930693069307, correct 94/101
class 1: acc 0.900990099009901, correct 91/101
class 2: acc 0.8725490196078431, correct 89/102
class 3: acc 0.9711538461538461, correct 101/104
class 4: acc 0.9708029197080292, correct 133/137

Val Set, val_loss: 1.4735, val_error: 0.4200, auc: 0.8480
class 0 clustering acc 0.967: correct 1934/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0104, instance_loss: 0.0516, weighted_loss: 0.0228, label: 3, bag_size: 66
batch 39, loss: 0.0002, instance_loss: 0.1112, weighted_loss: 0.0335, label: 3, bag_size: 50
batch 59, loss: 0.2163, instance_loss: 0.3302, weighted_loss: 0.2505, label: 1, bag_size: 470
batch 79, loss: 0.1062, instance_loss: 0.2980, weighted_loss: 0.1638, label: 2, bag_size: 245
batch 99, loss: 0.9334, instance_loss: 0.4520, weighted_loss: 0.7890, label: 1, bag_size: 269
batch 119, loss: 0.2955, instance_loss: 0.4096, weighted_loss: 0.3297, label: 0, bag_size: 255
batch 139, loss: 0.0005, instance_loss: 0.0264, weighted_loss: 0.0083, label: 3, bag_size: 72
batch 159, loss: 0.0059, instance_loss: 0.1161, weighted_loss: 0.0389, label: 3, bag_size: 21
batch 179, loss: 0.0004, instance_loss: 0.1996, weighted_loss: 0.0602, label: 3, bag_size: 841
batch 199, loss: 0.0001, instance_loss: 0.0220, weighted_loss: 0.0067, label: 3, bag_size: 43
batch 219, loss: 0.0010, instance_loss: 0.0412, weighted_loss: 0.0131, label: 3, bag_size: 143
batch 239, loss: 0.3334, instance_loss: 0.4182, weighted_loss: 0.3588, label: 1, bag_size: 139
batch 259, loss: 0.0004, instance_loss: 0.0917, weighted_loss: 0.0278, label: 3, bag_size: 20
batch 279, loss: 0.0009, instance_loss: 0.1871, weighted_loss: 0.0568, label: 4, bag_size: 47
batch 299, loss: 0.6896, instance_loss: 0.6037, weighted_loss: 0.6638, label: 1, bag_size: 747
batch 319, loss: 0.0184, instance_loss: 0.1400, weighted_loss: 0.0549, label: 1, bag_size: 858
batch 339, loss: 0.3447, instance_loss: 0.5399, weighted_loss: 0.4033, label: 1, bag_size: 446
batch 359, loss: 0.0018, instance_loss: 0.0626, weighted_loss: 0.0200, label: 0, bag_size: 898
batch 379, loss: 0.6849, instance_loss: 0.3725, weighted_loss: 0.5912, label: 1, bag_size: 1144
batch 399, loss: 0.0007, instance_loss: 0.2473, weighted_loss: 0.0747, label: 3, bag_size: 18
batch 419, loss: 0.0036, instance_loss: 0.1737, weighted_loss: 0.0546, label: 1, bag_size: 866
batch 439, loss: 0.0008, instance_loss: 0.0584, weighted_loss: 0.0181, label: 0, bag_size: 921
batch 459, loss: 0.0208, instance_loss: 0.1443, weighted_loss: 0.0579, label: 0, bag_size: 990
batch 479, loss: 0.0432, instance_loss: 0.2486, weighted_loss: 0.1048, label: 0, bag_size: 432
batch 499, loss: 0.0076, instance_loss: 0.2892, weighted_loss: 0.0921, label: 0, bag_size: 120
batch 519, loss: 0.0075, instance_loss: 0.2181, weighted_loss: 0.0707, label: 4, bag_size: 35
batch 539, loss: 0.0010, instance_loss: 0.0659, weighted_loss: 0.0205, label: 3, bag_size: 28


class 0 clustering acc 0.9859633027522936: correct 21494/21800
class 1 clustering acc 0.5628440366972477: correct 2454/4360
Epoch: 34, train_loss: 0.1496, train_clustering_loss:  0.2470, train_error: 0.0440
class 0: acc 0.97, correct 97/100
class 1: acc 0.9152542372881356, correct 108/118
class 2: acc 0.90625, correct 87/96
class 3: acc 0.9836065573770492, correct 120/122
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 1.2777, val_error: 0.3800, auc: 0.8520
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0376, instance_loss: 0.2780, weighted_loss: 0.1097, label: 1, bag_size: 1651
batch 39, loss: 0.0266, instance_loss: 0.3490, weighted_loss: 0.1233, label: 2, bag_size: 1416
batch 59, loss: 0.0195, instance_loss: 0.1242, weighted_loss: 0.0509, label: 3, bag_size: 18
batch 79, loss: 0.0007, instance_loss: 0.4183, weighted_loss: 0.1259, label: 4, bag_size: 14
batch 99, loss: 0.0175, instance_loss: 0.3332, weighted_loss: 0.1122, label: 4, bag_size: 928
batch 119, loss: 0.0115, instance_loss: 0.0920, weighted_loss: 0.0356, label: 3, bag_size: 115
batch 139, loss: 5.1298, instance_loss: 0.5430, weighted_loss: 3.7538, label: 2, bag_size: 883
batch 159, loss: 0.2044, instance_loss: 0.6262, weighted_loss: 0.3309, label: 4, bag_size: 1337
batch 179, loss: 0.0036, instance_loss: 0.3802, weighted_loss: 0.1165, label: 1, bag_size: 700
batch 199, loss: 1.4729, instance_loss: 0.5587, weighted_loss: 1.1987, label: 1, bag_size: 657
batch 219, loss: 0.0235, instance_loss: 0.0989, weighted_loss: 0.0461, label: 3, bag_size: 78
batch 239, loss: 0.0282, instance_loss: 0.2609, weighted_loss: 0.0980, label: 1, bag_size: 790
batch 259, loss: 0.0002, instance_loss: 0.1090, weighted_loss: 0.0328, label: 4, bag_size: 39
batch 279, loss: 0.0867, instance_loss: 0.2412, weighted_loss: 0.1331, label: 1, bag_size: 790
batch 299, loss: 0.0566, instance_loss: 0.3044, weighted_loss: 0.1309, label: 2, bag_size: 777
batch 319, loss: 0.0010, instance_loss: 0.0485, weighted_loss: 0.0152, label: 4, bag_size: 192
batch 339, loss: 0.0041, instance_loss: 0.0896, weighted_loss: 0.0297, label: 0, bag_size: 921
batch 359, loss: 0.0002, instance_loss: 0.0425, weighted_loss: 0.0129, label: 4, bag_size: 148
batch 379, loss: 0.0044, instance_loss: 0.3533, weighted_loss: 0.1091, label: 0, bag_size: 129
batch 399, loss: 0.0649, instance_loss: 0.4266, weighted_loss: 0.1734, label: 1, bag_size: 533
batch 419, loss: 0.0263, instance_loss: 0.2828, weighted_loss: 0.1033, label: 0, bag_size: 118
batch 439, loss: 0.0003, instance_loss: 0.0811, weighted_loss: 0.0245, label: 3, bag_size: 20
batch 459, loss: 0.2501, instance_loss: 0.3923, weighted_loss: 0.2927, label: 2, bag_size: 839
batch 479, loss: 0.1482, instance_loss: 0.4610, weighted_loss: 0.2420, label: 2, bag_size: 636
batch 499, loss: 0.0723, instance_loss: 0.2686, weighted_loss: 0.1312, label: 1, bag_size: 860
batch 519, loss: 0.0141, instance_loss: 0.1404, weighted_loss: 0.0520, label: 0, bag_size: 990
batch 539, loss: 0.0847, instance_loss: 0.3230, weighted_loss: 0.1562, label: 1, bag_size: 343


class 0 clustering acc 0.9856880733944954: correct 21488/21800
class 1 clustering acc 0.531651376146789: correct 2318/4360
Epoch: 35, train_loss: 0.1718, train_clustering_loss:  0.2616, train_error: 0.0587
class 0: acc 0.9661016949152542, correct 114/118
class 1: acc 0.8739495798319328, correct 104/119
class 2: acc 0.897196261682243, correct 96/107
class 3: acc 0.9896907216494846, correct 96/97
class 4: acc 0.9903846153846154, correct 103/104

Val Set, val_loss: 1.3600, val_error: 0.4600, auc: 0.8627
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0004, instance_loss: 0.0161, weighted_loss: 0.0051, label: 0, bag_size: 602
batch 39, loss: 0.2650, instance_loss: 0.3402, weighted_loss: 0.2875, label: 1, bag_size: 1559
batch 59, loss: 0.0005, instance_loss: 0.0172, weighted_loss: 0.0055, label: 4, bag_size: 162
batch 79, loss: 0.1077, instance_loss: 0.2308, weighted_loss: 0.1446, label: 2, bag_size: 461
batch 99, loss: 0.0978, instance_loss: 0.2110, weighted_loss: 0.1318, label: 1, bag_size: 903
batch 119, loss: 0.0034, instance_loss: 0.1412, weighted_loss: 0.0447, label: 0, bag_size: 117
batch 139, loss: 0.7037, instance_loss: 1.0366, weighted_loss: 0.8035, label: 4, bag_size: 210
batch 159, loss: 0.0005, instance_loss: 0.2188, weighted_loss: 0.0660, label: 4, bag_size: 35
batch 179, loss: 0.0461, instance_loss: 0.4219, weighted_loss: 0.1589, label: 4, bag_size: 1235
batch 199, loss: 0.0394, instance_loss: 0.1310, weighted_loss: 0.0669, label: 3, bag_size: 16
batch 219, loss: 0.0483, instance_loss: 0.1673, weighted_loss: 0.0840, label: 2, bag_size: 461
batch 239, loss: 1.6834, instance_loss: 0.8967, weighted_loss: 1.4474, label: 3, bag_size: 281
batch 259, loss: 0.0142, instance_loss: 0.2972, weighted_loss: 0.0991, label: 3, bag_size: 18
batch 279, loss: 0.3170, instance_loss: 0.3562, weighted_loss: 0.3288, label: 0, bag_size: 338
batch 299, loss: 0.0002, instance_loss: 0.1211, weighted_loss: 0.0365, label: 4, bag_size: 123
batch 319, loss: 0.0314, instance_loss: 0.0458, weighted_loss: 0.0357, label: 1, bag_size: 1086
batch 339, loss: 2.3728, instance_loss: 0.2920, weighted_loss: 1.7486, label: 2, bag_size: 878
batch 359, loss: 0.0010, instance_loss: 0.1982, weighted_loss: 0.0602, label: 4, bag_size: 47
batch 379, loss: 0.7545, instance_loss: 0.5559, weighted_loss: 0.6949, label: 1, bag_size: 1096
batch 399, loss: 0.0430, instance_loss: 0.1353, weighted_loss: 0.0707, label: 1, bag_size: 1402
batch 419, loss: 0.0098, instance_loss: 0.1068, weighted_loss: 0.0389, label: 3, bag_size: 35
batch 439, loss: 0.0304, instance_loss: 0.1345, weighted_loss: 0.0616, label: 0, bag_size: 375
batch 459, loss: 0.0029, instance_loss: 0.0435, weighted_loss: 0.0151, label: 0, bag_size: 1135
batch 479, loss: 0.9645, instance_loss: 0.8899, weighted_loss: 0.9421, label: 1, bag_size: 936
batch 499, loss: 0.0051, instance_loss: 0.1387, weighted_loss: 0.0452, label: 4, bag_size: 764
batch 519, loss: 0.0010, instance_loss: 0.0837, weighted_loss: 0.0258, label: 0, bag_size: 976
batch 539, loss: 1.2674, instance_loss: 0.2601, weighted_loss: 0.9652, label: 1, bag_size: 1144


class 0 clustering acc 0.9848165137614678: correct 21469/21800
class 1 clustering acc 0.556651376146789: correct 2427/4360
Epoch: 36, train_loss: 0.1692, train_clustering_loss:  0.2585, train_error: 0.0606
class 0: acc 0.9807692307692307, correct 102/104
class 1: acc 0.8865979381443299, correct 86/97
class 2: acc 0.8790322580645161, correct 109/124
class 3: acc 0.9553571428571429, correct 107/112
class 4: acc 1.0, correct 108/108

Val Set, val_loss: 1.3296, val_error: 0.4200, auc: 0.8430
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.31: correct 124/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0449, instance_loss: 0.4657, weighted_loss: 0.1711, label: 0, bag_size: 109
batch 39, loss: 0.0009, instance_loss: 0.0244, weighted_loss: 0.0079, label: 4, bag_size: 137
batch 59, loss: 0.0051, instance_loss: 0.1132, weighted_loss: 0.0375, label: 1, bag_size: 834
batch 79, loss: 0.0902, instance_loss: 0.2614, weighted_loss: 0.1415, label: 2, bag_size: 1128
batch 99, loss: 0.0051, instance_loss: 0.2649, weighted_loss: 0.0831, label: 3, bag_size: 343
batch 119, loss: 0.0455, instance_loss: 0.0962, weighted_loss: 0.0607, label: 3, bag_size: 952
batch 139, loss: 0.1358, instance_loss: 0.3391, weighted_loss: 0.1968, label: 0, bag_size: 990
batch 159, loss: 0.0603, instance_loss: 0.2969, weighted_loss: 0.1313, label: 1, bag_size: 242
batch 179, loss: 1.2196, instance_loss: 0.4055, weighted_loss: 0.9753, label: 0, bag_size: 1289
batch 199, loss: 0.0230, instance_loss: 0.0599, weighted_loss: 0.0341, label: 3, bag_size: 78
batch 219, loss: 0.0036, instance_loss: 0.0464, weighted_loss: 0.0164, label: 4, bag_size: 182
batch 239, loss: 0.5906, instance_loss: 0.8741, weighted_loss: 0.6756, label: 4, bag_size: 210
batch 259, loss: 0.0717, instance_loss: 0.6465, weighted_loss: 0.2441, label: 4, bag_size: 542
batch 279, loss: 0.1587, instance_loss: 0.2090, weighted_loss: 0.1738, label: 1, bag_size: 869
batch 299, loss: 0.0595, instance_loss: 0.4507, weighted_loss: 0.1769, label: 0, bag_size: 1527
batch 319, loss: 0.0079, instance_loss: 0.2767, weighted_loss: 0.0885, label: 4, bag_size: 656
batch 339, loss: 0.0510, instance_loss: 0.2476, weighted_loss: 0.1100, label: 2, bag_size: 324
batch 359, loss: 0.0021, instance_loss: 0.2069, weighted_loss: 0.0635, label: 1, bag_size: 614
batch 379, loss: 0.6923, instance_loss: 0.4642, weighted_loss: 0.6239, label: 0, bag_size: 423
batch 399, loss: 0.0416, instance_loss: 0.3030, weighted_loss: 0.1200, label: 3, bag_size: 230
batch 419, loss: 0.1085, instance_loss: 0.2519, weighted_loss: 0.1516, label: 3, bag_size: 230
batch 439, loss: 0.0334, instance_loss: 0.1915, weighted_loss: 0.0808, label: 2, bag_size: 323
batch 459, loss: 0.0303, instance_loss: 0.2071, weighted_loss: 0.0833, label: 2, bag_size: 480
batch 479, loss: 0.0528, instance_loss: 0.1134, weighted_loss: 0.0710, label: 1, bag_size: 288
batch 499, loss: 0.0288, instance_loss: 0.0364, weighted_loss: 0.0311, label: 3, bag_size: 1172
batch 519, loss: 0.0298, instance_loss: 0.0470, weighted_loss: 0.0350, label: 3, bag_size: 43
batch 539, loss: 0.5090, instance_loss: 0.6312, weighted_loss: 0.5457, label: 1, bag_size: 1197


class 0 clustering acc 0.9857798165137615: correct 21490/21800
class 1 clustering acc 0.55: correct 2398/4360
Epoch: 37, train_loss: 0.1563, train_clustering_loss:  0.2588, train_error: 0.0532
class 0: acc 0.9532710280373832, correct 102/107
class 1: acc 0.9, correct 99/110
class 2: acc 0.9174311926605505, correct 100/109
class 3: acc 0.9587628865979382, correct 93/97
class 4: acc 1.0, correct 122/122

Val Set, val_loss: 1.5034, val_error: 0.4200, auc: 0.8372
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.3175: correct 127/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0004, instance_loss: 0.1182, weighted_loss: 0.0357, label: 3, bag_size: 18
batch 39, loss: 0.0008, instance_loss: 0.1128, weighted_loss: 0.0344, label: 3, bag_size: 18
batch 59, loss: 0.0191, instance_loss: 0.1146, weighted_loss: 0.0478, label: 2, bag_size: 455
batch 79, loss: 0.0022, instance_loss: 0.0611, weighted_loss: 0.0199, label: 1, bag_size: 938
batch 99, loss: 0.0518, instance_loss: 0.1675, weighted_loss: 0.0865, label: 0, bag_size: 962
batch 119, loss: 0.0016, instance_loss: 0.3429, weighted_loss: 0.1040, label: 4, bag_size: 947
batch 139, loss: 0.3665, instance_loss: 0.8006, weighted_loss: 0.4967, label: 1, bag_size: 470
batch 159, loss: 0.0042, instance_loss: 0.2741, weighted_loss: 0.0852, label: 3, bag_size: 16
batch 179, loss: 0.0098, instance_loss: 0.0866, weighted_loss: 0.0328, label: 2, bag_size: 1289
batch 199, loss: 0.0437, instance_loss: 0.2620, weighted_loss: 0.1092, label: 2, bag_size: 861
batch 219, loss: 0.1121, instance_loss: 0.3336, weighted_loss: 0.1785, label: 2, bag_size: 500
batch 239, loss: 0.3072, instance_loss: 0.3315, weighted_loss: 0.3145, label: 1, bag_size: 348
batch 259, loss: 0.0000, instance_loss: 0.0122, weighted_loss: 0.0037, label: 4, bag_size: 157
batch 279, loss: 0.0024, instance_loss: 0.1534, weighted_loss: 0.0477, label: 3, bag_size: 18
batch 299, loss: 0.1193, instance_loss: 0.2170, weighted_loss: 0.1486, label: 2, bag_size: 508
batch 319, loss: 0.0172, instance_loss: 0.2164, weighted_loss: 0.0770, label: 2, bag_size: 202
batch 339, loss: 0.0067, instance_loss: 0.2561, weighted_loss: 0.0815, label: 3, bag_size: 23
batch 359, loss: 0.5334, instance_loss: 0.5824, weighted_loss: 0.5481, label: 1, bag_size: 139
batch 379, loss: 0.0776, instance_loss: 0.2339, weighted_loss: 0.1245, label: 2, bag_size: 499
batch 399, loss: 0.0010, instance_loss: 0.1279, weighted_loss: 0.0391, label: 4, bag_size: 24
batch 419, loss: 0.0634, instance_loss: 0.2705, weighted_loss: 0.1255, label: 2, bag_size: 1133
batch 439, loss: 0.0877, instance_loss: 0.4478, weighted_loss: 0.1957, label: 4, bag_size: 773
batch 459, loss: 0.0315, instance_loss: 0.7213, weighted_loss: 0.2384, label: 4, bag_size: 663
batch 479, loss: 0.0008, instance_loss: 0.1908, weighted_loss: 0.0578, label: 3, bag_size: 28
batch 499, loss: 0.0641, instance_loss: 0.2909, weighted_loss: 0.1321, label: 0, bag_size: 432
batch 519, loss: 0.0528, instance_loss: 0.3856, weighted_loss: 0.1526, label: 2, bag_size: 278
batch 539, loss: 0.1500, instance_loss: 0.5196, weighted_loss: 0.2609, label: 1, bag_size: 778


class 0 clustering acc 0.9854128440366973: correct 21482/21800
class 1 clustering acc 0.5612385321100918: correct 2447/4360
Epoch: 38, train_loss: 0.1439, train_clustering_loss:  0.2573, train_error: 0.0404
class 0: acc 0.9801980198019802, correct 99/101
class 1: acc 0.8921568627450981, correct 91/102
class 2: acc 0.9508196721311475, correct 116/122
class 3: acc 0.9914529914529915, correct 116/117
class 4: acc 0.9805825242718447, correct 101/103

Val Set, val_loss: 1.5517, val_error: 0.4600, auc: 0.8443
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.325: correct 130/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0004, instance_loss: 0.1154, weighted_loss: 0.0349, label: 3, bag_size: 48
batch 39, loss: 0.1195, instance_loss: 0.7517, weighted_loss: 0.3092, label: 3, bag_size: 281
batch 59, loss: 0.0193, instance_loss: 0.3086, weighted_loss: 0.1061, label: 0, bag_size: 116
batch 79, loss: 0.1970, instance_loss: 0.5990, weighted_loss: 0.3176, label: 2, bag_size: 1653
batch 99, loss: 0.0324, instance_loss: 0.1453, weighted_loss: 0.0663, label: 3, bag_size: 697
batch 119, loss: 0.0261, instance_loss: 0.0421, weighted_loss: 0.0309, label: 1, bag_size: 937
batch 139, loss: 0.0119, instance_loss: 0.1557, weighted_loss: 0.0550, label: 3, bag_size: 821
batch 159, loss: 0.1317, instance_loss: 0.3890, weighted_loss: 0.2089, label: 0, bag_size: 200
batch 179, loss: 0.0433, instance_loss: 0.1833, weighted_loss: 0.0853, label: 0, bag_size: 375
batch 199, loss: 0.2362, instance_loss: 0.1767, weighted_loss: 0.2184, label: 1, bag_size: 530
batch 219, loss: 0.0644, instance_loss: 0.3062, weighted_loss: 0.1369, label: 2, bag_size: 1024
batch 239, loss: 0.0034, instance_loss: 0.1866, weighted_loss: 0.0584, label: 3, bag_size: 1019
batch 259, loss: 0.0100, instance_loss: 0.0798, weighted_loss: 0.0310, label: 1, bag_size: 1325
batch 279, loss: 0.0067, instance_loss: 0.1043, weighted_loss: 0.0360, label: 4, bag_size: 182
batch 299, loss: 0.0431, instance_loss: 0.1974, weighted_loss: 0.0894, label: 1, bag_size: 828
batch 319, loss: 0.0175, instance_loss: 0.2555, weighted_loss: 0.0889, label: 2, bag_size: 878
batch 339, loss: 0.0016, instance_loss: 0.2065, weighted_loss: 0.0631, label: 1, bag_size: 890
batch 359, loss: 0.4606, instance_loss: 0.2464, weighted_loss: 0.3964, label: 2, bag_size: 935
batch 379, loss: 0.0365, instance_loss: 0.2147, weighted_loss: 0.0900, label: 2, bag_size: 1133
batch 399, loss: 0.0001, instance_loss: 0.0511, weighted_loss: 0.0154, label: 3, bag_size: 33
batch 419, loss: 0.0037, instance_loss: 0.0777, weighted_loss: 0.0259, label: 0, bag_size: 607
batch 439, loss: 0.0290, instance_loss: 0.2025, weighted_loss: 0.0811, label: 0, bag_size: 1034
batch 459, loss: 0.1201, instance_loss: 0.4130, weighted_loss: 0.2080, label: 0, bag_size: 200
batch 479, loss: 0.0027, instance_loss: 0.0296, weighted_loss: 0.0108, label: 4, bag_size: 43
batch 499, loss: 0.0070, instance_loss: 0.5445, weighted_loss: 0.1682, label: 4, bag_size: 928
batch 519, loss: 0.0712, instance_loss: 0.5942, weighted_loss: 0.2281, label: 1, bag_size: 470
batch 539, loss: 0.1121, instance_loss: 0.3018, weighted_loss: 0.1690, label: 0, bag_size: 868


class 0 clustering acc 0.9845871559633027: correct 21464/21800
class 1 clustering acc 0.5552752293577982: correct 2421/4360
Epoch: 39, train_loss: 0.1161, train_clustering_loss:  0.2547, train_error: 0.0239
class 0: acc 0.990909090909091, correct 109/110
class 1: acc 0.9763779527559056, correct 124/127
class 2: acc 0.9504950495049505, correct 96/101
class 3: acc 0.9724770642201835, correct 106/109
class 4: acc 0.9897959183673469, correct 97/98

Val Set, val_loss: 1.3918, val_error: 0.4400, auc: 0.8637
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.2825: correct 113/400
class 0: acc 1.0, correct 9/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.42105263157894735, correct 8/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0293, instance_loss: 0.3190, weighted_loss: 0.1162, label: 4, bag_size: 24
batch 39, loss: 0.0000, instance_loss: 0.0730, weighted_loss: 0.0219, label: 4, bag_size: 79
batch 59, loss: 0.0052, instance_loss: 0.3445, weighted_loss: 0.1070, label: 0, bag_size: 110
batch 79, loss: 0.9613, instance_loss: 0.5505, weighted_loss: 0.8381, label: 1, bag_size: 657
batch 99, loss: 0.1460, instance_loss: 0.3369, weighted_loss: 0.2033, label: 1, bag_size: 1559
batch 119, loss: 0.0009, instance_loss: 0.2337, weighted_loss: 0.0707, label: 3, bag_size: 16
batch 139, loss: 0.0836, instance_loss: 0.3000, weighted_loss: 0.1485, label: 2, bag_size: 1024
batch 159, loss: 0.0291, instance_loss: 0.2475, weighted_loss: 0.0947, label: 0, bag_size: 1332
batch 179, loss: 0.0044, instance_loss: 0.0562, weighted_loss: 0.0200, label: 0, bag_size: 756
batch 199, loss: 0.0006, instance_loss: 0.0370, weighted_loss: 0.0115, label: 4, bag_size: 83
batch 219, loss: 0.0394, instance_loss: 0.1927, weighted_loss: 0.0854, label: 2, bag_size: 907
batch 239, loss: 0.0013, instance_loss: 0.1202, weighted_loss: 0.0369, label: 0, bag_size: 616
batch 259, loss: 0.0008, instance_loss: 0.1851, weighted_loss: 0.0561, label: 0, bag_size: 110
batch 279, loss: 1.2314, instance_loss: 0.4143, weighted_loss: 0.9863, label: 1, bag_size: 887
batch 299, loss: 0.7245, instance_loss: 0.3930, weighted_loss: 0.6250, label: 2, bag_size: 500
batch 319, loss: 0.0014, instance_loss: 0.0313, weighted_loss: 0.0104, label: 0, bag_size: 1135
batch 339, loss: 0.2131, instance_loss: 0.2381, weighted_loss: 0.2206, label: 2, bag_size: 1050
batch 359, loss: 0.0002, instance_loss: 0.0396, weighted_loss: 0.0120, label: 4, bag_size: 160
batch 379, loss: 0.0681, instance_loss: 0.2487, weighted_loss: 0.1223, label: 1, bag_size: 945
batch 399, loss: 0.0000, instance_loss: 0.0184, weighted_loss: 0.0055, label: 3, bag_size: 115
batch 419, loss: 0.0004, instance_loss: 0.0117, weighted_loss: 0.0038, label: 3, bag_size: 143
batch 439, loss: 0.0001, instance_loss: 0.1938, weighted_loss: 0.0582, label: 4, bag_size: 30
batch 459, loss: 0.0076, instance_loss: 0.0925, weighted_loss: 0.0330, label: 1, bag_size: 834
batch 479, loss: 0.1990, instance_loss: 0.3359, weighted_loss: 0.2401, label: 2, bag_size: 1215
batch 499, loss: 0.0202, instance_loss: 0.1613, weighted_loss: 0.0625, label: 4, bag_size: 40
batch 519, loss: 0.0697, instance_loss: 0.1748, weighted_loss: 0.1012, label: 2, bag_size: 863
batch 539, loss: 0.5909, instance_loss: 0.5239, weighted_loss: 0.5708, label: 4, bag_size: 354


class 0 clustering acc 0.9876146788990826: correct 21530/21800
class 1 clustering acc 0.5846330275229358: correct 2549/4360
Epoch: 40, train_loss: 0.1389, train_clustering_loss:  0.2390, train_error: 0.0459
class 0: acc 0.9906542056074766, correct 106/107
class 1: acc 0.8990825688073395, correct 98/109
class 2: acc 0.9056603773584906, correct 96/106
class 3: acc 0.9724770642201835, correct 106/109
class 4: acc 1.0, correct 114/114

Val Set, val_loss: 1.4326, val_error: 0.3800, auc: 0.8490
class 0 clustering acc 0.9655: correct 1931/2000
class 1 clustering acc 0.3425: correct 137/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.3599, instance_loss: 0.4176, weighted_loss: 0.3773, label: 2, bag_size: 679
batch 39, loss: 0.0300, instance_loss: 0.2282, weighted_loss: 0.0895, label: 2, bag_size: 1052
batch 59, loss: 0.0003, instance_loss: 0.1188, weighted_loss: 0.0358, label: 3, bag_size: 18
batch 79, loss: 0.0216, instance_loss: 0.1445, weighted_loss: 0.0585, label: 1, bag_size: 530
batch 99, loss: 0.0007, instance_loss: 0.0741, weighted_loss: 0.0227, label: 4, bag_size: 150
batch 119, loss: 0.0001, instance_loss: 0.0375, weighted_loss: 0.0113, label: 4, bag_size: 211
batch 139, loss: 0.0002, instance_loss: 0.4831, weighted_loss: 0.1451, label: 1, bag_size: 818
batch 159, loss: 0.0488, instance_loss: 0.2847, weighted_loss: 0.1196, label: 2, bag_size: 511
batch 179, loss: 0.3948, instance_loss: 0.3698, weighted_loss: 0.3873, label: 2, bag_size: 384
batch 199, loss: 0.0022, instance_loss: 0.1554, weighted_loss: 0.0482, label: 3, bag_size: 16
batch 219, loss: 0.0703, instance_loss: 0.3490, weighted_loss: 0.1539, label: 1, bag_size: 242
batch 239, loss: 0.0002, instance_loss: 0.0211, weighted_loss: 0.0065, label: 4, bag_size: 178
batch 259, loss: 0.0021, instance_loss: 0.0748, weighted_loss: 0.0239, label: 0, bag_size: 1235
batch 279, loss: 0.0041, instance_loss: 0.0955, weighted_loss: 0.0315, label: 3, bag_size: 53
batch 299, loss: 0.0004, instance_loss: 0.0777, weighted_loss: 0.0236, label: 4, bag_size: 86
batch 319, loss: 0.0661, instance_loss: 0.1816, weighted_loss: 0.1007, label: 3, bag_size: 1118
batch 339, loss: 0.0112, instance_loss: 0.1077, weighted_loss: 0.0401, label: 4, bag_size: 388
batch 359, loss: 0.3201, instance_loss: 0.4529, weighted_loss: 0.3599, label: 0, bag_size: 718
batch 379, loss: 0.0096, instance_loss: 0.0775, weighted_loss: 0.0300, label: 1, bag_size: 937
batch 399, loss: 0.0038, instance_loss: 0.0624, weighted_loss: 0.0214, label: 3, bag_size: 97
batch 419, loss: 0.9262, instance_loss: 0.5813, weighted_loss: 0.8227, label: 0, bag_size: 718
batch 439, loss: 0.0160, instance_loss: 0.1069, weighted_loss: 0.0433, label: 0, bag_size: 381
batch 459, loss: 0.0603, instance_loss: 0.4669, weighted_loss: 0.1823, label: 4, bag_size: 590
batch 479, loss: 0.0001, instance_loss: 0.0430, weighted_loss: 0.0130, label: 4, bag_size: 78
batch 499, loss: 0.0438, instance_loss: 0.4493, weighted_loss: 0.1655, label: 0, bag_size: 109
batch 519, loss: 0.0646, instance_loss: 0.4429, weighted_loss: 0.1781, label: 2, bag_size: 911
batch 539, loss: 0.0175, instance_loss: 0.1546, weighted_loss: 0.0586, label: 2, bag_size: 2826


class 0 clustering acc 0.9857339449541285: correct 21489/21800
class 1 clustering acc 0.5908256880733945: correct 2576/4360
Epoch: 41, train_loss: 0.1124, train_clustering_loss:  0.2410, train_error: 0.0440
class 0: acc 0.9622641509433962, correct 102/106
class 1: acc 0.9150943396226415, correct 97/106
class 2: acc 0.9166666666666666, correct 99/108
class 3: acc 0.9797979797979798, correct 97/99
class 4: acc 1.0, correct 126/126

Val Set, val_loss: 1.3841, val_error: 0.3800, auc: 0.8531
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.3375: correct 135/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0024, instance_loss: 0.1212, weighted_loss: 0.0380, label: 4, bag_size: 110
batch 39, loss: 0.1741, instance_loss: 0.4553, weighted_loss: 0.2585, label: 0, bag_size: 424
batch 59, loss: 0.5461, instance_loss: 0.3133, weighted_loss: 0.4762, label: 2, bag_size: 883
batch 79, loss: 0.0055, instance_loss: 0.2254, weighted_loss: 0.0714, label: 2, bag_size: 1533
batch 99, loss: 0.0005, instance_loss: 0.1201, weighted_loss: 0.0364, label: 4, bag_size: 524
batch 119, loss: 0.0044, instance_loss: 0.0699, weighted_loss: 0.0240, label: 0, bag_size: 1018
batch 139, loss: 0.1395, instance_loss: 0.3307, weighted_loss: 0.1969, label: 3, bag_size: 936
batch 159, loss: 0.1271, instance_loss: 0.0875, weighted_loss: 0.1152, label: 1, bag_size: 1191
batch 179, loss: 0.5472, instance_loss: 0.4927, weighted_loss: 0.5308, label: 0, bag_size: 1061
batch 199, loss: 0.0094, instance_loss: 0.3544, weighted_loss: 0.1129, label: 4, bag_size: 675
batch 219, loss: 0.1007, instance_loss: 0.3405, weighted_loss: 0.1726, label: 2, bag_size: 1006
batch 239, loss: 0.0088, instance_loss: 0.1563, weighted_loss: 0.0531, label: 1, bag_size: 945
batch 259, loss: 0.2917, instance_loss: 0.4915, weighted_loss: 0.3516, label: 3, bag_size: 360
batch 279, loss: 0.0147, instance_loss: 0.1016, weighted_loss: 0.0408, label: 0, bag_size: 1061
batch 299, loss: 0.1203, instance_loss: 0.2815, weighted_loss: 0.1686, label: 2, bag_size: 265
batch 319, loss: 0.0001, instance_loss: 0.0428, weighted_loss: 0.0129, label: 4, bag_size: 125
batch 339, loss: 0.0922, instance_loss: 0.2342, weighted_loss: 0.1348, label: 2, bag_size: 828
batch 359, loss: 0.0009, instance_loss: 0.0507, weighted_loss: 0.0158, label: 0, bag_size: 933
batch 379, loss: 0.0202, instance_loss: 0.2255, weighted_loss: 0.0818, label: 1, bag_size: 343
batch 399, loss: 0.0349, instance_loss: 0.1672, weighted_loss: 0.0746, label: 3, bag_size: 405
batch 419, loss: 0.0088, instance_loss: 0.4909, weighted_loss: 0.1534, label: 1, bag_size: 1255
batch 439, loss: 0.2894, instance_loss: 0.2686, weighted_loss: 0.2832, label: 2, bag_size: 391
batch 459, loss: 0.0116, instance_loss: 0.3516, weighted_loss: 0.1136, label: 0, bag_size: 155
batch 479, loss: 0.0001, instance_loss: 0.0249, weighted_loss: 0.0076, label: 3, bag_size: 143
batch 499, loss: 0.1198, instance_loss: 0.1954, weighted_loss: 0.1425, label: 0, bag_size: 1332
batch 519, loss: 0.0003, instance_loss: 0.1468, weighted_loss: 0.0442, label: 4, bag_size: 157
batch 539, loss: 0.0010, instance_loss: 0.4060, weighted_loss: 0.1225, label: 4, bag_size: 947


class 0 clustering acc 0.9862844036697248: correct 21501/21800
class 1 clustering acc 0.5681192660550459: correct 2477/4360
Epoch: 42, train_loss: 0.1254, train_clustering_loss:  0.2513, train_error: 0.0349
class 0: acc 0.9886363636363636, correct 87/88
class 1: acc 0.959349593495935, correct 118/123
class 2: acc 0.9210526315789473, correct 105/114
class 3: acc 0.9836065573770492, correct 120/122
class 4: acc 0.9795918367346939, correct 96/98

Val Set, val_loss: 1.7496, val_error: 0.4000, auc: 0.8298
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.33: correct 132/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0139, instance_loss: 0.1725, weighted_loss: 0.0615, label: 2, bag_size: 347
batch 39, loss: 0.9880, instance_loss: 0.5774, weighted_loss: 0.8648, label: 2, bag_size: 629
batch 59, loss: 0.0109, instance_loss: 0.1069, weighted_loss: 0.0397, label: 1, bag_size: 945
batch 79, loss: 0.0654, instance_loss: 0.4223, weighted_loss: 0.1725, label: 1, bag_size: 868
batch 99, loss: 0.0180, instance_loss: 0.1500, weighted_loss: 0.0576, label: 2, bag_size: 848
batch 119, loss: 0.0018, instance_loss: 0.0654, weighted_loss: 0.0209, label: 0, bag_size: 1517
batch 139, loss: 0.0007, instance_loss: 0.0393, weighted_loss: 0.0123, label: 4, bag_size: 150
batch 159, loss: 0.0657, instance_loss: 0.1007, weighted_loss: 0.0762, label: 3, bag_size: 1177
batch 179, loss: 0.2667, instance_loss: 0.4696, weighted_loss: 0.3276, label: 1, bag_size: 139
batch 199, loss: 0.0023, instance_loss: 0.1042, weighted_loss: 0.0329, label: 0, bag_size: 382
batch 219, loss: 0.1278, instance_loss: 0.6121, weighted_loss: 0.2731, label: 1, bag_size: 1376
batch 239, loss: 0.4693, instance_loss: 0.2414, weighted_loss: 0.4009, label: 1, bag_size: 786
batch 259, loss: 0.0001, instance_loss: 0.0369, weighted_loss: 0.0112, label: 4, bag_size: 91
batch 279, loss: 0.0134, instance_loss: 0.2499, weighted_loss: 0.0844, label: 4, bag_size: 524
batch 299, loss: 0.6431, instance_loss: 0.5307, weighted_loss: 0.6094, label: 2, bag_size: 629
batch 319, loss: 0.0967, instance_loss: 0.1633, weighted_loss: 0.1166, label: 2, bag_size: 1148
batch 339, loss: 0.0025, instance_loss: 0.3181, weighted_loss: 0.0972, label: 0, bag_size: 117
batch 359, loss: 0.0774, instance_loss: 0.1288, weighted_loss: 0.0928, label: 3, bag_size: 952
batch 379, loss: 0.0052, instance_loss: 0.4238, weighted_loss: 0.1308, label: 4, bag_size: 14
batch 399, loss: 0.0269, instance_loss: 0.1919, weighted_loss: 0.0764, label: 2, bag_size: 907
batch 419, loss: 0.0083, instance_loss: 0.1934, weighted_loss: 0.0638, label: 0, bag_size: 432
batch 439, loss: 0.0046, instance_loss: 0.1171, weighted_loss: 0.0384, label: 0, bag_size: 731
batch 459, loss: 0.0005, instance_loss: 0.1079, weighted_loss: 0.0328, label: 4, bag_size: 790
batch 479, loss: 0.4851, instance_loss: 0.3772, weighted_loss: 0.4528, label: 0, bag_size: 1527
batch 499, loss: 0.0269, instance_loss: 0.2806, weighted_loss: 0.1030, label: 1, bag_size: 965
batch 519, loss: 0.0002, instance_loss: 0.1119, weighted_loss: 0.0337, label: 3, bag_size: 53
batch 539, loss: 0.0010, instance_loss: 0.1032, weighted_loss: 0.0317, label: 3, bag_size: 16


class 0 clustering acc 0.9844495412844037: correct 21461/21800
class 1 clustering acc 0.5795871559633028: correct 2527/4360
Epoch: 43, train_loss: 0.1121, train_clustering_loss:  0.2477, train_error: 0.0367
class 0: acc 0.9823008849557522, correct 111/113
class 1: acc 0.9191919191919192, correct 91/99
class 2: acc 0.9134615384615384, correct 95/104
class 3: acc 0.9908256880733946, correct 108/109
class 4: acc 1.0, correct 120/120

Val Set, val_loss: 1.4200, val_error: 0.4000, auc: 0.8493
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0008, instance_loss: 0.0522, weighted_loss: 0.0162, label: 3, bag_size: 75
batch 39, loss: 0.0002, instance_loss: 0.0251, weighted_loss: 0.0077, label: 3, bag_size: 28
batch 59, loss: 0.1345, instance_loss: 0.5618, weighted_loss: 0.2627, label: 0, bag_size: 128
batch 79, loss: 0.0001, instance_loss: 0.0169, weighted_loss: 0.0051, label: 4, bag_size: 143
batch 99, loss: 0.1452, instance_loss: 0.3076, weighted_loss: 0.1939, label: 1, bag_size: 965
batch 119, loss: 0.0001, instance_loss: 0.0481, weighted_loss: 0.0145, label: 4, bag_size: 178
batch 139, loss: 0.0053, instance_loss: 0.4529, weighted_loss: 0.1395, label: 1, bag_size: 700
batch 159, loss: 0.0002, instance_loss: 0.0335, weighted_loss: 0.0102, label: 0, bag_size: 1599
batch 179, loss: 0.0218, instance_loss: 0.1689, weighted_loss: 0.0659, label: 0, bag_size: 381
batch 199, loss: 0.0309, instance_loss: 0.2331, weighted_loss: 0.0916, label: 1, bag_size: 1651
batch 219, loss: 1.2511, instance_loss: 0.5945, weighted_loss: 1.0541, label: 1, bag_size: 1096
batch 239, loss: 0.0934, instance_loss: 0.3861, weighted_loss: 0.1812, label: 0, bag_size: 437
batch 259, loss: 0.2453, instance_loss: 0.1704, weighted_loss: 0.2228, label: 3, bag_size: 78
batch 279, loss: 0.0005, instance_loss: 0.0593, weighted_loss: 0.0182, label: 0, bag_size: 616
batch 299, loss: 0.0029, instance_loss: 0.2669, weighted_loss: 0.0821, label: 1, bag_size: 890
batch 319, loss: 0.4787, instance_loss: 0.4441, weighted_loss: 0.4683, label: 1, bag_size: 293
batch 339, loss: 2.4210, instance_loss: 0.6869, weighted_loss: 1.9008, label: 0, bag_size: 245
batch 359, loss: 0.0003, instance_loss: 0.0981, weighted_loss: 0.0296, label: 3, bag_size: 123
batch 379, loss: 0.0123, instance_loss: 0.0974, weighted_loss: 0.0379, label: 0, bag_size: 552
batch 399, loss: 0.4894, instance_loss: 0.5149, weighted_loss: 0.4971, label: 1, bag_size: 1096
batch 419, loss: 0.0000, instance_loss: 0.1728, weighted_loss: 0.0519, label: 4, bag_size: 185
batch 439, loss: 0.0069, instance_loss: 0.0532, weighted_loss: 0.0208, label: 4, bag_size: 86
batch 459, loss: 0.0421, instance_loss: 0.1535, weighted_loss: 0.0755, label: 2, bag_size: 317
batch 479, loss: 0.0002, instance_loss: 0.0159, weighted_loss: 0.0049, label: 0, bag_size: 402
batch 499, loss: 0.0711, instance_loss: 0.2266, weighted_loss: 0.1177, label: 0, bag_size: 255
batch 519, loss: 0.0217, instance_loss: 0.0695, weighted_loss: 0.0361, label: 0, bag_size: 545
batch 539, loss: 0.1396, instance_loss: 0.1030, weighted_loss: 0.1286, label: 0, bag_size: 367


class 0 clustering acc 0.9862844036697248: correct 21501/21800
class 1 clustering acc 0.5451834862385321: correct 2377/4360
Epoch: 44, train_loss: 0.1686, train_clustering_loss:  0.2630, train_error: 0.0440
class 0: acc 0.9609375, correct 123/128
class 1: acc 0.9396551724137931, correct 109/116
class 2: acc 0.9038461538461539, correct 94/104
class 3: acc 1.0, correct 94/94
class 4: acc 0.9805825242718447, correct 101/103

Val Set, val_loss: 1.3448, val_error: 0.4200, auc: 0.8642
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.325: correct 130/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.4229, instance_loss: 0.3709, weighted_loss: 0.4073, label: 0, bag_size: 818
batch 39, loss: 0.0332, instance_loss: 0.2815, weighted_loss: 0.1077, label: 3, bag_size: 316
batch 59, loss: 0.1402, instance_loss: 0.2515, weighted_loss: 0.1736, label: 2, bag_size: 2703
batch 79, loss: 0.0061, instance_loss: 0.2473, weighted_loss: 0.0785, label: 0, bag_size: 155
batch 99, loss: 0.0138, instance_loss: 0.0285, weighted_loss: 0.0182, label: 3, bag_size: 556
batch 119, loss: 0.0069, instance_loss: 0.1838, weighted_loss: 0.0600, label: 3, bag_size: 16
batch 139, loss: 0.1597, instance_loss: 0.4159, weighted_loss: 0.2366, label: 4, bag_size: 1235
batch 159, loss: 0.1617, instance_loss: 0.4385, weighted_loss: 0.2448, label: 2, bag_size: 356
batch 179, loss: 0.0164, instance_loss: 0.1338, weighted_loss: 0.0517, label: 0, bag_size: 731
batch 199, loss: 0.0753, instance_loss: 0.1690, weighted_loss: 0.1034, label: 1, bag_size: 847
batch 219, loss: 0.2746, instance_loss: 0.6425, weighted_loss: 0.3850, label: 1, bag_size: 936
batch 239, loss: 0.0353, instance_loss: 0.3126, weighted_loss: 0.1185, label: 1, bag_size: 102
batch 259, loss: 0.0000, instance_loss: 0.1174, weighted_loss: 0.0352, label: 3, bag_size: 18
batch 279, loss: 0.0181, instance_loss: 0.2631, weighted_loss: 0.0916, label: 0, bag_size: 148
batch 299, loss: 0.0001, instance_loss: 0.0406, weighted_loss: 0.0122, label: 3, bag_size: 33
batch 319, loss: 0.0001, instance_loss: 0.0750, weighted_loss: 0.0225, label: 3, bag_size: 18
batch 339, loss: 0.0027, instance_loss: 0.2362, weighted_loss: 0.0728, label: 4, bag_size: 974
batch 359, loss: 0.0623, instance_loss: 0.3269, weighted_loss: 0.1417, label: 2, bag_size: 1259
batch 379, loss: 0.2122, instance_loss: 0.2386, weighted_loss: 0.2201, label: 0, bag_size: 1247
batch 399, loss: 0.0105, instance_loss: 0.1572, weighted_loss: 0.0545, label: 0, bag_size: 472
batch 419, loss: 0.0026, instance_loss: 0.0632, weighted_loss: 0.0208, label: 4, bag_size: 130
batch 439, loss: 0.0201, instance_loss: 0.0584, weighted_loss: 0.0316, label: 1, bag_size: 937
batch 459, loss: 0.0049, instance_loss: 0.2111, weighted_loss: 0.0668, label: 0, bag_size: 432
batch 479, loss: 0.0014, instance_loss: 0.1798, weighted_loss: 0.0549, label: 0, bag_size: 110
batch 499, loss: 0.0865, instance_loss: 0.2392, weighted_loss: 0.1323, label: 1, bag_size: 348
batch 519, loss: 0.0250, instance_loss: 0.2473, weighted_loss: 0.0917, label: 0, bag_size: 478
batch 539, loss: 0.0008, instance_loss: 0.0208, weighted_loss: 0.0068, label: 4, bag_size: 94


class 0 clustering acc 0.9874770642201834: correct 21527/21800
class 1 clustering acc 0.6158256880733946: correct 2685/4360
Epoch: 45, train_loss: 0.0866, train_clustering_loss:  0.2242, train_error: 0.0183
class 0: acc 0.9805825242718447, correct 101/103
class 1: acc 0.9814814814814815, correct 106/108
class 2: acc 0.9340659340659341, correct 85/91
class 3: acc 1.0, correct 127/127
class 4: acc 1.0, correct 116/116

Val Set, val_loss: 1.4619, val_error: 0.4200, auc: 0.8491
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.33: correct 132/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.7142857142857143, correct 5/7
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0008, instance_loss: 0.2162, weighted_loss: 0.0654, label: 1, bag_size: 866
batch 39, loss: 0.0134, instance_loss: 0.1095, weighted_loss: 0.0422, label: 1, bag_size: 399
batch 59, loss: 0.0449, instance_loss: 0.3315, weighted_loss: 0.1309, label: 2, bag_size: 1232
batch 79, loss: 0.0030, instance_loss: 0.0942, weighted_loss: 0.0304, label: 3, bag_size: 21
batch 99, loss: 0.0001, instance_loss: 0.0037, weighted_loss: 0.0012, label: 3, bag_size: 66
batch 119, loss: 0.0090, instance_loss: 0.2276, weighted_loss: 0.0746, label: 0, bag_size: 382
batch 139, loss: 0.0046, instance_loss: 0.1178, weighted_loss: 0.0385, label: 0, bag_size: 446
batch 159, loss: 0.3803, instance_loss: 0.2121, weighted_loss: 0.3299, label: 0, bag_size: 1190
batch 179, loss: 0.0130, instance_loss: 0.2012, weighted_loss: 0.0695, label: 0, bag_size: 478
batch 199, loss: 0.0001, instance_loss: 0.1533, weighted_loss: 0.0460, label: 3, bag_size: 21
batch 219, loss: 0.0006, instance_loss: 0.2068, weighted_loss: 0.0624, label: 4, bag_size: 35
batch 239, loss: 0.0571, instance_loss: 0.2941, weighted_loss: 0.1282, label: 2, bag_size: 687
batch 259, loss: 0.0942, instance_loss: 0.3501, weighted_loss: 0.1710, label: 1, bag_size: 868
batch 279, loss: 0.0000, instance_loss: 0.2878, weighted_loss: 0.0864, label: 1, bag_size: 700
batch 299, loss: 0.1328, instance_loss: 0.3551, weighted_loss: 0.1995, label: 3, bag_size: 18
batch 319, loss: 0.0030, instance_loss: 0.0528, weighted_loss: 0.0179, label: 0, bag_size: 246
batch 339, loss: 0.9357, instance_loss: 0.2754, weighted_loss: 0.7376, label: 2, bag_size: 828
batch 359, loss: 0.0002, instance_loss: 0.0311, weighted_loss: 0.0095, label: 4, bag_size: 110
batch 379, loss: 0.0837, instance_loss: 0.3505, weighted_loss: 0.1637, label: 0, bag_size: 128
batch 399, loss: 0.0045, instance_loss: 0.1609, weighted_loss: 0.0514, label: 2, bag_size: 461
batch 419, loss: 0.1206, instance_loss: 0.4134, weighted_loss: 0.2085, label: 0, bag_size: 423
batch 439, loss: 0.0070, instance_loss: 0.3273, weighted_loss: 0.1031, label: 0, bag_size: 155
batch 459, loss: 2.4464, instance_loss: 0.5108, weighted_loss: 1.8657, label: 2, bag_size: 1306
batch 479, loss: 0.0605, instance_loss: 0.1826, weighted_loss: 0.0971, label: 2, bag_size: 2826
batch 499, loss: 0.0004, instance_loss: 0.0322, weighted_loss: 0.0100, label: 4, bag_size: 157
batch 519, loss: 0.0031, instance_loss: 0.2808, weighted_loss: 0.0864, label: 2, bag_size: 766
batch 539, loss: 0.0427, instance_loss: 0.3276, weighted_loss: 0.1281, label: 0, bag_size: 117


class 0 clustering acc 0.9848165137614678: correct 21469/21800
class 1 clustering acc 0.5559633027522936: correct 2424/4360
Epoch: 46, train_loss: 0.0888, train_clustering_loss:  0.2574, train_error: 0.0202
class 0: acc 0.990909090909091, correct 109/110
class 1: acc 0.9920634920634921, correct 125/126
class 2: acc 0.9369369369369369, correct 104/111
class 3: acc 0.9895833333333334, correct 95/96
class 4: acc 0.9901960784313726, correct 101/102

Val Set, val_loss: 1.4504, val_error: 0.4400, auc: 0.8617
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.335: correct 134/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5263157894736842, correct 10/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0012, instance_loss: 0.1419, weighted_loss: 0.0434, label: 2, bag_size: 846
batch 39, loss: 0.0106, instance_loss: 0.2643, weighted_loss: 0.0867, label: 1, bag_size: 913
batch 59, loss: 1.8550, instance_loss: 0.5262, weighted_loss: 1.4563, label: 2, bag_size: 384
batch 79, loss: 0.0046, instance_loss: 0.2769, weighted_loss: 0.0863, label: 2, bag_size: 351
batch 99, loss: 0.0080, instance_loss: 0.2202, weighted_loss: 0.0717, label: 2, bag_size: 248
batch 119, loss: 0.0317, instance_loss: 0.2642, weighted_loss: 0.1014, label: 2, bag_size: 470
batch 139, loss: 0.0001, instance_loss: 0.1518, weighted_loss: 0.0456, label: 2, bag_size: 1404
batch 159, loss: 0.0015, instance_loss: 0.3642, weighted_loss: 0.1103, label: 3, bag_size: 405
batch 179, loss: 0.0034, instance_loss: 0.0750, weighted_loss: 0.0248, label: 1, bag_size: 598
batch 199, loss: 0.1894, instance_loss: 0.4468, weighted_loss: 0.2666, label: 2, bag_size: 1235
batch 219, loss: 0.0010, instance_loss: 0.2213, weighted_loss: 0.0671, label: 2, bag_size: 312
batch 239, loss: 0.0947, instance_loss: 0.4109, weighted_loss: 0.1896, label: 1, bag_size: 1559
batch 259, loss: 0.0002, instance_loss: 0.2394, weighted_loss: 0.0719, label: 3, bag_size: 18
batch 279, loss: 0.0052, instance_loss: 0.2600, weighted_loss: 0.0816, label: 2, bag_size: 1404
batch 299, loss: 0.0010, instance_loss: 0.0288, weighted_loss: 0.0093, label: 4, bag_size: 96
batch 319, loss: 0.0098, instance_loss: 0.1357, weighted_loss: 0.0476, label: 1, bag_size: 886
batch 339, loss: 0.0004, instance_loss: 0.0489, weighted_loss: 0.0149, label: 0, bag_size: 933
batch 359, loss: 0.1429, instance_loss: 0.3344, weighted_loss: 0.2003, label: 3, bag_size: 230
batch 379, loss: 0.0595, instance_loss: 0.2439, weighted_loss: 0.1148, label: 2, bag_size: 237
batch 399, loss: 0.0061, instance_loss: 0.1756, weighted_loss: 0.0570, label: 0, bag_size: 413
batch 419, loss: 0.0013, instance_loss: 0.1164, weighted_loss: 0.0358, label: 3, bag_size: 20
batch 439, loss: 0.0693, instance_loss: 0.3514, weighted_loss: 0.1539, label: 3, bag_size: 230
batch 459, loss: 0.2742, instance_loss: 0.2739, weighted_loss: 0.2741, label: 3, bag_size: 316
batch 479, loss: 0.0046, instance_loss: 0.2422, weighted_loss: 0.0759, label: 2, bag_size: 1533
batch 499, loss: 0.0215, instance_loss: 0.3676, weighted_loss: 0.1253, label: 1, bag_size: 343
batch 519, loss: 2.7210, instance_loss: 0.5594, weighted_loss: 2.0726, label: 1, bag_size: 657
batch 539, loss: 0.0018, instance_loss: 0.0599, weighted_loss: 0.0192, label: 1, bag_size: 994


class 0 clustering acc 0.9838532110091743: correct 21448/21800
class 1 clustering acc 0.5811926605504587: correct 2534/4360
Epoch: 47, train_loss: 0.0932, train_clustering_loss:  0.2456, train_error: 0.0275
class 0: acc 0.9727272727272728, correct 107/110
class 1: acc 0.9711538461538461, correct 101/104
class 2: acc 0.9391304347826087, correct 108/115
class 3: acc 0.9913793103448276, correct 115/116
class 4: acc 0.99, correct 99/100

Val Set, val_loss: 1.4154, val_error: 0.4600, auc: 0.8556
class 0 clustering acc 0.9565: correct 1913/2000
class 1 clustering acc 0.335: correct 134/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.3473, instance_loss: 0.4743, weighted_loss: 0.3854, label: 0, bag_size: 818
batch 39, loss: 0.0013, instance_loss: 0.2477, weighted_loss: 0.0752, label: 1, bag_size: 846
batch 59, loss: 0.0182, instance_loss: 0.1355, weighted_loss: 0.0534, label: 4, bag_size: 38
batch 79, loss: 0.0132, instance_loss: 0.2894, weighted_loss: 0.0961, label: 0, bag_size: 118
batch 99, loss: 0.0304, instance_loss: 0.3578, weighted_loss: 0.1286, label: 2, bag_size: 252
batch 119, loss: 0.0017, instance_loss: 0.3758, weighted_loss: 0.1139, label: 2, bag_size: 725
batch 139, loss: 0.0017, instance_loss: 0.1466, weighted_loss: 0.0452, label: 2, bag_size: 419
batch 159, loss: 0.0001, instance_loss: 0.0921, weighted_loss: 0.0277, label: 4, bag_size: 104
batch 179, loss: 0.0244, instance_loss: 0.3092, weighted_loss: 0.1098, label: 0, bag_size: 1196
batch 199, loss: 0.0004, instance_loss: 0.0396, weighted_loss: 0.0121, label: 0, bag_size: 933
batch 219, loss: 0.0885, instance_loss: 0.1316, weighted_loss: 0.1014, label: 1, bag_size: 320
batch 239, loss: 0.0002, instance_loss: 0.0852, weighted_loss: 0.0257, label: 4, bag_size: 20
batch 259, loss: 0.1026, instance_loss: 0.3168, weighted_loss: 0.1669, label: 0, bag_size: 128
batch 279, loss: 0.9697, instance_loss: 0.7194, weighted_loss: 0.8946, label: 2, bag_size: 1348
batch 299, loss: 0.0064, instance_loss: 0.4194, weighted_loss: 0.1303, label: 2, bag_size: 330
batch 319, loss: 0.0140, instance_loss: 0.3204, weighted_loss: 0.1059, label: 4, bag_size: 974
batch 339, loss: 0.0002, instance_loss: 0.0614, weighted_loss: 0.0186, label: 1, bag_size: 1402
batch 359, loss: 0.0015, instance_loss: 0.6214, weighted_loss: 0.1875, label: 2, bag_size: 916
batch 379, loss: 0.0214, instance_loss: 0.2267, weighted_loss: 0.0830, label: 0, bag_size: 382
batch 399, loss: 0.0122, instance_loss: 0.0683, weighted_loss: 0.0291, label: 1, bag_size: 1191
batch 419, loss: 0.0142, instance_loss: 0.4300, weighted_loss: 0.1389, label: 2, bag_size: 345
batch 439, loss: 0.0002, instance_loss: 0.0664, weighted_loss: 0.0201, label: 0, bag_size: 898
batch 459, loss: 0.0006, instance_loss: 0.0725, weighted_loss: 0.0222, label: 0, bag_size: 476
batch 479, loss: 0.0015, instance_loss: 0.2433, weighted_loss: 0.0740, label: 0, bag_size: 736
batch 499, loss: 5.0163, instance_loss: 0.9574, weighted_loss: 3.7986, label: 2, bag_size: 319
batch 519, loss: 0.1362, instance_loss: 0.2900, weighted_loss: 0.1823, label: 2, bag_size: 264
batch 539, loss: 0.0038, instance_loss: 0.4618, weighted_loss: 0.1412, label: 2, bag_size: 655


class 0 clustering acc 0.9838990825688073: correct 21449/21800
class 1 clustering acc 0.5752293577981651: correct 2508/4360
Epoch: 48, train_loss: 0.1043, train_clustering_loss:  0.2553, train_error: 0.0239
class 0: acc 0.9917355371900827, correct 120/121
class 1: acc 0.9809523809523809, correct 103/105
class 2: acc 0.93, correct 93/100
class 3: acc 0.9916666666666667, correct 119/120
class 4: acc 0.9797979797979798, correct 97/99

Val Set, val_loss: 1.2891, val_error: 0.4200, auc: 0.8653
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.305: correct 122/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.47368421052631576, correct 9/19
class 3: acc 0.6666666666666666, correct 4/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0065, instance_loss: 0.5598, weighted_loss: 0.1725, label: 3, bag_size: 317
batch 39, loss: 0.0000, instance_loss: 0.0127, weighted_loss: 0.0038, label: 4, bag_size: 143
batch 59, loss: 0.0003, instance_loss: 0.0256, weighted_loss: 0.0079, label: 4, bag_size: 192
batch 79, loss: 0.3572, instance_loss: 0.3585, weighted_loss: 0.3576, label: 2, bag_size: 471
batch 99, loss: 0.0004, instance_loss: 0.0592, weighted_loss: 0.0181, label: 4, bag_size: 182
batch 119, loss: 0.0076, instance_loss: 0.1754, weighted_loss: 0.0579, label: 3, bag_size: 23
batch 139, loss: 0.1291, instance_loss: 0.5472, weighted_loss: 0.2545, label: 0, bag_size: 245
batch 159, loss: 0.0005, instance_loss: 0.0492, weighted_loss: 0.0151, label: 3, bag_size: 37
batch 179, loss: 0.0002, instance_loss: 0.0259, weighted_loss: 0.0079, label: 4, bag_size: 83
batch 199, loss: 0.0038, instance_loss: 0.0792, weighted_loss: 0.0264, label: 4, bag_size: 137
batch 219, loss: 0.0001, instance_loss: 0.0904, weighted_loss: 0.0272, label: 4, bag_size: 40
batch 239, loss: 0.1477, instance_loss: 0.4973, weighted_loss: 0.2525, label: 0, bag_size: 818
batch 259, loss: 0.0298, instance_loss: 0.1212, weighted_loss: 0.0572, label: 0, bag_size: 1517
batch 279, loss: 0.0183, instance_loss: 0.1309, weighted_loss: 0.0521, label: 0, bag_size: 255
batch 299, loss: 0.0010, instance_loss: 0.0679, weighted_loss: 0.0211, label: 4, bag_size: 128
batch 319, loss: 0.0045, instance_loss: 0.1137, weighted_loss: 0.0373, label: 1, bag_size: 994
batch 339, loss: 0.0249, instance_loss: 0.2652, weighted_loss: 0.0970, label: 0, bag_size: 1527
batch 359, loss: 1.0706, instance_loss: 0.4677, weighted_loss: 0.8897, label: 1, bag_size: 535
batch 379, loss: 0.2183, instance_loss: 0.2151, weighted_loss: 0.2173, label: 1, bag_size: 442
batch 399, loss: 0.0898, instance_loss: 0.2446, weighted_loss: 0.1362, label: 1, bag_size: 1144
batch 419, loss: 0.0010, instance_loss: 0.2245, weighted_loss: 0.0680, label: 4, bag_size: 19
batch 439, loss: 0.0154, instance_loss: 0.0361, weighted_loss: 0.0216, label: 3, bag_size: 78
batch 459, loss: 0.0000, instance_loss: 0.0209, weighted_loss: 0.0063, label: 3, bag_size: 32
batch 479, loss: 0.0012, instance_loss: 0.2637, weighted_loss: 0.0799, label: 2, bag_size: 1404
batch 499, loss: 0.0042, instance_loss: 0.1900, weighted_loss: 0.0600, label: 4, bag_size: 19
batch 519, loss: 0.0095, instance_loss: 0.1020, weighted_loss: 0.0373, label: 1, bag_size: 1127
batch 539, loss: 0.0171, instance_loss: 0.2186, weighted_loss: 0.0776, label: 2, bag_size: 358


class 0 clustering acc 0.9868807339449541: correct 21514/21800
class 1 clustering acc 0.5715596330275229: correct 2492/4360
Epoch: 49, train_loss: 0.0890, train_clustering_loss:  0.2441, train_error: 0.0275
class 0: acc 0.9894736842105263, correct 94/95
class 1: acc 0.9568965517241379, correct 111/116
class 2: acc 0.9181818181818182, correct 101/110
class 3: acc 1.0, correct 105/105
class 4: acc 1.0, correct 119/119

Val Set, val_loss: 1.4873, val_error: 0.4200, auc: 0.8666
class 0 clustering acc 0.964: correct 1928/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.3684210526315789, correct 7/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.1104, instance_loss: 0.3250, weighted_loss: 0.1748, label: 0, bag_size: 478
batch 39, loss: 0.0080, instance_loss: 0.1556, weighted_loss: 0.0523, label: 1, bag_size: 944
batch 59, loss: 0.0044, instance_loss: 0.0395, weighted_loss: 0.0149, label: 3, bag_size: 405
batch 79, loss: 0.0080, instance_loss: 0.3957, weighted_loss: 0.1243, label: 0, bag_size: 128
batch 99, loss: 0.0001, instance_loss: 0.0541, weighted_loss: 0.0163, label: 3, bag_size: 20
batch 119, loss: 0.0016, instance_loss: 0.1704, weighted_loss: 0.0522, label: 4, bag_size: 646
batch 139, loss: 0.0944, instance_loss: 0.2972, weighted_loss: 0.1552, label: 2, bag_size: 977
batch 159, loss: 0.0001, instance_loss: 0.0261, weighted_loss: 0.0079, label: 0, bag_size: 521
batch 179, loss: 0.0000, instance_loss: 0.0971, weighted_loss: 0.0291, label: 4, bag_size: 79
batch 199, loss: 0.0015, instance_loss: 0.0381, weighted_loss: 0.0125, label: 0, bag_size: 653
batch 219, loss: 0.0005, instance_loss: 0.0563, weighted_loss: 0.0173, label: 4, bag_size: 160
batch 239, loss: 0.0008, instance_loss: 0.2871, weighted_loss: 0.0867, label: 0, bag_size: 116
batch 259, loss: 0.1577, instance_loss: 0.1759, weighted_loss: 0.1632, label: 2, bag_size: 347
batch 279, loss: 0.1476, instance_loss: 0.6470, weighted_loss: 0.2974, label: 1, bag_size: 470
batch 299, loss: 0.8204, instance_loss: 0.4753, weighted_loss: 0.7168, label: 2, bag_size: 1167
batch 319, loss: 0.0001, instance_loss: 0.2190, weighted_loss: 0.0658, label: 1, bag_size: 614
batch 339, loss: 0.2193, instance_loss: 0.5226, weighted_loss: 0.3103, label: 2, bag_size: 408
batch 359, loss: 0.0265, instance_loss: 0.2250, weighted_loss: 0.0860, label: 4, bag_size: 28
batch 379, loss: 0.0056, instance_loss: 0.5356, weighted_loss: 0.1646, label: 3, bag_size: 1380
batch 399, loss: 0.0020, instance_loss: 0.2415, weighted_loss: 0.0738, label: 0, bag_size: 120
batch 419, loss: 0.0001, instance_loss: 0.0364, weighted_loss: 0.0110, label: 0, bag_size: 1101
batch 439, loss: 0.0920, instance_loss: 0.3030, weighted_loss: 0.1553, label: 1, bag_size: 913
batch 459, loss: 0.0576, instance_loss: 0.2199, weighted_loss: 0.1063, label: 3, bag_size: 316
batch 479, loss: 0.0001, instance_loss: 0.0416, weighted_loss: 0.0125, label: 4, bag_size: 185
batch 499, loss: 0.0001, instance_loss: 0.0730, weighted_loss: 0.0219, label: 3, bag_size: 841
batch 519, loss: 0.0148, instance_loss: 0.1849, weighted_loss: 0.0658, label: 2, bag_size: 828
batch 539, loss: 0.0002, instance_loss: 0.1242, weighted_loss: 0.0374, label: 0, bag_size: 1101


class 0 clustering acc 0.9844954128440367: correct 21462/21800
class 1 clustering acc 0.5619266055045872: correct 2450/4360
Epoch: 50, train_loss: 0.0825, train_clustering_loss:  0.2522, train_error: 0.0183
class 0: acc 0.9915966386554622, correct 118/119
class 1: acc 0.9741379310344828, correct 113/116
class 2: acc 0.9428571428571428, correct 99/105
class 3: acc 1.0, correct 115/115
class 4: acc 1.0, correct 90/90

Val Set, val_loss: 1.3121, val_error: 0.4000, auc: 0.8727
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.3225: correct 129/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0057, instance_loss: 0.3190, weighted_loss: 0.0997, label: 1, bag_size: 1255
batch 39, loss: 0.0004, instance_loss: 0.0350, weighted_loss: 0.0108, label: 3, bag_size: 27
batch 59, loss: 0.0334, instance_loss: 0.3935, weighted_loss: 0.1414, label: 4, bag_size: 1235
batch 79, loss: 0.0001, instance_loss: 0.0823, weighted_loss: 0.0248, label: 3, bag_size: 16
batch 99, loss: 0.0581, instance_loss: 0.3491, weighted_loss: 0.1454, label: 2, bag_size: 589
batch 119, loss: 0.0013, instance_loss: 0.1966, weighted_loss: 0.0599, label: 0, bag_size: 1332
batch 139, loss: 0.0099, instance_loss: 0.2613, weighted_loss: 0.0853, label: 2, bag_size: 701
batch 159, loss: 0.0006, instance_loss: 0.2507, weighted_loss: 0.0756, label: 0, bag_size: 122
batch 179, loss: 0.0027, instance_loss: 0.6169, weighted_loss: 0.1869, label: 2, bag_size: 916
batch 199, loss: 0.0734, instance_loss: 0.4872, weighted_loss: 0.1976, label: 2, bag_size: 471
batch 219, loss: 0.1100, instance_loss: 0.7133, weighted_loss: 0.2910, label: 1, bag_size: 875
batch 239, loss: 0.0036, instance_loss: 0.1765, weighted_loss: 0.0555, label: 0, bag_size: 1012
batch 259, loss: 0.1121, instance_loss: 0.4118, weighted_loss: 0.2020, label: 0, bag_size: 424
batch 279, loss: 0.0722, instance_loss: 0.4619, weighted_loss: 0.1891, label: 1, bag_size: 293
batch 299, loss: 0.0143, instance_loss: 0.3442, weighted_loss: 0.1133, label: 3, bag_size: 343
batch 319, loss: 0.0045, instance_loss: 0.0569, weighted_loss: 0.0202, label: 3, bag_size: 556
batch 339, loss: 0.0056, instance_loss: 0.2162, weighted_loss: 0.0688, label: 0, bag_size: 552
batch 359, loss: 0.0152, instance_loss: 0.2832, weighted_loss: 0.0956, label: 2, bag_size: 262
batch 379, loss: 0.0098, instance_loss: 0.5311, weighted_loss: 0.1662, label: 0, bag_size: 736
batch 399, loss: 0.0031, instance_loss: 0.1390, weighted_loss: 0.0439, label: 1, bag_size: 711
batch 419, loss: 0.0444, instance_loss: 0.2637, weighted_loss: 0.1102, label: 2, bag_size: 324
batch 439, loss: 0.0162, instance_loss: 0.8076, weighted_loss: 0.2536, label: 2, bag_size: 911
batch 459, loss: 0.0016, instance_loss: 0.0675, weighted_loss: 0.0214, label: 0, bag_size: 1012
batch 479, loss: 0.0001, instance_loss: 0.0457, weighted_loss: 0.0138, label: 3, bag_size: 27
batch 499, loss: 0.0002, instance_loss: 0.0332, weighted_loss: 0.0101, label: 4, bag_size: 128
batch 519, loss: 0.0054, instance_loss: 0.1771, weighted_loss: 0.0569, label: 3, bag_size: 24
batch 539, loss: 0.0064, instance_loss: 0.0806, weighted_loss: 0.0287, label: 1, bag_size: 690


class 0 clustering acc 0.9852293577981651: correct 21478/21800
class 1 clustering acc 0.5644495412844037: correct 2461/4360
Epoch: 51, train_loss: 0.0591, train_clustering_loss:  0.2479, train_error: 0.0073
class 0: acc 1.0, correct 119/119
class 1: acc 0.9823008849557522, correct 111/113
class 2: acc 0.9823008849557522, correct 111/113
class 3: acc 1.0, correct 96/96
class 4: acc 1.0, correct 104/104

Val Set, val_loss: 1.3888, val_error: 0.3800, auc: 0.8675
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.325: correct 130/400
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6842105263157895, correct 13/19
class 3: acc 0.5, correct 3/6
class 4: acc 0.5714285714285714, correct 4/7
EarlyStopping counter: 34 out of 20
Early stopping
Val error: 0.3800, ROC AUC: 0.8664
Test error: 0.2800, ROC AUC: 0.8967
class 0: acc 1.0, correct 4/4
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.9565217391304348, correct 22/23
class 3: acc 0.3333333333333333, correct 1/3
class 4: acc 0.42857142857142855, correct 3/7

Training Fold 6!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.4972, instance_loss: 1.1948, weighted_loss: 1.4065, label: 1, bag_size: 1402
batch 39, loss: 1.6997, instance_loss: 0.9954, weighted_loss: 1.4884, label: 0, bag_size: 143
batch 59, loss: 1.2216, instance_loss: 0.8440, weighted_loss: 1.1083, label: 4, bag_size: 78
batch 79, loss: 1.3787, instance_loss: 0.7306, weighted_loss: 1.1843, label: 0, bag_size: 1301
batch 99, loss: 1.6126, instance_loss: 0.6220, weighted_loss: 1.3154, label: 1, bag_size: 696
batch 119, loss: 1.7269, instance_loss: 0.5646, weighted_loss: 1.3782, label: 0, bag_size: 143
batch 139, loss: 1.5961, instance_loss: 0.5354, weighted_loss: 1.2779, label: 0, bag_size: 552
batch 159, loss: 1.7708, instance_loss: 0.5413, weighted_loss: 1.4020, label: 3, bag_size: 46
batch 179, loss: 1.5403, instance_loss: 0.5222, weighted_loss: 1.2349, label: 3, bag_size: 26
batch 199, loss: 1.8455, instance_loss: 0.5309, weighted_loss: 1.4511, label: 1, bag_size: 1646
batch 219, loss: 1.9000, instance_loss: 0.5370, weighted_loss: 1.4911, label: 1, bag_size: 319
batch 239, loss: 1.4905, instance_loss: 0.5181, weighted_loss: 1.1988, label: 0, bag_size: 1065
batch 259, loss: 1.4457, instance_loss: 0.4896, weighted_loss: 1.1589, label: 2, bag_size: 525
batch 279, loss: 1.6435, instance_loss: 0.5327, weighted_loss: 1.3103, label: 0, bag_size: 148
batch 299, loss: 1.3749, instance_loss: 0.4931, weighted_loss: 1.1103, label: 2, bag_size: 358
batch 319, loss: 1.4547, instance_loss: 0.5049, weighted_loss: 1.1697, label: 0, bag_size: 1301
batch 339, loss: 1.2725, instance_loss: 0.4837, weighted_loss: 1.0359, label: 0, bag_size: 976
batch 359, loss: 1.9328, instance_loss: 0.5455, weighted_loss: 1.5166, label: 3, bag_size: 607
batch 379, loss: 1.2983, instance_loss: 0.4986, weighted_loss: 1.0584, label: 0, bag_size: 1143
batch 399, loss: 1.8791, instance_loss: 0.5109, weighted_loss: 1.4687, label: 4, bag_size: 625
batch 419, loss: 1.4657, instance_loss: 0.5264, weighted_loss: 1.1839, label: 2, bag_size: 910
batch 439, loss: 1.3533, instance_loss: 0.4936, weighted_loss: 1.0954, label: 3, bag_size: 556
batch 459, loss: 1.2816, instance_loss: 0.4872, weighted_loss: 1.0433, label: 0, bag_size: 1174
batch 479, loss: 0.5427, instance_loss: 0.4199, weighted_loss: 0.5058, label: 4, bag_size: 20
batch 499, loss: 1.1908, instance_loss: 0.4788, weighted_loss: 0.9772, label: 1, bag_size: 320
batch 519, loss: 0.2561, instance_loss: 0.3399, weighted_loss: 0.2812, label: 4, bag_size: 23
batch 539, loss: 1.7528, instance_loss: 0.5254, weighted_loss: 1.3846, label: 2, bag_size: 571


class 0 clustering acc 0.9957798165137615: correct 21708/21800
class 1 clustering acc 0.002981651376146789: correct 13/4360
Epoch: 0, train_loss: 1.4392, train_clustering_loss:  0.5882, train_error: 0.5908
class 0: acc 0.4262295081967213, correct 52/122
class 1: acc 0.29292929292929293, correct 29/99
class 2: acc 0.25471698113207547, correct 27/106
class 3: acc 0.3018867924528302, correct 32/106
class 4: acc 0.7410714285714286, correct 83/112

Val Set, val_loss: 1.4685, val_error: 0.7000, auc: 0.7823
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.0, correct 0/20
class 3: acc 0.375, correct 3/8
class 4: acc 0.25, correct 2/8
Validation loss decreased (inf --> 1.468518).  Saving model ...


batch 19, loss: 2.5382, instance_loss: 0.5544, weighted_loss: 1.9431, label: 4, bag_size: 1357
batch 39, loss: 2.5025, instance_loss: 0.5705, weighted_loss: 1.9229, label: 4, bag_size: 1337
batch 59, loss: 1.4160, instance_loss: 0.4930, weighted_loss: 1.1391, label: 0, bag_size: 1061
batch 79, loss: 0.3667, instance_loss: 0.2725, weighted_loss: 0.3384, label: 4, bag_size: 140
batch 99, loss: 1.2852, instance_loss: 0.4728, weighted_loss: 1.0415, label: 1, bag_size: 700
batch 119, loss: 1.5978, instance_loss: 0.5187, weighted_loss: 1.2740, label: 0, bag_size: 1599
batch 139, loss: 1.4127, instance_loss: 0.4863, weighted_loss: 1.1348, label: 0, bag_size: 340
batch 159, loss: 1.2175, instance_loss: 0.4627, weighted_loss: 0.9911, label: 2, bag_size: 292
batch 179, loss: 0.2515, instance_loss: 0.2313, weighted_loss: 0.2454, label: 4, bag_size: 83
batch 199, loss: 0.7568, instance_loss: 0.4709, weighted_loss: 0.6711, label: 3, bag_size: 20
batch 219, loss: 1.4192, instance_loss: 0.4826, weighted_loss: 1.1382, label: 2, bag_size: 525
batch 239, loss: 0.3176, instance_loss: 0.2638, weighted_loss: 0.3015, label: 4, bag_size: 19
batch 259, loss: 1.2804, instance_loss: 0.5038, weighted_loss: 1.0474, label: 0, bag_size: 607
batch 279, loss: 1.1853, instance_loss: 0.4757, weighted_loss: 0.9724, label: 2, bag_size: 1259
batch 299, loss: 2.6641, instance_loss: 0.6781, weighted_loss: 2.0683, label: 4, bag_size: 524
batch 319, loss: 0.9576, instance_loss: 0.4414, weighted_loss: 0.8027, label: 2, bag_size: 848
batch 339, loss: 2.4634, instance_loss: 0.6228, weighted_loss: 1.9112, label: 4, bag_size: 663
batch 359, loss: 0.2800, instance_loss: 0.1971, weighted_loss: 0.2552, label: 4, bag_size: 167
batch 379, loss: 2.3425, instance_loss: 0.7300, weighted_loss: 1.8587, label: 0, bag_size: 116
batch 399, loss: 1.8758, instance_loss: 0.5748, weighted_loss: 1.4855, label: 0, bag_size: 350
batch 419, loss: 0.3874, instance_loss: 0.3522, weighted_loss: 0.3768, label: 4, bag_size: 14
batch 439, loss: 1.4814, instance_loss: 0.4597, weighted_loss: 1.1748, label: 1, bag_size: 838
batch 459, loss: 1.9276, instance_loss: 0.5585, weighted_loss: 1.5169, label: 2, bag_size: 1123
batch 479, loss: 1.0692, instance_loss: 0.4236, weighted_loss: 0.8755, label: 2, bag_size: 878
batch 499, loss: 1.3297, instance_loss: 0.5234, weighted_loss: 1.0878, label: 0, bag_size: 1174
batch 519, loss: 1.4284, instance_loss: 0.4772, weighted_loss: 1.1430, label: 1, bag_size: 861
batch 539, loss: 1.3737, instance_loss: 0.4801, weighted_loss: 1.1056, label: 1, bag_size: 442


class 0 clustering acc 0.9981192660550459: correct 21759/21800
class 1 clustering acc 0.032339449541284405: correct 141/4360
Epoch: 1, train_loss: 1.1948, train_clustering_loss:  0.4549, train_error: 0.4550
class 0: acc 0.21359223300970873, correct 22/103
class 1: acc 0.6057692307692307, correct 63/104
class 2: acc 0.4700854700854701, correct 55/117
class 3: acc 0.7450980392156863, correct 76/102
class 4: acc 0.680672268907563, correct 81/119

Val Set, val_loss: 1.3090, val_error: 0.4600, auc: 0.8437
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.0175: correct 7/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.3, correct 6/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
Validation loss decreased (1.468518 --> 1.309038).  Saving model ...


batch 19, loss: 2.5265, instance_loss: 0.6403, weighted_loss: 1.9607, label: 3, bag_size: 281
batch 39, loss: 1.4248, instance_loss: 0.4767, weighted_loss: 1.1404, label: 2, bag_size: 1231
batch 59, loss: 1.7731, instance_loss: 0.5379, weighted_loss: 1.4025, label: 1, bag_size: 442
batch 79, loss: 0.3144, instance_loss: 0.2845, weighted_loss: 0.3055, label: 3, bag_size: 50
batch 99, loss: 1.0545, instance_loss: 0.4615, weighted_loss: 0.8766, label: 0, bag_size: 385
batch 119, loss: 1.2862, instance_loss: 0.4941, weighted_loss: 1.0486, label: 2, bag_size: 259
batch 139, loss: 1.3238, instance_loss: 0.4551, weighted_loss: 1.0632, label: 1, bag_size: 867
batch 159, loss: 0.7969, instance_loss: 0.3772, weighted_loss: 0.6710, label: 1, bag_size: 945
batch 179, loss: 1.0406, instance_loss: 0.4483, weighted_loss: 0.8629, label: 2, bag_size: 730
batch 199, loss: 1.0932, instance_loss: 0.4445, weighted_loss: 0.8986, label: 2, bag_size: 649
batch 219, loss: 2.0898, instance_loss: 0.8257, weighted_loss: 1.7106, label: 0, bag_size: 109
batch 239, loss: 0.2253, instance_loss: 0.3273, weighted_loss: 0.2559, label: 4, bag_size: 23
batch 259, loss: 1.6597, instance_loss: 0.4590, weighted_loss: 1.2995, label: 1, bag_size: 657
batch 279, loss: 0.8946, instance_loss: 0.3496, weighted_loss: 0.7311, label: 3, bag_size: 1172
batch 299, loss: 1.5048, instance_loss: 0.4149, weighted_loss: 1.1778, label: 1, bag_size: 660
batch 319, loss: 1.2874, instance_loss: 0.5025, weighted_loss: 1.0519, label: 2, bag_size: 1653
batch 339, loss: 1.6276, instance_loss: 0.5025, weighted_loss: 1.2901, label: 0, bag_size: 282
batch 359, loss: 0.8398, instance_loss: 0.3437, weighted_loss: 0.6909, label: 1, bag_size: 269
batch 379, loss: 0.3655, instance_loss: 0.2794, weighted_loss: 0.3397, label: 1, bag_size: 1426
batch 399, loss: 0.8197, instance_loss: 0.4266, weighted_loss: 0.7017, label: 0, bag_size: 1133
batch 419, loss: 0.2967, instance_loss: 0.3244, weighted_loss: 0.3050, label: 3, bag_size: 18
batch 439, loss: 2.5399, instance_loss: 0.5287, weighted_loss: 1.9365, label: 3, bag_size: 952
batch 459, loss: 0.3493, instance_loss: 0.2627, weighted_loss: 0.3234, label: 1, bag_size: 828
batch 479, loss: 1.2171, instance_loss: 0.4956, weighted_loss: 1.0006, label: 2, bag_size: 270
batch 499, loss: 0.0798, instance_loss: 0.1728, weighted_loss: 0.1077, label: 3, bag_size: 26
batch 519, loss: 0.9058, instance_loss: 0.4418, weighted_loss: 0.7666, label: 2, bag_size: 1164
batch 539, loss: 1.0650, instance_loss: 0.3396, weighted_loss: 0.8474, label: 3, bag_size: 697


class 0 clustering acc 0.9958256880733944: correct 21709/21800
class 1 clustering acc 0.13853211009174313: correct 604/4360
Epoch: 2, train_loss: 0.9988, train_clustering_loss:  0.4049, train_error: 0.3578
class 0: acc 0.6779661016949152, correct 80/118
class 1: acc 0.6639344262295082, correct 81/122
class 2: acc 0.3235294117647059, correct 33/102
class 3: acc 0.7676767676767676, correct 76/99
class 4: acc 0.7692307692307693, correct 80/104

Val Set, val_loss: 1.1981, val_error: 0.4600, auc: 0.8541
class 0 clustering acc 0.998: correct 1996/2000
class 1 clustering acc 0.055: correct 22/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.55, correct 11/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.25, correct 2/8
Validation loss decreased (1.309038 --> 1.198061).  Saving model ...


batch 19, loss: 0.8929, instance_loss: 0.4502, weighted_loss: 0.7601, label: 0, bag_size: 1517
batch 39, loss: 0.8714, instance_loss: 0.4241, weighted_loss: 0.7372, label: 2, bag_size: 356
batch 59, loss: 1.2781, instance_loss: 0.4830, weighted_loss: 1.0396, label: 1, bag_size: 318
batch 79, loss: 2.7492, instance_loss: 0.6434, weighted_loss: 2.1174, label: 1, bag_size: 1172
batch 99, loss: 3.1902, instance_loss: 0.8098, weighted_loss: 2.4761, label: 3, bag_size: 1167
batch 119, loss: 2.5290, instance_loss: 0.6482, weighted_loss: 1.9647, label: 4, bag_size: 663
batch 139, loss: 0.5807, instance_loss: 0.3437, weighted_loss: 0.5096, label: 1, bag_size: 530
batch 159, loss: 1.2070, instance_loss: 0.4586, weighted_loss: 0.9825, label: 1, bag_size: 448
batch 179, loss: 0.8159, instance_loss: 0.3479, weighted_loss: 0.6755, label: 1, bag_size: 959
batch 199, loss: 0.1139, instance_loss: 0.2389, weighted_loss: 0.1514, label: 3, bag_size: 20
batch 219, loss: 0.6292, instance_loss: 0.4240, weighted_loss: 0.5676, label: 0, bag_size: 385
batch 239, loss: 0.4868, instance_loss: 0.3873, weighted_loss: 0.4570, label: 0, bag_size: 385
batch 259, loss: 0.9037, instance_loss: 0.4503, weighted_loss: 0.7677, label: 2, bag_size: 317
batch 279, loss: 2.3197, instance_loss: 0.6832, weighted_loss: 1.8288, label: 4, bag_size: 625
batch 299, loss: 0.3187, instance_loss: 0.2319, weighted_loss: 0.2926, label: 1, bag_size: 288
batch 319, loss: 0.1589, instance_loss: 0.1012, weighted_loss: 0.1416, label: 4, bag_size: 167
batch 339, loss: 1.3685, instance_loss: 0.5282, weighted_loss: 1.1164, label: 0, bag_size: 1332
batch 359, loss: 0.1264, instance_loss: 0.1641, weighted_loss: 0.1377, label: 3, bag_size: 19
batch 379, loss: 1.3124, instance_loss: 0.4500, weighted_loss: 1.0537, label: 2, bag_size: 809
batch 399, loss: 0.7981, instance_loss: 0.3890, weighted_loss: 0.6754, label: 2, bag_size: 1150
batch 419, loss: 0.3921, instance_loss: 0.2815, weighted_loss: 0.3590, label: 1, bag_size: 696
batch 439, loss: 1.0275, instance_loss: 0.3927, weighted_loss: 0.8370, label: 1, bag_size: 711
batch 459, loss: 0.9879, instance_loss: 0.4108, weighted_loss: 0.8148, label: 2, bag_size: 396
batch 479, loss: 0.1498, instance_loss: 0.0889, weighted_loss: 0.1315, label: 4, bag_size: 130
batch 499, loss: 0.1287, instance_loss: 0.1371, weighted_loss: 0.1312, label: 4, bag_size: 160
batch 519, loss: 0.8090, instance_loss: 0.4024, weighted_loss: 0.6870, label: 2, bag_size: 347
batch 539, loss: 0.6720, instance_loss: 0.4237, weighted_loss: 0.5975, label: 0, bag_size: 255


class 0 clustering acc 0.9962844036697248: correct 21719/21800
class 1 clustering acc 0.19587155963302752: correct 854/4360
Epoch: 3, train_loss: 0.9369, train_clustering_loss:  0.3900, train_error: 0.3413
class 0: acc 0.6306306306306306, correct 70/111
class 1: acc 0.6551724137931034, correct 76/116
class 2: acc 0.6, correct 69/115
class 3: acc 0.7623762376237624, correct 77/101
class 4: acc 0.6568627450980392, correct 67/102

Val Set, val_loss: 1.1876, val_error: 0.5200, auc: 0.8684
class 0 clustering acc 0.9935: correct 1987/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.25, correct 5/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.375, correct 3/8
Validation loss decreased (1.198061 --> 1.187641).  Saving model ...


batch 19, loss: 0.4012, instance_loss: 0.3227, weighted_loss: 0.3777, label: 0, bag_size: 432
batch 39, loss: 0.6862, instance_loss: 0.3972, weighted_loss: 0.5995, label: 2, bag_size: 1448
batch 59, loss: 0.1488, instance_loss: 0.1655, weighted_loss: 0.1538, label: 3, bag_size: 20
batch 79, loss: 0.6158, instance_loss: 0.3497, weighted_loss: 0.5359, label: 2, bag_size: 868
batch 99, loss: 0.7851, instance_loss: 0.4212, weighted_loss: 0.6759, label: 2, bag_size: 270
batch 119, loss: 0.1999, instance_loss: 0.1668, weighted_loss: 0.1899, label: 1, bag_size: 903
batch 139, loss: 0.4245, instance_loss: 0.2708, weighted_loss: 0.3784, label: 1, bag_size: 614
batch 159, loss: 0.2745, instance_loss: 0.1798, weighted_loss: 0.2461, label: 1, bag_size: 903
batch 179, loss: 0.2057, instance_loss: 0.1389, weighted_loss: 0.1857, label: 1, bag_size: 994
batch 199, loss: 0.0513, instance_loss: 0.0717, weighted_loss: 0.0574, label: 4, bag_size: 211
batch 219, loss: 0.0663, instance_loss: 0.0528, weighted_loss: 0.0623, label: 4, bag_size: 162
batch 239, loss: 1.2167, instance_loss: 0.5236, weighted_loss: 1.0088, label: 2, bag_size: 537
batch 259, loss: 0.8511, instance_loss: 0.4578, weighted_loss: 0.7331, label: 0, bag_size: 1018
batch 279, loss: 2.9319, instance_loss: 0.7229, weighted_loss: 2.2692, label: 4, bag_size: 663
batch 299, loss: 0.7070, instance_loss: 0.3530, weighted_loss: 0.6008, label: 1, bag_size: 102
batch 319, loss: 0.1340, instance_loss: 0.2020, weighted_loss: 0.1544, label: 4, bag_size: 63
batch 339, loss: 0.4986, instance_loss: 0.2526, weighted_loss: 0.4248, label: 1, bag_size: 598
batch 359, loss: 0.0357, instance_loss: 0.1051, weighted_loss: 0.0565, label: 3, bag_size: 20
batch 379, loss: 2.1196, instance_loss: 0.6016, weighted_loss: 1.6642, label: 2, bag_size: 1006
batch 399, loss: 0.5406, instance_loss: 0.3775, weighted_loss: 0.4916, label: 2, bag_size: 1119
batch 419, loss: 1.1037, instance_loss: 0.4782, weighted_loss: 0.9160, label: 0, bag_size: 424
batch 439, loss: 0.8981, instance_loss: 0.4033, weighted_loss: 0.7497, label: 2, bag_size: 1150
batch 459, loss: 0.5603, instance_loss: 0.3897, weighted_loss: 0.5092, label: 0, bag_size: 933
batch 479, loss: 1.2031, instance_loss: 0.3714, weighted_loss: 0.9536, label: 1, bag_size: 838
batch 499, loss: 0.0465, instance_loss: 0.0564, weighted_loss: 0.0495, label: 4, bag_size: 140
batch 519, loss: 1.8166, instance_loss: 0.5241, weighted_loss: 1.4289, label: 1, bag_size: 1559
batch 539, loss: 1.9476, instance_loss: 0.6416, weighted_loss: 1.5558, label: 4, bag_size: 625


class 0 clustering acc 0.9934403669724771: correct 21657/21800
class 1 clustering acc 0.30091743119266057: correct 1312/4360
Epoch: 4, train_loss: 0.7929, train_clustering_loss:  0.3511, train_error: 0.3028
class 0: acc 0.6774193548387096, correct 63/93
class 1: acc 0.7222222222222222, correct 91/126
class 2: acc 0.5339805825242718, correct 55/103
class 3: acc 0.7946428571428571, correct 89/112
class 4: acc 0.7387387387387387, correct 82/111

Val Set, val_loss: 1.0209, val_error: 0.4000, auc: 0.8755
class 0 clustering acc 0.9925: correct 1985/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.65, correct 13/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.25, correct 2/8
Validation loss decreased (1.187641 --> 1.020854).  Saving model ...


batch 19, loss: 0.6523, instance_loss: 0.3308, weighted_loss: 0.5558, label: 1, bag_size: 949
batch 39, loss: 0.6353, instance_loss: 0.4009, weighted_loss: 0.5650, label: 4, bag_size: 1121
batch 59, loss: 0.8289, instance_loss: 0.3656, weighted_loss: 0.6899, label: 1, bag_size: 442
batch 79, loss: 0.4493, instance_loss: 0.3790, weighted_loss: 0.4282, label: 0, bag_size: 807
batch 99, loss: 0.2854, instance_loss: 0.3395, weighted_loss: 0.3017, label: 0, bag_size: 607
batch 119, loss: 1.3140, instance_loss: 0.7968, weighted_loss: 1.1588, label: 0, bag_size: 128
batch 139, loss: 0.5000, instance_loss: 0.3504, weighted_loss: 0.4551, label: 2, bag_size: 750
batch 159, loss: 1.3346, instance_loss: 0.4899, weighted_loss: 1.0812, label: 2, bag_size: 194
batch 179, loss: 0.7536, instance_loss: 0.4009, weighted_loss: 0.6478, label: 1, bag_size: 1096
batch 199, loss: 1.2261, instance_loss: 0.4836, weighted_loss: 1.0033, label: 2, bag_size: 194
batch 219, loss: 0.1431, instance_loss: 0.2425, weighted_loss: 0.1729, label: 4, bag_size: 28
batch 239, loss: 1.4809, instance_loss: 0.8866, weighted_loss: 1.3026, label: 0, bag_size: 114
batch 259, loss: 0.7347, instance_loss: 0.4340, weighted_loss: 0.6445, label: 0, bag_size: 552
batch 279, loss: 0.3419, instance_loss: 0.2609, weighted_loss: 0.3176, label: 1, bag_size: 945
batch 299, loss: 0.0303, instance_loss: 0.1993, weighted_loss: 0.0810, label: 4, bag_size: 20
batch 319, loss: 3.0073, instance_loss: 1.0603, weighted_loss: 2.4232, label: 1, bag_size: 867
batch 339, loss: 0.9618, instance_loss: 0.4515, weighted_loss: 0.8087, label: 4, bag_size: 773
batch 359, loss: 0.4350, instance_loss: 0.3924, weighted_loss: 0.4222, label: 0, bag_size: 1101
batch 379, loss: 0.8286, instance_loss: 0.7341, weighted_loss: 0.8003, label: 0, bag_size: 116
batch 399, loss: 2.8521, instance_loss: 0.7161, weighted_loss: 2.2113, label: 1, bag_size: 293
batch 419, loss: 2.3102, instance_loss: 0.5981, weighted_loss: 1.7966, label: 4, bag_size: 1235
batch 439, loss: 0.7047, instance_loss: 0.4144, weighted_loss: 0.6176, label: 0, bag_size: 1255
batch 459, loss: 0.5764, instance_loss: 0.3331, weighted_loss: 0.5034, label: 2, bag_size: 774
batch 479, loss: 0.8350, instance_loss: 0.4560, weighted_loss: 0.7213, label: 2, bag_size: 1569
batch 499, loss: 1.6427, instance_loss: 0.5282, weighted_loss: 1.3083, label: 2, bag_size: 272
batch 519, loss: 0.1291, instance_loss: 0.3055, weighted_loss: 0.1820, label: 4, bag_size: 178
batch 539, loss: 0.5635, instance_loss: 0.2628, weighted_loss: 0.4732, label: 1, bag_size: 346


class 0 clustering acc 0.9928440366972477: correct 21644/21800
class 1 clustering acc 0.2589449541284404: correct 1129/4360
Epoch: 5, train_loss: 0.7737, train_clustering_loss:  0.3616, train_error: 0.2936
class 0: acc 0.7037037037037037, correct 76/108
class 1: acc 0.6272727272727273, correct 69/110
class 2: acc 0.6296296296296297, correct 68/108
class 3: acc 0.7941176470588235, correct 81/102
class 4: acc 0.7777777777777778, correct 91/117

Val Set, val_loss: 1.0606, val_error: 0.4600, auc: 0.8779
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.135: correct 54/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.45, correct 9/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.25, correct 2/8
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8707, instance_loss: 0.4067, weighted_loss: 0.7315, label: 1, bag_size: 1014
batch 39, loss: 0.6990, instance_loss: 0.3383, weighted_loss: 0.5908, label: 2, bag_size: 1133
batch 59, loss: 0.0512, instance_loss: 0.1531, weighted_loss: 0.0818, label: 3, bag_size: 20
batch 79, loss: 0.9876, instance_loss: 0.3376, weighted_loss: 0.7926, label: 2, bag_size: 358
batch 99, loss: 1.1988, instance_loss: 0.4956, weighted_loss: 0.9879, label: 1, bag_size: 343
batch 119, loss: 0.7113, instance_loss: 0.6815, weighted_loss: 0.7024, label: 0, bag_size: 163
batch 139, loss: 0.9363, instance_loss: 0.4194, weighted_loss: 0.7813, label: 2, bag_size: 351
batch 159, loss: 1.4139, instance_loss: 0.6591, weighted_loss: 1.1875, label: 4, bag_size: 711
batch 179, loss: 0.9499, instance_loss: 0.4467, weighted_loss: 0.7989, label: 2, bag_size: 474
batch 199, loss: 0.9004, instance_loss: 0.4374, weighted_loss: 0.7615, label: 0, bag_size: 800
batch 219, loss: 0.1812, instance_loss: 0.2869, weighted_loss: 0.2129, label: 0, bag_size: 1012
batch 239, loss: 1.1590, instance_loss: 0.4358, weighted_loss: 0.9420, label: 1, bag_size: 343
batch 259, loss: 1.0234, instance_loss: 0.5794, weighted_loss: 0.8902, label: 3, bag_size: 230
batch 279, loss: 0.8244, instance_loss: 0.4028, weighted_loss: 0.6980, label: 2, bag_size: 471
batch 299, loss: 0.4818, instance_loss: 0.2339, weighted_loss: 0.4074, label: 1, bag_size: 474
batch 319, loss: 0.3419, instance_loss: 0.3480, weighted_loss: 0.3437, label: 0, bag_size: 1174
batch 339, loss: 0.0285, instance_loss: 0.2197, weighted_loss: 0.0859, label: 3, bag_size: 18
batch 359, loss: 0.0119, instance_loss: 0.0721, weighted_loss: 0.0300, label: 3, bag_size: 43
batch 379, loss: 2.1427, instance_loss: 0.5447, weighted_loss: 1.6633, label: 1, bag_size: 657
batch 399, loss: 0.1254, instance_loss: 0.1239, weighted_loss: 0.1250, label: 4, bag_size: 150
batch 419, loss: 0.4526, instance_loss: 0.3236, weighted_loss: 0.4139, label: 1, bag_size: 530
batch 439, loss: 1.4253, instance_loss: 0.4466, weighted_loss: 1.1317, label: 1, bag_size: 1724
batch 459, loss: 0.2140, instance_loss: 0.3037, weighted_loss: 0.2409, label: 0, bag_size: 1466
batch 479, loss: 3.4265, instance_loss: 1.0527, weighted_loss: 2.7144, label: 3, bag_size: 607
batch 499, loss: 1.9861, instance_loss: 0.5611, weighted_loss: 1.5586, label: 3, bag_size: 281
batch 519, loss: 0.5962, instance_loss: 0.3694, weighted_loss: 0.5282, label: 1, bag_size: 711
batch 539, loss: 1.4160, instance_loss: 0.4863, weighted_loss: 1.1371, label: 2, bag_size: 883


class 0 clustering acc 0.9921100917431193: correct 21628/21800
class 1 clustering acc 0.24174311926605505: correct 1054/4360
Epoch: 6, train_loss: 0.7450, train_clustering_loss:  0.3629, train_error: 0.2771
class 0: acc 0.752, correct 94/125
class 1: acc 0.6138613861386139, correct 62/101
class 2: acc 0.6810344827586207, correct 79/116
class 3: acc 0.81, correct 81/100
class 4: acc 0.7572815533980582, correct 78/103

Val Set, val_loss: 1.1688, val_error: 0.5200, auc: 0.8800
class 0 clustering acc 0.9925: correct 1985/2000
class 1 clustering acc 0.1425: correct 57/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.3, correct 6/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.25, correct 2/8
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4296, instance_loss: 0.5081, weighted_loss: 1.1531, label: 0, bag_size: 801
batch 39, loss: 0.6644, instance_loss: 0.6625, weighted_loss: 0.6638, label: 0, bag_size: 109
batch 59, loss: 0.5216, instance_loss: 0.3282, weighted_loss: 0.4635, label: 2, bag_size: 471
batch 79, loss: 0.5853, instance_loss: 0.3556, weighted_loss: 0.5164, label: 2, bag_size: 247
batch 99, loss: 0.2543, instance_loss: 0.1464, weighted_loss: 0.2219, label: 1, bag_size: 1191
batch 119, loss: 0.0610, instance_loss: 0.1313, weighted_loss: 0.0821, label: 3, bag_size: 18
batch 139, loss: 1.7181, instance_loss: 0.5572, weighted_loss: 1.3698, label: 3, bag_size: 343
batch 159, loss: 1.2925, instance_loss: 0.5148, weighted_loss: 1.0592, label: 4, bag_size: 1357
batch 179, loss: 0.5016, instance_loss: 0.3167, weighted_loss: 0.4461, label: 2, bag_size: 600
batch 199, loss: 1.0098, instance_loss: 0.4001, weighted_loss: 0.8269, label: 1, bag_size: 1255
batch 219, loss: 0.3709, instance_loss: 0.2194, weighted_loss: 0.3254, label: 1, bag_size: 1127
batch 239, loss: 1.1332, instance_loss: 0.5359, weighted_loss: 0.9540, label: 0, bag_size: 282
batch 259, loss: 0.6523, instance_loss: 0.3744, weighted_loss: 0.5689, label: 0, bag_size: 350
batch 279, loss: 0.0579, instance_loss: 0.1997, weighted_loss: 0.1004, label: 0, bag_size: 982
batch 299, loss: 2.1508, instance_loss: 0.5546, weighted_loss: 1.6719, label: 2, bag_size: 373
batch 319, loss: 0.3166, instance_loss: 0.2154, weighted_loss: 0.2862, label: 1, bag_size: 405
batch 339, loss: 0.0510, instance_loss: 0.0950, weighted_loss: 0.0642, label: 3, bag_size: 451
batch 359, loss: 0.1382, instance_loss: 0.3837, weighted_loss: 0.2118, label: 4, bag_size: 24
batch 379, loss: 0.0162, instance_loss: 0.1326, weighted_loss: 0.0511, label: 3, bag_size: 26
batch 399, loss: 0.6133, instance_loss: 0.3098, weighted_loss: 0.5222, label: 2, bag_size: 701
batch 419, loss: 0.7030, instance_loss: 0.3759, weighted_loss: 0.6049, label: 2, bag_size: 404
batch 439, loss: 0.4570, instance_loss: 0.4981, weighted_loss: 0.4693, label: 0, bag_size: 114
batch 459, loss: 0.8173, instance_loss: 0.3820, weighted_loss: 0.6867, label: 2, bag_size: 1653
batch 479, loss: 2.5568, instance_loss: 0.7134, weighted_loss: 2.0037, label: 0, bag_size: 801
batch 499, loss: 0.7558, instance_loss: 0.4009, weighted_loss: 0.6493, label: 1, bag_size: 917
batch 519, loss: 2.6594, instance_loss: 0.7056, weighted_loss: 2.0732, label: 3, bag_size: 1380
batch 539, loss: 0.0161, instance_loss: 0.0274, weighted_loss: 0.0195, label: 3, bag_size: 66


class 0 clustering acc 0.9930275229357798: correct 21648/21800
class 1 clustering acc 0.2974770642201835: correct 1297/4360
Epoch: 7, train_loss: 0.6584, train_clustering_loss:  0.3348, train_error: 0.2330
class 0: acc 0.8103448275862069, correct 94/116
class 1: acc 0.6090909090909091, correct 67/110
class 2: acc 0.71, correct 71/100
class 3: acc 0.8813559322033898, correct 104/118
class 4: acc 0.8118811881188119, correct 82/101

Val Set, val_loss: 1.1032, val_error: 0.4400, auc: 0.8975
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.2075: correct 83/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 1.0, correct 7/7
class 2: acc 0.3, correct 6/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.375, correct 3/8
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8998, instance_loss: 0.6125, weighted_loss: 0.8136, label: 3, bag_size: 1250
batch 39, loss: 0.8669, instance_loss: 0.4442, weighted_loss: 0.7401, label: 2, bag_size: 1164
batch 59, loss: 0.8184, instance_loss: 0.5270, weighted_loss: 0.7310, label: 4, bag_size: 1360
batch 79, loss: 1.5773, instance_loss: 0.7701, weighted_loss: 1.3351, label: 0, bag_size: 143
batch 99, loss: 1.1078, instance_loss: 0.4472, weighted_loss: 0.9096, label: 2, bag_size: 1231
batch 119, loss: 0.6043, instance_loss: 0.3690, weighted_loss: 0.5337, label: 0, bag_size: 1190
batch 139, loss: 0.6864, instance_loss: 0.3490, weighted_loss: 0.5852, label: 2, bag_size: 1378
batch 159, loss: 1.4204, instance_loss: 0.3965, weighted_loss: 1.1132, label: 2, bag_size: 848
batch 179, loss: 1.5204, instance_loss: 0.5296, weighted_loss: 1.2231, label: 0, bag_size: 423
batch 199, loss: 0.7663, instance_loss: 0.4330, weighted_loss: 0.6663, label: 4, bag_size: 826
batch 219, loss: 1.3524, instance_loss: 0.8098, weighted_loss: 1.1896, label: 0, bag_size: 116
batch 239, loss: 1.0153, instance_loss: 0.4550, weighted_loss: 0.8472, label: 2, bag_size: 676
batch 259, loss: 0.1065, instance_loss: 0.0846, weighted_loss: 0.0999, label: 4, bag_size: 96
batch 279, loss: 0.2030, instance_loss: 0.1990, weighted_loss: 0.2018, label: 2, bag_size: 1019
batch 299, loss: 0.4914, instance_loss: 0.3305, weighted_loss: 0.4432, label: 2, bag_size: 1569
batch 319, loss: 0.8087, instance_loss: 0.3580, weighted_loss: 0.6735, label: 1, bag_size: 965
batch 339, loss: 0.0141, instance_loss: 0.0587, weighted_loss: 0.0275, label: 3, bag_size: 87
batch 359, loss: 1.8318, instance_loss: 0.6183, weighted_loss: 1.4677, label: 1, bag_size: 308
batch 379, loss: 0.1758, instance_loss: 0.2377, weighted_loss: 0.1944, label: 0, bag_size: 933
batch 399, loss: 1.0317, instance_loss: 0.4739, weighted_loss: 0.8644, label: 2, bag_size: 1677
batch 419, loss: 0.3709, instance_loss: 0.3332, weighted_loss: 0.3596, label: 2, bag_size: 324
batch 439, loss: 1.8857, instance_loss: 0.4941, weighted_loss: 1.4682, label: 2, bag_size: 948
batch 459, loss: 0.0750, instance_loss: 0.2820, weighted_loss: 0.1371, label: 4, bag_size: 19
batch 479, loss: 0.1279, instance_loss: 0.1434, weighted_loss: 0.1325, label: 3, bag_size: 18
batch 499, loss: 0.1996, instance_loss: 0.1615, weighted_loss: 0.1881, label: 1, bag_size: 346
batch 519, loss: 0.0399, instance_loss: 0.2151, weighted_loss: 0.0925, label: 3, bag_size: 18
batch 539, loss: 1.1110, instance_loss: 0.6561, weighted_loss: 0.9745, label: 4, bag_size: 1360


class 0 clustering acc 0.9911467889908256: correct 21607/21800
class 1 clustering acc 0.28990825688073396: correct 1264/4360
Epoch: 8, train_loss: 0.6443, train_clustering_loss:  0.3449, train_error: 0.2349
class 0: acc 0.8, correct 96/120
class 1: acc 0.6415094339622641, correct 68/106
class 2: acc 0.7586206896551724, correct 88/116
class 3: acc 0.8285714285714286, correct 87/105
class 4: acc 0.7959183673469388, correct 78/98

Val Set, val_loss: 1.0440, val_error: 0.5000, auc: 0.9020
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.215: correct 86/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.45, correct 9/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.25, correct 2/8
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0423, instance_loss: 0.0893, weighted_loss: 0.0564, label: 3, bag_size: 97
batch 39, loss: 2.1071, instance_loss: 0.6223, weighted_loss: 1.6617, label: 0, bag_size: 282
batch 59, loss: 0.6910, instance_loss: 0.5198, weighted_loss: 0.6397, label: 2, bag_size: 1235
batch 79, loss: 0.8723, instance_loss: 0.2968, weighted_loss: 0.6996, label: 0, bag_size: 338
batch 99, loss: 0.0691, instance_loss: 0.0980, weighted_loss: 0.0778, label: 3, bag_size: 28
batch 119, loss: 0.0964, instance_loss: 0.2322, weighted_loss: 0.1371, label: 3, bag_size: 15
batch 139, loss: 3.9133, instance_loss: 0.8489, weighted_loss: 2.9940, label: 4, bag_size: 210
batch 159, loss: 0.2059, instance_loss: 0.0967, weighted_loss: 0.1731, label: 1, bag_size: 1277
batch 179, loss: 1.0927, instance_loss: 0.4310, weighted_loss: 0.8942, label: 1, bag_size: 936
batch 199, loss: 0.0493, instance_loss: 0.1049, weighted_loss: 0.0660, label: 3, bag_size: 75
batch 219, loss: 0.8850, instance_loss: 0.5135, weighted_loss: 0.7736, label: 0, bag_size: 1527
batch 239, loss: 0.5494, instance_loss: 0.3617, weighted_loss: 0.4931, label: 2, bag_size: 471
batch 259, loss: 0.0626, instance_loss: 0.0941, weighted_loss: 0.0721, label: 3, bag_size: 1172
batch 279, loss: 0.3553, instance_loss: 0.3201, weighted_loss: 0.3448, label: 0, bag_size: 731
batch 299, loss: 0.2260, instance_loss: 0.1217, weighted_loss: 0.1947, label: 1, bag_size: 834
batch 319, loss: 0.2248, instance_loss: 0.5326, weighted_loss: 0.3172, label: 4, bag_size: 1474
batch 339, loss: 0.4139, instance_loss: 0.3365, weighted_loss: 0.3907, label: 2, bag_size: 638
batch 359, loss: 0.2764, instance_loss: 0.1640, weighted_loss: 0.2427, label: 1, bag_size: 994
batch 379, loss: 1.2088, instance_loss: 0.5286, weighted_loss: 1.0047, label: 2, bag_size: 1218
batch 399, loss: 0.1130, instance_loss: 0.0916, weighted_loss: 0.1066, label: 1, bag_size: 369
batch 419, loss: 0.0575, instance_loss: 0.1148, weighted_loss: 0.0747, label: 0, bag_size: 385
batch 439, loss: 0.4602, instance_loss: 0.3531, weighted_loss: 0.4280, label: 0, bag_size: 1255
batch 459, loss: 0.0173, instance_loss: 0.2158, weighted_loss: 0.0769, label: 3, bag_size: 18
batch 479, loss: 1.1897, instance_loss: 0.5093, weighted_loss: 0.9856, label: 2, bag_size: 687
batch 499, loss: 2.0344, instance_loss: 0.8973, weighted_loss: 1.6933, label: 2, bag_size: 1677
batch 519, loss: 0.4095, instance_loss: 0.2461, weighted_loss: 0.3605, label: 1, bag_size: 746
batch 539, loss: 0.1142, instance_loss: 0.1772, weighted_loss: 0.1331, label: 0, bag_size: 521


class 0 clustering acc 0.9909633027522936: correct 21603/21800
class 1 clustering acc 0.33876146788990824: correct 1477/4360
Epoch: 9, train_loss: 0.6700, train_clustering_loss:  0.3344, train_error: 0.2532
class 0: acc 0.8041237113402062, correct 78/97
class 1: acc 0.7222222222222222, correct 91/126
class 2: acc 0.63, correct 63/100
class 3: acc 0.822429906542056, correct 88/107
class 4: acc 0.7565217391304347, correct 87/115

Val Set, val_loss: 0.8574, val_error: 0.3400, auc: 0.9138
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.875, correct 7/8
Validation loss decreased (1.020854 --> 0.857417).  Saving model ...


batch 19, loss: 0.2452, instance_loss: 0.3434, weighted_loss: 0.2747, label: 4, bag_size: 1121
batch 39, loss: 0.2970, instance_loss: 0.2383, weighted_loss: 0.2794, label: 1, bag_size: 858
batch 59, loss: 1.0999, instance_loss: 0.4847, weighted_loss: 0.9153, label: 4, bag_size: 754
batch 79, loss: 0.2151, instance_loss: 0.2135, weighted_loss: 0.2146, label: 0, bag_size: 1018
batch 99, loss: 0.5257, instance_loss: 0.3936, weighted_loss: 0.4861, label: 2, bag_size: 1439
batch 119, loss: 0.3336, instance_loss: 0.2835, weighted_loss: 0.3186, label: 1, bag_size: 860
batch 139, loss: 0.9627, instance_loss: 0.4592, weighted_loss: 0.8116, label: 2, bag_size: 384
batch 159, loss: 0.7284, instance_loss: 0.4819, weighted_loss: 0.6545, label: 4, bag_size: 524
batch 179, loss: 0.6411, instance_loss: 0.6996, weighted_loss: 0.6587, label: 0, bag_size: 128
batch 199, loss: 0.3419, instance_loss: 0.4728, weighted_loss: 0.3811, label: 0, bag_size: 117
batch 219, loss: 0.0575, instance_loss: 0.0816, weighted_loss: 0.0647, label: 3, bag_size: 143
batch 239, loss: 0.3765, instance_loss: 0.1603, weighted_loss: 0.3116, label: 1, bag_size: 869
batch 259, loss: 0.8354, instance_loss: 0.4897, weighted_loss: 0.7317, label: 1, bag_size: 917
batch 279, loss: 2.9222, instance_loss: 0.6783, weighted_loss: 2.2490, label: 1, bag_size: 386
batch 299, loss: 0.0066, instance_loss: 0.0829, weighted_loss: 0.0295, label: 3, bag_size: 18
batch 319, loss: 0.0111, instance_loss: 0.0847, weighted_loss: 0.0332, label: 3, bag_size: 143
batch 339, loss: 0.6750, instance_loss: 0.4683, weighted_loss: 0.6130, label: 4, bag_size: 928
batch 359, loss: 0.0299, instance_loss: 0.1173, weighted_loss: 0.0561, label: 3, bag_size: 19
batch 379, loss: 0.0499, instance_loss: 0.0994, weighted_loss: 0.0648, label: 3, bag_size: 94
batch 399, loss: 0.6741, instance_loss: 0.3867, weighted_loss: 0.5879, label: 3, bag_size: 697
batch 419, loss: 0.5474, instance_loss: 0.4110, weighted_loss: 0.5065, label: 0, bag_size: 478
batch 439, loss: 0.8227, instance_loss: 0.5755, weighted_loss: 0.7486, label: 3, bag_size: 230
batch 459, loss: 1.2592, instance_loss: 0.5051, weighted_loss: 1.0330, label: 3, bag_size: 200
batch 479, loss: 0.6740, instance_loss: 0.5536, weighted_loss: 0.6379, label: 4, bag_size: 826
batch 499, loss: 0.6764, instance_loss: 0.3859, weighted_loss: 0.5892, label: 2, bag_size: 1164
batch 519, loss: 4.7137, instance_loss: 0.8341, weighted_loss: 3.5498, label: 4, bag_size: 210
batch 539, loss: 0.6178, instance_loss: 0.4264, weighted_loss: 0.5604, label: 2, bag_size: 396


class 0 clustering acc 0.9910550458715597: correct 21605/21800
class 1 clustering acc 0.36559633027522936: correct 1594/4360
Epoch: 10, train_loss: 0.5197, train_clustering_loss:  0.3121, train_error: 0.1853
class 0: acc 0.8521739130434782, correct 98/115
class 1: acc 0.7676767676767676, correct 76/99
class 2: acc 0.7019230769230769, correct 73/104
class 3: acc 0.8686868686868687, correct 86/99
class 4: acc 0.8671875, correct 111/128

Val Set, val_loss: 0.9207, val_error: 0.4200, auc: 0.9042
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.265: correct 106/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.35, correct 7/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0539, instance_loss: 0.1116, weighted_loss: 0.0712, label: 4, bag_size: 110
batch 39, loss: 1.0272, instance_loss: 0.4502, weighted_loss: 0.8541, label: 2, bag_size: 1006
batch 59, loss: 0.4408, instance_loss: 0.4926, weighted_loss: 0.4563, label: 0, bag_size: 143
batch 79, loss: 0.1343, instance_loss: 0.2634, weighted_loss: 0.1731, label: 0, bag_size: 472
batch 99, loss: 0.0222, instance_loss: 0.0548, weighted_loss: 0.0320, label: 4, bag_size: 140
batch 119, loss: 0.2637, instance_loss: 0.2621, weighted_loss: 0.2632, label: 2, bag_size: 1289
batch 139, loss: 0.0698, instance_loss: 0.1213, weighted_loss: 0.0853, label: 4, bag_size: 119
batch 159, loss: 0.0848, instance_loss: 0.1589, weighted_loss: 0.1070, label: 3, bag_size: 18
batch 179, loss: 0.2561, instance_loss: 0.4187, weighted_loss: 0.3049, label: 0, bag_size: 109
batch 199, loss: 0.0610, instance_loss: 0.1893, weighted_loss: 0.0995, label: 3, bag_size: 18
batch 219, loss: 0.0465, instance_loss: 0.1129, weighted_loss: 0.0664, label: 3, bag_size: 29
batch 239, loss: 0.0514, instance_loss: 0.0532, weighted_loss: 0.0519, label: 3, bag_size: 305
batch 259, loss: 0.4093, instance_loss: 0.2695, weighted_loss: 0.3673, label: 4, bag_size: 79
batch 279, loss: 0.1340, instance_loss: 0.2129, weighted_loss: 0.1577, label: 2, bag_size: 317
batch 299, loss: 0.6289, instance_loss: 0.4927, weighted_loss: 0.5881, label: 4, bag_size: 656
batch 319, loss: 0.0114, instance_loss: 0.0436, weighted_loss: 0.0210, label: 4, bag_size: 72
batch 339, loss: 0.1226, instance_loss: 0.2490, weighted_loss: 0.1605, label: 3, bag_size: 1253
batch 359, loss: 0.1546, instance_loss: 0.2222, weighted_loss: 0.1749, label: 0, bag_size: 478
batch 379, loss: 0.3844, instance_loss: 0.3212, weighted_loss: 0.3655, label: 2, bag_size: 1514
batch 399, loss: 0.2761, instance_loss: 0.2360, weighted_loss: 0.2641, label: 0, bag_size: 552
batch 419, loss: 1.0672, instance_loss: 0.3787, weighted_loss: 0.8607, label: 2, bag_size: 676
batch 439, loss: 0.9024, instance_loss: 0.2854, weighted_loss: 0.7173, label: 0, bag_size: 338
batch 459, loss: 0.5150, instance_loss: 0.2390, weighted_loss: 0.4322, label: 3, bag_size: 1399
batch 479, loss: 1.7469, instance_loss: 0.4638, weighted_loss: 1.3620, label: 2, bag_size: 508
batch 499, loss: 1.0257, instance_loss: 0.4537, weighted_loss: 0.8541, label: 2, bag_size: 1006
batch 519, loss: 0.7336, instance_loss: 0.4067, weighted_loss: 0.6355, label: 0, bag_size: 990
batch 539, loss: 0.0852, instance_loss: 0.2621, weighted_loss: 0.1383, label: 4, bag_size: 20


class 0 clustering acc 0.9907798165137615: correct 21599/21800
class 1 clustering acc 0.3839449541284404: correct 1674/4360
Epoch: 11, train_loss: 0.5128, train_clustering_loss:  0.3056, train_error: 0.1835
class 0: acc 0.8492063492063492, correct 107/126
class 1: acc 0.6770833333333334, correct 65/96
class 2: acc 0.7171717171717171, correct 71/99
class 3: acc 0.897196261682243, correct 96/107
class 4: acc 0.905982905982906, correct 106/117

Val Set, val_loss: 0.8789, val_error: 0.4200, auc: 0.9125
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.45, correct 9/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.5, correct 4/8
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0516, instance_loss: 0.2763, weighted_loss: 0.1190, label: 3, bag_size: 21
batch 39, loss: 0.7400, instance_loss: 0.6353, weighted_loss: 0.7086, label: 0, bag_size: 129
batch 59, loss: 0.2759, instance_loss: 0.2447, weighted_loss: 0.2666, label: 4, bag_size: 19
batch 79, loss: 0.0448, instance_loss: 0.1677, weighted_loss: 0.0817, label: 4, bag_size: 40
batch 99, loss: 0.2925, instance_loss: 0.4103, weighted_loss: 0.3278, label: 2, bag_size: 649
batch 119, loss: 0.3372, instance_loss: 0.3107, weighted_loss: 0.3292, label: 2, bag_size: 471
batch 139, loss: 0.3684, instance_loss: 0.3080, weighted_loss: 0.3503, label: 2, bag_size: 1133
batch 159, loss: 0.2320, instance_loss: 0.2602, weighted_loss: 0.2405, label: 2, bag_size: 2826
batch 179, loss: 0.0219, instance_loss: 0.0969, weighted_loss: 0.0444, label: 3, bag_size: 43
batch 199, loss: 0.2708, instance_loss: 0.2223, weighted_loss: 0.2562, label: 1, bag_size: 696
batch 219, loss: 0.4991, instance_loss: 0.4944, weighted_loss: 0.4977, label: 1, bag_size: 917
batch 239, loss: 0.0586, instance_loss: 0.0845, weighted_loss: 0.0664, label: 4, bag_size: 125
batch 259, loss: 0.0090, instance_loss: 0.0634, weighted_loss: 0.0254, label: 4, bag_size: 60
batch 279, loss: 0.9582, instance_loss: 0.4858, weighted_loss: 0.8165, label: 0, bag_size: 759
batch 299, loss: 0.7289, instance_loss: 0.4231, weighted_loss: 0.6372, label: 2, bag_size: 1218
batch 319, loss: 0.3059, instance_loss: 0.2537, weighted_loss: 0.2903, label: 2, bag_size: 471
batch 339, loss: 1.9541, instance_loss: 0.6597, weighted_loss: 1.5658, label: 2, bag_size: 120
batch 359, loss: 0.1643, instance_loss: 0.1461, weighted_loss: 0.1589, label: 3, bag_size: 28
batch 379, loss: 2.1596, instance_loss: 0.7657, weighted_loss: 1.7414, label: 2, bag_size: 518
batch 399, loss: 0.0543, instance_loss: 0.1602, weighted_loss: 0.0860, label: 4, bag_size: 72
batch 419, loss: 0.0347, instance_loss: 0.0964, weighted_loss: 0.0532, label: 4, bag_size: 83
batch 439, loss: 0.0395, instance_loss: 0.1754, weighted_loss: 0.0803, label: 3, bag_size: 18
batch 459, loss: 0.0306, instance_loss: 0.0752, weighted_loss: 0.0439, label: 0, bag_size: 402
batch 479, loss: 0.1172, instance_loss: 0.2085, weighted_loss: 0.1446, label: 0, bag_size: 921
batch 499, loss: 0.1744, instance_loss: 0.2477, weighted_loss: 0.1964, label: 0, bag_size: 921
batch 519, loss: 0.0196, instance_loss: 0.0406, weighted_loss: 0.0259, label: 3, bag_size: 143
batch 539, loss: 0.2294, instance_loss: 0.2709, weighted_loss: 0.2419, label: 2, bag_size: 323


class 0 clustering acc 0.9893577981651376: correct 21568/21800
class 1 clustering acc 0.40894495412844034: correct 1783/4360
Epoch: 12, train_loss: 0.4980, train_clustering_loss:  0.3049, train_error: 0.1743
class 0: acc 0.8846153846153846, correct 92/104
class 1: acc 0.7542372881355932, correct 89/118
class 2: acc 0.7522123893805309, correct 85/113
class 3: acc 0.8703703703703703, correct 94/108
class 4: acc 0.8823529411764706, correct 90/102

Val Set, val_loss: 1.0474, val_error: 0.5000, auc: 0.9158
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.2875: correct 115/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.2, correct 4/20
class 3: acc 0.875, correct 7/8
class 4: acc 0.25, correct 2/8
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2147, instance_loss: 0.3574, weighted_loss: 0.2575, label: 0, bag_size: 653
batch 39, loss: 0.2341, instance_loss: 0.2468, weighted_loss: 0.2379, label: 2, bag_size: 455
batch 59, loss: 0.0196, instance_loss: 0.1951, weighted_loss: 0.0723, label: 4, bag_size: 35
batch 79, loss: 0.0238, instance_loss: 0.1775, weighted_loss: 0.0699, label: 4, bag_size: 35
batch 99, loss: 1.2130, instance_loss: 0.6317, weighted_loss: 1.0386, label: 4, bag_size: 625
batch 119, loss: 0.0190, instance_loss: 0.0756, weighted_loss: 0.0360, label: 4, bag_size: 211
batch 139, loss: 0.1063, instance_loss: 0.1687, weighted_loss: 0.1251, label: 0, bag_size: 381
batch 159, loss: 0.1289, instance_loss: 0.0665, weighted_loss: 0.1102, label: 1, bag_size: 288
batch 179, loss: 0.0041, instance_loss: 0.1311, weighted_loss: 0.0422, label: 4, bag_size: 40
batch 199, loss: 0.6526, instance_loss: 0.3039, weighted_loss: 0.5480, label: 1, bag_size: 139
batch 219, loss: 0.0104, instance_loss: 0.0347, weighted_loss: 0.0177, label: 4, bag_size: 123
batch 239, loss: 0.2839, instance_loss: 0.3832, weighted_loss: 0.3137, label: 2, bag_size: 419
batch 259, loss: 0.0361, instance_loss: 0.2611, weighted_loss: 0.1036, label: 4, bag_size: 19
batch 279, loss: 2.0785, instance_loss: 0.6397, weighted_loss: 1.6469, label: 1, bag_size: 308
batch 299, loss: 0.0969, instance_loss: 0.3732, weighted_loss: 0.1798, label: 0, bag_size: 117
batch 319, loss: 0.9372, instance_loss: 0.5546, weighted_loss: 0.8224, label: 2, bag_size: 1677
batch 339, loss: 0.4772, instance_loss: 0.3801, weighted_loss: 0.4481, label: 0, bag_size: 990
batch 359, loss: 0.0340, instance_loss: 0.1012, weighted_loss: 0.0542, label: 3, bag_size: 28
batch 379, loss: 0.0085, instance_loss: 0.0424, weighted_loss: 0.0187, label: 4, bag_size: 137
batch 399, loss: 1.1520, instance_loss: 0.4526, weighted_loss: 0.9422, label: 1, bag_size: 139
batch 419, loss: 0.0085, instance_loss: 0.0684, weighted_loss: 0.0264, label: 3, bag_size: 34
batch 439, loss: 0.0165, instance_loss: 0.0452, weighted_loss: 0.0251, label: 4, bag_size: 148
batch 459, loss: 0.9194, instance_loss: 0.6762, weighted_loss: 0.8465, label: 3, bag_size: 360
batch 479, loss: 0.8511, instance_loss: 0.3236, weighted_loss: 0.6929, label: 1, bag_size: 778
batch 499, loss: 1.5009, instance_loss: 0.5557, weighted_loss: 1.2173, label: 1, bag_size: 535
batch 519, loss: 0.3375, instance_loss: 0.3036, weighted_loss: 0.3273, label: 2, bag_size: 1155
batch 539, loss: 0.5002, instance_loss: 0.5645, weighted_loss: 0.5195, label: 4, bag_size: 817


class 0 clustering acc 0.9891284403669725: correct 21563/21800
class 1 clustering acc 0.39908256880733944: correct 1740/4360
Epoch: 13, train_loss: 0.4954, train_clustering_loss:  0.3079, train_error: 0.1927
class 0: acc 0.8771929824561403, correct 100/114
class 1: acc 0.7559055118110236, correct 96/127
class 2: acc 0.6732673267326733, correct 68/101
class 3: acc 0.8505747126436781, correct 74/87
class 4: acc 0.8793103448275862, correct 102/116

Val Set, val_loss: 0.9089, val_error: 0.4400, auc: 0.9112
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.3: correct 120/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.375, correct 3/8
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0143, instance_loss: 0.5709, weighted_loss: 0.8813, label: 2, bag_size: 408
batch 39, loss: 0.2573, instance_loss: 0.2297, weighted_loss: 0.2490, label: 2, bag_size: 1019
batch 59, loss: 0.6081, instance_loss: 0.3812, weighted_loss: 0.5401, label: 0, bag_size: 736
batch 79, loss: 1.0720, instance_loss: 0.3166, weighted_loss: 0.8454, label: 2, bag_size: 480
batch 99, loss: 0.2578, instance_loss: 0.2421, weighted_loss: 0.2531, label: 2, bag_size: 730
batch 119, loss: 0.0223, instance_loss: 0.1011, weighted_loss: 0.0459, label: 0, bag_size: 1012
batch 139, loss: 0.4597, instance_loss: 0.3611, weighted_loss: 0.4301, label: 2, bag_size: 391
batch 159, loss: 0.3428, instance_loss: 0.2661, weighted_loss: 0.3198, label: 0, bag_size: 736
batch 179, loss: 0.0999, instance_loss: 0.2522, weighted_loss: 0.1456, label: 4, bag_size: 20
batch 199, loss: 0.2093, instance_loss: 0.3649, weighted_loss: 0.2559, label: 0, bag_size: 148
batch 219, loss: 0.5156, instance_loss: 0.3205, weighted_loss: 0.4571, label: 2, bag_size: 632
batch 239, loss: 0.1530, instance_loss: 0.2174, weighted_loss: 0.1723, label: 2, bag_size: 839
batch 259, loss: 0.0031, instance_loss: 0.0601, weighted_loss: 0.0202, label: 4, bag_size: 157
batch 279, loss: 0.0747, instance_loss: 0.2387, weighted_loss: 0.1239, label: 4, bag_size: 388
batch 299, loss: 0.0336, instance_loss: 0.1187, weighted_loss: 0.0592, label: 0, bag_size: 1143
batch 319, loss: 0.0557, instance_loss: 0.0585, weighted_loss: 0.0566, label: 4, bag_size: 150
batch 339, loss: 0.0005, instance_loss: 0.0338, weighted_loss: 0.0105, label: 4, bag_size: 101
batch 359, loss: 0.6310, instance_loss: 0.3358, weighted_loss: 0.5424, label: 0, bag_size: 990
batch 379, loss: 0.1629, instance_loss: 0.2260, weighted_loss: 0.1818, label: 2, bag_size: 839
batch 399, loss: 0.0044, instance_loss: 0.1766, weighted_loss: 0.0560, label: 4, bag_size: 20
batch 419, loss: 0.0369, instance_loss: 0.0622, weighted_loss: 0.0445, label: 3, bag_size: 75
batch 439, loss: 0.3660, instance_loss: 0.2091, weighted_loss: 0.3189, label: 3, bag_size: 1177
batch 459, loss: 0.7762, instance_loss: 0.3932, weighted_loss: 0.6613, label: 2, bag_size: 1378
batch 479, loss: 0.1309, instance_loss: 0.2539, weighted_loss: 0.1678, label: 4, bag_size: 1235
batch 499, loss: 0.0515, instance_loss: 0.3119, weighted_loss: 0.1296, label: 4, bag_size: 128
batch 519, loss: 0.2307, instance_loss: 0.2634, weighted_loss: 0.2405, label: 2, bag_size: 330
batch 539, loss: 0.0048, instance_loss: 0.0730, weighted_loss: 0.0253, label: 4, bag_size: 79


class 0 clustering acc 0.9890825688073395: correct 21562/21800
class 1 clustering acc 0.42660550458715596: correct 1860/4360
Epoch: 14, train_loss: 0.3904, train_clustering_loss:  0.2853, train_error: 0.1321
class 0: acc 0.9130434782608695, correct 105/115
class 1: acc 0.7549019607843137, correct 77/102
class 2: acc 0.8189655172413793, correct 95/116
class 3: acc 0.925531914893617, correct 87/94
class 4: acc 0.923728813559322, correct 109/118

Val Set, val_loss: 0.8128, val_error: 0.3800, auc: 0.9131
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.3425: correct 137/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.625, correct 5/8
Validation loss decreased (0.857417 --> 0.812829).  Saving model ...


batch 19, loss: 0.1007, instance_loss: 0.2384, weighted_loss: 0.1420, label: 2, bag_size: 1039
batch 39, loss: 0.0029, instance_loss: 0.0618, weighted_loss: 0.0206, label: 4, bag_size: 192
batch 59, loss: 0.3285, instance_loss: 0.3137, weighted_loss: 0.3241, label: 0, bag_size: 472
batch 79, loss: 0.0204, instance_loss: 0.0396, weighted_loss: 0.0261, label: 0, bag_size: 402
batch 99, loss: 2.1039, instance_loss: 0.7411, weighted_loss: 1.6951, label: 3, bag_size: 671
batch 119, loss: 2.3047, instance_loss: 0.7876, weighted_loss: 1.8496, label: 1, bag_size: 660
batch 139, loss: 0.2462, instance_loss: 0.2509, weighted_loss: 0.2476, label: 2, bag_size: 542
batch 159, loss: 0.0572, instance_loss: 0.2496, weighted_loss: 0.1149, label: 0, bag_size: 110
batch 179, loss: 0.6860, instance_loss: 0.4042, weighted_loss: 0.6014, label: 1, bag_size: 887
batch 199, loss: 0.0210, instance_loss: 0.0626, weighted_loss: 0.0335, label: 0, bag_size: 1599
batch 219, loss: 0.5752, instance_loss: 0.3655, weighted_loss: 0.5123, label: 2, bag_size: 784
batch 239, loss: 0.0146, instance_loss: 0.0656, weighted_loss: 0.0299, label: 4, bag_size: 157
batch 259, loss: 0.0278, instance_loss: 0.1075, weighted_loss: 0.0517, label: 4, bag_size: 40
batch 279, loss: 0.1666, instance_loss: 0.2661, weighted_loss: 0.1965, label: 2, bag_size: 357
batch 299, loss: 0.0263, instance_loss: 0.0623, weighted_loss: 0.0371, label: 3, bag_size: 78
batch 319, loss: 0.1608, instance_loss: 0.4412, weighted_loss: 0.2450, label: 0, bag_size: 110
batch 339, loss: 0.0257, instance_loss: 0.1790, weighted_loss: 0.0717, label: 3, bag_size: 35
batch 359, loss: 0.0294, instance_loss: 0.1155, weighted_loss: 0.0552, label: 0, bag_size: 1235
batch 379, loss: 0.0702, instance_loss: 0.0824, weighted_loss: 0.0739, label: 1, bag_size: 369
batch 399, loss: 0.0786, instance_loss: 0.3284, weighted_loss: 0.1536, label: 0, bag_size: 1086
batch 419, loss: 0.3123, instance_loss: 0.2955, weighted_loss: 0.3073, label: 2, bag_size: 1259
batch 439, loss: 0.0737, instance_loss: 0.2236, weighted_loss: 0.1187, label: 3, bag_size: 18
batch 459, loss: 3.7399, instance_loss: 1.0417, weighted_loss: 2.9305, label: 3, bag_size: 607
batch 479, loss: 0.1660, instance_loss: 0.2137, weighted_loss: 0.1803, label: 2, bag_size: 1378
batch 499, loss: 0.2931, instance_loss: 0.1570, weighted_loss: 0.2523, label: 0, bag_size: 515
batch 519, loss: 0.1022, instance_loss: 0.1633, weighted_loss: 0.1205, label: 0, bag_size: 1018
batch 539, loss: 0.4448, instance_loss: 0.3677, weighted_loss: 0.4217, label: 2, bag_size: 1006


class 0 clustering acc 0.9871559633027523: correct 21520/21800
class 1 clustering acc 0.42821100917431193: correct 1867/4360
Epoch: 15, train_loss: 0.4613, train_clustering_loss:  0.3046, train_error: 0.1596
class 0: acc 0.9459459459459459, correct 105/111
class 1: acc 0.6880733944954128, correct 75/109
class 2: acc 0.8389830508474576, correct 99/118
class 3: acc 0.826530612244898, correct 81/98
class 4: acc 0.8990825688073395, correct 98/109

Val Set, val_loss: 0.8768, val_error: 0.4600, auc: 0.9134
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.29: correct 116/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.45, correct 9/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.375, correct 3/8
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8214, instance_loss: 0.5405, weighted_loss: 1.4371, label: 1, bag_size: 651
batch 39, loss: 1.5233, instance_loss: 0.4538, weighted_loss: 1.2024, label: 1, bag_size: 711
batch 59, loss: 0.4481, instance_loss: 0.3146, weighted_loss: 0.4081, label: 2, bag_size: 1215
batch 79, loss: 0.1201, instance_loss: 0.1762, weighted_loss: 0.1369, label: 3, bag_size: 405
batch 99, loss: 0.2467, instance_loss: 0.2432, weighted_loss: 0.2456, label: 2, bag_size: 270
batch 119, loss: 0.1404, instance_loss: 0.2277, weighted_loss: 0.1666, label: 1, bag_size: 696
batch 139, loss: 0.7100, instance_loss: 0.3515, weighted_loss: 0.6024, label: 2, bag_size: 1006
batch 159, loss: 0.0105, instance_loss: 0.0818, weighted_loss: 0.0319, label: 4, bag_size: 40
batch 179, loss: 0.1921, instance_loss: 0.2840, weighted_loss: 0.2197, label: 2, bag_size: 784
batch 199, loss: 0.4338, instance_loss: 0.3018, weighted_loss: 0.3942, label: 2, bag_size: 1218
batch 219, loss: 1.0796, instance_loss: 0.4723, weighted_loss: 0.8974, label: 1, bag_size: 887
batch 239, loss: 0.7462, instance_loss: 0.3649, weighted_loss: 0.6318, label: 2, bag_size: 391
batch 259, loss: 1.6141, instance_loss: 0.5515, weighted_loss: 1.2953, label: 1, bag_size: 861
batch 279, loss: 0.2117, instance_loss: 0.2537, weighted_loss: 0.2243, label: 2, bag_size: 499
batch 299, loss: 0.3009, instance_loss: 0.2727, weighted_loss: 0.2924, label: 2, bag_size: 2703
batch 319, loss: 0.2789, instance_loss: 0.2758, weighted_loss: 0.2779, label: 2, bag_size: 846
batch 339, loss: 0.2631, instance_loss: 0.1942, weighted_loss: 0.2424, label: 4, bag_size: 91
batch 359, loss: 0.0127, instance_loss: 0.0557, weighted_loss: 0.0256, label: 3, bag_size: 28
batch 379, loss: 0.6035, instance_loss: 0.4637, weighted_loss: 0.5615, label: 2, bag_size: 411
batch 399, loss: 0.0225, instance_loss: 0.0585, weighted_loss: 0.0333, label: 3, bag_size: 78
batch 419, loss: 0.0198, instance_loss: 0.1512, weighted_loss: 0.0592, label: 4, bag_size: 29
batch 439, loss: 0.0073, instance_loss: 0.2347, weighted_loss: 0.0755, label: 3, bag_size: 20
batch 459, loss: 0.0081, instance_loss: 0.1271, weighted_loss: 0.0438, label: 3, bag_size: 20
batch 479, loss: 0.7582, instance_loss: 0.4750, weighted_loss: 0.6732, label: 0, bag_size: 759
batch 499, loss: 0.0187, instance_loss: 0.0438, weighted_loss: 0.0262, label: 4, bag_size: 79
batch 519, loss: 0.1858, instance_loss: 0.2142, weighted_loss: 0.1943, label: 0, bag_size: 545
batch 539, loss: 1.5030, instance_loss: 0.5028, weighted_loss: 1.2029, label: 1, bag_size: 1273


class 0 clustering acc 0.9892201834862385: correct 21565/21800
class 1 clustering acc 0.43096330275229355: correct 1879/4360
Epoch: 16, train_loss: 0.3783, train_clustering_loss:  0.2863, train_error: 0.1303
class 0: acc 0.8865979381443299, correct 86/97
class 1: acc 0.7634408602150538, correct 71/93
class 2: acc 0.8592592592592593, correct 116/135
class 3: acc 0.9051724137931034, correct 105/116
class 4: acc 0.9230769230769231, correct 96/104

Val Set, val_loss: 0.8814, val_error: 0.3800, auc: 0.9200
class 0 clustering acc 0.9815: correct 1963/2000
class 1 clustering acc 0.3625: correct 145/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.4, correct 8/20
class 3: acc 1.0, correct 8/8
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0489, instance_loss: 0.0534, weighted_loss: 0.0502, label: 3, bag_size: 556
batch 39, loss: 0.1051, instance_loss: 0.1720, weighted_loss: 0.1252, label: 2, bag_size: 1259
batch 59, loss: 0.3901, instance_loss: 0.4440, weighted_loss: 0.4063, label: 4, bag_size: 1357
batch 79, loss: 0.0001, instance_loss: 0.0317, weighted_loss: 0.0096, label: 3, bag_size: 41
batch 99, loss: 0.0205, instance_loss: 0.0521, weighted_loss: 0.0300, label: 4, bag_size: 157
batch 119, loss: 0.0129, instance_loss: 0.1764, weighted_loss: 0.0619, label: 3, bag_size: 35
batch 139, loss: 0.1100, instance_loss: 0.3245, weighted_loss: 0.1743, label: 3, bag_size: 1019
batch 159, loss: 0.1007, instance_loss: 0.1785, weighted_loss: 0.1241, label: 2, bag_size: 292
batch 179, loss: 0.0059, instance_loss: 0.0526, weighted_loss: 0.0200, label: 4, bag_size: 60
batch 199, loss: 0.1416, instance_loss: 0.3010, weighted_loss: 0.1894, label: 4, bag_size: 1474
batch 219, loss: 0.0304, instance_loss: 0.0600, weighted_loss: 0.0393, label: 3, bag_size: 29
batch 239, loss: 0.0064, instance_loss: 0.0263, weighted_loss: 0.0124, label: 4, bag_size: 192
batch 259, loss: 0.1800, instance_loss: 0.2237, weighted_loss: 0.1931, label: 2, bag_size: 499
batch 279, loss: 0.0109, instance_loss: 0.1001, weighted_loss: 0.0377, label: 3, bag_size: 29
batch 299, loss: 0.4063, instance_loss: 0.7278, weighted_loss: 0.5027, label: 2, bag_size: 1231
batch 319, loss: 0.0014, instance_loss: 0.0294, weighted_loss: 0.0098, label: 4, bag_size: 123
batch 339, loss: 0.1669, instance_loss: 0.1814, weighted_loss: 0.1712, label: 2, bag_size: 839
batch 359, loss: 0.4501, instance_loss: 0.3775, weighted_loss: 0.4283, label: 1, bag_size: 242
batch 379, loss: 0.1481, instance_loss: 0.1908, weighted_loss: 0.1609, label: 2, bag_size: 621
batch 399, loss: 0.0539, instance_loss: 0.1812, weighted_loss: 0.0921, label: 0, bag_size: 1018
batch 419, loss: 0.0478, instance_loss: 0.3286, weighted_loss: 0.1320, label: 0, bag_size: 109
batch 439, loss: 0.0298, instance_loss: 0.2655, weighted_loss: 0.1005, label: 4, bag_size: 24
batch 459, loss: 0.8216, instance_loss: 0.5630, weighted_loss: 0.7441, label: 3, bag_size: 283
batch 479, loss: 0.1979, instance_loss: 0.5741, weighted_loss: 0.3108, label: 4, bag_size: 754
batch 499, loss: 0.4508, instance_loss: 0.3014, weighted_loss: 0.4059, label: 2, bag_size: 1050
batch 519, loss: 0.0991, instance_loss: 0.2342, weighted_loss: 0.1396, label: 2, bag_size: 626
batch 539, loss: 0.7321, instance_loss: 0.3861, weighted_loss: 0.6283, label: 2, bag_size: 1050


class 0 clustering acc 0.9878440366972477: correct 21535/21800
class 1 clustering acc 0.4405963302752294: correct 1921/4360
Epoch: 17, train_loss: 0.4285, train_clustering_loss:  0.3021, train_error: 0.1578
class 0: acc 0.8803418803418803, correct 103/117
class 1: acc 0.693069306930693, correct 70/101
class 2: acc 0.8362068965517241, correct 97/116
class 3: acc 0.8761904761904762, correct 92/105
class 4: acc 0.9150943396226415, correct 97/106

Val Set, val_loss: 0.8577, val_error: 0.4000, auc: 0.9266
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.345: correct 138/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.45, correct 9/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0082, instance_loss: 0.2249, weighted_loss: 0.0732, label: 3, bag_size: 16
batch 39, loss: 0.6986, instance_loss: 0.4330, weighted_loss: 0.6189, label: 1, bag_size: 343
batch 59, loss: 1.5661, instance_loss: 0.5620, weighted_loss: 1.2649, label: 3, bag_size: 305
batch 79, loss: 0.7564, instance_loss: 0.4622, weighted_loss: 0.6681, label: 2, bag_size: 312
batch 99, loss: 0.0682, instance_loss: 0.1936, weighted_loss: 0.1058, label: 4, bag_size: 104
batch 119, loss: 0.0032, instance_loss: 0.1107, weighted_loss: 0.0355, label: 3, bag_size: 31
batch 139, loss: 0.1988, instance_loss: 0.3162, weighted_loss: 0.2340, label: 1, bag_size: 242
batch 159, loss: 0.0298, instance_loss: 0.2163, weighted_loss: 0.0858, label: 4, bag_size: 40
batch 179, loss: 1.6443, instance_loss: 0.7256, weighted_loss: 1.3687, label: 2, bag_size: 934
batch 199, loss: 0.0015, instance_loss: 0.2091, weighted_loss: 0.0638, label: 4, bag_size: 20
batch 219, loss: 0.1775, instance_loss: 0.1921, weighted_loss: 0.1819, label: 0, bag_size: 807
batch 239, loss: 3.4131, instance_loss: 0.7725, weighted_loss: 2.6209, label: 2, bag_size: 194
batch 259, loss: 3.1436, instance_loss: 0.7979, weighted_loss: 2.4399, label: 1, bag_size: 386
batch 279, loss: 0.0770, instance_loss: 0.3272, weighted_loss: 0.1521, label: 0, bag_size: 128
batch 299, loss: 0.1593, instance_loss: 0.1437, weighted_loss: 0.1546, label: 1, bag_size: 288
batch 319, loss: 0.1744, instance_loss: 0.3062, weighted_loss: 0.2140, label: 1, bag_size: 1646
batch 339, loss: 0.1225, instance_loss: 0.2548, weighted_loss: 0.1622, label: 1, bag_size: 846
batch 359, loss: 0.2522, instance_loss: 0.3253, weighted_loss: 0.2741, label: 2, bag_size: 638
batch 379, loss: 0.6622, instance_loss: 0.4513, weighted_loss: 0.5989, label: 2, bag_size: 500
batch 399, loss: 0.5022, instance_loss: 0.3330, weighted_loss: 0.4514, label: 3, bag_size: 1177
batch 419, loss: 0.2802, instance_loss: 0.3155, weighted_loss: 0.2908, label: 0, bag_size: 350
batch 439, loss: 0.0191, instance_loss: 0.1085, weighted_loss: 0.0459, label: 3, bag_size: 43
batch 459, loss: 1.6547, instance_loss: 0.5746, weighted_loss: 1.3307, label: 0, bag_size: 801
batch 479, loss: 0.0789, instance_loss: 0.2264, weighted_loss: 0.1232, label: 2, bag_size: 2081
batch 499, loss: 0.0766, instance_loss: 0.2397, weighted_loss: 0.1256, label: 4, bag_size: 168
batch 519, loss: 0.0427, instance_loss: 0.1510, weighted_loss: 0.0752, label: 3, bag_size: 105
batch 539, loss: 0.0067, instance_loss: 0.0360, weighted_loss: 0.0155, label: 0, bag_size: 402


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.4534403669724771: correct 1977/4360
Epoch: 18, train_loss: 0.3922, train_clustering_loss:  0.2823, train_error: 0.1431
class 0: acc 0.8938053097345132, correct 101/113
class 1: acc 0.7909090909090909, correct 87/110
class 2: acc 0.8095238095238095, correct 85/105
class 3: acc 0.883495145631068, correct 91/103
class 4: acc 0.9035087719298246, correct 103/114

Val Set, val_loss: 1.0392, val_error: 0.4400, auc: 0.9252
class 0 clustering acc 0.967: correct 1934/2000
class 1 clustering acc 0.3625: correct 145/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.3, correct 6/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.5, correct 4/8
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2858, instance_loss: 0.2167, weighted_loss: 0.2651, label: 2, bag_size: 347
batch 39, loss: 0.0265, instance_loss: 0.0510, weighted_loss: 0.0338, label: 4, bag_size: 157
batch 59, loss: 0.1542, instance_loss: 0.4052, weighted_loss: 0.2295, label: 4, bag_size: 1176
batch 79, loss: 0.0190, instance_loss: 0.3504, weighted_loss: 0.1184, label: 4, bag_size: 38
batch 99, loss: 0.0027, instance_loss: 0.1209, weighted_loss: 0.0381, label: 3, bag_size: 18
batch 119, loss: 0.2345, instance_loss: 0.3150, weighted_loss: 0.2586, label: 0, bag_size: 552
batch 139, loss: 0.4194, instance_loss: 0.4644, weighted_loss: 0.4329, label: 1, bag_size: 530
batch 159, loss: 0.1903, instance_loss: 0.2694, weighted_loss: 0.2141, label: 2, bag_size: 621
batch 179, loss: 0.1034, instance_loss: 0.2433, weighted_loss: 0.1453, label: 4, bag_size: 1474
batch 199, loss: 0.0049, instance_loss: 0.1018, weighted_loss: 0.0340, label: 3, bag_size: 27
batch 219, loss: 1.1077, instance_loss: 0.4431, weighted_loss: 0.9083, label: 1, bag_size: 898
batch 239, loss: 0.4054, instance_loss: 0.5231, weighted_loss: 0.4407, label: 2, bag_size: 358
batch 259, loss: 0.2952, instance_loss: 0.2439, weighted_loss: 0.2798, label: 2, bag_size: 1006
batch 279, loss: 0.1634, instance_loss: 0.1389, weighted_loss: 0.1560, label: 2, bag_size: 270
batch 299, loss: 0.1120, instance_loss: 0.1693, weighted_loss: 0.1292, label: 0, bag_size: 1301
batch 319, loss: 0.0005, instance_loss: 0.0455, weighted_loss: 0.0140, label: 4, bag_size: 130
batch 339, loss: 0.0480, instance_loss: 0.1492, weighted_loss: 0.0783, label: 2, bag_size: 317
batch 359, loss: 0.1188, instance_loss: 0.4434, weighted_loss: 0.2161, label: 0, bag_size: 109
batch 379, loss: 0.0540, instance_loss: 0.1196, weighted_loss: 0.0737, label: 2, bag_size: 614
batch 399, loss: 0.0857, instance_loss: 0.1687, weighted_loss: 0.1106, label: 0, bag_size: 1255
batch 419, loss: 0.2441, instance_loss: 0.2847, weighted_loss: 0.2563, label: 0, bag_size: 371
batch 439, loss: 0.1518, instance_loss: 0.1963, weighted_loss: 0.1652, label: 2, bag_size: 868
batch 459, loss: 0.0020, instance_loss: 0.1145, weighted_loss: 0.0358, label: 3, bag_size: 50
batch 479, loss: 0.6908, instance_loss: 0.6573, weighted_loss: 0.6807, label: 0, bag_size: 801
batch 499, loss: 0.4229, instance_loss: 0.3991, weighted_loss: 0.4157, label: 0, bag_size: 128
batch 519, loss: 0.8808, instance_loss: 0.3912, weighted_loss: 0.7339, label: 4, bag_size: 542
batch 539, loss: 0.2138, instance_loss: 0.4968, weighted_loss: 0.2987, label: 3, bag_size: 230


class 0 clustering acc 0.9875688073394495: correct 21529/21800
class 1 clustering acc 0.4646788990825688: correct 2026/4360
Epoch: 19, train_loss: 0.3732, train_clustering_loss:  0.2858, train_error: 0.1211
class 0: acc 0.9130434782608695, correct 105/115
class 1: acc 0.7073170731707317, correct 58/82
class 2: acc 0.8682170542635659, correct 112/129
class 3: acc 0.8888888888888888, correct 88/99
class 4: acc 0.9666666666666667, correct 116/120

Val Set, val_loss: 0.7999, val_error: 0.3800, auc: 0.9259
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
Validation loss decreased (0.812829 --> 0.799861).  Saving model ...


batch 19, loss: 0.0960, instance_loss: 0.2333, weighted_loss: 0.1372, label: 2, bag_size: 1155
batch 39, loss: 0.0216, instance_loss: 0.0909, weighted_loss: 0.0424, label: 1, bag_size: 1086
batch 59, loss: 1.0819, instance_loss: 0.4523, weighted_loss: 0.8930, label: 1, bag_size: 1559
batch 79, loss: 0.0115, instance_loss: 0.0444, weighted_loss: 0.0214, label: 0, bag_size: 402
batch 99, loss: 0.0422, instance_loss: 0.0975, weighted_loss: 0.0588, label: 4, bag_size: 48
batch 119, loss: 0.1181, instance_loss: 0.2852, weighted_loss: 0.1682, label: 2, bag_size: 1039
batch 139, loss: 0.1206, instance_loss: 0.2447, weighted_loss: 0.1578, label: 1, bag_size: 696
batch 159, loss: 0.0788, instance_loss: 0.2057, weighted_loss: 0.1169, label: 0, bag_size: 607
batch 179, loss: 1.8930, instance_loss: 0.6607, weighted_loss: 1.5233, label: 3, bag_size: 630
batch 199, loss: 0.0082, instance_loss: 0.0958, weighted_loss: 0.0345, label: 3, bag_size: 16
batch 219, loss: 0.0426, instance_loss: 0.1033, weighted_loss: 0.0608, label: 0, bag_size: 340
batch 239, loss: 0.0029, instance_loss: 0.0903, weighted_loss: 0.0291, label: 0, bag_size: 982
batch 259, loss: 0.0043, instance_loss: 0.2032, weighted_loss: 0.0640, label: 3, bag_size: 18
batch 279, loss: 0.0054, instance_loss: 0.0744, weighted_loss: 0.0261, label: 4, bag_size: 150
batch 299, loss: 0.0041, instance_loss: 0.0827, weighted_loss: 0.0277, label: 4, bag_size: 79
batch 319, loss: 0.6559, instance_loss: 0.6016, weighted_loss: 0.6396, label: 1, bag_size: 343
batch 339, loss: 0.0871, instance_loss: 0.5448, weighted_loss: 0.2244, label: 3, bag_size: 936
batch 359, loss: 0.0246, instance_loss: 0.1984, weighted_loss: 0.0767, label: 4, bag_size: 78
batch 379, loss: 0.0157, instance_loss: 0.1782, weighted_loss: 0.0644, label: 4, bag_size: 86
batch 399, loss: 0.0020, instance_loss: 0.1734, weighted_loss: 0.0534, label: 4, bag_size: 19
batch 419, loss: 0.0062, instance_loss: 0.0985, weighted_loss: 0.0339, label: 4, bag_size: 79
batch 439, loss: 2.1845, instance_loss: 0.6599, weighted_loss: 1.7271, label: 1, bag_size: 435
batch 459, loss: 0.1918, instance_loss: 0.2607, weighted_loss: 0.2124, label: 2, bag_size: 391
batch 479, loss: 0.0042, instance_loss: 0.0997, weighted_loss: 0.0328, label: 3, bag_size: 20
batch 499, loss: 2.0650, instance_loss: 0.6587, weighted_loss: 1.6431, label: 1, bag_size: 1197
batch 519, loss: 0.0020, instance_loss: 0.0910, weighted_loss: 0.0287, label: 4, bag_size: 130
batch 539, loss: 0.1379, instance_loss: 0.2480, weighted_loss: 0.1709, label: 3, bag_size: 316


class 0 clustering acc 0.9884403669724771: correct 21548/21800
class 1 clustering acc 0.5055045871559632: correct 2204/4360
Epoch: 20, train_loss: 0.3179, train_clustering_loss:  0.2702, train_error: 0.1174
class 0: acc 0.9444444444444444, correct 119/126
class 1: acc 0.7685185185185185, correct 83/108
class 2: acc 0.8623853211009175, correct 94/109
class 3: acc 0.9090909090909091, correct 90/99
class 4: acc 0.9223300970873787, correct 95/103

Val Set, val_loss: 0.8835, val_error: 0.3600, auc: 0.9199
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.3825: correct 153/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0357, instance_loss: 0.1528, weighted_loss: 0.0708, label: 0, bag_size: 246
batch 39, loss: 0.1088, instance_loss: 0.2386, weighted_loss: 0.1477, label: 0, bag_size: 350
batch 59, loss: 0.1381, instance_loss: 0.2697, weighted_loss: 0.1775, label: 2, bag_size: 730
batch 79, loss: 1.8831, instance_loss: 0.6754, weighted_loss: 1.5208, label: 3, bag_size: 281
batch 99, loss: 1.0706, instance_loss: 0.2990, weighted_loss: 0.8391, label: 4, bag_size: 773
batch 119, loss: 0.0119, instance_loss: 0.2305, weighted_loss: 0.0775, label: 3, bag_size: 16
batch 139, loss: 0.0068, instance_loss: 0.1254, weighted_loss: 0.0424, label: 4, bag_size: 178
batch 159, loss: 0.1139, instance_loss: 0.2706, weighted_loss: 0.1609, label: 0, bag_size: 1034
batch 179, loss: 2.6560, instance_loss: 0.7513, weighted_loss: 2.0846, label: 1, bag_size: 1799
batch 199, loss: 0.0455, instance_loss: 0.2434, weighted_loss: 0.1049, label: 4, bag_size: 1474
batch 219, loss: 0.1933, instance_loss: 0.2072, weighted_loss: 0.1975, label: 2, bag_size: 766
batch 239, loss: 0.0707, instance_loss: 0.4003, weighted_loss: 0.1696, label: 1, bag_size: 1014
batch 259, loss: 0.1209, instance_loss: 0.1666, weighted_loss: 0.1346, label: 1, bag_size: 346
batch 279, loss: 0.3155, instance_loss: 0.2677, weighted_loss: 0.3012, label: 2, bag_size: 391
batch 299, loss: 0.0002, instance_loss: 0.0188, weighted_loss: 0.0058, label: 4, bag_size: 185
batch 319, loss: 0.7883, instance_loss: 0.4278, weighted_loss: 0.6802, label: 1, bag_size: 1273
batch 339, loss: 0.7262, instance_loss: 0.4951, weighted_loss: 0.6569, label: 2, bag_size: 1006
batch 359, loss: 0.0138, instance_loss: 0.3941, weighted_loss: 0.1279, label: 4, bag_size: 24
batch 379, loss: 0.1197, instance_loss: 0.1106, weighted_loss: 0.1170, label: 1, bag_size: 1261
batch 399, loss: 1.2111, instance_loss: 0.6628, weighted_loss: 1.0466, label: 1, bag_size: 386
batch 419, loss: 0.5529, instance_loss: 0.4528, weighted_loss: 0.5228, label: 1, bag_size: 651
batch 439, loss: 0.0169, instance_loss: 0.3460, weighted_loss: 0.1156, label: 1, bag_size: 868
batch 459, loss: 0.0445, instance_loss: 0.2237, weighted_loss: 0.0982, label: 0, bag_size: 1086
batch 479, loss: 0.1719, instance_loss: 0.2166, weighted_loss: 0.1853, label: 1, bag_size: 442
batch 499, loss: 0.0057, instance_loss: 0.0369, weighted_loss: 0.0151, label: 4, bag_size: 104
batch 519, loss: 0.2831, instance_loss: 0.1290, weighted_loss: 0.2369, label: 3, bag_size: 533
batch 539, loss: 0.0542, instance_loss: 0.1557, weighted_loss: 0.0846, label: 2, bag_size: 525


class 0 clustering acc 0.9891284403669725: correct 21563/21800
class 1 clustering acc 0.5022935779816514: correct 2190/4360
Epoch: 21, train_loss: 0.2969, train_clustering_loss:  0.2649, train_error: 0.0954
class 0: acc 0.9448818897637795, correct 120/127
class 1: acc 0.7916666666666666, correct 76/96
class 2: acc 0.8543689320388349, correct 88/103
class 3: acc 0.9369369369369369, correct 104/111
class 4: acc 0.9722222222222222, correct 105/108

Val Set, val_loss: 0.8546, val_error: 0.3400, auc: 0.9197
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.375: correct 150/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.65, correct 13/20
class 3: acc 0.875, correct 7/8
class 4: acc 0.5, correct 4/8
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0714, instance_loss: 0.2445, weighted_loss: 0.1233, label: 0, bag_size: 1086
batch 39, loss: 0.0031, instance_loss: 0.0849, weighted_loss: 0.0276, label: 3, bag_size: 20
batch 59, loss: 0.0108, instance_loss: 0.0943, weighted_loss: 0.0358, label: 3, bag_size: 72
batch 79, loss: 0.1785, instance_loss: 0.5293, weighted_loss: 0.2838, label: 4, bag_size: 754
batch 99, loss: 0.0008, instance_loss: 0.1987, weighted_loss: 0.0602, label: 4, bag_size: 20
batch 119, loss: 0.7696, instance_loss: 0.3581, weighted_loss: 0.6462, label: 2, bag_size: 1069
batch 139, loss: 0.0067, instance_loss: 0.1103, weighted_loss: 0.0378, label: 3, bag_size: 20
batch 159, loss: 0.0010, instance_loss: 0.0348, weighted_loss: 0.0112, label: 4, bag_size: 114
batch 179, loss: 0.0044, instance_loss: 0.0633, weighted_loss: 0.0221, label: 4, bag_size: 160
batch 199, loss: 0.6294, instance_loss: 0.2560, weighted_loss: 0.5174, label: 2, bag_size: 828
batch 219, loss: 0.2700, instance_loss: 0.3057, weighted_loss: 0.2807, label: 2, bag_size: 1164
batch 239, loss: 0.0754, instance_loss: 0.1410, weighted_loss: 0.0951, label: 3, bag_size: 451
batch 259, loss: 0.0011, instance_loss: 0.2181, weighted_loss: 0.0662, label: 3, bag_size: 18
batch 279, loss: 0.4303, instance_loss: 0.4971, weighted_loss: 0.4504, label: 2, bag_size: 408
batch 299, loss: 0.0885, instance_loss: 0.1938, weighted_loss: 0.1201, label: 2, bag_size: 499
batch 319, loss: 0.0613, instance_loss: 0.1626, weighted_loss: 0.0917, label: 2, bag_size: 323
batch 339, loss: 0.0159, instance_loss: 0.1225, weighted_loss: 0.0479, label: 1, bag_size: 405
batch 359, loss: 2.4047, instance_loss: 0.5954, weighted_loss: 1.8619, label: 3, bag_size: 1380
batch 379, loss: 0.0137, instance_loss: 0.1139, weighted_loss: 0.0437, label: 0, bag_size: 1466
batch 399, loss: 0.6856, instance_loss: 0.3520, weighted_loss: 0.5855, label: 1, bag_size: 1049
batch 419, loss: 0.2179, instance_loss: 0.3019, weighted_loss: 0.2431, label: 0, bag_size: 800
batch 439, loss: 0.1380, instance_loss: 0.1269, weighted_loss: 0.1346, label: 1, bag_size: 869
batch 459, loss: 0.0019, instance_loss: 0.2745, weighted_loss: 0.0837, label: 3, bag_size: 18
batch 479, loss: 0.6493, instance_loss: 0.6373, weighted_loss: 0.6457, label: 3, bag_size: 849
batch 499, loss: 0.6322, instance_loss: 0.4763, weighted_loss: 0.5854, label: 1, bag_size: 838
batch 519, loss: 0.1202, instance_loss: 0.2107, weighted_loss: 0.1473, label: 0, bag_size: 478
batch 539, loss: 0.1165, instance_loss: 0.3409, weighted_loss: 0.1839, label: 3, bag_size: 697


class 0 clustering acc 0.9877981651376146: correct 21534/21800
class 1 clustering acc 0.5094036697247707: correct 2221/4360
Epoch: 22, train_loss: 0.3488, train_clustering_loss:  0.2737, train_error: 0.1266
class 0: acc 0.9603960396039604, correct 97/101
class 1: acc 0.7719298245614035, correct 88/114
class 2: acc 0.7614678899082569, correct 83/109
class 3: acc 0.9365079365079365, correct 118/126
class 4: acc 0.9473684210526315, correct 90/95

Val Set, val_loss: 0.8652, val_error: 0.3400, auc: 0.9234
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.37: correct 148/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0033, instance_loss: 0.1003, weighted_loss: 0.0324, label: 4, bag_size: 40
batch 39, loss: 0.0170, instance_loss: 0.0549, weighted_loss: 0.0284, label: 3, bag_size: 20
batch 59, loss: 1.5944, instance_loss: 0.5588, weighted_loss: 1.2837, label: 0, bag_size: 1065
batch 79, loss: 0.0045, instance_loss: 0.1724, weighted_loss: 0.0549, label: 4, bag_size: 40
batch 99, loss: 0.0788, instance_loss: 0.0811, weighted_loss: 0.0795, label: 1, bag_size: 1191
batch 119, loss: 0.1810, instance_loss: 0.2303, weighted_loss: 0.1958, label: 2, bag_size: 265
batch 139, loss: 0.0131, instance_loss: 0.1626, weighted_loss: 0.0580, label: 3, bag_size: 18
batch 159, loss: 0.0456, instance_loss: 0.1767, weighted_loss: 0.0850, label: 2, bag_size: 600
batch 179, loss: 0.3893, instance_loss: 0.3857, weighted_loss: 0.3882, label: 2, bag_size: 471
batch 199, loss: 2.8859, instance_loss: 1.4039, weighted_loss: 2.4413, label: 2, bag_size: 1108
batch 219, loss: 0.1526, instance_loss: 0.2065, weighted_loss: 0.1688, label: 0, bag_size: 1301
batch 239, loss: 0.0790, instance_loss: 0.0974, weighted_loss: 0.0845, label: 4, bag_size: 48
batch 259, loss: 1.6885, instance_loss: 0.7154, weighted_loss: 1.3966, label: 1, bag_size: 386
batch 279, loss: 0.5634, instance_loss: 0.5600, weighted_loss: 0.5624, label: 1, bag_size: 102
batch 299, loss: 0.0020, instance_loss: 0.0319, weighted_loss: 0.0109, label: 3, bag_size: 46
batch 319, loss: 0.1445, instance_loss: 0.2447, weighted_loss: 0.1745, label: 0, bag_size: 1012
batch 339, loss: 0.0216, instance_loss: 0.1149, weighted_loss: 0.0496, label: 3, bag_size: 28
batch 359, loss: 0.0433, instance_loss: 0.1186, weighted_loss: 0.0659, label: 1, bag_size: 828
batch 379, loss: 0.3937, instance_loss: 0.2639, weighted_loss: 0.3548, label: 0, bag_size: 912
batch 399, loss: 0.1575, instance_loss: 0.1943, weighted_loss: 0.1686, label: 1, bag_size: 399
batch 419, loss: 0.5675, instance_loss: 0.2951, weighted_loss: 0.4858, label: 2, bag_size: 828
batch 439, loss: 0.7404, instance_loss: 0.4594, weighted_loss: 0.6561, label: 2, bag_size: 537
batch 459, loss: 0.2389, instance_loss: 0.2540, weighted_loss: 0.2434, label: 2, bag_size: 1569
batch 479, loss: 0.0012, instance_loss: 0.1438, weighted_loss: 0.0440, label: 4, bag_size: 20
batch 499, loss: 0.1111, instance_loss: 0.1672, weighted_loss: 0.1279, label: 0, bag_size: 476
batch 519, loss: 0.0056, instance_loss: 0.2322, weighted_loss: 0.0736, label: 3, bag_size: 18
batch 539, loss: 0.0003, instance_loss: 0.1698, weighted_loss: 0.0512, label: 4, bag_size: 47


class 0 clustering acc 0.9873394495412844: correct 21524/21800
class 1 clustering acc 0.48486238532110093: correct 2114/4360
Epoch: 23, train_loss: 0.3268, train_clustering_loss:  0.2748, train_error: 0.1248
class 0: acc 0.898989898989899, correct 89/99
class 1: acc 0.7522935779816514, correct 82/109
class 2: acc 0.7870370370370371, correct 85/108
class 3: acc 0.9719626168224299, correct 104/107
class 4: acc 0.9590163934426229, correct 117/122

Val Set, val_loss: 0.9720, val_error: 0.4200, auc: 0.9227
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.3725: correct 149/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.35, correct 7/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0050, instance_loss: 0.2060, weighted_loss: 0.0653, label: 3, bag_size: 48
batch 39, loss: 0.0637, instance_loss: 0.3216, weighted_loss: 0.1411, label: 0, bag_size: 129
batch 59, loss: 1.6126, instance_loss: 0.4758, weighted_loss: 1.2715, label: 2, bag_size: 271
batch 79, loss: 0.0946, instance_loss: 0.1276, weighted_loss: 0.1045, label: 1, bag_size: 682
batch 99, loss: 0.0710, instance_loss: 0.1129, weighted_loss: 0.0836, label: 1, bag_size: 994
batch 119, loss: 1.5306, instance_loss: 0.5147, weighted_loss: 1.2258, label: 1, bag_size: 651
batch 139, loss: 0.0217, instance_loss: 0.0612, weighted_loss: 0.0336, label: 0, bag_size: 446
batch 159, loss: 0.7188, instance_loss: 0.6004, weighted_loss: 0.6833, label: 2, bag_size: 916
batch 179, loss: 0.0042, instance_loss: 0.1434, weighted_loss: 0.0459, label: 3, bag_size: 105
batch 199, loss: 0.1403, instance_loss: 0.4911, weighted_loss: 0.2455, label: 4, bag_size: 1474
batch 219, loss: 0.0030, instance_loss: 0.0933, weighted_loss: 0.0301, label: 3, bag_size: 19
batch 239, loss: 0.0032, instance_loss: 0.0697, weighted_loss: 0.0232, label: 1, bag_size: 1127
batch 259, loss: 0.0021, instance_loss: 0.0927, weighted_loss: 0.0293, label: 4, bag_size: 30
batch 279, loss: 0.2385, instance_loss: 0.2437, weighted_loss: 0.2400, label: 0, bag_size: 1332
batch 299, loss: 0.0710, instance_loss: 0.1137, weighted_loss: 0.0838, label: 3, bag_size: 16
batch 319, loss: 0.2687, instance_loss: 0.3046, weighted_loss: 0.2795, label: 2, bag_size: 1006
batch 339, loss: 0.0041, instance_loss: 0.2620, weighted_loss: 0.0815, label: 4, bag_size: 38
batch 359, loss: 1.2502, instance_loss: 0.3943, weighted_loss: 0.9935, label: 2, bag_size: 271
batch 379, loss: 0.0064, instance_loss: 0.0840, weighted_loss: 0.0297, label: 3, bag_size: 123
batch 399, loss: 0.0096, instance_loss: 0.0407, weighted_loss: 0.0190, label: 4, bag_size: 60
batch 419, loss: 0.1552, instance_loss: 0.1487, weighted_loss: 0.1532, label: 0, bag_size: 630
batch 439, loss: 0.0250, instance_loss: 0.1750, weighted_loss: 0.0700, label: 0, bag_size: 246
batch 459, loss: 0.4151, instance_loss: 0.2586, weighted_loss: 0.3682, label: 2, bag_size: 471
batch 479, loss: 0.0012, instance_loss: 0.1995, weighted_loss: 0.0607, label: 3, bag_size: 32
batch 499, loss: 0.0109, instance_loss: 0.0416, weighted_loss: 0.0201, label: 3, bag_size: 305
batch 519, loss: 0.0258, instance_loss: 0.0856, weighted_loss: 0.0438, label: 0, bag_size: 1143
batch 539, loss: 0.3099, instance_loss: 0.5014, weighted_loss: 0.3674, label: 3, bag_size: 200


class 0 clustering acc 0.9893119266055046: correct 21567/21800
class 1 clustering acc 0.506651376146789: correct 2209/4360
Epoch: 24, train_loss: 0.2830, train_clustering_loss:  0.2689, train_error: 0.0936
class 0: acc 0.9056603773584906, correct 96/106
class 1: acc 0.8017241379310345, correct 93/116
class 2: acc 0.8983050847457628, correct 106/118
class 3: acc 0.963302752293578, correct 105/109
class 4: acc 0.9791666666666666, correct 94/96

Val Set, val_loss: 0.8492, val_error: 0.3200, auc: 0.9188
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.875, correct 7/8
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7776, instance_loss: 0.6859, weighted_loss: 0.7501, label: 4, bag_size: 210
batch 39, loss: 0.0022, instance_loss: 0.0432, weighted_loss: 0.0145, label: 3, bag_size: 55
batch 59, loss: 0.0002, instance_loss: 0.0198, weighted_loss: 0.0061, label: 3, bag_size: 48
batch 79, loss: 0.1446, instance_loss: 0.2698, weighted_loss: 0.1822, label: 1, bag_size: 898
batch 99, loss: 0.0402, instance_loss: 0.2004, weighted_loss: 0.0883, label: 2, bag_size: 766
batch 119, loss: 0.0045, instance_loss: 0.0689, weighted_loss: 0.0238, label: 0, bag_size: 1599
batch 139, loss: 0.0011, instance_loss: 0.0386, weighted_loss: 0.0123, label: 4, bag_size: 123
batch 159, loss: 0.0143, instance_loss: 0.2854, weighted_loss: 0.0956, label: 0, bag_size: 136
batch 179, loss: 0.0002, instance_loss: 0.0327, weighted_loss: 0.0099, label: 4, bag_size: 167
batch 199, loss: 1.1012, instance_loss: 0.5008, weighted_loss: 0.9211, label: 1, bag_size: 1376
batch 219, loss: 0.1797, instance_loss: 0.4018, weighted_loss: 0.2463, label: 1, bag_size: 887
batch 239, loss: 0.7389, instance_loss: 0.3537, weighted_loss: 0.6234, label: 1, bag_size: 1273
batch 259, loss: 0.0572, instance_loss: 0.1936, weighted_loss: 0.0981, label: 3, bag_size: 952
batch 279, loss: 0.0409, instance_loss: 0.4168, weighted_loss: 0.1536, label: 0, bag_size: 129
batch 299, loss: 0.1420, instance_loss: 0.3553, weighted_loss: 0.2060, label: 2, bag_size: 1050
batch 319, loss: 0.0724, instance_loss: 0.2274, weighted_loss: 0.1189, label: 0, bag_size: 200
batch 339, loss: 0.0008, instance_loss: 0.1488, weighted_loss: 0.0452, label: 4, bag_size: 35
batch 359, loss: 0.0112, instance_loss: 0.1085, weighted_loss: 0.0404, label: 0, bag_size: 246
batch 379, loss: 1.7536, instance_loss: 0.7099, weighted_loss: 1.4405, label: 1, bag_size: 446
batch 399, loss: 0.0275, instance_loss: 0.3308, weighted_loss: 0.1185, label: 2, bag_size: 1439
batch 419, loss: 0.6256, instance_loss: 0.4098, weighted_loss: 0.5609, label: 2, bag_size: 967
batch 439, loss: 0.2102, instance_loss: 0.1997, weighted_loss: 0.2070, label: 3, bag_size: 1399
batch 459, loss: 0.0401, instance_loss: 0.6620, weighted_loss: 0.2267, label: 4, bag_size: 675
batch 479, loss: 0.1703, instance_loss: 0.2287, weighted_loss: 0.1878, label: 1, bag_size: 913
batch 499, loss: 0.0745, instance_loss: 0.3588, weighted_loss: 0.1598, label: 1, bag_size: 887
batch 519, loss: 0.0017, instance_loss: 0.0927, weighted_loss: 0.0290, label: 3, bag_size: 16
batch 539, loss: 0.5368, instance_loss: 0.6989, weighted_loss: 0.5854, label: 3, bag_size: 305


class 0 clustering acc 0.9864678899082568: correct 21505/21800
class 1 clustering acc 0.5123853211009174: correct 2234/4360
Epoch: 25, train_loss: 0.2354, train_clustering_loss:  0.2741, train_error: 0.0752
class 0: acc 0.9734513274336283, correct 110/113
class 1: acc 0.7864077669902912, correct 81/103
class 2: acc 0.8981481481481481, correct 97/108
class 3: acc 0.9716981132075472, correct 103/106
class 4: acc 0.9826086956521739, correct 113/115

Val Set, val_loss: 0.9317, val_error: 0.3800, auc: 0.9217
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.41: correct 164/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.5, correct 4/8
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0015, instance_loss: 0.0187, weighted_loss: 0.0067, label: 0, bag_size: 385
batch 39, loss: 0.0200, instance_loss: 0.1435, weighted_loss: 0.0570, label: 0, bag_size: 437
batch 59, loss: 0.2724, instance_loss: 0.4003, weighted_loss: 0.3108, label: 1, bag_size: 968
batch 79, loss: 0.0207, instance_loss: 0.1333, weighted_loss: 0.0545, label: 2, bag_size: 614
batch 99, loss: 0.0670, instance_loss: 0.1786, weighted_loss: 0.1005, label: 2, bag_size: 317
batch 119, loss: 0.0702, instance_loss: 0.1231, weighted_loss: 0.0861, label: 0, bag_size: 381
batch 139, loss: 0.4742, instance_loss: 0.7053, weighted_loss: 0.5436, label: 2, bag_size: 411
batch 159, loss: 0.0219, instance_loss: 0.0597, weighted_loss: 0.0332, label: 2, bag_size: 455
batch 179, loss: 0.0886, instance_loss: 0.1198, weighted_loss: 0.0980, label: 2, bag_size: 1514
batch 199, loss: 1.1151, instance_loss: 0.7271, weighted_loss: 0.9987, label: 1, bag_size: 867
batch 219, loss: 0.0006, instance_loss: 0.2062, weighted_loss: 0.0623, label: 4, bag_size: 35
batch 239, loss: 1.1232, instance_loss: 0.2484, weighted_loss: 0.8607, label: 2, bag_size: 986
batch 259, loss: 2.1083, instance_loss: 0.7934, weighted_loss: 1.7138, label: 1, bag_size: 875
batch 279, loss: 0.6809, instance_loss: 0.4071, weighted_loss: 0.5988, label: 0, bag_size: 736
batch 299, loss: 0.0005, instance_loss: 0.1772, weighted_loss: 0.0535, label: 3, bag_size: 18
batch 319, loss: 0.5062, instance_loss: 0.4035, weighted_loss: 0.4754, label: 2, bag_size: 795
batch 339, loss: 0.5318, instance_loss: 0.2914, weighted_loss: 0.4597, label: 1, bag_size: 965
batch 359, loss: 0.0042, instance_loss: 0.1108, weighted_loss: 0.0362, label: 3, bag_size: 34
batch 379, loss: 0.0457, instance_loss: 0.4737, weighted_loss: 0.1741, label: 4, bag_size: 24
batch 399, loss: 0.5448, instance_loss: 0.5004, weighted_loss: 0.5315, label: 4, bag_size: 542
batch 419, loss: 0.0931, instance_loss: 0.1207, weighted_loss: 0.1014, label: 1, bag_size: 945
batch 439, loss: 0.1796, instance_loss: 0.2368, weighted_loss: 0.1967, label: 2, bag_size: 1133
batch 459, loss: 0.0635, instance_loss: 0.5067, weighted_loss: 0.1965, label: 3, bag_size: 1253
batch 479, loss: 0.3384, instance_loss: 0.2832, weighted_loss: 0.3219, label: 2, bag_size: 265
batch 499, loss: 0.0647, instance_loss: 0.2351, weighted_loss: 0.1158, label: 2, bag_size: 571
batch 519, loss: 0.2828, instance_loss: 0.3144, weighted_loss: 0.2923, label: 2, bag_size: 1133
batch 539, loss: 1.3898, instance_loss: 0.7845, weighted_loss: 1.2082, label: 1, bag_size: 435


class 0 clustering acc 0.9854128440366973: correct 21482/21800
class 1 clustering acc 0.5135321100917432: correct 2239/4360
Epoch: 26, train_loss: 0.2614, train_clustering_loss:  0.2751, train_error: 0.0972
class 0: acc 0.9537037037037037, correct 103/108
class 1: acc 0.7962962962962963, correct 86/108
class 2: acc 0.8363636363636363, correct 92/110
class 3: acc 0.9541284403669725, correct 104/109
class 4: acc 0.9727272727272728, correct 107/110

Val Set, val_loss: 0.8635, val_error: 0.3600, auc: 0.9153
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.43: correct 172/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.3948, instance_loss: 0.6327, weighted_loss: 0.4662, label: 0, bag_size: 423
batch 39, loss: 3.2245, instance_loss: 0.7447, weighted_loss: 2.4805, label: 3, bag_size: 1380
batch 59, loss: 2.3718, instance_loss: 0.6574, weighted_loss: 1.8575, label: 1, bag_size: 1144
batch 79, loss: 0.0175, instance_loss: 0.1137, weighted_loss: 0.0464, label: 3, bag_size: 24
batch 99, loss: 0.0565, instance_loss: 0.3766, weighted_loss: 0.1525, label: 0, bag_size: 129
batch 119, loss: 0.0893, instance_loss: 0.1847, weighted_loss: 0.1179, label: 2, bag_size: 2081
batch 139, loss: 0.1070, instance_loss: 0.1984, weighted_loss: 0.1344, label: 1, bag_size: 869
batch 159, loss: 0.0722, instance_loss: 0.3466, weighted_loss: 0.1545, label: 4, bag_size: 1176
batch 179, loss: 0.2380, instance_loss: 0.2444, weighted_loss: 0.2399, label: 3, bag_size: 451
batch 199, loss: 0.0008, instance_loss: 0.0334, weighted_loss: 0.0106, label: 4, bag_size: 162
batch 219, loss: 0.5559, instance_loss: 0.4283, weighted_loss: 0.5176, label: 1, bag_size: 139
batch 239, loss: 0.0003, instance_loss: 0.0261, weighted_loss: 0.0080, label: 4, bag_size: 112
batch 259, loss: 0.0157, instance_loss: 0.0687, weighted_loss: 0.0316, label: 1, bag_size: 1426
batch 279, loss: 0.0499, instance_loss: 0.3971, weighted_loss: 0.1540, label: 3, bag_size: 936
batch 299, loss: 0.0011, instance_loss: 0.0453, weighted_loss: 0.0144, label: 4, bag_size: 160
batch 319, loss: 0.0511, instance_loss: 0.1299, weighted_loss: 0.0747, label: 0, bag_size: 478
batch 339, loss: 0.1190, instance_loss: 0.2819, weighted_loss: 0.1679, label: 0, bag_size: 424
batch 359, loss: 0.2897, instance_loss: 0.2490, weighted_loss: 0.2775, label: 2, bag_size: 1006
batch 379, loss: 0.2311, instance_loss: 0.2737, weighted_loss: 0.2439, label: 2, bag_size: 883
batch 399, loss: 0.8122, instance_loss: 0.6374, weighted_loss: 0.7597, label: 2, bag_size: 248
batch 419, loss: 0.1702, instance_loss: 0.2744, weighted_loss: 0.2015, label: 2, bag_size: 809
batch 439, loss: 0.1680, instance_loss: 0.4433, weighted_loss: 0.2506, label: 1, bag_size: 343
batch 459, loss: 0.0728, instance_loss: 0.2331, weighted_loss: 0.1209, label: 2, bag_size: 2081
batch 479, loss: 0.0022, instance_loss: 0.0506, weighted_loss: 0.0167, label: 4, bag_size: 140
batch 499, loss: 0.0329, instance_loss: 0.0907, weighted_loss: 0.0503, label: 0, bag_size: 1190
batch 519, loss: 0.0002, instance_loss: 0.0142, weighted_loss: 0.0044, label: 4, bag_size: 123
batch 539, loss: 0.0874, instance_loss: 0.1807, weighted_loss: 0.1154, label: 3, bag_size: 316


class 0 clustering acc 0.9851834862385321: correct 21477/21800
class 1 clustering acc 0.5254587155963303: correct 2291/4360
Epoch: 27, train_loss: 0.2533, train_clustering_loss:  0.2665, train_error: 0.0826
class 0: acc 0.9615384615384616, correct 125/130
class 1: acc 0.7920792079207921, correct 80/101
class 2: acc 0.8839285714285714, correct 99/112
class 3: acc 0.96, correct 96/100
class 4: acc 0.9803921568627451, correct 100/102

Val Set, val_loss: 1.0602, val_error: 0.4400, auc: 0.9146
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.395: correct 158/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 1.0, correct 7/7
class 2: acc 0.35, correct 7/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.2895, instance_loss: 0.5488, weighted_loss: 1.0673, label: 1, bag_size: 1799
batch 39, loss: 0.0002, instance_loss: 0.0205, weighted_loss: 0.0063, label: 4, bag_size: 130
batch 59, loss: 0.0005, instance_loss: 0.1610, weighted_loss: 0.0486, label: 3, bag_size: 18
batch 79, loss: 0.1629, instance_loss: 0.3223, weighted_loss: 0.2107, label: 0, bag_size: 653
batch 99, loss: 0.0277, instance_loss: 0.2543, weighted_loss: 0.0957, label: 0, bag_size: 120
batch 119, loss: 0.2642, instance_loss: 0.4044, weighted_loss: 0.3063, label: 1, bag_size: 898
batch 139, loss: 0.1906, instance_loss: 0.3152, weighted_loss: 0.2280, label: 0, bag_size: 114
batch 159, loss: 0.1000, instance_loss: 0.1508, weighted_loss: 0.1152, label: 1, bag_size: 1049
batch 179, loss: 0.0930, instance_loss: 0.1987, weighted_loss: 0.1247, label: 2, bag_size: 292
batch 199, loss: 0.8095, instance_loss: 0.5479, weighted_loss: 0.7310, label: 0, bag_size: 868
batch 219, loss: 0.0389, instance_loss: 0.3884, weighted_loss: 0.1437, label: 0, bag_size: 163
batch 239, loss: 0.0083, instance_loss: 0.0731, weighted_loss: 0.0277, label: 0, bag_size: 607
batch 259, loss: 1.2339, instance_loss: 0.7467, weighted_loss: 1.0877, label: 3, bag_size: 630
batch 279, loss: 0.0012, instance_loss: 0.1249, weighted_loss: 0.0383, label: 3, bag_size: 72
batch 299, loss: 0.0437, instance_loss: 0.1417, weighted_loss: 0.0731, label: 0, bag_size: 200
batch 319, loss: 0.1738, instance_loss: 0.7469, weighted_loss: 0.3457, label: 3, bag_size: 230
batch 339, loss: 0.0193, instance_loss: 0.0642, weighted_loss: 0.0328, label: 1, bag_size: 1086
batch 359, loss: 0.0061, instance_loss: 0.1383, weighted_loss: 0.0457, label: 1, bag_size: 399
batch 379, loss: 0.0824, instance_loss: 0.1937, weighted_loss: 0.1158, label: 2, bag_size: 480
batch 399, loss: 0.0257, instance_loss: 0.1013, weighted_loss: 0.0483, label: 1, bag_size: 938
batch 419, loss: 0.0376, instance_loss: 0.1501, weighted_loss: 0.0714, label: 3, bag_size: 1399
batch 439, loss: 0.6735, instance_loss: 0.4819, weighted_loss: 0.6160, label: 2, bag_size: 110
batch 459, loss: 2.9908, instance_loss: 0.7990, weighted_loss: 2.3333, label: 1, bag_size: 446
batch 479, loss: 0.6449, instance_loss: 0.3952, weighted_loss: 0.5700, label: 4, bag_size: 533
batch 499, loss: 0.0607, instance_loss: 0.1890, weighted_loss: 0.0992, label: 2, bag_size: 237
batch 519, loss: 1.3956, instance_loss: 0.3717, weighted_loss: 1.0884, label: 4, bag_size: 542
batch 539, loss: 0.0025, instance_loss: 0.1260, weighted_loss: 0.0396, label: 0, bag_size: 360


class 0 clustering acc 0.9858256880733945: correct 21491/21800
class 1 clustering acc 0.5470183486238532: correct 2385/4360
Epoch: 28, train_loss: 0.2209, train_clustering_loss:  0.2588, train_error: 0.0789
class 0: acc 0.9473684210526315, correct 90/95
class 1: acc 0.8857142857142857, correct 93/105
class 2: acc 0.8518518518518519, correct 92/108
class 3: acc 0.9380530973451328, correct 106/113
class 4: acc 0.9758064516129032, correct 121/124

Val Set, val_loss: 1.0290, val_error: 0.3800, auc: 0.9004
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.4125: correct 165/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0327, instance_loss: 0.1292, weighted_loss: 0.0616, label: 0, bag_size: 921
batch 39, loss: 0.0478, instance_loss: 0.3911, weighted_loss: 0.1508, label: 1, bag_size: 1144
batch 59, loss: 0.9029, instance_loss: 0.5340, weighted_loss: 0.7922, label: 3, bag_size: 281
batch 79, loss: 0.0950, instance_loss: 0.6847, weighted_loss: 0.2719, label: 4, bag_size: 663
batch 99, loss: 0.7615, instance_loss: 0.5219, weighted_loss: 0.6896, label: 2, bag_size: 3236
batch 119, loss: 0.3119, instance_loss: 0.3149, weighted_loss: 0.3128, label: 2, bag_size: 356
batch 139, loss: 0.1889, instance_loss: 0.7988, weighted_loss: 0.3719, label: 4, bag_size: 675
batch 159, loss: 0.0993, instance_loss: 0.5208, weighted_loss: 0.2258, label: 0, bag_size: 143
batch 179, loss: 0.0044, instance_loss: 0.0416, weighted_loss: 0.0156, label: 4, bag_size: 150
batch 199, loss: 0.3451, instance_loss: 0.2983, weighted_loss: 0.3310, label: 2, bag_size: 1289
batch 219, loss: 0.0004, instance_loss: 0.0403, weighted_loss: 0.0123, label: 3, bag_size: 66
batch 239, loss: 0.0067, instance_loss: 0.3419, weighted_loss: 0.1073, label: 4, bag_size: 754
batch 259, loss: 0.0383, instance_loss: 0.1879, weighted_loss: 0.0832, label: 2, bag_size: 1259
batch 279, loss: 0.0472, instance_loss: 0.1168, weighted_loss: 0.0680, label: 0, bag_size: 570
batch 299, loss: 0.0001, instance_loss: 0.1072, weighted_loss: 0.0323, label: 3, bag_size: 20
batch 319, loss: 0.0093, instance_loss: 0.0525, weighted_loss: 0.0223, label: 4, bag_size: 110
batch 339, loss: 0.1074, instance_loss: 0.2417, weighted_loss: 0.1477, label: 1, bag_size: 320
batch 359, loss: 0.0032, instance_loss: 0.0749, weighted_loss: 0.0247, label: 3, bag_size: 123
batch 379, loss: 0.0016, instance_loss: 0.0165, weighted_loss: 0.0060, label: 4, bag_size: 202
batch 399, loss: 0.1405, instance_loss: 0.2534, weighted_loss: 0.1744, label: 2, bag_size: 730
batch 419, loss: 0.0011, instance_loss: 0.0566, weighted_loss: 0.0178, label: 3, bag_size: 27
batch 439, loss: 0.0016, instance_loss: 0.0181, weighted_loss: 0.0065, label: 3, bag_size: 66
batch 459, loss: 0.0002, instance_loss: 0.0400, weighted_loss: 0.0121, label: 3, bag_size: 43
batch 479, loss: 0.0051, instance_loss: 0.1135, weighted_loss: 0.0376, label: 4, bag_size: 40
batch 499, loss: 0.4789, instance_loss: 0.4645, weighted_loss: 0.4746, label: 1, bag_size: 377
batch 519, loss: 2.4450, instance_loss: 0.6729, weighted_loss: 1.9134, label: 1, bag_size: 1197
batch 539, loss: 3.6758, instance_loss: 0.8999, weighted_loss: 2.8430, label: 3, bag_size: 607


class 0 clustering acc 0.9882568807339449: correct 21544/21800
class 1 clustering acc 0.5236238532110091: correct 2283/4360
Epoch: 29, train_loss: 0.2112, train_clustering_loss:  0.2601, train_error: 0.0771
class 0: acc 0.9743589743589743, correct 114/117
class 1: acc 0.8348623853211009, correct 91/109
class 2: acc 0.8631578947368421, correct 82/95
class 3: acc 0.926605504587156, correct 101/109
class 4: acc 1.0, correct 115/115

Val Set, val_loss: 0.9851, val_error: 0.3400, auc: 0.9061
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.44: correct 176/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.65, correct 13/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0015, instance_loss: 0.0159, weighted_loss: 0.0058, label: 4, bag_size: 96
batch 39, loss: 0.0716, instance_loss: 0.1645, weighted_loss: 0.0995, label: 1, bag_size: 696
batch 59, loss: 0.2313, instance_loss: 0.2194, weighted_loss: 0.2277, label: 2, bag_size: 750
batch 79, loss: 0.1912, instance_loss: 0.2586, weighted_loss: 0.2114, label: 2, bag_size: 1050
batch 99, loss: 0.0356, instance_loss: 0.2179, weighted_loss: 0.0903, label: 2, bag_size: 2081
batch 119, loss: 0.0072, instance_loss: 0.0718, weighted_loss: 0.0266, label: 1, bag_size: 847
batch 139, loss: 0.2325, instance_loss: 0.1777, weighted_loss: 0.2161, label: 1, bag_size: 697
batch 159, loss: 0.0197, instance_loss: 0.2635, weighted_loss: 0.0928, label: 4, bag_size: 1235
batch 179, loss: 0.0828, instance_loss: 0.1831, weighted_loss: 0.1129, label: 2, bag_size: 2826
batch 199, loss: 0.3289, instance_loss: 0.3693, weighted_loss: 0.3410, label: 0, bag_size: 338
batch 219, loss: 0.0838, instance_loss: 0.3099, weighted_loss: 0.1516, label: 1, bag_size: 746
batch 239, loss: 0.3623, instance_loss: 0.3453, weighted_loss: 0.3572, label: 0, bag_size: 912
batch 259, loss: 0.0014, instance_loss: 0.0385, weighted_loss: 0.0125, label: 3, bag_size: 78
batch 279, loss: 0.3326, instance_loss: 0.3192, weighted_loss: 0.3286, label: 1, bag_size: 534
batch 299, loss: 0.0339, instance_loss: 0.0759, weighted_loss: 0.0465, label: 3, bag_size: 1559
batch 319, loss: 0.0184, instance_loss: 0.5161, weighted_loss: 0.1677, label: 3, bag_size: 1253
batch 339, loss: 0.3428, instance_loss: 0.2523, weighted_loss: 0.3157, label: 2, bag_size: 720
batch 359, loss: 0.0008, instance_loss: 0.1207, weighted_loss: 0.0368, label: 4, bag_size: 128
batch 379, loss: 0.0007, instance_loss: 0.0882, weighted_loss: 0.0270, label: 4, bag_size: 47
batch 399, loss: 0.0373, instance_loss: 0.1300, weighted_loss: 0.0652, label: 2, bag_size: 1448
batch 419, loss: 1.1340, instance_loss: 0.8588, weighted_loss: 1.0514, label: 1, bag_size: 660
batch 439, loss: 0.5963, instance_loss: 0.4061, weighted_loss: 0.5392, label: 1, bag_size: 1559
batch 459, loss: 0.2838, instance_loss: 0.6016, weighted_loss: 0.3791, label: 3, bag_size: 1250
batch 479, loss: 0.2973, instance_loss: 0.5469, weighted_loss: 0.3722, label: 4, bag_size: 366
batch 499, loss: 0.0171, instance_loss: 0.4352, weighted_loss: 0.1425, label: 3, bag_size: 1253
batch 519, loss: 0.0102, instance_loss: 0.2154, weighted_loss: 0.0717, label: 0, bag_size: 118
batch 539, loss: 0.0004, instance_loss: 0.0439, weighted_loss: 0.0134, label: 3, bag_size: 43


class 0 clustering acc 0.9873853211009175: correct 21525/21800
class 1 clustering acc 0.5490825688073394: correct 2394/4360
Epoch: 30, train_loss: 0.2055, train_clustering_loss:  0.2602, train_error: 0.0679
class 0: acc 0.9576271186440678, correct 113/118
class 1: acc 0.8080808080808081, correct 80/99
class 2: acc 0.926829268292683, correct 114/123
class 3: acc 0.9724770642201835, correct 106/109
class 4: acc 0.9895833333333334, correct 95/96

Val Set, val_loss: 1.2434, val_error: 0.4800, auc: 0.9086
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.39: correct 156/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.25, correct 5/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.0392, instance_loss: 0.5207, weighted_loss: 0.8836, label: 0, bag_size: 760
batch 39, loss: 1.7751, instance_loss: 0.6121, weighted_loss: 1.4262, label: 1, bag_size: 1197
batch 59, loss: 0.0770, instance_loss: 0.1190, weighted_loss: 0.0896, label: 1, bag_size: 1086
batch 79, loss: 0.0801, instance_loss: 0.2147, weighted_loss: 0.1204, label: 2, bag_size: 404
batch 99, loss: 0.0002, instance_loss: 0.0427, weighted_loss: 0.0129, label: 4, bag_size: 55
batch 119, loss: 0.0075, instance_loss: 0.1491, weighted_loss: 0.0500, label: 0, bag_size: 1135
batch 139, loss: 0.0008, instance_loss: 0.2915, weighted_loss: 0.0880, label: 4, bag_size: 23
batch 159, loss: 0.7166, instance_loss: 0.3989, weighted_loss: 0.6213, label: 1, bag_size: 1724
batch 179, loss: 0.1661, instance_loss: 0.1297, weighted_loss: 0.1552, label: 0, bag_size: 630
batch 199, loss: 0.2684, instance_loss: 0.3829, weighted_loss: 0.3028, label: 2, bag_size: 542
batch 219, loss: 0.1752, instance_loss: 0.4071, weighted_loss: 0.2448, label: 1, bag_size: 700
batch 239, loss: 0.0005, instance_loss: 0.1474, weighted_loss: 0.0445, label: 4, bag_size: 40
batch 259, loss: 0.0064, instance_loss: 0.1227, weighted_loss: 0.0413, label: 1, bag_size: 405
batch 279, loss: 0.0000, instance_loss: 0.0371, weighted_loss: 0.0112, label: 4, bag_size: 174
batch 299, loss: 0.1540, instance_loss: 0.2947, weighted_loss: 0.1962, label: 0, bag_size: 371
batch 319, loss: 0.0190, instance_loss: 0.0474, weighted_loss: 0.0275, label: 1, bag_size: 1277
batch 339, loss: 0.0000, instance_loss: 0.0877, weighted_loss: 0.0263, label: 4, bag_size: 88
batch 359, loss: 0.5137, instance_loss: 0.5379, weighted_loss: 0.5209, label: 0, bag_size: 868
batch 379, loss: 0.6935, instance_loss: 0.4054, weighted_loss: 0.6071, label: 2, bag_size: 720
batch 399, loss: 0.1202, instance_loss: 0.7288, weighted_loss: 0.3028, label: 2, bag_size: 518
batch 419, loss: 0.4192, instance_loss: 0.4497, weighted_loss: 0.4284, label: 1, bag_size: 1724
batch 439, loss: 0.0571, instance_loss: 0.2074, weighted_loss: 0.1022, label: 3, bag_size: 53
batch 459, loss: 0.0577, instance_loss: 0.1796, weighted_loss: 0.0943, label: 1, bag_size: 897
batch 479, loss: 0.0002, instance_loss: 0.1632, weighted_loss: 0.0491, label: 3, bag_size: 32
batch 499, loss: 3.4730, instance_loss: 0.8909, weighted_loss: 2.6984, label: 1, bag_size: 448
batch 519, loss: 0.0488, instance_loss: 0.3398, weighted_loss: 0.1361, label: 1, bag_size: 1646
batch 539, loss: 0.0005, instance_loss: 0.0181, weighted_loss: 0.0058, label: 0, bag_size: 385


class 0 clustering acc 0.9869266055045871: correct 21515/21800
class 1 clustering acc 0.5697247706422018: correct 2484/4360
Epoch: 31, train_loss: 0.1795, train_clustering_loss:  0.2473, train_error: 0.0624
class 0: acc 0.9661016949152542, correct 114/118
class 1: acc 0.8785046728971962, correct 94/107
class 2: acc 0.9, correct 99/110
class 3: acc 0.9603960396039604, correct 97/101
class 4: acc 0.981651376146789, correct 107/109

Val Set, val_loss: 0.9651, val_error: 0.3800, auc: 0.9117
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.4025: correct 161/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.45, correct 9/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0835, weighted_loss: 0.0252, label: 3, bag_size: 37
batch 39, loss: 0.1024, instance_loss: 0.2327, weighted_loss: 0.1415, label: 0, bag_size: 736
batch 59, loss: 0.0627, instance_loss: 0.3522, weighted_loss: 0.1495, label: 0, bag_size: 163
batch 79, loss: 0.0807, instance_loss: 0.2618, weighted_loss: 0.1351, label: 0, bag_size: 478
batch 99, loss: 0.8393, instance_loss: 0.4705, weighted_loss: 0.7287, label: 2, bag_size: 629
batch 119, loss: 0.0005, instance_loss: 0.0248, weighted_loss: 0.0078, label: 0, bag_size: 982
batch 139, loss: 0.0113, instance_loss: 0.0927, weighted_loss: 0.0357, label: 2, bag_size: 470
batch 159, loss: 0.1447, instance_loss: 0.2036, weighted_loss: 0.1624, label: 1, bag_size: 945
batch 179, loss: 0.2517, instance_loss: 0.3850, weighted_loss: 0.2917, label: 0, bag_size: 1065
batch 199, loss: 0.4480, instance_loss: 0.4812, weighted_loss: 0.4580, label: 1, bag_size: 139
batch 219, loss: 0.0006, instance_loss: 0.2174, weighted_loss: 0.0656, label: 3, bag_size: 18
batch 239, loss: 0.8576, instance_loss: 0.5213, weighted_loss: 0.7567, label: 1, bag_size: 1144
batch 259, loss: 0.0019, instance_loss: 0.0280, weighted_loss: 0.0098, label: 0, bag_size: 360
batch 279, loss: 0.7147, instance_loss: 0.3753, weighted_loss: 0.6129, label: 2, bag_size: 1617
batch 299, loss: 0.0012, instance_loss: 0.0496, weighted_loss: 0.0157, label: 3, bag_size: 78
batch 319, loss: 0.0006, instance_loss: 0.0357, weighted_loss: 0.0111, label: 4, bag_size: 112
batch 339, loss: 0.0144, instance_loss: 0.1995, weighted_loss: 0.0699, label: 0, bag_size: 155
batch 359, loss: 0.0013, instance_loss: 0.0670, weighted_loss: 0.0210, label: 4, bag_size: 51
batch 379, loss: 0.0998, instance_loss: 0.2544, weighted_loss: 0.1462, label: 3, bag_size: 1177
batch 399, loss: 0.2012, instance_loss: 0.7672, weighted_loss: 0.3710, label: 4, bag_size: 663
batch 419, loss: 0.0017, instance_loss: 0.0839, weighted_loss: 0.0264, label: 0, bag_size: 616
batch 439, loss: 0.0005, instance_loss: 0.0471, weighted_loss: 0.0145, label: 3, bag_size: 34
batch 459, loss: 0.0206, instance_loss: 0.1590, weighted_loss: 0.0621, label: 2, bag_size: 600
batch 479, loss: 0.0841, instance_loss: 0.5659, weighted_loss: 0.2286, label: 4, bag_size: 366
batch 499, loss: 0.0196, instance_loss: 0.4897, weighted_loss: 0.1606, label: 2, bag_size: 204
batch 519, loss: 0.4601, instance_loss: 0.6390, weighted_loss: 0.5138, label: 1, bag_size: 435
batch 539, loss: 0.0431, instance_loss: 0.2045, weighted_loss: 0.0915, label: 2, bag_size: 292


class 0 clustering acc 0.9878440366972477: correct 21535/21800
class 1 clustering acc 0.5458715596330275: correct 2380/4360
Epoch: 32, train_loss: 0.1845, train_clustering_loss:  0.2543, train_error: 0.0569
class 0: acc 0.9814814814814815, correct 106/108
class 1: acc 0.9083333333333333, correct 109/120
class 2: acc 0.8723404255319149, correct 82/94
class 3: acc 0.9557522123893806, correct 108/113
class 4: acc 0.990909090909091, correct 109/110

Val Set, val_loss: 1.0783, val_error: 0.4200, auc: 0.9168
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.3875: correct 155/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.35, correct 7/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.1701, instance_loss: 0.5449, weighted_loss: 0.2826, label: 1, bag_size: 917
batch 39, loss: 1.1674, instance_loss: 0.5528, weighted_loss: 0.9830, label: 2, bag_size: 732
batch 59, loss: 0.0778, instance_loss: 0.4018, weighted_loss: 0.1750, label: 4, bag_size: 524
batch 79, loss: 0.0116, instance_loss: 0.1221, weighted_loss: 0.0448, label: 2, bag_size: 317
batch 99, loss: 0.0430, instance_loss: 0.2565, weighted_loss: 0.1071, label: 0, bag_size: 122
batch 119, loss: 0.0402, instance_loss: 0.1522, weighted_loss: 0.0738, label: 2, bag_size: 347
batch 139, loss: 0.0131, instance_loss: 0.0602, weighted_loss: 0.0272, label: 2, bag_size: 455
batch 159, loss: 0.1308, instance_loss: 0.2074, weighted_loss: 0.1537, label: 2, bag_size: 1050
batch 179, loss: 0.0125, instance_loss: 0.1844, weighted_loss: 0.0641, label: 0, bag_size: 472
batch 199, loss: 0.0051, instance_loss: 0.0927, weighted_loss: 0.0314, label: 0, bag_size: 1235
batch 219, loss: 0.0013, instance_loss: 0.2267, weighted_loss: 0.0689, label: 4, bag_size: 711
batch 239, loss: 0.2850, instance_loss: 0.3990, weighted_loss: 0.3192, label: 1, bag_size: 377
batch 259, loss: 0.0894, instance_loss: 0.1304, weighted_loss: 0.1017, label: 2, bag_size: 1019
batch 279, loss: 1.7826, instance_loss: 0.5263, weighted_loss: 1.4057, label: 2, bag_size: 508
batch 299, loss: 0.2667, instance_loss: 0.2889, weighted_loss: 0.2734, label: 2, bag_size: 1047
batch 319, loss: 0.0007, instance_loss: 0.0489, weighted_loss: 0.0152, label: 4, bag_size: 91
batch 339, loss: 0.1119, instance_loss: 0.4468, weighted_loss: 0.2124, label: 2, bag_size: 679
batch 359, loss: 0.0073, instance_loss: 0.1499, weighted_loss: 0.0501, label: 3, bag_size: 15
batch 379, loss: 0.0031, instance_loss: 0.1715, weighted_loss: 0.0536, label: 0, bag_size: 116
batch 399, loss: 0.0001, instance_loss: 0.0728, weighted_loss: 0.0219, label: 3, bag_size: 43
batch 419, loss: 0.2928, instance_loss: 0.4165, weighted_loss: 0.3299, label: 2, bag_size: 1128
batch 439, loss: 0.0202, instance_loss: 0.2481, weighted_loss: 0.0886, label: 0, bag_size: 118
batch 459, loss: 0.0455, instance_loss: 0.1954, weighted_loss: 0.0904, label: 3, bag_size: 1399
batch 479, loss: 0.0001, instance_loss: 0.0737, weighted_loss: 0.0222, label: 3, bag_size: 43
batch 499, loss: 0.4028, instance_loss: 0.6924, weighted_loss: 0.4897, label: 2, bag_size: 911
batch 519, loss: 0.0229, instance_loss: 0.0750, weighted_loss: 0.0386, label: 1, bag_size: 1426
batch 539, loss: 0.0020, instance_loss: 0.0999, weighted_loss: 0.0314, label: 4, bag_size: 143


class 0 clustering acc 0.986697247706422: correct 21510/21800
class 1 clustering acc 0.563302752293578: correct 2456/4360
Epoch: 33, train_loss: 0.2092, train_clustering_loss:  0.2496, train_error: 0.0661
class 0: acc 0.9732142857142857, correct 109/112
class 1: acc 0.8604651162790697, correct 74/86
class 2: acc 0.8771929824561403, correct 100/114
class 3: acc 0.9495798319327731, correct 113/119
class 4: acc 0.9912280701754386, correct 113/114

Val Set, val_loss: 0.9811, val_error: 0.4000, auc: 0.9247
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.3925: correct 157/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.35, correct 7/20
class 3: acc 0.875, correct 7/8
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0089, instance_loss: 0.1180, weighted_loss: 0.0416, label: 4, bag_size: 28
batch 39, loss: 0.0001, instance_loss: 0.0629, weighted_loss: 0.0189, label: 3, bag_size: 50
batch 59, loss: 0.1149, instance_loss: 0.5402, weighted_loss: 0.2425, label: 3, bag_size: 200
batch 79, loss: 0.0204, instance_loss: 0.1413, weighted_loss: 0.0567, label: 1, bag_size: 1325
batch 99, loss: 0.0827, instance_loss: 0.1706, weighted_loss: 0.1091, label: 0, bag_size: 515
batch 119, loss: 0.0745, instance_loss: 0.1874, weighted_loss: 0.1084, label: 2, bag_size: 1019
batch 139, loss: 0.0017, instance_loss: 0.1718, weighted_loss: 0.0527, label: 4, bag_size: 26
batch 159, loss: 0.0073, instance_loss: 0.1513, weighted_loss: 0.0505, label: 3, bag_size: 21
batch 179, loss: 0.4419, instance_loss: 0.4622, weighted_loss: 0.4480, label: 2, bag_size: 632
batch 199, loss: 0.0174, instance_loss: 0.1119, weighted_loss: 0.0458, label: 3, bag_size: 18
batch 219, loss: 0.0004, instance_loss: 0.0717, weighted_loss: 0.0218, label: 4, bag_size: 157
batch 239, loss: 0.3438, instance_loss: 0.4841, weighted_loss: 0.3859, label: 1, bag_size: 139
batch 259, loss: 0.0009, instance_loss: 0.1404, weighted_loss: 0.0428, label: 3, bag_size: 20
batch 279, loss: 0.0056, instance_loss: 0.1727, weighted_loss: 0.0557, label: 4, bag_size: 47
batch 299, loss: 0.0627, instance_loss: 0.2790, weighted_loss: 0.1276, label: 0, bag_size: 759
batch 319, loss: 0.2875, instance_loss: 0.3923, weighted_loss: 0.3189, label: 0, bag_size: 868
batch 339, loss: 0.0222, instance_loss: 0.1119, weighted_loss: 0.0491, label: 2, bag_size: 317
batch 359, loss: 0.2478, instance_loss: 0.3737, weighted_loss: 0.2856, label: 2, bag_size: 537
batch 379, loss: 0.1713, instance_loss: 0.3965, weighted_loss: 0.2388, label: 2, bag_size: 1439
batch 399, loss: 0.0006, instance_loss: 0.1565, weighted_loss: 0.0474, label: 3, bag_size: 18
batch 419, loss: 0.0827, instance_loss: 0.2811, weighted_loss: 0.1422, label: 2, bag_size: 312
batch 439, loss: 0.1424, instance_loss: 0.3604, weighted_loss: 0.2078, label: 1, bag_size: 700
batch 459, loss: 0.0008, instance_loss: 0.0372, weighted_loss: 0.0117, label: 0, bag_size: 982
batch 479, loss: 0.0238, instance_loss: 0.1204, weighted_loss: 0.0527, label: 1, bag_size: 1127
batch 499, loss: 0.0004, instance_loss: 0.0856, weighted_loss: 0.0259, label: 4, bag_size: 48
batch 519, loss: 0.0004, instance_loss: 0.0694, weighted_loss: 0.0211, label: 4, bag_size: 125
batch 539, loss: 0.0008, instance_loss: 0.0334, weighted_loss: 0.0106, label: 3, bag_size: 28


class 0 clustering acc 0.9888073394495412: correct 21556/21800
class 1 clustering acc 0.5348623853211009: correct 2332/4360
Epoch: 34, train_loss: 0.1978, train_clustering_loss:  0.2520, train_error: 0.0734
class 0: acc 0.9722222222222222, correct 105/108
class 1: acc 0.8214285714285714, correct 92/112
class 2: acc 0.8842105263157894, correct 84/95
class 3: acc 0.9491525423728814, correct 112/118
class 4: acc 1.0, correct 112/112

Val Set, val_loss: 1.0458, val_error: 0.4200, auc: 0.9118
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.4025: correct 161/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.4, correct 8/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.6118, instance_loss: 0.3964, weighted_loss: 0.5472, label: 4, bag_size: 533
batch 39, loss: 0.0381, instance_loss: 0.1623, weighted_loss: 0.0753, label: 0, bag_size: 371
batch 59, loss: 0.0001, instance_loss: 0.1972, weighted_loss: 0.0592, label: 4, bag_size: 19
batch 79, loss: 0.0021, instance_loss: 0.3880, weighted_loss: 0.1179, label: 4, bag_size: 14
batch 99, loss: 0.0101, instance_loss: 0.3032, weighted_loss: 0.0980, label: 4, bag_size: 928
batch 119, loss: 0.0000, instance_loss: 0.0984, weighted_loss: 0.0295, label: 3, bag_size: 41
batch 139, loss: 0.0924, instance_loss: 0.5110, weighted_loss: 0.2180, label: 3, bag_size: 283
batch 159, loss: 0.6221, instance_loss: 0.5157, weighted_loss: 0.5901, label: 4, bag_size: 1337
batch 179, loss: 0.0049, instance_loss: 0.1887, weighted_loss: 0.0600, label: 1, bag_size: 949
batch 199, loss: 1.7899, instance_loss: 0.7310, weighted_loss: 1.4722, label: 1, bag_size: 1144
batch 219, loss: 0.0100, instance_loss: 0.0696, weighted_loss: 0.0279, label: 3, bag_size: 78
batch 239, loss: 0.7241, instance_loss: 0.4425, weighted_loss: 0.6396, label: 2, bag_size: 411
batch 259, loss: 0.0126, instance_loss: 0.2189, weighted_loss: 0.0745, label: 4, bag_size: 47
batch 279, loss: 0.1468, instance_loss: 0.4157, weighted_loss: 0.2275, label: 2, bag_size: 411
batch 299, loss: 0.4379, instance_loss: 0.6338, weighted_loss: 0.4967, label: 4, bag_size: 1331
batch 319, loss: 0.0009, instance_loss: 0.0388, weighted_loss: 0.0122, label: 4, bag_size: 192
batch 339, loss: 0.0753, instance_loss: 0.3469, weighted_loss: 0.1568, label: 1, bag_size: 700
batch 359, loss: 0.0003, instance_loss: 0.0268, weighted_loss: 0.0082, label: 4, bag_size: 148
batch 379, loss: 0.0110, instance_loss: 0.3262, weighted_loss: 0.1056, label: 0, bag_size: 129
batch 399, loss: 0.0763, instance_loss: 0.1786, weighted_loss: 0.1070, label: 2, bag_size: 910
batch 419, loss: 0.0086, instance_loss: 0.1807, weighted_loss: 0.0602, label: 0, bag_size: 118
batch 439, loss: 0.0003, instance_loss: 0.0389, weighted_loss: 0.0119, label: 3, bag_size: 20
batch 459, loss: 0.2097, instance_loss: 0.4422, weighted_loss: 0.2795, label: 1, bag_size: 1646
batch 479, loss: 0.7196, instance_loss: 0.4435, weighted_loss: 0.6368, label: 1, bag_size: 1646
batch 499, loss: 0.0170, instance_loss: 0.0675, weighted_loss: 0.0321, label: 0, bag_size: 1301
batch 519, loss: 0.0124, instance_loss: 0.1334, weighted_loss: 0.0487, label: 0, bag_size: 1190
batch 539, loss: 0.0872, instance_loss: 0.2906, weighted_loss: 0.1482, label: 4, bag_size: 542


class 0 clustering acc 0.9865596330275229: correct 21507/21800
class 1 clustering acc 0.5571100917431193: correct 2429/4360
Epoch: 35, train_loss: 0.1586, train_clustering_loss:  0.2499, train_error: 0.0440
class 0: acc 0.9824561403508771, correct 112/114
class 1: acc 0.8691588785046729, correct 93/107
class 2: acc 0.9464285714285714, correct 106/112
class 3: acc 0.9805825242718447, correct 101/103
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 1.0168, val_error: 0.4000, auc: 0.9253
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.39: correct 156/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 1.0, correct 7/7
class 2: acc 0.35, correct 7/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.6112, instance_loss: 0.4935, weighted_loss: 0.5759, label: 2, bag_size: 271
batch 39, loss: 0.0060, instance_loss: 0.1312, weighted_loss: 0.0435, label: 0, bag_size: 962
batch 59, loss: 0.0004, instance_loss: 0.0378, weighted_loss: 0.0116, label: 4, bag_size: 162
batch 79, loss: 0.3049, instance_loss: 0.3268, weighted_loss: 0.3114, label: 2, bag_size: 758
batch 99, loss: 0.4060, instance_loss: 0.3663, weighted_loss: 0.3941, label: 2, bag_size: 271
batch 119, loss: 0.0010, instance_loss: 0.0302, weighted_loss: 0.0098, label: 3, bag_size: 33
batch 139, loss: 0.1165, instance_loss: 0.2210, weighted_loss: 0.1479, label: 0, bag_size: 990
batch 159, loss: 0.0001, instance_loss: 0.0609, weighted_loss: 0.0184, label: 4, bag_size: 125
batch 179, loss: 0.0377, instance_loss: 0.4329, weighted_loss: 0.1563, label: 4, bag_size: 1002
batch 199, loss: 0.0010, instance_loss: 0.1776, weighted_loss: 0.0540, label: 4, bag_size: 104
batch 219, loss: 0.4838, instance_loss: 0.2637, weighted_loss: 0.4178, label: 2, bag_size: 758
batch 239, loss: 0.1409, instance_loss: 0.2111, weighted_loss: 0.1619, label: 1, bag_size: 860
batch 259, loss: 0.0161, instance_loss: 0.1876, weighted_loss: 0.0675, label: 3, bag_size: 18
batch 279, loss: 0.0062, instance_loss: 0.0868, weighted_loss: 0.0303, label: 0, bag_size: 552
batch 299, loss: 0.0019, instance_loss: 0.0489, weighted_loss: 0.0160, label: 4, bag_size: 94
batch 319, loss: 0.0031, instance_loss: 0.3418, weighted_loss: 0.1047, label: 4, bag_size: 974
batch 339, loss: 1.0616, instance_loss: 0.3268, weighted_loss: 0.8412, label: 2, bag_size: 471
batch 359, loss: 0.0048, instance_loss: 0.2010, weighted_loss: 0.0637, label: 4, bag_size: 47
batch 379, loss: 0.5112, instance_loss: 0.7448, weighted_loss: 0.5813, label: 3, bag_size: 630
batch 399, loss: 0.4700, instance_loss: 0.2358, weighted_loss: 0.3997, label: 0, bag_size: 1046
batch 419, loss: 0.0001, instance_loss: 0.0443, weighted_loss: 0.0133, label: 3, bag_size: 35
batch 439, loss: 0.4729, instance_loss: 0.4796, weighted_loss: 0.4749, label: 1, bag_size: 651
batch 459, loss: 0.0424, instance_loss: 0.3393, weighted_loss: 0.1314, label: 1, bag_size: 1559
batch 479, loss: 0.0041, instance_loss: 0.1373, weighted_loss: 0.0441, label: 1, bag_size: 890
batch 499, loss: 0.2670, instance_loss: 0.2392, weighted_loss: 0.2587, label: 2, bag_size: 750
batch 519, loss: 0.0034, instance_loss: 0.0696, weighted_loss: 0.0233, label: 0, bag_size: 976
batch 539, loss: 0.1435, instance_loss: 0.3213, weighted_loss: 0.1968, label: 1, bag_size: 1144


class 0 clustering acc 0.9846788990825688: correct 21466/21800
class 1 clustering acc 0.5697247706422018: correct 2484/4360
Epoch: 36, train_loss: 0.1781, train_clustering_loss:  0.2478, train_error: 0.0587
class 0: acc 0.972972972972973, correct 108/111
class 1: acc 0.8431372549019608, correct 86/102
class 2: acc 0.9279279279279279, correct 103/111
class 3: acc 0.9658119658119658, correct 113/117
class 4: acc 0.9903846153846154, correct 103/104

Val Set, val_loss: 0.9918, val_error: 0.3400, auc: 0.9095
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.4275: correct 171/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.55, correct 11/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0395, weighted_loss: 0.0119, label: 4, bag_size: 60
batch 39, loss: 0.0006, instance_loss: 0.2201, weighted_loss: 0.0665, label: 3, bag_size: 15
batch 59, loss: 0.0118, instance_loss: 0.0487, weighted_loss: 0.0229, label: 1, bag_size: 1426
batch 79, loss: 0.1191, instance_loss: 0.6082, weighted_loss: 0.2658, label: 3, bag_size: 200
batch 99, loss: 0.2639, instance_loss: 0.2181, weighted_loss: 0.2502, label: 2, bag_size: 270
batch 119, loss: 0.0104, instance_loss: 0.1506, weighted_loss: 0.0525, label: 4, bag_size: 773
batch 139, loss: 0.0079, instance_loss: 0.0557, weighted_loss: 0.0222, label: 0, bag_size: 1190
batch 159, loss: 0.0168, instance_loss: 0.3091, weighted_loss: 0.1045, label: 4, bag_size: 1176
batch 179, loss: 0.1028, instance_loss: 0.5987, weighted_loss: 0.2515, label: 3, bag_size: 283
batch 199, loss: 0.0007, instance_loss: 0.0142, weighted_loss: 0.0048, label: 3, bag_size: 78
batch 219, loss: 0.0006, instance_loss: 0.0275, weighted_loss: 0.0087, label: 4, bag_size: 182
batch 239, loss: 0.3567, instance_loss: 0.2404, weighted_loss: 0.3218, label: 0, bag_size: 990
batch 259, loss: 0.0259, instance_loss: 0.2486, weighted_loss: 0.0927, label: 4, bag_size: 1474
batch 279, loss: 0.1189, instance_loss: 0.1724, weighted_loss: 0.1349, label: 2, bag_size: 977
batch 299, loss: 0.1221, instance_loss: 0.3181, weighted_loss: 0.1809, label: 2, bag_size: 1039
batch 319, loss: 0.0056, instance_loss: 0.1893, weighted_loss: 0.0607, label: 4, bag_size: 656
batch 339, loss: 0.1077, instance_loss: 0.1440, weighted_loss: 0.1186, label: 1, bag_size: 346
batch 359, loss: 0.0061, instance_loss: 0.0758, weighted_loss: 0.0270, label: 0, bag_size: 731
batch 379, loss: 0.0833, instance_loss: 0.3316, weighted_loss: 0.1578, label: 3, bag_size: 1253
batch 399, loss: 0.1097, instance_loss: 0.6937, weighted_loss: 0.2849, label: 1, bag_size: 1390
batch 419, loss: 0.0549, instance_loss: 0.5960, weighted_loss: 0.2173, label: 3, bag_size: 230
batch 439, loss: 0.0191, instance_loss: 0.2083, weighted_loss: 0.0759, label: 0, bag_size: 466
batch 459, loss: 0.0002, instance_loss: 0.1460, weighted_loss: 0.0439, label: 0, bag_size: 360
batch 479, loss: 0.3392, instance_loss: 0.5051, weighted_loss: 0.3889, label: 2, bag_size: 408
batch 499, loss: 0.1107, instance_loss: 0.2478, weighted_loss: 0.1518, label: 1, bag_size: 754
batch 519, loss: 0.0005, instance_loss: 0.1828, weighted_loss: 0.0552, label: 3, bag_size: 18
batch 539, loss: 0.2208, instance_loss: 0.2551, weighted_loss: 0.2311, label: 2, bag_size: 264


class 0 clustering acc 0.9852752293577982: correct 21479/21800
class 1 clustering acc 0.5651376146788991: correct 2464/4360
Epoch: 37, train_loss: 0.1631, train_clustering_loss:  0.2520, train_error: 0.0495
class 0: acc 0.9805825242718447, correct 101/103
class 1: acc 0.9047619047619048, correct 95/105
class 2: acc 0.9, correct 99/110
class 3: acc 0.9615384615384616, correct 100/104
class 4: acc 1.0, correct 123/123

Val Set, val_loss: 1.0041, val_error: 0.3800, auc: 0.9223
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.4325: correct 173/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.45, correct 9/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0000, instance_loss: 0.1258, weighted_loss: 0.0378, label: 3, bag_size: 50
batch 39, loss: 0.0000, instance_loss: 0.0153, weighted_loss: 0.0046, label: 4, bag_size: 174
batch 59, loss: 0.0095, instance_loss: 0.0561, weighted_loss: 0.0235, label: 1, bag_size: 1261
batch 79, loss: 0.3182, instance_loss: 0.3073, weighted_loss: 0.3149, label: 2, bag_size: 806
batch 99, loss: 0.0339, instance_loss: 0.2031, weighted_loss: 0.0847, label: 0, bag_size: 759
batch 119, loss: 0.1225, instance_loss: 0.2313, weighted_loss: 0.1551, label: 2, bag_size: 404
batch 139, loss: 0.0620, instance_loss: 0.2219, weighted_loss: 0.1100, label: 1, bag_size: 320
batch 159, loss: 0.0009, instance_loss: 0.0283, weighted_loss: 0.0091, label: 3, bag_size: 66
batch 179, loss: 0.0044, instance_loss: 0.1082, weighted_loss: 0.0355, label: 0, bag_size: 1174
batch 199, loss: 0.9130, instance_loss: 0.6204, weighted_loss: 0.8252, label: 4, bag_size: 1337
batch 219, loss: 1.4299, instance_loss: 0.7723, weighted_loss: 1.2326, label: 1, bag_size: 875
batch 239, loss: 0.0667, instance_loss: 0.3543, weighted_loss: 0.1530, label: 2, bag_size: 499
batch 259, loss: 0.0000, instance_loss: 0.0148, weighted_loss: 0.0045, label: 4, bag_size: 157
batch 279, loss: 0.0012, instance_loss: 0.0238, weighted_loss: 0.0080, label: 3, bag_size: 50
batch 299, loss: 0.2938, instance_loss: 0.3121, weighted_loss: 0.2993, label: 0, bag_size: 990
batch 319, loss: 0.0368, instance_loss: 0.1563, weighted_loss: 0.0727, label: 1, bag_size: 504
batch 339, loss: 0.0001, instance_loss: 0.0222, weighted_loss: 0.0067, label: 4, bag_size: 147
batch 359, loss: 0.1947, instance_loss: 0.4003, weighted_loss: 0.2564, label: 1, bag_size: 139
batch 379, loss: 0.0020, instance_loss: 0.4524, weighted_loss: 0.1372, label: 4, bag_size: 1357
batch 399, loss: 0.0372, instance_loss: 0.2286, weighted_loss: 0.0946, label: 0, bag_size: 117
batch 419, loss: 0.0250, instance_loss: 0.3590, weighted_loss: 0.1252, label: 4, bag_size: 1002
batch 439, loss: 0.0811, instance_loss: 0.1801, weighted_loss: 0.1108, label: 2, bag_size: 846
batch 459, loss: 0.0353, instance_loss: 0.1808, weighted_loss: 0.0790, label: 2, bag_size: 626
batch 479, loss: 0.0014, instance_loss: 0.3068, weighted_loss: 0.0930, label: 3, bag_size: 28
batch 499, loss: 0.0371, instance_loss: 0.0747, weighted_loss: 0.0484, label: 1, bag_size: 1127
batch 519, loss: 0.0545, instance_loss: 0.2827, weighted_loss: 0.1230, label: 1, bag_size: 614
batch 539, loss: 0.0047, instance_loss: 0.0859, weighted_loss: 0.0291, label: 1, bag_size: 697


class 0 clustering acc 0.986605504587156: correct 21508/21800
class 1 clustering acc 0.5880733944954128: correct 2564/4360
Epoch: 38, train_loss: 0.1706, train_clustering_loss:  0.2396, train_error: 0.0642
class 0: acc 0.970873786407767, correct 100/103
class 1: acc 0.8938053097345132, correct 101/113
class 2: acc 0.8725490196078431, correct 89/102
class 3: acc 0.9532710280373832, correct 102/107
class 4: acc 0.9833333333333333, correct 118/120

Val Set, val_loss: 0.9458, val_error: 0.3200, auc: 0.9156
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.4725: correct 189/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0003, instance_loss: 0.1474, weighted_loss: 0.0444, label: 3, bag_size: 48
batch 39, loss: 0.0289, instance_loss: 0.3094, weighted_loss: 0.1130, label: 0, bag_size: 424
batch 59, loss: 0.0035, instance_loss: 0.1763, weighted_loss: 0.0553, label: 0, bag_size: 116
batch 79, loss: 0.0373, instance_loss: 0.2570, weighted_loss: 0.1032, label: 1, bag_size: 405
batch 99, loss: 0.2714, instance_loss: 0.3615, weighted_loss: 0.2984, label: 0, bag_size: 1065
batch 119, loss: 0.3294, instance_loss: 0.2258, weighted_loss: 0.2983, label: 1, bag_size: 598
batch 139, loss: 0.4000, instance_loss: 0.2902, weighted_loss: 0.3671, label: 1, bag_size: 442
batch 159, loss: 0.1311, instance_loss: 0.4508, weighted_loss: 0.2270, label: 0, bag_size: 282
batch 179, loss: 0.0193, instance_loss: 0.0669, weighted_loss: 0.0336, label: 0, bag_size: 375
batch 199, loss: 0.0107, instance_loss: 0.3071, weighted_loss: 0.0996, label: 2, bag_size: 1416
batch 219, loss: 0.0623, instance_loss: 0.1246, weighted_loss: 0.0810, label: 0, bag_size: 1061
batch 239, loss: 0.3108, instance_loss: 0.3753, weighted_loss: 0.3302, label: 3, bag_size: 1019
batch 259, loss: 0.0037, instance_loss: 0.0531, weighted_loss: 0.0185, label: 0, bag_size: 1235
batch 279, loss: 0.0044, instance_loss: 0.1033, weighted_loss: 0.0341, label: 3, bag_size: 18
batch 299, loss: 0.0032, instance_loss: 0.1215, weighted_loss: 0.0387, label: 2, bag_size: 525
batch 319, loss: 0.0323, instance_loss: 0.2147, weighted_loss: 0.0870, label: 0, bag_size: 1174
batch 339, loss: 0.0044, instance_loss: 0.1863, weighted_loss: 0.0590, label: 1, bag_size: 890
batch 359, loss: 0.0767, instance_loss: 0.1729, weighted_loss: 0.1056, label: 1, bag_size: 399
batch 379, loss: 0.0176, instance_loss: 0.1838, weighted_loss: 0.0675, label: 0, bag_size: 1332
batch 399, loss: 0.0001, instance_loss: 0.0241, weighted_loss: 0.0073, label: 3, bag_size: 87
batch 419, loss: 2.1571, instance_loss: 0.7813, weighted_loss: 1.7444, label: 1, bag_size: 1172
batch 439, loss: 0.0023, instance_loss: 0.0209, weighted_loss: 0.0079, label: 1, bag_size: 1277
batch 459, loss: 0.0324, instance_loss: 0.0929, weighted_loss: 0.0506, label: 1, bag_size: 356
batch 479, loss: 0.0047, instance_loss: 0.3892, weighted_loss: 0.1201, label: 0, bag_size: 136
batch 499, loss: 0.0258, instance_loss: 0.4599, weighted_loss: 0.1560, label: 4, bag_size: 928
batch 519, loss: 0.0529, instance_loss: 0.1118, weighted_loss: 0.0706, label: 1, bag_size: 320
batch 539, loss: 0.1875, instance_loss: 0.1573, weighted_loss: 0.1785, label: 0, bag_size: 630


class 0 clustering acc 0.9843577981651376: correct 21459/21800
class 1 clustering acc 0.6032110091743119: correct 2630/4360
Epoch: 39, train_loss: 0.1521, train_clustering_loss:  0.2388, train_error: 0.0367
class 0: acc 0.9844961240310077, correct 127/129
class 1: acc 0.8938053097345132, correct 101/113
class 2: acc 0.956140350877193, correct 109/114
class 3: acc 1.0, correct 90/90
class 4: acc 0.98989898989899, correct 98/99

Val Set, val_loss: 1.0560, val_error: 0.3400, auc: 0.9112
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.4625: correct 185/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.55, correct 11/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0002, instance_loss: 0.2729, weighted_loss: 0.0820, label: 4, bag_size: 24
batch 39, loss: 0.0003, instance_loss: 0.0506, weighted_loss: 0.0154, label: 4, bag_size: 79
batch 59, loss: 0.0001, instance_loss: 0.0186, weighted_loss: 0.0057, label: 3, bag_size: 105
batch 79, loss: 0.1205, instance_loss: 0.6643, weighted_loss: 0.2837, label: 1, bag_size: 657
batch 99, loss: 0.0041, instance_loss: 0.1618, weighted_loss: 0.0514, label: 0, bag_size: 962
batch 119, loss: 0.0000, instance_loss: 0.0221, weighted_loss: 0.0067, label: 4, bag_size: 63
batch 139, loss: 0.0917, instance_loss: 0.2564, weighted_loss: 0.1411, label: 1, bag_size: 1144
batch 159, loss: 0.0082, instance_loss: 0.2281, weighted_loss: 0.0742, label: 0, bag_size: 1332
batch 179, loss: 0.0144, instance_loss: 0.0333, weighted_loss: 0.0201, label: 0, bag_size: 756
batch 199, loss: 0.0002, instance_loss: 0.1370, weighted_loss: 0.0413, label: 4, bag_size: 83
batch 219, loss: 0.0237, instance_loss: 0.1929, weighted_loss: 0.0745, label: 2, bag_size: 1155
batch 239, loss: 0.0008, instance_loss: 0.0295, weighted_loss: 0.0094, label: 0, bag_size: 616
batch 259, loss: 0.0000, instance_loss: 0.0080, weighted_loss: 0.0024, label: 3, bag_size: 105
batch 279, loss: 0.0219, instance_loss: 0.2130, weighted_loss: 0.0792, label: 1, bag_size: 846
batch 299, loss: 1.7703, instance_loss: 0.7128, weighted_loss: 1.4531, label: 1, bag_size: 875
batch 319, loss: 0.1017, instance_loss: 0.3296, weighted_loss: 0.1701, label: 1, bag_size: 1559
batch 339, loss: 0.1428, instance_loss: 0.2952, weighted_loss: 0.1885, label: 2, bag_size: 1050
batch 359, loss: 0.0001, instance_loss: 0.0999, weighted_loss: 0.0301, label: 3, bag_size: 32
batch 379, loss: 0.0082, instance_loss: 0.3951, weighted_loss: 0.1243, label: 2, bag_size: 1128
batch 399, loss: 0.0015, instance_loss: 0.0262, weighted_loss: 0.0089, label: 3, bag_size: 115
batch 419, loss: 0.0015, instance_loss: 0.0294, weighted_loss: 0.0099, label: 3, bag_size: 143
batch 439, loss: 0.0004, instance_loss: 0.0120, weighted_loss: 0.0039, label: 4, bag_size: 123
batch 459, loss: 0.0054, instance_loss: 0.0572, weighted_loss: 0.0209, label: 1, bag_size: 1426
batch 479, loss: 0.0119, instance_loss: 0.7549, weighted_loss: 0.2348, label: 4, bag_size: 663
batch 499, loss: 0.0122, instance_loss: 0.0802, weighted_loss: 0.0326, label: 4, bag_size: 40
batch 519, loss: 0.0682, instance_loss: 0.4339, weighted_loss: 0.1779, label: 2, bag_size: 1150
batch 539, loss: 0.0004, instance_loss: 0.0308, weighted_loss: 0.0095, label: 0, bag_size: 402


class 0 clustering acc 0.9840825688073395: correct 21453/21800
class 1 clustering acc 0.6103211009174312: correct 2661/4360
Epoch: 40, train_loss: 0.1264, train_clustering_loss:  0.2368, train_error: 0.0330
class 0: acc 0.9911504424778761, correct 112/113
class 1: acc 0.9166666666666666, correct 99/108
class 2: acc 0.9629629629629629, correct 104/108
class 3: acc 0.9649122807017544, correct 110/114
class 4: acc 1.0, correct 102/102

Val Set, val_loss: 1.1260, val_error: 0.4600, auc: 0.9112
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.4425: correct 177/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.25, correct 5/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0190, instance_loss: 0.4897, weighted_loss: 0.1602, label: 2, bag_size: 679
batch 39, loss: 0.0065, instance_loss: 0.1721, weighted_loss: 0.0562, label: 0, bag_size: 350
batch 59, loss: 0.0000, instance_loss: 0.0333, weighted_loss: 0.0100, label: 4, bag_size: 178
batch 79, loss: 0.0088, instance_loss: 0.2846, weighted_loss: 0.0915, label: 2, bag_size: 1416
batch 99, loss: 0.0003, instance_loss: 0.0205, weighted_loss: 0.0064, label: 4, bag_size: 150
batch 119, loss: 0.0001, instance_loss: 0.0289, weighted_loss: 0.0087, label: 4, bag_size: 211
batch 139, loss: 0.1102, instance_loss: 0.2622, weighted_loss: 0.1558, label: 0, bag_size: 478
batch 159, loss: 0.0528, instance_loss: 0.5572, weighted_loss: 0.2041, label: 4, bag_size: 366
batch 179, loss: 0.6536, instance_loss: 0.7634, weighted_loss: 0.6865, label: 3, bag_size: 607
batch 199, loss: 0.0002, instance_loss: 0.0795, weighted_loss: 0.0240, label: 4, bag_size: 48
batch 219, loss: 0.0082, instance_loss: 0.2804, weighted_loss: 0.0899, label: 4, bag_size: 1176
batch 239, loss: 0.0000, instance_loss: 0.0135, weighted_loss: 0.0041, label: 4, bag_size: 178
batch 259, loss: 0.0170, instance_loss: 0.0333, weighted_loss: 0.0219, label: 3, bag_size: 1559
batch 279, loss: 0.0005, instance_loss: 0.0360, weighted_loss: 0.0111, label: 3, bag_size: 53
batch 299, loss: 0.0085, instance_loss: 0.1526, weighted_loss: 0.0517, label: 4, bag_size: 86
batch 319, loss: 0.1680, instance_loss: 0.3503, weighted_loss: 0.2227, label: 2, bag_size: 1232
batch 339, loss: 0.0664, instance_loss: 0.3349, weighted_loss: 0.1470, label: 3, bag_size: 1019
batch 359, loss: 0.1703, instance_loss: 0.3443, weighted_loss: 0.2225, label: 1, bag_size: 925
batch 379, loss: 0.0688, instance_loss: 0.1940, weighted_loss: 0.1064, label: 1, bag_size: 598
batch 399, loss: 0.0010, instance_loss: 0.1293, weighted_loss: 0.0395, label: 3, bag_size: 97
batch 419, loss: 0.0337, instance_loss: 0.2136, weighted_loss: 0.0877, label: 1, bag_size: 925
batch 439, loss: 0.0247, instance_loss: 0.1588, weighted_loss: 0.0649, label: 1, bag_size: 474
batch 459, loss: 0.0045, instance_loss: 0.0284, weighted_loss: 0.0117, label: 3, bag_size: 305
batch 479, loss: 0.0001, instance_loss: 0.0314, weighted_loss: 0.0095, label: 3, bag_size: 48
batch 499, loss: 0.0021, instance_loss: 0.1866, weighted_loss: 0.0575, label: 0, bag_size: 109
batch 519, loss: 0.0626, instance_loss: 0.1892, weighted_loss: 0.1006, label: 2, bag_size: 1289
batch 539, loss: 0.4076, instance_loss: 0.4716, weighted_loss: 0.4268, label: 0, bag_size: 868


class 0 clustering acc 0.9867431192660551: correct 21511/21800
class 1 clustering acc 0.5928899082568807: correct 2585/4360
Epoch: 41, train_loss: 0.1411, train_clustering_loss:  0.2385, train_error: 0.0367
class 0: acc 1.0, correct 120/120
class 1: acc 0.8846153846153846, correct 92/104
class 2: acc 0.9345794392523364, correct 100/107
class 3: acc 0.9905660377358491, correct 105/106
class 4: acc 1.0, correct 108/108

Val Set, val_loss: 1.1017, val_error: 0.3600, auc: 0.9146
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.435: correct 174/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.4, correct 8/20
class 3: acc 0.875, correct 7/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0056, instance_loss: 0.1167, weighted_loss: 0.0389, label: 3, bag_size: 18
batch 39, loss: 0.6956, instance_loss: 0.4254, weighted_loss: 0.6145, label: 2, bag_size: 869
batch 59, loss: 0.1592, instance_loss: 0.5132, weighted_loss: 0.2654, label: 3, bag_size: 283
batch 79, loss: 0.1635, instance_loss: 0.2550, weighted_loss: 0.1909, label: 2, bag_size: 795
batch 99, loss: 0.0893, instance_loss: 0.1902, weighted_loss: 0.1195, label: 1, bag_size: 682
batch 119, loss: 0.0022, instance_loss: 0.0570, weighted_loss: 0.0186, label: 0, bag_size: 1018
batch 139, loss: 0.0075, instance_loss: 0.8550, weighted_loss: 0.2618, label: 4, bag_size: 663
batch 159, loss: 0.0077, instance_loss: 0.2232, weighted_loss: 0.0723, label: 4, bag_size: 1121
batch 179, loss: 0.0063, instance_loss: 0.1686, weighted_loss: 0.0550, label: 2, bag_size: 809
batch 199, loss: 0.0366, instance_loss: 0.0810, weighted_loss: 0.0499, label: 1, bag_size: 288
batch 219, loss: 0.0452, instance_loss: 0.3831, weighted_loss: 0.1466, label: 2, bag_size: 1167
batch 239, loss: 0.0139, instance_loss: 0.3342, weighted_loss: 0.1100, label: 2, bag_size: 1128
batch 259, loss: 0.0321, instance_loss: 0.4927, weighted_loss: 0.1703, label: 3, bag_size: 1250
batch 279, loss: 0.0170, instance_loss: 0.1729, weighted_loss: 0.0638, label: 2, bag_size: 809
batch 299, loss: 0.4050, instance_loss: 0.1740, weighted_loss: 0.3357, label: 2, bag_size: 828
batch 319, loss: 0.0018, instance_loss: 0.0272, weighted_loss: 0.0094, label: 3, bag_size: 54
batch 339, loss: 0.0363, instance_loss: 0.3035, weighted_loss: 0.1165, label: 1, bag_size: 690
batch 359, loss: 0.1236, instance_loss: 0.5143, weighted_loss: 0.2408, label: 1, bag_size: 1096
batch 379, loss: 1.1048, instance_loss: 0.5899, weighted_loss: 0.9503, label: 2, bag_size: 1069
batch 399, loss: 0.0351, instance_loss: 0.3106, weighted_loss: 0.1177, label: 1, bag_size: 746
batch 419, loss: 0.0195, instance_loss: 0.0683, weighted_loss: 0.0341, label: 1, bag_size: 828
batch 439, loss: 0.5997, instance_loss: 0.4459, weighted_loss: 0.5536, label: 1, bag_size: 1197
batch 459, loss: 0.0078, instance_loss: 0.2564, weighted_loss: 0.0824, label: 0, bag_size: 155
batch 479, loss: 0.0003, instance_loss: 0.0276, weighted_loss: 0.0085, label: 3, bag_size: 143
batch 499, loss: 0.1129, instance_loss: 0.2532, weighted_loss: 0.1550, label: 0, bag_size: 1332
batch 519, loss: 0.0005, instance_loss: 0.0583, weighted_loss: 0.0178, label: 4, bag_size: 157
batch 539, loss: 0.0505, instance_loss: 0.1546, weighted_loss: 0.0817, label: 2, bag_size: 1123


class 0 clustering acc 0.9842660550458716: correct 21457/21800
class 1 clustering acc 0.6105504587155963: correct 2662/4360
Epoch: 42, train_loss: 0.1259, train_clustering_loss:  0.2327, train_error: 0.0422
class 0: acc 0.9603960396039604, correct 97/101
class 1: acc 0.9357798165137615, correct 102/109
class 2: acc 0.9262295081967213, correct 113/122
class 3: acc 0.981651376146789, correct 107/109
class 4: acc 0.9903846153846154, correct 103/104

Val Set, val_loss: 0.9815, val_error: 0.3200, auc: 0.9147
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.4575: correct 183/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.875, correct 7/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0138, instance_loss: 0.1957, weighted_loss: 0.0684, label: 0, bag_size: 807
batch 39, loss: 0.0196, instance_loss: 0.1232, weighted_loss: 0.0507, label: 0, bag_size: 200
batch 59, loss: 0.0088, instance_loss: 0.3647, weighted_loss: 0.1156, label: 2, bag_size: 1128
batch 79, loss: 1.0875, instance_loss: 0.5624, weighted_loss: 0.9299, label: 1, bag_size: 446
batch 99, loss: 0.3305, instance_loss: 0.4227, weighted_loss: 0.3581, label: 1, bag_size: 535
batch 119, loss: 0.2921, instance_loss: 0.8401, weighted_loss: 0.4565, label: 3, bag_size: 281
batch 139, loss: 0.0188, instance_loss: 0.0351, weighted_loss: 0.0237, label: 4, bag_size: 150
batch 159, loss: 0.3980, instance_loss: 0.8138, weighted_loss: 0.5228, label: 2, bag_size: 959
batch 179, loss: 0.1283, instance_loss: 0.3845, weighted_loss: 0.2051, label: 1, bag_size: 139
batch 199, loss: 0.0430, instance_loss: 0.4656, weighted_loss: 0.1697, label: 3, bag_size: 671
batch 219, loss: 0.9386, instance_loss: 0.3741, weighted_loss: 0.7693, label: 2, bag_size: 1218
batch 239, loss: 0.0152, instance_loss: 0.2577, weighted_loss: 0.0880, label: 2, bag_size: 419
batch 259, loss: 0.0031, instance_loss: 0.2167, weighted_loss: 0.0672, label: 0, bag_size: 120
batch 279, loss: 0.0150, instance_loss: 0.1576, weighted_loss: 0.0578, label: 1, bag_size: 682
batch 299, loss: 0.2674, instance_loss: 0.1996, weighted_loss: 0.2470, label: 0, bag_size: 200
batch 319, loss: 0.0496, instance_loss: 0.3597, weighted_loss: 0.1426, label: 2, bag_size: 784
batch 339, loss: 0.0000, instance_loss: 0.0671, weighted_loss: 0.0202, label: 3, bag_size: 33
batch 359, loss: 0.0028, instance_loss: 0.1844, weighted_loss: 0.0573, label: 4, bag_size: 773
batch 379, loss: 0.0000, instance_loss: 0.1328, weighted_loss: 0.0398, label: 4, bag_size: 83
batch 399, loss: 0.0520, instance_loss: 0.3356, weighted_loss: 0.1371, label: 2, bag_size: 1155
batch 419, loss: 0.0058, instance_loss: 0.0458, weighted_loss: 0.0178, label: 1, bag_size: 1127
batch 439, loss: 0.2173, instance_loss: 0.7413, weighted_loss: 0.3745, label: 0, bag_size: 282
batch 459, loss: 0.4137, instance_loss: 0.4265, weighted_loss: 0.4175, label: 1, bag_size: 711
batch 479, loss: 0.1363, instance_loss: 0.1429, weighted_loss: 0.1383, label: 2, bag_size: 1281
batch 499, loss: 0.0120, instance_loss: 0.1417, weighted_loss: 0.0509, label: 1, bag_size: 965
batch 519, loss: 0.0161, instance_loss: 0.0849, weighted_loss: 0.0367, label: 3, bag_size: 53
batch 539, loss: 0.0016, instance_loss: 0.3078, weighted_loss: 0.0934, label: 0, bag_size: 122


class 0 clustering acc 0.9848165137614678: correct 21469/21800
class 1 clustering acc 0.5614678899082569: correct 2448/4360
Epoch: 43, train_loss: 0.1417, train_clustering_loss:  0.2522, train_error: 0.0459
class 0: acc 0.9714285714285714, correct 102/105
class 1: acc 0.926829268292683, correct 114/123
class 2: acc 0.8876404494382022, correct 79/89
class 3: acc 0.9830508474576272, correct 116/118
class 4: acc 0.990909090909091, correct 109/110

Val Set, val_loss: 1.6306, val_error: 0.4800, auc: 0.9091
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.3875: correct 155/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 1.0, correct 7/7
class 2: acc 0.2, correct 4/20
class 3: acc 0.375, correct 3/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0864, weighted_loss: 0.0260, label: 3, bag_size: 18
batch 39, loss: 0.0086, instance_loss: 0.1589, weighted_loss: 0.0537, label: 3, bag_size: 28
batch 59, loss: 0.0067, instance_loss: 0.1412, weighted_loss: 0.0471, label: 0, bag_size: 128
batch 79, loss: 0.0001, instance_loss: 0.0144, weighted_loss: 0.0044, label: 4, bag_size: 143
batch 99, loss: 2.8538, instance_loss: 0.3297, weighted_loss: 2.0966, label: 1, bag_size: 965
batch 119, loss: 0.0000, instance_loss: 0.0191, weighted_loss: 0.0057, label: 4, bag_size: 178
batch 139, loss: 0.0023, instance_loss: 0.0939, weighted_loss: 0.0298, label: 0, bag_size: 255
batch 159, loss: 0.0006, instance_loss: 0.0269, weighted_loss: 0.0085, label: 0, bag_size: 1599
batch 179, loss: 0.0015, instance_loss: 0.2644, weighted_loss: 0.0804, label: 1, bag_size: 474
batch 199, loss: 0.1260, instance_loss: 0.3400, weighted_loss: 0.1902, label: 4, bag_size: 533
batch 219, loss: 0.0014, instance_loss: 0.0260, weighted_loss: 0.0088, label: 0, bag_size: 446
batch 239, loss: 0.0643, instance_loss: 0.5566, weighted_loss: 0.2120, label: 3, bag_size: 230
batch 259, loss: 0.0013, instance_loss: 0.0230, weighted_loss: 0.0078, label: 3, bag_size: 78
batch 279, loss: 0.0008, instance_loss: 0.0275, weighted_loss: 0.0088, label: 0, bag_size: 616
batch 299, loss: 0.0156, instance_loss: 0.0829, weighted_loss: 0.0358, label: 0, bag_size: 1012
batch 319, loss: 0.4117, instance_loss: 0.6765, weighted_loss: 0.4912, label: 2, bag_size: 732
batch 339, loss: 0.0026, instance_loss: 0.1520, weighted_loss: 0.0475, label: 0, bag_size: 607
batch 359, loss: 0.0001, instance_loss: 0.0601, weighted_loss: 0.0181, label: 3, bag_size: 37
batch 379, loss: 0.0507, instance_loss: 0.0988, weighted_loss: 0.0651, label: 1, bag_size: 944
batch 399, loss: 0.0027, instance_loss: 0.0362, weighted_loss: 0.0128, label: 0, bag_size: 446
batch 419, loss: 0.0000, instance_loss: 0.0250, weighted_loss: 0.0075, label: 4, bag_size: 185
batch 439, loss: 0.0022, instance_loss: 0.0628, weighted_loss: 0.0204, label: 3, bag_size: 53
batch 459, loss: 0.0033, instance_loss: 0.4068, weighted_loss: 0.1244, label: 2, bag_size: 252
batch 479, loss: 0.0085, instance_loss: 0.1955, weighted_loss: 0.0646, label: 1, bag_size: 690
batch 499, loss: 0.4419, instance_loss: 0.5613, weighted_loss: 0.4777, label: 3, bag_size: 281
batch 519, loss: 0.0191, instance_loss: 0.3195, weighted_loss: 0.1093, label: 3, bag_size: 697
batch 539, loss: 0.1964, instance_loss: 0.3844, weighted_loss: 0.2528, label: 0, bag_size: 1034


class 0 clustering acc 0.9888532110091743: correct 21557/21800
class 1 clustering acc 0.583256880733945: correct 2543/4360
Epoch: 44, train_loss: 0.1518, train_clustering_loss:  0.2349, train_error: 0.0477
class 0: acc 0.976, correct 122/125
class 1: acc 0.9134615384615384, correct 95/104
class 2: acc 0.9042553191489362, correct 85/94
class 3: acc 0.9743589743589743, correct 114/117
class 4: acc 0.9809523809523809, correct 103/105

Val Set, val_loss: 1.0673, val_error: 0.3200, auc: 0.9126
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.4: correct 160/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.55, correct 11/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0032, instance_loss: 0.2338, weighted_loss: 0.0724, label: 1, bag_size: 868
batch 39, loss: 0.0762, instance_loss: 0.1905, weighted_loss: 0.1105, label: 2, bag_size: 913
batch 59, loss: 0.0052, instance_loss: 0.0372, weighted_loss: 0.0148, label: 1, bag_size: 369
batch 79, loss: 0.0166, instance_loss: 0.2461, weighted_loss: 0.0855, label: 0, bag_size: 155
batch 99, loss: 0.0175, instance_loss: 0.0454, weighted_loss: 0.0259, label: 3, bag_size: 556
batch 119, loss: 0.0017, instance_loss: 0.0269, weighted_loss: 0.0093, label: 3, bag_size: 63
batch 139, loss: 0.0340, instance_loss: 0.5147, weighted_loss: 0.1782, label: 4, bag_size: 1002
batch 159, loss: 0.2175, instance_loss: 0.5090, weighted_loss: 0.3049, label: 0, bag_size: 801
batch 179, loss: 0.0636, instance_loss: 0.5695, weighted_loss: 0.2154, label: 0, bag_size: 282
batch 199, loss: 0.0170, instance_loss: 0.1587, weighted_loss: 0.0595, label: 2, bag_size: 323
batch 219, loss: 0.4498, instance_loss: 0.6302, weighted_loss: 0.5039, label: 1, bag_size: 936
batch 239, loss: 0.4547, instance_loss: 0.3763, weighted_loss: 0.4312, label: 1, bag_size: 102
batch 259, loss: 0.0000, instance_loss: 0.0558, weighted_loss: 0.0167, label: 3, bag_size: 18
batch 279, loss: 0.0010, instance_loss: 0.1708, weighted_loss: 0.0519, label: 0, bag_size: 148
batch 299, loss: 0.0004, instance_loss: 0.0229, weighted_loss: 0.0072, label: 3, bag_size: 87
batch 319, loss: 0.0000, instance_loss: 0.1870, weighted_loss: 0.0561, label: 3, bag_size: 18
batch 339, loss: 0.0068, instance_loss: 0.2905, weighted_loss: 0.0919, label: 4, bag_size: 1235
batch 359, loss: 0.0533, instance_loss: 0.2038, weighted_loss: 0.0985, label: 2, bag_size: 1235
batch 379, loss: 0.0594, instance_loss: 0.2777, weighted_loss: 0.1249, label: 4, bag_size: 826
batch 399, loss: 0.0007, instance_loss: 0.0562, weighted_loss: 0.0174, label: 0, bag_size: 1135
batch 419, loss: 0.0001, instance_loss: 0.1131, weighted_loss: 0.0340, label: 4, bag_size: 39
batch 439, loss: 0.0663, instance_loss: 0.2504, weighted_loss: 0.1216, label: 1, bag_size: 598
batch 459, loss: 0.0079, instance_loss: 0.0757, weighted_loss: 0.0283, label: 1, bag_size: 1127
batch 479, loss: 0.0028, instance_loss: 0.1514, weighted_loss: 0.0474, label: 3, bag_size: 105
batch 499, loss: 0.3007, instance_loss: 0.3198, weighted_loss: 0.3064, label: 2, bag_size: 499
batch 519, loss: 4.4114, instance_loss: 0.6793, weighted_loss: 3.2918, label: 1, bag_size: 530
batch 539, loss: 0.0032, instance_loss: 0.1782, weighted_loss: 0.0557, label: 3, bag_size: 16


class 0 clustering acc 0.9853669724770642: correct 21481/21800
class 1 clustering acc 0.6048165137614679: correct 2637/4360
Epoch: 45, train_loss: 0.1050, train_clustering_loss:  0.2368, train_error: 0.0220
class 0: acc 0.9907407407407407, correct 107/108
class 1: acc 0.9361702127659575, correct 88/94
class 2: acc 0.963302752293578, correct 105/109
class 3: acc 0.990990990990991, correct 110/111
class 4: acc 1.0, correct 123/123

Val Set, val_loss: 0.9778, val_error: 0.3400, auc: 0.9321
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.4575: correct 183/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0921, instance_loss: 0.2526, weighted_loss: 0.1402, label: 0, bag_size: 371
batch 39, loss: 0.0495, instance_loss: 0.2970, weighted_loss: 0.1238, label: 4, bag_size: 524
batch 59, loss: 0.2993, instance_loss: 0.4194, weighted_loss: 0.3353, label: 2, bag_size: 1232
batch 79, loss: 0.0001, instance_loss: 0.0857, weighted_loss: 0.0258, label: 3, bag_size: 21
batch 99, loss: 0.0145, instance_loss: 0.2102, weighted_loss: 0.0732, label: 4, bag_size: 28
batch 119, loss: 0.0075, instance_loss: 0.2902, weighted_loss: 0.0923, label: 1, bag_size: 487
batch 139, loss: 0.0023, instance_loss: 0.2063, weighted_loss: 0.0635, label: 0, bag_size: 1133
batch 159, loss: 0.0070, instance_loss: 0.1083, weighted_loss: 0.0374, label: 1, bag_size: 614
batch 179, loss: 0.0034, instance_loss: 0.2950, weighted_loss: 0.0909, label: 1, bag_size: 530
batch 199, loss: 0.0002, instance_loss: 0.2364, weighted_loss: 0.0711, label: 3, bag_size: 18
batch 219, loss: 0.0005, instance_loss: 0.0836, weighted_loss: 0.0254, label: 4, bag_size: 125
batch 239, loss: 0.0048, instance_loss: 0.2479, weighted_loss: 0.0777, label: 2, bag_size: 1058
batch 259, loss: 0.2803, instance_loss: 0.4868, weighted_loss: 0.3422, label: 1, bag_size: 446
batch 279, loss: 0.0029, instance_loss: 0.1070, weighted_loss: 0.0341, label: 1, bag_size: 949
batch 299, loss: 0.0033, instance_loss: 0.2797, weighted_loss: 0.0862, label: 0, bag_size: 114
batch 319, loss: 0.0061, instance_loss: 0.0753, weighted_loss: 0.0269, label: 0, bag_size: 246
batch 339, loss: 0.0077, instance_loss: 0.2490, weighted_loss: 0.0801, label: 1, bag_size: 690
batch 359, loss: 0.0000, instance_loss: 0.0496, weighted_loss: 0.0149, label: 4, bag_size: 110
batch 379, loss: 0.0002, instance_loss: 0.0102, weighted_loss: 0.0032, label: 4, bag_size: 148
batch 399, loss: 0.0144, instance_loss: 0.1981, weighted_loss: 0.0695, label: 2, bag_size: 758
batch 419, loss: 0.0685, instance_loss: 0.4501, weighted_loss: 0.1830, label: 3, bag_size: 1253
batch 439, loss: 0.0048, instance_loss: 0.3297, weighted_loss: 0.1022, label: 0, bag_size: 155
batch 459, loss: 0.2928, instance_loss: 0.4515, weighted_loss: 0.3404, label: 2, bag_size: 1306
batch 479, loss: 0.1581, instance_loss: 0.3633, weighted_loss: 0.2197, label: 0, bag_size: 868
batch 499, loss: 0.0018, instance_loss: 0.0339, weighted_loss: 0.0114, label: 4, bag_size: 157
batch 519, loss: 0.0020, instance_loss: 0.0930, weighted_loss: 0.0293, label: 1, bag_size: 1325
batch 539, loss: 0.0001, instance_loss: 0.0879, weighted_loss: 0.0264, label: 3, bag_size: 33


class 0 clustering acc 0.9858715596330275: correct 21492/21800
class 1 clustering acc 0.5761467889908257: correct 2512/4360
Epoch: 46, train_loss: 0.1145, train_clustering_loss:  0.2483, train_error: 0.0422
class 0: acc 0.9830508474576272, correct 116/118
class 1: acc 0.9166666666666666, correct 110/120
class 2: acc 0.9099099099099099, correct 101/111
class 3: acc 0.9901960784313726, correct 101/102
class 4: acc 1.0, correct 94/94

Val Set, val_loss: 0.9886, val_error: 0.3000, auc: 0.9188
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.4475: correct 179/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0034, instance_loss: 0.0964, weighted_loss: 0.0313, label: 0, bag_size: 1174
batch 39, loss: 0.0099, instance_loss: 0.1329, weighted_loss: 0.0468, label: 2, bag_size: 567
batch 59, loss: 0.0278, instance_loss: 0.2045, weighted_loss: 0.0808, label: 0, bag_size: 800
batch 79, loss: 0.0017, instance_loss: 0.0796, weighted_loss: 0.0251, label: 0, bag_size: 807
batch 99, loss: 0.0142, instance_loss: 0.4528, weighted_loss: 0.1458, label: 3, bag_size: 936
batch 119, loss: 0.0510, instance_loss: 0.3182, weighted_loss: 0.1311, label: 2, bag_size: 1215
batch 139, loss: 0.0001, instance_loss: 0.0257, weighted_loss: 0.0078, label: 0, bag_size: 982
batch 159, loss: 0.0095, instance_loss: 0.0894, weighted_loss: 0.0334, label: 1, bag_size: 746
batch 179, loss: 0.0208, instance_loss: 0.3009, weighted_loss: 0.1049, label: 1, bag_size: 898
batch 199, loss: 0.3785, instance_loss: 0.5922, weighted_loss: 0.4426, label: 3, bag_size: 1380
batch 219, loss: 0.0067, instance_loss: 0.0722, weighted_loss: 0.0264, label: 0, bag_size: 1517
batch 239, loss: 0.0752, instance_loss: 0.5276, weighted_loss: 0.2109, label: 4, bag_size: 1360
batch 259, loss: 0.0064, instance_loss: 0.3514, weighted_loss: 0.1099, label: 4, bag_size: 14
batch 279, loss: 0.0001, instance_loss: 0.0188, weighted_loss: 0.0057, label: 0, bag_size: 982
batch 299, loss: 0.0020, instance_loss: 0.0303, weighted_loss: 0.0105, label: 4, bag_size: 119
batch 319, loss: 0.1121, instance_loss: 0.4669, weighted_loss: 0.2185, label: 1, bag_size: 778
batch 339, loss: 0.0351, instance_loss: 0.3868, weighted_loss: 0.1406, label: 1, bag_size: 1096
batch 359, loss: 0.0155, instance_loss: 0.5930, weighted_loss: 0.1888, label: 1, bag_size: 1390
batch 379, loss: 0.2273, instance_loss: 0.5881, weighted_loss: 0.3355, label: 1, bag_size: 386
batch 399, loss: 0.3201, instance_loss: 0.5222, weighted_loss: 0.3807, label: 3, bag_size: 849
batch 419, loss: 0.0001, instance_loss: 0.0563, weighted_loss: 0.0169, label: 3, bag_size: 46
batch 439, loss: 0.3699, instance_loss: 0.7256, weighted_loss: 0.4766, label: 1, bag_size: 1390
batch 459, loss: 0.0278, instance_loss: 0.1766, weighted_loss: 0.0725, label: 2, bag_size: 913
batch 479, loss: 0.0894, instance_loss: 0.1819, weighted_loss: 0.1171, label: 1, bag_size: 994
batch 499, loss: 0.0790, instance_loss: 0.5415, weighted_loss: 0.2178, label: 4, bag_size: 542
batch 519, loss: 0.3630, instance_loss: 0.7404, weighted_loss: 0.4762, label: 1, bag_size: 657
batch 539, loss: 0.0159, instance_loss: 0.3103, weighted_loss: 0.1042, label: 2, bag_size: 883


class 0 clustering acc 0.9865137614678899: correct 21506/21800
class 1 clustering acc 0.603440366972477: correct 2631/4360
Epoch: 47, train_loss: 0.0778, train_clustering_loss:  0.2372, train_error: 0.0183
class 0: acc 1.0, correct 109/109
class 1: acc 0.963302752293578, correct 105/109
class 2: acc 0.9727272727272728, correct 107/110
class 3: acc 1.0, correct 101/101
class 4: acc 0.9741379310344828, correct 113/116

Val Set, val_loss: 0.8541, val_error: 0.3200, auc: 0.9286
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.435: correct 174/400
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.5, correct 10/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0426, instance_loss: 0.2064, weighted_loss: 0.0918, label: 0, bag_size: 1527
batch 39, loss: 0.0023, instance_loss: 0.5158, weighted_loss: 0.1563, label: 4, bag_size: 1357
batch 59, loss: 0.0000, instance_loss: 0.0828, weighted_loss: 0.0249, label: 4, bag_size: 134
batch 79, loss: 0.0057, instance_loss: 0.2577, weighted_loss: 0.0813, label: 0, bag_size: 118
batch 99, loss: 0.1159, instance_loss: 0.3076, weighted_loss: 0.1734, label: 2, bag_size: 245
batch 119, loss: 0.0210, instance_loss: 0.2910, weighted_loss: 0.1020, label: 0, bag_size: 1086
batch 139, loss: 0.0039, instance_loss: 0.0926, weighted_loss: 0.0306, label: 2, bag_size: 399
batch 159, loss: 0.0001, instance_loss: 0.1709, weighted_loss: 0.0513, label: 4, bag_size: 35
batch 179, loss: 1.0515, instance_loss: 0.5357, weighted_loss: 0.8968, label: 1, bag_size: 293
batch 199, loss: 0.0052, instance_loss: 0.0605, weighted_loss: 0.0218, label: 0, bag_size: 446
batch 219, loss: 0.0160, instance_loss: 0.1878, weighted_loss: 0.0675, label: 2, bag_size: 848
batch 239, loss: 0.0004, instance_loss: 0.1576, weighted_loss: 0.0475, label: 4, bag_size: 20
batch 259, loss: 0.0018, instance_loss: 0.1231, weighted_loss: 0.0382, label: 0, bag_size: 128
batch 279, loss: 0.8232, instance_loss: 0.3234, weighted_loss: 0.6732, label: 2, bag_size: 1348
batch 299, loss: 0.0552, instance_loss: 0.3908, weighted_loss: 0.1558, label: 1, bag_size: 898
batch 319, loss: 0.0006, instance_loss: 0.1536, weighted_loss: 0.0465, label: 4, bag_size: 1235
batch 339, loss: 0.0055, instance_loss: 0.0647, weighted_loss: 0.0233, label: 0, bag_size: 1046
batch 359, loss: 0.0421, instance_loss: 0.1744, weighted_loss: 0.0818, label: 2, bag_size: 907
batch 379, loss: 0.0125, instance_loss: 0.4344, weighted_loss: 0.1390, label: 1, bag_size: 487
batch 399, loss: 0.0025, instance_loss: 0.3210, weighted_loss: 0.0981, label: 4, bag_size: 1121
batch 419, loss: 0.3263, instance_loss: 0.6504, weighted_loss: 0.4235, label: 2, bag_size: 471
batch 439, loss: 0.1356, instance_loss: 0.4101, weighted_loss: 0.2179, label: 2, bag_size: 537
batch 459, loss: 0.0086, instance_loss: 0.3220, weighted_loss: 0.1026, label: 4, bag_size: 511
batch 479, loss: 0.0242, instance_loss: 0.1335, weighted_loss: 0.0570, label: 3, bag_size: 451
batch 499, loss: 0.0166, instance_loss: 0.1812, weighted_loss: 0.0660, label: 2, bag_size: 347
batch 519, loss: 0.0151, instance_loss: 0.3518, weighted_loss: 0.1161, label: 2, bag_size: 655
batch 539, loss: 0.0043, instance_loss: 0.2939, weighted_loss: 0.0912, label: 2, bag_size: 384


class 0 clustering acc 0.9861009174311927: correct 21497/21800
class 1 clustering acc 0.6022935779816514: correct 2626/4360
Epoch: 48, train_loss: 0.1091, train_clustering_loss:  0.2365, train_error: 0.0294
class 0: acc 0.9814814814814815, correct 106/108
class 1: acc 0.9245283018867925, correct 98/106
class 2: acc 0.9553571428571429, correct 107/112
class 3: acc 1.0, correct 112/112
class 4: acc 0.9906542056074766, correct 106/107

Val Set, val_loss: 0.8850, val_error: 0.3200, auc: 0.9322
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.4775: correct 191/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.55, correct 11/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 29 out of 20


batch 19, loss: 3.5717, instance_loss: 1.6863, weighted_loss: 3.0061, label: 2, bag_size: 1108
batch 39, loss: 0.0001, instance_loss: 0.0454, weighted_loss: 0.0137, label: 4, bag_size: 43
batch 59, loss: 0.0002, instance_loss: 0.0463, weighted_loss: 0.0140, label: 4, bag_size: 192
batch 79, loss: 0.5791, instance_loss: 0.2720, weighted_loss: 0.4869, label: 2, bag_size: 1348
batch 99, loss: 0.0003, instance_loss: 0.0282, weighted_loss: 0.0087, label: 4, bag_size: 182
batch 119, loss: 0.0006, instance_loss: 0.0225, weighted_loss: 0.0072, label: 4, bag_size: 147
batch 139, loss: 0.0062, instance_loss: 0.1538, weighted_loss: 0.0505, label: 0, bag_size: 607
batch 159, loss: 0.0003, instance_loss: 0.0332, weighted_loss: 0.0102, label: 3, bag_size: 37
batch 179, loss: 0.0001, instance_loss: 0.0677, weighted_loss: 0.0204, label: 4, bag_size: 83
batch 199, loss: 0.0002, instance_loss: 0.1228, weighted_loss: 0.0370, label: 3, bag_size: 15
batch 219, loss: 0.0002, instance_loss: 0.0346, weighted_loss: 0.0105, label: 4, bag_size: 40
batch 239, loss: 0.0213, instance_loss: 0.2479, weighted_loss: 0.0893, label: 0, bag_size: 1527
batch 259, loss: 0.1099, instance_loss: 0.9683, weighted_loss: 0.3674, label: 3, bag_size: 281
batch 279, loss: 0.7817, instance_loss: 0.6876, weighted_loss: 0.7535, label: 3, bag_size: 281
batch 299, loss: 0.0001, instance_loss: 0.0241, weighted_loss: 0.0073, label: 4, bag_size: 128
batch 319, loss: 0.1864, instance_loss: 0.3765, weighted_loss: 0.2434, label: 2, bag_size: 883
batch 339, loss: 0.0683, instance_loss: 0.1207, weighted_loss: 0.0840, label: 2, bag_size: 1039
batch 359, loss: 0.0008, instance_loss: 0.1617, weighted_loss: 0.0491, label: 1, bag_size: 1152
batch 379, loss: 0.0017, instance_loss: 0.0954, weighted_loss: 0.0298, label: 0, bag_size: 1255
batch 399, loss: 0.0309, instance_loss: 0.3338, weighted_loss: 0.1218, label: 1, bag_size: 1144
batch 419, loss: 0.0023, instance_loss: 0.0284, weighted_loss: 0.0101, label: 3, bag_size: 20
batch 439, loss: 0.0008, instance_loss: 0.0196, weighted_loss: 0.0064, label: 3, bag_size: 78
batch 459, loss: 0.0001, instance_loss: 0.0207, weighted_loss: 0.0063, label: 3, bag_size: 32
batch 479, loss: 0.0001, instance_loss: 0.0092, weighted_loss: 0.0028, label: 0, bag_size: 982
batch 499, loss: 0.0001, instance_loss: 0.1725, weighted_loss: 0.0518, label: 4, bag_size: 19
batch 519, loss: 0.0116, instance_loss: 0.1822, weighted_loss: 0.0628, label: 0, bag_size: 367
batch 539, loss: 0.0069, instance_loss: 0.1056, weighted_loss: 0.0365, label: 2, bag_size: 480


class 0 clustering acc 0.9846788990825688: correct 21466/21800
class 1 clustering acc 0.615137614678899: correct 2682/4360
Epoch: 49, train_loss: 0.1003, train_clustering_loss:  0.2318, train_error: 0.0257
class 0: acc 0.9908256880733946, correct 108/109
class 1: acc 0.94, correct 94/100
class 2: acc 0.968503937007874, correct 123/127
class 3: acc 0.9797979797979798, correct 97/99
class 4: acc 0.990909090909091, correct 109/110

Val Set, val_loss: 1.0558, val_error: 0.3600, auc: 0.9154
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.44: correct 176/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.55, correct 11/20
class 3: acc 0.5, correct 4/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0069, instance_loss: 0.4113, weighted_loss: 0.1282, label: 1, bag_size: 530
batch 39, loss: 0.9015, instance_loss: 0.5001, weighted_loss: 0.7811, label: 2, bag_size: 1231
batch 59, loss: 0.0335, instance_loss: 0.0743, weighted_loss: 0.0457, label: 3, bag_size: 405
batch 79, loss: 0.0009, instance_loss: 0.2203, weighted_loss: 0.0667, label: 0, bag_size: 128
batch 99, loss: 0.0001, instance_loss: 0.0421, weighted_loss: 0.0127, label: 3, bag_size: 20
batch 119, loss: 0.0243, instance_loss: 0.4028, weighted_loss: 0.1379, label: 1, bag_size: 343
batch 139, loss: 0.1218, instance_loss: 0.5725, weighted_loss: 0.2570, label: 0, bag_size: 801
batch 159, loss: 0.0353, instance_loss: 0.2266, weighted_loss: 0.0927, label: 2, bag_size: 1378
batch 179, loss: 0.0014, instance_loss: 0.0637, weighted_loss: 0.0201, label: 4, bag_size: 79
batch 199, loss: 0.0006, instance_loss: 0.1799, weighted_loss: 0.0544, label: 0, bag_size: 1101
batch 219, loss: 0.0000, instance_loss: 0.0239, weighted_loss: 0.0072, label: 4, bag_size: 160
batch 239, loss: 0.0009, instance_loss: 0.1070, weighted_loss: 0.0327, label: 3, bag_size: 34
batch 259, loss: 0.0025, instance_loss: 0.1259, weighted_loss: 0.0395, label: 0, bag_size: 807
batch 279, loss: 0.0545, instance_loss: 0.1927, weighted_loss: 0.0960, label: 1, bag_size: 320
batch 299, loss: 0.4754, instance_loss: 0.5952, weighted_loss: 0.5114, label: 1, bag_size: 308
batch 319, loss: 0.0008, instance_loss: 0.0436, weighted_loss: 0.0136, label: 0, bag_size: 731
batch 339, loss: 0.0036, instance_loss: 0.1253, weighted_loss: 0.0401, label: 0, bag_size: 466
batch 359, loss: 0.0001, instance_loss: 0.0129, weighted_loss: 0.0039, label: 4, bag_size: 112
batch 379, loss: 0.0123, instance_loss: 0.2421, weighted_loss: 0.0812, label: 2, bag_size: 1164
batch 399, loss: 0.0000, instance_loss: 0.0761, weighted_loss: 0.0229, label: 4, bag_size: 48
batch 419, loss: 0.0386, instance_loss: 0.3258, weighted_loss: 0.1248, label: 1, bag_size: 242
batch 439, loss: 0.0027, instance_loss: 0.1119, weighted_loss: 0.0355, label: 2, bag_size: 567
batch 459, loss: 0.0113, instance_loss: 0.2240, weighted_loss: 0.0752, label: 2, bag_size: 913
batch 479, loss: 0.0000, instance_loss: 0.0329, weighted_loss: 0.0099, label: 4, bag_size: 185
batch 499, loss: 0.0042, instance_loss: 0.1762, weighted_loss: 0.0558, label: 0, bag_size: 570
batch 519, loss: 0.0005, instance_loss: 0.0602, weighted_loss: 0.0184, label: 1, bag_size: 690
batch 539, loss: 0.0484, instance_loss: 0.3573, weighted_loss: 0.1411, label: 1, bag_size: 242


class 0 clustering acc 0.9858715596330275: correct 21492/21800
class 1 clustering acc 0.5873853211009175: correct 2561/4360
Epoch: 50, train_loss: 0.0927, train_clustering_loss:  0.2461, train_error: 0.0239
class 0: acc 0.9913793103448276, correct 115/116
class 1: acc 0.940677966101695, correct 111/118
class 2: acc 0.9509803921568627, correct 97/102
class 3: acc 1.0, correct 109/109
class 4: acc 1.0, correct 100/100

Val Set, val_loss: 1.0653, val_error: 0.3400, auc: 0.9211
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.55, correct 11/20
class 3: acc 0.625, correct 5/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0450, instance_loss: 0.1477, weighted_loss: 0.0758, label: 0, bag_size: 338
batch 39, loss: 0.0005, instance_loss: 0.1502, weighted_loss: 0.0454, label: 0, bag_size: 176
batch 59, loss: 0.0483, instance_loss: 0.5043, weighted_loss: 0.1851, label: 4, bag_size: 1002
batch 79, loss: 0.0002, instance_loss: 0.2387, weighted_loss: 0.0717, label: 3, bag_size: 16
batch 99, loss: 0.0202, instance_loss: 0.1922, weighted_loss: 0.0718, label: 0, bag_size: 476
batch 119, loss: 0.0018, instance_loss: 0.0985, weighted_loss: 0.0308, label: 0, bag_size: 1332
batch 139, loss: 0.0089, instance_loss: 0.1030, weighted_loss: 0.0371, label: 2, bag_size: 470
batch 159, loss: 0.0053, instance_loss: 0.1655, weighted_loss: 0.0534, label: 3, bag_size: 55
batch 179, loss: 0.0813, instance_loss: 0.1846, weighted_loss: 0.1123, label: 2, bag_size: 907
batch 199, loss: 0.0031, instance_loss: 0.2015, weighted_loss: 0.0626, label: 0, bag_size: 200
batch 219, loss: 0.0320, instance_loss: 0.4039, weighted_loss: 0.1435, label: 0, bag_size: 245
batch 239, loss: 0.0010, instance_loss: 0.0488, weighted_loss: 0.0153, label: 0, bag_size: 1012
batch 259, loss: 0.3804, instance_loss: 0.6575, weighted_loss: 0.4635, label: 2, bag_size: 869
batch 279, loss: 0.0112, instance_loss: 0.2858, weighted_loss: 0.0936, label: 2, bag_size: 732
batch 299, loss: 0.0065, instance_loss: 0.1414, weighted_loss: 0.0470, label: 2, bag_size: 270
batch 319, loss: 0.0019, instance_loss: 0.3508, weighted_loss: 0.1066, label: 2, bag_size: 358
batch 339, loss: 0.0939, instance_loss: 0.2934, weighted_loss: 0.1537, label: 2, bag_size: 1569
batch 359, loss: 0.0035, instance_loss: 0.3618, weighted_loss: 0.1110, label: 2, bag_size: 784
batch 379, loss: 0.0580, instance_loss: 0.1646, weighted_loss: 0.0900, label: 3, bag_size: 451
batch 399, loss: 0.1618, instance_loss: 0.6115, weighted_loss: 0.2967, label: 1, bag_size: 308
batch 419, loss: 0.0066, instance_loss: 0.0625, weighted_loss: 0.0234, label: 1, bag_size: 346
batch 439, loss: 0.0219, instance_loss: 0.1548, weighted_loss: 0.0618, label: 2, bag_size: 1289
batch 459, loss: 0.0007, instance_loss: 0.0804, weighted_loss: 0.0246, label: 0, bag_size: 1012
batch 479, loss: 0.0099, instance_loss: 0.0502, weighted_loss: 0.0220, label: 3, bag_size: 27
batch 499, loss: 0.0003, instance_loss: 0.0677, weighted_loss: 0.0205, label: 4, bag_size: 128
batch 519, loss: 0.0318, instance_loss: 0.1871, weighted_loss: 0.0784, label: 3, bag_size: 24
batch 539, loss: 0.0119, instance_loss: 0.1061, weighted_loss: 0.0402, label: 2, bag_size: 1448


class 0 clustering acc 0.986605504587156: correct 21508/21800
class 1 clustering acc 0.6025229357798165: correct 2627/4360
Epoch: 51, train_loss: 0.0695, train_clustering_loss:  0.2365, train_error: 0.0165
class 0: acc 0.9919354838709677, correct 123/124
class 1: acc 0.9595959595959596, correct 95/99
class 2: acc 0.9824561403508771, correct 112/114
class 3: acc 0.9900990099009901, correct 100/101
class 4: acc 0.9906542056074766, correct 106/107

Val Set, val_loss: 1.0994, val_error: 0.3600, auc: 0.9291
class 0 clustering acc 0.969: correct 1938/2000
class 1 clustering acc 0.435: correct 174/400
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.45, correct 9/20
class 3: acc 0.75, correct 6/8
class 4: acc 0.75, correct 6/8
EarlyStopping counter: 32 out of 20
Early stopping
Val error: 0.3800, ROC AUC: 0.9259
Test error: 0.2800, ROC AUC: 0.8921
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.8, correct 20/25
class 3: acc 0.5, correct 1/2
class 4: acc 0.4, correct 2/5

Training Fold 7!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.4369, instance_loss: 1.2119, weighted_loss: 1.3694, label: 0, bag_size: 1046
batch 39, loss: 1.7081, instance_loss: 1.0677, weighted_loss: 1.5160, label: 3, bag_size: 19
batch 59, loss: 1.5333, instance_loss: 0.8328, weighted_loss: 1.3231, label: 4, bag_size: 19
batch 79, loss: 1.1462, instance_loss: 0.5932, weighted_loss: 0.9803, label: 0, bag_size: 1301
batch 99, loss: 1.7482, instance_loss: 0.5778, weighted_loss: 1.3971, label: 1, bag_size: 754
batch 119, loss: 1.7098, instance_loss: 0.5995, weighted_loss: 1.3767, label: 3, bag_size: 19
batch 139, loss: 1.6048, instance_loss: 0.5280, weighted_loss: 1.2817, label: 0, bag_size: 413
batch 159, loss: 1.8791, instance_loss: 0.5712, weighted_loss: 1.4867, label: 3, bag_size: 20
batch 179, loss: 1.6218, instance_loss: 0.5375, weighted_loss: 1.2965, label: 0, bag_size: 128
batch 199, loss: 1.3474, instance_loss: 0.5090, weighted_loss: 1.0959, label: 0, bag_size: 653
batch 219, loss: 1.3152, instance_loss: 0.5005, weighted_loss: 1.0708, label: 0, bag_size: 446
batch 239, loss: 1.7925, instance_loss: 0.5575, weighted_loss: 1.4220, label: 2, bag_size: 1006
batch 259, loss: 1.3007, instance_loss: 0.4951, weighted_loss: 1.0590, label: 0, bag_size: 423
batch 279, loss: 1.4247, instance_loss: 0.5403, weighted_loss: 1.1594, label: 3, bag_size: 28
batch 299, loss: 1.6456, instance_loss: 0.5363, weighted_loss: 1.3128, label: 2, bag_size: 399
batch 319, loss: 1.2496, instance_loss: 0.4952, weighted_loss: 1.0233, label: 0, bag_size: 1301
batch 339, loss: 1.2886, instance_loss: 0.5220, weighted_loss: 1.0586, label: 1, bag_size: 319
batch 359, loss: 1.2478, instance_loss: 0.5064, weighted_loss: 1.0254, label: 1, bag_size: 898
batch 379, loss: 1.9229, instance_loss: 0.5506, weighted_loss: 1.5112, label: 3, bag_size: 305
batch 399, loss: 2.2925, instance_loss: 0.5306, weighted_loss: 1.7639, label: 4, bag_size: 974
batch 419, loss: 1.1618, instance_loss: 0.4838, weighted_loss: 0.9584, label: 0, bag_size: 466
batch 439, loss: 1.2743, instance_loss: 0.4703, weighted_loss: 1.0331, label: 1, bag_size: 945
batch 459, loss: 1.4468, instance_loss: 0.5088, weighted_loss: 1.1654, label: 2, bag_size: 846
batch 479, loss: 1.3590, instance_loss: 0.5339, weighted_loss: 1.1115, label: 3, bag_size: 18
batch 499, loss: 2.3343, instance_loss: 0.5342, weighted_loss: 1.7943, label: 4, bag_size: 882
batch 519, loss: 1.5472, instance_loss: 0.5470, weighted_loss: 1.2471, label: 3, bag_size: 28
batch 539, loss: 0.8804, instance_loss: 0.4584, weighted_loss: 0.7538, label: 1, bag_size: 682


class 0 clustering acc 0.9939449541284404: correct 21668/21800
class 1 clustering acc 0.004357798165137615: correct 19/4360
Epoch: 0, train_loss: 1.4427, train_clustering_loss:  0.5866, train_error: 0.6073
class 0: acc 0.5241935483870968, correct 65/124
class 1: acc 0.5, correct 60/120
class 2: acc 0.022727272727272728, correct 2/88
class 3: acc 0.18478260869565216, correct 17/92
class 4: acc 0.5785123966942148, correct 70/121

Val Set, val_loss: 1.3896, val_error: 0.6600, auc: 0.7442
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/5
class 1: acc 1.0, correct 14/14
class 2: acc 0.0, correct 0/20
class 3: acc 0.2, correct 1/5
class 4: acc 0.3333333333333333, correct 2/6
Validation loss decreased (inf --> 1.389568).  Saving model ...


batch 19, loss: 1.4783, instance_loss: 0.5836, weighted_loss: 1.2098, label: 2, bag_size: 1215
batch 39, loss: 1.7940, instance_loss: 0.5580, weighted_loss: 1.4232, label: 0, bag_size: 868
batch 59, loss: 1.5161, instance_loss: 0.5159, weighted_loss: 1.2160, label: 1, bag_size: 1144
batch 79, loss: 0.7065, instance_loss: 0.4468, weighted_loss: 0.6286, label: 3, bag_size: 18
batch 99, loss: 1.6965, instance_loss: 0.5434, weighted_loss: 1.3506, label: 1, bag_size: 700
batch 119, loss: 1.0794, instance_loss: 0.4825, weighted_loss: 0.9003, label: 0, bag_size: 976
batch 139, loss: 1.5785, instance_loss: 0.4985, weighted_loss: 1.2545, label: 2, bag_size: 1108
batch 159, loss: 1.2508, instance_loss: 0.4352, weighted_loss: 1.0061, label: 3, bag_size: 451
batch 179, loss: 0.8605, instance_loss: 0.4540, weighted_loss: 0.7385, label: 3, bag_size: 53
batch 199, loss: 0.5850, instance_loss: 0.3665, weighted_loss: 0.5195, label: 4, bag_size: 23
batch 219, loss: 1.3209, instance_loss: 0.4787, weighted_loss: 1.0683, label: 2, bag_size: 1231
batch 239, loss: 0.4072, instance_loss: 0.3148, weighted_loss: 0.3795, label: 4, bag_size: 19
batch 259, loss: 1.2929, instance_loss: 0.4297, weighted_loss: 1.0339, label: 3, bag_size: 936
batch 279, loss: 1.9111, instance_loss: 0.5851, weighted_loss: 1.5133, label: 1, bag_size: 1172
batch 299, loss: 1.2598, instance_loss: 0.4660, weighted_loss: 1.0217, label: 2, bag_size: 409
batch 319, loss: 1.2997, instance_loss: 0.4912, weighted_loss: 1.0572, label: 0, bag_size: 736
batch 339, loss: 1.4985, instance_loss: 0.5167, weighted_loss: 1.2039, label: 2, bag_size: 774
batch 359, loss: 1.2602, instance_loss: 0.4734, weighted_loss: 1.0242, label: 1, bag_size: 1014
batch 379, loss: 0.6386, instance_loss: 0.4041, weighted_loss: 0.5683, label: 3, bag_size: 35
batch 399, loss: 1.1796, instance_loss: 0.4363, weighted_loss: 0.9566, label: 3, bag_size: 1172
batch 419, loss: 0.5208, instance_loss: 0.3759, weighted_loss: 0.4773, label: 3, bag_size: 50
batch 439, loss: 1.3575, instance_loss: 0.4857, weighted_loss: 1.0959, label: 2, bag_size: 461
batch 459, loss: 2.0547, instance_loss: 0.4636, weighted_loss: 1.5774, label: 3, bag_size: 1118
batch 479, loss: 2.1193, instance_loss: 0.5797, weighted_loss: 1.6574, label: 3, bag_size: 283
batch 499, loss: 1.4271, instance_loss: 0.5097, weighted_loss: 1.1519, label: 2, bag_size: 1289
batch 519, loss: 1.2770, instance_loss: 0.4654, weighted_loss: 1.0335, label: 1, bag_size: 1197
batch 539, loss: 2.6038, instance_loss: 0.5556, weighted_loss: 1.9894, label: 3, bag_size: 630


class 0 clustering acc 0.9988532110091743: correct 21775/21800
class 1 clustering acc 0.009862385321100918: correct 43/4360
Epoch: 1, train_loss: 1.2595, train_clustering_loss:  0.4677, train_error: 0.4899
class 0: acc 0.37272727272727274, correct 41/110
class 1: acc 0.4069767441860465, correct 35/86
class 2: acc 0.36538461538461536, correct 38/104
class 3: acc 0.7131782945736435, correct 92/129
class 4: acc 0.6206896551724138, correct 72/116

Val Set, val_loss: 1.2676, val_error: 0.4800, auc: 0.7942
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.005: correct 2/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.45, correct 9/20
class 3: acc 0.6, correct 3/5
class 4: acc 0.3333333333333333, correct 2/6
Validation loss decreased (1.389568 --> 1.267559).  Saving model ...


batch 19, loss: 0.9881, instance_loss: 0.4695, weighted_loss: 0.8325, label: 0, bag_size: 1872
batch 39, loss: 2.1175, instance_loss: 0.6189, weighted_loss: 1.6679, label: 4, bag_size: 754
batch 59, loss: 2.3844, instance_loss: 0.5690, weighted_loss: 1.8398, label: 3, bag_size: 630
batch 79, loss: 0.3120, instance_loss: 0.3382, weighted_loss: 0.3199, label: 3, bag_size: 21
batch 99, loss: 1.2826, instance_loss: 0.4797, weighted_loss: 1.0417, label: 2, bag_size: 202
batch 119, loss: 2.5755, instance_loss: 0.6957, weighted_loss: 2.0115, label: 4, bag_size: 366
batch 139, loss: 0.8591, instance_loss: 0.4334, weighted_loss: 0.7314, label: 0, bag_size: 933
batch 159, loss: 1.4420, instance_loss: 0.4553, weighted_loss: 1.1460, label: 1, bag_size: 470
batch 179, loss: 1.0293, instance_loss: 0.4444, weighted_loss: 0.8538, label: 0, bag_size: 466
batch 199, loss: 0.8165, instance_loss: 0.4160, weighted_loss: 0.6964, label: 0, bag_size: 1143
batch 219, loss: 0.4789, instance_loss: 0.3959, weighted_loss: 0.4540, label: 3, bag_size: 56
batch 239, loss: 0.5770, instance_loss: 0.3220, weighted_loss: 0.5005, label: 4, bag_size: 23
batch 259, loss: 1.2168, instance_loss: 0.4848, weighted_loss: 0.9972, label: 2, bag_size: 222
batch 279, loss: 0.4647, instance_loss: 0.3382, weighted_loss: 0.4268, label: 1, bag_size: 1191
batch 299, loss: 0.5614, instance_loss: 0.3361, weighted_loss: 0.4938, label: 1, bag_size: 828
batch 319, loss: 1.3118, instance_loss: 0.4875, weighted_loss: 1.0645, label: 2, bag_size: 682
batch 339, loss: 0.9333, instance_loss: 0.3814, weighted_loss: 0.7677, label: 1, bag_size: 897
batch 359, loss: 0.9272, instance_loss: 0.3874, weighted_loss: 0.7652, label: 1, bag_size: 269
batch 379, loss: 0.7197, instance_loss: 0.4332, weighted_loss: 0.6338, label: 0, bag_size: 1235
batch 399, loss: 1.5775, instance_loss: 0.5447, weighted_loss: 1.2677, label: 0, bag_size: 912
batch 419, loss: 0.1658, instance_loss: 0.1428, weighted_loss: 0.1589, label: 4, bag_size: 112
batch 439, loss: 0.5520, instance_loss: 0.2907, weighted_loss: 0.4737, label: 1, bag_size: 533
batch 459, loss: 0.3663, instance_loss: 0.2394, weighted_loss: 0.3283, label: 1, bag_size: 944
batch 479, loss: 1.0522, instance_loss: 0.4810, weighted_loss: 0.8808, label: 2, bag_size: 682
batch 499, loss: 0.2326, instance_loss: 0.1376, weighted_loss: 0.2041, label: 4, bag_size: 148
batch 519, loss: 1.0588, instance_loss: 0.4886, weighted_loss: 0.8877, label: 0, bag_size: 653
batch 539, loss: 1.2587, instance_loss: 0.4711, weighted_loss: 1.0224, label: 2, bag_size: 421


class 0 clustering acc 0.9959633027522936: correct 21712/21800
class 1 clustering acc 0.10848623853211009: correct 473/4360
Epoch: 2, train_loss: 1.0287, train_clustering_loss:  0.4180, train_error: 0.3927
class 0: acc 0.6330275229357798, correct 69/109
class 1: acc 0.7322834645669292, correct 93/127
class 2: acc 0.21929824561403508, correct 25/114
class 3: acc 0.7303370786516854, correct 65/89
class 4: acc 0.7452830188679245, correct 79/106

Val Set, val_loss: 1.1544, val_error: 0.4400, auc: 0.8068
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0725: correct 29/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.55, correct 11/20
class 3: acc 0.6, correct 3/5
class 4: acc 0.3333333333333333, correct 2/6
Validation loss decreased (1.267559 --> 1.154410).  Saving model ...


batch 19, loss: 0.7710, instance_loss: 0.4540, weighted_loss: 0.6759, label: 0, bag_size: 1517
batch 39, loss: 1.7320, instance_loss: 0.5532, weighted_loss: 1.3784, label: 0, bag_size: 801
batch 59, loss: 1.1191, instance_loss: 0.4127, weighted_loss: 0.9072, label: 3, bag_size: 451
batch 79, loss: 1.8248, instance_loss: 0.4958, weighted_loss: 1.4261, label: 1, bag_size: 1172
batch 99, loss: 2.1097, instance_loss: 0.6562, weighted_loss: 1.6736, label: 4, bag_size: 354
batch 119, loss: 1.9757, instance_loss: 0.5926, weighted_loss: 1.5608, label: 4, bag_size: 663
batch 139, loss: 0.6609, instance_loss: 0.4119, weighted_loss: 0.5862, label: 0, bag_size: 1143
batch 159, loss: 1.0813, instance_loss: 0.3681, weighted_loss: 0.8673, label: 3, bag_size: 556
batch 179, loss: 2.7676, instance_loss: 0.7161, weighted_loss: 2.1522, label: 3, bag_size: 230
batch 199, loss: 0.1191, instance_loss: 0.2338, weighted_loss: 0.1535, label: 3, bag_size: 20
batch 219, loss: 1.4377, instance_loss: 0.5160, weighted_loss: 1.1612, label: 0, bag_size: 552
batch 239, loss: 1.2520, instance_loss: 0.5086, weighted_loss: 1.0290, label: 0, bag_size: 552
batch 259, loss: 1.8235, instance_loss: 0.5949, weighted_loss: 1.4550, label: 4, bag_size: 1278
batch 279, loss: 1.9184, instance_loss: 0.5559, weighted_loss: 1.5097, label: 4, bag_size: 974
batch 299, loss: 1.1554, instance_loss: 0.4536, weighted_loss: 0.9449, label: 2, bag_size: 262
batch 319, loss: 0.6048, instance_loss: 0.3811, weighted_loss: 0.5377, label: 1, bag_size: 1014
batch 339, loss: 0.4025, instance_loss: 0.2959, weighted_loss: 0.3705, label: 3, bag_size: 1019
batch 359, loss: 0.0690, instance_loss: 0.1071, weighted_loss: 0.0804, label: 3, bag_size: 48
batch 379, loss: 1.1698, instance_loss: 0.4689, weighted_loss: 0.9595, label: 2, bag_size: 1024
batch 399, loss: 0.9935, instance_loss: 0.4113, weighted_loss: 0.8188, label: 1, bag_size: 648
batch 419, loss: 0.7141, instance_loss: 0.3864, weighted_loss: 0.6158, label: 1, bag_size: 696
batch 439, loss: 0.7471, instance_loss: 0.3756, weighted_loss: 0.6357, label: 2, bag_size: 3236
batch 459, loss: 0.7842, instance_loss: 0.3837, weighted_loss: 0.6640, label: 2, bag_size: 766
batch 479, loss: 1.3035, instance_loss: 0.4200, weighted_loss: 1.0385, label: 1, bag_size: 1273
batch 499, loss: 0.4050, instance_loss: 0.2341, weighted_loss: 0.3537, label: 4, bag_size: 160
batch 519, loss: 0.8944, instance_loss: 0.4390, weighted_loss: 0.7578, label: 0, bag_size: 718
batch 539, loss: 2.6635, instance_loss: 0.7010, weighted_loss: 2.0748, label: 3, bag_size: 343


class 0 clustering acc 0.9934403669724771: correct 21657/21800
class 1 clustering acc 0.1470183486238532: correct 641/4360
Epoch: 3, train_loss: 1.0104, train_clustering_loss:  0.4189, train_error: 0.4018
class 0: acc 0.5818181818181818, correct 64/110
class 1: acc 0.5288461538461539, correct 55/104
class 2: acc 0.5447154471544715, correct 67/123
class 3: acc 0.7352941176470589, correct 75/102
class 4: acc 0.6132075471698113, correct 65/106

Val Set, val_loss: 1.1089, val_error: 0.4800, auc: 0.8180
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.075: correct 30/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5, correct 7/14
class 2: acc 0.45, correct 9/20
class 3: acc 0.6, correct 3/5
class 4: acc 0.5, correct 3/6
Validation loss decreased (1.154410 --> 1.108864).  Saving model ...


batch 19, loss: 0.4561, instance_loss: 0.2759, weighted_loss: 0.4021, label: 1, bag_size: 1127
batch 39, loss: 0.9035, instance_loss: 0.4142, weighted_loss: 0.7567, label: 2, bag_size: 265
batch 59, loss: 0.0443, instance_loss: 0.0870, weighted_loss: 0.0571, label: 3, bag_size: 115
batch 79, loss: 1.0272, instance_loss: 0.4085, weighted_loss: 0.8416, label: 1, bag_size: 968
batch 99, loss: 1.3061, instance_loss: 0.4934, weighted_loss: 1.0623, label: 2, bag_size: 682
batch 119, loss: 1.0674, instance_loss: 0.5126, weighted_loss: 0.9010, label: 2, bag_size: 395
batch 139, loss: 1.3244, instance_loss: 0.4885, weighted_loss: 1.0737, label: 0, bag_size: 1190
batch 159, loss: 1.0393, instance_loss: 0.4639, weighted_loss: 0.8667, label: 2, bag_size: 395
batch 179, loss: 1.6870, instance_loss: 0.4875, weighted_loss: 1.3271, label: 1, bag_size: 535
batch 199, loss: 0.1836, instance_loss: 0.1308, weighted_loss: 0.1678, label: 4, bag_size: 211
batch 219, loss: 0.1878, instance_loss: 0.2255, weighted_loss: 0.1991, label: 3, bag_size: 16
batch 239, loss: 0.5317, instance_loss: 0.3391, weighted_loss: 0.4739, label: 1, bag_size: 648
batch 259, loss: 0.7546, instance_loss: 0.4764, weighted_loss: 0.6712, label: 0, bag_size: 976
batch 279, loss: 1.8125, instance_loss: 0.5839, weighted_loss: 1.4439, label: 4, bag_size: 663
batch 299, loss: 0.3122, instance_loss: 0.4312, weighted_loss: 0.3479, label: 0, bag_size: 402
batch 319, loss: 0.1365, instance_loss: 0.1753, weighted_loss: 0.1482, label: 3, bag_size: 31
batch 339, loss: 0.7133, instance_loss: 0.4915, weighted_loss: 0.6467, label: 2, bag_size: 655
batch 359, loss: 1.9528, instance_loss: 0.9301, weighted_loss: 1.6460, label: 0, bag_size: 128
batch 379, loss: 0.5289, instance_loss: 0.2901, weighted_loss: 0.4573, label: 1, bag_size: 1402
batch 399, loss: 1.7379, instance_loss: 0.6122, weighted_loss: 1.4002, label: 4, bag_size: 817
batch 419, loss: 2.2076, instance_loss: 0.6380, weighted_loss: 1.7367, label: 0, bag_size: 1257
batch 439, loss: 0.5815, instance_loss: 0.2999, weighted_loss: 0.4970, label: 1, bag_size: 530
batch 459, loss: 0.3782, instance_loss: 0.3188, weighted_loss: 0.3604, label: 1, bag_size: 102
batch 479, loss: 1.8760, instance_loss: 0.5174, weighted_loss: 1.4684, label: 1, bag_size: 308
batch 499, loss: 0.0525, instance_loss: 0.1396, weighted_loss: 0.0787, label: 3, bag_size: 53
batch 519, loss: 0.8888, instance_loss: 0.4841, weighted_loss: 0.7674, label: 0, bag_size: 962
batch 539, loss: 1.6796, instance_loss: 0.5384, weighted_loss: 1.3372, label: 4, bag_size: 974


class 0 clustering acc 0.9943577981651376: correct 21677/21800
class 1 clustering acc 0.22660550458715598: correct 988/4360
Epoch: 4, train_loss: 0.8229, train_clustering_loss:  0.3749, train_error: 0.3028
class 0: acc 0.6568627450980392, correct 67/102
class 1: acc 0.7049180327868853, correct 86/122
class 2: acc 0.5462962962962963, correct 59/108
class 3: acc 0.7916666666666666, correct 76/96
class 4: acc 0.7863247863247863, correct 92/117

Val Set, val_loss: 0.9830, val_error: 0.3600, auc: 0.8429
class 0 clustering acc 0.998: correct 1996/2000
class 1 clustering acc 0.13: correct 52/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.6, correct 3/5
class 4: acc 0.5, correct 3/6
Validation loss decreased (1.108864 --> 0.982967).  Saving model ...


batch 19, loss: 0.7142, instance_loss: 0.4249, weighted_loss: 0.6274, label: 0, bag_size: 410
batch 39, loss: 0.7760, instance_loss: 0.4057, weighted_loss: 0.6649, label: 4, bag_size: 1121
batch 59, loss: 0.2922, instance_loss: 0.3630, weighted_loss: 0.3135, label: 0, bag_size: 446
batch 79, loss: 0.6639, instance_loss: 0.3941, weighted_loss: 0.5830, label: 2, bag_size: 469
batch 99, loss: 0.5814, instance_loss: 0.3251, weighted_loss: 0.5045, label: 1, bag_size: 913
batch 119, loss: 0.4460, instance_loss: 0.4914, weighted_loss: 0.4596, label: 0, bag_size: 129
batch 139, loss: 1.1079, instance_loss: 0.4561, weighted_loss: 0.9124, label: 2, bag_size: 1128
batch 159, loss: 1.9822, instance_loss: 0.6212, weighted_loss: 1.5739, label: 2, bag_size: 1043
batch 179, loss: 2.2267, instance_loss: 0.6610, weighted_loss: 1.7570, label: 4, bag_size: 1337
batch 199, loss: 0.8705, instance_loss: 0.4984, weighted_loss: 0.7589, label: 0, bag_size: 432
batch 219, loss: 0.3356, instance_loss: 0.1827, weighted_loss: 0.2897, label: 4, bag_size: 114
batch 239, loss: 0.2670, instance_loss: 0.2555, weighted_loss: 0.2635, label: 3, bag_size: 18
batch 259, loss: 0.6262, instance_loss: 0.4366, weighted_loss: 0.5693, label: 0, bag_size: 413
batch 279, loss: 0.5309, instance_loss: 0.3382, weighted_loss: 0.4731, label: 1, bag_size: 470
batch 299, loss: 0.0344, instance_loss: 0.1507, weighted_loss: 0.0693, label: 3, bag_size: 20
batch 319, loss: 0.1927, instance_loss: 0.3789, weighted_loss: 0.2485, label: 0, bag_size: 933
batch 339, loss: 0.8923, instance_loss: 0.4336, weighted_loss: 0.7547, label: 2, bag_size: 2703
batch 359, loss: 0.9830, instance_loss: 0.4400, weighted_loss: 0.8201, label: 2, bag_size: 684
batch 379, loss: 0.1132, instance_loss: 0.2097, weighted_loss: 0.1422, label: 3, bag_size: 35
batch 399, loss: 0.4177, instance_loss: 0.4082, weighted_loss: 0.4149, label: 0, bag_size: 255
batch 419, loss: 0.8334, instance_loss: 0.4063, weighted_loss: 0.7053, label: 2, bag_size: 1133
batch 439, loss: 2.0538, instance_loss: 0.5347, weighted_loss: 1.5981, label: 3, bag_size: 630
batch 459, loss: 2.5984, instance_loss: 0.6367, weighted_loss: 2.0099, label: 1, bag_size: 293
batch 479, loss: 1.8490, instance_loss: 0.5365, weighted_loss: 1.4553, label: 2, bag_size: 120
batch 499, loss: 1.6994, instance_loss: 0.5545, weighted_loss: 1.3559, label: 4, bag_size: 542
batch 519, loss: 1.1679, instance_loss: 0.7569, weighted_loss: 1.0446, label: 0, bag_size: 109
batch 539, loss: 1.0091, instance_loss: 0.4551, weighted_loss: 0.8429, label: 2, bag_size: 409


class 0 clustering acc 0.9930733944954129: correct 21649/21800
class 1 clustering acc 0.21100917431192662: correct 920/4360
Epoch: 5, train_loss: 0.7805, train_clustering_loss:  0.3794, train_error: 0.2917
class 0: acc 0.7117117117117117, correct 79/111
class 1: acc 0.5922330097087378, correct 61/103
class 2: acc 0.6759259259259259, correct 73/108
class 3: acc 0.8290598290598291, correct 97/117
class 4: acc 0.7169811320754716, correct 76/106

Val Set, val_loss: 1.0227, val_error: 0.4600, auc: 0.8542
class 0 clustering acc 0.998: correct 1996/2000
class 1 clustering acc 0.13: correct 52/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.3, correct 6/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3326, instance_loss: 0.2897, weighted_loss: 0.3197, label: 4, bag_size: 764
batch 39, loss: 0.6639, instance_loss: 0.4681, weighted_loss: 0.6052, label: 4, bag_size: 1002
batch 59, loss: 0.7860, instance_loss: 0.6940, weighted_loss: 0.7584, label: 0, bag_size: 176
batch 79, loss: 1.3903, instance_loss: 0.5312, weighted_loss: 1.1325, label: 4, bag_size: 297
batch 99, loss: 1.3593, instance_loss: 0.6093, weighted_loss: 1.1343, label: 2, bag_size: 636
batch 119, loss: 0.6424, instance_loss: 0.5887, weighted_loss: 0.6263, label: 0, bag_size: 163
batch 139, loss: 0.6475, instance_loss: 0.3255, weighted_loss: 0.5509, label: 1, bag_size: 968
batch 159, loss: 0.1264, instance_loss: 0.1295, weighted_loss: 0.1273, label: 1, bag_size: 369
batch 179, loss: 0.9071, instance_loss: 0.4279, weighted_loss: 0.7633, label: 2, bag_size: 474
batch 199, loss: 0.7069, instance_loss: 0.3358, weighted_loss: 0.5956, label: 1, bag_size: 898
batch 219, loss: 0.3428, instance_loss: 0.2614, weighted_loss: 0.3184, label: 1, bag_size: 890
batch 239, loss: 1.2969, instance_loss: 0.5128, weighted_loss: 1.0616, label: 2, bag_size: 571
batch 259, loss: 0.8803, instance_loss: 0.3494, weighted_loss: 0.7210, label: 1, bag_size: 1080
batch 279, loss: 0.5394, instance_loss: 0.4102, weighted_loss: 0.5007, label: 0, bag_size: 1018
batch 299, loss: 0.5705, instance_loss: 0.3999, weighted_loss: 0.5193, label: 0, bag_size: 990
batch 319, loss: 0.7016, instance_loss: 0.3750, weighted_loss: 0.6037, label: 2, bag_size: 846
batch 339, loss: 0.1238, instance_loss: 0.2068, weighted_loss: 0.1487, label: 3, bag_size: 50
batch 359, loss: 0.1820, instance_loss: 0.1316, weighted_loss: 0.1669, label: 4, bag_size: 40
batch 379, loss: 1.1205, instance_loss: 0.4788, weighted_loss: 0.9280, label: 1, bag_size: 657
batch 399, loss: 0.1057, instance_loss: 0.1946, weighted_loss: 0.1324, label: 3, bag_size: 18
batch 419, loss: 0.0793, instance_loss: 0.2580, weighted_loss: 0.1329, label: 0, bag_size: 898
batch 439, loss: 0.8770, instance_loss: 0.4593, weighted_loss: 0.7517, label: 2, bag_size: 508
batch 459, loss: 0.3046, instance_loss: 0.1918, weighted_loss: 0.2707, label: 1, bag_size: 697
batch 479, loss: 1.9009, instance_loss: 0.6745, weighted_loss: 1.5330, label: 2, bag_size: 916
batch 499, loss: 0.0982, instance_loss: 0.2553, weighted_loss: 0.1453, label: 0, bag_size: 360
batch 519, loss: 1.3212, instance_loss: 0.4641, weighted_loss: 1.0641, label: 2, bag_size: 3236
batch 539, loss: 0.9633, instance_loss: 0.5090, weighted_loss: 0.8270, label: 2, bag_size: 1378


class 0 clustering acc 0.9925688073394495: correct 21638/21800
class 1 clustering acc 0.23577981651376148: correct 1028/4360
Epoch: 6, train_loss: 0.7209, train_clustering_loss:  0.3647, train_error: 0.2606
class 0: acc 0.7355371900826446, correct 89/121
class 1: acc 0.6581196581196581, correct 77/117
class 2: acc 0.6224489795918368, correct 61/98
class 3: acc 0.8415841584158416, correct 85/101
class 4: acc 0.8425925925925926, correct 91/108

Val Set, val_loss: 0.9486, val_error: 0.3800, auc: 0.8493
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.19: correct 76/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
Validation loss decreased (0.982967 --> 0.948646).  Saving model ...


batch 19, loss: 0.6520, instance_loss: 0.3913, weighted_loss: 0.5738, label: 2, bag_size: 707
batch 39, loss: 0.0146, instance_loss: 0.0821, weighted_loss: 0.0348, label: 3, bag_size: 56
batch 59, loss: 0.1788, instance_loss: 0.3215, weighted_loss: 0.2216, label: 4, bag_size: 711
batch 79, loss: 0.1392, instance_loss: 0.2962, weighted_loss: 0.1863, label: 0, bag_size: 616
batch 99, loss: 0.5832, instance_loss: 0.3737, weighted_loss: 0.5204, label: 2, bag_size: 1052
batch 119, loss: 0.0089, instance_loss: 0.0825, weighted_loss: 0.0310, label: 3, bag_size: 43
batch 139, loss: 0.5263, instance_loss: 0.4855, weighted_loss: 0.5140, label: 4, bag_size: 1176
batch 159, loss: 1.3059, instance_loss: 0.5626, weighted_loss: 1.0829, label: 4, bag_size: 1357
batch 179, loss: 0.4520, instance_loss: 0.2702, weighted_loss: 0.3974, label: 1, bag_size: 746
batch 199, loss: 0.2558, instance_loss: 0.1824, weighted_loss: 0.2338, label: 1, bag_size: 828
batch 219, loss: 0.2059, instance_loss: 0.3150, weighted_loss: 0.2387, label: 0, bag_size: 367
batch 239, loss: 0.6166, instance_loss: 0.2610, weighted_loss: 0.5099, label: 1, bag_size: 897
batch 259, loss: 0.1439, instance_loss: 0.1103, weighted_loss: 0.1338, label: 3, bag_size: 1172
batch 279, loss: 0.2839, instance_loss: 0.3170, weighted_loss: 0.2938, label: 0, bag_size: 1190
batch 299, loss: 1.3818, instance_loss: 0.5187, weighted_loss: 1.1228, label: 2, bag_size: 271
batch 319, loss: 0.0579, instance_loss: 0.0976, weighted_loss: 0.0698, label: 3, bag_size: 1069
batch 339, loss: 0.6097, instance_loss: 0.3802, weighted_loss: 0.5409, label: 2, bag_size: 614
batch 359, loss: 0.0552, instance_loss: 0.1573, weighted_loss: 0.0858, label: 4, bag_size: 24
batch 379, loss: 0.0341, instance_loss: 0.0614, weighted_loss: 0.0423, label: 4, bag_size: 148
batch 399, loss: 0.3087, instance_loss: 0.3493, weighted_loss: 0.3209, label: 2, bag_size: 649
batch 419, loss: 0.5098, instance_loss: 0.3252, weighted_loss: 0.4544, label: 2, bag_size: 1232
batch 439, loss: 0.2012, instance_loss: 0.4356, weighted_loss: 0.2715, label: 0, bag_size: 114
batch 459, loss: 1.2526, instance_loss: 0.4770, weighted_loss: 1.0199, label: 2, bag_size: 682
batch 479, loss: 1.3036, instance_loss: 0.7286, weighted_loss: 1.1311, label: 2, bag_size: 373
batch 499, loss: 0.1571, instance_loss: 0.1345, weighted_loss: 0.1503, label: 3, bag_size: 316
batch 519, loss: 1.6015, instance_loss: 0.4593, weighted_loss: 1.2588, label: 3, bag_size: 1380
batch 539, loss: 0.3521, instance_loss: 0.3330, weighted_loss: 0.3464, label: 4, bag_size: 63


class 0 clustering acc 0.9926605504587156: correct 21640/21800
class 1 clustering acc 0.28577981651376144: correct 1246/4360
Epoch: 7, train_loss: 0.6508, train_clustering_loss:  0.3502, train_error: 0.2422
class 0: acc 0.8333333333333334, correct 80/96
class 1: acc 0.6491228070175439, correct 74/114
class 2: acc 0.5981308411214953, correct 64/107
class 3: acc 0.8503937007874016, correct 108/127
class 4: acc 0.8613861386138614, correct 87/101

Val Set, val_loss: 0.9866, val_error: 0.3600, auc: 0.8445
class 0 clustering acc 0.992: correct 1984/2000
class 1 clustering acc 0.1875: correct 75/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.55, correct 11/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5305, instance_loss: 0.5109, weighted_loss: 0.5246, label: 4, bag_size: 1357
batch 39, loss: 0.3316, instance_loss: 0.2688, weighted_loss: 0.3128, label: 3, bag_size: 1019
batch 59, loss: 0.4169, instance_loss: 0.3453, weighted_loss: 0.3954, label: 0, bag_size: 476
batch 79, loss: 0.2028, instance_loss: 0.1009, weighted_loss: 0.1723, label: 3, bag_size: 19
batch 99, loss: 0.4446, instance_loss: 0.4241, weighted_loss: 0.4385, label: 0, bag_size: 552
batch 119, loss: 1.1428, instance_loss: 0.4757, weighted_loss: 0.9427, label: 0, bag_size: 1289
batch 139, loss: 0.8930, instance_loss: 0.5024, weighted_loss: 0.7758, label: 2, bag_size: 1047
batch 159, loss: 1.0449, instance_loss: 0.5218, weighted_loss: 0.8880, label: 0, bag_size: 736
batch 179, loss: 1.5570, instance_loss: 0.4826, weighted_loss: 1.2347, label: 2, bag_size: 324
batch 199, loss: 0.2098, instance_loss: 0.1652, weighted_loss: 0.1964, label: 1, bag_size: 346
batch 219, loss: 0.0421, instance_loss: 0.1377, weighted_loss: 0.0707, label: 3, bag_size: 35
batch 239, loss: 1.3048, instance_loss: 0.5565, weighted_loss: 1.0803, label: 4, bag_size: 297
batch 259, loss: 0.0042, instance_loss: 0.1358, weighted_loss: 0.0437, label: 4, bag_size: 30
batch 279, loss: 1.1239, instance_loss: 0.4611, weighted_loss: 0.9250, label: 2, bag_size: 1653
batch 299, loss: 2.0294, instance_loss: 0.6399, weighted_loss: 1.6126, label: 2, bag_size: 120
batch 319, loss: 0.1393, instance_loss: 0.2698, weighted_loss: 0.1785, label: 0, bag_size: 933
batch 339, loss: 0.0292, instance_loss: 0.1476, weighted_loss: 0.0647, label: 3, bag_size: 33
batch 359, loss: 0.3825, instance_loss: 0.3328, weighted_loss: 0.3676, label: 1, bag_size: 1255
batch 379, loss: 1.2165, instance_loss: 0.6266, weighted_loss: 1.0396, label: 4, bag_size: 663
batch 399, loss: 1.5513, instance_loss: 0.6419, weighted_loss: 1.2785, label: 4, bag_size: 625
batch 419, loss: 0.5339, instance_loss: 0.2520, weighted_loss: 0.4494, label: 1, bag_size: 399
batch 439, loss: 0.1861, instance_loss: 0.3254, weighted_loss: 0.2279, label: 0, bag_size: 1247
batch 459, loss: 0.0632, instance_loss: 0.1533, weighted_loss: 0.0902, label: 3, bag_size: 46
batch 479, loss: 0.0117, instance_loss: 0.1100, weighted_loss: 0.0412, label: 3, bag_size: 43
batch 499, loss: 0.7213, instance_loss: 0.4288, weighted_loss: 0.6335, label: 2, bag_size: 409
batch 519, loss: 0.0890, instance_loss: 0.1219, weighted_loss: 0.0989, label: 4, bag_size: 174
batch 539, loss: 0.5942, instance_loss: 0.3940, weighted_loss: 0.5341, label: 0, bag_size: 759


class 0 clustering acc 0.9925688073394495: correct 21638/21800
class 1 clustering acc 0.286697247706422: correct 1250/4360
Epoch: 8, train_loss: 0.6437, train_clustering_loss:  0.3509, train_error: 0.2624
class 0: acc 0.7870370370370371, correct 85/108
class 1: acc 0.6870229007633588, correct 90/131
class 2: acc 0.5242718446601942, correct 54/103
class 3: acc 0.8541666666666666, correct 82/96
class 4: acc 0.8504672897196262, correct 91/107

Val Set, val_loss: 1.0412, val_error: 0.4000, auc: 0.8428
class 0 clustering acc 0.995: correct 1990/2000
class 1 clustering acc 0.1775: correct 71/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5, correct 7/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0431, instance_loss: 0.2206, weighted_loss: 0.0963, label: 4, bag_size: 20
batch 39, loss: 0.2878, instance_loss: 0.2348, weighted_loss: 0.2719, label: 1, bag_size: 897
batch 59, loss: 1.8661, instance_loss: 0.4957, weighted_loss: 1.4550, label: 2, bag_size: 948
batch 79, loss: 0.3722, instance_loss: 0.2897, weighted_loss: 0.3475, label: 1, bag_size: 1049
batch 99, loss: 0.0179, instance_loss: 0.1144, weighted_loss: 0.0469, label: 3, bag_size: 28
batch 119, loss: 0.0653, instance_loss: 0.1352, weighted_loss: 0.0863, label: 4, bag_size: 39
batch 139, loss: 1.1404, instance_loss: 0.4306, weighted_loss: 0.9275, label: 2, bag_size: 1218
batch 159, loss: 0.2378, instance_loss: 0.2706, weighted_loss: 0.2477, label: 0, bag_size: 340
batch 179, loss: 2.1139, instance_loss: 0.5919, weighted_loss: 1.6573, label: 1, bag_size: 936
batch 199, loss: 0.0095, instance_loss: 0.0429, weighted_loss: 0.0195, label: 4, bag_size: 112
batch 219, loss: 1.6646, instance_loss: 0.6136, weighted_loss: 1.3493, label: 0, bag_size: 1527
batch 239, loss: 0.1807, instance_loss: 0.2857, weighted_loss: 0.2122, label: 0, bag_size: 1018
batch 259, loss: 0.1644, instance_loss: 0.1266, weighted_loss: 0.1531, label: 1, bag_size: 1191
batch 279, loss: 0.4163, instance_loss: 0.2576, weighted_loss: 0.3687, label: 1, bag_size: 1651
batch 299, loss: 0.7538, instance_loss: 0.3913, weighted_loss: 0.6450, label: 2, bag_size: 245
batch 319, loss: 0.7895, instance_loss: 0.4085, weighted_loss: 0.6752, label: 2, bag_size: 1197
batch 339, loss: 0.1208, instance_loss: 0.1805, weighted_loss: 0.1387, label: 1, bag_size: 866
batch 359, loss: 1.9891, instance_loss: 0.6294, weighted_loss: 1.5812, label: 3, bag_size: 791
batch 379, loss: 0.6136, instance_loss: 0.3929, weighted_loss: 0.5474, label: 2, bag_size: 271
batch 399, loss: 0.4103, instance_loss: 0.3268, weighted_loss: 0.3853, label: 2, bag_size: 2703
batch 419, loss: 0.2723, instance_loss: 0.3363, weighted_loss: 0.2915, label: 0, bag_size: 552
batch 439, loss: 2.9950, instance_loss: 0.6525, weighted_loss: 2.2923, label: 4, bag_size: 663
batch 459, loss: 0.0346, instance_loss: 0.2167, weighted_loss: 0.0892, label: 3, bag_size: 50
batch 479, loss: 1.5940, instance_loss: 0.4783, weighted_loss: 1.2593, label: 2, bag_size: 687
batch 499, loss: 1.4606, instance_loss: 0.6224, weighted_loss: 1.2092, label: 4, bag_size: 625
batch 519, loss: 0.8104, instance_loss: 0.3597, weighted_loss: 0.6752, label: 1, bag_size: 651
batch 539, loss: 0.1302, instance_loss: 0.1089, weighted_loss: 0.1238, label: 1, bag_size: 320


class 0 clustering acc 0.9906880733944954: correct 21597/21800
class 1 clustering acc 0.33142201834862384: correct 1445/4360
Epoch: 9, train_loss: 0.5494, train_clustering_loss:  0.3303, train_error: 0.1945
class 0: acc 0.8691588785046729, correct 93/107
class 1: acc 0.7377049180327869, correct 90/122
class 2: acc 0.7155963302752294, correct 78/109
class 3: acc 0.8090909090909091, correct 89/110
class 4: acc 0.9175257731958762, correct 89/97

Val Set, val_loss: 1.0103, val_error: 0.3800, auc: 0.8465
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.25: correct 100/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.55, correct 11/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2078, instance_loss: 0.3051, weighted_loss: 0.2370, label: 4, bag_size: 1121
batch 39, loss: 0.8922, instance_loss: 0.3765, weighted_loss: 0.7375, label: 0, bag_size: 424
batch 59, loss: 0.4641, instance_loss: 0.4292, weighted_loss: 0.4536, label: 2, bag_size: 357
batch 79, loss: 0.3177, instance_loss: 0.2060, weighted_loss: 0.2842, label: 1, bag_size: 534
batch 99, loss: 0.0838, instance_loss: 0.2429, weighted_loss: 0.1315, label: 0, bag_size: 542
batch 119, loss: 0.1674, instance_loss: 0.2447, weighted_loss: 0.1906, label: 0, bag_size: 381
batch 139, loss: 0.2372, instance_loss: 0.1749, weighted_loss: 0.2185, label: 1, bag_size: 598
batch 159, loss: 1.2119, instance_loss: 0.6091, weighted_loss: 1.0311, label: 2, bag_size: 1235
batch 179, loss: 0.0224, instance_loss: 0.1361, weighted_loss: 0.0565, label: 4, bag_size: 148
batch 199, loss: 0.0182, instance_loss: 0.1764, weighted_loss: 0.0657, label: 4, bag_size: 24
batch 219, loss: 0.0576, instance_loss: 0.1804, weighted_loss: 0.0945, label: 4, bag_size: 168
batch 239, loss: 0.3917, instance_loss: 0.3978, weighted_loss: 0.3935, label: 2, bag_size: 1053
batch 259, loss: 0.4705, instance_loss: 0.2469, weighted_loss: 0.4034, label: 3, bag_size: 316
batch 279, loss: 0.1959, instance_loss: 0.2564, weighted_loss: 0.2141, label: 1, bag_size: 474
batch 299, loss: 0.0292, instance_loss: 0.1452, weighted_loss: 0.0640, label: 4, bag_size: 26
batch 319, loss: 0.0327, instance_loss: 0.2023, weighted_loss: 0.0836, label: 4, bag_size: 168
batch 339, loss: 0.2226, instance_loss: 0.3120, weighted_loss: 0.2494, label: 0, bag_size: 1255
batch 359, loss: 0.0071, instance_loss: 0.0760, weighted_loss: 0.0278, label: 3, bag_size: 48
batch 379, loss: 0.0386, instance_loss: 0.0585, weighted_loss: 0.0445, label: 4, bag_size: 192
batch 399, loss: 0.5748, instance_loss: 0.4303, weighted_loss: 0.5315, label: 2, bag_size: 421
batch 419, loss: 2.0109, instance_loss: 0.5485, weighted_loss: 1.5722, label: 1, bag_size: 786
batch 439, loss: 0.6587, instance_loss: 0.3486, weighted_loss: 0.5656, label: 1, bag_size: 1080
batch 459, loss: 1.8402, instance_loss: 0.5568, weighted_loss: 1.4552, label: 2, bag_size: 194
batch 479, loss: 0.1037, instance_loss: 0.1027, weighted_loss: 0.1034, label: 1, bag_size: 346
batch 499, loss: 0.2533, instance_loss: 0.2594, weighted_loss: 0.2551, label: 1, bag_size: 343
batch 519, loss: 0.2588, instance_loss: 0.1490, weighted_loss: 0.2259, label: 1, bag_size: 949
batch 539, loss: 0.3623, instance_loss: 0.3356, weighted_loss: 0.3543, label: 2, bag_size: 766


class 0 clustering acc 0.9907798165137615: correct 21599/21800
class 1 clustering acc 0.40573394495412846: correct 1769/4360
Epoch: 10, train_loss: 0.4672, train_clustering_loss:  0.3033, train_error: 0.1706
class 0: acc 0.8172043010752689, correct 76/93
class 1: acc 0.7899159663865546, correct 94/119
class 2: acc 0.6382978723404256, correct 60/94
class 3: acc 0.89, correct 89/100
class 4: acc 0.9568345323741008, correct 133/139

Val Set, val_loss: 1.0216, val_error: 0.3400, auc: 0.8408
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.2225: correct 89/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0803, instance_loss: 0.0845, weighted_loss: 0.0816, label: 4, bag_size: 110
batch 39, loss: 0.2167, instance_loss: 0.2435, weighted_loss: 0.2247, label: 1, bag_size: 1402
batch 59, loss: 0.0162, instance_loss: 0.2088, weighted_loss: 0.0740, label: 3, bag_size: 19
batch 79, loss: 0.4643, instance_loss: 0.4107, weighted_loss: 0.4482, label: 0, bag_size: 1086
batch 99, loss: 0.0205, instance_loss: 0.2478, weighted_loss: 0.0886, label: 3, bag_size: 18
batch 119, loss: 1.3009, instance_loss: 0.5466, weighted_loss: 1.0746, label: 1, bag_size: 1376
batch 139, loss: 0.0570, instance_loss: 0.0768, weighted_loss: 0.0629, label: 4, bag_size: 123
batch 159, loss: 0.0031, instance_loss: 0.0736, weighted_loss: 0.0242, label: 3, bag_size: 43
batch 179, loss: 0.0134, instance_loss: 0.0359, weighted_loss: 0.0202, label: 3, bag_size: 56
batch 199, loss: 0.0347, instance_loss: 0.1779, weighted_loss: 0.0777, label: 3, bag_size: 18
batch 219, loss: 0.0953, instance_loss: 0.1296, weighted_loss: 0.1056, label: 4, bag_size: 72
batch 239, loss: 0.1567, instance_loss: 0.2491, weighted_loss: 0.1844, label: 0, bag_size: 515
batch 259, loss: 0.1211, instance_loss: 0.1492, weighted_loss: 0.1295, label: 4, bag_size: 79
batch 279, loss: 1.5593, instance_loss: 0.5883, weighted_loss: 1.2680, label: 2, bag_size: 967
batch 299, loss: 0.3066, instance_loss: 0.3811, weighted_loss: 0.3289, label: 4, bag_size: 354
batch 319, loss: 0.0810, instance_loss: 0.2646, weighted_loss: 0.1361, label: 4, bag_size: 35
batch 339, loss: 0.4753, instance_loss: 0.3797, weighted_loss: 0.4466, label: 2, bag_size: 1569
batch 359, loss: 1.2269, instance_loss: 0.5467, weighted_loss: 1.0228, label: 1, bag_size: 786
batch 379, loss: 1.8872, instance_loss: 0.5966, weighted_loss: 1.5000, label: 1, bag_size: 875
batch 399, loss: 0.2572, instance_loss: 0.3306, weighted_loss: 0.2792, label: 0, bag_size: 413
batch 419, loss: 1.1613, instance_loss: 0.5301, weighted_loss: 0.9719, label: 4, bag_size: 297
batch 439, loss: 0.8621, instance_loss: 0.3351, weighted_loss: 0.7040, label: 1, bag_size: 1049
batch 459, loss: 1.2020, instance_loss: 0.4838, weighted_loss: 0.9865, label: 2, bag_size: 259
batch 479, loss: 0.5184, instance_loss: 0.3168, weighted_loss: 0.4579, label: 2, bag_size: 1289
batch 499, loss: 0.6358, instance_loss: 0.3988, weighted_loss: 0.5647, label: 2, bag_size: 278
batch 519, loss: 1.1917, instance_loss: 0.5735, weighted_loss: 1.0062, label: 1, bag_size: 860
batch 539, loss: 0.0205, instance_loss: 0.2422, weighted_loss: 0.0870, label: 3, bag_size: 20


class 0 clustering acc 0.9892201834862385: correct 21565/21800
class 1 clustering acc 0.36009174311926606: correct 1570/4360
Epoch: 11, train_loss: 0.4966, train_clustering_loss:  0.3221, train_error: 0.1780
class 0: acc 0.92, correct 115/125
class 1: acc 0.7, correct 77/110
class 2: acc 0.6382978723404256, correct 60/94
class 3: acc 0.9009009009009009, correct 100/111
class 4: acc 0.9142857142857143, correct 96/105

Val Set, val_loss: 1.0132, val_error: 0.3800, auc: 0.8463
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.245: correct 98/400
class 0: acc 0.4, correct 2/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0116, instance_loss: 0.0887, weighted_loss: 0.0347, label: 4, bag_size: 140
batch 39, loss: 0.2653, instance_loss: 0.2977, weighted_loss: 0.2750, label: 4, bag_size: 20
batch 59, loss: 0.0083, instance_loss: 0.1229, weighted_loss: 0.0427, label: 3, bag_size: 46
batch 79, loss: 0.0234, instance_loss: 0.0582, weighted_loss: 0.0338, label: 3, bag_size: 23
batch 99, loss: 0.0243, instance_loss: 0.1167, weighted_loss: 0.0520, label: 0, bag_size: 1143
batch 119, loss: 0.0830, instance_loss: 0.2519, weighted_loss: 0.1336, label: 0, bag_size: 1018
batch 139, loss: 0.0018, instance_loss: 0.2240, weighted_loss: 0.0684, label: 4, bag_size: 1002
batch 159, loss: 1.0305, instance_loss: 0.4862, weighted_loss: 0.8672, label: 2, bag_size: 869
batch 179, loss: 0.0162, instance_loss: 0.1986, weighted_loss: 0.0709, label: 3, bag_size: 18
batch 199, loss: 0.2782, instance_loss: 0.2756, weighted_loss: 0.2774, label: 1, bag_size: 696
batch 219, loss: 0.0911, instance_loss: 0.1790, weighted_loss: 0.1175, label: 3, bag_size: 316
batch 239, loss: 0.0215, instance_loss: 0.0802, weighted_loss: 0.0391, label: 4, bag_size: 91
batch 259, loss: 0.0396, instance_loss: 0.1030, weighted_loss: 0.0586, label: 4, bag_size: 119
batch 279, loss: 4.5148, instance_loss: 0.8930, weighted_loss: 3.4283, label: 4, bag_size: 511
batch 299, loss: 0.3990, instance_loss: 0.3452, weighted_loss: 0.3829, label: 2, bag_size: 271
batch 319, loss: 0.0750, instance_loss: 0.2014, weighted_loss: 0.1129, label: 0, bag_size: 1018
batch 339, loss: 0.1949, instance_loss: 0.2727, weighted_loss: 0.2183, label: 1, bag_size: 959
batch 359, loss: 0.0569, instance_loss: 0.1421, weighted_loss: 0.0825, label: 3, bag_size: 28
batch 379, loss: 0.3580, instance_loss: 0.2581, weighted_loss: 0.3280, label: 3, bag_size: 841
batch 399, loss: 0.0130, instance_loss: 0.0986, weighted_loss: 0.0387, label: 3, bag_size: 63
batch 419, loss: 0.1965, instance_loss: 0.2133, weighted_loss: 0.2015, label: 4, bag_size: 86
batch 439, loss: 0.0280, instance_loss: 0.1202, weighted_loss: 0.0557, label: 3, bag_size: 75
batch 459, loss: 0.1804, instance_loss: 0.3434, weighted_loss: 0.2293, label: 0, bag_size: 1196
batch 479, loss: 0.0637, instance_loss: 0.2002, weighted_loss: 0.1047, label: 0, bag_size: 921
batch 499, loss: 0.0550, instance_loss: 0.1651, weighted_loss: 0.0880, label: 0, bag_size: 921
batch 519, loss: 0.0086, instance_loss: 0.1339, weighted_loss: 0.0462, label: 4, bag_size: 168
batch 539, loss: 1.6568, instance_loss: 0.5640, weighted_loss: 1.3290, label: 1, bag_size: 470


class 0 clustering acc 0.9903211009174312: correct 21589/21800
class 1 clustering acc 0.3731651376146789: correct 1627/4360
Epoch: 12, train_loss: 0.4936, train_clustering_loss:  0.3166, train_error: 0.1945
class 0: acc 0.873015873015873, correct 110/126
class 1: acc 0.6781609195402298, correct 59/87
class 2: acc 0.6176470588235294, correct 63/102
class 3: acc 0.8596491228070176, correct 98/114
class 4: acc 0.9396551724137931, correct 109/116

Val Set, val_loss: 1.0674, val_error: 0.3600, auc: 0.8281
class 0 clustering acc 0.993: correct 1986/2000
class 1 clustering acc 0.2075: correct 83/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 0.75, correct 15/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3781, instance_loss: 0.3295, weighted_loss: 0.3635, label: 1, bag_size: 343
batch 39, loss: 0.2727, instance_loss: 0.2611, weighted_loss: 0.2693, label: 2, bag_size: 455
batch 59, loss: 0.0280, instance_loss: 0.1016, weighted_loss: 0.0501, label: 3, bag_size: 54
batch 79, loss: 0.0380, instance_loss: 0.1750, weighted_loss: 0.0791, label: 4, bag_size: 91
batch 99, loss: 0.2924, instance_loss: 0.5206, weighted_loss: 0.3609, label: 4, bag_size: 625
batch 119, loss: 0.0096, instance_loss: 0.0646, weighted_loss: 0.0261, label: 4, bag_size: 211
batch 139, loss: 0.4745, instance_loss: 0.4253, weighted_loss: 0.4597, label: 2, bag_size: 508
batch 159, loss: 0.1139, instance_loss: 0.3115, weighted_loss: 0.1732, label: 2, bag_size: 784
batch 179, loss: 0.0126, instance_loss: 0.0726, weighted_loss: 0.0306, label: 4, bag_size: 147
batch 199, loss: 1.6308, instance_loss: 0.5541, weighted_loss: 1.3078, label: 1, bag_size: 700
batch 219, loss: 0.0182, instance_loss: 0.0686, weighted_loss: 0.0333, label: 4, bag_size: 55
batch 239, loss: 0.0672, instance_loss: 0.0836, weighted_loss: 0.0721, label: 3, bag_size: 305
batch 259, loss: 0.0084, instance_loss: 0.0631, weighted_loss: 0.0248, label: 3, bag_size: 46
batch 279, loss: 0.4608, instance_loss: 0.4023, weighted_loss: 0.4433, label: 1, bag_size: 1255
batch 299, loss: 0.0566, instance_loss: 0.3090, weighted_loss: 0.1323, label: 4, bag_size: 24
batch 319, loss: 0.2448, instance_loss: 0.4190, weighted_loss: 0.2971, label: 4, bag_size: 625
batch 339, loss: 0.5651, instance_loss: 0.4698, weighted_loss: 0.5365, label: 1, bag_size: 860
batch 359, loss: 0.0139, instance_loss: 0.2478, weighted_loss: 0.0841, label: 3, bag_size: 20
batch 379, loss: 0.0167, instance_loss: 0.0593, weighted_loss: 0.0295, label: 4, bag_size: 130
batch 399, loss: 3.0362, instance_loss: 0.5736, weighted_loss: 2.2974, label: 1, bag_size: 700
batch 419, loss: 0.0558, instance_loss: 0.2886, weighted_loss: 0.1257, label: 0, bag_size: 116
batch 439, loss: 0.1174, instance_loss: 0.5013, weighted_loss: 0.2326, label: 0, bag_size: 129
batch 459, loss: 1.5370, instance_loss: 0.7952, weighted_loss: 1.3145, label: 3, bag_size: 360
batch 479, loss: 0.0118, instance_loss: 0.2344, weighted_loss: 0.0785, label: 0, bag_size: 1466
batch 499, loss: 0.6178, instance_loss: 0.3325, weighted_loss: 0.5322, label: 0, bag_size: 294
batch 519, loss: 1.8092, instance_loss: 0.5269, weighted_loss: 1.4245, label: 1, bag_size: 875
batch 539, loss: 0.8699, instance_loss: 0.4898, weighted_loss: 0.7559, label: 2, bag_size: 1148


class 0 clustering acc 0.9905504587155963: correct 21594/21800
class 1 clustering acc 0.39655963302752295: correct 1729/4360
Epoch: 13, train_loss: 0.4370, train_clustering_loss:  0.3086, train_error: 0.1743
class 0: acc 0.9145299145299145, correct 107/117
class 1: acc 0.7209302325581395, correct 93/129
class 2: acc 0.6534653465346535, correct 66/101
class 3: acc 0.9278350515463918, correct 90/97
class 4: acc 0.9306930693069307, correct 94/101

Val Set, val_loss: 1.0527, val_error: 0.3800, auc: 0.8494
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.55, correct 11/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2494, instance_loss: 0.2219, weighted_loss: 0.2412, label: 0, bag_size: 294
batch 39, loss: 0.3216, instance_loss: 0.3045, weighted_loss: 0.3165, label: 2, bag_size: 270
batch 59, loss: 0.8581, instance_loss: 0.3636, weighted_loss: 0.7098, label: 0, bag_size: 545
batch 79, loss: 0.2677, instance_loss: 0.3025, weighted_loss: 0.2782, label: 2, bag_size: 499
batch 99, loss: 0.3810, instance_loss: 0.4357, weighted_loss: 0.3974, label: 0, bag_size: 466
batch 119, loss: 0.0142, instance_loss: 0.0897, weighted_loss: 0.0368, label: 0, bag_size: 1012
batch 139, loss: 1.4186, instance_loss: 0.5037, weighted_loss: 1.1441, label: 1, bag_size: 1197
batch 159, loss: 1.1037, instance_loss: 0.3843, weighted_loss: 0.8879, label: 0, bag_size: 545
batch 179, loss: 0.0202, instance_loss: 0.1200, weighted_loss: 0.0501, label: 3, bag_size: 20
batch 199, loss: 0.0177, instance_loss: 0.1355, weighted_loss: 0.0530, label: 3, bag_size: 28
batch 219, loss: 0.0708, instance_loss: 0.2420, weighted_loss: 0.1221, label: 3, bag_size: 841
batch 239, loss: 2.7434, instance_loss: 0.6291, weighted_loss: 2.1091, label: 3, bag_size: 1380
batch 259, loss: 0.0207, instance_loss: 0.1858, weighted_loss: 0.0702, label: 4, bag_size: 20
batch 279, loss: 0.9378, instance_loss: 0.4114, weighted_loss: 0.7799, label: 1, bag_size: 746
batch 299, loss: 1.0064, instance_loss: 0.5646, weighted_loss: 0.8739, label: 2, bag_size: 758
batch 319, loss: 0.0200, instance_loss: 0.1904, weighted_loss: 0.0711, label: 3, bag_size: 18
batch 339, loss: 0.0376, instance_loss: 0.2828, weighted_loss: 0.1112, label: 3, bag_size: 17
batch 359, loss: 0.3723, instance_loss: 0.3558, weighted_loss: 0.3674, label: 2, bag_size: 237
batch 379, loss: 2.5694, instance_loss: 0.5825, weighted_loss: 1.9733, label: 3, bag_size: 1380
batch 399, loss: 0.0365, instance_loss: 0.2162, weighted_loss: 0.0904, label: 4, bag_size: 20
batch 419, loss: 0.0070, instance_loss: 0.1551, weighted_loss: 0.0514, label: 3, bag_size: 18
batch 439, loss: 0.0860, instance_loss: 0.0851, weighted_loss: 0.0857, label: 1, bag_size: 937
batch 459, loss: 0.2964, instance_loss: 0.3643, weighted_loss: 0.3168, label: 2, bag_size: 1047
batch 479, loss: 0.4890, instance_loss: 0.3651, weighted_loss: 0.4518, label: 2, bag_size: 1133
batch 499, loss: 0.0060, instance_loss: 0.0410, weighted_loss: 0.0165, label: 4, bag_size: 162
batch 519, loss: 0.4337, instance_loss: 0.2282, weighted_loss: 0.3721, label: 3, bag_size: 1177
batch 539, loss: 0.0261, instance_loss: 0.0898, weighted_loss: 0.0452, label: 4, bag_size: 143


class 0 clustering acc 0.9904128440366973: correct 21591/21800
class 1 clustering acc 0.43279816513761465: correct 1887/4360
Epoch: 14, train_loss: 0.3944, train_clustering_loss:  0.2939, train_error: 0.1505
class 0: acc 0.8981481481481481, correct 97/108
class 1: acc 0.7454545454545455, correct 82/110
class 2: acc 0.7387387387387387, correct 82/111
class 3: acc 0.9345794392523364, correct 100/107
class 4: acc 0.9357798165137615, correct 102/109

Val Set, val_loss: 1.2066, val_error: 0.4000, auc: 0.8338
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.26: correct 104/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.5, correct 10/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.0917, instance_loss: 0.5555, weighted_loss: 0.9308, label: 2, bag_size: 967
batch 39, loss: 0.0039, instance_loss: 0.0374, weighted_loss: 0.0140, label: 4, bag_size: 192
batch 59, loss: 0.1956, instance_loss: 0.3845, weighted_loss: 0.2523, label: 0, bag_size: 1135
batch 79, loss: 0.1947, instance_loss: 0.3821, weighted_loss: 0.2509, label: 0, bag_size: 1196
batch 99, loss: 0.5233, instance_loss: 0.3610, weighted_loss: 0.4746, label: 2, bag_size: 1133
batch 119, loss: 0.0580, instance_loss: 0.1720, weighted_loss: 0.0922, label: 1, bag_size: 828
batch 139, loss: 3.0004, instance_loss: 0.6907, weighted_loss: 2.3075, label: 1, bag_size: 700
batch 159, loss: 0.1154, instance_loss: 0.3509, weighted_loss: 0.1860, label: 0, bag_size: 110
batch 179, loss: 0.5325, instance_loss: 0.5644, weighted_loss: 0.5421, label: 2, bag_size: 649
batch 199, loss: 0.0149, instance_loss: 0.1074, weighted_loss: 0.0426, label: 0, bag_size: 246
batch 219, loss: 0.4106, instance_loss: 0.2778, weighted_loss: 0.3708, label: 3, bag_size: 697
batch 239, loss: 0.0170, instance_loss: 0.0672, weighted_loss: 0.0320, label: 4, bag_size: 157
batch 259, loss: 0.0109, instance_loss: 0.1036, weighted_loss: 0.0387, label: 4, bag_size: 44
batch 279, loss: 0.0259, instance_loss: 0.2370, weighted_loss: 0.0892, label: 3, bag_size: 1291
batch 299, loss: 0.0433, instance_loss: 0.1912, weighted_loss: 0.0877, label: 3, bag_size: 78
batch 319, loss: 0.0528, instance_loss: 0.3357, weighted_loss: 0.1377, label: 0, bag_size: 110
batch 339, loss: 0.0467, instance_loss: 0.3110, weighted_loss: 0.1260, label: 0, bag_size: 114
batch 359, loss: 0.1135, instance_loss: 0.0765, weighted_loss: 0.1024, label: 3, bag_size: 1559
batch 379, loss: 0.4143, instance_loss: 0.3253, weighted_loss: 0.3876, label: 2, bag_size: 883
batch 399, loss: 0.4340, instance_loss: 0.3363, weighted_loss: 0.4047, label: 2, bag_size: 941
batch 419, loss: 0.7170, instance_loss: 0.4820, weighted_loss: 0.6465, label: 2, bag_size: 1259
batch 439, loss: 0.0309, instance_loss: 0.1123, weighted_loss: 0.0553, label: 4, bag_size: 110
batch 459, loss: 0.9348, instance_loss: 0.6368, weighted_loss: 0.8454, label: 2, bag_size: 916
batch 479, loss: 0.3045, instance_loss: 0.3102, weighted_loss: 0.3062, label: 2, bag_size: 1047
batch 499, loss: 0.6492, instance_loss: 0.3752, weighted_loss: 0.5670, label: 2, bag_size: 1410
batch 519, loss: 0.0379, instance_loss: 0.1487, weighted_loss: 0.0712, label: 1, bag_size: 534
batch 539, loss: 0.4537, instance_loss: 0.3540, weighted_loss: 0.4238, label: 2, bag_size: 278


class 0 clustering acc 0.9892660550458715: correct 21566/21800
class 1 clustering acc 0.39105504587155965: correct 1705/4360
Epoch: 15, train_loss: 0.4377, train_clustering_loss:  0.3088, train_error: 0.1615
class 0: acc 0.9074074074074074, correct 98/108
class 1: acc 0.6785714285714286, correct 76/112
class 2: acc 0.7641509433962265, correct 81/106
class 3: acc 0.9385964912280702, correct 107/114
class 4: acc 0.9047619047619048, correct 95/105

Val Set, val_loss: 1.0536, val_error: 0.4200, auc: 0.8590
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.2521, instance_loss: 0.1775, weighted_loss: 0.2297, label: 0, bag_size: 375
batch 39, loss: 0.1246, instance_loss: 0.2364, weighted_loss: 0.1582, label: 2, bag_size: 461
batch 59, loss: 2.6784, instance_loss: 0.5745, weighted_loss: 2.0472, label: 0, bag_size: 245
batch 79, loss: 1.3296, instance_loss: 0.8488, weighted_loss: 1.1853, label: 1, bag_size: 651
batch 99, loss: 0.9673, instance_loss: 0.5303, weighted_loss: 0.8362, label: 3, bag_size: 706
batch 119, loss: 0.0508, instance_loss: 0.1724, weighted_loss: 0.0872, label: 1, bag_size: 696
batch 139, loss: 0.0369, instance_loss: 0.1018, weighted_loss: 0.0563, label: 1, bag_size: 1402
batch 159, loss: 0.0059, instance_loss: 0.1441, weighted_loss: 0.0474, label: 4, bag_size: 140
batch 179, loss: 0.0802, instance_loss: 0.3157, weighted_loss: 0.1508, label: 3, bag_size: 697
batch 199, loss: 0.2536, instance_loss: 0.2858, weighted_loss: 0.2633, label: 2, bag_size: 271
batch 219, loss: 0.0674, instance_loss: 0.2021, weighted_loss: 0.1078, label: 0, bag_size: 807
batch 239, loss: 1.4485, instance_loss: 0.4940, weighted_loss: 1.1622, label: 1, bag_size: 1197
batch 259, loss: 0.9729, instance_loss: 0.5056, weighted_loss: 0.8327, label: 1, bag_size: 1197
batch 279, loss: 0.3143, instance_loss: 0.2918, weighted_loss: 0.3075, label: 2, bag_size: 470
batch 299, loss: 0.2299, instance_loss: 0.3303, weighted_loss: 0.2600, label: 2, bag_size: 986
batch 319, loss: 0.4237, instance_loss: 0.3882, weighted_loss: 0.4131, label: 4, bag_size: 773
batch 339, loss: 0.0197, instance_loss: 0.2916, weighted_loss: 0.1012, label: 3, bag_size: 16
batch 359, loss: 0.0182, instance_loss: 0.2250, weighted_loss: 0.0802, label: 0, bag_size: 155
batch 379, loss: 0.0535, instance_loss: 0.1402, weighted_loss: 0.0795, label: 0, bag_size: 1061
batch 399, loss: 0.0248, instance_loss: 0.0859, weighted_loss: 0.0431, label: 3, bag_size: 78
batch 419, loss: 0.0398, instance_loss: 0.0759, weighted_loss: 0.0506, label: 3, bag_size: 60
batch 439, loss: 0.0072, instance_loss: 0.2086, weighted_loss: 0.0677, label: 3, bag_size: 20
batch 459, loss: 0.0409, instance_loss: 0.1779, weighted_loss: 0.0820, label: 4, bag_size: 23
batch 479, loss: 3.5048, instance_loss: 0.8307, weighted_loss: 2.7026, label: 4, bag_size: 511
batch 499, loss: 0.0057, instance_loss: 0.0594, weighted_loss: 0.0218, label: 4, bag_size: 79
batch 519, loss: 0.0260, instance_loss: 0.2405, weighted_loss: 0.0904, label: 4, bag_size: 790
batch 539, loss: 0.1953, instance_loss: 0.4063, weighted_loss: 0.2586, label: 2, bag_size: 358


class 0 clustering acc 0.9896788990825688: correct 21575/21800
class 1 clustering acc 0.4286697247706422: correct 1869/4360
Epoch: 16, train_loss: 0.3850, train_clustering_loss:  0.3004, train_error: 0.1339
class 0: acc 0.9310344827586207, correct 108/116
class 1: acc 0.77, correct 77/100
class 2: acc 0.7586206896551724, correct 88/116
class 3: acc 0.9454545454545454, correct 104/110
class 4: acc 0.9223300970873787, correct 95/103

Val Set, val_loss: 1.0377, val_error: 0.3400, auc: 0.8628
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.2625: correct 105/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.7, correct 14/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.4768, instance_loss: 0.2879, weighted_loss: 0.4202, label: 1, bag_size: 945
batch 39, loss: 1.9434, instance_loss: 0.6175, weighted_loss: 1.5457, label: 1, bag_size: 1172
batch 59, loss: 0.1582, instance_loss: 0.3682, weighted_loss: 0.2212, label: 2, bag_size: 1215
batch 79, loss: 0.0035, instance_loss: 0.3331, weighted_loss: 0.1024, label: 3, bag_size: 16
batch 99, loss: 0.0057, instance_loss: 0.0398, weighted_loss: 0.0159, label: 4, bag_size: 157
batch 119, loss: 0.0185, instance_loss: 0.1134, weighted_loss: 0.0469, label: 3, bag_size: 35
batch 139, loss: 0.0281, instance_loss: 0.2360, weighted_loss: 0.0905, label: 4, bag_size: 388
batch 159, loss: 0.5866, instance_loss: 0.5027, weighted_loss: 0.5615, label: 1, bag_size: 470
batch 179, loss: 0.0135, instance_loss: 0.1189, weighted_loss: 0.0451, label: 4, bag_size: 119
batch 199, loss: 1.0187, instance_loss: 0.4789, weighted_loss: 0.8567, label: 2, bag_size: 943
batch 219, loss: 0.0341, instance_loss: 0.1539, weighted_loss: 0.0700, label: 3, bag_size: 16
batch 239, loss: 0.0033, instance_loss: 0.2966, weighted_loss: 0.0913, label: 3, bag_size: 18
batch 259, loss: 0.6969, instance_loss: 0.3284, weighted_loss: 0.5864, label: 2, bag_size: 470
batch 279, loss: 0.0010, instance_loss: 0.0722, weighted_loss: 0.0223, label: 4, bag_size: 72
batch 299, loss: 0.9063, instance_loss: 0.5209, weighted_loss: 0.7907, label: 2, bag_size: 1167
batch 319, loss: 0.0252, instance_loss: 0.1140, weighted_loss: 0.0519, label: 4, bag_size: 55
batch 339, loss: 2.1997, instance_loss: 0.6182, weighted_loss: 1.7253, label: 3, bag_size: 1380
batch 359, loss: 0.0065, instance_loss: 0.2025, weighted_loss: 0.0653, label: 4, bag_size: 1474
batch 379, loss: 0.2456, instance_loss: 0.4154, weighted_loss: 0.2965, label: 2, bag_size: 638
batch 399, loss: 0.0431, instance_loss: 0.2410, weighted_loss: 0.1025, label: 0, bag_size: 976
batch 419, loss: 0.0005, instance_loss: 0.0901, weighted_loss: 0.0274, label: 3, bag_size: 56
batch 439, loss: 0.0104, instance_loss: 0.1453, weighted_loss: 0.0509, label: 4, bag_size: 24
batch 459, loss: 1.4071, instance_loss: 0.6245, weighted_loss: 1.1723, label: 0, bag_size: 1289
batch 479, loss: 0.3923, instance_loss: 0.3670, weighted_loss: 0.3847, label: 2, bag_size: 357
batch 499, loss: 0.0229, instance_loss: 0.2672, weighted_loss: 0.0962, label: 4, bag_size: 947
batch 519, loss: 0.2133, instance_loss: 0.1416, weighted_loss: 0.1918, label: 1, bag_size: 690
batch 539, loss: 0.0094, instance_loss: 0.1442, weighted_loss: 0.0498, label: 4, bag_size: 947


class 0 clustering acc 0.9899082568807339: correct 21580/21800
class 1 clustering acc 0.4077981651376147: correct 1778/4360
Epoch: 17, train_loss: 0.3886, train_clustering_loss:  0.3035, train_error: 0.1358
class 0: acc 0.9368421052631579, correct 89/95
class 1: acc 0.7631578947368421, correct 87/114
class 2: acc 0.7714285714285715, correct 81/105
class 3: acc 0.9099099099099099, correct 101/111
class 4: acc 0.9416666666666667, correct 113/120

Val Set, val_loss: 1.0763, val_error: 0.3400, auc: 0.8452
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.2675: correct 107/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0036, instance_loss: 0.0285, weighted_loss: 0.0111, label: 3, bag_size: 66
batch 39, loss: 0.8240, instance_loss: 0.7695, weighted_loss: 0.8076, label: 2, bag_size: 636
batch 59, loss: 0.4422, instance_loss: 0.3467, weighted_loss: 0.4135, label: 0, bag_size: 570
batch 79, loss: 0.1377, instance_loss: 0.2882, weighted_loss: 0.1829, label: 2, bag_size: 312
batch 99, loss: 0.0141, instance_loss: 0.1057, weighted_loss: 0.0416, label: 4, bag_size: 125
batch 119, loss: 0.0935, instance_loss: 0.2268, weighted_loss: 0.1335, label: 4, bag_size: 28
batch 139, loss: 0.1214, instance_loss: 0.3774, weighted_loss: 0.1982, label: 4, bag_size: 1474
batch 159, loss: 0.0911, instance_loss: 0.1647, weighted_loss: 0.1132, label: 4, bag_size: 44
batch 179, loss: 0.9395, instance_loss: 0.4347, weighted_loss: 0.7881, label: 1, bag_size: 533
batch 199, loss: 0.0119, instance_loss: 0.1282, weighted_loss: 0.0467, label: 3, bag_size: 20
batch 219, loss: 0.2896, instance_loss: 0.2313, weighted_loss: 0.2721, label: 2, bag_size: 469
batch 239, loss: 1.4743, instance_loss: 0.6181, weighted_loss: 1.2175, label: 2, bag_size: 1043
batch 259, loss: 0.1649, instance_loss: 0.1928, weighted_loss: 0.1732, label: 2, bag_size: 1404
batch 279, loss: 0.0572, instance_loss: 0.2857, weighted_loss: 0.1258, label: 0, bag_size: 129
batch 299, loss: 0.3542, instance_loss: 0.3533, weighted_loss: 0.3539, label: 2, bag_size: 784
batch 319, loss: 0.1846, instance_loss: 0.4387, weighted_loss: 0.2609, label: 0, bag_size: 653
batch 339, loss: 0.2671, instance_loss: 0.2621, weighted_loss: 0.2656, label: 2, bag_size: 470
batch 359, loss: 0.0282, instance_loss: 0.1984, weighted_loss: 0.0792, label: 1, bag_size: 866
batch 379, loss: 0.8603, instance_loss: 0.4648, weighted_loss: 0.7416, label: 2, bag_size: 384
batch 399, loss: 0.1669, instance_loss: 0.3064, weighted_loss: 0.2087, label: 2, bag_size: 355
batch 419, loss: 0.0921, instance_loss: 0.1197, weighted_loss: 0.1004, label: 3, bag_size: 1172
batch 439, loss: 0.0026, instance_loss: 0.1821, weighted_loss: 0.0565, label: 3, bag_size: 18
batch 459, loss: 0.2953, instance_loss: 0.2977, weighted_loss: 0.2960, label: 2, bag_size: 707
batch 479, loss: 2.2276, instance_loss: 0.6331, weighted_loss: 1.7492, label: 1, bag_size: 875
batch 499, loss: 0.0114, instance_loss: 0.1400, weighted_loss: 0.0500, label: 3, bag_size: 18
batch 519, loss: 0.0009, instance_loss: 0.0646, weighted_loss: 0.0200, label: 3, bag_size: 105
batch 539, loss: 0.1061, instance_loss: 0.3159, weighted_loss: 0.1690, label: 0, bag_size: 1196


class 0 clustering acc 0.9888532110091743: correct 21557/21800
class 1 clustering acc 0.4208715596330275: correct 1835/4360
Epoch: 18, train_loss: 0.3947, train_clustering_loss:  0.2982, train_error: 0.1468
class 0: acc 0.9183673469387755, correct 90/98
class 1: acc 0.6590909090909091, correct 58/88
class 2: acc 0.7857142857142857, correct 99/126
class 3: acc 0.9137931034482759, correct 106/116
class 4: acc 0.9572649572649573, correct 112/117

Val Set, val_loss: 1.0168, val_error: 0.3200, auc: 0.8599
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2407, instance_loss: 0.3050, weighted_loss: 0.2600, label: 0, bag_size: 718
batch 39, loss: 0.0034, instance_loss: 0.1337, weighted_loss: 0.0425, label: 3, bag_size: 143
batch 59, loss: 0.1389, instance_loss: 0.2442, weighted_loss: 0.1705, label: 1, bag_size: 242
batch 79, loss: 0.0049, instance_loss: 0.1062, weighted_loss: 0.0353, label: 4, bag_size: 40
batch 99, loss: 0.0192, instance_loss: 0.0941, weighted_loss: 0.0417, label: 4, bag_size: 137
batch 119, loss: 0.2387, instance_loss: 0.3663, weighted_loss: 0.2769, label: 3, bag_size: 849
batch 139, loss: 0.0033, instance_loss: 0.0349, weighted_loss: 0.0128, label: 0, bag_size: 898
batch 159, loss: 0.1667, instance_loss: 0.4018, weighted_loss: 0.2372, label: 2, bag_size: 638
batch 179, loss: 0.9461, instance_loss: 0.4398, weighted_loss: 0.7942, label: 2, bag_size: 943
batch 199, loss: 0.0082, instance_loss: 0.0456, weighted_loss: 0.0194, label: 4, bag_size: 157
batch 219, loss: 0.0147, instance_loss: 0.4066, weighted_loss: 0.1322, label: 4, bag_size: 823
batch 239, loss: 0.4202, instance_loss: 0.4859, weighted_loss: 0.4399, label: 2, bag_size: 750
batch 259, loss: 0.0418, instance_loss: 0.1539, weighted_loss: 0.0754, label: 1, bag_size: 1402
batch 279, loss: 0.1971, instance_loss: 0.5556, weighted_loss: 0.3047, label: 3, bag_size: 706
batch 299, loss: 0.0890, instance_loss: 0.2490, weighted_loss: 0.1370, label: 1, bag_size: 474
batch 319, loss: 0.4662, instance_loss: 0.3862, weighted_loss: 0.4422, label: 1, bag_size: 1273
batch 339, loss: 0.0158, instance_loss: 0.1074, weighted_loss: 0.0433, label: 4, bag_size: 1278
batch 359, loss: 0.0023, instance_loss: 0.2382, weighted_loss: 0.0731, label: 3, bag_size: 56
batch 379, loss: 0.0132, instance_loss: 0.0730, weighted_loss: 0.0311, label: 4, bag_size: 790
batch 399, loss: 0.0735, instance_loss: 0.4683, weighted_loss: 0.1919, label: 4, bag_size: 663
batch 419, loss: 0.1241, instance_loss: 0.2317, weighted_loss: 0.1564, label: 0, bag_size: 371
batch 439, loss: 0.9084, instance_loss: 0.3845, weighted_loss: 0.7512, label: 1, bag_size: 968
batch 459, loss: 0.0015, instance_loss: 0.0905, weighted_loss: 0.0282, label: 4, bag_size: 137
batch 479, loss: 0.1296, instance_loss: 0.4450, weighted_loss: 0.2242, label: 2, bag_size: 373
batch 499, loss: 0.2763, instance_loss: 0.5133, weighted_loss: 0.3474, label: 0, bag_size: 129
batch 519, loss: 0.6126, instance_loss: 0.3752, weighted_loss: 0.5414, label: 1, bag_size: 1646
batch 539, loss: 0.6059, instance_loss: 0.3655, weighted_loss: 0.5337, label: 1, bag_size: 1080


class 0 clustering acc 0.9910091743119266: correct 21604/21800
class 1 clustering acc 0.42110091743119266: correct 1836/4360
Epoch: 19, train_loss: 0.3560, train_clustering_loss:  0.3011, train_error: 0.1193
class 0: acc 0.95, correct 114/120
class 1: acc 0.6907216494845361, correct 67/97
class 2: acc 0.8214285714285714, correct 92/112
class 3: acc 0.9595959595959596, correct 95/99
class 4: acc 0.9572649572649573, correct 112/117

Val Set, val_loss: 1.1783, val_error: 0.3400, auc: 0.8366
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.2875: correct 115/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2870, instance_loss: 0.2928, weighted_loss: 0.2887, label: 2, bag_size: 2081
batch 39, loss: 3.2892, instance_loss: 1.0287, weighted_loss: 2.6110, label: 4, bag_size: 511
batch 59, loss: 0.2284, instance_loss: 0.1668, weighted_loss: 0.2099, label: 0, bag_size: 962
batch 79, loss: 0.1243, instance_loss: 0.2821, weighted_loss: 0.1717, label: 0, bag_size: 1196
batch 99, loss: 0.0037, instance_loss: 0.0744, weighted_loss: 0.0249, label: 3, bag_size: 55
batch 119, loss: 0.2457, instance_loss: 0.2503, weighted_loss: 0.2471, label: 2, bag_size: 317
batch 139, loss: 0.1367, instance_loss: 0.2116, weighted_loss: 0.1591, label: 1, bag_size: 754
batch 159, loss: 0.2729, instance_loss: 0.2222, weighted_loss: 0.2577, label: 1, bag_size: 913
batch 179, loss: 0.2909, instance_loss: 0.3210, weighted_loss: 0.2999, label: 2, bag_size: 1448
batch 199, loss: 0.0008, instance_loss: 0.0980, weighted_loss: 0.0300, label: 4, bag_size: 104
batch 219, loss: 3.8849, instance_loss: 1.0993, weighted_loss: 3.0492, label: 2, bag_size: 1108
batch 239, loss: 0.0049, instance_loss: 0.0355, weighted_loss: 0.0141, label: 0, bag_size: 982
batch 259, loss: 0.0141, instance_loss: 0.0649, weighted_loss: 0.0293, label: 3, bag_size: 75
batch 279, loss: 0.0168, instance_loss: 0.3530, weighted_loss: 0.1177, label: 3, bag_size: 18
batch 299, loss: 0.0041, instance_loss: 0.0709, weighted_loss: 0.0242, label: 4, bag_size: 79
batch 319, loss: 0.5273, instance_loss: 0.4423, weighted_loss: 0.5018, label: 2, bag_size: 571
batch 339, loss: 0.4138, instance_loss: 0.3036, weighted_loss: 0.3808, label: 1, bag_size: 913
batch 359, loss: 0.0714, instance_loss: 0.2376, weighted_loss: 0.1212, label: 4, bag_size: 19
batch 379, loss: 0.0204, instance_loss: 0.2476, weighted_loss: 0.0886, label: 3, bag_size: 15
batch 399, loss: 0.0006, instance_loss: 0.1440, weighted_loss: 0.0436, label: 3, bag_size: 46
batch 419, loss: 0.0011, instance_loss: 0.0277, weighted_loss: 0.0091, label: 4, bag_size: 79
batch 439, loss: 1.5984, instance_loss: 0.5931, weighted_loss: 1.2968, label: 1, bag_size: 435
batch 459, loss: 0.7099, instance_loss: 0.3745, weighted_loss: 0.6093, label: 1, bag_size: 1197
batch 479, loss: 0.0289, instance_loss: 0.2488, weighted_loss: 0.0949, label: 0, bag_size: 176
batch 499, loss: 0.0061, instance_loss: 0.0383, weighted_loss: 0.0158, label: 0, bag_size: 382
batch 519, loss: 2.2301, instance_loss: 0.6484, weighted_loss: 1.7556, label: 1, bag_size: 448
batch 539, loss: 0.1127, instance_loss: 0.2288, weighted_loss: 0.1475, label: 0, bag_size: 524


class 0 clustering acc 0.9882568807339449: correct 21544/21800
class 1 clustering acc 0.44380733944954126: correct 1935/4360
Epoch: 20, train_loss: 0.3425, train_clustering_loss:  0.2940, train_error: 0.1119
class 0: acc 0.9310344827586207, correct 108/116
class 1: acc 0.8260869565217391, correct 95/115
class 2: acc 0.7663551401869159, correct 82/107
class 3: acc 0.9652173913043478, correct 111/115
class 4: acc 0.9565217391304348, correct 88/92

Val Set, val_loss: 1.1021, val_error: 0.3200, auc: 0.8473
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.27: correct 108/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.5201, instance_loss: 0.3046, weighted_loss: 0.4555, label: 1, bag_size: 965
batch 39, loss: 0.0705, instance_loss: 0.1179, weighted_loss: 0.0847, label: 3, bag_size: 1172
batch 59, loss: 0.3395, instance_loss: 0.3930, weighted_loss: 0.3556, label: 2, bag_size: 1119
batch 79, loss: 0.0024, instance_loss: 0.0373, weighted_loss: 0.0128, label: 0, bag_size: 360
batch 99, loss: 0.0667, instance_loss: 0.1982, weighted_loss: 0.1061, label: 3, bag_size: 952
batch 119, loss: 0.1023, instance_loss: 0.2257, weighted_loss: 0.1393, label: 3, bag_size: 17
batch 139, loss: 0.0483, instance_loss: 0.4308, weighted_loss: 0.1630, label: 0, bag_size: 109
batch 159, loss: 0.2287, instance_loss: 0.1809, weighted_loss: 0.2144, label: 1, bag_size: 886
batch 179, loss: 1.1757, instance_loss: 0.5193, weighted_loss: 0.9788, label: 1, bag_size: 861
batch 199, loss: 0.7320, instance_loss: 0.4893, weighted_loss: 0.6592, label: 2, bag_size: 1197
batch 219, loss: 0.3652, instance_loss: 0.4790, weighted_loss: 0.3993, label: 2, bag_size: 741
batch 239, loss: 0.0065, instance_loss: 0.0481, weighted_loss: 0.0190, label: 4, bag_size: 764
batch 259, loss: 0.0655, instance_loss: 0.0920, weighted_loss: 0.0734, label: 1, bag_size: 346
batch 279, loss: 1.6879, instance_loss: 0.5079, weighted_loss: 1.3339, label: 1, bag_size: 1197
batch 299, loss: 0.0205, instance_loss: 0.1219, weighted_loss: 0.0509, label: 3, bag_size: 97
batch 319, loss: 0.1056, instance_loss: 0.3271, weighted_loss: 0.1721, label: 2, bag_size: 358
batch 339, loss: 0.0594, instance_loss: 0.1695, weighted_loss: 0.0924, label: 1, bag_size: 1402
batch 359, loss: 0.0782, instance_loss: 0.0678, weighted_loss: 0.0750, label: 3, bag_size: 32
batch 379, loss: 0.0568, instance_loss: 0.1606, weighted_loss: 0.0879, label: 2, bag_size: 455
batch 399, loss: 0.2500, instance_loss: 0.3022, weighted_loss: 0.2656, label: 1, bag_size: 474
batch 419, loss: 1.5981, instance_loss: 0.6645, weighted_loss: 1.3180, label: 2, bag_size: 411
batch 439, loss: 0.0614, instance_loss: 0.1805, weighted_loss: 0.0972, label: 1, bag_size: 696
batch 459, loss: 0.6198, instance_loss: 0.2994, weighted_loss: 0.5237, label: 1, bag_size: 1559
batch 479, loss: 0.0813, instance_loss: 0.1330, weighted_loss: 0.0968, label: 0, bag_size: 446
batch 499, loss: 0.0237, instance_loss: 0.0871, weighted_loss: 0.0427, label: 4, bag_size: 125
batch 519, loss: 1.1953, instance_loss: 0.3609, weighted_loss: 0.9450, label: 3, bag_size: 533
batch 539, loss: 1.9368, instance_loss: 0.6215, weighted_loss: 1.5422, label: 0, bag_size: 423


class 0 clustering acc 0.9906880733944954: correct 21597/21800
class 1 clustering acc 0.4614678899082569: correct 2012/4360
Epoch: 21, train_loss: 0.3313, train_clustering_loss:  0.2802, train_error: 0.1174
class 0: acc 0.8571428571428571, correct 84/98
class 1: acc 0.8301886792452831, correct 88/106
class 2: acc 0.8455284552845529, correct 104/123
class 3: acc 0.9495798319327731, correct 113/119
class 4: acc 0.9292929292929293, correct 92/99

Val Set, val_loss: 1.0994, val_error: 0.3600, auc: 0.8580
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.2925: correct 117/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1448, instance_loss: 0.2279, weighted_loss: 0.1697, label: 2, bag_size: 941
batch 39, loss: 0.0008, instance_loss: 0.1249, weighted_loss: 0.0380, label: 3, bag_size: 94
batch 59, loss: 0.0044, instance_loss: 0.0799, weighted_loss: 0.0271, label: 3, bag_size: 29
batch 79, loss: 0.0198, instance_loss: 0.1398, weighted_loss: 0.0558, label: 1, bag_size: 504
batch 99, loss: 0.0008, instance_loss: 0.1870, weighted_loss: 0.0567, label: 3, bag_size: 20
batch 119, loss: 0.1719, instance_loss: 0.2137, weighted_loss: 0.1844, label: 1, bag_size: 1646
batch 139, loss: 0.0948, instance_loss: 0.4279, weighted_loss: 0.1947, label: 0, bag_size: 176
batch 159, loss: 0.0025, instance_loss: 0.0507, weighted_loss: 0.0170, label: 3, bag_size: 75
batch 179, loss: 0.0124, instance_loss: 0.0554, weighted_loss: 0.0253, label: 4, bag_size: 160
batch 199, loss: 0.1224, instance_loss: 0.2447, weighted_loss: 0.1591, label: 0, bag_size: 1196
batch 219, loss: 0.1589, instance_loss: 0.2295, weighted_loss: 0.1801, label: 3, bag_size: 1019
batch 239, loss: 0.1470, instance_loss: 0.2612, weighted_loss: 0.1813, label: 2, bag_size: 614
batch 259, loss: 0.0918, instance_loss: 0.2334, weighted_loss: 0.1343, label: 4, bag_size: 137
batch 279, loss: 0.0932, instance_loss: 0.1396, weighted_loss: 0.1071, label: 0, bag_size: 294
batch 299, loss: 0.1206, instance_loss: 0.2439, weighted_loss: 0.1576, label: 2, bag_size: 470
batch 319, loss: 0.0971, instance_loss: 0.5047, weighted_loss: 0.2194, label: 1, bag_size: 470
batch 339, loss: 0.1596, instance_loss: 0.1117, weighted_loss: 0.1452, label: 3, bag_size: 1069
batch 359, loss: 2.4926, instance_loss: 0.5762, weighted_loss: 1.9177, label: 3, bag_size: 1380
batch 379, loss: 0.3833, instance_loss: 0.2068, weighted_loss: 0.3304, label: 1, bag_size: 697
batch 399, loss: 0.0046, instance_loss: 0.0521, weighted_loss: 0.0188, label: 0, bag_size: 385
batch 419, loss: 0.9710, instance_loss: 0.5912, weighted_loss: 0.8570, label: 2, bag_size: 500
batch 439, loss: 0.0855, instance_loss: 0.2008, weighted_loss: 0.1201, label: 2, bag_size: 1053
batch 459, loss: 0.0033, instance_loss: 0.0671, weighted_loss: 0.0224, label: 4, bag_size: 137
batch 479, loss: 0.0191, instance_loss: 0.0785, weighted_loss: 0.0369, label: 1, bag_size: 938
batch 499, loss: 0.4817, instance_loss: 0.4016, weighted_loss: 0.4577, label: 1, bag_size: 308
batch 519, loss: 0.1444, instance_loss: 0.3951, weighted_loss: 0.2196, label: 1, bag_size: 786
batch 539, loss: 0.6315, instance_loss: 0.4120, weighted_loss: 0.5657, label: 2, bag_size: 421


class 0 clustering acc 0.9872018348623853: correct 21521/21800
class 1 clustering acc 0.49311926605504586: correct 2150/4360
Epoch: 22, train_loss: 0.3013, train_clustering_loss:  0.2756, train_error: 0.1083
class 0: acc 0.9545454545454546, correct 105/110
class 1: acc 0.7563025210084033, correct 90/119
class 2: acc 0.8043478260869565, correct 74/92
class 3: acc 0.9847328244274809, correct 129/131
class 4: acc 0.946236559139785, correct 88/93

Val Set, val_loss: 1.2156, val_error: 0.3200, auc: 0.8362
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0011, instance_loss: 0.0738, weighted_loss: 0.0229, label: 4, bag_size: 44
batch 39, loss: 0.0429, instance_loss: 0.2845, weighted_loss: 0.1154, label: 0, bag_size: 176
batch 59, loss: 0.8482, instance_loss: 0.4929, weighted_loss: 0.7416, label: 2, bag_size: 1006
batch 79, loss: 0.0023, instance_loss: 0.1194, weighted_loss: 0.0374, label: 4, bag_size: 44
batch 99, loss: 0.6519, instance_loss: 0.4266, weighted_loss: 0.5843, label: 2, bag_size: 1052
batch 119, loss: 1.5076, instance_loss: 0.5399, weighted_loss: 1.2173, label: 2, bag_size: 869
batch 139, loss: 0.0033, instance_loss: 0.2013, weighted_loss: 0.0627, label: 4, bag_size: 19
batch 159, loss: 0.0848, instance_loss: 0.4364, weighted_loss: 0.1903, label: 1, bag_size: 746
batch 179, loss: 0.0105, instance_loss: 0.0930, weighted_loss: 0.0352, label: 0, bag_size: 1018
batch 199, loss: 0.7884, instance_loss: 0.6290, weighted_loss: 0.7406, label: 1, bag_size: 778
batch 219, loss: 0.1011, instance_loss: 0.3499, weighted_loss: 0.1757, label: 0, bag_size: 1301
batch 239, loss: 0.0015, instance_loss: 0.0434, weighted_loss: 0.0141, label: 3, bag_size: 55
batch 259, loss: 0.0689, instance_loss: 0.4215, weighted_loss: 0.1747, label: 1, bag_size: 474
batch 279, loss: 0.0021, instance_loss: 0.0309, weighted_loss: 0.0108, label: 0, bag_size: 402
batch 299, loss: 0.0005, instance_loss: 0.1625, weighted_loss: 0.0491, label: 3, bag_size: 20
batch 319, loss: 0.0291, instance_loss: 0.1492, weighted_loss: 0.0652, label: 1, bag_size: 890
batch 339, loss: 0.0383, instance_loss: 0.3428, weighted_loss: 0.1296, label: 0, bag_size: 163
batch 359, loss: 0.6814, instance_loss: 0.3414, weighted_loss: 0.5794, label: 1, bag_size: 1049
batch 379, loss: 0.3260, instance_loss: 0.3243, weighted_loss: 0.3255, label: 2, bag_size: 2826
batch 399, loss: 0.0168, instance_loss: 0.1140, weighted_loss: 0.0460, label: 1, bag_size: 399
batch 419, loss: 0.0342, instance_loss: 0.2338, weighted_loss: 0.0941, label: 0, bag_size: 1196
batch 439, loss: 0.0957, instance_loss: 0.3060, weighted_loss: 0.1588, label: 1, bag_size: 648
batch 459, loss: 2.0694, instance_loss: 0.6398, weighted_loss: 1.6405, label: 2, bag_size: 120
batch 479, loss: 0.0051, instance_loss: 0.2026, weighted_loss: 0.0643, label: 4, bag_size: 20
batch 499, loss: 0.0688, instance_loss: 0.0864, weighted_loss: 0.0741, label: 1, bag_size: 1086
batch 519, loss: 0.0169, instance_loss: 0.1079, weighted_loss: 0.0442, label: 4, bag_size: 137
batch 539, loss: 0.0006, instance_loss: 0.0211, weighted_loss: 0.0067, label: 4, bag_size: 167


class 0 clustering acc 0.9882568807339449: correct 21544/21800
class 1 clustering acc 0.47293577981651375: correct 2062/4360
Epoch: 23, train_loss: 0.2810, train_clustering_loss:  0.2821, train_error: 0.0917
class 0: acc 0.9528301886792453, correct 101/106
class 1: acc 0.8333333333333334, correct 100/120
class 2: acc 0.8348623853211009, correct 91/109
class 3: acc 0.981651376146789, correct 107/109
class 4: acc 0.9504950495049505, correct 96/101

Val Set, val_loss: 1.1670, val_error: 0.3000, auc: 0.8337
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.7, correct 14/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0018, instance_loss: 0.0721, weighted_loss: 0.0229, label: 4, bag_size: 78
batch 39, loss: 0.0090, instance_loss: 0.2131, weighted_loss: 0.0702, label: 4, bag_size: 20
batch 59, loss: 0.1073, instance_loss: 0.2832, weighted_loss: 0.1600, label: 2, bag_size: 725
batch 79, loss: 0.4775, instance_loss: 0.1589, weighted_loss: 0.3819, label: 1, bag_size: 682
batch 99, loss: 1.7260, instance_loss: 0.6055, weighted_loss: 1.3899, label: 1, bag_size: 535
batch 119, loss: 0.0347, instance_loss: 0.1407, weighted_loss: 0.0665, label: 0, bag_size: 375
batch 139, loss: 1.1558, instance_loss: 0.7325, weighted_loss: 1.0288, label: 4, bag_size: 1337
batch 159, loss: 0.0628, instance_loss: 0.2576, weighted_loss: 0.1213, label: 2, bag_size: 330
batch 179, loss: 0.0050, instance_loss: 0.1035, weighted_loss: 0.0346, label: 4, bag_size: 182
batch 199, loss: 0.7196, instance_loss: 0.5054, weighted_loss: 0.6553, label: 2, bag_size: 1197
batch 219, loss: 0.0021, instance_loss: 0.0723, weighted_loss: 0.0232, label: 3, bag_size: 48
batch 239, loss: 0.0236, instance_loss: 0.1031, weighted_loss: 0.0475, label: 0, bag_size: 367
batch 259, loss: 0.0369, instance_loss: 0.1054, weighted_loss: 0.0574, label: 4, bag_size: 94
batch 279, loss: 0.1755, instance_loss: 0.1493, weighted_loss: 0.1677, label: 3, bag_size: 1019
batch 299, loss: 0.0023, instance_loss: 0.0476, weighted_loss: 0.0159, label: 3, bag_size: 63
batch 319, loss: 0.0491, instance_loss: 0.2115, weighted_loss: 0.0978, label: 2, bag_size: 1289
batch 339, loss: 0.0367, instance_loss: 0.1833, weighted_loss: 0.0807, label: 4, bag_size: 40
batch 359, loss: 0.0858, instance_loss: 0.3095, weighted_loss: 0.1529, label: 0, bag_size: 1135
batch 379, loss: 0.0008, instance_loss: 0.0621, weighted_loss: 0.0192, label: 3, bag_size: 37
batch 399, loss: 0.0051, instance_loss: 0.1903, weighted_loss: 0.0606, label: 4, bag_size: 119
batch 419, loss: 0.5075, instance_loss: 0.4202, weighted_loss: 0.4813, label: 2, bag_size: 732
batch 439, loss: 0.4395, instance_loss: 0.3142, weighted_loss: 0.4019, label: 1, bag_size: 965
batch 459, loss: 0.0155, instance_loss: 0.0952, weighted_loss: 0.0394, label: 0, bag_size: 1018
batch 479, loss: 0.0069, instance_loss: 0.0532, weighted_loss: 0.0208, label: 4, bag_size: 160
batch 499, loss: 0.4246, instance_loss: 0.2256, weighted_loss: 0.3649, label: 0, bag_size: 515
batch 519, loss: 0.3393, instance_loss: 0.7431, weighted_loss: 0.4605, label: 2, bag_size: 758
batch 539, loss: 0.3885, instance_loss: 0.3374, weighted_loss: 0.3731, label: 0, bag_size: 432


class 0 clustering acc 0.986788990825688: correct 21512/21800
class 1 clustering acc 0.4488532110091743: correct 1957/4360
Epoch: 24, train_loss: 0.3164, train_clustering_loss:  0.2920, train_error: 0.1174
class 0: acc 0.9130434782608695, correct 105/115
class 1: acc 0.7878787878787878, correct 78/99
class 2: acc 0.8278688524590164, correct 101/122
class 3: acc 0.9245283018867925, correct 98/106
class 4: acc 0.9611650485436893, correct 99/103

Val Set, val_loss: 1.1799, val_error: 0.3600, auc: 0.8418
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.3016, instance_loss: 0.2851, weighted_loss: 0.2967, label: 1, bag_size: 949
batch 39, loss: 0.0031, instance_loss: 0.2286, weighted_loss: 0.0707, label: 4, bag_size: 38
batch 59, loss: 0.0102, instance_loss: 0.1013, weighted_loss: 0.0375, label: 4, bag_size: 78
batch 79, loss: 0.0231, instance_loss: 0.5166, weighted_loss: 0.1712, label: 4, bag_size: 823
batch 99, loss: 0.0943, instance_loss: 0.1728, weighted_loss: 0.1179, label: 1, bag_size: 1325
batch 119, loss: 0.0175, instance_loss: 0.0852, weighted_loss: 0.0378, label: 0, bag_size: 246
batch 139, loss: 0.0041, instance_loss: 0.1204, weighted_loss: 0.0390, label: 4, bag_size: 55
batch 159, loss: 0.0454, instance_loss: 0.3450, weighted_loss: 0.1353, label: 0, bag_size: 136
batch 179, loss: 0.0563, instance_loss: 0.2914, weighted_loss: 0.1269, label: 1, bag_size: 1014
batch 199, loss: 0.1145, instance_loss: 0.3387, weighted_loss: 0.1817, label: 1, bag_size: 700
batch 219, loss: 0.0155, instance_loss: 0.1303, weighted_loss: 0.0500, label: 0, bag_size: 807
batch 239, loss: 0.5383, instance_loss: 0.6219, weighted_loss: 0.5634, label: 2, bag_size: 358
batch 259, loss: 1.3560, instance_loss: 0.5120, weighted_loss: 1.1028, label: 2, bag_size: 986
batch 279, loss: 0.0006, instance_loss: 0.1794, weighted_loss: 0.0543, label: 3, bag_size: 24
batch 299, loss: 0.0031, instance_loss: 0.1959, weighted_loss: 0.0609, label: 4, bag_size: 947
batch 319, loss: 0.2114, instance_loss: 0.2191, weighted_loss: 0.2137, label: 2, bag_size: 1006
batch 339, loss: 0.0101, instance_loss: 0.0970, weighted_loss: 0.0362, label: 4, bag_size: 91
batch 359, loss: 0.2704, instance_loss: 0.2085, weighted_loss: 0.2518, label: 1, bag_size: 965
batch 379, loss: 0.2739, instance_loss: 0.1923, weighted_loss: 0.2494, label: 2, bag_size: 1281
batch 399, loss: 0.0909, instance_loss: 0.3365, weighted_loss: 0.1646, label: 0, bag_size: 542
batch 419, loss: 0.0239, instance_loss: 0.1467, weighted_loss: 0.0607, label: 4, bag_size: 1278
batch 439, loss: 0.2045, instance_loss: 0.3066, weighted_loss: 0.2351, label: 2, bag_size: 259
batch 459, loss: 0.2389, instance_loss: 0.6139, weighted_loss: 0.3514, label: 1, bag_size: 917
batch 479, loss: 1.4435, instance_loss: 0.4409, weighted_loss: 1.1427, label: 2, bag_size: 1200
batch 499, loss: 0.2881, instance_loss: 0.4414, weighted_loss: 0.3341, label: 2, bag_size: 649
batch 519, loss: 0.0032, instance_loss: 0.1007, weighted_loss: 0.0324, label: 3, bag_size: 55
batch 539, loss: 0.3159, instance_loss: 0.3786, weighted_loss: 0.3347, label: 0, bag_size: 570


class 0 clustering acc 0.9860550458715597: correct 21496/21800
class 1 clustering acc 0.48440366972477067: correct 2112/4360
Epoch: 25, train_loss: 0.2801, train_clustering_loss:  0.2775, train_error: 0.0917
class 0: acc 0.9574468085106383, correct 90/94
class 1: acc 0.8130841121495327, correct 87/107
class 2: acc 0.8349514563106796, correct 86/103
class 3: acc 0.9658119658119658, correct 113/117
class 4: acc 0.9596774193548387, correct 119/124

Val Set, val_loss: 1.1640, val_error: 0.3200, auc: 0.8462
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.3475: correct 139/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.1005, instance_loss: 0.4399, weighted_loss: 0.2023, label: 0, bag_size: 552
batch 39, loss: 0.6070, instance_loss: 0.3914, weighted_loss: 0.5423, label: 2, bag_size: 1306
batch 59, loss: 0.0067, instance_loss: 0.0842, weighted_loss: 0.0300, label: 0, bag_size: 515
batch 79, loss: 0.0152, instance_loss: 0.1042, weighted_loss: 0.0419, label: 4, bag_size: 790
batch 99, loss: 0.0545, instance_loss: 0.3553, weighted_loss: 0.1447, label: 4, bag_size: 1278
batch 119, loss: 0.9284, instance_loss: 0.4210, weighted_loss: 0.7762, label: 1, bag_size: 1724
batch 139, loss: 0.1409, instance_loss: 0.2339, weighted_loss: 0.1688, label: 0, bag_size: 1061
batch 159, loss: 0.0741, instance_loss: 0.1481, weighted_loss: 0.0963, label: 2, bag_size: 455
batch 179, loss: 2.9684, instance_loss: 0.7891, weighted_loss: 2.3146, label: 1, bag_size: 875
batch 199, loss: 0.0035, instance_loss: 0.0331, weighted_loss: 0.0124, label: 0, bag_size: 933
batch 219, loss: 0.0016, instance_loss: 0.0352, weighted_loss: 0.0117, label: 3, bag_size: 54
batch 239, loss: 0.0739, instance_loss: 0.1668, weighted_loss: 0.1018, label: 1, bag_size: 847
batch 259, loss: 0.0101, instance_loss: 0.0856, weighted_loss: 0.0328, label: 0, bag_size: 800
batch 279, loss: 0.3162, instance_loss: 0.3055, weighted_loss: 0.3130, label: 0, bag_size: 545
batch 299, loss: 0.0009, instance_loss: 0.1710, weighted_loss: 0.0519, label: 3, bag_size: 18
batch 319, loss: 0.0020, instance_loss: 0.2379, weighted_loss: 0.0727, label: 3, bag_size: 791
batch 339, loss: 1.1752, instance_loss: 0.4115, weighted_loss: 0.9461, label: 1, bag_size: 1096
batch 359, loss: 0.0051, instance_loss: 0.2481, weighted_loss: 0.0780, label: 3, bag_size: 34
batch 379, loss: 0.0002, instance_loss: 0.1111, weighted_loss: 0.0335, label: 3, bag_size: 32
batch 399, loss: 0.4582, instance_loss: 0.3620, weighted_loss: 0.4294, label: 1, bag_size: 1646
batch 419, loss: 0.0721, instance_loss: 0.2366, weighted_loss: 0.1215, label: 1, bag_size: 470
batch 439, loss: 0.0284, instance_loss: 0.1936, weighted_loss: 0.0780, label: 4, bag_size: 1002
batch 459, loss: 0.0969, instance_loss: 0.1925, weighted_loss: 0.1256, label: 1, bag_size: 504
batch 479, loss: 0.4326, instance_loss: 0.3440, weighted_loss: 0.4060, label: 1, bag_size: 139
batch 499, loss: 0.0883, instance_loss: 0.0791, weighted_loss: 0.0855, label: 1, bag_size: 682
batch 519, loss: 0.0000, instance_loss: 0.3075, weighted_loss: 0.0923, label: 4, bag_size: 1002
batch 539, loss: 0.1334, instance_loss: 0.4738, weighted_loss: 0.2355, label: 1, bag_size: 269


class 0 clustering acc 0.9890825688073395: correct 21562/21800
class 1 clustering acc 0.5158256880733945: correct 2249/4360
Epoch: 26, train_loss: 0.2528, train_clustering_loss:  0.2585, train_error: 0.1009
class 0: acc 0.9473684210526315, correct 90/95
class 1: acc 0.8174603174603174, correct 103/126
class 2: acc 0.7608695652173914, correct 70/92
class 3: acc 0.9652173913043478, correct 111/115
class 4: acc 0.9914529914529915, correct 116/117

Val Set, val_loss: 1.2583, val_error: 0.3200, auc: 0.8338
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.2975: correct 119/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.3260, instance_loss: 0.3436, weighted_loss: 0.3313, label: 2, bag_size: 324
batch 39, loss: 3.0620, instance_loss: 0.6832, weighted_loss: 2.3484, label: 3, bag_size: 1380
batch 59, loss: 0.0250, instance_loss: 0.1515, weighted_loss: 0.0629, label: 0, bag_size: 542
batch 79, loss: 0.0057, instance_loss: 0.0651, weighted_loss: 0.0235, label: 3, bag_size: 43
batch 99, loss: 0.0094, instance_loss: 0.1544, weighted_loss: 0.0529, label: 4, bag_size: 20
batch 119, loss: 0.2086, instance_loss: 0.2276, weighted_loss: 0.2143, label: 2, bag_size: 907
batch 139, loss: 0.0935, instance_loss: 0.2622, weighted_loss: 0.1441, label: 2, bag_size: 1053
batch 159, loss: 0.0549, instance_loss: 0.2705, weighted_loss: 0.1196, label: 1, bag_size: 242
batch 179, loss: 0.1030, instance_loss: 0.3169, weighted_loss: 0.1672, label: 2, bag_size: 614
batch 199, loss: 0.0036, instance_loss: 0.2162, weighted_loss: 0.0674, label: 3, bag_size: 16
batch 219, loss: 0.4995, instance_loss: 0.6823, weighted_loss: 0.5543, label: 2, bag_size: 110
batch 239, loss: 0.0033, instance_loss: 0.0804, weighted_loss: 0.0264, label: 3, bag_size: 29
batch 259, loss: 0.2481, instance_loss: 0.3966, weighted_loss: 0.2926, label: 2, bag_size: 471
batch 279, loss: 0.3795, instance_loss: 0.2614, weighted_loss: 0.3440, label: 1, bag_size: 913
batch 299, loss: 0.0010, instance_loss: 0.0439, weighted_loss: 0.0139, label: 4, bag_size: 160
batch 319, loss: 0.4405, instance_loss: 0.5761, weighted_loss: 0.4812, label: 1, bag_size: 786
batch 339, loss: 1.4655, instance_loss: 0.4840, weighted_loss: 1.1711, label: 0, bag_size: 1257
batch 359, loss: 0.0151, instance_loss: 0.0810, weighted_loss: 0.0349, label: 1, bag_size: 1402
batch 379, loss: 0.3462, instance_loss: 0.3257, weighted_loss: 0.3401, label: 2, bag_size: 1378
batch 399, loss: 0.2392, instance_loss: 0.4916, weighted_loss: 0.3149, label: 1, bag_size: 535
batch 419, loss: 0.2036, instance_loss: 0.2865, weighted_loss: 0.2285, label: 2, bag_size: 1024
batch 439, loss: 0.0548, instance_loss: 0.2833, weighted_loss: 0.1233, label: 2, bag_size: 571
batch 459, loss: 2.9838, instance_loss: 0.7573, weighted_loss: 2.3158, label: 1, bag_size: 875
batch 479, loss: 0.0023, instance_loss: 0.2524, weighted_loss: 0.0773, label: 3, bag_size: 18
batch 499, loss: 0.0127, instance_loss: 0.0889, weighted_loss: 0.0355, label: 0, bag_size: 1190
batch 519, loss: 0.0008, instance_loss: 0.2818, weighted_loss: 0.0851, label: 3, bag_size: 16
batch 539, loss: 0.0066, instance_loss: 0.0771, weighted_loss: 0.0277, label: 0, bag_size: 524


class 0 clustering acc 0.9888990825688073: correct 21558/21800
class 1 clustering acc 0.5029816513761468: correct 2193/4360
Epoch: 27, train_loss: 0.2253, train_clustering_loss:  0.2648, train_error: 0.0844
class 0: acc 0.9459459459459459, correct 105/111
class 1: acc 0.8671875, correct 111/128
class 2: acc 0.8240740740740741, correct 89/108
class 3: acc 0.9805825242718447, correct 101/103
class 4: acc 0.9789473684210527, correct 93/95

Val Set, val_loss: 1.2645, val_error: 0.3600, auc: 0.8378
class 0 clustering acc 0.972: correct 1944/2000
class 1 clustering acc 0.365: correct 146/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 21 out of 20


batch 19, loss: 2.3196, instance_loss: 0.5883, weighted_loss: 1.8002, label: 1, bag_size: 861
batch 39, loss: 1.4633, instance_loss: 0.6297, weighted_loss: 1.2132, label: 1, bag_size: 448
batch 59, loss: 0.0016, instance_loss: 0.0625, weighted_loss: 0.0199, label: 4, bag_size: 211
batch 79, loss: 0.3305, instance_loss: 0.3193, weighted_loss: 0.3271, label: 1, bag_size: 343
batch 99, loss: 0.0030, instance_loss: 0.1476, weighted_loss: 0.0464, label: 3, bag_size: 16
batch 119, loss: 0.0618, instance_loss: 0.4948, weighted_loss: 0.1917, label: 4, bag_size: 823
batch 139, loss: 0.0522, instance_loss: 0.2394, weighted_loss: 0.1083, label: 3, bag_size: 18
batch 159, loss: 0.0152, instance_loss: 0.1761, weighted_loss: 0.0635, label: 3, bag_size: 1253
batch 179, loss: 0.0317, instance_loss: 0.0672, weighted_loss: 0.0423, label: 3, bag_size: 451
batch 199, loss: 0.9060, instance_loss: 0.5463, weighted_loss: 0.7981, label: 1, bag_size: 139
batch 219, loss: 0.0002, instance_loss: 0.0489, weighted_loss: 0.0148, label: 4, bag_size: 157
batch 239, loss: 0.2036, instance_loss: 0.4216, weighted_loss: 0.2690, label: 1, bag_size: 913
batch 259, loss: 0.7360, instance_loss: 0.3558, weighted_loss: 0.6219, label: 0, bag_size: 912
batch 279, loss: 0.0006, instance_loss: 0.1261, weighted_loss: 0.0383, label: 4, bag_size: 26
batch 299, loss: 0.0023, instance_loss: 0.0694, weighted_loss: 0.0225, label: 0, bag_size: 1174
batch 319, loss: 0.3731, instance_loss: 0.2414, weighted_loss: 0.3336, label: 1, bag_size: 1080
batch 339, loss: 0.0226, instance_loss: 0.5626, weighted_loss: 0.1846, label: 1, bag_size: 1409
batch 359, loss: 0.0041, instance_loss: 0.0982, weighted_loss: 0.0323, label: 1, bag_size: 399
batch 379, loss: 0.3849, instance_loss: 0.2896, weighted_loss: 0.3563, label: 2, bag_size: 499
batch 399, loss: 0.0899, instance_loss: 0.3877, weighted_loss: 0.1792, label: 3, bag_size: 1118
batch 419, loss: 0.2243, instance_loss: 0.3903, weighted_loss: 0.2741, label: 2, bag_size: 1416
batch 439, loss: 0.4380, instance_loss: 0.5166, weighted_loss: 0.4616, label: 3, bag_size: 305
batch 459, loss: 2.0548, instance_loss: 0.6342, weighted_loss: 1.6287, label: 0, bag_size: 1527
batch 479, loss: 1.1436, instance_loss: 0.5580, weighted_loss: 0.9679, label: 2, bag_size: 345
batch 499, loss: 0.3243, instance_loss: 0.3110, weighted_loss: 0.3203, label: 0, bag_size: 381
batch 519, loss: 0.2997, instance_loss: 0.2960, weighted_loss: 0.2986, label: 2, bag_size: 684
batch 539, loss: 0.0325, instance_loss: 0.2582, weighted_loss: 0.1002, label: 2, bag_size: 1788


class 0 clustering acc 0.9863761467889908: correct 21503/21800
class 1 clustering acc 0.5029816513761468: correct 2193/4360
Epoch: 28, train_loss: 0.2255, train_clustering_loss:  0.2727, train_error: 0.0771
class 0: acc 0.9444444444444444, correct 85/90
class 1: acc 0.8256880733944955, correct 90/109
class 2: acc 0.865546218487395, correct 103/119
class 3: acc 0.9910714285714286, correct 111/112
class 4: acc 0.991304347826087, correct 114/115

Val Set, val_loss: 1.5370, val_error: 0.4200, auc: 0.8207
class 0 clustering acc 0.967: correct 1934/2000
class 1 clustering acc 0.33: correct 132/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.5, correct 10/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0040, instance_loss: 0.0585, weighted_loss: 0.0203, label: 0, bag_size: 921
batch 39, loss: 0.0363, instance_loss: 0.2843, weighted_loss: 0.1107, label: 2, bag_size: 204
batch 59, loss: 0.0829, instance_loss: 0.1828, weighted_loss: 0.1129, label: 2, bag_size: 270
batch 79, loss: 0.0860, instance_loss: 0.1657, weighted_loss: 0.1099, label: 1, bag_size: 690
batch 99, loss: 0.6057, instance_loss: 0.7557, weighted_loss: 0.6507, label: 1, bag_size: 660
batch 119, loss: 0.2908, instance_loss: 0.4957, weighted_loss: 0.3523, label: 0, bag_size: 801
batch 139, loss: 0.3836, instance_loss: 0.5714, weighted_loss: 0.4399, label: 1, bag_size: 917
batch 159, loss: 0.0032, instance_loss: 0.0870, weighted_loss: 0.0284, label: 3, bag_size: 19
batch 179, loss: 0.0032, instance_loss: 0.2616, weighted_loss: 0.0807, label: 3, bag_size: 20
batch 199, loss: 1.3685, instance_loss: 0.4636, weighted_loss: 1.0970, label: 1, bag_size: 1376
batch 219, loss: 0.0003, instance_loss: 0.1108, weighted_loss: 0.0335, label: 4, bag_size: 63
batch 239, loss: 0.1045, instance_loss: 0.2427, weighted_loss: 0.1459, label: 2, bag_size: 357
batch 259, loss: 0.4439, instance_loss: 0.3905, weighted_loss: 0.4278, label: 2, bag_size: 1259
batch 279, loss: 0.0750, instance_loss: 0.3510, weighted_loss: 0.1578, label: 3, bag_size: 841
batch 299, loss: 0.0381, instance_loss: 0.2682, weighted_loss: 0.1071, label: 4, bag_size: 23
batch 319, loss: 0.0025, instance_loss: 0.1719, weighted_loss: 0.0533, label: 3, bag_size: 18
batch 339, loss: 0.1708, instance_loss: 0.7924, weighted_loss: 0.3573, label: 4, bag_size: 882
batch 359, loss: 0.0006, instance_loss: 0.0830, weighted_loss: 0.0253, label: 3, bag_size: 37
batch 379, loss: 0.0019, instance_loss: 0.0401, weighted_loss: 0.0134, label: 4, bag_size: 202
batch 399, loss: 0.7119, instance_loss: 0.5242, weighted_loss: 0.6556, label: 2, bag_size: 1119
batch 419, loss: 0.0005, instance_loss: 0.0418, weighted_loss: 0.0129, label: 4, bag_size: 157
batch 439, loss: 0.0035, instance_loss: 0.0742, weighted_loss: 0.0247, label: 4, bag_size: 63
batch 459, loss: 0.0006, instance_loss: 0.0978, weighted_loss: 0.0298, label: 4, bag_size: 40
batch 479, loss: 0.0000, instance_loss: 0.0147, weighted_loss: 0.0044, label: 4, bag_size: 147
batch 499, loss: 0.0003, instance_loss: 0.1229, weighted_loss: 0.0371, label: 1, bag_size: 1376
batch 519, loss: 0.0131, instance_loss: 0.0832, weighted_loss: 0.0341, label: 4, bag_size: 636
batch 539, loss: 0.8621, instance_loss: 0.8036, weighted_loss: 0.8446, label: 2, bag_size: 916


class 0 clustering acc 0.9877522935779817: correct 21533/21800
class 1 clustering acc 0.4791284403669725: correct 2089/4360
Epoch: 29, train_loss: 0.2825, train_clustering_loss:  0.2782, train_error: 0.1064
class 0: acc 0.9183673469387755, correct 90/98
class 1: acc 0.8043478260869565, correct 74/92
class 2: acc 0.8267716535433071, correct 105/127
class 3: acc 0.9357798165137615, correct 102/109
class 4: acc 0.9747899159663865, correct 116/119

Val Set, val_loss: 1.2583, val_error: 0.3200, auc: 0.8538
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.3925: correct 157/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0969, weighted_loss: 0.0293, label: 4, bag_size: 30
batch 39, loss: 0.1401, instance_loss: 0.2280, weighted_loss: 0.1665, label: 1, bag_size: 696
batch 59, loss: 0.2229, instance_loss: 0.4001, weighted_loss: 0.2761, label: 2, bag_size: 1128
batch 79, loss: 0.1122, instance_loss: 0.4859, weighted_loss: 0.2243, label: 4, bag_size: 947
batch 99, loss: 0.4547, instance_loss: 0.2061, weighted_loss: 0.3802, label: 2, bag_size: 907
batch 119, loss: 0.0014, instance_loss: 0.0262, weighted_loss: 0.0088, label: 0, bag_size: 982
batch 139, loss: 0.1334, instance_loss: 0.2082, weighted_loss: 0.1558, label: 3, bag_size: 533
batch 159, loss: 0.4577, instance_loss: 0.3456, weighted_loss: 0.4240, label: 2, bag_size: 1133
batch 179, loss: 0.1034, instance_loss: 0.2490, weighted_loss: 0.1471, label: 0, bag_size: 424
batch 199, loss: 0.9417, instance_loss: 0.3487, weighted_loss: 0.7638, label: 1, bag_size: 1049
batch 219, loss: 0.0122, instance_loss: 0.1291, weighted_loss: 0.0473, label: 3, bag_size: 405
batch 239, loss: 0.0182, instance_loss: 0.2385, weighted_loss: 0.0843, label: 1, bag_size: 858
batch 259, loss: 0.0005, instance_loss: 0.0549, weighted_loss: 0.0168, label: 4, bag_size: 107
batch 279, loss: 0.0666, instance_loss: 0.3957, weighted_loss: 0.1653, label: 1, bag_size: 442
batch 299, loss: 0.0027, instance_loss: 0.0385, weighted_loss: 0.0135, label: 0, bag_size: 616
batch 319, loss: 0.0891, instance_loss: 0.2452, weighted_loss: 0.1360, label: 2, bag_size: 1569
batch 339, loss: 0.0024, instance_loss: 0.0644, weighted_loss: 0.0210, label: 0, bag_size: 518
batch 359, loss: 0.0040, instance_loss: 0.0956, weighted_loss: 0.0315, label: 4, bag_size: 162
batch 379, loss: 0.0004, instance_loss: 0.0635, weighted_loss: 0.0193, label: 4, bag_size: 130
batch 399, loss: 0.8227, instance_loss: 0.5571, weighted_loss: 0.7430, label: 2, bag_size: 803
batch 419, loss: 0.0078, instance_loss: 0.0951, weighted_loss: 0.0339, label: 1, bag_size: 828
batch 439, loss: 0.1249, instance_loss: 0.2645, weighted_loss: 0.1668, label: 0, bag_size: 962
batch 459, loss: 0.5346, instance_loss: 0.2990, weighted_loss: 0.4639, label: 4, bag_size: 1357
batch 479, loss: 0.0484, instance_loss: 0.2828, weighted_loss: 0.1187, label: 0, bag_size: 807
batch 499, loss: 0.1107, instance_loss: 0.2408, weighted_loss: 0.1497, label: 2, bag_size: 1569
batch 519, loss: 0.0010, instance_loss: 0.1426, weighted_loss: 0.0435, label: 4, bag_size: 24
batch 539, loss: 0.0012, instance_loss: 0.0565, weighted_loss: 0.0178, label: 4, bag_size: 40


class 0 clustering acc 0.9877981651376146: correct 21534/21800
class 1 clustering acc 0.49954128440366974: correct 2178/4360
Epoch: 30, train_loss: 0.2134, train_clustering_loss:  0.2689, train_error: 0.0697
class 0: acc 0.9568965517241379, correct 111/116
class 1: acc 0.8728813559322034, correct 103/118
class 2: acc 0.8738738738738738, correct 97/111
class 3: acc 0.9583333333333334, correct 92/96
class 4: acc 1.0, correct 104/104

Val Set, val_loss: 1.3116, val_error: 0.3200, auc: 0.8328
class 0 clustering acc 0.9705: correct 1941/2000
class 1 clustering acc 0.3675: correct 147/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1060, instance_loss: 0.2283, weighted_loss: 0.1427, label: 3, bag_size: 316
batch 39, loss: 0.0035, instance_loss: 0.0740, weighted_loss: 0.0247, label: 0, bag_size: 382
batch 59, loss: 0.0175, instance_loss: 0.6143, weighted_loss: 0.1966, label: 1, bag_size: 1409
batch 79, loss: 0.7096, instance_loss: 0.3115, weighted_loss: 0.5902, label: 2, bag_size: 1232
batch 99, loss: 0.0006, instance_loss: 0.1722, weighted_loss: 0.0520, label: 4, bag_size: 101
batch 119, loss: 0.1874, instance_loss: 0.2894, weighted_loss: 0.2180, label: 1, bag_size: 1559
batch 139, loss: 0.0017, instance_loss: 0.1804, weighted_loss: 0.0553, label: 4, bag_size: 23
batch 159, loss: 0.2846, instance_loss: 0.3649, weighted_loss: 0.3087, label: 2, bag_size: 508
batch 179, loss: 1.7293, instance_loss: 0.7376, weighted_loss: 1.4318, label: 2, bag_size: 1400
batch 199, loss: 1.1611, instance_loss: 0.6560, weighted_loss: 1.0095, label: 1, bag_size: 700
batch 219, loss: 0.0160, instance_loss: 0.0949, weighted_loss: 0.0397, label: 0, bag_size: 1517
batch 239, loss: 0.0002, instance_loss: 0.0840, weighted_loss: 0.0254, label: 4, bag_size: 140
batch 259, loss: 0.6088, instance_loss: 0.5805, weighted_loss: 0.6003, label: 3, bag_size: 305
batch 279, loss: 0.0048, instance_loss: 0.0839, weighted_loss: 0.0285, label: 3, bag_size: 123
batch 299, loss: 0.2072, instance_loss: 0.2317, weighted_loss: 0.2145, label: 0, bag_size: 371
batch 319, loss: 0.0533, instance_loss: 0.0993, weighted_loss: 0.0671, label: 1, bag_size: 886
batch 339, loss: 0.0028, instance_loss: 0.2111, weighted_loss: 0.0653, label: 4, bag_size: 134
batch 359, loss: 0.1601, instance_loss: 0.3083, weighted_loss: 0.2046, label: 2, bag_size: 542
batch 379, loss: 0.0040, instance_loss: 0.0564, weighted_loss: 0.0197, label: 0, bag_size: 518
batch 399, loss: 0.2920, instance_loss: 0.4245, weighted_loss: 0.3317, label: 4, bag_size: 1474
batch 419, loss: 0.2502, instance_loss: 0.3959, weighted_loss: 0.2939, label: 2, bag_size: 508
batch 439, loss: 0.0084, instance_loss: 0.1722, weighted_loss: 0.0575, label: 3, bag_size: 15
batch 459, loss: 0.0431, instance_loss: 0.2358, weighted_loss: 0.1009, label: 1, bag_size: 614
batch 479, loss: 0.0181, instance_loss: 0.1417, weighted_loss: 0.0552, label: 3, bag_size: 32
batch 499, loss: 0.0192, instance_loss: 0.0599, weighted_loss: 0.0314, label: 3, bag_size: 556
batch 519, loss: 0.0326, instance_loss: 0.2534, weighted_loss: 0.0989, label: 0, bag_size: 653
batch 539, loss: 0.0981, instance_loss: 0.3031, weighted_loss: 0.1596, label: 2, bag_size: 202


class 0 clustering acc 0.9861009174311927: correct 21497/21800
class 1 clustering acc 0.5096330275229358: correct 2222/4360
Epoch: 31, train_loss: 0.2189, train_clustering_loss:  0.2711, train_error: 0.0826
class 0: acc 0.9298245614035088, correct 106/114
class 1: acc 0.8660714285714286, correct 97/112
class 2: acc 0.8598130841121495, correct 92/107
class 3: acc 0.9532710280373832, correct 102/107
class 4: acc 0.9809523809523809, correct 103/105

Val Set, val_loss: 1.2106, val_error: 0.3200, auc: 0.8578
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.285: correct 114/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0041, instance_loss: 0.0756, weighted_loss: 0.0255, label: 3, bag_size: 37
batch 39, loss: 0.1523, instance_loss: 0.3266, weighted_loss: 0.2046, label: 3, bag_size: 697
batch 59, loss: 0.0048, instance_loss: 0.2487, weighted_loss: 0.0780, label: 0, bag_size: 163
batch 79, loss: 0.0968, instance_loss: 0.4762, weighted_loss: 0.2106, label: 1, bag_size: 786
batch 99, loss: 0.0022, instance_loss: 0.1047, weighted_loss: 0.0329, label: 4, bag_size: 711
batch 119, loss: 0.0011, instance_loss: 0.0528, weighted_loss: 0.0166, label: 0, bag_size: 982
batch 139, loss: 0.0304, instance_loss: 0.2326, weighted_loss: 0.0911, label: 2, bag_size: 314
batch 159, loss: 0.0312, instance_loss: 0.1713, weighted_loss: 0.0733, label: 1, bag_size: 470
batch 179, loss: 0.0033, instance_loss: 0.1670, weighted_loss: 0.0524, label: 0, bag_size: 524
batch 199, loss: 0.8779, instance_loss: 0.6251, weighted_loss: 0.8021, label: 1, bag_size: 700
batch 219, loss: 0.0006, instance_loss: 0.1212, weighted_loss: 0.0368, label: 3, bag_size: 18
batch 239, loss: 0.0292, instance_loss: 0.1264, weighted_loss: 0.0583, label: 0, bag_size: 542
batch 259, loss: 0.0212, instance_loss: 0.5004, weighted_loss: 0.1649, label: 3, bag_size: 706
batch 279, loss: 0.0789, instance_loss: 0.2500, weighted_loss: 0.1302, label: 2, bag_size: 499
batch 299, loss: 0.0144, instance_loss: 0.1296, weighted_loss: 0.0490, label: 3, bag_size: 78
batch 319, loss: 0.0027, instance_loss: 0.1828, weighted_loss: 0.0567, label: 3, bag_size: 18
batch 339, loss: 0.0021, instance_loss: 0.2969, weighted_loss: 0.0905, label: 4, bag_size: 24
batch 359, loss: 0.0007, instance_loss: 0.0508, weighted_loss: 0.0157, label: 4, bag_size: 48
batch 379, loss: 0.0105, instance_loss: 0.0307, weighted_loss: 0.0166, label: 1, bag_size: 937
batch 399, loss: 0.0234, instance_loss: 0.1077, weighted_loss: 0.0487, label: 1, bag_size: 690
batch 419, loss: 0.4676, instance_loss: 0.5363, weighted_loss: 0.4882, label: 1, bag_size: 867
batch 439, loss: 0.0230, instance_loss: 0.3056, weighted_loss: 0.1078, label: 0, bag_size: 116
batch 459, loss: 0.0101, instance_loss: 0.0971, weighted_loss: 0.0362, label: 3, bag_size: 405
batch 479, loss: 0.0194, instance_loss: 0.3052, weighted_loss: 0.1051, label: 0, bag_size: 807
batch 499, loss: 0.0165, instance_loss: 0.0591, weighted_loss: 0.0293, label: 1, bag_size: 1261
batch 519, loss: 1.1804, instance_loss: 0.6518, weighted_loss: 1.0218, label: 1, bag_size: 435
batch 539, loss: 0.0176, instance_loss: 0.4433, weighted_loss: 0.1453, label: 1, bag_size: 470


class 0 clustering acc 0.9877981651376146: correct 21534/21800
class 1 clustering acc 0.5298165137614679: correct 2310/4360
Epoch: 32, train_loss: 0.1788, train_clustering_loss:  0.2568, train_error: 0.0532
class 0: acc 0.979381443298969, correct 95/97
class 1: acc 0.8916666666666667, correct 107/120
class 2: acc 0.900990099009901, correct 91/101
class 3: acc 0.9761904761904762, correct 123/126
class 4: acc 0.9900990099009901, correct 100/101

Val Set, val_loss: 1.4486, val_error: 0.3200, auc: 0.8313
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.37: correct 148/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0962, instance_loss: 0.1695, weighted_loss: 0.1182, label: 3, bag_size: 316
batch 39, loss: 1.6747, instance_loss: 0.5603, weighted_loss: 1.3404, label: 3, bag_size: 281
batch 59, loss: 3.6643, instance_loss: 0.5460, weighted_loss: 2.7288, label: 2, bag_size: 1235
batch 79, loss: 0.3795, instance_loss: 0.5007, weighted_loss: 0.4159, label: 2, bag_size: 967
batch 99, loss: 0.0002, instance_loss: 0.1058, weighted_loss: 0.0319, label: 4, bag_size: 128
batch 119, loss: 0.3640, instance_loss: 0.4874, weighted_loss: 0.4010, label: 0, bag_size: 718
batch 139, loss: 0.0653, instance_loss: 0.1744, weighted_loss: 0.0980, label: 2, bag_size: 455
batch 159, loss: 0.0062, instance_loss: 0.2575, weighted_loss: 0.0816, label: 4, bag_size: 947
batch 179, loss: 0.0500, instance_loss: 0.3100, weighted_loss: 0.1280, label: 0, bag_size: 1135
batch 199, loss: 0.1307, instance_loss: 0.3269, weighted_loss: 0.1896, label: 2, bag_size: 1348
batch 219, loss: 0.0261, instance_loss: 0.0601, weighted_loss: 0.0363, label: 1, bag_size: 369
batch 239, loss: 0.0001, instance_loss: 0.0846, weighted_loss: 0.0254, label: 1, bag_size: 1376
batch 259, loss: 0.1062, instance_loss: 0.2168, weighted_loss: 0.1394, label: 2, bag_size: 270
batch 279, loss: 0.3689, instance_loss: 0.3273, weighted_loss: 0.3564, label: 2, bag_size: 1289
batch 299, loss: 1.0090, instance_loss: 0.4138, weighted_loss: 0.8304, label: 0, bag_size: 294
batch 319, loss: 0.0001, instance_loss: 0.2822, weighted_loss: 0.0847, label: 3, bag_size: 16
batch 339, loss: 0.0031, instance_loss: 0.2977, weighted_loss: 0.0915, label: 4, bag_size: 388
batch 359, loss: 0.0016, instance_loss: 0.0424, weighted_loss: 0.0139, label: 4, bag_size: 39
batch 379, loss: 0.0026, instance_loss: 0.1366, weighted_loss: 0.0428, label: 3, bag_size: 35
batch 399, loss: 0.0027, instance_loss: 0.0646, weighted_loss: 0.0213, label: 3, bag_size: 43
batch 419, loss: 1.0032, instance_loss: 0.6971, weighted_loss: 0.9114, label: 2, bag_size: 194
batch 439, loss: 0.0106, instance_loss: 0.3249, weighted_loss: 0.1049, label: 0, bag_size: 118
batch 459, loss: 0.0009, instance_loss: 0.1749, weighted_loss: 0.0531, label: 1, bag_size: 866
batch 479, loss: 0.0008, instance_loss: 0.1437, weighted_loss: 0.0437, label: 3, bag_size: 18
batch 499, loss: 0.4212, instance_loss: 0.5748, weighted_loss: 0.4673, label: 2, bag_size: 934
batch 519, loss: 0.0115, instance_loss: 0.1167, weighted_loss: 0.0430, label: 0, bag_size: 1235
batch 539, loss: 0.0041, instance_loss: 0.0663, weighted_loss: 0.0227, label: 4, bag_size: 143


class 0 clustering acc 0.9888073394495412: correct 21556/21800
class 1 clustering acc 0.5096330275229358: correct 2222/4360
Epoch: 33, train_loss: 0.2094, train_clustering_loss:  0.2663, train_error: 0.0679
class 0: acc 0.9603960396039604, correct 97/101
class 1: acc 0.8942307692307693, correct 93/104
class 2: acc 0.8461538461538461, correct 88/104
class 3: acc 0.9469026548672567, correct 107/113
class 4: acc 1.0, correct 123/123

Val Set, val_loss: 1.3122, val_error: 0.3400, auc: 0.8571
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.375: correct 150/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0009, instance_loss: 0.0905, weighted_loss: 0.0278, label: 4, bag_size: 114
batch 39, loss: 0.0001, instance_loss: 0.1391, weighted_loss: 0.0418, label: 3, bag_size: 21
batch 59, loss: 0.0226, instance_loss: 0.2163, weighted_loss: 0.0807, label: 0, bag_size: 432
batch 79, loss: 0.0431, instance_loss: 0.2716, weighted_loss: 0.1116, label: 3, bag_size: 1559
batch 99, loss: 0.0362, instance_loss: 0.4779, weighted_loss: 0.1687, label: 4, bag_size: 590
batch 119, loss: 0.2662, instance_loss: 0.2959, weighted_loss: 0.2751, label: 2, bag_size: 270
batch 139, loss: 0.0000, instance_loss: 0.0264, weighted_loss: 0.0079, label: 4, bag_size: 72
batch 159, loss: 0.0002, instance_loss: 0.1058, weighted_loss: 0.0319, label: 4, bag_size: 83
batch 179, loss: 0.2541, instance_loss: 0.4563, weighted_loss: 0.3148, label: 3, bag_size: 841
batch 199, loss: 0.0002, instance_loss: 0.0900, weighted_loss: 0.0271, label: 3, bag_size: 43
batch 219, loss: 0.0017, instance_loss: 0.0866, weighted_loss: 0.0272, label: 3, bag_size: 143
batch 239, loss: 1.0409, instance_loss: 0.5305, weighted_loss: 0.8878, label: 2, bag_size: 110
batch 259, loss: 0.0001, instance_loss: 0.0697, weighted_loss: 0.0210, label: 3, bag_size: 20
batch 279, loss: 0.0001, instance_loss: 0.0275, weighted_loss: 0.0083, label: 4, bag_size: 130
batch 299, loss: 0.0223, instance_loss: 0.1025, weighted_loss: 0.0463, label: 1, bag_size: 1086
batch 319, loss: 1.8355, instance_loss: 0.5401, weighted_loss: 1.4469, label: 1, bag_size: 139
batch 339, loss: 0.0103, instance_loss: 0.0972, weighted_loss: 0.0364, label: 4, bag_size: 1278
batch 359, loss: 0.1013, instance_loss: 0.3180, weighted_loss: 0.1663, label: 1, bag_size: 648
batch 379, loss: 0.0378, instance_loss: 0.2264, weighted_loss: 0.0944, label: 0, bag_size: 542
batch 399, loss: 0.0001, instance_loss: 0.0234, weighted_loss: 0.0071, label: 4, bag_size: 174
batch 419, loss: 0.0183, instance_loss: 0.1739, weighted_loss: 0.0650, label: 2, bag_size: 312
batch 439, loss: 0.0088, instance_loss: 0.5048, weighted_loss: 0.1576, label: 1, bag_size: 700
batch 459, loss: 0.0073, instance_loss: 0.1227, weighted_loss: 0.0419, label: 0, bag_size: 1190
batch 479, loss: 0.0006, instance_loss: 0.1731, weighted_loss: 0.0523, label: 1, bag_size: 1127
batch 499, loss: 0.0025, instance_loss: 0.0759, weighted_loss: 0.0245, label: 3, bag_size: 55
batch 519, loss: 0.0001, instance_loss: 0.0665, weighted_loss: 0.0201, label: 4, bag_size: 51
batch 539, loss: 0.0008, instance_loss: 0.1725, weighted_loss: 0.0523, label: 3, bag_size: 20


class 0 clustering acc 0.9877064220183486: correct 21532/21800
class 1 clustering acc 0.5584862385321101: correct 2435/4360
Epoch: 34, train_loss: 0.1995, train_clustering_loss:  0.2457, train_error: 0.0734
class 0: acc 0.9586776859504132, correct 116/121
class 1: acc 0.8222222222222222, correct 74/90
class 2: acc 0.8571428571428571, correct 90/105
class 3: acc 0.9727272727272728, correct 107/110
class 4: acc 0.9915966386554622, correct 118/119

Val Set, val_loss: 1.2403, val_error: 0.3200, auc: 0.8605
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.355: correct 142/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.4139, instance_loss: 0.3630, weighted_loss: 0.3986, label: 2, bag_size: 345
batch 39, loss: 0.4200, instance_loss: 0.2825, weighted_loss: 0.3788, label: 0, bag_size: 371
batch 59, loss: 0.0013, instance_loss: 0.1097, weighted_loss: 0.0338, label: 3, bag_size: 20
batch 79, loss: 0.0471, instance_loss: 0.0905, weighted_loss: 0.0601, label: 4, bag_size: 86
batch 99, loss: 0.0027, instance_loss: 0.1466, weighted_loss: 0.0459, label: 0, bag_size: 1255
batch 119, loss: 0.0002, instance_loss: 0.3515, weighted_loss: 0.1056, label: 3, bag_size: 16
batch 139, loss: 0.3628, instance_loss: 0.4072, weighted_loss: 0.3761, label: 0, bag_size: 1289
batch 159, loss: 0.0539, instance_loss: 0.2898, weighted_loss: 0.1247, label: 2, bag_size: 828
batch 179, loss: 0.0140, instance_loss: 0.1335, weighted_loss: 0.0498, label: 0, bag_size: 410
batch 199, loss: 0.0450, instance_loss: 0.7668, weighted_loss: 0.2615, label: 1, bag_size: 657
batch 219, loss: 0.1367, instance_loss: 0.1435, weighted_loss: 0.1387, label: 3, bag_size: 78
batch 239, loss: 0.0225, instance_loss: 0.1098, weighted_loss: 0.0487, label: 1, bag_size: 790
batch 259, loss: 0.0005, instance_loss: 0.0106, weighted_loss: 0.0035, label: 4, bag_size: 167
batch 279, loss: 0.0860, instance_loss: 0.2693, weighted_loss: 0.1410, label: 0, bag_size: 1061
batch 299, loss: 0.0650, instance_loss: 0.2281, weighted_loss: 0.1139, label: 2, bag_size: 777
batch 319, loss: 0.0004, instance_loss: 0.0125, weighted_loss: 0.0040, label: 4, bag_size: 192
batch 339, loss: 0.0111, instance_loss: 0.0987, weighted_loss: 0.0374, label: 0, bag_size: 1517
batch 359, loss: 0.0001, instance_loss: 0.1478, weighted_loss: 0.0444, label: 3, bag_size: 24
batch 379, loss: 0.0098, instance_loss: 0.2183, weighted_loss: 0.0724, label: 4, bag_size: 20
batch 399, loss: 0.4337, instance_loss: 0.5128, weighted_loss: 0.4574, label: 0, bag_size: 466
batch 419, loss: 0.0004, instance_loss: 0.1303, weighted_loss: 0.0394, label: 4, bag_size: 24
batch 439, loss: 0.0002, instance_loss: 0.1375, weighted_loss: 0.0414, label: 3, bag_size: 20
batch 459, loss: 0.0092, instance_loss: 0.2771, weighted_loss: 0.0896, label: 0, bag_size: 653
batch 479, loss: 0.0539, instance_loss: 0.2435, weighted_loss: 0.1108, label: 2, bag_size: 1164
batch 499, loss: 0.0364, instance_loss: 0.3013, weighted_loss: 0.1159, label: 0, bag_size: 1301
batch 519, loss: 0.0044, instance_loss: 0.1255, weighted_loss: 0.0407, label: 0, bag_size: 1190
batch 539, loss: 0.1040, instance_loss: 0.2930, weighted_loss: 0.1607, label: 2, bag_size: 684


class 0 clustering acc 0.9871559633027523: correct 21520/21800
class 1 clustering acc 0.5805045871559633: correct 2531/4360
Epoch: 35, train_loss: 0.1745, train_clustering_loss:  0.2425, train_error: 0.0569
class 0: acc 0.9911504424778761, correct 112/113
class 1: acc 0.8947368421052632, correct 85/95
class 2: acc 0.8861788617886179, correct 109/123
class 3: acc 0.9487179487179487, correct 111/117
class 4: acc 1.0, correct 97/97

Val Set, val_loss: 1.3492, val_error: 0.3200, auc: 0.8452
class 0 clustering acc 0.968: correct 1936/2000
class 1 clustering acc 0.4425: correct 177/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.1812, instance_loss: 0.4160, weighted_loss: 0.2516, label: 2, bag_size: 725
batch 39, loss: 0.0081, instance_loss: 0.0526, weighted_loss: 0.0215, label: 0, bag_size: 476
batch 59, loss: 0.0058, instance_loss: 0.1669, weighted_loss: 0.0541, label: 4, bag_size: 44
batch 79, loss: 0.0148, instance_loss: 0.1357, weighted_loss: 0.0511, label: 0, bag_size: 338
batch 99, loss: 0.0402, instance_loss: 0.2667, weighted_loss: 0.1082, label: 2, bag_size: 725
batch 119, loss: 0.0369, instance_loss: 0.4083, weighted_loss: 0.1483, label: 0, bag_size: 117
batch 139, loss: 0.0341, instance_loss: 0.4866, weighted_loss: 0.1699, label: 1, bag_size: 860
batch 159, loss: 0.0006, instance_loss: 0.1207, weighted_loss: 0.0366, label: 4, bag_size: 51
batch 179, loss: 0.0117, instance_loss: 0.2175, weighted_loss: 0.0735, label: 0, bag_size: 1332
batch 199, loss: 0.0016, instance_loss: 0.0816, weighted_loss: 0.0256, label: 4, bag_size: 125
batch 219, loss: 0.0085, instance_loss: 0.1331, weighted_loss: 0.0459, label: 0, bag_size: 338
batch 239, loss: 0.2312, instance_loss: 0.3036, weighted_loss: 0.2529, label: 0, bag_size: 381
batch 259, loss: 0.0010, instance_loss: 0.3248, weighted_loss: 0.0982, label: 3, bag_size: 18
batch 279, loss: 0.6885, instance_loss: 0.5365, weighted_loss: 0.6429, label: 0, bag_size: 423
batch 299, loss: 0.0005, instance_loss: 0.2244, weighted_loss: 0.0677, label: 3, bag_size: 16
batch 319, loss: 0.0343, instance_loss: 0.5024, weighted_loss: 0.1747, label: 4, bag_size: 974
batch 339, loss: 0.0052, instance_loss: 0.1495, weighted_loss: 0.0485, label: 4, bag_size: 711
batch 359, loss: 0.0007, instance_loss: 0.0292, weighted_loss: 0.0093, label: 4, bag_size: 130
batch 379, loss: 0.0079, instance_loss: 0.3660, weighted_loss: 0.1153, label: 4, bag_size: 656
batch 399, loss: 0.5026, instance_loss: 0.4806, weighted_loss: 0.4960, label: 1, bag_size: 377
batch 419, loss: 0.0043, instance_loss: 0.2885, weighted_loss: 0.0895, label: 0, bag_size: 114
batch 439, loss: 1.3990, instance_loss: 0.6597, weighted_loss: 1.1772, label: 2, bag_size: 411
batch 459, loss: 0.8398, instance_loss: 0.4762, weighted_loss: 0.7308, label: 0, bag_size: 962
batch 479, loss: 0.8932, instance_loss: 0.5552, weighted_loss: 0.7918, label: 1, bag_size: 936
batch 499, loss: 0.5628, instance_loss: 0.4367, weighted_loss: 0.5250, label: 2, bag_size: 1128
batch 519, loss: 0.3093, instance_loss: 0.4701, weighted_loss: 0.3575, label: 1, bag_size: 319
batch 539, loss: 0.1595, instance_loss: 0.3637, weighted_loss: 0.2208, label: 2, bag_size: 204


class 0 clustering acc 0.9846788990825688: correct 21466/21800
class 1 clustering acc 0.5555045871559633: correct 2422/4360
Epoch: 36, train_loss: 0.1672, train_clustering_loss:  0.2585, train_error: 0.0514
class 0: acc 0.9758064516129032, correct 121/124
class 1: acc 0.9009009009009009, correct 100/111
class 2: acc 0.865979381443299, correct 84/97
class 3: acc 0.99, correct 99/100
class 4: acc 1.0, correct 113/113

Val Set, val_loss: 1.4033, val_error: 0.3600, auc: 0.8443
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.325: correct 130/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0009, instance_loss: 0.0223, weighted_loss: 0.0073, label: 4, bag_size: 119
batch 39, loss: 0.0002, instance_loss: 0.0267, weighted_loss: 0.0081, label: 4, bag_size: 39
batch 59, loss: 0.0028, instance_loss: 0.0268, weighted_loss: 0.0100, label: 0, bag_size: 1235
batch 79, loss: 0.0382, instance_loss: 0.1931, weighted_loss: 0.0847, label: 0, bag_size: 432
batch 99, loss: 0.0397, instance_loss: 0.5223, weighted_loss: 0.1845, label: 3, bag_size: 706
batch 119, loss: 0.0088, instance_loss: 0.1939, weighted_loss: 0.0643, label: 3, bag_size: 952
batch 139, loss: 0.0076, instance_loss: 0.0652, weighted_loss: 0.0248, label: 0, bag_size: 1190
batch 159, loss: 0.0690, instance_loss: 0.3495, weighted_loss: 0.1532, label: 1, bag_size: 242
batch 179, loss: 0.1187, instance_loss: 0.3960, weighted_loss: 0.2019, label: 0, bag_size: 1289
batch 199, loss: 0.0030, instance_loss: 0.0965, weighted_loss: 0.0311, label: 3, bag_size: 78
batch 219, loss: 0.0091, instance_loss: 0.1558, weighted_loss: 0.0531, label: 3, bag_size: 18
batch 239, loss: 0.1019, instance_loss: 0.4149, weighted_loss: 0.1958, label: 1, bag_size: 860
batch 259, loss: 0.5524, instance_loss: 0.4108, weighted_loss: 0.5099, label: 2, bag_size: 943
batch 279, loss: 0.3656, instance_loss: 0.4196, weighted_loss: 0.3818, label: 2, bag_size: 356
batch 299, loss: 0.0575, instance_loss: 0.1671, weighted_loss: 0.0904, label: 2, bag_size: 317
batch 319, loss: 0.5655, instance_loss: 0.5369, weighted_loss: 0.5569, label: 0, bag_size: 868
batch 339, loss: 0.4095, instance_loss: 0.4309, weighted_loss: 0.4159, label: 2, bag_size: 409
batch 359, loss: 0.0106, instance_loss: 0.2290, weighted_loss: 0.0761, label: 1, bag_size: 1651
batch 379, loss: 0.2449, instance_loss: 0.2184, weighted_loss: 0.2369, label: 2, bag_size: 1569
batch 399, loss: 0.2608, instance_loss: 0.4054, weighted_loss: 0.3042, label: 2, bag_size: 1139
batch 419, loss: 0.2007, instance_loss: 0.4280, weighted_loss: 0.2689, label: 1, bag_size: 1080
batch 439, loss: 0.0734, instance_loss: 0.1165, weighted_loss: 0.0863, label: 1, bag_size: 847
batch 459, loss: 0.0118, instance_loss: 0.6470, weighted_loss: 0.2024, label: 3, bag_size: 706
batch 479, loss: 0.0608, instance_loss: 0.1696, weighted_loss: 0.0935, label: 0, bag_size: 294
batch 499, loss: 0.0041, instance_loss: 0.0821, weighted_loss: 0.0275, label: 4, bag_size: 1121
batch 519, loss: 0.0020, instance_loss: 0.1751, weighted_loss: 0.0539, label: 3, bag_size: 18
batch 539, loss: 0.1228, instance_loss: 0.2712, weighted_loss: 0.1673, label: 2, bag_size: 1133


class 0 clustering acc 0.9872018348623853: correct 21521/21800
class 1 clustering acc 0.5594036697247706: correct 2439/4360
Epoch: 37, train_loss: 0.1474, train_clustering_loss:  0.2467, train_error: 0.0440
class 0: acc 0.975, correct 117/120
class 1: acc 0.9142857142857143, correct 96/105
class 2: acc 0.9174311926605505, correct 100/109
class 3: acc 0.9732142857142857, correct 109/112
class 4: acc 1.0, correct 99/99

Val Set, val_loss: 1.3511, val_error: 0.3600, auc: 0.8520
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.3825: correct 153/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0268, instance_loss: 0.0789, weighted_loss: 0.0424, label: 4, bag_size: 137
batch 39, loss: 0.0009, instance_loss: 0.0942, weighted_loss: 0.0289, label: 4, bag_size: 174
batch 59, loss: 0.0794, instance_loss: 0.1546, weighted_loss: 0.1020, label: 2, bag_size: 455
batch 79, loss: 0.3177, instance_loss: 0.3663, weighted_loss: 0.3323, label: 0, bag_size: 437
batch 99, loss: 0.2222, instance_loss: 0.6255, weighted_loss: 0.3432, label: 4, bag_size: 511
batch 119, loss: 0.1275, instance_loss: 0.3433, weighted_loss: 0.1922, label: 2, bag_size: 1232
batch 139, loss: 0.0097, instance_loss: 0.3982, weighted_loss: 0.1263, label: 4, bag_size: 882
batch 159, loss: 0.0001, instance_loss: 0.0268, weighted_loss: 0.0081, label: 4, bag_size: 63
batch 179, loss: 0.0296, instance_loss: 0.2074, weighted_loss: 0.0829, label: 2, bag_size: 1289
batch 199, loss: 0.2006, instance_loss: 0.2318, weighted_loss: 0.2100, label: 0, bag_size: 868
batch 219, loss: 0.2465, instance_loss: 0.1674, weighted_loss: 0.2228, label: 2, bag_size: 907
batch 239, loss: 0.1252, instance_loss: 0.2680, weighted_loss: 0.1681, label: 2, bag_size: 1385
batch 259, loss: 0.0040, instance_loss: 0.0791, weighted_loss: 0.0265, label: 3, bag_size: 143
batch 279, loss: 0.0157, instance_loss: 0.2515, weighted_loss: 0.0864, label: 4, bag_size: 137
batch 299, loss: 0.0888, instance_loss: 0.2755, weighted_loss: 0.1448, label: 2, bag_size: 237
batch 319, loss: 0.7149, instance_loss: 0.6673, weighted_loss: 0.7006, label: 2, bag_size: 120
batch 339, loss: 0.0027, instance_loss: 0.0606, weighted_loss: 0.0201, label: 3, bag_size: 23
batch 359, loss: 0.3786, instance_loss: 0.5941, weighted_loss: 0.4432, label: 1, bag_size: 700
batch 379, loss: 0.1005, instance_loss: 0.3211, weighted_loss: 0.1667, label: 2, bag_size: 1215
batch 399, loss: 0.0009, instance_loss: 0.2934, weighted_loss: 0.0886, label: 4, bag_size: 24
batch 419, loss: 0.0884, instance_loss: 0.3763, weighted_loss: 0.1747, label: 0, bag_size: 1332
batch 439, loss: 0.0643, instance_loss: 0.2081, weighted_loss: 0.1075, label: 4, bag_size: 773
batch 459, loss: 0.0285, instance_loss: 0.0855, weighted_loss: 0.0456, label: 1, bag_size: 690
batch 479, loss: 0.0094, instance_loss: 0.2694, weighted_loss: 0.0874, label: 0, bag_size: 163
batch 499, loss: 0.0098, instance_loss: 0.0904, weighted_loss: 0.0340, label: 0, bag_size: 367
batch 519, loss: 0.2949, instance_loss: 0.3185, weighted_loss: 0.3020, label: 0, bag_size: 1190
batch 539, loss: 0.1536, instance_loss: 0.1902, weighted_loss: 0.1646, label: 3, bag_size: 533


class 0 clustering acc 0.9872018348623853: correct 21521/21800
class 1 clustering acc 0.5561926605504587: correct 2425/4360
Epoch: 38, train_loss: 0.1625, train_clustering_loss:  0.2484, train_error: 0.0550
class 0: acc 0.9615384615384616, correct 100/104
class 1: acc 0.9158878504672897, correct 98/107
class 2: acc 0.86, correct 86/100
class 3: acc 0.9761904761904762, correct 123/126
class 4: acc 1.0, correct 108/108

Val Set, val_loss: 1.4954, val_error: 0.3400, auc: 0.8439
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.355: correct 142/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0018, instance_loss: 0.0612, weighted_loss: 0.0196, label: 4, bag_size: 78
batch 39, loss: 0.1107, instance_loss: 0.1975, weighted_loss: 0.1367, label: 0, bag_size: 1257
batch 59, loss: 0.0045, instance_loss: 0.0594, weighted_loss: 0.0210, label: 3, bag_size: 35
batch 79, loss: 0.5777, instance_loss: 0.5127, weighted_loss: 0.5582, label: 3, bag_size: 305
batch 99, loss: 0.9554, instance_loss: 0.5482, weighted_loss: 0.8333, label: 2, bag_size: 1006
batch 119, loss: 0.0375, instance_loss: 0.2151, weighted_loss: 0.0908, label: 2, bag_size: 655
batch 139, loss: 0.1035, instance_loss: 0.6444, weighted_loss: 0.2658, label: 3, bag_size: 630
batch 159, loss: 0.0130, instance_loss: 0.2817, weighted_loss: 0.0936, label: 1, bag_size: 897
batch 179, loss: 0.0143, instance_loss: 0.0867, weighted_loss: 0.0360, label: 1, bag_size: 790
batch 199, loss: 0.1592, instance_loss: 0.5057, weighted_loss: 0.2631, label: 4, bag_size: 366
batch 219, loss: 0.0916, instance_loss: 0.1668, weighted_loss: 0.1141, label: 1, bag_size: 1144
batch 239, loss: 0.0004, instance_loss: 0.3183, weighted_loss: 0.0958, label: 4, bag_size: 388
batch 259, loss: 0.2686, instance_loss: 0.3843, weighted_loss: 0.3033, label: 2, bag_size: 1348
batch 279, loss: 0.0051, instance_loss: 0.1545, weighted_loss: 0.0499, label: 3, bag_size: 18
batch 299, loss: 0.0267, instance_loss: 0.4088, weighted_loss: 0.1413, label: 2, bag_size: 1231
batch 319, loss: 0.1510, instance_loss: 0.2211, weighted_loss: 0.1720, label: 2, bag_size: 846
batch 339, loss: 0.0021, instance_loss: 0.2145, weighted_loss: 0.0658, label: 1, bag_size: 890
batch 359, loss: 0.0011, instance_loss: 0.3100, weighted_loss: 0.0938, label: 1, bag_size: 399
batch 379, loss: 0.1858, instance_loss: 0.6315, weighted_loss: 0.3195, label: 2, bag_size: 679
batch 399, loss: 0.0002, instance_loss: 0.0710, weighted_loss: 0.0214, label: 3, bag_size: 33
batch 419, loss: 0.3705, instance_loss: 0.6472, weighted_loss: 0.4535, label: 1, bag_size: 1172
batch 439, loss: 0.0808, instance_loss: 0.1785, weighted_loss: 0.1101, label: 0, bag_size: 340
batch 459, loss: 0.0051, instance_loss: 0.2000, weighted_loss: 0.0636, label: 1, bag_size: 897
batch 479, loss: 0.0282, instance_loss: 0.4272, weighted_loss: 0.1479, label: 0, bag_size: 136
batch 499, loss: 0.0026, instance_loss: 0.0766, weighted_loss: 0.0248, label: 0, bag_size: 1255
batch 519, loss: 0.0068, instance_loss: 0.6298, weighted_loss: 0.1937, label: 4, bag_size: 882
batch 539, loss: 0.0671, instance_loss: 0.5300, weighted_loss: 0.2060, label: 2, bag_size: 732


class 0 clustering acc 0.9852293577981651: correct 21478/21800
class 1 clustering acc 0.5135321100917432: correct 2239/4360
Epoch: 39, train_loss: 0.1641, train_clustering_loss:  0.2705, train_error: 0.0477
class 0: acc 0.9611650485436893, correct 99/103
class 1: acc 0.9112903225806451, correct 113/124
class 2: acc 0.9272727272727272, correct 102/110
class 3: acc 0.9814814814814815, correct 106/108
class 4: acc 0.99, correct 99/100

Val Set, val_loss: 1.3935, val_error: 0.3600, auc: 0.8413
class 0 clustering acc 0.974: correct 1948/2000
class 1 clustering acc 0.335: correct 134/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0038, instance_loss: 0.1048, weighted_loss: 0.0341, label: 4, bag_size: 24
batch 39, loss: 0.0022, instance_loss: 0.0771, weighted_loss: 0.0247, label: 4, bag_size: 143
batch 59, loss: 0.0001, instance_loss: 0.1392, weighted_loss: 0.0418, label: 3, bag_size: 105
batch 79, loss: 0.0402, instance_loss: 0.9611, weighted_loss: 0.3165, label: 1, bag_size: 657
batch 99, loss: 0.0033, instance_loss: 0.0443, weighted_loss: 0.0156, label: 0, bag_size: 476
batch 119, loss: 0.0042, instance_loss: 0.1434, weighted_loss: 0.0459, label: 3, bag_size: 31
batch 139, loss: 0.1019, instance_loss: 0.3049, weighted_loss: 0.1628, label: 1, bag_size: 1144
batch 159, loss: 0.5679, instance_loss: 0.6443, weighted_loss: 0.5908, label: 2, bag_size: 679
batch 179, loss: 0.1159, instance_loss: 0.5271, weighted_loss: 0.2393, label: 4, bag_size: 928
batch 199, loss: 0.0003, instance_loss: 0.1250, weighted_loss: 0.0377, label: 3, bag_size: 53
batch 219, loss: 0.1116, instance_loss: 0.2149, weighted_loss: 0.1426, label: 2, bag_size: 2081
batch 239, loss: 0.0506, instance_loss: 0.3076, weighted_loss: 0.1277, label: 1, bag_size: 867
batch 259, loss: 0.0002, instance_loss: 0.0387, weighted_loss: 0.0117, label: 4, bag_size: 182
batch 279, loss: 0.2713, instance_loss: 0.3216, weighted_loss: 0.2864, label: 2, bag_size: 621
batch 299, loss: 0.5903, instance_loss: 0.2261, weighted_loss: 0.4810, label: 2, bag_size: 907
batch 319, loss: 0.1483, instance_loss: 0.3544, weighted_loss: 0.2101, label: 0, bag_size: 962
batch 339, loss: 0.0822, instance_loss: 0.3743, weighted_loss: 0.1698, label: 4, bag_size: 947
batch 359, loss: 0.0031, instance_loss: 0.0406, weighted_loss: 0.0144, label: 4, bag_size: 160
batch 379, loss: 0.8148, instance_loss: 0.6034, weighted_loss: 0.7514, label: 2, bag_size: 194
batch 399, loss: 0.0162, instance_loss: 0.1520, weighted_loss: 0.0569, label: 4, bag_size: 60
batch 419, loss: 0.0061, instance_loss: 0.1614, weighted_loss: 0.0527, label: 4, bag_size: 168
batch 439, loss: 0.0087, instance_loss: 0.1668, weighted_loss: 0.0561, label: 4, bag_size: 55
batch 459, loss: 0.0109, instance_loss: 0.0712, weighted_loss: 0.0289, label: 0, bag_size: 1235
batch 479, loss: 0.0655, instance_loss: 0.1647, weighted_loss: 0.0952, label: 2, bag_size: 935
batch 499, loss: 0.0018, instance_loss: 0.1013, weighted_loss: 0.0316, label: 4, bag_size: 140
batch 519, loss: 0.0147, instance_loss: 0.3063, weighted_loss: 0.1022, label: 1, bag_size: 530
batch 539, loss: 0.0049, instance_loss: 0.1374, weighted_loss: 0.0447, label: 0, bag_size: 1196


class 0 clustering acc 0.9860550458715597: correct 21496/21800
class 1 clustering acc 0.5325688073394496: correct 2322/4360
Epoch: 40, train_loss: 0.2039, train_clustering_loss:  0.2659, train_error: 0.0661
class 0: acc 0.9484536082474226, correct 92/97
class 1: acc 0.8867924528301887, correct 94/106
class 2: acc 0.8771929824561403, correct 100/114
class 3: acc 0.9649122807017544, correct 110/114
class 4: acc 0.9912280701754386, correct 113/114

Val Set, val_loss: 1.3533, val_error: 0.3600, auc: 0.8580
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.2975: correct 119/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0001, instance_loss: 0.2872, weighted_loss: 0.0862, label: 4, bag_size: 388
batch 39, loss: 0.0128, instance_loss: 0.0585, weighted_loss: 0.0265, label: 3, bag_size: 1172
batch 59, loss: 0.0827, instance_loss: 0.3138, weighted_loss: 0.1520, label: 0, bag_size: 109
batch 79, loss: 0.0722, instance_loss: 0.5759, weighted_loss: 0.2233, label: 4, bag_size: 366
batch 99, loss: 0.0048, instance_loss: 0.2056, weighted_loss: 0.0650, label: 3, bag_size: 18
batch 119, loss: 0.0101, instance_loss: 0.2270, weighted_loss: 0.0752, label: 3, bag_size: 78
batch 139, loss: 0.0618, instance_loss: 0.5283, weighted_loss: 0.2017, label: 1, bag_size: 786
batch 159, loss: 0.1292, instance_loss: 0.2541, weighted_loss: 0.1667, label: 2, bag_size: 537
batch 179, loss: 0.1216, instance_loss: 0.2427, weighted_loss: 0.1579, label: 1, bag_size: 898
batch 199, loss: 0.0008, instance_loss: 0.1269, weighted_loss: 0.0387, label: 3, bag_size: 55
batch 219, loss: 0.0368, instance_loss: 0.3931, weighted_loss: 0.1437, label: 1, bag_size: 242
batch 239, loss: 0.0314, instance_loss: 0.5074, weighted_loss: 0.1742, label: 0, bag_size: 109
batch 259, loss: 0.0048, instance_loss: 0.0881, weighted_loss: 0.0298, label: 0, bag_size: 616
batch 279, loss: 0.0022, instance_loss: 0.1062, weighted_loss: 0.0334, label: 3, bag_size: 18
batch 299, loss: 0.0007, instance_loss: 0.0918, weighted_loss: 0.0280, label: 3, bag_size: 15
batch 319, loss: 1.5898, instance_loss: 0.5542, weighted_loss: 1.2792, label: 1, bag_size: 1390
batch 339, loss: 0.5063, instance_loss: 0.3977, weighted_loss: 0.4737, label: 2, bag_size: 1141
batch 359, loss: 0.2208, instance_loss: 0.2662, weighted_loss: 0.2344, label: 2, bag_size: 351
batch 379, loss: 0.4188, instance_loss: 0.6201, weighted_loss: 0.4792, label: 2, bag_size: 655
batch 399, loss: 0.0003, instance_loss: 0.0816, weighted_loss: 0.0247, label: 4, bag_size: 20
batch 419, loss: 0.1540, instance_loss: 0.3029, weighted_loss: 0.1986, label: 2, bag_size: 351
batch 439, loss: 0.1220, instance_loss: 0.1887, weighted_loss: 0.1420, label: 0, bag_size: 990
batch 459, loss: 0.0027, instance_loss: 0.0394, weighted_loss: 0.0137, label: 0, bag_size: 515
batch 479, loss: 0.0007, instance_loss: 0.0655, weighted_loss: 0.0202, label: 4, bag_size: 78
batch 499, loss: 0.0002, instance_loss: 0.1164, weighted_loss: 0.0351, label: 3, bag_size: 56
batch 519, loss: 1.9739, instance_loss: 0.9576, weighted_loss: 1.6690, label: 2, bag_size: 911
batch 539, loss: 0.3284, instance_loss: 0.4534, weighted_loss: 0.3659, label: 1, bag_size: 139


class 0 clustering acc 0.9872935779816514: correct 21523/21800
class 1 clustering acc 0.5126146788990825: correct 2235/4360
Epoch: 41, train_loss: 0.1697, train_clustering_loss:  0.2615, train_error: 0.0642
class 0: acc 0.9702970297029703, correct 98/101
class 1: acc 0.8584070796460177, correct 97/113
class 2: acc 0.8782608695652174, correct 101/115
class 3: acc 0.9910714285714286, correct 111/112
class 4: acc 0.9903846153846154, correct 103/104

Val Set, val_loss: 1.3338, val_error: 0.3400, auc: 0.8444
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.35: correct 140/400
class 0: acc 0.6, correct 3/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0366, weighted_loss: 0.0110, label: 4, bag_size: 110
batch 39, loss: 0.6333, instance_loss: 0.3820, weighted_loss: 0.5579, label: 0, bag_size: 1257
batch 59, loss: 0.1272, instance_loss: 0.3218, weighted_loss: 0.1856, label: 2, bag_size: 883
batch 79, loss: 0.0053, instance_loss: 0.4364, weighted_loss: 0.1346, label: 3, bag_size: 791
batch 99, loss: 0.1673, instance_loss: 0.2836, weighted_loss: 0.2022, label: 2, bag_size: 839
batch 119, loss: 0.0104, instance_loss: 0.1662, weighted_loss: 0.0571, label: 1, bag_size: 534
batch 139, loss: 0.0218, instance_loss: 0.5884, weighted_loss: 0.1918, label: 4, bag_size: 663
batch 159, loss: 0.1167, instance_loss: 0.4022, weighted_loss: 0.2023, label: 2, bag_size: 307
batch 179, loss: 0.3764, instance_loss: 0.2130, weighted_loss: 0.3274, label: 0, bag_size: 1061
batch 199, loss: 0.0061, instance_loss: 0.3426, weighted_loss: 0.1071, label: 2, bag_size: 784
batch 219, loss: 0.0014, instance_loss: 0.0430, weighted_loss: 0.0139, label: 0, bag_size: 518
batch 239, loss: 0.4336, instance_loss: 0.5057, weighted_loss: 0.4552, label: 2, bag_size: 194
batch 259, loss: 0.0442, instance_loss: 0.5845, weighted_loss: 0.2063, label: 3, bag_size: 1250
batch 279, loss: 0.4149, instance_loss: 0.2325, weighted_loss: 0.3602, label: 0, bag_size: 1061
batch 299, loss: 0.0330, instance_loss: 0.2922, weighted_loss: 0.1107, label: 2, bag_size: 542
batch 319, loss: 0.4070, instance_loss: 0.2807, weighted_loss: 0.3691, label: 0, bag_size: 120
batch 339, loss: 0.1482, instance_loss: 0.4505, weighted_loss: 0.2388, label: 2, bag_size: 1400
batch 359, loss: 0.0601, instance_loss: 0.3925, weighted_loss: 0.1598, label: 1, bag_size: 102
batch 379, loss: 0.4033, instance_loss: 0.3851, weighted_loss: 0.3978, label: 1, bag_size: 1646
batch 399, loss: 0.8349, instance_loss: 0.8480, weighted_loss: 0.8388, label: 1, bag_size: 651
batch 419, loss: 0.8074, instance_loss: 0.4196, weighted_loss: 0.6910, label: 1, bag_size: 1049
batch 439, loss: 0.0010, instance_loss: 0.1343, weighted_loss: 0.0410, label: 4, bag_size: 636
batch 459, loss: 0.0055, instance_loss: 0.1035, weighted_loss: 0.0349, label: 0, bag_size: 155
batch 479, loss: 0.0008, instance_loss: 0.0316, weighted_loss: 0.0100, label: 4, bag_size: 168
batch 499, loss: 0.0613, instance_loss: 0.2783, weighted_loss: 0.1264, label: 3, bag_size: 1019
batch 519, loss: 0.0000, instance_loss: 0.0465, weighted_loss: 0.0140, label: 4, bag_size: 157
batch 539, loss: 0.1290, instance_loss: 0.2489, weighted_loss: 0.1650, label: 2, bag_size: 1232


class 0 clustering acc 0.9861926605504587: correct 21499/21800
class 1 clustering acc 0.5447247706422018: correct 2375/4360
Epoch: 42, train_loss: 0.1515, train_clustering_loss:  0.2555, train_error: 0.0495
class 0: acc 0.9693877551020408, correct 95/98
class 1: acc 0.8865979381443299, correct 86/97
class 2: acc 0.9153846153846154, correct 119/130
class 3: acc 0.9823008849557522, correct 111/113
class 4: acc 1.0, correct 107/107

Val Set, val_loss: 1.5647, val_error: 0.3600, auc: 0.8452
class 0 clustering acc 0.966: correct 1932/2000
class 1 clustering acc 0.415: correct 166/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0578, instance_loss: 0.2148, weighted_loss: 0.1049, label: 2, bag_size: 636
batch 39, loss: 0.0659, instance_loss: 0.1661, weighted_loss: 0.0960, label: 2, bag_size: 1006
batch 59, loss: 0.0557, instance_loss: 0.2993, weighted_loss: 0.1288, label: 1, bag_size: 470
batch 79, loss: 0.0085, instance_loss: 0.1537, weighted_loss: 0.0520, label: 2, bag_size: 1281
batch 99, loss: 0.0283, instance_loss: 0.3049, weighted_loss: 0.1113, label: 4, bag_size: 675
batch 119, loss: 0.0012, instance_loss: 0.0257, weighted_loss: 0.0085, label: 0, bag_size: 1872
batch 139, loss: 0.0070, instance_loss: 0.3612, weighted_loss: 0.1133, label: 3, bag_size: 18
batch 159, loss: 0.0250, instance_loss: 0.1847, weighted_loss: 0.0729, label: 1, bag_size: 598
batch 179, loss: 0.0852, instance_loss: 0.7275, weighted_loss: 0.2779, label: 1, bag_size: 700
batch 199, loss: 0.6038, instance_loss: 0.4033, weighted_loss: 0.5437, label: 2, bag_size: 1133
batch 219, loss: 0.2651, instance_loss: 0.2989, weighted_loss: 0.2752, label: 2, bag_size: 271
batch 239, loss: 0.0017, instance_loss: 0.0256, weighted_loss: 0.0088, label: 3, bag_size: 305
batch 259, loss: 0.0006, instance_loss: 0.0876, weighted_loss: 0.0267, label: 3, bag_size: 16
batch 279, loss: 0.0701, instance_loss: 0.3072, weighted_loss: 0.1412, label: 2, bag_size: 839
batch 299, loss: 0.0838, instance_loss: 0.2225, weighted_loss: 0.1254, label: 2, bag_size: 1006
batch 319, loss: 0.0474, instance_loss: 0.2704, weighted_loss: 0.1143, label: 3, bag_size: 697
batch 339, loss: 0.0012, instance_loss: 0.1154, weighted_loss: 0.0355, label: 3, bag_size: 33
batch 359, loss: 0.0090, instance_loss: 0.1462, weighted_loss: 0.0502, label: 3, bag_size: 952
batch 379, loss: 0.0508, instance_loss: 0.1125, weighted_loss: 0.0693, label: 4, bag_size: 86
batch 399, loss: 1.3376, instance_loss: 0.5244, weighted_loss: 1.0937, label: 1, bag_size: 875
batch 419, loss: 0.0166, instance_loss: 0.2475, weighted_loss: 0.0859, label: 0, bag_size: 367
batch 439, loss: 0.0024, instance_loss: 0.3588, weighted_loss: 0.1093, label: 1, bag_size: 897
batch 459, loss: 0.0115, instance_loss: 0.1642, weighted_loss: 0.0573, label: 2, bag_size: 461
batch 479, loss: 0.0044, instance_loss: 0.2062, weighted_loss: 0.0649, label: 2, bag_size: 317
batch 499, loss: 0.0010, instance_loss: 0.0411, weighted_loss: 0.0130, label: 0, bag_size: 933
batch 519, loss: 0.0037, instance_loss: 0.2166, weighted_loss: 0.0676, label: 3, bag_size: 18
batch 539, loss: 0.0000, instance_loss: 0.1334, weighted_loss: 0.0401, label: 4, bag_size: 128


class 0 clustering acc 0.9859633027522936: correct 21494/21800
class 1 clustering acc 0.5612385321100918: correct 2447/4360
Epoch: 43, train_loss: 0.1428, train_clustering_loss:  0.2502, train_error: 0.0477
class 0: acc 0.9821428571428571, correct 110/112
class 1: acc 0.9196428571428571, correct 103/112
class 2: acc 0.9196428571428571, correct 103/112
class 3: acc 0.9444444444444444, correct 102/108
class 4: acc 1.0, correct 101/101

Val Set, val_loss: 1.4375, val_error: 0.3800, auc: 0.8381
class 0 clustering acc 0.965: correct 1930/2000
class 1 clustering acc 0.4125: correct 165/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.6, correct 12/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.0028, instance_loss: 0.0783, weighted_loss: 0.0255, label: 4, bag_size: 26
batch 39, loss: 0.0004, instance_loss: 0.1996, weighted_loss: 0.0602, label: 3, bag_size: 20
batch 59, loss: 0.0029, instance_loss: 0.2046, weighted_loss: 0.0634, label: 0, bag_size: 129
batch 79, loss: 0.1882, instance_loss: 0.1129, weighted_loss: 0.1656, label: 4, bag_size: 43
batch 99, loss: 0.7731, instance_loss: 0.4377, weighted_loss: 0.6725, label: 1, bag_size: 1096
batch 119, loss: 1.0747, instance_loss: 0.5525, weighted_loss: 0.9180, label: 0, bag_size: 109
batch 139, loss: 0.0007, instance_loss: 0.0524, weighted_loss: 0.0162, label: 0, bag_size: 360
batch 159, loss: 0.0013, instance_loss: 0.1613, weighted_loss: 0.0493, label: 0, bag_size: 976
batch 179, loss: 0.0880, instance_loss: 0.2058, weighted_loss: 0.1234, label: 2, bag_size: 1404
batch 199, loss: 0.3771, instance_loss: 0.3543, weighted_loss: 0.3703, label: 2, bag_size: 345
batch 219, loss: 0.0029, instance_loss: 0.5243, weighted_loss: 0.1594, label: 4, bag_size: 656
batch 239, loss: 0.1849, instance_loss: 0.3825, weighted_loss: 0.2441, label: 1, bag_size: 1080
batch 259, loss: 0.0033, instance_loss: 0.0920, weighted_loss: 0.0299, label: 3, bag_size: 78
batch 279, loss: 0.0411, instance_loss: 0.2610, weighted_loss: 0.1071, label: 1, bag_size: 867
batch 299, loss: 0.0004, instance_loss: 0.1194, weighted_loss: 0.0361, label: 1, bag_size: 890
batch 319, loss: 0.3987, instance_loss: 0.4595, weighted_loss: 0.4169, label: 3, bag_size: 281
batch 339, loss: 0.0565, instance_loss: 0.3902, weighted_loss: 0.1566, label: 1, bag_size: 913
batch 359, loss: 0.0001, instance_loss: 0.0456, weighted_loss: 0.0138, label: 3, bag_size: 37
batch 379, loss: 0.0137, instance_loss: 0.2131, weighted_loss: 0.0735, label: 3, bag_size: 1253
batch 399, loss: 0.0158, instance_loss: 0.5374, weighted_loss: 0.1723, label: 4, bag_size: 656
batch 419, loss: 0.0079, instance_loss: 0.0405, weighted_loss: 0.0177, label: 3, bag_size: 97
batch 439, loss: 0.0031, instance_loss: 0.2051, weighted_loss: 0.0637, label: 3, bag_size: 15
batch 459, loss: 0.1993, instance_loss: 0.3405, weighted_loss: 0.2417, label: 2, bag_size: 252
batch 479, loss: 0.0024, instance_loss: 0.2338, weighted_loss: 0.0718, label: 1, bag_size: 858
batch 499, loss: 0.0002, instance_loss: 0.0222, weighted_loss: 0.0068, label: 0, bag_size: 360
batch 519, loss: 0.0004, instance_loss: 0.0192, weighted_loss: 0.0060, label: 0, bag_size: 239
batch 539, loss: 0.0401, instance_loss: 0.1056, weighted_loss: 0.0597, label: 1, bag_size: 886


class 0 clustering acc 0.9879816513761468: correct 21538/21800
class 1 clustering acc 0.5674311926605504: correct 2474/4360
Epoch: 44, train_loss: 0.1251, train_clustering_loss:  0.2442, train_error: 0.0404
class 0: acc 0.967479674796748, correct 119/123
class 1: acc 0.911504424778761, correct 103/113
class 2: acc 0.9411764705882353, correct 96/102
class 3: acc 0.9829059829059829, correct 115/117
class 4: acc 1.0, correct 90/90

Val Set, val_loss: 1.5176, val_error: 0.3600, auc: 0.8404
class 0 clustering acc 0.9665: correct 1933/2000
class 1 clustering acc 0.3925: correct 157/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 38 out of 20


batch 19, loss: 2.3336, instance_loss: 0.5442, weighted_loss: 1.7968, label: 1, bag_size: 868
batch 39, loss: 0.4196, instance_loss: 0.5998, weighted_loss: 0.4736, label: 2, bag_size: 720
batch 59, loss: 0.0312, instance_loss: 0.2647, weighted_loss: 0.1013, label: 2, bag_size: 2703
batch 79, loss: 0.0038, instance_loss: 0.1961, weighted_loss: 0.0615, label: 0, bag_size: 155
batch 99, loss: 0.1152, instance_loss: 0.1500, weighted_loss: 0.1256, label: 1, bag_size: 945
batch 119, loss: 0.0010, instance_loss: 0.0209, weighted_loss: 0.0070, label: 3, bag_size: 54
batch 139, loss: 0.0101, instance_loss: 0.2052, weighted_loss: 0.0686, label: 0, bag_size: 1332
batch 159, loss: 0.0211, instance_loss: 0.4001, weighted_loss: 0.1348, label: 2, bag_size: 373
batch 179, loss: 0.0020, instance_loss: 0.3105, weighted_loss: 0.0946, label: 1, bag_size: 897
batch 199, loss: 0.0161, instance_loss: 0.6137, weighted_loss: 0.1954, label: 1, bag_size: 470
batch 219, loss: 0.1925, instance_loss: 0.5214, weighted_loss: 0.2912, label: 1, bag_size: 936
batch 239, loss: 0.0007, instance_loss: 0.0227, weighted_loss: 0.0073, label: 0, bag_size: 402
batch 259, loss: 0.0008, instance_loss: 0.1332, weighted_loss: 0.0405, label: 3, bag_size: 34
batch 279, loss: 0.0009, instance_loss: 0.1150, weighted_loss: 0.0351, label: 0, bag_size: 148
batch 299, loss: 0.0002, instance_loss: 0.0343, weighted_loss: 0.0105, label: 3, bag_size: 33
batch 319, loss: 0.0046, instance_loss: 0.0559, weighted_loss: 0.0200, label: 4, bag_size: 137
batch 339, loss: 0.5012, instance_loss: 0.3377, weighted_loss: 0.4521, label: 2, bag_size: 1133
batch 359, loss: 0.4375, instance_loss: 0.5428, weighted_loss: 0.4690, label: 2, bag_size: 948
batch 379, loss: 0.0034, instance_loss: 0.0369, weighted_loss: 0.0135, label: 1, bag_size: 346
batch 399, loss: 0.0038, instance_loss: 0.2012, weighted_loss: 0.0630, label: 0, bag_size: 1086
batch 419, loss: 0.0561, instance_loss: 0.7199, weighted_loss: 0.2552, label: 1, bag_size: 1273
batch 439, loss: 0.1450, instance_loss: 0.6026, weighted_loss: 0.2823, label: 2, bag_size: 655
batch 459, loss: 0.0029, instance_loss: 0.0828, weighted_loss: 0.0268, label: 0, bag_size: 367
batch 479, loss: 0.0001, instance_loss: 0.0401, weighted_loss: 0.0121, label: 3, bag_size: 105
batch 499, loss: 0.4352, instance_loss: 0.2961, weighted_loss: 0.3934, label: 1, bag_size: 348
batch 519, loss: 0.0029, instance_loss: 0.0617, weighted_loss: 0.0206, label: 0, bag_size: 1143
batch 539, loss: 0.0110, instance_loss: 0.2986, weighted_loss: 0.0973, label: 3, bag_size: 17


class 0 clustering acc 0.9871559633027523: correct 21520/21800
class 1 clustering acc 0.5853211009174312: correct 2552/4360
Epoch: 45, train_loss: 0.0934, train_clustering_loss:  0.2341, train_error: 0.0220
class 0: acc 1.0, correct 101/101
class 1: acc 0.9464285714285714, correct 106/112
class 2: acc 0.9705882352941176, correct 99/102
class 3: acc 0.975, correct 117/120
class 4: acc 1.0, correct 110/110

Val Set, val_loss: 1.4502, val_error: 0.2800, auc: 0.8540
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.405: correct 162/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.8, correct 16/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0172, instance_loss: 0.2403, weighted_loss: 0.0841, label: 0, bag_size: 371
batch 39, loss: 0.8945, instance_loss: 0.5221, weighted_loss: 0.7828, label: 2, bag_size: 948
batch 59, loss: 0.0192, instance_loss: 0.4761, weighted_loss: 0.1563, label: 3, bag_size: 230
batch 79, loss: 0.0001, instance_loss: 0.1257, weighted_loss: 0.0378, label: 4, bag_size: 83
batch 99, loss: 0.0001, instance_loss: 0.0966, weighted_loss: 0.0290, label: 4, bag_size: 114
batch 119, loss: 0.9063, instance_loss: 0.3970, weighted_loss: 0.7535, label: 2, bag_size: 264
batch 139, loss: 0.3272, instance_loss: 0.2497, weighted_loss: 0.3040, label: 0, bag_size: 912
batch 159, loss: 0.1622, instance_loss: 0.2203, weighted_loss: 0.1796, label: 0, bag_size: 1190
batch 179, loss: 0.0010, instance_loss: 0.0208, weighted_loss: 0.0069, label: 0, bag_size: 1143
batch 199, loss: 0.0194, instance_loss: 0.1240, weighted_loss: 0.0508, label: 4, bag_size: 47
batch 219, loss: 0.0003, instance_loss: 0.0815, weighted_loss: 0.0247, label: 4, bag_size: 51
batch 239, loss: 0.0610, instance_loss: 0.4189, weighted_loss: 0.1684, label: 1, bag_size: 700
batch 259, loss: 0.0070, instance_loss: 0.2179, weighted_loss: 0.0702, label: 2, bag_size: 1281
batch 279, loss: 0.0062, instance_loss: 0.2107, weighted_loss: 0.0676, label: 0, bag_size: 410
batch 299, loss: 0.0023, instance_loss: 0.3124, weighted_loss: 0.0954, label: 3, bag_size: 18
batch 319, loss: 0.0267, instance_loss: 0.3150, weighted_loss: 0.1132, label: 1, bag_size: 965
batch 339, loss: 0.3904, instance_loss: 0.4638, weighted_loss: 0.4124, label: 2, bag_size: 1400
batch 359, loss: 0.0011, instance_loss: 0.0299, weighted_loss: 0.0098, label: 4, bag_size: 110
batch 379, loss: 0.0004, instance_loss: 0.1128, weighted_loss: 0.0341, label: 0, bag_size: 129
batch 399, loss: 0.0030, instance_loss: 0.1397, weighted_loss: 0.0440, label: 0, bag_size: 338
batch 419, loss: 0.0268, instance_loss: 0.2517, weighted_loss: 0.0943, label: 2, bag_size: 1569
batch 439, loss: 0.0016, instance_loss: 0.1982, weighted_loss: 0.0606, label: 0, bag_size: 155
batch 459, loss: 0.0025, instance_loss: 0.1312, weighted_loss: 0.0411, label: 1, bag_size: 903
batch 479, loss: 0.0535, instance_loss: 0.3934, weighted_loss: 0.1555, label: 1, bag_size: 139
batch 499, loss: 0.0034, instance_loss: 0.3683, weighted_loss: 0.1128, label: 4, bag_size: 20
batch 519, loss: 0.1701, instance_loss: 0.3360, weighted_loss: 0.2199, label: 2, bag_size: 471
batch 539, loss: 0.0002, instance_loss: 0.1151, weighted_loss: 0.0347, label: 0, bag_size: 117


class 0 clustering acc 0.9856880733944954: correct 21488/21800
class 1 clustering acc 0.5238532110091743: correct 2284/4360
Epoch: 46, train_loss: 0.1189, train_clustering_loss:  0.2685, train_error: 0.0422
class 0: acc 0.981651376146789, correct 107/109
class 1: acc 0.9375, correct 120/128
class 2: acc 0.9122807017543859, correct 104/114
class 3: acc 0.989247311827957, correct 92/93
class 4: acc 0.9801980198019802, correct 99/101

Val Set, val_loss: 1.4530, val_error: 0.3000, auc: 0.8728
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.3825: correct 153/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.8, correct 16/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.0098, instance_loss: 0.1593, weighted_loss: 0.0547, label: 2, bag_size: 1289
batch 39, loss: 0.0369, instance_loss: 0.1841, weighted_loss: 0.0811, label: 2, bag_size: 567
batch 59, loss: 0.0973, instance_loss: 0.2133, weighted_loss: 0.1321, label: 1, bag_size: 898
batch 79, loss: 0.0377, instance_loss: 0.2685, weighted_loss: 0.1069, label: 2, bag_size: 469
batch 99, loss: 0.1335, instance_loss: 0.5600, weighted_loss: 0.2614, label: 0, bag_size: 245
batch 119, loss: 0.0183, instance_loss: 0.0943, weighted_loss: 0.0411, label: 0, bag_size: 1579
batch 139, loss: 0.0002, instance_loss: 0.0097, weighted_loss: 0.0030, label: 0, bag_size: 982
batch 159, loss: 0.2589, instance_loss: 0.7653, weighted_loss: 0.4108, label: 1, bag_size: 651
batch 179, loss: 0.0321, instance_loss: 0.4255, weighted_loss: 0.1501, label: 4, bag_size: 823
batch 199, loss: 1.5433, instance_loss: 0.5170, weighted_loss: 1.2354, label: 3, bag_size: 1380
batch 219, loss: 0.0152, instance_loss: 0.5331, weighted_loss: 0.1706, label: 3, bag_size: 1250
batch 239, loss: 0.0013, instance_loss: 0.0583, weighted_loss: 0.0184, label: 0, bag_size: 476
batch 259, loss: 0.0147, instance_loss: 0.0952, weighted_loss: 0.0388, label: 3, bag_size: 50
batch 279, loss: 0.0044, instance_loss: 0.0420, weighted_loss: 0.0157, label: 0, bag_size: 1190
batch 299, loss: 0.0011, instance_loss: 0.0609, weighted_loss: 0.0191, label: 4, bag_size: 123
batch 319, loss: 0.0002, instance_loss: 0.0449, weighted_loss: 0.0136, label: 0, bag_size: 1466
batch 339, loss: 0.5727, instance_loss: 0.7025, weighted_loss: 0.6116, label: 4, bag_size: 1337
batch 359, loss: 2.4017, instance_loss: 0.9743, weighted_loss: 1.9735, label: 2, bag_size: 1139
batch 379, loss: 0.0212, instance_loss: 0.4000, weighted_loss: 0.1348, label: 1, bag_size: 474
batch 399, loss: 0.0031, instance_loss: 0.0650, weighted_loss: 0.0217, label: 1, bag_size: 938
batch 419, loss: 0.0183, instance_loss: 0.1712, weighted_loss: 0.0642, label: 4, bag_size: 17
batch 439, loss: 0.1577, instance_loss: 0.3675, weighted_loss: 0.2206, label: 2, bag_size: 1139
batch 459, loss: 0.0108, instance_loss: 0.3479, weighted_loss: 0.1120, label: 2, bag_size: 1167
batch 479, loss: 0.0052, instance_loss: 0.3342, weighted_loss: 0.1039, label: 3, bag_size: 791
batch 499, loss: 0.0423, instance_loss: 0.2026, weighted_loss: 0.0904, label: 1, bag_size: 1646
batch 519, loss: 0.0079, instance_loss: 0.6513, weighted_loss: 0.2009, label: 1, bag_size: 657
batch 539, loss: 0.0388, instance_loss: 0.4500, weighted_loss: 0.1621, label: 2, bag_size: 248


class 0 clustering acc 0.9874770642201834: correct 21527/21800
class 1 clustering acc 0.5373853211009174: correct 2343/4360
Epoch: 47, train_loss: 0.1480, train_clustering_loss:  0.2632, train_error: 0.0422
class 0: acc 0.9716981132075472, correct 103/106
class 1: acc 0.9528301886792453, correct 101/106
class 2: acc 0.9105691056910569, correct 112/123
class 3: acc 0.97, correct 97/100
class 4: acc 0.990909090909091, correct 109/110

Val Set, val_loss: 1.5270, val_error: 0.3200, auc: 0.8393
class 0 clustering acc 0.9585: correct 1917/2000
class 1 clustering acc 0.505: correct 202/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.75, correct 15/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.8628, instance_loss: 0.4431, weighted_loss: 0.7369, label: 0, bag_size: 1527
batch 39, loss: 0.0336, instance_loss: 0.2050, weighted_loss: 0.0850, label: 2, bag_size: 1215
batch 59, loss: 0.0156, instance_loss: 0.2704, weighted_loss: 0.0920, label: 3, bag_size: 21
batch 79, loss: 0.0004, instance_loss: 0.1197, weighted_loss: 0.0362, label: 4, bag_size: 24
batch 99, loss: 0.0070, instance_loss: 0.0860, weighted_loss: 0.0307, label: 1, bag_size: 1325
batch 119, loss: 0.0818, instance_loss: 0.2251, weighted_loss: 0.1248, label: 2, bag_size: 941
batch 139, loss: 0.0257, instance_loss: 0.3565, weighted_loss: 0.1250, label: 1, bag_size: 530
batch 159, loss: 0.0091, instance_loss: 0.0727, weighted_loss: 0.0282, label: 4, bag_size: 91
batch 179, loss: 0.0054, instance_loss: 0.3132, weighted_loss: 0.0978, label: 0, bag_size: 255
batch 199, loss: 0.1384, instance_loss: 0.6847, weighted_loss: 0.3023, label: 4, bag_size: 1337
batch 219, loss: 0.0158, instance_loss: 0.2126, weighted_loss: 0.0748, label: 0, bag_size: 736
batch 239, loss: 0.0043, instance_loss: 0.0670, weighted_loss: 0.0231, label: 3, bag_size: 20
batch 259, loss: 0.0017, instance_loss: 0.2305, weighted_loss: 0.0703, label: 0, bag_size: 129
batch 279, loss: 0.0020, instance_loss: 0.0691, weighted_loss: 0.0221, label: 0, bag_size: 246
batch 299, loss: 0.0010, instance_loss: 0.4932, weighted_loss: 0.1487, label: 4, bag_size: 823
batch 319, loss: 0.6691, instance_loss: 0.3714, weighted_loss: 0.5798, label: 2, bag_size: 1133
batch 339, loss: 0.0115, instance_loss: 0.3733, weighted_loss: 0.1200, label: 1, bag_size: 377
batch 359, loss: 0.4133, instance_loss: 0.5553, weighted_loss: 0.4559, label: 2, bag_size: 500
batch 379, loss: 0.1325, instance_loss: 0.7451, weighted_loss: 0.3163, label: 3, bag_size: 671
batch 399, loss: 0.2318, instance_loss: 0.6015, weighted_loss: 0.3427, label: 2, bag_size: 307
batch 419, loss: 0.0057, instance_loss: 0.0748, weighted_loss: 0.0264, label: 4, bag_size: 711
batch 439, loss: 0.0050, instance_loss: 0.3540, weighted_loss: 0.1097, label: 1, bag_size: 648
batch 459, loss: 0.0053, instance_loss: 0.2195, weighted_loss: 0.0695, label: 4, bag_size: 625
batch 479, loss: 0.0745, instance_loss: 0.5738, weighted_loss: 0.2243, label: 1, bag_size: 917
batch 499, loss: 0.0675, instance_loss: 0.2633, weighted_loss: 0.1262, label: 0, bag_size: 718
batch 519, loss: 0.0000, instance_loss: 0.0073, weighted_loss: 0.0022, label: 1, bag_size: 937
batch 539, loss: 0.0237, instance_loss: 0.1768, weighted_loss: 0.0696, label: 1, bag_size: 598


class 0 clustering acc 0.9882568807339449: correct 21544/21800
class 1 clustering acc 0.6002293577981651: correct 2617/4360
Epoch: 48, train_loss: 0.0882, train_clustering_loss:  0.2258, train_error: 0.0275
class 0: acc 0.9734513274336283, correct 110/113
class 1: acc 0.9553571428571429, correct 107/112
class 2: acc 0.9523809523809523, correct 100/105
class 3: acc 0.9911504424778761, correct 112/113
class 4: acc 0.9901960784313726, correct 101/102

Val Set, val_loss: 1.6113, val_error: 0.3400, auc: 0.8544
class 0 clustering acc 0.966: correct 1932/2000
class 1 clustering acc 0.43: correct 172/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.65, correct 13/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.0842, instance_loss: 0.6280, weighted_loss: 0.2474, label: 1, bag_size: 778
batch 39, loss: 0.0083, instance_loss: 0.0607, weighted_loss: 0.0240, label: 4, bag_size: 43
batch 59, loss: 0.0001, instance_loss: 0.1343, weighted_loss: 0.0404, label: 3, bag_size: 18
batch 79, loss: 0.0039, instance_loss: 0.0755, weighted_loss: 0.0254, label: 0, bag_size: 246
batch 99, loss: 0.0059, instance_loss: 0.0994, weighted_loss: 0.0339, label: 3, bag_size: 18
batch 119, loss: 0.0023, instance_loss: 0.0810, weighted_loss: 0.0259, label: 3, bag_size: 23
batch 139, loss: 0.0053, instance_loss: 0.2238, weighted_loss: 0.0708, label: 3, bag_size: 936
batch 159, loss: 0.0008, instance_loss: 0.2393, weighted_loss: 0.0723, label: 0, bag_size: 110
batch 179, loss: 0.0005, instance_loss: 0.1495, weighted_loss: 0.0452, label: 3, bag_size: 53
batch 199, loss: 0.0012, instance_loss: 0.0358, weighted_loss: 0.0116, label: 4, bag_size: 39
batch 219, loss: 0.0000, instance_loss: 0.0265, weighted_loss: 0.0080, label: 4, bag_size: 140
batch 239, loss: 0.0581, instance_loss: 0.2203, weighted_loss: 0.1067, label: 0, bag_size: 1527
batch 259, loss: 0.0001, instance_loss: 0.0086, weighted_loss: 0.0026, label: 0, bag_size: 1872
batch 279, loss: 0.1012, instance_loss: 0.1696, weighted_loss: 0.1217, label: 2, bag_size: 270
batch 299, loss: 0.0011, instance_loss: 0.0791, weighted_loss: 0.0245, label: 4, bag_size: 40
batch 319, loss: 0.0333, instance_loss: 0.5043, weighted_loss: 0.1746, label: 2, bag_size: 248
batch 339, loss: 0.0065, instance_loss: 0.1735, weighted_loss: 0.0566, label: 2, bag_size: 317
batch 359, loss: 0.0322, instance_loss: 0.2125, weighted_loss: 0.0863, label: 2, bag_size: 848
batch 379, loss: 0.0051, instance_loss: 0.5922, weighted_loss: 0.1812, label: 4, bag_size: 663
batch 399, loss: 0.7253, instance_loss: 0.4696, weighted_loss: 0.6486, label: 2, bag_size: 204
batch 419, loss: 0.0152, instance_loss: 0.2252, weighted_loss: 0.0782, label: 0, bag_size: 128
batch 439, loss: 0.0003, instance_loss: 0.3749, weighted_loss: 0.1127, label: 3, bag_size: 78
batch 459, loss: 0.0007, instance_loss: 0.0696, weighted_loss: 0.0214, label: 3, bag_size: 32
batch 479, loss: 0.0001, instance_loss: 0.0087, weighted_loss: 0.0027, label: 0, bag_size: 982
batch 499, loss: 0.0002, instance_loss: 0.0485, weighted_loss: 0.0147, label: 3, bag_size: 20
batch 519, loss: 0.0139, instance_loss: 0.3798, weighted_loss: 0.1237, label: 0, bag_size: 1034
batch 539, loss: 0.1389, instance_loss: 0.2575, weighted_loss: 0.1745, label: 2, bag_size: 499


class 0 clustering acc 0.9870183486238532: correct 21517/21800
class 1 clustering acc 0.6020642201834863: correct 2625/4360
Epoch: 49, train_loss: 0.0903, train_clustering_loss:  0.2310, train_error: 0.0220
class 0: acc 0.9915966386554622, correct 118/119
class 1: acc 0.945054945054945, correct 86/91
class 2: acc 0.9568965517241379, correct 111/116
class 3: acc 0.990909090909091, correct 109/110
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 1.4288, val_error: 0.3200, auc: 0.8645
class 0 clustering acc 0.9685: correct 1937/2000
class 1 clustering acc 0.395: correct 158/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.8, correct 16/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.0007, instance_loss: 0.0301, weighted_loss: 0.0095, label: 0, bag_size: 1143
batch 39, loss: 0.0008, instance_loss: 0.1106, weighted_loss: 0.0337, label: 0, bag_size: 552
batch 59, loss: 0.1069, instance_loss: 0.7052, weighted_loss: 0.2864, label: 1, bag_size: 651
batch 79, loss: 0.0032, instance_loss: 0.1355, weighted_loss: 0.0429, label: 0, bag_size: 129
batch 99, loss: 0.0018, instance_loss: 0.1665, weighted_loss: 0.0512, label: 0, bag_size: 176
batch 119, loss: 0.0607, instance_loss: 0.2367, weighted_loss: 0.1135, label: 2, bag_size: 571
batch 139, loss: 0.0322, instance_loss: 0.1356, weighted_loss: 0.0632, label: 0, bag_size: 801
batch 159, loss: 0.0188, instance_loss: 0.3222, weighted_loss: 0.1099, label: 2, bag_size: 1047
batch 179, loss: 0.0005, instance_loss: 0.0657, weighted_loss: 0.0201, label: 4, bag_size: 143
batch 199, loss: 0.0135, instance_loss: 0.2349, weighted_loss: 0.0799, label: 2, bag_size: 684
batch 219, loss: 0.0005, instance_loss: 0.0740, weighted_loss: 0.0225, label: 4, bag_size: 160
batch 239, loss: 0.0057, instance_loss: 0.2010, weighted_loss: 0.0643, label: 0, bag_size: 116
batch 259, loss: 0.0049, instance_loss: 0.1835, weighted_loss: 0.0585, label: 2, bag_size: 636
batch 279, loss: 0.0060, instance_loss: 0.3980, weighted_loss: 0.1236, label: 4, bag_size: 882
batch 299, loss: 0.4674, instance_loss: 0.5094, weighted_loss: 0.4800, label: 1, bag_size: 1255
batch 319, loss: 0.0003, instance_loss: 0.1661, weighted_loss: 0.0501, label: 1, bag_size: 1651
batch 339, loss: 0.1003, instance_loss: 0.0990, weighted_loss: 0.0999, label: 1, bag_size: 847
batch 359, loss: 0.0041, instance_loss: 0.1266, weighted_loss: 0.0409, label: 3, bag_size: 18
batch 379, loss: 0.0061, instance_loss: 0.1697, weighted_loss: 0.0552, label: 0, bag_size: 653
batch 399, loss: 0.0019, instance_loss: 0.1707, weighted_loss: 0.0525, label: 0, bag_size: 122
batch 419, loss: 0.0097, instance_loss: 0.2281, weighted_loss: 0.0752, label: 4, bag_size: 1474
batch 439, loss: 0.0151, instance_loss: 0.2419, weighted_loss: 0.0831, label: 2, bag_size: 567
batch 459, loss: 0.0465, instance_loss: 0.3807, weighted_loss: 0.1467, label: 2, bag_size: 1167
batch 479, loss: 0.0013, instance_loss: 0.0276, weighted_loss: 0.0092, label: 3, bag_size: 97
batch 499, loss: 0.0126, instance_loss: 0.1953, weighted_loss: 0.0674, label: 3, bag_size: 841
batch 519, loss: 0.4305, instance_loss: 0.5436, weighted_loss: 0.4644, label: 2, bag_size: 1400
batch 539, loss: 1.5439, instance_loss: 0.4308, weighted_loss: 1.2100, label: 2, bag_size: 272


class 0 clustering acc 0.9852752293577982: correct 21479/21800
class 1 clustering acc 0.6077981651376146: correct 2650/4360
Epoch: 50, train_loss: 0.0842, train_clustering_loss:  0.2372, train_error: 0.0239
class 0: acc 0.9849624060150376, correct 131/133
class 1: acc 0.9405940594059405, correct 95/101
class 2: acc 0.9736842105263158, correct 111/114
class 3: acc 0.9821428571428571, correct 110/112
class 4: acc 1.0, correct 85/85

Val Set, val_loss: 1.4864, val_error: 0.3200, auc: 0.8468
class 0 clustering acc 0.9645: correct 1929/2000
class 1 clustering acc 0.3825: correct 153/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.7, correct 14/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 3/6
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.1237, instance_loss: 0.3551, weighted_loss: 0.1931, label: 1, bag_size: 1049
batch 39, loss: 0.0006, instance_loss: 0.1258, weighted_loss: 0.0382, label: 3, bag_size: 27
batch 59, loss: 0.0509, instance_loss: 0.2137, weighted_loss: 0.0998, label: 0, bag_size: 1332
batch 79, loss: 0.0320, instance_loss: 0.3248, weighted_loss: 0.1199, label: 4, bag_size: 14
batch 99, loss: 0.2051, instance_loss: 0.3475, weighted_loss: 0.2478, label: 0, bag_size: 759
batch 119, loss: 0.0300, instance_loss: 0.1991, weighted_loss: 0.0807, label: 3, bag_size: 1019
batch 139, loss: 0.0131, instance_loss: 0.2183, weighted_loss: 0.0746, label: 2, bag_size: 314
batch 159, loss: 0.0001, instance_loss: 0.1039, weighted_loss: 0.0312, label: 4, bag_size: 38
batch 179, loss: 0.0022, instance_loss: 0.1561, weighted_loss: 0.0484, label: 0, bag_size: 800
batch 199, loss: 0.3165, instance_loss: 0.1726, weighted_loss: 0.2733, label: 2, bag_size: 1006
batch 219, loss: 0.0486, instance_loss: 0.3107, weighted_loss: 0.1273, label: 2, bag_size: 248
batch 239, loss: 0.0016, instance_loss: 0.0829, weighted_loss: 0.0260, label: 0, bag_size: 1012
batch 259, loss: 0.0508, instance_loss: 0.5054, weighted_loss: 0.1872, label: 2, bag_size: 110
batch 279, loss: 0.9416, instance_loss: 0.7979, weighted_loss: 0.8985, label: 3, bag_size: 281
batch 299, loss: 0.0086, instance_loss: 0.4776, weighted_loss: 0.1493, label: 3, bag_size: 706
batch 319, loss: 0.0303, instance_loss: 0.3937, weighted_loss: 0.1394, label: 2, bag_size: 750
batch 339, loss: 0.0237, instance_loss: 0.2394, weighted_loss: 0.0884, label: 3, bag_size: 849
batch 359, loss: 0.0411, instance_loss: 0.4236, weighted_loss: 0.1558, label: 3, bag_size: 697
batch 379, loss: 0.0052, instance_loss: 0.1475, weighted_loss: 0.0479, label: 0, bag_size: 545
batch 399, loss: 0.0162, instance_loss: 0.9646, weighted_loss: 0.3007, label: 1, bag_size: 660
batch 419, loss: 0.0826, instance_loss: 0.4030, weighted_loss: 0.1788, label: 2, bag_size: 409
batch 439, loss: 0.6726, instance_loss: 0.6157, weighted_loss: 0.6555, label: 2, bag_size: 911
batch 459, loss: 0.0123, instance_loss: 0.1880, weighted_loss: 0.0650, label: 0, bag_size: 1012
batch 479, loss: 0.0000, instance_loss: 0.0188, weighted_loss: 0.0057, label: 4, bag_size: 157
batch 499, loss: 0.0005, instance_loss: 0.0179, weighted_loss: 0.0057, label: 4, bag_size: 162
batch 519, loss: 0.0028, instance_loss: 0.0358, weighted_loss: 0.0127, label: 3, bag_size: 43
batch 539, loss: 0.0110, instance_loss: 0.5299, weighted_loss: 0.1667, label: 2, bag_size: 803


class 0 clustering acc 0.9852752293577982: correct 21479/21800
class 1 clustering acc 0.5926605504587156: correct 2584/4360
Epoch: 51, train_loss: 0.0651, train_clustering_loss:  0.2397, train_error: 0.0147
class 0: acc 0.991304347826087, correct 114/115
class 1: acc 0.983739837398374, correct 121/123
class 2: acc 0.968421052631579, correct 92/95
class 3: acc 0.9819819819819819, correct 109/111
class 4: acc 1.0, correct 101/101

Val Set, val_loss: 1.5719, val_error: 0.3800, auc: 0.8435
class 0 clustering acc 0.97: correct 1940/2000
class 1 clustering acc 0.4025: correct 161/400
class 0: acc 0.8, correct 4/5
class 1: acc 0.5, correct 7/14
class 2: acc 0.7, correct 14/20
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 2/6
EarlyStopping counter: 45 out of 20
Early stopping
Val error: 0.3800, ROC AUC: 0.8493
Test error: 0.3600, ROC AUC: 0.8086
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.64, correct 16/25
class 3: acc 0.2, correct 1/5
class 4: acc 0.0, correct 0/2

Training Fold 8!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6039, instance_loss: 1.2272, weighted_loss: 1.4909, label: 0, bag_size: 518
batch 39, loss: 1.6380, instance_loss: 1.0872, weighted_loss: 1.4727, label: 3, bag_size: 19
batch 59, loss: 1.5877, instance_loss: 0.9212, weighted_loss: 1.3877, label: 4, bag_size: 78
batch 79, loss: 1.5650, instance_loss: 0.7071, weighted_loss: 1.3076, label: 1, bag_size: 860
batch 99, loss: 1.5729, instance_loss: 0.5884, weighted_loss: 1.2775, label: 3, bag_size: 1172
batch 119, loss: 1.3977, instance_loss: 0.5328, weighted_loss: 1.1383, label: 3, bag_size: 19
batch 139, loss: 1.8732, instance_loss: 0.5741, weighted_loss: 1.4835, label: 2, bag_size: 120
batch 159, loss: 1.6346, instance_loss: 0.5339, weighted_loss: 1.3044, label: 3, bag_size: 46
batch 179, loss: 1.5787, instance_loss: 0.5404, weighted_loss: 1.2672, label: 3, bag_size: 20
batch 199, loss: 1.5923, instance_loss: 0.5243, weighted_loss: 1.2719, label: 2, bag_size: 1197
batch 219, loss: 1.8467, instance_loss: 0.5337, weighted_loss: 1.4528, label: 4, bag_size: 928
batch 239, loss: 1.2610, instance_loss: 0.5099, weighted_loss: 1.0357, label: 0, bag_size: 524
batch 259, loss: 1.7661, instance_loss: 0.5291, weighted_loss: 1.3950, label: 3, bag_size: 1253
batch 279, loss: 0.6443, instance_loss: 0.4514, weighted_loss: 0.5864, label: 4, bag_size: 160
batch 299, loss: 1.5972, instance_loss: 0.5311, weighted_loss: 1.2773, label: 1, bag_size: 925
batch 319, loss: 1.5390, instance_loss: 0.5296, weighted_loss: 1.2362, label: 1, bag_size: 860
batch 339, loss: 1.5476, instance_loss: 0.5176, weighted_loss: 1.2386, label: 2, bag_size: 373
batch 359, loss: 1.7239, instance_loss: 0.5446, weighted_loss: 1.3701, label: 2, bag_size: 500
batch 379, loss: 1.4356, instance_loss: 0.5188, weighted_loss: 1.1605, label: 1, bag_size: 818
batch 399, loss: 1.4764, instance_loss: 0.4800, weighted_loss: 1.1774, label: 3, bag_size: 211
batch 419, loss: 1.4830, instance_loss: 0.5082, weighted_loss: 1.1905, label: 0, bag_size: 466
batch 439, loss: 1.9095, instance_loss: 0.5351, weighted_loss: 1.4972, label: 4, bag_size: 764
batch 459, loss: 1.1086, instance_loss: 0.4692, weighted_loss: 0.9168, label: 0, bag_size: 1190
batch 479, loss: 0.5138, instance_loss: 0.3984, weighted_loss: 0.4792, label: 4, bag_size: 150
batch 499, loss: 1.3620, instance_loss: 0.4812, weighted_loss: 1.0977, label: 0, bag_size: 736
batch 519, loss: 0.7738, instance_loss: 0.4513, weighted_loss: 0.6771, label: 3, bag_size: 20
batch 539, loss: 1.5597, instance_loss: 0.5105, weighted_loss: 1.2450, label: 0, bag_size: 653


class 0 clustering acc 0.9958256880733944: correct 21709/21800
class 1 clustering acc 0.002522935779816514: correct 11/4360
Epoch: 0, train_loss: 1.4665, train_clustering_loss:  0.5963, train_error: 0.6312
class 0: acc 0.5564516129032258, correct 69/124
class 1: acc 0.2127659574468085, correct 20/94
class 2: acc 0.1346153846153846, correct 14/104
class 3: acc 0.3387096774193548, correct 42/124
class 4: acc 0.5656565656565656, correct 56/99

Val Set, val_loss: 1.6273, val_error: 0.6800, auc: 0.7373
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6, correct 3/5
class 4: acc 0.25, correct 3/12
Validation loss decreased (inf --> 1.627328).  Saving model ...


batch 19, loss: 1.3922, instance_loss: 0.5078, weighted_loss: 1.1269, label: 1, bag_size: 846
batch 39, loss: 2.6865, instance_loss: 0.5804, weighted_loss: 2.0547, label: 4, bag_size: 663
batch 59, loss: 1.4189, instance_loss: 0.4799, weighted_loss: 1.1372, label: 2, bag_size: 204
batch 79, loss: 0.5173, instance_loss: 0.4106, weighted_loss: 0.4853, label: 3, bag_size: 21
batch 99, loss: 1.0735, instance_loss: 0.4569, weighted_loss: 0.8885, label: 2, bag_size: 312
batch 119, loss: 1.2022, instance_loss: 0.4681, weighted_loss: 0.9820, label: 2, bag_size: 471
batch 139, loss: 2.1212, instance_loss: 0.5346, weighted_loss: 1.6452, label: 3, bag_size: 317
batch 159, loss: 0.9792, instance_loss: 0.4075, weighted_loss: 0.8077, label: 1, bag_size: 320
batch 179, loss: 1.0600, instance_loss: 0.4877, weighted_loss: 0.8884, label: 3, bag_size: 16
batch 199, loss: 0.6801, instance_loss: 0.4454, weighted_loss: 0.6097, label: 3, bag_size: 28
batch 219, loss: 2.1407, instance_loss: 0.5345, weighted_loss: 1.6588, label: 3, bag_size: 1253
batch 239, loss: 0.8366, instance_loss: 0.4663, weighted_loss: 0.7255, label: 3, bag_size: 18
batch 259, loss: 1.5285, instance_loss: 0.5261, weighted_loss: 1.2278, label: 0, bag_size: 607
batch 279, loss: 1.0321, instance_loss: 0.4389, weighted_loss: 0.8541, label: 2, bag_size: 948
batch 299, loss: 2.8200, instance_loss: 0.6549, weighted_loss: 2.1705, label: 4, bag_size: 826
batch 319, loss: 1.3206, instance_loss: 0.5007, weighted_loss: 1.0746, label: 0, bag_size: 294
batch 339, loss: 0.9435, instance_loss: 0.4732, weighted_loss: 0.8024, label: 0, bag_size: 1133
batch 359, loss: 0.3009, instance_loss: 0.1985, weighted_loss: 0.2702, label: 4, bag_size: 130
batch 379, loss: 0.5392, instance_loss: 0.3930, weighted_loss: 0.4953, label: 3, bag_size: 34
batch 399, loss: 1.2200, instance_loss: 0.5179, weighted_loss: 1.0094, label: 0, bag_size: 1301
batch 419, loss: 0.5666, instance_loss: 0.3338, weighted_loss: 0.4967, label: 4, bag_size: 44
batch 439, loss: 1.2942, instance_loss: 0.4818, weighted_loss: 1.0505, label: 2, bag_size: 3236
batch 459, loss: 0.8689, instance_loss: 0.4160, weighted_loss: 0.7330, label: 2, bag_size: 1306
batch 479, loss: 2.8579, instance_loss: 0.7824, weighted_loss: 2.2353, label: 4, bag_size: 773
batch 499, loss: 1.5249, instance_loss: 0.5135, weighted_loss: 1.2215, label: 0, bag_size: 1190
batch 519, loss: 1.1122, instance_loss: 0.4723, weighted_loss: 0.9202, label: 0, bag_size: 382
batch 539, loss: 1.2414, instance_loss: 0.5070, weighted_loss: 1.0210, label: 1, bag_size: 965


class 0 clustering acc 0.9993119266055046: correct 21785/21800
class 1 clustering acc 0.02889908256880734: correct 126/4360
Epoch: 1, train_loss: 1.1530, train_clustering_loss:  0.4512, train_error: 0.4477
class 0: acc 0.16, correct 16/100
class 1: acc 0.5229357798165137, correct 57/109
class 2: acc 0.6065573770491803, correct 74/122
class 3: acc 0.7, correct 77/110
class 4: acc 0.7403846153846154, correct 77/104

Val Set, val_loss: 1.3464, val_error: 0.4800, auc: 0.8043
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.0475: correct 19/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.7, correct 7/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.25, correct 3/12
Validation loss decreased (1.627328 --> 1.346354).  Saving model ...


batch 19, loss: 1.1115, instance_loss: 0.4743, weighted_loss: 0.9203, label: 0, bag_size: 1579
batch 39, loss: 0.7407, instance_loss: 0.4045, weighted_loss: 0.6398, label: 1, bag_size: 504
batch 59, loss: 0.7326, instance_loss: 0.4020, weighted_loss: 0.6334, label: 1, bag_size: 965
batch 79, loss: 0.1802, instance_loss: 0.2940, weighted_loss: 0.2144, label: 3, bag_size: 18
batch 99, loss: 1.6691, instance_loss: 0.5126, weighted_loss: 1.3221, label: 2, bag_size: 357
batch 119, loss: 0.8085, instance_loss: 0.3895, weighted_loss: 0.6828, label: 1, bag_size: 530
batch 139, loss: 1.2202, instance_loss: 0.4989, weighted_loss: 1.0038, label: 0, bag_size: 976
batch 159, loss: 1.0760, instance_loss: 0.4750, weighted_loss: 0.8957, label: 2, bag_size: 750
batch 179, loss: 0.9605, instance_loss: 0.4352, weighted_loss: 0.8029, label: 2, bag_size: 1533
batch 199, loss: 0.8824, instance_loss: 0.4446, weighted_loss: 0.7511, label: 2, bag_size: 286
batch 219, loss: 1.7379, instance_loss: 0.7171, weighted_loss: 1.4317, label: 0, bag_size: 109
batch 239, loss: 1.2675, instance_loss: 0.4985, weighted_loss: 1.0368, label: 4, bag_size: 23
batch 259, loss: 1.2913, instance_loss: 0.5537, weighted_loss: 1.0700, label: 2, bag_size: 373
batch 279, loss: 1.0383, instance_loss: 0.4938, weighted_loss: 0.8749, label: 0, bag_size: 1301
batch 299, loss: 1.3221, instance_loss: 0.4742, weighted_loss: 1.0677, label: 0, bag_size: 552
batch 319, loss: 0.4051, instance_loss: 0.3205, weighted_loss: 0.3797, label: 1, bag_size: 405
batch 339, loss: 1.1602, instance_loss: 0.4042, weighted_loss: 0.9334, label: 2, bag_size: 629
batch 359, loss: 1.5729, instance_loss: 0.4969, weighted_loss: 1.2501, label: 1, bag_size: 897
batch 379, loss: 0.6291, instance_loss: 0.3471, weighted_loss: 0.5445, label: 2, bag_size: 252
batch 399, loss: 0.9033, instance_loss: 0.4333, weighted_loss: 0.7623, label: 0, bag_size: 446
batch 419, loss: 0.1118, instance_loss: 0.1451, weighted_loss: 0.1218, label: 4, bag_size: 63
batch 439, loss: 0.9575, instance_loss: 0.4608, weighted_loss: 0.8085, label: 0, bag_size: 466
batch 459, loss: 1.0336, instance_loss: 0.3643, weighted_loss: 0.8328, label: 2, bag_size: 1231
batch 479, loss: 0.8339, instance_loss: 0.4687, weighted_loss: 0.7243, label: 1, bag_size: 405
batch 499, loss: 0.0770, instance_loss: 0.1993, weighted_loss: 0.1137, label: 3, bag_size: 26
batch 519, loss: 0.8090, instance_loss: 0.3626, weighted_loss: 0.6751, label: 2, bag_size: 1069
batch 539, loss: 0.7875, instance_loss: 0.4027, weighted_loss: 0.6721, label: 0, bag_size: 524


class 0 clustering acc 0.9956880733944954: correct 21706/21800
class 1 clustering acc 0.11651376146788991: correct 508/4360
Epoch: 2, train_loss: 1.0304, train_clustering_loss:  0.4171, train_error: 0.3982
class 0: acc 0.3431372549019608, correct 35/102
class 1: acc 0.5567010309278351, correct 54/97
class 2: acc 0.648854961832061, correct 85/131
class 3: acc 0.7657657657657657, correct 85/111
class 4: acc 0.6634615384615384, correct 69/104

Val Set, val_loss: 1.3754, val_error: 0.5800, auc: 0.8494
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.085: correct 34/400
class 0: acc 0.3, correct 3/10
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.25, correct 3/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.0731, instance_loss: 0.6065, weighted_loss: 1.6331, label: 3, bag_size: 360
batch 39, loss: 1.3207, instance_loss: 0.4631, weighted_loss: 1.0634, label: 2, bag_size: 977
batch 59, loss: 1.0201, instance_loss: 0.4554, weighted_loss: 0.8507, label: 0, bag_size: 294
batch 79, loss: 0.7393, instance_loss: 0.3589, weighted_loss: 0.6252, label: 2, bag_size: 1259
batch 99, loss: 3.5466, instance_loss: 0.7980, weighted_loss: 2.7221, label: 4, bag_size: 1337
batch 119, loss: 2.1427, instance_loss: 0.5821, weighted_loss: 1.6745, label: 1, bag_size: 1172
batch 139, loss: 0.4731, instance_loss: 0.3210, weighted_loss: 0.4275, label: 2, bag_size: 286
batch 159, loss: 1.7955, instance_loss: 0.5231, weighted_loss: 1.4138, label: 1, bag_size: 448
batch 179, loss: 1.1696, instance_loss: 0.4613, weighted_loss: 0.9571, label: 2, bag_size: 373
batch 199, loss: 1.2470, instance_loss: 0.7335, weighted_loss: 1.0929, label: 0, bag_size: 148
batch 219, loss: 1.3034, instance_loss: 0.5720, weighted_loss: 1.0840, label: 2, bag_size: 932
batch 239, loss: 0.7986, instance_loss: 0.4125, weighted_loss: 0.6827, label: 2, bag_size: 932
batch 259, loss: 1.2718, instance_loss: 0.5007, weighted_loss: 1.0405, label: 0, bag_size: 1527
batch 279, loss: 2.7073, instance_loss: 0.6306, weighted_loss: 2.0843, label: 3, bag_size: 211
batch 299, loss: 0.2923, instance_loss: 0.2592, weighted_loss: 0.2824, label: 3, bag_size: 451
batch 319, loss: 0.0503, instance_loss: 0.0769, weighted_loss: 0.0583, label: 4, bag_size: 130
batch 339, loss: 1.0488, instance_loss: 0.4450, weighted_loss: 0.8677, label: 4, bag_size: 388
batch 359, loss: 0.0668, instance_loss: 0.0979, weighted_loss: 0.0762, label: 3, bag_size: 48
batch 379, loss: 1.0594, instance_loss: 0.4105, weighted_loss: 0.8647, label: 1, bag_size: 1144
batch 399, loss: 0.5212, instance_loss: 0.3513, weighted_loss: 0.4702, label: 2, bag_size: 351
batch 419, loss: 0.1449, instance_loss: 0.1732, weighted_loss: 0.1534, label: 3, bag_size: 1172
batch 439, loss: 0.9623, instance_loss: 0.3820, weighted_loss: 0.7882, label: 1, bag_size: 1402
batch 459, loss: 1.1442, instance_loss: 0.4503, weighted_loss: 0.9360, label: 2, bag_size: 1039
batch 479, loss: 0.0643, instance_loss: 0.0518, weighted_loss: 0.0606, label: 4, bag_size: 137
batch 499, loss: 0.0754, instance_loss: 0.0643, weighted_loss: 0.0720, label: 4, bag_size: 160
batch 519, loss: 2.2595, instance_loss: 0.6812, weighted_loss: 1.7860, label: 4, bag_size: 590
batch 539, loss: 2.8418, instance_loss: 0.7365, weighted_loss: 2.2102, label: 3, bag_size: 281


class 0 clustering acc 0.9954587155963303: correct 21701/21800
class 1 clustering acc 0.1713302752293578: correct 747/4360
Epoch: 3, train_loss: 0.9326, train_clustering_loss:  0.3935, train_error: 0.3321
class 0: acc 0.703125, correct 90/128
class 1: acc 0.59375, correct 57/96
class 2: acc 0.5701754385964912, correct 65/114
class 3: acc 0.7157894736842105, correct 68/95
class 4: acc 0.75, correct 84/112

Val Set, val_loss: 1.0421, val_error: 0.3800, auc: 0.8910
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.09: correct 36/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.6, correct 6/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5833333333333334, correct 7/12
Validation loss decreased (1.346354 --> 1.042143).  Saving model ...


batch 19, loss: 2.4240, instance_loss: 0.7015, weighted_loss: 1.9072, label: 3, bag_size: 200
batch 39, loss: 1.0373, instance_loss: 0.4594, weighted_loss: 0.8639, label: 2, bag_size: 861
batch 59, loss: 0.1070, instance_loss: 0.2005, weighted_loss: 0.1350, label: 3, bag_size: 20
batch 79, loss: 2.0282, instance_loss: 0.5098, weighted_loss: 1.5727, label: 1, bag_size: 435
batch 99, loss: 0.3028, instance_loss: 0.2348, weighted_loss: 0.2824, label: 1, bag_size: 405
batch 119, loss: 0.6859, instance_loss: 0.4133, weighted_loss: 0.6042, label: 0, bag_size: 1135
batch 139, loss: 2.5166, instance_loss: 0.6854, weighted_loss: 1.9672, label: 3, bag_size: 283
batch 159, loss: 0.4504, instance_loss: 0.3712, weighted_loss: 0.4266, label: 0, bag_size: 1135
batch 179, loss: 0.3750, instance_loss: 0.3449, weighted_loss: 0.3660, label: 0, bag_size: 521
batch 199, loss: 0.0587, instance_loss: 0.1792, weighted_loss: 0.0948, label: 3, bag_size: 18
batch 219, loss: 0.1339, instance_loss: 0.2022, weighted_loss: 0.1544, label: 4, bag_size: 128
batch 239, loss: 0.8362, instance_loss: 0.4158, weighted_loss: 0.7101, label: 2, bag_size: 351
batch 259, loss: 1.1832, instance_loss: 0.4958, weighted_loss: 0.9769, label: 2, bag_size: 471
batch 279, loss: 2.8266, instance_loss: 0.6743, weighted_loss: 2.1809, label: 1, bag_size: 1172
batch 299, loss: 0.6464, instance_loss: 0.4065, weighted_loss: 0.5744, label: 2, bag_size: 626
batch 319, loss: 0.1118, instance_loss: 0.2585, weighted_loss: 0.1558, label: 3, bag_size: 16
batch 339, loss: 0.9562, instance_loss: 0.5011, weighted_loss: 0.8197, label: 2, bag_size: 655
batch 359, loss: 0.1224, instance_loss: 0.3057, weighted_loss: 0.1774, label: 4, bag_size: 19
batch 379, loss: 0.7676, instance_loss: 0.3468, weighted_loss: 0.6414, label: 1, bag_size: 1402
batch 399, loss: 0.3798, instance_loss: 0.2495, weighted_loss: 0.3407, label: 1, bag_size: 318
batch 419, loss: 0.9231, instance_loss: 0.3839, weighted_loss: 0.7614, label: 1, bag_size: 139
batch 439, loss: 1.1983, instance_loss: 0.4865, weighted_loss: 0.9848, label: 2, bag_size: 868
batch 459, loss: 0.2876, instance_loss: 0.2468, weighted_loss: 0.2753, label: 1, bag_size: 442
batch 479, loss: 0.8931, instance_loss: 0.4462, weighted_loss: 0.7590, label: 2, bag_size: 461
batch 499, loss: 0.1375, instance_loss: 0.2017, weighted_loss: 0.1567, label: 3, bag_size: 21
batch 519, loss: 0.7058, instance_loss: 0.4123, weighted_loss: 0.6177, label: 0, bag_size: 962
batch 539, loss: 0.9653, instance_loss: 0.4132, weighted_loss: 0.7997, label: 4, bag_size: 974


class 0 clustering acc 0.9948165137614678: correct 21687/21800
class 1 clustering acc 0.24587155963302754: correct 1072/4360
Epoch: 4, train_loss: 0.8257, train_clustering_loss:  0.3679, train_error: 0.3083
class 0: acc 0.672566371681416, correct 76/113
class 1: acc 0.717948717948718, correct 84/117
class 2: acc 0.4842105263157895, correct 46/95
class 3: acc 0.8035714285714286, correct 90/112
class 4: acc 0.75, correct 81/108

Val Set, val_loss: 0.9583, val_error: 0.4000, auc: 0.9016
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.4, correct 4/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.75, correct 9/12
Validation loss decreased (1.042143 --> 0.958295).  Saving model ...


batch 19, loss: 0.6178, instance_loss: 0.3886, weighted_loss: 0.5490, label: 2, bag_size: 1215
batch 39, loss: 1.0929, instance_loss: 0.4647, weighted_loss: 0.9044, label: 2, bag_size: 1052
batch 59, loss: 0.5818, instance_loss: 0.2610, weighted_loss: 0.4856, label: 1, bag_size: 965
batch 79, loss: 1.9768, instance_loss: 0.6935, weighted_loss: 1.5918, label: 2, bag_size: 758
batch 99, loss: 0.5788, instance_loss: 0.3727, weighted_loss: 0.5170, label: 0, bag_size: 607
batch 119, loss: 0.5824, instance_loss: 0.4703, weighted_loss: 0.5488, label: 0, bag_size: 128
batch 139, loss: 1.0837, instance_loss: 0.4864, weighted_loss: 0.9045, label: 4, bag_size: 764
batch 159, loss: 1.0866, instance_loss: 0.3881, weighted_loss: 0.8771, label: 1, bag_size: 470
batch 179, loss: 0.5301, instance_loss: 0.3940, weighted_loss: 0.4893, label: 0, bag_size: 1255
batch 199, loss: 1.0065, instance_loss: 0.4291, weighted_loss: 0.8333, label: 1, bag_size: 470
batch 219, loss: 0.0209, instance_loss: 0.0345, weighted_loss: 0.0250, label: 3, bag_size: 66
batch 239, loss: 0.0359, instance_loss: 0.1044, weighted_loss: 0.0565, label: 3, bag_size: 35
batch 259, loss: 1.6500, instance_loss: 0.5180, weighted_loss: 1.3104, label: 2, bag_size: 120
batch 279, loss: 0.5157, instance_loss: 0.2873, weighted_loss: 0.4472, label: 1, bag_size: 945
batch 299, loss: 0.1461, instance_loss: 0.1225, weighted_loss: 0.1390, label: 4, bag_size: 157
batch 319, loss: 0.4573, instance_loss: 0.3959, weighted_loss: 0.4389, label: 0, bag_size: 976
batch 339, loss: 0.6621, instance_loss: 0.3791, weighted_loss: 0.5772, label: 2, bag_size: 910
batch 359, loss: 0.0771, instance_loss: 0.2137, weighted_loss: 0.1180, label: 3, bag_size: 841
batch 379, loss: 0.0538, instance_loss: 0.1119, weighted_loss: 0.0712, label: 3, bag_size: 34
batch 399, loss: 3.1386, instance_loss: 0.7743, weighted_loss: 2.4294, label: 1, bag_size: 293
batch 419, loss: 0.8503, instance_loss: 0.3878, weighted_loss: 0.7115, label: 0, bag_size: 1332
batch 439, loss: 1.1076, instance_loss: 0.3413, weighted_loss: 0.8777, label: 1, bag_size: 965
batch 459, loss: 0.5217, instance_loss: 0.3629, weighted_loss: 0.4741, label: 2, bag_size: 774
batch 479, loss: 1.3893, instance_loss: 0.5027, weighted_loss: 1.1233, label: 4, bag_size: 947
batch 499, loss: 0.4023, instance_loss: 0.2446, weighted_loss: 0.3550, label: 1, bag_size: 348
batch 519, loss: 0.0385, instance_loss: 0.1969, weighted_loss: 0.0860, label: 3, bag_size: 18
batch 539, loss: 0.4129, instance_loss: 0.3194, weighted_loss: 0.3848, label: 2, bag_size: 839


class 0 clustering acc 0.993165137614679: correct 21651/21800
class 1 clustering acc 0.25504587155963304: correct 1112/4360
Epoch: 5, train_loss: 0.7727, train_clustering_loss:  0.3619, train_error: 0.2844
class 0: acc 0.7068965517241379, correct 82/116
class 1: acc 0.7181818181818181, correct 79/110
class 2: acc 0.5660377358490566, correct 60/106
class 3: acc 0.8230088495575221, correct 93/113
class 4: acc 0.76, correct 76/100

Val Set, val_loss: 1.0471, val_error: 0.4200, auc: 0.9017
class 0 clustering acc 0.996: correct 1992/2000
class 1 clustering acc 0.1475: correct 59/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6, correct 3/5
class 4: acc 0.3333333333333333, correct 4/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 3.2024, instance_loss: 0.6149, weighted_loss: 2.4261, label: 2, bag_size: 358
batch 39, loss: 0.3689, instance_loss: 0.2938, weighted_loss: 0.3464, label: 2, bag_size: 1164
batch 59, loss: 0.0534, instance_loss: 0.2562, weighted_loss: 0.1142, label: 4, bag_size: 20
batch 79, loss: 0.4615, instance_loss: 0.3213, weighted_loss: 0.4194, label: 2, bag_size: 636
batch 99, loss: 0.6287, instance_loss: 0.3427, weighted_loss: 0.5429, label: 2, bag_size: 1164
batch 119, loss: 0.2553, instance_loss: 0.3017, weighted_loss: 0.2693, label: 4, bag_size: 23
batch 139, loss: 1.7716, instance_loss: 0.5143, weighted_loss: 1.3944, label: 1, bag_size: 435
batch 159, loss: 2.1598, instance_loss: 0.6000, weighted_loss: 1.6919, label: 1, bag_size: 770
batch 179, loss: 1.0406, instance_loss: 0.4711, weighted_loss: 0.8697, label: 2, bag_size: 474
batch 199, loss: 0.8320, instance_loss: 0.4414, weighted_loss: 0.7148, label: 2, bag_size: 500
batch 219, loss: 1.0367, instance_loss: 0.5089, weighted_loss: 0.8783, label: 4, bag_size: 1331
batch 239, loss: 0.9825, instance_loss: 0.4171, weighted_loss: 0.8129, label: 1, bag_size: 1646
batch 259, loss: 0.2920, instance_loss: 0.2105, weighted_loss: 0.2675, label: 1, bag_size: 903
batch 279, loss: 1.0266, instance_loss: 0.4530, weighted_loss: 0.8545, label: 2, bag_size: 741
batch 299, loss: 2.6224, instance_loss: 0.7661, weighted_loss: 2.0655, label: 1, bag_size: 1724
batch 319, loss: 1.2855, instance_loss: 0.4918, weighted_loss: 1.0474, label: 0, bag_size: 1190
batch 339, loss: 0.1448, instance_loss: 0.1573, weighted_loss: 0.1485, label: 4, bag_size: 140
batch 359, loss: 0.0107, instance_loss: 0.0861, weighted_loss: 0.0333, label: 3, bag_size: 43
batch 379, loss: 1.0479, instance_loss: 0.4948, weighted_loss: 0.8819, label: 2, bag_size: 707
batch 399, loss: 0.0136, instance_loss: 0.1271, weighted_loss: 0.0476, label: 3, bag_size: 24
batch 419, loss: 1.9222, instance_loss: 0.6108, weighted_loss: 1.5287, label: 1, bag_size: 968
batch 439, loss: 0.3509, instance_loss: 0.2896, weighted_loss: 0.3326, label: 0, bag_size: 410
batch 459, loss: 4.1743, instance_loss: 1.4781, weighted_loss: 3.3655, label: 2, bag_size: 1108
batch 479, loss: 0.9458, instance_loss: 0.3687, weighted_loss: 0.7727, label: 1, bag_size: 898
batch 499, loss: 0.4706, instance_loss: 0.3405, weighted_loss: 0.4316, label: 2, bag_size: 1019
batch 519, loss: 0.2062, instance_loss: 0.1820, weighted_loss: 0.1990, label: 1, bag_size: 1402
batch 539, loss: 0.4031, instance_loss: 0.3100, weighted_loss: 0.3752, label: 1, bag_size: 1152


class 0 clustering acc 0.9940366972477064: correct 21670/21800
class 1 clustering acc 0.28784403669724773: correct 1255/4360
Epoch: 6, train_loss: 0.6646, train_clustering_loss:  0.3407, train_error: 0.2367
class 0: acc 0.7321428571428571, correct 82/112
class 1: acc 0.6637168141592921, correct 75/113
class 2: acc 0.7391304347826086, correct 85/115
class 3: acc 0.8446601941747572, correct 87/103
class 4: acc 0.8529411764705882, correct 87/102

Val Set, val_loss: 1.0021, val_error: 0.4000, auc: 0.9054
class 0 clustering acc 0.991: correct 1982/2000
class 1 clustering acc 0.21: correct 84/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.6, correct 6/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 4/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.5399, instance_loss: 0.5404, weighted_loss: 1.2400, label: 0, bag_size: 801
batch 39, loss: 1.9397, instance_loss: 0.9690, weighted_loss: 1.6485, label: 0, bag_size: 109
batch 59, loss: 0.6508, instance_loss: 0.4162, weighted_loss: 0.5804, label: 2, bag_size: 278
batch 79, loss: 0.3469, instance_loss: 0.2012, weighted_loss: 0.3032, label: 1, bag_size: 1325
batch 99, loss: 2.9972, instance_loss: 0.6574, weighted_loss: 2.2953, label: 1, bag_size: 386
batch 119, loss: 0.0111, instance_loss: 0.0805, weighted_loss: 0.0319, label: 3, bag_size: 43
batch 139, loss: 1.5302, instance_loss: 0.5569, weighted_loss: 1.2382, label: 3, bag_size: 343
batch 159, loss: 0.6577, instance_loss: 0.2572, weighted_loss: 0.5376, label: 1, bag_size: 846
batch 179, loss: 0.1401, instance_loss: 0.0891, weighted_loss: 0.1248, label: 3, bag_size: 405
batch 199, loss: 0.4789, instance_loss: 0.3500, weighted_loss: 0.4402, label: 2, bag_size: 525
batch 219, loss: 0.3560, instance_loss: 0.3714, weighted_loss: 0.3606, label: 0, bag_size: 432
batch 239, loss: 2.1164, instance_loss: 0.6666, weighted_loss: 1.6815, label: 2, bag_size: 629
batch 259, loss: 0.1812, instance_loss: 0.3141, weighted_loss: 0.2211, label: 0, bag_size: 1301
batch 279, loss: 0.5370, instance_loss: 0.3619, weighted_loss: 0.4844, label: 0, bag_size: 990
batch 299, loss: 0.4317, instance_loss: 0.3211, weighted_loss: 0.3985, label: 2, bag_size: 395
batch 319, loss: 1.5243, instance_loss: 0.5133, weighted_loss: 1.2210, label: 0, bag_size: 1257
batch 339, loss: 0.9875, instance_loss: 0.5675, weighted_loss: 0.8615, label: 2, bag_size: 1148
batch 359, loss: 0.4478, instance_loss: 0.5864, weighted_loss: 0.4893, label: 0, bag_size: 118
batch 379, loss: 0.0522, instance_loss: 0.1177, weighted_loss: 0.0719, label: 3, bag_size: 26
batch 399, loss: 0.4429, instance_loss: 0.3602, weighted_loss: 0.4181, label: 2, bag_size: 863
batch 419, loss: 1.8625, instance_loss: 0.6523, weighted_loss: 1.4994, label: 3, bag_size: 230
batch 439, loss: 0.8440, instance_loss: 0.6281, weighted_loss: 0.7793, label: 0, bag_size: 116
batch 459, loss: 0.4655, instance_loss: 0.2864, weighted_loss: 0.4118, label: 1, bag_size: 405
batch 479, loss: 1.8299, instance_loss: 0.5979, weighted_loss: 1.4603, label: 2, bag_size: 356
batch 499, loss: 0.7278, instance_loss: 0.3875, weighted_loss: 0.6258, label: 0, bag_size: 545
batch 519, loss: 0.5859, instance_loss: 0.4234, weighted_loss: 0.5372, label: 2, bag_size: 571
batch 539, loss: 0.2472, instance_loss: 0.2039, weighted_loss: 0.2342, label: 4, bag_size: 55


class 0 clustering acc 0.9902293577981651: correct 21587/21800
class 1 clustering acc 0.3057339449541284: correct 1333/4360
Epoch: 7, train_loss: 0.6308, train_clustering_loss:  0.3442, train_error: 0.2404
class 0: acc 0.7923076923076923, correct 103/130
class 1: acc 0.7058823529411765, correct 72/102
class 2: acc 0.6, correct 63/105
class 3: acc 0.8660714285714286, correct 97/112
class 4: acc 0.8229166666666666, correct 79/96

Val Set, val_loss: 0.9179, val_error: 0.4200, auc: 0.9111
class 0 clustering acc 0.9975: correct 1995/2000
class 1 clustering acc 0.2025: correct 81/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.5, correct 5/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.4166666666666667, correct 5/12
Validation loss decreased (0.958295 --> 0.917938).  Saving model ...


batch 19, loss: 0.4896, instance_loss: 0.4118, weighted_loss: 0.4662, label: 2, bag_size: 1700
batch 39, loss: 0.0840, instance_loss: 0.2565, weighted_loss: 0.1357, label: 4, bag_size: 388
batch 59, loss: 0.5074, instance_loss: 0.4685, weighted_loss: 0.4957, label: 0, bag_size: 476
batch 79, loss: 1.0055, instance_loss: 0.7248, weighted_loss: 0.9213, label: 0, bag_size: 143
batch 99, loss: 0.4225, instance_loss: 0.2802, weighted_loss: 0.3798, label: 1, bag_size: 504
batch 119, loss: 0.6675, instance_loss: 0.3964, weighted_loss: 0.5862, label: 2, bag_size: 2703
batch 139, loss: 0.9425, instance_loss: 0.4054, weighted_loss: 0.7814, label: 2, bag_size: 1047
batch 159, loss: 0.6203, instance_loss: 0.3807, weighted_loss: 0.5484, label: 0, bag_size: 294
batch 179, loss: 0.6468, instance_loss: 0.4114, weighted_loss: 0.5762, label: 0, bag_size: 552
batch 199, loss: 0.3844, instance_loss: 0.2674, weighted_loss: 0.3493, label: 1, bag_size: 682
batch 219, loss: 0.0380, instance_loss: 0.1157, weighted_loss: 0.0613, label: 3, bag_size: 34
batch 239, loss: 1.5705, instance_loss: 0.4503, weighted_loss: 1.2345, label: 2, bag_size: 511
batch 259, loss: 0.0086, instance_loss: 0.1981, weighted_loss: 0.0654, label: 3, bag_size: 16
batch 279, loss: 0.4756, instance_loss: 0.3745, weighted_loss: 0.4453, label: 0, bag_size: 424
batch 299, loss: 1.0993, instance_loss: 0.4500, weighted_loss: 0.9045, label: 4, bag_size: 947
batch 319, loss: 0.2792, instance_loss: 0.2347, weighted_loss: 0.2659, label: 1, bag_size: 534
batch 339, loss: 0.0472, instance_loss: 0.1152, weighted_loss: 0.0676, label: 3, bag_size: 33
batch 359, loss: 1.5785, instance_loss: 0.5409, weighted_loss: 1.2672, label: 1, bag_size: 377
batch 379, loss: 0.4515, instance_loss: 0.5053, weighted_loss: 0.4677, label: 1, bag_size: 319
batch 399, loss: 1.7466, instance_loss: 0.4815, weighted_loss: 1.3671, label: 4, bag_size: 974
batch 419, loss: 0.5671, instance_loss: 0.4209, weighted_loss: 0.5233, label: 4, bag_size: 524
batch 439, loss: 0.1695, instance_loss: 0.1744, weighted_loss: 0.1710, label: 1, bag_size: 346
batch 459, loss: 0.0165, instance_loss: 0.1532, weighted_loss: 0.0575, label: 3, bag_size: 46
batch 479, loss: 0.0547, instance_loss: 0.1274, weighted_loss: 0.0765, label: 4, bag_size: 168
batch 499, loss: 0.2363, instance_loss: 0.2208, weighted_loss: 0.2316, label: 2, bag_size: 839
batch 519, loss: 0.0193, instance_loss: 0.1696, weighted_loss: 0.0644, label: 3, bag_size: 18
batch 539, loss: 1.0403, instance_loss: 0.4857, weighted_loss: 0.8739, label: 0, bag_size: 759


class 0 clustering acc 0.9920183486238532: correct 21626/21800
class 1 clustering acc 0.3130733944954128: correct 1365/4360
Epoch: 8, train_loss: 0.6147, train_clustering_loss:  0.3367, train_error: 0.2165
class 0: acc 0.82, correct 82/100
class 1: acc 0.7, correct 77/110
class 2: acc 0.6756756756756757, correct 75/111
class 3: acc 0.8494623655913979, correct 79/93
class 4: acc 0.8702290076335878, correct 114/131

Val Set, val_loss: 0.7694, val_error: 0.3000, auc: 0.9108
class 0 clustering acc 0.9955: correct 1991/2000
class 1 clustering acc 0.2175: correct 87/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.8333333333333334, correct 10/12
Validation loss decreased (0.917938 --> 0.769402).  Saving model ...


batch 19, loss: 0.0450, instance_loss: 0.1871, weighted_loss: 0.0876, label: 4, bag_size: 185
batch 39, loss: 1.8738, instance_loss: 0.5742, weighted_loss: 1.4839, label: 2, bag_size: 629
batch 59, loss: 0.1704, instance_loss: 0.1788, weighted_loss: 0.1729, label: 1, bag_size: 346
batch 79, loss: 1.0053, instance_loss: 0.4698, weighted_loss: 0.8447, label: 0, bag_size: 423
batch 99, loss: 0.0162, instance_loss: 0.0867, weighted_loss: 0.0373, label: 3, bag_size: 28
batch 119, loss: 0.0131, instance_loss: 0.1288, weighted_loss: 0.0478, label: 3, bag_size: 18
batch 139, loss: 0.0793, instance_loss: 0.1219, weighted_loss: 0.0921, label: 0, bag_size: 1872
batch 159, loss: 0.0690, instance_loss: 0.0897, weighted_loss: 0.0752, label: 1, bag_size: 1277
batch 179, loss: 0.5567, instance_loss: 0.3261, weighted_loss: 0.4875, label: 2, bag_size: 461
batch 199, loss: 0.0157, instance_loss: 0.1475, weighted_loss: 0.0552, label: 3, bag_size: 31
batch 219, loss: 0.7891, instance_loss: 0.3467, weighted_loss: 0.6564, label: 4, bag_size: 1121
batch 239, loss: 0.9745, instance_loss: 0.4183, weighted_loss: 0.8076, label: 2, bag_size: 741
batch 259, loss: 1.1154, instance_loss: 0.4935, weighted_loss: 0.9289, label: 0, bag_size: 1301
batch 279, loss: 0.8208, instance_loss: 0.4032, weighted_loss: 0.6956, label: 2, bag_size: 345
batch 299, loss: 0.3735, instance_loss: 0.3169, weighted_loss: 0.3565, label: 2, bag_size: 317
batch 319, loss: 0.5138, instance_loss: 0.2861, weighted_loss: 0.4455, label: 1, bag_size: 242
batch 339, loss: 0.4794, instance_loss: 0.4693, weighted_loss: 0.4764, label: 2, bag_size: 649
batch 359, loss: 1.0657, instance_loss: 0.5984, weighted_loss: 0.9255, label: 3, bag_size: 791
batch 379, loss: 0.3915, instance_loss: 0.4672, weighted_loss: 0.4142, label: 4, bag_size: 1357
batch 399, loss: 1.8286, instance_loss: 0.6789, weighted_loss: 1.4837, label: 2, bag_size: 934
batch 419, loss: 0.8582, instance_loss: 0.4594, weighted_loss: 0.7386, label: 2, bag_size: 357
batch 439, loss: 2.0005, instance_loss: 0.6643, weighted_loss: 1.5997, label: 1, bag_size: 319
batch 459, loss: 0.0597, instance_loss: 0.1176, weighted_loss: 0.0771, label: 4, bag_size: 44
batch 479, loss: 0.1620, instance_loss: 0.1841, weighted_loss: 0.1686, label: 3, bag_size: 1399
batch 499, loss: 1.6731, instance_loss: 0.4721, weighted_loss: 1.3128, label: 4, bag_size: 974
batch 519, loss: 0.1114, instance_loss: 0.2038, weighted_loss: 0.1391, label: 0, bag_size: 375
batch 539, loss: 0.1693, instance_loss: 0.1686, weighted_loss: 0.1691, label: 1, bag_size: 288


class 0 clustering acc 0.9918348623853211: correct 21622/21800
class 1 clustering acc 0.3431192660550459: correct 1496/4360
Epoch: 9, train_loss: 0.5556, train_clustering_loss:  0.3193, train_error: 0.1890
class 0: acc 0.8442622950819673, correct 103/122
class 1: acc 0.693069306930693, correct 70/101
class 2: acc 0.7358490566037735, correct 78/106
class 3: acc 0.8518518518518519, correct 92/108
class 4: acc 0.9166666666666666, correct 99/108

Val Set, val_loss: 0.8536, val_error: 0.3400, auc: 0.9101
class 0 clustering acc 0.993: correct 1986/2000
class 1 clustering acc 0.2475: correct 99/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4918, instance_loss: 0.3566, weighted_loss: 0.4513, label: 2, bag_size: 1052
batch 39, loss: 0.1519, instance_loss: 0.2582, weighted_loss: 0.1838, label: 1, bag_size: 858
batch 59, loss: 0.0811, instance_loss: 0.1879, weighted_loss: 0.1131, label: 3, bag_size: 849
batch 79, loss: 0.0242, instance_loss: 0.0402, weighted_loss: 0.0290, label: 3, bag_size: 1559
batch 99, loss: 2.4767, instance_loss: 0.6553, weighted_loss: 1.9303, label: 1, bag_size: 657
batch 119, loss: 0.2330, instance_loss: 0.1936, weighted_loss: 0.2212, label: 1, bag_size: 949
batch 139, loss: 0.3515, instance_loss: 0.4620, weighted_loss: 0.3847, label: 2, bag_size: 330
batch 159, loss: 0.5427, instance_loss: 0.5070, weighted_loss: 0.5320, label: 4, bag_size: 826
batch 179, loss: 0.0278, instance_loss: 0.1416, weighted_loss: 0.0620, label: 3, bag_size: 26
batch 199, loss: 0.3374, instance_loss: 0.3220, weighted_loss: 0.3328, label: 4, bag_size: 24
batch 219, loss: 0.0254, instance_loss: 0.1192, weighted_loss: 0.0535, label: 3, bag_size: 143
batch 239, loss: 0.2633, instance_loss: 0.2402, weighted_loss: 0.2564, label: 2, bag_size: 1053
batch 259, loss: 0.7533, instance_loss: 0.3994, weighted_loss: 0.6472, label: 0, bag_size: 545
batch 279, loss: 0.4059, instance_loss: 0.3351, weighted_loss: 0.3846, label: 0, bag_size: 381
batch 299, loss: 0.0138, instance_loss: 0.3054, weighted_loss: 0.1013, label: 3, bag_size: 18
batch 319, loss: 0.0213, instance_loss: 0.1043, weighted_loss: 0.0462, label: 3, bag_size: 143
batch 339, loss: 0.0813, instance_loss: 0.1669, weighted_loss: 0.1070, label: 0, bag_size: 246
batch 359, loss: 0.0115, instance_loss: 0.0779, weighted_loss: 0.0314, label: 3, bag_size: 19
batch 379, loss: 0.0074, instance_loss: 0.1602, weighted_loss: 0.0532, label: 3, bag_size: 20
batch 399, loss: 0.0623, instance_loss: 0.1824, weighted_loss: 0.0983, label: 0, bag_size: 524
batch 419, loss: 1.5514, instance_loss: 0.4842, weighted_loss: 1.2313, label: 1, bag_size: 435
batch 439, loss: 0.2085, instance_loss: 0.1454, weighted_loss: 0.1896, label: 1, bag_size: 903
batch 459, loss: 1.2488, instance_loss: 0.6023, weighted_loss: 1.0549, label: 2, bag_size: 1128
batch 479, loss: 0.3625, instance_loss: 0.2109, weighted_loss: 0.3170, label: 1, bag_size: 682
batch 499, loss: 1.2487, instance_loss: 0.6125, weighted_loss: 1.0578, label: 2, bag_size: 1069
batch 519, loss: 1.2280, instance_loss: 0.4313, weighted_loss: 0.9890, label: 3, bag_size: 1250
batch 539, loss: 0.5088, instance_loss: 0.3475, weighted_loss: 0.4604, label: 2, bag_size: 1039


class 0 clustering acc 0.9898165137614678: correct 21578/21800
class 1 clustering acc 0.36903669724770644: correct 1609/4360
Epoch: 10, train_loss: 0.5179, train_clustering_loss:  0.3142, train_error: 0.1945
class 0: acc 0.8928571428571429, correct 100/112
class 1: acc 0.6818181818181818, correct 75/110
class 2: acc 0.7065217391304348, correct 65/92
class 3: acc 0.8629032258064516, correct 107/124
class 4: acc 0.8598130841121495, correct 92/107

Val Set, val_loss: 0.8767, val_error: 0.3200, auc: 0.9079
class 0 clustering acc 0.9915: correct 1983/2000
class 1 clustering acc 0.2425: correct 97/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0359, instance_loss: 0.2406, weighted_loss: 0.0973, label: 3, bag_size: 18
batch 39, loss: 0.3900, instance_loss: 0.2187, weighted_loss: 0.3386, label: 1, bag_size: 1402
batch 59, loss: 1.0998, instance_loss: 0.6058, weighted_loss: 0.9516, label: 0, bag_size: 143
batch 79, loss: 1.1291, instance_loss: 0.3992, weighted_loss: 0.9101, label: 1, bag_size: 1559
batch 99, loss: 0.0161, instance_loss: 0.1183, weighted_loss: 0.0468, label: 4, bag_size: 40
batch 119, loss: 0.0521, instance_loss: 0.0920, weighted_loss: 0.0641, label: 1, bag_size: 1239
batch 139, loss: 0.0385, instance_loss: 0.0728, weighted_loss: 0.0488, label: 3, bag_size: 56
batch 159, loss: 0.1111, instance_loss: 0.1381, weighted_loss: 0.1192, label: 4, bag_size: 168
batch 179, loss: 0.3768, instance_loss: 0.7573, weighted_loss: 0.4909, label: 0, bag_size: 109
batch 199, loss: 0.0282, instance_loss: 0.0415, weighted_loss: 0.0322, label: 4, bag_size: 202
batch 219, loss: 0.0261, instance_loss: 0.0401, weighted_loss: 0.0303, label: 4, bag_size: 112
batch 239, loss: 0.2986, instance_loss: 0.1878, weighted_loss: 0.2653, label: 1, bag_size: 356
batch 259, loss: 0.2744, instance_loss: 0.4066, weighted_loss: 0.3140, label: 4, bag_size: 17
batch 279, loss: 1.3307, instance_loss: 0.5140, weighted_loss: 1.0857, label: 1, bag_size: 868
batch 299, loss: 0.2846, instance_loss: 0.2965, weighted_loss: 0.2882, label: 1, bag_size: 102
batch 319, loss: 0.0056, instance_loss: 0.1492, weighted_loss: 0.0487, label: 3, bag_size: 18
batch 339, loss: 0.1520, instance_loss: 0.2308, weighted_loss: 0.1756, label: 0, bag_size: 413
batch 359, loss: 1.3541, instance_loss: 0.5186, weighted_loss: 1.1035, label: 1, bag_size: 269
batch 379, loss: 0.2270, instance_loss: 0.2626, weighted_loss: 0.2377, label: 2, bag_size: 1514
batch 399, loss: 0.1573, instance_loss: 0.2224, weighted_loss: 0.1768, label: 3, bag_size: 1291
batch 419, loss: 2.0916, instance_loss: 0.5652, weighted_loss: 1.6337, label: 2, bag_size: 511
batch 439, loss: 1.1325, instance_loss: 0.4966, weighted_loss: 0.9417, label: 0, bag_size: 423
batch 459, loss: 1.4017, instance_loss: 0.5108, weighted_loss: 1.1344, label: 2, bag_size: 537
batch 479, loss: 0.4448, instance_loss: 0.4976, weighted_loss: 0.4607, label: 4, bag_size: 1357
batch 499, loss: 2.0865, instance_loss: 0.7238, weighted_loss: 1.6777, label: 3, bag_size: 283
batch 519, loss: 0.5584, instance_loss: 0.4557, weighted_loss: 0.5276, label: 2, bag_size: 1218
batch 539, loss: 0.0347, instance_loss: 0.0388, weighted_loss: 0.0359, label: 4, bag_size: 157


class 0 clustering acc 0.9889449541284404: correct 21559/21800
class 1 clustering acc 0.3958715596330275: correct 1726/4360
Epoch: 11, train_loss: 0.5270, train_clustering_loss:  0.3062, train_error: 0.2000
class 0: acc 0.875, correct 105/120
class 1: acc 0.6495726495726496, correct 76/117
class 2: acc 0.6703296703296703, correct 61/91
class 3: acc 0.8962264150943396, correct 95/106
class 4: acc 0.8918918918918919, correct 99/111

Val Set, val_loss: 0.8009, val_error: 0.3400, auc: 0.9108
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.265: correct 106/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.4, correct 4/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.75, correct 9/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1671, instance_loss: 0.1997, weighted_loss: 0.1769, label: 4, bag_size: 134
batch 39, loss: 0.1602, instance_loss: 0.4233, weighted_loss: 0.2391, label: 0, bag_size: 129
batch 59, loss: 0.0239, instance_loss: 0.1308, weighted_loss: 0.0560, label: 3, bag_size: 46
batch 79, loss: 0.0370, instance_loss: 0.0632, weighted_loss: 0.0449, label: 4, bag_size: 147
batch 99, loss: 2.4595, instance_loss: 0.8756, weighted_loss: 1.9843, label: 2, bag_size: 758
batch 119, loss: 0.1617, instance_loss: 0.2008, weighted_loss: 0.1734, label: 1, bag_size: 1426
batch 139, loss: 0.2976, instance_loss: 0.2985, weighted_loss: 0.2979, label: 2, bag_size: 1164
batch 159, loss: 0.3445, instance_loss: 0.3221, weighted_loss: 0.3378, label: 2, bag_size: 265
batch 179, loss: 0.1889, instance_loss: 0.0749, weighted_loss: 0.1547, label: 3, bag_size: 43
batch 199, loss: 0.1525, instance_loss: 0.0981, weighted_loss: 0.1362, label: 3, bag_size: 1172
batch 219, loss: 0.4325, instance_loss: 0.3150, weighted_loss: 0.3973, label: 0, bag_size: 545
batch 239, loss: 0.0086, instance_loss: 0.1267, weighted_loss: 0.0440, label: 4, bag_size: 72
batch 259, loss: 0.7093, instance_loss: 0.7362, weighted_loss: 0.7173, label: 0, bag_size: 109
batch 279, loss: 3.1513, instance_loss: 0.7976, weighted_loss: 2.4452, label: 4, bag_size: 511
batch 299, loss: 0.0439, instance_loss: 0.2128, weighted_loss: 0.0946, label: 4, bag_size: 1357
batch 319, loss: 0.1097, instance_loss: 0.1488, weighted_loss: 0.1214, label: 1, bag_size: 1426
batch 339, loss: 0.2725, instance_loss: 0.2745, weighted_loss: 0.2731, label: 2, bag_size: 1242
batch 359, loss: 0.0189, instance_loss: 0.2042, weighted_loss: 0.0745, label: 3, bag_size: 20
batch 379, loss: 0.2355, instance_loss: 0.2672, weighted_loss: 0.2450, label: 2, bag_size: 499
batch 399, loss: 0.0034, instance_loss: 0.0944, weighted_loss: 0.0307, label: 3, bag_size: 18
batch 419, loss: 0.0248, instance_loss: 0.1420, weighted_loss: 0.0600, label: 3, bag_size: 16
batch 439, loss: 0.0334, instance_loss: 0.0980, weighted_loss: 0.0528, label: 4, bag_size: 63
batch 459, loss: 0.6511, instance_loss: 0.4676, weighted_loss: 0.5960, label: 2, bag_size: 828
batch 479, loss: 0.2302, instance_loss: 0.1671, weighted_loss: 0.2113, label: 3, bag_size: 1399
batch 499, loss: 0.4986, instance_loss: 0.5784, weighted_loss: 0.5225, label: 2, bag_size: 1416
batch 519, loss: 0.0094, instance_loss: 0.0793, weighted_loss: 0.0304, label: 3, bag_size: 143
batch 539, loss: 0.6997, instance_loss: 0.4927, weighted_loss: 0.6376, label: 4, bag_size: 817


class 0 clustering acc 0.98848623853211: correct 21549/21800
class 1 clustering acc 0.38279816513761467: correct 1669/4360
Epoch: 12, train_loss: 0.5095, train_clustering_loss:  0.3161, train_error: 0.1780
class 0: acc 0.8857142857142857, correct 93/105
class 1: acc 0.696969696969697, correct 69/99
class 2: acc 0.7289719626168224, correct 78/107
class 3: acc 0.9043478260869565, correct 104/115
class 4: acc 0.8739495798319328, correct 104/119

Val Set, val_loss: 0.9259, val_error: 0.4000, auc: 0.9050
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.6, correct 6/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4337, instance_loss: 0.4271, weighted_loss: 0.4317, label: 2, bag_size: 684
batch 39, loss: 0.1378, instance_loss: 0.1760, weighted_loss: 0.1493, label: 1, bag_size: 890
batch 59, loss: 0.0259, instance_loss: 0.1361, weighted_loss: 0.0589, label: 3, bag_size: 16
batch 79, loss: 0.0303, instance_loss: 0.1512, weighted_loss: 0.0666, label: 3, bag_size: 16
batch 99, loss: 0.9851, instance_loss: 0.3332, weighted_loss: 0.7895, label: 4, bag_size: 974
batch 119, loss: 0.0365, instance_loss: 0.0720, weighted_loss: 0.0472, label: 4, bag_size: 110
batch 139, loss: 0.5713, instance_loss: 0.3385, weighted_loss: 0.5015, label: 0, bag_size: 410
batch 159, loss: 0.6439, instance_loss: 0.3123, weighted_loss: 0.5445, label: 1, bag_size: 470
batch 179, loss: 0.0210, instance_loss: 0.0550, weighted_loss: 0.0312, label: 4, bag_size: 147
batch 199, loss: 0.3274, instance_loss: 0.3599, weighted_loss: 0.3371, label: 0, bag_size: 1196
batch 219, loss: 0.0065, instance_loss: 0.1466, weighted_loss: 0.0486, label: 4, bag_size: 29
batch 239, loss: 1.0668, instance_loss: 0.5013, weighted_loss: 0.8972, label: 4, bag_size: 590
batch 259, loss: 0.0227, instance_loss: 0.1812, weighted_loss: 0.0703, label: 3, bag_size: 46
batch 279, loss: 0.2015, instance_loss: 0.2325, weighted_loss: 0.2108, label: 2, bag_size: 758
batch 299, loss: 0.0213, instance_loss: 0.3564, weighted_loss: 0.1219, label: 4, bag_size: 24
batch 319, loss: 0.0666, instance_loss: 0.2447, weighted_loss: 0.1201, label: 4, bag_size: 974
batch 339, loss: 0.4937, instance_loss: 0.3543, weighted_loss: 0.4519, label: 2, bag_size: 1218
batch 359, loss: 0.4972, instance_loss: 0.4772, weighted_loss: 0.4912, label: 0, bag_size: 148
batch 379, loss: 0.0441, instance_loss: 0.2846, weighted_loss: 0.1162, label: 3, bag_size: 15
batch 399, loss: 0.4884, instance_loss: 0.3691, weighted_loss: 0.4526, label: 0, bag_size: 1196
batch 419, loss: 0.0103, instance_loss: 0.1743, weighted_loss: 0.0595, label: 3, bag_size: 18
batch 439, loss: 0.0777, instance_loss: 0.3439, weighted_loss: 0.1576, label: 0, bag_size: 128
batch 459, loss: 1.8586, instance_loss: 0.7215, weighted_loss: 1.5175, label: 4, bag_size: 366
batch 479, loss: 0.2704, instance_loss: 0.2881, weighted_loss: 0.2757, label: 0, bag_size: 340
batch 499, loss: 0.3187, instance_loss: 0.1599, weighted_loss: 0.2710, label: 1, bag_size: 847
batch 519, loss: 0.1827, instance_loss: 0.2344, weighted_loss: 0.1982, label: 2, bag_size: 1514
batch 539, loss: 0.2587, instance_loss: 0.2209, weighted_loss: 0.2474, label: 3, bag_size: 451


class 0 clustering acc 0.9904587155963303: correct 21592/21800
class 1 clustering acc 0.4061926605504587: correct 1771/4360
Epoch: 13, train_loss: 0.4627, train_clustering_loss:  0.3005, train_error: 0.1615
class 0: acc 0.9043478260869565, correct 104/115
class 1: acc 0.75, correct 87/116
class 2: acc 0.75, correct 78/104
class 3: acc 0.8857142857142857, correct 93/105
class 4: acc 0.9047619047619048, correct 95/105

Val Set, val_loss: 1.1191, val_error: 0.3600, auc: 0.8934
class 0 clustering acc 0.9875: correct 1975/2000
class 1 clustering acc 0.28: correct 112/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6, correct 3/5
class 4: acc 0.3333333333333333, correct 4/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.6437, instance_loss: 0.7060, weighted_loss: 1.3624, label: 4, bag_size: 817
batch 39, loss: 0.4485, instance_loss: 0.3214, weighted_loss: 0.4104, label: 0, bag_size: 424
batch 59, loss: 0.1563, instance_loss: 0.2498, weighted_loss: 0.1843, label: 0, bag_size: 760
batch 79, loss: 0.2025, instance_loss: 0.2411, weighted_loss: 0.2141, label: 2, bag_size: 480
batch 99, loss: 0.5813, instance_loss: 0.2470, weighted_loss: 0.4810, label: 2, bag_size: 1533
batch 119, loss: 1.7525, instance_loss: 0.6782, weighted_loss: 1.4302, label: 1, bag_size: 936
batch 139, loss: 0.0176, instance_loss: 0.0931, weighted_loss: 0.0402, label: 0, bag_size: 382
batch 159, loss: 0.0440, instance_loss: 0.2080, weighted_loss: 0.0932, label: 0, bag_size: 760
batch 179, loss: 0.0293, instance_loss: 0.0632, weighted_loss: 0.0395, label: 3, bag_size: 97
batch 199, loss: 0.0125, instance_loss: 0.0632, weighted_loss: 0.0277, label: 4, bag_size: 160
batch 219, loss: 0.0442, instance_loss: 0.3390, weighted_loss: 0.1326, label: 4, bag_size: 1176
batch 239, loss: 0.5993, instance_loss: 0.4139, weighted_loss: 0.5437, label: 1, bag_size: 343
batch 259, loss: 0.6357, instance_loss: 0.8498, weighted_loss: 0.6999, label: 0, bag_size: 163
batch 279, loss: 0.1481, instance_loss: 0.0869, weighted_loss: 0.1298, label: 3, bag_size: 405
batch 299, loss: 0.2992, instance_loss: 0.5560, weighted_loss: 0.3762, label: 1, bag_size: 818
batch 319, loss: 0.0157, instance_loss: 0.0467, weighted_loss: 0.0250, label: 4, bag_size: 150
batch 339, loss: 0.0030, instance_loss: 0.0859, weighted_loss: 0.0279, label: 4, bag_size: 94
batch 359, loss: 0.1029, instance_loss: 0.1289, weighted_loss: 0.1107, label: 1, bag_size: 949
batch 379, loss: 0.1804, instance_loss: 0.3273, weighted_loss: 0.2245, label: 1, bag_size: 343
batch 399, loss: 0.5866, instance_loss: 0.5789, weighted_loss: 0.5843, label: 0, bag_size: 163
batch 419, loss: 0.0078, instance_loss: 0.0905, weighted_loss: 0.0326, label: 3, bag_size: 31
batch 439, loss: 1.2868, instance_loss: 0.4892, weighted_loss: 1.0475, label: 1, bag_size: 487
batch 459, loss: 0.1997, instance_loss: 0.2617, weighted_loss: 0.2183, label: 0, bag_size: 521
batch 479, loss: 0.8105, instance_loss: 0.4025, weighted_loss: 0.6881, label: 0, bag_size: 1332
batch 499, loss: 0.0096, instance_loss: 0.1474, weighted_loss: 0.0509, label: 3, bag_size: 16
batch 519, loss: 0.3047, instance_loss: 0.2226, weighted_loss: 0.2801, label: 1, bag_size: 598
batch 539, loss: 0.0201, instance_loss: 0.0628, weighted_loss: 0.0329, label: 4, bag_size: 79


class 0 clustering acc 0.9883944954128441: correct 21547/21800
class 1 clustering acc 0.40389908256880735: correct 1761/4360
Epoch: 14, train_loss: 0.4291, train_clustering_loss:  0.2944, train_error: 0.1486
class 0: acc 0.9411764705882353, correct 96/102
class 1: acc 0.7115384615384616, correct 74/104
class 2: acc 0.8053097345132744, correct 91/113
class 3: acc 0.8910891089108911, correct 90/101
class 4: acc 0.904, correct 113/125

Val Set, val_loss: 0.9229, val_error: 0.3000, auc: 0.9033
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.3025: correct 121/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.2060, instance_loss: 0.5579, weighted_loss: 1.0116, label: 1, bag_size: 868
batch 39, loss: 0.0075, instance_loss: 0.1592, weighted_loss: 0.0530, label: 3, bag_size: 20
batch 59, loss: 0.7416, instance_loss: 0.3861, weighted_loss: 0.6350, label: 1, bag_size: 1559
batch 79, loss: 1.7755, instance_loss: 0.6135, weighted_loss: 1.4269, label: 0, bag_size: 868
batch 99, loss: 1.4935, instance_loss: 0.6809, weighted_loss: 1.2497, label: 3, bag_size: 671
batch 119, loss: 0.0652, instance_loss: 0.1417, weighted_loss: 0.0881, label: 0, bag_size: 552
batch 139, loss: 0.1569, instance_loss: 0.3421, weighted_loss: 0.2125, label: 0, bag_size: 1196
batch 159, loss: 0.0027, instance_loss: 0.0934, weighted_loss: 0.0299, label: 3, bag_size: 37
batch 179, loss: 0.0384, instance_loss: 0.2262, weighted_loss: 0.0948, label: 0, bag_size: 1143
batch 199, loss: 0.0288, instance_loss: 0.1599, weighted_loss: 0.0681, label: 0, bag_size: 1235
batch 219, loss: 0.9630, instance_loss: 0.7030, weighted_loss: 0.8850, label: 1, bag_size: 917
batch 239, loss: 0.0867, instance_loss: 0.4997, weighted_loss: 0.2106, label: 0, bag_size: 163
batch 259, loss: 0.0222, instance_loss: 0.0594, weighted_loss: 0.0333, label: 4, bag_size: 38
batch 279, loss: 0.2121, instance_loss: 0.2434, weighted_loss: 0.2215, label: 2, bag_size: 1123
batch 299, loss: 0.0030, instance_loss: 0.0868, weighted_loss: 0.0281, label: 4, bag_size: 211
batch 319, loss: 0.0058, instance_loss: 0.1044, weighted_loss: 0.0354, label: 3, bag_size: 37
batch 339, loss: 0.2144, instance_loss: 0.4739, weighted_loss: 0.2923, label: 0, bag_size: 116
batch 359, loss: 0.4471, instance_loss: 0.3573, weighted_loss: 0.4202, label: 2, bag_size: 245
batch 379, loss: 1.4573, instance_loss: 0.8200, weighted_loss: 1.2661, label: 2, bag_size: 934
batch 399, loss: 1.2812, instance_loss: 0.4847, weighted_loss: 1.0422, label: 1, bag_size: 747
batch 419, loss: 1.3666, instance_loss: 0.4716, weighted_loss: 1.0981, label: 2, bag_size: 948
batch 439, loss: 0.0097, instance_loss: 0.1090, weighted_loss: 0.0395, label: 4, bag_size: 202
batch 459, loss: 0.1874, instance_loss: 0.2421, weighted_loss: 0.2038, label: 1, bag_size: 898
batch 479, loss: 0.5911, instance_loss: 0.4588, weighted_loss: 0.5514, label: 2, bag_size: 1047
batch 499, loss: 0.0237, instance_loss: 0.0624, weighted_loss: 0.0353, label: 1, bag_size: 286
batch 519, loss: 0.2900, instance_loss: 0.2039, weighted_loss: 0.2642, label: 3, bag_size: 1559
batch 539, loss: 1.5471, instance_loss: 0.7331, weighted_loss: 1.3029, label: 3, bag_size: 283


class 0 clustering acc 0.9887614678899083: correct 21555/21800
class 1 clustering acc 0.45848623853211007: correct 1999/4360
Epoch: 15, train_loss: 0.4023, train_clustering_loss:  0.2817, train_error: 0.1394
class 0: acc 0.9056603773584906, correct 96/106
class 1: acc 0.7769230769230769, correct 101/130
class 2: acc 0.8380952380952381, correct 88/105
class 3: acc 0.88, correct 88/100
class 4: acc 0.9230769230769231, correct 96/104

Val Set, val_loss: 0.7719, val_error: 0.2800, auc: 0.9206
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.3575: correct 143/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.7, correct 7/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.75, correct 9/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0579, instance_loss: 0.2170, weighted_loss: 0.1056, label: 1, bag_size: 790
batch 39, loss: 0.9673, instance_loss: 0.5532, weighted_loss: 0.8430, label: 2, bag_size: 3236
batch 59, loss: 0.4663, instance_loss: 0.3239, weighted_loss: 0.4236, label: 1, bag_size: 913
batch 79, loss: 0.0609, instance_loss: 0.1542, weighted_loss: 0.0889, label: 0, bag_size: 375
batch 99, loss: 0.3612, instance_loss: 0.3102, weighted_loss: 0.3459, label: 1, bag_size: 405
batch 119, loss: 0.0532, instance_loss: 0.1062, weighted_loss: 0.0691, label: 3, bag_size: 1172
batch 139, loss: 1.0610, instance_loss: 0.5158, weighted_loss: 0.8975, label: 2, bag_size: 1167
batch 159, loss: 0.1328, instance_loss: 0.1996, weighted_loss: 0.1528, label: 4, bag_size: 38
batch 179, loss: 1.6028, instance_loss: 0.6794, weighted_loss: 1.3258, label: 1, bag_size: 917
batch 199, loss: 2.9381, instance_loss: 0.6998, weighted_loss: 2.2666, label: 4, bag_size: 1357
batch 219, loss: 0.0069, instance_loss: 0.1204, weighted_loss: 0.0409, label: 0, bag_size: 1143
batch 239, loss: 0.0487, instance_loss: 0.1745, weighted_loss: 0.0865, label: 0, bag_size: 382
batch 259, loss: 0.0195, instance_loss: 0.0985, weighted_loss: 0.0432, label: 0, bag_size: 382
batch 279, loss: 1.3682, instance_loss: 0.4718, weighted_loss: 1.0993, label: 1, bag_size: 887
batch 299, loss: 0.4826, instance_loss: 0.3786, weighted_loss: 0.4514, label: 2, bag_size: 986
batch 319, loss: 2.0140, instance_loss: 0.6080, weighted_loss: 1.5922, label: 1, bag_size: 770
batch 339, loss: 0.0103, instance_loss: 0.0418, weighted_loss: 0.0197, label: 3, bag_size: 63
batch 359, loss: 0.0127, instance_loss: 0.0819, weighted_loss: 0.0334, label: 3, bag_size: 28
batch 379, loss: 0.5140, instance_loss: 0.3400, weighted_loss: 0.4618, label: 2, bag_size: 1024
batch 399, loss: 0.0622, instance_loss: 0.1276, weighted_loss: 0.0818, label: 4, bag_size: 211
batch 419, loss: 0.1027, instance_loss: 0.0635, weighted_loss: 0.0909, label: 4, bag_size: 96
batch 439, loss: 0.0031, instance_loss: 0.1174, weighted_loss: 0.0374, label: 3, bag_size: 20
batch 459, loss: 0.0666, instance_loss: 0.1181, weighted_loss: 0.0821, label: 3, bag_size: 28
batch 479, loss: 2.4317, instance_loss: 0.9657, weighted_loss: 1.9919, label: 4, bag_size: 511
batch 499, loss: 0.0136, instance_loss: 0.0751, weighted_loss: 0.0320, label: 4, bag_size: 79
batch 519, loss: 0.4555, instance_loss: 0.2958, weighted_loss: 0.4076, label: 3, bag_size: 316
batch 539, loss: 0.0045, instance_loss: 0.0497, weighted_loss: 0.0181, label: 4, bag_size: 167


class 0 clustering acc 0.9876605504587156: correct 21531/21800
class 1 clustering acc 0.4270642201834862: correct 1862/4360
Epoch: 16, train_loss: 0.4056, train_clustering_loss:  0.2971, train_error: 0.1523
class 0: acc 0.923728813559322, correct 109/118
class 1: acc 0.6956521739130435, correct 64/92
class 2: acc 0.7927927927927928, correct 88/111
class 3: acc 0.8849557522123894, correct 100/113
class 4: acc 0.9099099099099099, correct 101/111

Val Set, val_loss: 0.8816, val_error: 0.2800, auc: 0.9132
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.34: correct 136/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.7, correct 7/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.75, correct 9/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1622, instance_loss: 0.1481, weighted_loss: 0.1580, label: 3, bag_size: 556
batch 39, loss: 0.5458, instance_loss: 0.4588, weighted_loss: 0.5197, label: 2, bag_size: 324
batch 59, loss: 0.3450, instance_loss: 0.2856, weighted_loss: 0.3272, label: 1, bag_size: 846
batch 79, loss: 0.0197, instance_loss: 0.0625, weighted_loss: 0.0326, label: 3, bag_size: 115
batch 99, loss: 0.0213, instance_loss: 0.1219, weighted_loss: 0.0515, label: 3, bag_size: 28
batch 119, loss: 0.0733, instance_loss: 0.1686, weighted_loss: 0.1019, label: 3, bag_size: 34
batch 139, loss: 0.3638, instance_loss: 0.4823, weighted_loss: 0.3993, label: 2, bag_size: 1141
batch 159, loss: 0.0995, instance_loss: 0.1437, weighted_loss: 0.1128, label: 1, bag_size: 320
batch 179, loss: 0.1746, instance_loss: 0.4769, weighted_loss: 0.2653, label: 0, bag_size: 109
batch 199, loss: 0.1975, instance_loss: 0.2664, weighted_loss: 0.2182, label: 1, bag_size: 242
batch 219, loss: 0.0163, instance_loss: 0.1226, weighted_loss: 0.0482, label: 3, bag_size: 75
batch 239, loss: 0.0090, instance_loss: 0.0841, weighted_loss: 0.0315, label: 3, bag_size: 94
batch 259, loss: 0.1423, instance_loss: 0.2033, weighted_loss: 0.1606, label: 2, bag_size: 399
batch 279, loss: 0.0091, instance_loss: 0.0696, weighted_loss: 0.0273, label: 3, bag_size: 75
batch 299, loss: 1.0421, instance_loss: 0.6413, weighted_loss: 0.9219, label: 2, bag_size: 720
batch 319, loss: 0.0294, instance_loss: 0.2696, weighted_loss: 0.1014, label: 4, bag_size: 29
batch 339, loss: 0.4702, instance_loss: 0.2645, weighted_loss: 0.4085, label: 1, bag_size: 343
batch 359, loss: 0.3814, instance_loss: 0.2524, weighted_loss: 0.3427, label: 0, bag_size: 570
batch 379, loss: 0.1451, instance_loss: 0.3153, weighted_loss: 0.1962, label: 4, bag_size: 297
batch 399, loss: 1.1351, instance_loss: 0.5620, weighted_loss: 0.9632, label: 2, bag_size: 471
batch 419, loss: 0.1508, instance_loss: 0.4354, weighted_loss: 0.2362, label: 0, bag_size: 109
batch 439, loss: 0.0542, instance_loss: 0.3221, weighted_loss: 0.1345, label: 0, bag_size: 118
batch 459, loss: 0.1317, instance_loss: 0.2652, weighted_loss: 0.1717, label: 3, bag_size: 952
batch 479, loss: 0.0660, instance_loss: 0.2399, weighted_loss: 0.1182, label: 3, bag_size: 849
batch 499, loss: 0.1188, instance_loss: 0.1274, weighted_loss: 0.1214, label: 1, bag_size: 938
batch 519, loss: 2.1356, instance_loss: 0.6288, weighted_loss: 1.6835, label: 3, bag_size: 630
batch 539, loss: 0.0355, instance_loss: 0.0733, weighted_loss: 0.0468, label: 1, bag_size: 938


class 0 clustering acc 0.9870183486238532: correct 21517/21800
class 1 clustering acc 0.44541284403669723: correct 1942/4360
Epoch: 17, train_loss: 0.4547, train_clustering_loss:  0.2973, train_error: 0.1578
class 0: acc 0.9444444444444444, correct 102/108
class 1: acc 0.7288135593220338, correct 86/118
class 2: acc 0.7980769230769231, correct 83/104
class 3: acc 0.8761904761904762, correct 92/105
class 4: acc 0.8727272727272727, correct 96/110

Val Set, val_loss: 0.9848, val_error: 0.3600, auc: 0.9043
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.3575: correct 143/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 4/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0169, instance_loss: 0.2558, weighted_loss: 0.0886, label: 3, bag_size: 60
batch 39, loss: 1.0401, instance_loss: 0.3088, weighted_loss: 0.8207, label: 1, bag_size: 1646
batch 59, loss: 1.5255, instance_loss: 0.5786, weighted_loss: 1.2414, label: 3, bag_size: 305
batch 79, loss: 1.0138, instance_loss: 0.4630, weighted_loss: 0.8485, label: 2, bag_size: 676
batch 99, loss: 0.0102, instance_loss: 0.1118, weighted_loss: 0.0407, label: 3, bag_size: 29
batch 119, loss: 0.0498, instance_loss: 0.1335, weighted_loss: 0.0749, label: 4, bag_size: 101
batch 139, loss: 0.1147, instance_loss: 0.1655, weighted_loss: 0.1299, label: 0, bag_size: 570
batch 159, loss: 0.0064, instance_loss: 0.1619, weighted_loss: 0.0530, label: 4, bag_size: 38
batch 179, loss: 0.3426, instance_loss: 0.2245, weighted_loss: 0.3072, label: 0, bag_size: 466
batch 199, loss: 0.0135, instance_loss: 0.0588, weighted_loss: 0.0271, label: 4, bag_size: 185
batch 219, loss: 0.5034, instance_loss: 0.6953, weighted_loss: 0.5610, label: 2, bag_size: 758
batch 239, loss: 0.5066, instance_loss: 0.2929, weighted_loss: 0.4425, label: 1, bag_size: 470
batch 259, loss: 0.2966, instance_loss: 0.2388, weighted_loss: 0.2793, label: 0, bag_size: 381
batch 279, loss: 0.0027, instance_loss: 0.1519, weighted_loss: 0.0474, label: 3, bag_size: 26
batch 299, loss: 2.5133, instance_loss: 0.7156, weighted_loss: 1.9740, label: 1, bag_size: 470
batch 319, loss: 0.4071, instance_loss: 0.3885, weighted_loss: 0.4015, label: 2, bag_size: 1197
batch 339, loss: 0.1387, instance_loss: 0.1553, weighted_loss: 0.1437, label: 2, bag_size: 399
batch 359, loss: 0.0889, instance_loss: 0.2740, weighted_loss: 0.1444, label: 0, bag_size: 807
batch 379, loss: 0.1674, instance_loss: 0.2046, weighted_loss: 0.1786, label: 2, bag_size: 1180
batch 399, loss: 1.3460, instance_loss: 0.6238, weighted_loss: 1.1294, label: 1, bag_size: 487
batch 419, loss: 0.0534, instance_loss: 0.1373, weighted_loss: 0.0786, label: 0, bag_size: 1301
batch 439, loss: 0.0209, instance_loss: 0.0604, weighted_loss: 0.0327, label: 3, bag_size: 43
batch 459, loss: 0.8022, instance_loss: 0.3695, weighted_loss: 0.6724, label: 0, bag_size: 801
batch 479, loss: 1.0316, instance_loss: 0.2672, weighted_loss: 0.8023, label: 2, bag_size: 2081
batch 499, loss: 0.0072, instance_loss: 0.0500, weighted_loss: 0.0200, label: 4, bag_size: 168
batch 519, loss: 0.0409, instance_loss: 0.3431, weighted_loss: 0.1316, label: 0, bag_size: 110
batch 539, loss: 0.0842, instance_loss: 0.1562, weighted_loss: 0.1058, label: 2, bag_size: 774


class 0 clustering acc 0.9874770642201834: correct 21527/21800
class 1 clustering acc 0.47477064220183485: correct 2070/4360
Epoch: 18, train_loss: 0.3746, train_clustering_loss:  0.2797, train_error: 0.1339
class 0: acc 0.9239130434782609, correct 85/92
class 1: acc 0.7586206896551724, correct 66/87
class 2: acc 0.8153846153846154, correct 106/130
class 3: acc 0.8770491803278688, correct 107/122
class 4: acc 0.9473684210526315, correct 108/114

Val Set, val_loss: 1.2088, val_error: 0.4000, auc: 0.8860
class 0 clustering acc 0.976: correct 1952/2000
class 1 clustering acc 0.365: correct 146/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6, correct 3/5
class 4: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.8417, instance_loss: 0.4446, weighted_loss: 0.7226, label: 4, bag_size: 590
batch 39, loss: 0.0119, instance_loss: 0.0883, weighted_loss: 0.0348, label: 4, bag_size: 157
batch 59, loss: 0.2213, instance_loss: 0.3447, weighted_loss: 0.2583, label: 3, bag_size: 706
batch 79, loss: 0.0660, instance_loss: 0.4736, weighted_loss: 0.1883, label: 0, bag_size: 122
batch 99, loss: 0.0068, instance_loss: 0.1747, weighted_loss: 0.0572, label: 3, bag_size: 53
batch 119, loss: 0.0081, instance_loss: 0.1177, weighted_loss: 0.0410, label: 3, bag_size: 1291
batch 139, loss: 0.5240, instance_loss: 0.4049, weighted_loss: 0.4882, label: 1, bag_size: 968
batch 159, loss: 0.2811, instance_loss: 0.3144, weighted_loss: 0.2911, label: 4, bag_size: 297
batch 179, loss: 0.2104, instance_loss: 0.2933, weighted_loss: 0.2353, label: 1, bag_size: 242
batch 199, loss: 0.0050, instance_loss: 0.1267, weighted_loss: 0.0415, label: 3, bag_size: 27
batch 219, loss: 0.2204, instance_loss: 0.2968, weighted_loss: 0.2433, label: 2, bag_size: 1180
batch 239, loss: 0.0679, instance_loss: 0.0699, weighted_loss: 0.0685, label: 3, bag_size: 556
batch 259, loss: 0.2289, instance_loss: 0.1978, weighted_loss: 0.2196, label: 1, bag_size: 1402
batch 279, loss: 0.2005, instance_loss: 0.1821, weighted_loss: 0.1950, label: 1, bag_size: 405
batch 299, loss: 0.9637, instance_loss: 0.3552, weighted_loss: 0.7812, label: 0, bag_size: 381
batch 319, loss: 0.0084, instance_loss: 0.1836, weighted_loss: 0.0610, label: 4, bag_size: 47
batch 339, loss: 0.2711, instance_loss: 0.3518, weighted_loss: 0.2953, label: 0, bag_size: 1527
batch 359, loss: 0.0207, instance_loss: 0.3471, weighted_loss: 0.1186, label: 0, bag_size: 109
batch 379, loss: 0.2385, instance_loss: 0.2052, weighted_loss: 0.2286, label: 3, bag_size: 316
batch 399, loss: 0.1400, instance_loss: 0.6234, weighted_loss: 0.2850, label: 1, bag_size: 319
batch 419, loss: 0.5614, instance_loss: 0.5308, weighted_loss: 0.5523, label: 2, bag_size: 1416
batch 439, loss: 0.5992, instance_loss: 0.4241, weighted_loss: 0.5466, label: 2, bag_size: 1410
batch 459, loss: 0.0109, instance_loss: 0.1663, weighted_loss: 0.0575, label: 3, bag_size: 53
batch 479, loss: 0.7736, instance_loss: 0.4669, weighted_loss: 0.6816, label: 2, bag_size: 356
batch 499, loss: 0.1530, instance_loss: 0.3824, weighted_loss: 0.2218, label: 0, bag_size: 128
batch 519, loss: 0.6485, instance_loss: 0.5148, weighted_loss: 0.6084, label: 4, bag_size: 1474
batch 539, loss: 0.0428, instance_loss: 0.0855, weighted_loss: 0.0556, label: 1, bag_size: 903


class 0 clustering acc 0.9880733944954129: correct 21540/21800
class 1 clustering acc 0.47591743119266056: correct 2075/4360
Epoch: 19, train_loss: 0.3898, train_clustering_loss:  0.2834, train_error: 0.1450
class 0: acc 0.9081632653061225, correct 89/98
class 1: acc 0.6972477064220184, correct 76/109
class 2: acc 0.7931034482758621, correct 92/116
class 3: acc 0.925, correct 111/120
class 4: acc 0.9607843137254902, correct 98/102

Val Set, val_loss: 0.8241, val_error: 0.2800, auc: 0.9255
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.385: correct 154/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2237, instance_loss: 0.2478, weighted_loss: 0.2309, label: 2, bag_size: 1155
batch 39, loss: 3.0112, instance_loss: 0.8398, weighted_loss: 2.3598, label: 4, bag_size: 511
batch 59, loss: 0.9170, instance_loss: 0.4552, weighted_loss: 0.7785, label: 0, bag_size: 962
batch 79, loss: 0.4349, instance_loss: 0.3012, weighted_loss: 0.3948, label: 2, bag_size: 828
batch 99, loss: 0.0024, instance_loss: 0.1132, weighted_loss: 0.0357, label: 4, bag_size: 91
batch 119, loss: 1.6139, instance_loss: 0.5376, weighted_loss: 1.2910, label: 1, bag_size: 868
batch 139, loss: 0.0933, instance_loss: 0.0842, weighted_loss: 0.0906, label: 1, bag_size: 1191
batch 159, loss: 0.0970, instance_loss: 0.3049, weighted_loss: 0.1593, label: 0, bag_size: 607
batch 179, loss: 0.0124, instance_loss: 0.1303, weighted_loss: 0.0477, label: 0, bag_size: 933
batch 199, loss: 0.0009, instance_loss: 0.0690, weighted_loss: 0.0213, label: 3, bag_size: 72
batch 219, loss: 0.3457, instance_loss: 0.5254, weighted_loss: 0.3997, label: 3, bag_size: 317
batch 239, loss: 0.2041, instance_loss: 0.2965, weighted_loss: 0.2319, label: 0, bag_size: 990
batch 259, loss: 0.0058, instance_loss: 0.0530, weighted_loss: 0.0200, label: 4, bag_size: 63
batch 279, loss: 0.0042, instance_loss: 0.0695, weighted_loss: 0.0238, label: 4, bag_size: 150
batch 299, loss: 0.0027, instance_loss: 0.3331, weighted_loss: 0.1019, label: 4, bag_size: 17
batch 319, loss: 0.3784, instance_loss: 0.3055, weighted_loss: 0.3565, label: 1, bag_size: 1646
batch 339, loss: 0.0841, instance_loss: 0.4193, weighted_loss: 0.1846, label: 3, bag_size: 936
batch 359, loss: 0.0024, instance_loss: 0.0635, weighted_loss: 0.0207, label: 4, bag_size: 78
batch 379, loss: 0.0063, instance_loss: 0.0314, weighted_loss: 0.0138, label: 4, bag_size: 83
batch 399, loss: 0.0146, instance_loss: 0.2283, weighted_loss: 0.0787, label: 4, bag_size: 19
batch 419, loss: 0.0096, instance_loss: 0.1222, weighted_loss: 0.0434, label: 4, bag_size: 79
batch 439, loss: 0.4103, instance_loss: 0.3126, weighted_loss: 0.3810, label: 0, bag_size: 200
batch 459, loss: 0.0099, instance_loss: 0.0397, weighted_loss: 0.0188, label: 0, bag_size: 382
batch 479, loss: 0.0004, instance_loss: 0.1701, weighted_loss: 0.0513, label: 4, bag_size: 20
batch 499, loss: 0.3204, instance_loss: 0.3214, weighted_loss: 0.3207, label: 4, bag_size: 636
batch 519, loss: 0.0066, instance_loss: 0.0924, weighted_loss: 0.0323, label: 4, bag_size: 47
batch 539, loss: 0.5493, instance_loss: 0.4589, weighted_loss: 0.5222, label: 1, bag_size: 838


class 0 clustering acc 0.9894495412844037: correct 21570/21800
class 1 clustering acc 0.5089449541284403: correct 2219/4360
Epoch: 20, train_loss: 0.3291, train_clustering_loss:  0.2609, train_error: 0.1193
class 0: acc 0.9183673469387755, correct 90/98
class 1: acc 0.8058252427184466, correct 83/103
class 2: acc 0.7475728155339806, correct 77/103
class 3: acc 0.944954128440367, correct 103/109
class 4: acc 0.9621212121212122, correct 127/132

Val Set, val_loss: 0.7849, val_error: 0.2600, auc: 0.9246
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.4075: correct 163/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.75, correct 9/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1120, instance_loss: 0.1853, weighted_loss: 0.1340, label: 0, bag_size: 756
batch 39, loss: 0.0360, instance_loss: 0.0406, weighted_loss: 0.0374, label: 1, bag_size: 847
batch 59, loss: 0.5778, instance_loss: 0.3837, weighted_loss: 0.5196, label: 2, bag_size: 1533
batch 79, loss: 0.2181, instance_loss: 0.2297, weighted_loss: 0.2216, label: 0, bag_size: 424
batch 99, loss: 0.2086, instance_loss: 0.2543, weighted_loss: 0.2223, label: 2, bag_size: 910
batch 119, loss: 0.0288, instance_loss: 0.2486, weighted_loss: 0.0947, label: 4, bag_size: 94
batch 139, loss: 0.0017, instance_loss: 0.1074, weighted_loss: 0.0334, label: 4, bag_size: 178
batch 159, loss: 0.0280, instance_loss: 0.0790, weighted_loss: 0.0433, label: 0, bag_size: 367
batch 179, loss: 1.2030, instance_loss: 0.4938, weighted_loss: 0.9903, label: 1, bag_size: 861
batch 199, loss: 0.3191, instance_loss: 0.2598, weighted_loss: 0.3013, label: 1, bag_size: 348
batch 219, loss: 0.0869, instance_loss: 0.2402, weighted_loss: 0.1329, label: 4, bag_size: 1278
batch 239, loss: 0.1594, instance_loss: 0.1084, weighted_loss: 0.1441, label: 3, bag_size: 556
batch 259, loss: 0.1258, instance_loss: 0.2072, weighted_loss: 0.1502, label: 2, bag_size: 839
batch 279, loss: 0.0094, instance_loss: 0.0604, weighted_loss: 0.0247, label: 0, bag_size: 382
batch 299, loss: 0.0241, instance_loss: 0.1868, weighted_loss: 0.0729, label: 3, bag_size: 18
batch 319, loss: 0.0006, instance_loss: 0.0629, weighted_loss: 0.0193, label: 4, bag_size: 167
batch 339, loss: 0.1925, instance_loss: 0.2350, weighted_loss: 0.2052, label: 1, bag_size: 1402
batch 359, loss: 0.0158, instance_loss: 0.3674, weighted_loss: 0.1213, label: 0, bag_size: 118
batch 379, loss: 0.1044, instance_loss: 0.1660, weighted_loss: 0.1229, label: 1, bag_size: 890
batch 399, loss: 0.3389, instance_loss: 0.1904, weighted_loss: 0.2944, label: 0, bag_size: 381
batch 419, loss: 0.0558, instance_loss: 0.1221, weighted_loss: 0.0757, label: 1, bag_size: 790
batch 439, loss: 1.0636, instance_loss: 0.4576, weighted_loss: 0.8818, label: 2, bag_size: 307
batch 459, loss: 0.1296, instance_loss: 0.4696, weighted_loss: 0.2316, label: 1, bag_size: 747
batch 479, loss: 0.4583, instance_loss: 0.3953, weighted_loss: 0.4394, label: 1, bag_size: 965
batch 499, loss: 0.0033, instance_loss: 0.0474, weighted_loss: 0.0165, label: 3, bag_size: 29
batch 519, loss: 0.1976, instance_loss: 0.2868, weighted_loss: 0.2244, label: 2, bag_size: 391
batch 539, loss: 0.0324, instance_loss: 0.2398, weighted_loss: 0.0946, label: 3, bag_size: 1253


class 0 clustering acc 0.9867431192660551: correct 21511/21800
class 1 clustering acc 0.46009174311926604: correct 2006/4360
Epoch: 21, train_loss: 0.3491, train_clustering_loss:  0.2920, train_error: 0.1303
class 0: acc 0.9357798165137615, correct 102/109
class 1: acc 0.7378640776699029, correct 76/103
class 2: acc 0.7818181818181819, correct 86/110
class 3: acc 0.9489795918367347, correct 93/98
class 4: acc 0.936, correct 117/125

Val Set, val_loss: 1.0318, val_error: 0.3200, auc: 0.9107
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.3675: correct 147/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2885, instance_loss: 0.4920, weighted_loss: 0.3496, label: 1, bag_size: 747
batch 39, loss: 0.0086, instance_loss: 0.2422, weighted_loss: 0.0787, label: 4, bag_size: 20
batch 59, loss: 0.0037, instance_loss: 0.0511, weighted_loss: 0.0179, label: 4, bag_size: 114
batch 79, loss: 0.6294, instance_loss: 0.4479, weighted_loss: 0.5749, label: 3, bag_size: 849
batch 99, loss: 0.0028, instance_loss: 0.0326, weighted_loss: 0.0118, label: 4, bag_size: 157
batch 119, loss: 1.1243, instance_loss: 0.5366, weighted_loss: 0.9480, label: 2, bag_size: 272
batch 139, loss: 0.0032, instance_loss: 0.0586, weighted_loss: 0.0198, label: 3, bag_size: 97
batch 159, loss: 0.0017, instance_loss: 0.0568, weighted_loss: 0.0182, label: 4, bag_size: 63
batch 179, loss: 0.0085, instance_loss: 0.0688, weighted_loss: 0.0266, label: 4, bag_size: 160
batch 199, loss: 1.1681, instance_loss: 0.5712, weighted_loss: 0.9891, label: 0, bag_size: 868
batch 219, loss: 0.0374, instance_loss: 0.3068, weighted_loss: 0.1182, label: 4, bag_size: 388
batch 239, loss: 0.2563, instance_loss: 0.2802, weighted_loss: 0.2635, label: 2, bag_size: 1148
batch 259, loss: 0.0098, instance_loss: 0.1603, weighted_loss: 0.0549, label: 3, bag_size: 50
batch 279, loss: 0.1386, instance_loss: 0.2890, weighted_loss: 0.1837, label: 4, bag_size: 817
batch 299, loss: 1.2527, instance_loss: 0.5617, weighted_loss: 1.0454, label: 1, bag_size: 887
batch 319, loss: 0.2665, instance_loss: 0.1269, weighted_loss: 0.2246, label: 1, bag_size: 320
batch 339, loss: 0.9104, instance_loss: 0.4236, weighted_loss: 0.7644, label: 0, bag_size: 1257
batch 359, loss: 0.1626, instance_loss: 0.3755, weighted_loss: 0.2265, label: 2, bag_size: 571
batch 379, loss: 5.3502, instance_loss: 1.7103, weighted_loss: 4.2583, label: 2, bag_size: 1108
batch 399, loss: 1.0708, instance_loss: 0.5436, weighted_loss: 0.9126, label: 2, bag_size: 324
batch 419, loss: 0.7555, instance_loss: 0.9532, weighted_loss: 0.8148, label: 3, bag_size: 607
batch 439, loss: 0.4446, instance_loss: 0.2662, weighted_loss: 0.3911, label: 1, bag_size: 869
batch 459, loss: 0.0462, instance_loss: 0.1520, weighted_loss: 0.0779, label: 3, bag_size: 50
batch 479, loss: 0.5818, instance_loss: 0.3487, weighted_loss: 0.5119, label: 2, bag_size: 806
batch 499, loss: 0.1143, instance_loss: 0.1657, weighted_loss: 0.1297, label: 2, bag_size: 461
batch 519, loss: 0.5404, instance_loss: 0.5625, weighted_loss: 0.5470, label: 1, bag_size: 269
batch 539, loss: 0.0616, instance_loss: 0.1430, weighted_loss: 0.0860, label: 0, bag_size: 524


class 0 clustering acc 0.9869266055045871: correct 21515/21800
class 1 clustering acc 0.47844036697247705: correct 2086/4360
Epoch: 22, train_loss: 0.3779, train_clustering_loss:  0.2837, train_error: 0.1578
class 0: acc 0.9, correct 90/100
class 1: acc 0.7090909090909091, correct 78/110
class 2: acc 0.7692307692307693, correct 90/117
class 3: acc 0.9019607843137255, correct 92/102
class 4: acc 0.9396551724137931, correct 109/116

Val Set, val_loss: 0.8481, val_error: 0.2800, auc: 0.9223
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.35: correct 140/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0010, instance_loss: 0.1695, weighted_loss: 0.0515, label: 4, bag_size: 38
batch 39, loss: 0.0004, instance_loss: 0.1131, weighted_loss: 0.0342, label: 4, bag_size: 20
batch 59, loss: 0.1652, instance_loss: 0.2202, weighted_loss: 0.1817, label: 1, bag_size: 711
batch 79, loss: 0.0010, instance_loss: 0.1368, weighted_loss: 0.0418, label: 4, bag_size: 38
batch 99, loss: 3.3002, instance_loss: 0.6711, weighted_loss: 2.5115, label: 1, bag_size: 386
batch 119, loss: 0.1560, instance_loss: 0.3723, weighted_loss: 0.2209, label: 4, bag_size: 354
batch 139, loss: 0.0013, instance_loss: 0.0182, weighted_loss: 0.0063, label: 4, bag_size: 182
batch 159, loss: 2.3618, instance_loss: 0.7200, weighted_loss: 1.8692, label: 1, bag_size: 651
batch 179, loss: 0.6899, instance_loss: 0.4348, weighted_loss: 0.6133, label: 2, bag_size: 741
batch 199, loss: 0.0656, instance_loss: 0.1093, weighted_loss: 0.0787, label: 1, bag_size: 886
batch 219, loss: 0.6518, instance_loss: 0.5207, weighted_loss: 0.6125, label: 1, bag_size: 860
batch 239, loss: 0.0087, instance_loss: 0.0589, weighted_loss: 0.0237, label: 4, bag_size: 91
batch 259, loss: 0.2005, instance_loss: 0.2656, weighted_loss: 0.2200, label: 0, bag_size: 381
batch 279, loss: 0.3392, instance_loss: 0.2993, weighted_loss: 0.3272, label: 0, bag_size: 1133
batch 299, loss: 0.0022, instance_loss: 0.0577, weighted_loss: 0.0188, label: 3, bag_size: 46
batch 319, loss: 0.3107, instance_loss: 0.3844, weighted_loss: 0.3328, label: 4, bag_size: 1331
batch 339, loss: 0.0012, instance_loss: 0.2404, weighted_loss: 0.0730, label: 4, bag_size: 23
batch 359, loss: 1.6222, instance_loss: 0.5638, weighted_loss: 1.3047, label: 0, bag_size: 423
batch 379, loss: 0.0917, instance_loss: 0.2429, weighted_loss: 0.1371, label: 2, bag_size: 1448
batch 399, loss: 0.9139, instance_loss: 0.4013, weighted_loss: 0.7601, label: 2, bag_size: 409
batch 419, loss: 1.3455, instance_loss: 0.6382, weighted_loss: 1.1333, label: 0, bag_size: 868
batch 439, loss: 0.1455, instance_loss: 0.3042, weighted_loss: 0.1931, label: 0, bag_size: 478
batch 459, loss: 0.3904, instance_loss: 0.5011, weighted_loss: 0.4236, label: 4, bag_size: 947
batch 479, loss: 0.6051, instance_loss: 0.5973, weighted_loss: 0.6028, label: 0, bag_size: 163
batch 499, loss: 0.0404, instance_loss: 0.0784, weighted_loss: 0.0518, label: 1, bag_size: 1086
batch 519, loss: 0.0066, instance_loss: 0.1576, weighted_loss: 0.0519, label: 3, bag_size: 50
batch 539, loss: 0.0007, instance_loss: 0.1394, weighted_loss: 0.0423, label: 3, bag_size: 21


class 0 clustering acc 0.9890366972477064: correct 21561/21800
class 1 clustering acc 0.5155963302752293: correct 2248/4360
Epoch: 23, train_loss: 0.2996, train_clustering_loss:  0.2647, train_error: 0.1028
class 0: acc 0.9230769230769231, correct 96/104
class 1: acc 0.8017241379310345, correct 93/116
class 2: acc 0.8297872340425532, correct 78/94
class 3: acc 0.956989247311828, correct 89/93
class 4: acc 0.9637681159420289, correct 133/138

Val Set, val_loss: 0.8359, val_error: 0.2800, auc: 0.9320
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.41: correct 164/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0048, instance_loss: 0.1113, weighted_loss: 0.0368, label: 3, bag_size: 48
batch 39, loss: 0.0337, instance_loss: 0.3693, weighted_loss: 0.1344, label: 0, bag_size: 129
batch 59, loss: 0.0719, instance_loss: 0.1294, weighted_loss: 0.0892, label: 0, bag_size: 1086
batch 79, loss: 0.0139, instance_loss: 0.0970, weighted_loss: 0.0388, label: 0, bag_size: 653
batch 99, loss: 0.0320, instance_loss: 0.3904, weighted_loss: 0.1395, label: 3, bag_size: 791
batch 119, loss: 0.0320, instance_loss: 0.1732, weighted_loss: 0.0744, label: 1, bag_size: 790
batch 139, loss: 0.0392, instance_loss: 0.1593, weighted_loss: 0.0753, label: 0, bag_size: 1255
batch 159, loss: 1.4513, instance_loss: 0.6139, weighted_loss: 1.2001, label: 2, bag_size: 959
batch 179, loss: 0.0069, instance_loss: 0.0298, weighted_loss: 0.0138, label: 3, bag_size: 105
batch 199, loss: 0.0887, instance_loss: 0.1906, weighted_loss: 0.1193, label: 1, bag_size: 242
batch 219, loss: 0.0270, instance_loss: 0.0614, weighted_loss: 0.0373, label: 3, bag_size: 19
batch 239, loss: 0.3259, instance_loss: 0.3244, weighted_loss: 0.3255, label: 0, bag_size: 432
batch 259, loss: 0.0012, instance_loss: 0.1049, weighted_loss: 0.0323, label: 4, bag_size: 119
batch 279, loss: 0.0392, instance_loss: 0.3868, weighted_loss: 0.1435, label: 4, bag_size: 388
batch 299, loss: 0.0007, instance_loss: 0.0345, weighted_loss: 0.0108, label: 3, bag_size: 72
batch 319, loss: 0.3370, instance_loss: 0.6642, weighted_loss: 0.4351, label: 3, bag_size: 283
batch 339, loss: 0.0208, instance_loss: 0.5132, weighted_loss: 0.1685, label: 0, bag_size: 122
batch 359, loss: 0.0224, instance_loss: 0.1630, weighted_loss: 0.0646, label: 0, bag_size: 1086
batch 379, loss: 0.0175, instance_loss: 0.0685, weighted_loss: 0.0328, label: 3, bag_size: 123
batch 399, loss: 0.0306, instance_loss: 0.2974, weighted_loss: 0.1106, label: 0, bag_size: 109
batch 419, loss: 0.0148, instance_loss: 0.1418, weighted_loss: 0.0529, label: 0, bag_size: 630
batch 439, loss: 0.1123, instance_loss: 0.2501, weighted_loss: 0.1536, label: 0, bag_size: 756
batch 459, loss: 0.3780, instance_loss: 0.3342, weighted_loss: 0.3648, label: 2, bag_size: 741
batch 479, loss: 0.0098, instance_loss: 0.1586, weighted_loss: 0.0544, label: 4, bag_size: 24
batch 499, loss: 0.1747, instance_loss: 0.1881, weighted_loss: 0.1787, label: 1, bag_size: 356
batch 519, loss: 0.0764, instance_loss: 0.3502, weighted_loss: 0.1586, label: 1, bag_size: 818
batch 539, loss: 0.1283, instance_loss: 0.1869, weighted_loss: 0.1459, label: 1, bag_size: 470


class 0 clustering acc 0.9885779816513761: correct 21551/21800
class 1 clustering acc 0.5151376146788991: correct 2246/4360
Epoch: 24, train_loss: 0.2951, train_clustering_loss:  0.2678, train_error: 0.1119
class 0: acc 0.940677966101695, correct 111/118
class 1: acc 0.8267716535433071, correct 105/127
class 2: acc 0.7909090909090909, correct 87/110
class 3: acc 0.9423076923076923, correct 98/104
class 4: acc 0.9651162790697675, correct 83/86

Val Set, val_loss: 1.1441, val_error: 0.3600, auc: 0.9201
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.4125: correct 165/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6, correct 3/5
class 4: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 2.5475, instance_loss: 0.8203, weighted_loss: 2.0293, label: 3, bag_size: 1250
batch 39, loss: 0.0005, instance_loss: 0.0429, weighted_loss: 0.0132, label: 4, bag_size: 48
batch 59, loss: 0.0016, instance_loss: 0.0475, weighted_loss: 0.0154, label: 4, bag_size: 78
batch 79, loss: 1.3319, instance_loss: 0.5356, weighted_loss: 1.0930, label: 2, bag_size: 916
batch 99, loss: 1.4546, instance_loss: 0.7631, weighted_loss: 1.2471, label: 4, bag_size: 1278
batch 119, loss: 0.0177, instance_loss: 0.1451, weighted_loss: 0.0559, label: 0, bag_size: 1235
batch 139, loss: 0.0005, instance_loss: 0.1089, weighted_loss: 0.0330, label: 4, bag_size: 29
batch 159, loss: 0.0014, instance_loss: 0.0502, weighted_loss: 0.0160, label: 4, bag_size: 43
batch 179, loss: 0.0007, instance_loss: 0.0132, weighted_loss: 0.0044, label: 4, bag_size: 130
batch 199, loss: 0.2411, instance_loss: 0.2295, weighted_loss: 0.2376, label: 0, bag_size: 371
batch 219, loss: 0.0052, instance_loss: 0.0670, weighted_loss: 0.0238, label: 0, bag_size: 1143
batch 239, loss: 0.0006, instance_loss: 0.0260, weighted_loss: 0.0082, label: 4, bag_size: 167
batch 259, loss: 0.6583, instance_loss: 0.4653, weighted_loss: 0.6004, label: 1, bag_size: 533
batch 279, loss: 0.0027, instance_loss: 0.0759, weighted_loss: 0.0246, label: 4, bag_size: 148
batch 299, loss: 0.0028, instance_loss: 0.0867, weighted_loss: 0.0280, label: 1, bag_size: 938
batch 319, loss: 0.2031, instance_loss: 0.2486, weighted_loss: 0.2167, label: 2, bag_size: 1006
batch 339, loss: 0.3933, instance_loss: 0.2790, weighted_loss: 0.3590, label: 3, bag_size: 16
batch 359, loss: 0.0735, instance_loss: 0.2245, weighted_loss: 0.1188, label: 0, bag_size: 756
batch 379, loss: 0.0454, instance_loss: 0.2152, weighted_loss: 0.0964, label: 1, bag_size: 754
batch 399, loss: 1.8657, instance_loss: 0.5748, weighted_loss: 1.4785, label: 1, bag_size: 657
batch 419, loss: 0.4165, instance_loss: 0.5338, weighted_loss: 0.4517, label: 0, bag_size: 1527
batch 439, loss: 0.3501, instance_loss: 0.4051, weighted_loss: 0.3666, label: 2, bag_size: 537
batch 459, loss: 1.2548, instance_loss: 0.4316, weighted_loss: 1.0079, label: 2, bag_size: 784
batch 479, loss: 0.9984, instance_loss: 0.5076, weighted_loss: 0.8512, label: 0, bag_size: 245
batch 499, loss: 0.0664, instance_loss: 0.1684, weighted_loss: 0.0970, label: 2, bag_size: 863
batch 519, loss: 0.0010, instance_loss: 0.1082, weighted_loss: 0.0332, label: 4, bag_size: 51
batch 539, loss: 1.4507, instance_loss: 0.6272, weighted_loss: 1.2036, label: 3, bag_size: 305


class 0 clustering acc 0.9861009174311927: correct 21497/21800
class 1 clustering acc 0.5110091743119266: correct 2228/4360
Epoch: 25, train_loss: 0.3135, train_clustering_loss:  0.2744, train_error: 0.1174
class 0: acc 0.918918918918919, correct 102/111
class 1: acc 0.7551020408163265, correct 74/98
class 2: acc 0.8333333333333334, correct 90/108
class 3: acc 0.9238095238095239, correct 97/105
class 4: acc 0.959349593495935, correct 118/123

Val Set, val_loss: 0.7298, val_error: 0.2800, auc: 0.9406
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.43: correct 172/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.6666666666666666, correct 8/12
Validation loss decreased (0.769402 --> 0.729808).  Saving model ...


batch 19, loss: 0.1173, instance_loss: 0.3677, weighted_loss: 0.1925, label: 2, bag_size: 357
batch 39, loss: 0.0163, instance_loss: 0.1361, weighted_loss: 0.0523, label: 0, bag_size: 602
batch 59, loss: 0.2723, instance_loss: 0.1836, weighted_loss: 0.2457, label: 1, bag_size: 356
batch 79, loss: 0.0689, instance_loss: 0.1950, weighted_loss: 0.1067, label: 3, bag_size: 316
batch 99, loss: 0.0516, instance_loss: 0.1519, weighted_loss: 0.0817, label: 0, bag_size: 1527
batch 119, loss: 0.0441, instance_loss: 0.0990, weighted_loss: 0.0605, label: 0, bag_size: 410
batch 139, loss: 0.3455, instance_loss: 0.3171, weighted_loss: 0.3370, label: 2, bag_size: 1024
batch 159, loss: 0.0309, instance_loss: 0.1591, weighted_loss: 0.0693, label: 1, bag_size: 890
batch 179, loss: 0.2367, instance_loss: 0.2644, weighted_loss: 0.2450, label: 2, bag_size: 1514
batch 199, loss: 0.0074, instance_loss: 0.0789, weighted_loss: 0.0288, label: 0, bag_size: 976
batch 219, loss: 0.0180, instance_loss: 0.1697, weighted_loss: 0.0635, label: 3, bag_size: 16
batch 239, loss: 0.0636, instance_loss: 0.2321, weighted_loss: 0.1141, label: 2, bag_size: 292
batch 259, loss: 0.1735, instance_loss: 0.2866, weighted_loss: 0.2074, label: 0, bag_size: 800
batch 279, loss: 0.0743, instance_loss: 0.1864, weighted_loss: 0.1079, label: 0, bag_size: 760
batch 299, loss: 0.0004, instance_loss: 0.0504, weighted_loss: 0.0154, label: 4, bag_size: 140
batch 319, loss: 0.2566, instance_loss: 0.4399, weighted_loss: 0.3116, label: 3, bag_size: 791
batch 339, loss: 0.0543, instance_loss: 0.1234, weighted_loss: 0.0750, label: 1, bag_size: 534
batch 359, loss: 0.0001, instance_loss: 0.0148, weighted_loss: 0.0045, label: 4, bag_size: 192
batch 379, loss: 0.0370, instance_loss: 0.3895, weighted_loss: 0.1428, label: 0, bag_size: 118
batch 399, loss: 0.1046, instance_loss: 0.3171, weighted_loss: 0.1683, label: 4, bag_size: 1474
batch 419, loss: 0.3444, instance_loss: 0.2866, weighted_loss: 0.3271, label: 1, bag_size: 945
batch 439, loss: 0.6907, instance_loss: 0.2851, weighted_loss: 0.5690, label: 2, bag_size: 1164
batch 459, loss: 0.0524, instance_loss: 0.1534, weighted_loss: 0.0827, label: 0, bag_size: 413
batch 479, loss: 0.1373, instance_loss: 0.4661, weighted_loss: 0.2360, label: 4, bag_size: 354
batch 499, loss: 0.0236, instance_loss: 0.3571, weighted_loss: 0.1236, label: 0, bag_size: 653
batch 519, loss: 0.2680, instance_loss: 0.1454, weighted_loss: 0.2312, label: 2, bag_size: 1164
batch 539, loss: 0.1802, instance_loss: 0.2661, weighted_loss: 0.2060, label: 0, bag_size: 200


class 0 clustering acc 0.986788990825688: correct 21512/21800
class 1 clustering acc 0.5639908256880733: correct 2459/4360
Epoch: 26, train_loss: 0.2490, train_clustering_loss:  0.2518, train_error: 0.0807
class 0: acc 0.9765625, correct 125/128
class 1: acc 0.8645833333333334, correct 83/96
class 2: acc 0.8434782608695652, correct 97/115
class 3: acc 0.9454545454545454, correct 104/110
class 4: acc 0.9583333333333334, correct 92/96

Val Set, val_loss: 1.3081, val_error: 0.3400, auc: 0.9027
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.4275: correct 171/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0833, instance_loss: 0.2070, weighted_loss: 0.1205, label: 0, bag_size: 552
batch 39, loss: 0.0817, instance_loss: 0.3244, weighted_loss: 0.1545, label: 2, bag_size: 571
batch 59, loss: 2.3193, instance_loss: 0.7112, weighted_loss: 1.8369, label: 1, bag_size: 657
batch 79, loss: 0.0556, instance_loss: 0.1625, weighted_loss: 0.0877, label: 3, bag_size: 24
batch 99, loss: 0.2945, instance_loss: 0.4959, weighted_loss: 0.3549, label: 0, bag_size: 129
batch 119, loss: 0.0454, instance_loss: 0.0950, weighted_loss: 0.0602, label: 2, bag_size: 907
batch 139, loss: 0.0402, instance_loss: 0.1600, weighted_loss: 0.0761, label: 2, bag_size: 1053
batch 159, loss: 0.0919, instance_loss: 0.3792, weighted_loss: 0.1781, label: 3, bag_size: 706
batch 179, loss: 0.3680, instance_loss: 0.3436, weighted_loss: 0.3607, label: 2, bag_size: 1148
batch 199, loss: 0.0001, instance_loss: 0.0217, weighted_loss: 0.0066, label: 4, bag_size: 128
batch 219, loss: 2.4997, instance_loss: 0.4427, weighted_loss: 1.8826, label: 2, bag_size: 542
batch 239, loss: 0.0018, instance_loss: 0.0657, weighted_loss: 0.0210, label: 4, bag_size: 114
batch 259, loss: 0.0252, instance_loss: 0.2146, weighted_loss: 0.0820, label: 2, bag_size: 396
batch 279, loss: 0.2687, instance_loss: 0.5555, weighted_loss: 0.3548, label: 3, bag_size: 936
batch 299, loss: 0.0020, instance_loss: 0.0723, weighted_loss: 0.0231, label: 3, bag_size: 32
batch 319, loss: 0.3807, instance_loss: 0.6847, weighted_loss: 0.4719, label: 1, bag_size: 269
batch 339, loss: 0.7613, instance_loss: 0.4268, weighted_loss: 0.6610, label: 2, bag_size: 869
batch 359, loss: 0.0176, instance_loss: 0.1209, weighted_loss: 0.0486, label: 1, bag_size: 1402
batch 379, loss: 0.0230, instance_loss: 0.3455, weighted_loss: 0.1197, label: 1, bag_size: 1152
batch 399, loss: 0.0027, instance_loss: 0.0290, weighted_loss: 0.0106, label: 0, bag_size: 521
batch 419, loss: 0.5649, instance_loss: 0.4280, weighted_loss: 0.5238, label: 1, bag_size: 1144
batch 439, loss: 0.7858, instance_loss: 0.3854, weighted_loss: 0.6657, label: 1, bag_size: 1646
batch 459, loss: 0.0524, instance_loss: 0.1681, weighted_loss: 0.0871, label: 2, bag_size: 2081
batch 479, loss: 0.0035, instance_loss: 0.3518, weighted_loss: 0.1080, label: 3, bag_size: 21
batch 499, loss: 0.2781, instance_loss: 0.3247, weighted_loss: 0.2921, label: 0, bag_size: 990
batch 519, loss: 0.0003, instance_loss: 0.0373, weighted_loss: 0.0114, label: 4, bag_size: 30
batch 539, loss: 0.8771, instance_loss: 0.2129, weighted_loss: 0.6779, label: 1, bag_size: 711


class 0 clustering acc 0.9860550458715597: correct 21496/21800
class 1 clustering acc 0.5380733944954128: correct 2346/4360
Epoch: 27, train_loss: 0.2584, train_clustering_loss:  0.2591, train_error: 0.0862
class 0: acc 0.9622641509433962, correct 102/106
class 1: acc 0.8272727272727273, correct 91/110
class 2: acc 0.8740740740740741, correct 118/135
class 3: acc 0.9696969696969697, correct 96/99
class 4: acc 0.9578947368421052, correct 91/95

Val Set, val_loss: 1.1710, val_error: 0.3200, auc: 0.9157
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.44: correct 176/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6644, instance_loss: 0.5805, weighted_loss: 0.6392, label: 1, bag_size: 861
batch 39, loss: 0.0021, instance_loss: 0.0803, weighted_loss: 0.0256, label: 4, bag_size: 47
batch 59, loss: 0.0031, instance_loss: 0.0441, weighted_loss: 0.0154, label: 4, bag_size: 110
batch 79, loss: 0.1626, instance_loss: 0.3168, weighted_loss: 0.2088, label: 2, bag_size: 684
batch 99, loss: 0.0001, instance_loss: 0.0998, weighted_loss: 0.0300, label: 4, bag_size: 125
batch 119, loss: 0.3887, instance_loss: 0.3448, weighted_loss: 0.3756, label: 2, bag_size: 1180
batch 139, loss: 0.0010, instance_loss: 0.0991, weighted_loss: 0.0305, label: 3, bag_size: 35
batch 159, loss: 0.0137, instance_loss: 0.6004, weighted_loss: 0.1897, label: 4, bag_size: 754
batch 179, loss: 0.0465, instance_loss: 0.0931, weighted_loss: 0.0605, label: 1, bag_size: 320
batch 199, loss: 0.4036, instance_loss: 0.5240, weighted_loss: 0.4397, label: 0, bag_size: 868
batch 219, loss: 0.0059, instance_loss: 0.1642, weighted_loss: 0.0534, label: 3, bag_size: 28
batch 239, loss: 0.0983, instance_loss: 0.4330, weighted_loss: 0.1987, label: 3, bag_size: 936
batch 259, loss: 0.0102, instance_loss: 0.0588, weighted_loss: 0.0248, label: 0, bag_size: 446
batch 279, loss: 0.0545, instance_loss: 0.0676, weighted_loss: 0.0584, label: 4, bag_size: 114
batch 299, loss: 0.0181, instance_loss: 0.1981, weighted_loss: 0.0721, label: 0, bag_size: 1174
batch 319, loss: 0.0673, instance_loss: 0.1237, weighted_loss: 0.0842, label: 1, bag_size: 903
batch 339, loss: 0.0062, instance_loss: 0.5591, weighted_loss: 0.1721, label: 1, bag_size: 1409
batch 359, loss: 0.2782, instance_loss: 0.4001, weighted_loss: 0.3147, label: 2, bag_size: 409
batch 379, loss: 0.0582, instance_loss: 0.1186, weighted_loss: 0.0763, label: 2, bag_size: 480
batch 399, loss: 0.0830, instance_loss: 0.1623, weighted_loss: 0.1068, label: 2, bag_size: 1306
batch 419, loss: 0.0323, instance_loss: 0.2652, weighted_loss: 0.1022, label: 0, bag_size: 807
batch 439, loss: 2.0878, instance_loss: 0.6465, weighted_loss: 1.6554, label: 2, bag_size: 110
batch 459, loss: 0.0088, instance_loss: 0.1870, weighted_loss: 0.0623, label: 4, bag_size: 1121
batch 479, loss: 0.0365, instance_loss: 0.2085, weighted_loss: 0.0881, label: 4, bag_size: 711
batch 499, loss: 0.0104, instance_loss: 0.6683, weighted_loss: 0.2078, label: 3, bag_size: 281
batch 519, loss: 0.0624, instance_loss: 0.2357, weighted_loss: 0.1144, label: 4, bag_size: 1474
batch 539, loss: 0.0967, instance_loss: 0.1470, weighted_loss: 0.1118, label: 2, bag_size: 270


class 0 clustering acc 0.9878899082568807: correct 21536/21800
class 1 clustering acc 0.5752293577981651: correct 2508/4360
Epoch: 28, train_loss: 0.2084, train_clustering_loss:  0.2454, train_error: 0.0679
class 0: acc 0.8979591836734694, correct 88/98
class 1: acc 0.8703703703703703, correct 94/108
class 2: acc 0.9081632653061225, correct 89/98
class 3: acc 0.9829059829059829, correct 115/117
class 4: acc 0.9838709677419355, correct 122/124

Val Set, val_loss: 1.1355, val_error: 0.3000, auc: 0.9078
class 0 clustering acc 0.9845: correct 1969/2000
class 1 clustering acc 0.4325: correct 173/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2619, instance_loss: 0.3790, weighted_loss: 0.2970, label: 2, bag_size: 638
batch 39, loss: 0.0189, instance_loss: 0.0983, weighted_loss: 0.0427, label: 2, bag_size: 455
batch 59, loss: 0.2676, instance_loss: 0.4140, weighted_loss: 0.3115, label: 0, bag_size: 424
batch 79, loss: 0.0129, instance_loss: 0.1685, weighted_loss: 0.0596, label: 0, bag_size: 1133
batch 99, loss: 0.3860, instance_loss: 0.2325, weighted_loss: 0.3400, label: 0, bag_size: 1046
batch 119, loss: 0.2947, instance_loss: 0.3653, weighted_loss: 0.3159, label: 2, bag_size: 356
batch 139, loss: 0.0920, instance_loss: 0.3879, weighted_loss: 0.1808, label: 2, bag_size: 784
batch 159, loss: 0.0024, instance_loss: 0.0469, weighted_loss: 0.0157, label: 3, bag_size: 19
batch 179, loss: 0.0003, instance_loss: 0.1299, weighted_loss: 0.0391, label: 3, bag_size: 24
batch 199, loss: 0.0118, instance_loss: 0.0715, weighted_loss: 0.0297, label: 1, bag_size: 1239
batch 219, loss: 0.0034, instance_loss: 0.1223, weighted_loss: 0.0390, label: 4, bag_size: 55
batch 239, loss: 0.6364, instance_loss: 0.5766, weighted_loss: 0.6185, label: 3, bag_size: 849
batch 259, loss: 0.5949, instance_loss: 0.4679, weighted_loss: 0.5568, label: 2, bag_size: 948
batch 279, loss: 0.1712, instance_loss: 0.5630, weighted_loss: 0.2887, label: 4, bag_size: 1176
batch 299, loss: 0.0085, instance_loss: 0.2176, weighted_loss: 0.0712, label: 3, bag_size: 28
batch 319, loss: 0.0023, instance_loss: 0.2066, weighted_loss: 0.0636, label: 3, bag_size: 18
batch 339, loss: 0.1357, instance_loss: 0.2825, weighted_loss: 0.1797, label: 0, bag_size: 736
batch 359, loss: 0.0010, instance_loss: 0.0308, weighted_loss: 0.0100, label: 3, bag_size: 123
batch 379, loss: 0.0042, instance_loss: 0.0448, weighted_loss: 0.0164, label: 3, bag_size: 87
batch 399, loss: 0.1513, instance_loss: 0.2955, weighted_loss: 0.1946, label: 2, bag_size: 1533
batch 419, loss: 0.0020, instance_loss: 0.1295, weighted_loss: 0.0403, label: 3, bag_size: 27
batch 439, loss: 0.0270, instance_loss: 0.0681, weighted_loss: 0.0394, label: 4, bag_size: 55
batch 459, loss: 0.0004, instance_loss: 0.1301, weighted_loss: 0.0393, label: 3, bag_size: 43
batch 479, loss: 0.0001, instance_loss: 0.0256, weighted_loss: 0.0077, label: 4, bag_size: 147
batch 499, loss: 0.0007, instance_loss: 0.0194, weighted_loss: 0.0063, label: 1, bag_size: 1376
batch 519, loss: 0.4756, instance_loss: 0.3460, weighted_loss: 0.4367, label: 2, bag_size: 1133
batch 539, loss: 0.8878, instance_loss: 0.4255, weighted_loss: 0.7492, label: 1, bag_size: 898


class 0 clustering acc 0.9861926605504587: correct 21499/21800
class 1 clustering acc 0.5658256880733945: correct 2467/4360
Epoch: 29, train_loss: 0.2451, train_clustering_loss:  0.2503, train_error: 0.0789
class 0: acc 0.9541284403669725, correct 104/109
class 1: acc 0.8828828828828829, correct 98/111
class 2: acc 0.8316831683168316, correct 84/101
class 3: acc 0.9669421487603306, correct 117/121
class 4: acc 0.9611650485436893, correct 99/103

Val Set, val_loss: 1.5803, val_error: 0.3600, auc: 0.8854
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.405: correct 162/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.3333333333333333, correct 4/12
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0001, instance_loss: 0.2054, weighted_loss: 0.0617, label: 3, bag_size: 16
batch 39, loss: 0.0096, instance_loss: 0.1027, weighted_loss: 0.0375, label: 3, bag_size: 1172
batch 59, loss: 0.0026, instance_loss: 0.0808, weighted_loss: 0.0261, label: 4, bag_size: 764
batch 79, loss: 0.0051, instance_loss: 0.0485, weighted_loss: 0.0182, label: 1, bag_size: 938
batch 99, loss: 0.0460, instance_loss: 0.2741, weighted_loss: 0.1144, label: 2, bag_size: 907
batch 119, loss: 0.0539, instance_loss: 0.2387, weighted_loss: 0.1094, label: 1, bag_size: 474
batch 139, loss: 0.1969, instance_loss: 0.1470, weighted_loss: 0.1819, label: 3, bag_size: 533
batch 159, loss: 0.0223, instance_loss: 0.1369, weighted_loss: 0.0567, label: 0, bag_size: 1332
batch 179, loss: 0.2428, instance_loss: 0.4332, weighted_loss: 0.2999, label: 2, bag_size: 265
batch 199, loss: 1.5147, instance_loss: 0.5546, weighted_loss: 1.2266, label: 0, bag_size: 423
batch 219, loss: 0.4408, instance_loss: 0.5866, weighted_loss: 0.4845, label: 1, bag_size: 651
batch 239, loss: 0.5492, instance_loss: 0.2741, weighted_loss: 0.4667, label: 0, bag_size: 912
batch 259, loss: 0.0004, instance_loss: 0.0359, weighted_loss: 0.0111, label: 4, bag_size: 211
batch 279, loss: 0.0040, instance_loss: 0.0517, weighted_loss: 0.0183, label: 0, bag_size: 616
batch 299, loss: 0.0363, instance_loss: 0.0643, weighted_loss: 0.0447, label: 1, bag_size: 1325
batch 319, loss: 0.0216, instance_loss: 0.1558, weighted_loss: 0.0619, label: 0, bag_size: 413
batch 339, loss: 0.8502, instance_loss: 0.7291, weighted_loss: 0.8139, label: 1, bag_size: 308
batch 359, loss: 0.0009, instance_loss: 0.0940, weighted_loss: 0.0288, label: 3, bag_size: 16
batch 379, loss: 0.0002, instance_loss: 0.2087, weighted_loss: 0.0628, label: 3, bag_size: 21
batch 399, loss: 0.0852, instance_loss: 0.2665, weighted_loss: 0.1396, label: 2, bag_size: 861
batch 419, loss: 0.0056, instance_loss: 0.0640, weighted_loss: 0.0232, label: 0, bag_size: 552
batch 439, loss: 0.1362, instance_loss: 0.2005, weighted_loss: 0.1555, label: 0, bag_size: 962
batch 459, loss: 0.0275, instance_loss: 0.2245, weighted_loss: 0.0866, label: 2, bag_size: 499
batch 479, loss: 0.0025, instance_loss: 0.0232, weighted_loss: 0.0087, label: 0, bag_size: 1143
batch 499, loss: 0.0154, instance_loss: 0.1046, weighted_loss: 0.0422, label: 0, bag_size: 413
batch 519, loss: 0.0006, instance_loss: 0.0177, weighted_loss: 0.0057, label: 4, bag_size: 107
batch 539, loss: 0.0001, instance_loss: 0.0460, weighted_loss: 0.0139, label: 4, bag_size: 40


class 0 clustering acc 0.9860550458715597: correct 21496/21800
class 1 clustering acc 0.5463302752293578: correct 2382/4360
Epoch: 30, train_loss: 0.2233, train_clustering_loss:  0.2585, train_error: 0.0734
class 0: acc 0.9557522123893806, correct 108/113
class 1: acc 0.8415841584158416, correct 85/101
class 2: acc 0.8981481481481481, correct 97/108
class 3: acc 0.963302752293578, correct 105/109
class 4: acc 0.9649122807017544, correct 110/114

Val Set, val_loss: 0.9254, val_error: 0.3000, auc: 0.9218
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.4375: correct 175/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1678, instance_loss: 0.2080, weighted_loss: 0.1799, label: 0, bag_size: 545
batch 39, loss: 0.1261, instance_loss: 0.1987, weighted_loss: 0.1479, label: 4, bag_size: 636
batch 59, loss: 0.0116, instance_loss: 0.4630, weighted_loss: 0.1470, label: 1, bag_size: 1409
batch 79, loss: 1.1725, instance_loss: 0.6046, weighted_loss: 1.0021, label: 3, bag_size: 230
batch 99, loss: 0.0004, instance_loss: 0.1137, weighted_loss: 0.0344, label: 4, bag_size: 123
batch 119, loss: 1.6378, instance_loss: 0.5584, weighted_loss: 1.3140, label: 2, bag_size: 589
batch 139, loss: 0.0013, instance_loss: 0.2494, weighted_loss: 0.0757, label: 4, bag_size: 23
batch 159, loss: 0.0056, instance_loss: 0.0325, weighted_loss: 0.0137, label: 0, bag_size: 1872
batch 179, loss: 0.0259, instance_loss: 0.1433, weighted_loss: 0.0611, label: 1, bag_size: 690
batch 199, loss: 0.0291, instance_loss: 0.1419, weighted_loss: 0.0629, label: 0, bag_size: 1196
batch 219, loss: 0.5378, instance_loss: 0.4492, weighted_loss: 0.5112, label: 3, bag_size: 360
batch 239, loss: 0.0008, instance_loss: 0.2958, weighted_loss: 0.0893, label: 4, bag_size: 38
batch 259, loss: 0.2413, instance_loss: 0.2157, weighted_loss: 0.2337, label: 0, bag_size: 1257
batch 279, loss: 0.0001, instance_loss: 0.0646, weighted_loss: 0.0194, label: 4, bag_size: 174
batch 299, loss: 0.0181, instance_loss: 0.2047, weighted_loss: 0.0741, label: 2, bag_size: 358
batch 319, loss: 0.0159, instance_loss: 0.0897, weighted_loss: 0.0381, label: 1, bag_size: 1277
batch 339, loss: 0.0001, instance_loss: 0.0469, weighted_loss: 0.0142, label: 4, bag_size: 48
batch 359, loss: 0.9703, instance_loss: 0.6126, weighted_loss: 0.8630, label: 0, bag_size: 868
batch 379, loss: 0.6290, instance_loss: 0.6787, weighted_loss: 0.6439, label: 1, bag_size: 308
batch 399, loss: 0.3853, instance_loss: 0.2787, weighted_loss: 0.3533, label: 0, bag_size: 570
batch 419, loss: 0.0491, instance_loss: 0.1375, weighted_loss: 0.0756, label: 0, bag_size: 410
batch 439, loss: 0.0015, instance_loss: 0.1092, weighted_loss: 0.0338, label: 4, bag_size: 83
batch 459, loss: 0.1086, instance_loss: 0.2726, weighted_loss: 0.1578, label: 1, bag_size: 1651
batch 479, loss: 0.0376, instance_loss: 0.3456, weighted_loss: 0.1300, label: 0, bag_size: 118
batch 499, loss: 3.4005, instance_loss: 0.8250, weighted_loss: 2.6278, label: 1, bag_size: 448
batch 519, loss: 2.9867, instance_loss: 0.5177, weighted_loss: 2.2460, label: 2, bag_size: 1197
batch 539, loss: 0.0603, instance_loss: 0.2983, weighted_loss: 0.1317, label: 2, bag_size: 357


class 0 clustering acc 0.9843577981651376: correct 21459/21800
class 1 clustering acc 0.5428899082568808: correct 2367/4360
Epoch: 31, train_loss: 0.2198, train_clustering_loss:  0.2685, train_error: 0.0807
class 0: acc 0.9736842105263158, correct 111/114
class 1: acc 0.8288288288288288, correct 92/111
class 2: acc 0.8476190476190476, correct 89/105
class 3: acc 0.984, correct 123/125
class 4: acc 0.9555555555555556, correct 86/90

Val Set, val_loss: 0.8729, val_error: 0.2400, auc: 0.9307
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.4625: correct 185/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.75, correct 9/12
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0002, instance_loss: 0.0215, weighted_loss: 0.0066, label: 3, bag_size: 123
batch 39, loss: 0.2271, instance_loss: 0.6244, weighted_loss: 0.3463, label: 1, bag_size: 917
batch 59, loss: 0.0026, instance_loss: 0.2534, weighted_loss: 0.0779, label: 4, bag_size: 23
batch 79, loss: 0.7492, instance_loss: 0.4946, weighted_loss: 0.6728, label: 1, bag_size: 269
batch 99, loss: 0.0202, instance_loss: 0.1226, weighted_loss: 0.0509, label: 2, bag_size: 1289
batch 119, loss: 0.0315, instance_loss: 0.0899, weighted_loss: 0.0490, label: 0, bag_size: 990
batch 139, loss: 0.0294, instance_loss: 0.2755, weighted_loss: 0.1032, label: 4, bag_size: 297
batch 159, loss: 0.1070, instance_loss: 0.1976, weighted_loss: 0.1342, label: 1, bag_size: 945
batch 179, loss: 0.3209, instance_loss: 0.1942, weighted_loss: 0.2829, label: 1, bag_size: 711
batch 199, loss: 0.0556, instance_loss: 0.3079, weighted_loss: 0.1313, label: 0, bag_size: 1196
batch 219, loss: 0.0066, instance_loss: 0.1029, weighted_loss: 0.0355, label: 3, bag_size: 43
batch 239, loss: 0.0179, instance_loss: 0.1943, weighted_loss: 0.0708, label: 2, bag_size: 222
batch 259, loss: 0.6086, instance_loss: 0.3168, weighted_loss: 0.5211, label: 1, bag_size: 405
batch 279, loss: 1.5320, instance_loss: 0.6283, weighted_loss: 1.2609, label: 1, bag_size: 887
batch 299, loss: 0.0007, instance_loss: 0.1336, weighted_loss: 0.0406, label: 3, bag_size: 18
batch 319, loss: 0.0290, instance_loss: 0.1039, weighted_loss: 0.0515, label: 4, bag_size: 28
batch 339, loss: 0.0074, instance_loss: 0.5451, weighted_loss: 0.1687, label: 0, bag_size: 155
batch 359, loss: 0.0004, instance_loss: 0.1080, weighted_loss: 0.0327, label: 4, bag_size: 35
batch 379, loss: 1.4509, instance_loss: 0.6515, weighted_loss: 1.2111, label: 1, bag_size: 487
batch 399, loss: 0.0166, instance_loss: 0.1253, weighted_loss: 0.0492, label: 0, bag_size: 1133
batch 419, loss: 0.0513, instance_loss: 0.1798, weighted_loss: 0.0899, label: 0, bag_size: 1018
batch 439, loss: 0.0007, instance_loss: 0.1281, weighted_loss: 0.0389, label: 3, bag_size: 18
batch 459, loss: 0.1657, instance_loss: 0.6590, weighted_loss: 0.3137, label: 1, bag_size: 651
batch 479, loss: 0.0072, instance_loss: 0.0503, weighted_loss: 0.0201, label: 0, bag_size: 1143
batch 499, loss: 0.0589, instance_loss: 0.2699, weighted_loss: 0.1222, label: 0, bag_size: 1012
batch 519, loss: 0.0618, instance_loss: 0.2005, weighted_loss: 0.1034, label: 0, bag_size: 200
batch 539, loss: 0.0381, instance_loss: 0.0646, weighted_loss: 0.0461, label: 1, bag_size: 320


class 0 clustering acc 0.9855504587155963: correct 21485/21800
class 1 clustering acc 0.5410550458715596: correct 2359/4360
Epoch: 32, train_loss: 0.2444, train_clustering_loss:  0.2668, train_error: 0.0844
class 0: acc 0.9615384615384616, correct 100/104
class 1: acc 0.8666666666666667, correct 104/120
class 2: acc 0.8118811881188119, correct 82/101
class 3: acc 0.9444444444444444, correct 102/108
class 4: acc 0.9910714285714286, correct 111/112

Val Set, val_loss: 1.2215, val_error: 0.3200, auc: 0.9133
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.42: correct 168/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.4166666666666667, correct 5/12
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1572, instance_loss: 0.2358, weighted_loss: 0.1808, label: 0, bag_size: 545
batch 39, loss: 0.8437, instance_loss: 0.5214, weighted_loss: 0.7470, label: 2, bag_size: 1400
batch 59, loss: 0.5524, instance_loss: 0.4472, weighted_loss: 0.5208, label: 4, bag_size: 826
batch 79, loss: 0.1800, instance_loss: 0.4086, weighted_loss: 0.2486, label: 1, bag_size: 868
batch 99, loss: 0.0149, instance_loss: 0.2332, weighted_loss: 0.0804, label: 0, bag_size: 120
batch 119, loss: 0.0109, instance_loss: 0.2536, weighted_loss: 0.0837, label: 4, bag_size: 590
batch 139, loss: 0.0307, instance_loss: 0.1116, weighted_loss: 0.0550, label: 1, bag_size: 890
batch 159, loss: 0.0038, instance_loss: 0.0604, weighted_loss: 0.0208, label: 1, bag_size: 938
batch 179, loss: 0.3603, instance_loss: 0.3299, weighted_loss: 0.3512, label: 1, bag_size: 1559
batch 199, loss: 0.0284, instance_loss: 0.1996, weighted_loss: 0.0798, label: 2, bag_size: 245
batch 219, loss: 1.8322, instance_loss: 0.5642, weighted_loss: 1.4518, label: 1, bag_size: 770
batch 239, loss: 0.0003, instance_loss: 0.0500, weighted_loss: 0.0152, label: 1, bag_size: 1376
batch 259, loss: 0.0656, instance_loss: 0.1515, weighted_loss: 0.0913, label: 0, bag_size: 424
batch 279, loss: 0.0911, instance_loss: 0.3718, weighted_loss: 0.1753, label: 3, bag_size: 1250
batch 299, loss: 0.1151, instance_loss: 0.1338, weighted_loss: 0.1207, label: 1, bag_size: 847
batch 319, loss: 0.0011, instance_loss: 0.0199, weighted_loss: 0.0068, label: 3, bag_size: 63
batch 339, loss: 0.2495, instance_loss: 0.3752, weighted_loss: 0.2872, label: 2, bag_size: 600
batch 359, loss: 0.0008, instance_loss: 0.1492, weighted_loss: 0.0453, label: 3, bag_size: 18
batch 379, loss: 0.0017, instance_loss: 0.1164, weighted_loss: 0.0361, label: 3, bag_size: 34
batch 399, loss: 0.0152, instance_loss: 0.2493, weighted_loss: 0.0854, label: 3, bag_size: 24
batch 419, loss: 0.1185, instance_loss: 0.1945, weighted_loss: 0.1413, label: 1, bag_size: 945
batch 439, loss: 0.0003, instance_loss: 0.0109, weighted_loss: 0.0035, label: 4, bag_size: 107
batch 459, loss: 0.0082, instance_loss: 0.0595, weighted_loss: 0.0236, label: 0, bag_size: 807
batch 479, loss: 0.0006, instance_loss: 0.1107, weighted_loss: 0.0336, label: 3, bag_size: 43
batch 499, loss: 0.1188, instance_loss: 0.2313, weighted_loss: 0.1526, label: 2, bag_size: 795
batch 519, loss: 0.0184, instance_loss: 0.1463, weighted_loss: 0.0568, label: 2, bag_size: 396
batch 539, loss: 0.0066, instance_loss: 0.1087, weighted_loss: 0.0372, label: 4, bag_size: 79


class 0 clustering acc 0.9885321100917431: correct 21550/21800
class 1 clustering acc 0.5646788990825689: correct 2462/4360
Epoch: 33, train_loss: 0.2123, train_clustering_loss:  0.2438, train_error: 0.0826
class 0: acc 0.9473684210526315, correct 90/95
class 1: acc 0.8571428571428571, correct 96/112
class 2: acc 0.8545454545454545, correct 94/110
class 3: acc 0.957983193277311, correct 114/119
class 4: acc 0.9724770642201835, correct 106/109

Val Set, val_loss: 1.2345, val_error: 0.3000, auc: 0.9141
class 0 clustering acc 0.9735: correct 1947/2000
class 1 clustering acc 0.4675: correct 187/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0021, instance_loss: 0.0164, weighted_loss: 0.0064, label: 3, bag_size: 66
batch 39, loss: 0.0017, instance_loss: 0.0782, weighted_loss: 0.0247, label: 3, bag_size: 53
batch 59, loss: 0.0231, instance_loss: 0.1669, weighted_loss: 0.0663, label: 1, bag_size: 470
batch 79, loss: 0.0074, instance_loss: 0.0492, weighted_loss: 0.0200, label: 1, bag_size: 834
batch 99, loss: 0.0053, instance_loss: 0.0209, weighted_loss: 0.0100, label: 1, bag_size: 286
batch 119, loss: 0.0463, instance_loss: 0.2061, weighted_loss: 0.0943, label: 0, bag_size: 424
batch 139, loss: 0.0004, instance_loss: 0.0356, weighted_loss: 0.0110, label: 4, bag_size: 112
batch 159, loss: 0.0000, instance_loss: 0.0524, weighted_loss: 0.0157, label: 4, bag_size: 134
batch 179, loss: 0.0049, instance_loss: 0.2561, weighted_loss: 0.0803, label: 4, bag_size: 1176
batch 199, loss: 0.0000, instance_loss: 0.0293, weighted_loss: 0.0088, label: 3, bag_size: 43
batch 219, loss: 0.0002, instance_loss: 0.0135, weighted_loss: 0.0042, label: 4, bag_size: 157
batch 239, loss: 0.0855, instance_loss: 0.3269, weighted_loss: 0.1580, label: 2, bag_size: 542
batch 259, loss: 0.0082, instance_loss: 0.2545, weighted_loss: 0.0821, label: 0, bag_size: 148
batch 279, loss: 0.0003, instance_loss: 0.1313, weighted_loss: 0.0396, label: 3, bag_size: 21
batch 299, loss: 0.0148, instance_loss: 0.0539, weighted_loss: 0.0265, label: 1, bag_size: 1086
batch 319, loss: 0.0184, instance_loss: 0.4196, weighted_loss: 0.1387, label: 4, bag_size: 354
batch 339, loss: 1.6027, instance_loss: 0.4572, weighted_loss: 1.2590, label: 0, bag_size: 1527
batch 359, loss: 0.0111, instance_loss: 0.0955, weighted_loss: 0.0364, label: 0, bag_size: 478
batch 379, loss: 0.3246, instance_loss: 0.4634, weighted_loss: 0.3662, label: 1, bag_size: 657
batch 399, loss: 0.0012, instance_loss: 0.1497, weighted_loss: 0.0458, label: 3, bag_size: 18
batch 419, loss: 1.9744, instance_loss: 0.6348, weighted_loss: 1.5725, label: 2, bag_size: 676
batch 439, loss: 0.0492, instance_loss: 0.2387, weighted_loss: 0.1061, label: 2, bag_size: 312
batch 459, loss: 0.0293, instance_loss: 0.0971, weighted_loss: 0.0496, label: 0, bag_size: 990
batch 479, loss: 2.4805, instance_loss: 0.6512, weighted_loss: 1.9317, label: 2, bag_size: 194
batch 499, loss: 0.0008, instance_loss: 0.0386, weighted_loss: 0.0122, label: 4, bag_size: 91
batch 519, loss: 0.0001, instance_loss: 0.0249, weighted_loss: 0.0075, label: 4, bag_size: 104
batch 539, loss: 0.0205, instance_loss: 0.3069, weighted_loss: 0.1064, label: 0, bag_size: 148


class 0 clustering acc 0.9861926605504587: correct 21499/21800
class 1 clustering acc 0.593348623853211: correct 2587/4360
Epoch: 34, train_loss: 0.1978, train_clustering_loss:  0.2382, train_error: 0.0734
class 0: acc 0.9523809523809523, correct 100/105
class 1: acc 0.8706896551724138, correct 101/116
class 2: acc 0.8349514563106796, correct 86/103
class 3: acc 1.0, correct 109/109
class 4: acc 0.9732142857142857, correct 109/112

Val Set, val_loss: 1.0310, val_error: 0.2800, auc: 0.9268
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.4325: correct 173/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0128, instance_loss: 0.3435, weighted_loss: 0.1120, label: 4, bag_size: 711
batch 39, loss: 0.1306, instance_loss: 0.3033, weighted_loss: 0.1825, label: 2, bag_size: 358
batch 59, loss: 0.0074, instance_loss: 0.1587, weighted_loss: 0.0528, label: 3, bag_size: 18
batch 79, loss: 0.0002, instance_loss: 0.3103, weighted_loss: 0.0933, label: 3, bag_size: 16
batch 99, loss: 0.0076, instance_loss: 0.0962, weighted_loss: 0.0342, label: 0, bag_size: 246
batch 119, loss: 0.0002, instance_loss: 0.0168, weighted_loss: 0.0052, label: 3, bag_size: 115
batch 139, loss: 0.0077, instance_loss: 0.1155, weighted_loss: 0.0401, label: 3, bag_size: 952
batch 159, loss: 0.0602, instance_loss: 0.4365, weighted_loss: 0.1731, label: 4, bag_size: 663
batch 179, loss: 0.0162, instance_loss: 0.1222, weighted_loss: 0.0480, label: 0, bag_size: 1579
batch 199, loss: 0.1133, instance_loss: 0.2518, weighted_loss: 0.1549, label: 2, bag_size: 707
batch 219, loss: 0.0008, instance_loss: 0.0288, weighted_loss: 0.0092, label: 4, bag_size: 211
batch 239, loss: 0.4102, instance_loss: 0.3082, weighted_loss: 0.3796, label: 0, bag_size: 1061
batch 259, loss: 0.0003, instance_loss: 0.2376, weighted_loss: 0.0715, label: 3, bag_size: 21
batch 279, loss: 0.6009, instance_loss: 0.4166, weighted_loss: 0.5456, label: 2, bag_size: 1024
batch 299, loss: 0.2296, instance_loss: 0.3805, weighted_loss: 0.2748, label: 2, bag_size: 1439
batch 319, loss: 0.0002, instance_loss: 0.1529, weighted_loss: 0.0460, label: 3, bag_size: 20
batch 339, loss: 0.7345, instance_loss: 0.6032, weighted_loss: 0.6951, label: 3, bag_size: 360
batch 359, loss: 0.0001, instance_loss: 0.0332, weighted_loss: 0.0100, label: 4, bag_size: 148
batch 379, loss: 0.0137, instance_loss: 0.4191, weighted_loss: 0.1353, label: 0, bag_size: 129
batch 399, loss: 0.0100, instance_loss: 0.1350, weighted_loss: 0.0475, label: 0, bag_size: 466
batch 419, loss: 0.0004, instance_loss: 0.0397, weighted_loss: 0.0122, label: 4, bag_size: 107
batch 439, loss: 0.0017, instance_loss: 0.0445, weighted_loss: 0.0145, label: 4, bag_size: 157
batch 459, loss: 0.1772, instance_loss: 0.2412, weighted_loss: 0.1964, label: 2, bag_size: 1197
batch 479, loss: 0.5438, instance_loss: 0.2812, weighted_loss: 0.4650, label: 2, bag_size: 943
batch 499, loss: 0.0393, instance_loss: 0.1998, weighted_loss: 0.0875, label: 2, bag_size: 237
batch 519, loss: 0.6978, instance_loss: 0.4410, weighted_loss: 0.6208, label: 0, bag_size: 990
batch 539, loss: 0.0342, instance_loss: 0.1714, weighted_loss: 0.0754, label: 4, bag_size: 1474


class 0 clustering acc 0.9865596330275229: correct 21507/21800
class 1 clustering acc 0.5534403669724771: correct 2413/4360
Epoch: 35, train_loss: 0.2106, train_clustering_loss:  0.2565, train_error: 0.0679
class 0: acc 0.9565217391304348, correct 110/115
class 1: acc 0.8260869565217391, correct 76/92
class 2: acc 0.8833333333333333, correct 106/120
class 3: acc 0.981651376146789, correct 107/109
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 1.2150, val_error: 0.3200, auc: 0.9162
class 0 clustering acc 0.975: correct 1950/2000
class 1 clustering acc 0.465: correct 186/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0013, instance_loss: 0.0423, weighted_loss: 0.0136, label: 0, bag_size: 1086
batch 39, loss: 0.0019, instance_loss: 0.0413, weighted_loss: 0.0137, label: 0, bag_size: 476
batch 59, loss: 0.0001, instance_loss: 0.1120, weighted_loss: 0.0336, label: 4, bag_size: 128
batch 79, loss: 0.0036, instance_loss: 0.1446, weighted_loss: 0.0459, label: 1, bag_size: 828
batch 99, loss: 0.0129, instance_loss: 0.1757, weighted_loss: 0.0617, label: 0, bag_size: 1086
batch 119, loss: 0.0258, instance_loss: 0.4236, weighted_loss: 0.1452, label: 0, bag_size: 117
batch 139, loss: 0.0179, instance_loss: 0.1494, weighted_loss: 0.0574, label: 2, bag_size: 1218
batch 159, loss: 0.0001, instance_loss: 0.0176, weighted_loss: 0.0053, label: 4, bag_size: 72
batch 179, loss: 0.3084, instance_loss: 0.2120, weighted_loss: 0.2795, label: 3, bag_size: 1019
batch 199, loss: 0.0012, instance_loss: 0.0405, weighted_loss: 0.0130, label: 3, bag_size: 29
batch 219, loss: 0.0065, instance_loss: 0.1598, weighted_loss: 0.0525, label: 1, bag_size: 828
batch 239, loss: 0.1090, instance_loss: 0.1663, weighted_loss: 0.1262, label: 1, bag_size: 949
batch 259, loss: 0.0011, instance_loss: 0.1149, weighted_loss: 0.0352, label: 3, bag_size: 35
batch 279, loss: 0.0019, instance_loss: 0.0303, weighted_loss: 0.0105, label: 0, bag_size: 385
batch 299, loss: 0.0000, instance_loss: 0.1484, weighted_loss: 0.0445, label: 4, bag_size: 30
batch 319, loss: 0.0627, instance_loss: 0.8278, weighted_loss: 0.2922, label: 3, bag_size: 211
batch 339, loss: 0.0585, instance_loss: 0.1830, weighted_loss: 0.0958, label: 2, bag_size: 278
batch 359, loss: 0.0001, instance_loss: 0.1169, weighted_loss: 0.0351, label: 3, bag_size: 21
batch 379, loss: 0.0023, instance_loss: 0.0306, weighted_loss: 0.0108, label: 0, bag_size: 933
batch 399, loss: 0.0131, instance_loss: 0.1957, weighted_loss: 0.0679, label: 1, bag_size: 828
batch 419, loss: 0.0083, instance_loss: 0.2373, weighted_loss: 0.0770, label: 0, bag_size: 116
batch 439, loss: 0.0282, instance_loss: 0.0810, weighted_loss: 0.0441, label: 1, bag_size: 790
batch 459, loss: 0.0211, instance_loss: 0.1247, weighted_loss: 0.0522, label: 0, bag_size: 962
batch 479, loss: 0.0150, instance_loss: 0.1524, weighted_loss: 0.0562, label: 2, bag_size: 461
batch 499, loss: 0.2367, instance_loss: 0.3321, weighted_loss: 0.2653, label: 2, bag_size: 750
batch 519, loss: 0.0020, instance_loss: 0.0473, weighted_loss: 0.0156, label: 0, bag_size: 616
batch 539, loss: 0.0195, instance_loss: 0.1267, weighted_loss: 0.0517, label: 0, bag_size: 1012


class 0 clustering acc 0.9855045871559633: correct 21484/21800
class 1 clustering acc 0.5825688073394495: correct 2540/4360
Epoch: 36, train_loss: 0.1794, train_clustering_loss:  0.2435, train_error: 0.0642
class 0: acc 0.9739130434782609, correct 112/115
class 1: acc 0.8725490196078431, correct 89/102
class 2: acc 0.8907563025210085, correct 106/119
class 3: acc 0.9821428571428571, correct 110/112
class 4: acc 0.9587628865979382, correct 93/97

Val Set, val_loss: 1.0406, val_error: 0.2800, auc: 0.9257
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.47: correct 188/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0013, instance_loss: 0.3662, weighted_loss: 0.1108, label: 0, bag_size: 109
batch 39, loss: 0.0013, instance_loss: 0.1663, weighted_loss: 0.0508, label: 3, bag_size: 18
batch 59, loss: 0.0105, instance_loss: 0.1672, weighted_loss: 0.0575, label: 2, bag_size: 396
batch 79, loss: 0.0129, instance_loss: 0.1175, weighted_loss: 0.0443, label: 1, bag_size: 470
batch 99, loss: 0.0451, instance_loss: 0.1715, weighted_loss: 0.0831, label: 1, bag_size: 405
batch 119, loss: 0.0582, instance_loss: 0.2182, weighted_loss: 0.1062, label: 2, bag_size: 910
batch 139, loss: 0.1756, instance_loss: 0.2726, weighted_loss: 0.2047, label: 0, bag_size: 990
batch 159, loss: 0.5674, instance_loss: 0.3678, weighted_loss: 0.5075, label: 3, bag_size: 706
batch 179, loss: 0.0981, instance_loss: 0.2790, weighted_loss: 0.1523, label: 2, bag_size: 2703
batch 199, loss: 0.0000, instance_loss: 0.0353, weighted_loss: 0.0106, label: 4, bag_size: 211
batch 219, loss: 0.0002, instance_loss: 0.0161, weighted_loss: 0.0049, label: 4, bag_size: 182
batch 239, loss: 0.5675, instance_loss: 0.5811, weighted_loss: 0.5716, label: 2, bag_size: 508
batch 259, loss: 0.0517, instance_loss: 0.1789, weighted_loss: 0.0898, label: 1, bag_size: 242
batch 279, loss: 0.0340, instance_loss: 0.0630, weighted_loss: 0.0427, label: 1, bag_size: 869
batch 299, loss: 0.3095, instance_loss: 0.3639, weighted_loss: 0.3258, label: 1, bag_size: 868
batch 319, loss: 0.4774, instance_loss: 0.5527, weighted_loss: 0.5000, label: 1, bag_size: 102
batch 339, loss: 0.1178, instance_loss: 0.2294, weighted_loss: 0.1513, label: 2, bag_size: 839
batch 359, loss: 1.1716, instance_loss: 0.8126, weighted_loss: 1.0639, label: 2, bag_size: 878
batch 379, loss: 0.0193, instance_loss: 0.0970, weighted_loss: 0.0426, label: 2, bag_size: 1050
batch 399, loss: 0.1310, instance_loss: 0.1837, weighted_loss: 0.1468, label: 1, bag_size: 636
batch 419, loss: 0.0821, instance_loss: 0.1322, weighted_loss: 0.0971, label: 1, bag_size: 903
batch 439, loss: 0.0028, instance_loss: 0.0894, weighted_loss: 0.0287, label: 1, bag_size: 318
batch 459, loss: 0.0977, instance_loss: 0.2111, weighted_loss: 0.1317, label: 2, bag_size: 1653
batch 479, loss: 0.2091, instance_loss: 0.4825, weighted_loss: 0.2911, label: 4, bag_size: 817
batch 499, loss: 0.2326, instance_loss: 0.4385, weighted_loss: 0.2943, label: 2, bag_size: 1052
batch 519, loss: 0.0015, instance_loss: 0.0668, weighted_loss: 0.0211, label: 3, bag_size: 43
batch 539, loss: 0.2481, instance_loss: 0.7049, weighted_loss: 0.3851, label: 3, bag_size: 671


class 0 clustering acc 0.9857339449541285: correct 21489/21800
class 1 clustering acc 0.5717889908256881: correct 2493/4360
Epoch: 37, train_loss: 0.2212, train_clustering_loss:  0.2520, train_error: 0.0624
class 0: acc 0.9658119658119658, correct 113/117
class 1: acc 0.9043478260869565, correct 104/115
class 2: acc 0.8514851485148515, correct 86/101
class 3: acc 0.9739130434782609, correct 112/115
class 4: acc 0.9896907216494846, correct 96/97

Val Set, val_loss: 0.9526, val_error: 0.2800, auc: 0.9294
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.4625: correct 185/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0019, instance_loss: 0.1005, weighted_loss: 0.0315, label: 3, bag_size: 53
batch 39, loss: 0.0027, instance_loss: 0.2220, weighted_loss: 0.0685, label: 3, bag_size: 18
batch 59, loss: 0.0082, instance_loss: 0.1520, weighted_loss: 0.0513, label: 1, bag_size: 890
batch 79, loss: 1.7108, instance_loss: 0.4774, weighted_loss: 1.3408, label: 1, bag_size: 1080
batch 99, loss: 0.0837, instance_loss: 0.5713, weighted_loss: 0.2300, label: 4, bag_size: 511
batch 119, loss: 0.0782, instance_loss: 0.3753, weighted_loss: 0.1674, label: 3, bag_size: 230
batch 139, loss: 0.1387, instance_loss: 0.2797, weighted_loss: 0.1810, label: 0, bag_size: 736
batch 159, loss: 0.0019, instance_loss: 0.0718, weighted_loss: 0.0229, label: 4, bag_size: 55
batch 179, loss: 0.2274, instance_loss: 0.3569, weighted_loss: 0.2663, label: 0, bag_size: 1190
batch 199, loss: 0.7040, instance_loss: 0.6597, weighted_loss: 0.6907, label: 1, bag_size: 102
batch 219, loss: 0.0450, instance_loss: 0.1358, weighted_loss: 0.0723, label: 2, bag_size: 907
batch 239, loss: 0.0525, instance_loss: 0.1858, weighted_loss: 0.0925, label: 2, bag_size: 358
batch 259, loss: 0.0002, instance_loss: 0.0425, weighted_loss: 0.0128, label: 4, bag_size: 157
batch 279, loss: 0.0042, instance_loss: 0.1967, weighted_loss: 0.0619, label: 3, bag_size: 53
batch 299, loss: 0.0196, instance_loss: 0.1622, weighted_loss: 0.0624, label: 1, bag_size: 949
batch 319, loss: 0.0362, instance_loss: 0.4321, weighted_loss: 0.1549, label: 4, bag_size: 947
batch 339, loss: 0.0014, instance_loss: 0.1639, weighted_loss: 0.0502, label: 3, bag_size: 23
batch 359, loss: 0.4636, instance_loss: 0.3965, weighted_loss: 0.4435, label: 2, bag_size: 542
batch 379, loss: 0.0120, instance_loss: 0.2629, weighted_loss: 0.0873, label: 1, bag_size: 846
batch 399, loss: 0.0046, instance_loss: 0.2784, weighted_loss: 0.0868, label: 4, bag_size: 24
batch 419, loss: 0.2375, instance_loss: 0.2819, weighted_loss: 0.2508, label: 3, bag_size: 1019
batch 439, loss: 2.1467, instance_loss: 0.6681, weighted_loss: 1.7031, label: 1, bag_size: 770
batch 459, loss: 0.2971, instance_loss: 0.4895, weighted_loss: 0.3549, label: 3, bag_size: 630
batch 479, loss: 0.0004, instance_loss: 0.2487, weighted_loss: 0.0749, label: 4, bag_size: 23
batch 499, loss: 1.8997, instance_loss: 0.6679, weighted_loss: 1.5302, label: 2, bag_size: 194
batch 519, loss: 0.1365, instance_loss: 0.6148, weighted_loss: 0.2800, label: 3, bag_size: 283
batch 539, loss: 0.1836, instance_loss: 0.1838, weighted_loss: 0.1837, label: 3, bag_size: 533


class 0 clustering acc 0.9870183486238532: correct 21517/21800
class 1 clustering acc 0.5506880733944954: correct 2401/4360
Epoch: 38, train_loss: 0.2042, train_clustering_loss:  0.2570, train_error: 0.0587
class 0: acc 0.97, correct 97/100
class 1: acc 0.8431372549019608, correct 86/102
class 2: acc 0.9107142857142857, correct 102/112
class 3: acc 1.0, correct 103/103
class 4: acc 0.9765625, correct 125/128

Val Set, val_loss: 1.0054, val_error: 0.2800, auc: 0.9245
class 0 clustering acc 0.9795: correct 1959/2000
class 1 clustering acc 0.4425: correct 177/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0003, instance_loss: 0.0124, weighted_loss: 0.0040, label: 3, bag_size: 48
batch 39, loss: 0.4358, instance_loss: 0.4583, weighted_loss: 0.4426, label: 1, bag_size: 139
batch 59, loss: 0.0003, instance_loss: 0.0640, weighted_loss: 0.0194, label: 3, bag_size: 34
batch 79, loss: 0.2094, instance_loss: 0.2101, weighted_loss: 0.2096, label: 0, bag_size: 1257
batch 99, loss: 0.0658, instance_loss: 0.2915, weighted_loss: 0.1335, label: 1, bag_size: 711
batch 119, loss: 0.0226, instance_loss: 0.1495, weighted_loss: 0.0607, label: 2, bag_size: 655
batch 139, loss: 0.0344, instance_loss: 0.1689, weighted_loss: 0.0748, label: 1, bag_size: 965
batch 159, loss: 0.0311, instance_loss: 0.5740, weighted_loss: 0.1940, label: 4, bag_size: 533
batch 179, loss: 0.0529, instance_loss: 0.2124, weighted_loss: 0.1008, label: 0, bag_size: 1061
batch 199, loss: 0.0072, instance_loss: 0.3620, weighted_loss: 0.1137, label: 1, bag_size: 530
batch 219, loss: 0.0127, instance_loss: 0.3820, weighted_loss: 0.1235, label: 2, bag_size: 204
batch 239, loss: 0.1149, instance_loss: 0.2476, weighted_loss: 0.1547, label: 2, bag_size: 1141
batch 259, loss: 0.0690, instance_loss: 0.2265, weighted_loss: 0.1162, label: 2, bag_size: 741
batch 279, loss: 0.0051, instance_loss: 0.1507, weighted_loss: 0.0488, label: 4, bag_size: 182
batch 299, loss: 0.0114, instance_loss: 0.3788, weighted_loss: 0.1217, label: 3, bag_size: 1253
batch 319, loss: 0.5713, instance_loss: 0.3989, weighted_loss: 0.5196, label: 0, bag_size: 1190
batch 339, loss: 0.1237, instance_loss: 0.3134, weighted_loss: 0.1806, label: 4, bag_size: 1331
batch 359, loss: 0.0001, instance_loss: 0.3261, weighted_loss: 0.0979, label: 4, bag_size: 524
batch 379, loss: 0.4338, instance_loss: 0.3973, weighted_loss: 0.4228, label: 3, bag_size: 1019
batch 399, loss: 0.0018, instance_loss: 0.0487, weighted_loss: 0.0159, label: 3, bag_size: 33
batch 419, loss: 0.0343, instance_loss: 0.2155, weighted_loss: 0.0887, label: 2, bag_size: 324
batch 439, loss: 0.0096, instance_loss: 0.0831, weighted_loss: 0.0317, label: 1, bag_size: 1277
batch 459, loss: 0.0150, instance_loss: 0.4012, weighted_loss: 0.1308, label: 4, bag_size: 533
batch 479, loss: 0.0004, instance_loss: 0.0348, weighted_loss: 0.0107, label: 4, bag_size: 43
batch 499, loss: 0.0119, instance_loss: 0.1083, weighted_loss: 0.0408, label: 0, bag_size: 246
batch 519, loss: 0.0108, instance_loss: 0.1661, weighted_loss: 0.0574, label: 0, bag_size: 736
batch 539, loss: 0.0028, instance_loss: 0.2732, weighted_loss: 0.0839, label: 1, bag_size: 690


class 0 clustering acc 0.9860091743119266: correct 21495/21800
class 1 clustering acc 0.5704128440366972: correct 2487/4360
Epoch: 39, train_loss: 0.1451, train_clustering_loss:  0.2481, train_error: 0.0312
class 0: acc 1.0, correct 111/111
class 1: acc 0.9142857142857143, correct 96/105
class 2: acc 0.9512195121951219, correct 117/123
class 3: acc 0.9906542056074766, correct 106/107
class 4: acc 0.98989898989899, correct 98/99

Val Set, val_loss: 1.3348, val_error: 0.3200, auc: 0.9002
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.5025: correct 201/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0074, instance_loss: 0.1879, weighted_loss: 0.0616, label: 0, bag_size: 118
batch 39, loss: 0.0002, instance_loss: 0.0599, weighted_loss: 0.0181, label: 4, bag_size: 79
batch 59, loss: 0.0020, instance_loss: 0.1976, weighted_loss: 0.0607, label: 0, bag_size: 110
batch 79, loss: 0.0112, instance_loss: 0.1751, weighted_loss: 0.0603, label: 2, bag_size: 707
batch 99, loss: 0.0019, instance_loss: 0.0375, weighted_loss: 0.0126, label: 0, bag_size: 476
batch 119, loss: 0.0044, instance_loss: 0.2656, weighted_loss: 0.0828, label: 3, bag_size: 16
batch 139, loss: 0.0187, instance_loss: 0.0910, weighted_loss: 0.0404, label: 2, bag_size: 455
batch 159, loss: 0.0001, instance_loss: 0.2916, weighted_loss: 0.0875, label: 4, bag_size: 388
batch 179, loss: 0.0002, instance_loss: 0.0328, weighted_loss: 0.0100, label: 0, bag_size: 1599
batch 199, loss: 0.0011, instance_loss: 0.2127, weighted_loss: 0.0646, label: 3, bag_size: 16
batch 219, loss: 0.0153, instance_loss: 0.1150, weighted_loss: 0.0452, label: 2, bag_size: 1155
batch 239, loss: 0.0033, instance_loss: 0.1725, weighted_loss: 0.0541, label: 0, bag_size: 1018
batch 259, loss: 0.0007, instance_loss: 0.1395, weighted_loss: 0.0424, label: 0, bag_size: 110
batch 279, loss: 0.0864, instance_loss: 0.1413, weighted_loss: 0.1028, label: 2, bag_size: 399
batch 299, loss: 0.0310, instance_loss: 0.1092, weighted_loss: 0.0545, label: 2, bag_size: 907
batch 319, loss: 0.0804, instance_loss: 0.2663, weighted_loss: 0.1362, label: 0, bag_size: 962
batch 339, loss: 0.0010, instance_loss: 0.0679, weighted_loss: 0.0211, label: 1, bag_size: 938
batch 359, loss: 0.0007, instance_loss: 0.1534, weighted_loss: 0.0465, label: 4, bag_size: 24
batch 379, loss: 0.1343, instance_loss: 0.7729, weighted_loss: 0.3259, label: 2, bag_size: 1128
batch 399, loss: 0.0001, instance_loss: 0.0116, weighted_loss: 0.0036, label: 4, bag_size: 178
batch 419, loss: 0.0011, instance_loss: 0.0249, weighted_loss: 0.0083, label: 3, bag_size: 143
batch 439, loss: 0.0001, instance_loss: 0.0658, weighted_loss: 0.0198, label: 4, bag_size: 29
batch 459, loss: 0.0628, instance_loss: 0.2215, weighted_loss: 0.1104, label: 2, bag_size: 252
batch 479, loss: 0.0298, instance_loss: 0.1424, weighted_loss: 0.0636, label: 2, bag_size: 935
batch 499, loss: 0.0000, instance_loss: 0.1017, weighted_loss: 0.0306, label: 4, bag_size: 38
batch 519, loss: 0.1549, instance_loss: 0.3004, weighted_loss: 0.1985, label: 2, bag_size: 868
batch 539, loss: 0.0438, instance_loss: 0.1800, weighted_loss: 0.0847, label: 2, bag_size: 828


class 0 clustering acc 0.9859174311926605: correct 21493/21800
class 1 clustering acc 0.6266055045871559: correct 2732/4360
Epoch: 40, train_loss: 0.1295, train_clustering_loss:  0.2264, train_error: 0.0367
class 0: acc 0.9915966386554622, correct 118/119
class 1: acc 0.9117647058823529, correct 93/102
class 2: acc 0.9245283018867925, correct 98/106
class 3: acc 0.9910714285714286, correct 111/112
class 4: acc 0.9905660377358491, correct 105/106

Val Set, val_loss: 1.3894, val_error: 0.3200, auc: 0.8994
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.4725: correct 189/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0905, instance_loss: 0.5225, weighted_loss: 0.2201, label: 2, bag_size: 600
batch 39, loss: 0.0040, instance_loss: 0.0456, weighted_loss: 0.0165, label: 0, bag_size: 1301
batch 59, loss: 0.0012, instance_loss: 0.3677, weighted_loss: 0.1112, label: 3, bag_size: 18
batch 79, loss: 0.0077, instance_loss: 0.1512, weighted_loss: 0.0507, label: 1, bag_size: 530
batch 99, loss: 0.0002, instance_loss: 0.0589, weighted_loss: 0.0178, label: 3, bag_size: 24
batch 119, loss: 0.0005, instance_loss: 0.0983, weighted_loss: 0.0299, label: 3, bag_size: 18
batch 139, loss: 0.1282, instance_loss: 0.4610, weighted_loss: 0.2280, label: 1, bag_size: 269
batch 159, loss: 0.2077, instance_loss: 0.4182, weighted_loss: 0.2709, label: 2, bag_size: 511
batch 179, loss: 0.1578, instance_loss: 0.5554, weighted_loss: 0.2771, label: 2, bag_size: 500
batch 199, loss: 0.0001, instance_loss: 0.0193, weighted_loss: 0.0059, label: 4, bag_size: 91
batch 219, loss: 0.1254, instance_loss: 0.5007, weighted_loss: 0.2380, label: 3, bag_size: 706
batch 239, loss: 0.0001, instance_loss: 0.0133, weighted_loss: 0.0040, label: 4, bag_size: 178
batch 259, loss: 0.0172, instance_loss: 0.0756, weighted_loss: 0.0347, label: 1, bag_size: 1325
batch 279, loss: 0.0001, instance_loss: 0.0399, weighted_loss: 0.0120, label: 4, bag_size: 83
batch 299, loss: 0.0012, instance_loss: 0.4124, weighted_loss: 0.1246, label: 3, bag_size: 18
batch 319, loss: 0.0653, instance_loss: 0.1921, weighted_loss: 0.1034, label: 2, bag_size: 400
batch 339, loss: 0.3270, instance_loss: 0.1817, weighted_loss: 0.2834, label: 1, bag_size: 746
batch 359, loss: 0.4240, instance_loss: 0.6857, weighted_loss: 0.5025, label: 1, bag_size: 786
batch 379, loss: 0.0265, instance_loss: 0.2164, weighted_loss: 0.0835, label: 2, bag_size: 655
batch 399, loss: 0.0014, instance_loss: 0.3554, weighted_loss: 0.1076, label: 3, bag_size: 18
batch 419, loss: 0.7878, instance_loss: 0.6780, weighted_loss: 0.7549, label: 1, bag_size: 786
batch 439, loss: 0.4295, instance_loss: 0.3184, weighted_loss: 0.3961, label: 1, bag_size: 1724
batch 459, loss: 0.0052, instance_loss: 0.0536, weighted_loss: 0.0197, label: 1, bag_size: 356
batch 479, loss: 0.0007, instance_loss: 0.0475, weighted_loss: 0.0148, label: 4, bag_size: 78
batch 499, loss: 0.0004, instance_loss: 0.1591, weighted_loss: 0.0480, label: 0, bag_size: 109
batch 519, loss: 0.0106, instance_loss: 0.1253, weighted_loss: 0.0450, label: 2, bag_size: 748
batch 539, loss: 0.0089, instance_loss: 0.2972, weighted_loss: 0.0954, label: 4, bag_size: 354


class 0 clustering acc 0.9855504587155963: correct 21485/21800
class 1 clustering acc 0.5928899082568807: correct 2585/4360
Epoch: 41, train_loss: 0.1475, train_clustering_loss:  0.2417, train_error: 0.0440
class 0: acc 0.9896907216494846, correct 96/97
class 1: acc 0.9159663865546218, correct 109/119
class 2: acc 0.9, correct 90/100
class 3: acc 0.9901960784313726, correct 101/102
class 4: acc 0.984251968503937, correct 125/127

Val Set, val_loss: 1.1900, val_error: 0.3200, auc: 0.9109
class 0 clustering acc 0.9725: correct 1945/2000
class 1 clustering acc 0.4825: correct 193/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.6, correct 3/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0230, weighted_loss: 0.0069, label: 4, bag_size: 202
batch 39, loss: 0.2978, instance_loss: 0.5041, weighted_loss: 0.3597, label: 1, bag_size: 139
batch 59, loss: 0.1094, instance_loss: 0.1428, weighted_loss: 0.1194, label: 3, bag_size: 952
batch 79, loss: 0.0111, instance_loss: 0.3705, weighted_loss: 0.1189, label: 3, bag_size: 791
batch 99, loss: 0.0400, instance_loss: 0.2443, weighted_loss: 0.1013, label: 1, bag_size: 343
batch 119, loss: 0.0449, instance_loss: 0.2824, weighted_loss: 0.1161, label: 3, bag_size: 1559
batch 139, loss: 0.4833, instance_loss: 0.6657, weighted_loss: 0.5381, label: 1, bag_size: 1172
batch 159, loss: 0.0006, instance_loss: 0.0417, weighted_loss: 0.0129, label: 1, bag_size: 847
batch 179, loss: 0.0693, instance_loss: 0.4787, weighted_loss: 0.1921, label: 1, bag_size: 1144
batch 199, loss: 0.1101, instance_loss: 0.5147, weighted_loss: 0.2315, label: 1, bag_size: 470
batch 219, loss: 0.0004, instance_loss: 0.0190, weighted_loss: 0.0060, label: 0, bag_size: 518
batch 239, loss: 0.1927, instance_loss: 0.1695, weighted_loss: 0.1857, label: 1, bag_size: 945
batch 259, loss: 0.1427, instance_loss: 0.3147, weighted_loss: 0.1943, label: 2, bag_size: 1700
batch 279, loss: 0.0671, instance_loss: 0.3006, weighted_loss: 0.1371, label: 1, bag_size: 1144
batch 299, loss: 0.0734, instance_loss: 0.3930, weighted_loss: 0.1693, label: 0, bag_size: 868
batch 319, loss: 0.0002, instance_loss: 0.0510, weighted_loss: 0.0154, label: 4, bag_size: 104
batch 339, loss: 0.0101, instance_loss: 0.2960, weighted_loss: 0.0959, label: 1, bag_size: 690
batch 359, loss: 0.0211, instance_loss: 0.2495, weighted_loss: 0.0896, label: 1, bag_size: 442
batch 379, loss: 0.8497, instance_loss: 0.5196, weighted_loss: 0.7506, label: 2, bag_size: 272
batch 399, loss: 0.0032, instance_loss: 0.0861, weighted_loss: 0.0281, label: 0, bag_size: 375
batch 419, loss: 0.1398, instance_loss: 0.6408, weighted_loss: 0.2901, label: 0, bag_size: 423
batch 439, loss: 0.1799, instance_loss: 0.4410, weighted_loss: 0.2583, label: 2, bag_size: 1133
batch 459, loss: 0.0363, instance_loss: 0.2645, weighted_loss: 0.1048, label: 0, bag_size: 155
batch 479, loss: 0.0006, instance_loss: 0.0209, weighted_loss: 0.0067, label: 3, bag_size: 143
batch 499, loss: 0.0003, instance_loss: 0.4117, weighted_loss: 0.1237, label: 4, bag_size: 388
batch 519, loss: 0.0023, instance_loss: 0.2142, weighted_loss: 0.0659, label: 0, bag_size: 163
batch 539, loss: 0.5085, instance_loss: 0.5235, weighted_loss: 0.5130, label: 3, bag_size: 230


class 0 clustering acc 0.9855963302752293: correct 21486/21800
class 1 clustering acc 0.5983944954128441: correct 2609/4360
Epoch: 42, train_loss: 0.1379, train_clustering_loss:  0.2353, train_error: 0.0477
class 0: acc 0.9827586206896551, correct 114/116
class 1: acc 0.9134615384615384, correct 95/104
class 2: acc 0.8712871287128713, correct 88/101
class 3: acc 0.9917355371900827, correct 120/121
class 4: acc 0.9902912621359223, correct 102/103

Val Set, val_loss: 1.4924, val_error: 0.3200, auc: 0.8925
class 0 clustering acc 0.971: correct 1942/2000
class 1 clustering acc 0.4625: correct 185/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0255, instance_loss: 0.1856, weighted_loss: 0.0735, label: 0, bag_size: 478
batch 39, loss: 0.0245, instance_loss: 0.2730, weighted_loss: 0.0991, label: 2, bag_size: 1006
batch 59, loss: 0.0542, instance_loss: 0.1064, weighted_loss: 0.0698, label: 1, bag_size: 945
batch 79, loss: 0.0338, instance_loss: 0.2420, weighted_loss: 0.0962, label: 4, bag_size: 1121
batch 99, loss: 0.1188, instance_loss: 0.1323, weighted_loss: 0.1228, label: 1, bag_size: 847
batch 119, loss: 0.0173, instance_loss: 0.1263, weighted_loss: 0.0500, label: 0, bag_size: 1579
batch 139, loss: 0.0000, instance_loss: 0.0843, weighted_loss: 0.0253, label: 3, bag_size: 24
batch 159, loss: 0.4243, instance_loss: 0.2928, weighted_loss: 0.3848, label: 2, bag_size: 330
batch 179, loss: 0.0044, instance_loss: 0.1595, weighted_loss: 0.0509, label: 0, bag_size: 1196
batch 199, loss: 0.1441, instance_loss: 0.6360, weighted_loss: 0.2917, label: 3, bag_size: 671
batch 219, loss: 0.0024, instance_loss: 0.5969, weighted_loss: 0.1808, label: 4, bag_size: 1357
batch 239, loss: 0.0391, instance_loss: 0.2496, weighted_loss: 0.1023, label: 4, bag_size: 590
batch 259, loss: 0.0114, instance_loss: 0.0304, weighted_loss: 0.0171, label: 4, bag_size: 125
batch 279, loss: 0.0934, instance_loss: 0.3003, weighted_loss: 0.1555, label: 1, bag_size: 343
batch 299, loss: 0.0305, instance_loss: 0.1403, weighted_loss: 0.0634, label: 2, bag_size: 1006
batch 319, loss: 0.3342, instance_loss: 0.6094, weighted_loss: 0.4168, label: 1, bag_size: 917
batch 339, loss: 0.0169, instance_loss: 0.3536, weighted_loss: 0.1179, label: 0, bag_size: 117
batch 359, loss: 0.0556, instance_loss: 0.1330, weighted_loss: 0.0789, label: 2, bag_size: 910
batch 379, loss: 0.0001, instance_loss: 0.2039, weighted_loss: 0.0612, label: 3, bag_size: 16
batch 399, loss: 0.0071, instance_loss: 0.0828, weighted_loss: 0.0298, label: 2, bag_size: 1514
batch 419, loss: 0.6011, instance_loss: 0.4473, weighted_loss: 0.5550, label: 0, bag_size: 432
batch 439, loss: 0.0405, instance_loss: 0.2555, weighted_loss: 0.1050, label: 2, bag_size: 471
batch 459, loss: 0.1948, instance_loss: 0.5319, weighted_loss: 0.2960, label: 2, bag_size: 3236
batch 479, loss: 0.8650, instance_loss: 0.5148, weighted_loss: 0.7600, label: 1, bag_size: 868
batch 499, loss: 0.0036, instance_loss: 0.0732, weighted_loss: 0.0244, label: 1, bag_size: 534
batch 519, loss: 0.0006, instance_loss: 0.1544, weighted_loss: 0.0468, label: 4, bag_size: 83
batch 539, loss: 0.0053, instance_loss: 0.2219, weighted_loss: 0.0703, label: 0, bag_size: 120


class 0 clustering acc 0.9862385321100917: correct 21500/21800
class 1 clustering acc 0.6130733944954129: correct 2673/4360
Epoch: 43, train_loss: 0.1227, train_clustering_loss:  0.2341, train_error: 0.0312
class 0: acc 0.9910714285714286, correct 111/112
class 1: acc 0.9256198347107438, correct 112/121
class 2: acc 0.944954128440367, correct 103/109
class 3: acc 0.9900990099009901, correct 100/101
class 4: acc 1.0, correct 102/102

Val Set, val_loss: 2.2234, val_error: 0.4000, auc: 0.8768
class 0 clustering acc 0.957: correct 1914/2000
class 1 clustering acc 0.495: correct 198/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6, correct 3/5
class 4: acc 0.25, correct 3/12
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0012, instance_loss: 0.1255, weighted_loss: 0.0385, label: 3, bag_size: 18
batch 39, loss: 0.0026, instance_loss: 0.1585, weighted_loss: 0.0494, label: 0, bag_size: 148
batch 59, loss: 0.0029, instance_loss: 0.1431, weighted_loss: 0.0449, label: 0, bag_size: 128
batch 79, loss: 0.0007, instance_loss: 0.0622, weighted_loss: 0.0192, label: 4, bag_size: 143
batch 99, loss: 0.0185, instance_loss: 0.1003, weighted_loss: 0.0430, label: 1, bag_size: 534
batch 119, loss: 0.0001, instance_loss: 0.0078, weighted_loss: 0.0024, label: 4, bag_size: 178
batch 139, loss: 0.2194, instance_loss: 0.5574, weighted_loss: 0.3208, label: 3, bag_size: 281
batch 159, loss: 0.8528, instance_loss: 0.5244, weighted_loss: 0.7543, label: 2, bag_size: 471
batch 179, loss: 0.0136, instance_loss: 0.5190, weighted_loss: 0.1652, label: 1, bag_size: 1724
batch 199, loss: 0.0077, instance_loss: 0.1451, weighted_loss: 0.0489, label: 4, bag_size: 711
batch 219, loss: 0.0051, instance_loss: 0.0893, weighted_loss: 0.0303, label: 0, bag_size: 1255
batch 239, loss: 0.0391, instance_loss: 0.1142, weighted_loss: 0.0616, label: 1, bag_size: 903
batch 259, loss: 0.0002, instance_loss: 0.0445, weighted_loss: 0.0135, label: 4, bag_size: 211
batch 279, loss: 0.0032, instance_loss: 0.0798, weighted_loss: 0.0262, label: 0, bag_size: 1018
batch 299, loss: 0.0176, instance_loss: 0.2490, weighted_loss: 0.0870, label: 4, bag_size: 1331
batch 319, loss: 0.1593, instance_loss: 0.4126, weighted_loss: 0.2353, label: 2, bag_size: 1400
batch 339, loss: 0.0022, instance_loss: 0.1432, weighted_loss: 0.0445, label: 0, bag_size: 607
batch 359, loss: 0.0080, instance_loss: 0.0223, weighted_loss: 0.0123, label: 3, bag_size: 123
batch 379, loss: 0.0078, instance_loss: 0.4890, weighted_loss: 0.1522, label: 4, bag_size: 754
batch 399, loss: 0.0020, instance_loss: 0.1430, weighted_loss: 0.0443, label: 0, bag_size: 1255
batch 419, loss: 0.0152, instance_loss: 0.4045, weighted_loss: 0.1320, label: 3, bag_size: 18
batch 439, loss: 0.0000, instance_loss: 0.0315, weighted_loss: 0.0094, label: 4, bag_size: 83
batch 459, loss: 0.9697, instance_loss: 0.5702, weighted_loss: 0.8498, label: 1, bag_size: 446
batch 479, loss: 0.2459, instance_loss: 0.3441, weighted_loss: 0.2754, label: 1, bag_size: 690
batch 499, loss: 0.0782, instance_loss: 0.2435, weighted_loss: 0.1278, label: 2, bag_size: 1019
batch 519, loss: 0.0110, instance_loss: 0.0723, weighted_loss: 0.0294, label: 0, bag_size: 524
batch 539, loss: 0.0102, instance_loss: 0.1081, weighted_loss: 0.0395, label: 0, bag_size: 367


class 0 clustering acc 0.9844954128440367: correct 21462/21800
class 1 clustering acc 0.5830275229357799: correct 2542/4360
Epoch: 44, train_loss: 0.1490, train_clustering_loss:  0.2515, train_error: 0.0459
class 0: acc 1.0, correct 114/114
class 1: acc 0.9051724137931034, correct 105/116
class 2: acc 0.8921568627450981, correct 91/102
class 3: acc 0.9911504424778761, correct 112/113
class 4: acc 0.98, correct 98/100

Val Set, val_loss: 1.1433, val_error: 0.2800, auc: 0.9109
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.4525: correct 181/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6, correct 3/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0067, instance_loss: 0.1574, weighted_loss: 0.0519, label: 0, bag_size: 350
batch 39, loss: 0.0234, instance_loss: 0.2529, weighted_loss: 0.0922, label: 1, bag_size: 838
batch 59, loss: 0.0620, instance_loss: 0.6581, weighted_loss: 0.2408, label: 2, bag_size: 934
batch 79, loss: 0.0024, instance_loss: 0.3909, weighted_loss: 0.1190, label: 0, bag_size: 155
batch 99, loss: 0.0003, instance_loss: 0.0629, weighted_loss: 0.0191, label: 4, bag_size: 764
batch 119, loss: 0.0000, instance_loss: 0.1776, weighted_loss: 0.0533, label: 4, bag_size: 26
batch 139, loss: 0.5396, instance_loss: 0.6901, weighted_loss: 0.5848, label: 2, bag_size: 679
batch 159, loss: 0.2196, instance_loss: 0.3738, weighted_loss: 0.2659, label: 2, bag_size: 356
batch 179, loss: 1.6835, instance_loss: 0.6627, weighted_loss: 1.3772, label: 2, bag_size: 629
batch 199, loss: 0.1016, instance_loss: 0.0555, weighted_loss: 0.0878, label: 1, bag_size: 320
batch 219, loss: 0.0039, instance_loss: 0.1466, weighted_loss: 0.0467, label: 2, bag_size: 777
batch 239, loss: 0.0043, instance_loss: 0.1899, weighted_loss: 0.0599, label: 2, bag_size: 626
batch 259, loss: 0.0003, instance_loss: 0.1100, weighted_loss: 0.0332, label: 3, bag_size: 94
batch 279, loss: 0.0000, instance_loss: 0.0264, weighted_loss: 0.0080, label: 4, bag_size: 160
batch 299, loss: 0.0002, instance_loss: 0.0419, weighted_loss: 0.0127, label: 3, bag_size: 33
batch 319, loss: 0.0001, instance_loss: 0.0590, weighted_loss: 0.0178, label: 3, bag_size: 50
batch 339, loss: 0.0218, instance_loss: 0.2346, weighted_loss: 0.0856, label: 0, bag_size: 1332
batch 359, loss: 0.0247, instance_loss: 0.1140, weighted_loss: 0.0515, label: 1, bag_size: 346
batch 379, loss: 0.0605, instance_loss: 0.1997, weighted_loss: 0.1022, label: 1, bag_size: 682
batch 399, loss: 0.1236, instance_loss: 0.4131, weighted_loss: 0.2104, label: 2, bag_size: 589
batch 419, loss: 0.0001, instance_loss: 0.0370, weighted_loss: 0.0112, label: 4, bag_size: 137
batch 439, loss: 0.0194, instance_loss: 0.1658, weighted_loss: 0.0633, label: 2, bag_size: 655
batch 459, loss: 0.3337, instance_loss: 0.4441, weighted_loss: 0.3668, label: 0, bag_size: 432
batch 479, loss: 0.0022, instance_loss: 0.1077, weighted_loss: 0.0339, label: 0, bag_size: 110
batch 499, loss: 0.0749, instance_loss: 0.2048, weighted_loss: 0.1139, label: 2, bag_size: 1788
batch 519, loss: 0.2479, instance_loss: 0.3882, weighted_loss: 0.2900, label: 1, bag_size: 968
batch 539, loss: 0.0020, instance_loss: 0.0633, weighted_loss: 0.0204, label: 3, bag_size: 60


class 0 clustering acc 0.9853669724770642: correct 21481/21800
class 1 clustering acc 0.5848623853211009: correct 2550/4360
Epoch: 45, train_loss: 0.1332, train_clustering_loss:  0.2397, train_error: 0.0459
class 0: acc 0.946236559139785, correct 88/93
class 1: acc 0.9272727272727272, correct 102/110
class 2: acc 0.9056603773584906, correct 96/106
class 3: acc 0.9913793103448276, correct 115/116
class 4: acc 0.9916666666666667, correct 119/120

Val Set, val_loss: 1.2064, val_error: 0.2600, auc: 0.9170
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.48: correct 192/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0861, instance_loss: 0.4445, weighted_loss: 0.1936, label: 2, bag_size: 676
batch 39, loss: 0.2171, instance_loss: 0.1937, weighted_loss: 0.2101, label: 4, bag_size: 826
batch 59, loss: 0.0046, instance_loss: 0.1982, weighted_loss: 0.0627, label: 2, bag_size: 400
batch 79, loss: 0.0000, instance_loss: 0.0332, weighted_loss: 0.0100, label: 4, bag_size: 134
batch 99, loss: 0.0004, instance_loss: 0.0285, weighted_loss: 0.0088, label: 3, bag_size: 66
batch 119, loss: 0.0093, instance_loss: 0.0811, weighted_loss: 0.0309, label: 1, bag_size: 937
batch 139, loss: 0.0032, instance_loss: 0.0826, weighted_loss: 0.0270, label: 0, bag_size: 446
batch 159, loss: 0.0169, instance_loss: 0.0462, weighted_loss: 0.0257, label: 1, bag_size: 369
batch 179, loss: 0.0837, instance_loss: 0.2162, weighted_loss: 0.1234, label: 1, bag_size: 968
batch 199, loss: 0.0002, instance_loss: 0.0548, weighted_loss: 0.0166, label: 3, bag_size: 50
batch 219, loss: 0.0002, instance_loss: 0.0108, weighted_loss: 0.0034, label: 4, bag_size: 72
batch 239, loss: 0.0237, instance_loss: 0.2925, weighted_loss: 0.1043, label: 0, bag_size: 371
batch 259, loss: 0.0087, instance_loss: 0.1666, weighted_loss: 0.0561, label: 1, bag_size: 754
batch 279, loss: 0.0264, instance_loss: 0.2094, weighted_loss: 0.0813, label: 2, bag_size: 1215
batch 299, loss: 0.0012, instance_loss: 0.0837, weighted_loss: 0.0260, label: 3, bag_size: 35
batch 319, loss: 0.0018, instance_loss: 0.1227, weighted_loss: 0.0380, label: 0, bag_size: 1018
batch 339, loss: 0.0017, instance_loss: 0.1241, weighted_loss: 0.0384, label: 1, bag_size: 690
batch 359, loss: 0.0026, instance_loss: 0.2107, weighted_loss: 0.0650, label: 3, bag_size: 18
batch 379, loss: 0.0003, instance_loss: 0.3968, weighted_loss: 0.1193, label: 0, bag_size: 128
batch 399, loss: 0.0781, instance_loss: 0.2092, weighted_loss: 0.1174, label: 1, bag_size: 828
batch 419, loss: 0.0223, instance_loss: 0.3286, weighted_loss: 0.1142, label: 2, bag_size: 1050
batch 439, loss: 0.0071, instance_loss: 0.3734, weighted_loss: 0.1170, label: 0, bag_size: 155
batch 459, loss: 0.0680, instance_loss: 0.2053, weighted_loss: 0.1092, label: 2, bag_size: 271
batch 479, loss: 0.2039, instance_loss: 0.4341, weighted_loss: 0.2730, label: 4, bag_size: 354
batch 499, loss: 0.0012, instance_loss: 0.1384, weighted_loss: 0.0424, label: 0, bag_size: 163
batch 519, loss: 0.1150, instance_loss: 0.6767, weighted_loss: 0.2835, label: 2, bag_size: 396
batch 539, loss: 0.0034, instance_loss: 0.1645, weighted_loss: 0.0517, label: 0, bag_size: 117


class 0 clustering acc 0.986788990825688: correct 21512/21800
class 1 clustering acc 0.5759174311926606: correct 2511/4360
Epoch: 46, train_loss: 0.1456, train_clustering_loss:  0.2461, train_error: 0.0495
class 0: acc 0.9615384615384616, correct 125/130
class 1: acc 0.9252336448598131, correct 99/107
class 2: acc 0.907563025210084, correct 108/119
class 3: acc 0.9795918367346939, correct 96/98
class 4: acc 0.989010989010989, correct 90/91

Val Set, val_loss: 1.1986, val_error: 0.2600, auc: 0.9163
class 0 clustering acc 0.9675: correct 1935/2000
class 1 clustering acc 0.4875: correct 195/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.1258, instance_loss: 0.2818, weighted_loss: 0.1726, label: 0, bag_size: 1190
batch 39, loss: 0.0081, instance_loss: 0.2719, weighted_loss: 0.0872, label: 2, bag_size: 567
batch 59, loss: 0.1030, instance_loss: 0.6791, weighted_loss: 0.2759, label: 3, bag_size: 607
batch 79, loss: 0.1141, instance_loss: 0.5729, weighted_loss: 0.2517, label: 2, bag_size: 758
batch 99, loss: 0.1078, instance_loss: 0.2529, weighted_loss: 0.1514, label: 1, bag_size: 913
batch 119, loss: 0.0394, instance_loss: 0.1974, weighted_loss: 0.0868, label: 2, bag_size: 470
batch 139, loss: 0.0333, instance_loss: 0.1537, weighted_loss: 0.0694, label: 0, bag_size: 990
batch 159, loss: 0.0052, instance_loss: 0.1310, weighted_loss: 0.0429, label: 0, bag_size: 375
batch 179, loss: 0.1401, instance_loss: 0.1805, weighted_loss: 0.1522, label: 2, bag_size: 1180
batch 199, loss: 0.0099, instance_loss: 0.2927, weighted_loss: 0.0948, label: 2, bag_size: 571
batch 219, loss: 0.0875, instance_loss: 0.2057, weighted_loss: 0.1230, label: 2, bag_size: 1617
batch 239, loss: 0.0008, instance_loss: 0.0330, weighted_loss: 0.0105, label: 0, bag_size: 476
batch 259, loss: 0.0001, instance_loss: 0.0499, weighted_loss: 0.0150, label: 4, bag_size: 44
batch 279, loss: 0.5684, instance_loss: 0.3663, weighted_loss: 0.5078, label: 0, bag_size: 990
batch 299, loss: 0.0002, instance_loss: 0.0265, weighted_loss: 0.0081, label: 3, bag_size: 56
batch 319, loss: 0.0286, instance_loss: 0.0837, weighted_loss: 0.0451, label: 1, bag_size: 886
batch 339, loss: 0.0022, instance_loss: 0.1240, weighted_loss: 0.0387, label: 0, bag_size: 1255
batch 359, loss: 0.0118, instance_loss: 0.0753, weighted_loss: 0.0309, label: 1, bag_size: 636
batch 379, loss: 0.0209, instance_loss: 0.1921, weighted_loss: 0.0722, label: 0, bag_size: 381
batch 399, loss: 0.0851, instance_loss: 0.2833, weighted_loss: 0.1446, label: 2, bag_size: 806
batch 419, loss: 0.0019, instance_loss: 0.1468, weighted_loss: 0.0454, label: 3, bag_size: 20
batch 439, loss: 0.0064, instance_loss: 0.0761, weighted_loss: 0.0273, label: 1, bag_size: 636
batch 459, loss: 0.0648, instance_loss: 0.4939, weighted_loss: 0.1935, label: 2, bag_size: 720
batch 479, loss: 0.0119, instance_loss: 0.4495, weighted_loss: 0.1432, label: 3, bag_size: 791
batch 499, loss: 0.2746, instance_loss: 0.2349, weighted_loss: 0.2627, label: 4, bag_size: 1474
batch 519, loss: 0.0009, instance_loss: 0.2217, weighted_loss: 0.0672, label: 2, bag_size: 707
batch 539, loss: 0.0032, instance_loss: 0.5194, weighted_loss: 0.1581, label: 1, bag_size: 1152


class 0 clustering acc 0.9852293577981651: correct 21478/21800
class 1 clustering acc 0.5912844036697248: correct 2578/4360
Epoch: 47, train_loss: 0.0912, train_clustering_loss:  0.2402, train_error: 0.0165
class 0: acc 1.0, correct 118/118
class 1: acc 0.9519230769230769, correct 99/104
class 2: acc 0.975, correct 117/120
class 3: acc 0.9900990099009901, correct 100/101
class 4: acc 1.0, correct 102/102

Val Set, val_loss: 1.3088, val_error: 0.2800, auc: 0.9143
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.5: correct 200/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.6666666666666666, correct 8/12
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0082, instance_loss: 0.1845, weighted_loss: 0.0611, label: 4, bag_size: 1121
batch 39, loss: 0.0076, instance_loss: 0.2048, weighted_loss: 0.0668, label: 1, bag_size: 846
batch 59, loss: 0.0000, instance_loss: 0.0556, weighted_loss: 0.0167, label: 4, bag_size: 88
batch 79, loss: 0.0000, instance_loss: 0.0326, weighted_loss: 0.0098, label: 4, bag_size: 107
batch 99, loss: 0.5896, instance_loss: 0.9677, weighted_loss: 0.7030, label: 4, bag_size: 436
batch 119, loss: 0.0573, instance_loss: 0.4831, weighted_loss: 0.1850, label: 1, bag_size: 747
batch 139, loss: 0.0348, instance_loss: 0.1411, weighted_loss: 0.0667, label: 2, bag_size: 347
batch 159, loss: 0.0238, instance_loss: 0.0883, weighted_loss: 0.0432, label: 3, bag_size: 16
batch 179, loss: 0.7387, instance_loss: 0.6385, weighted_loss: 0.7086, label: 1, bag_size: 293
batch 199, loss: 0.0007, instance_loss: 0.0746, weighted_loss: 0.0229, label: 0, bag_size: 1255
batch 219, loss: 0.0376, instance_loss: 0.2703, weighted_loss: 0.1074, label: 0, bag_size: 294
batch 239, loss: 0.0000, instance_loss: 0.0103, weighted_loss: 0.0031, label: 4, bag_size: 185
batch 259, loss: 0.0033, instance_loss: 0.1708, weighted_loss: 0.0535, label: 0, bag_size: 128
batch 279, loss: 0.0013, instance_loss: 0.0458, weighted_loss: 0.0147, label: 0, bag_size: 1235
batch 299, loss: 0.0391, instance_loss: 0.2104, weighted_loss: 0.0905, label: 2, bag_size: 1180
batch 319, loss: 0.0035, instance_loss: 0.1112, weighted_loss: 0.0358, label: 0, bag_size: 1332
batch 339, loss: 0.0051, instance_loss: 0.1763, weighted_loss: 0.0564, label: 1, bag_size: 828
batch 359, loss: 0.0283, instance_loss: 0.2080, weighted_loss: 0.0822, label: 0, bag_size: 800
batch 379, loss: 0.0032, instance_loss: 0.0270, weighted_loss: 0.0103, label: 1, bag_size: 937
batch 399, loss: 0.0010, instance_loss: 0.0234, weighted_loss: 0.0077, label: 1, bag_size: 847
batch 419, loss: 0.1220, instance_loss: 0.2905, weighted_loss: 0.1726, label: 2, bag_size: 278
batch 439, loss: 0.0502, instance_loss: 0.2702, weighted_loss: 0.1162, label: 0, bag_size: 478
batch 459, loss: 0.0768, instance_loss: 0.3671, weighted_loss: 0.1639, label: 2, bag_size: 1677
batch 479, loss: 0.0701, instance_loss: 0.2061, weighted_loss: 0.1109, label: 2, bag_size: 262
batch 499, loss: 0.5534, instance_loss: 0.7646, weighted_loss: 0.6168, label: 2, bag_size: 1410
batch 519, loss: 0.1281, instance_loss: 0.3559, weighted_loss: 0.1964, label: 2, bag_size: 355
batch 539, loss: 0.0411, instance_loss: 0.1803, weighted_loss: 0.0829, label: 2, bag_size: 330


class 0 clustering acc 0.9860091743119266: correct 21495/21800
class 1 clustering acc 0.6222477064220183: correct 2713/4360
Epoch: 48, train_loss: 0.1254, train_clustering_loss:  0.2303, train_error: 0.0312
class 0: acc 0.9716981132075472, correct 103/106
class 1: acc 0.9345794392523364, correct 100/107
class 2: acc 0.9557522123893806, correct 108/113
class 3: acc 0.9834710743801653, correct 119/121
class 4: acc 1.0, correct 98/98

Val Set, val_loss: 1.3793, val_error: 0.3000, auc: 0.9153
class 0 clustering acc 0.9695: correct 1939/2000
class 1 clustering acc 0.4975: correct 199/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0025, instance_loss: 0.1038, weighted_loss: 0.0329, label: 1, bag_size: 886
batch 39, loss: 0.0001, instance_loss: 0.0524, weighted_loss: 0.0158, label: 4, bag_size: 143
batch 59, loss: 0.0001, instance_loss: 0.0587, weighted_loss: 0.0177, label: 3, bag_size: 94
batch 79, loss: 0.0706, instance_loss: 0.1086, weighted_loss: 0.0820, label: 1, bag_size: 1325
batch 99, loss: 0.0016, instance_loss: 0.1227, weighted_loss: 0.0379, label: 4, bag_size: 182
batch 119, loss: 0.0053, instance_loss: 0.0579, weighted_loss: 0.0211, label: 3, bag_size: 23
batch 139, loss: 0.0082, instance_loss: 0.2060, weighted_loss: 0.0675, label: 0, bag_size: 607
batch 159, loss: 0.0001, instance_loss: 0.0170, weighted_loss: 0.0052, label: 3, bag_size: 37
batch 179, loss: 0.0007, instance_loss: 0.1074, weighted_loss: 0.0327, label: 3, bag_size: 16
batch 199, loss: 0.0007, instance_loss: 0.0906, weighted_loss: 0.0277, label: 3, bag_size: 18
batch 219, loss: 0.0009, instance_loss: 0.0992, weighted_loss: 0.0304, label: 4, bag_size: 38
batch 239, loss: 0.0013, instance_loss: 0.1235, weighted_loss: 0.0380, label: 0, bag_size: 350
batch 259, loss: 0.0043, instance_loss: 0.0997, weighted_loss: 0.0329, label: 0, bag_size: 1579
batch 279, loss: 0.0017, instance_loss: 0.0896, weighted_loss: 0.0280, label: 0, bag_size: 424
batch 299, loss: 0.0023, instance_loss: 0.3436, weighted_loss: 0.1047, label: 0, bag_size: 122
batch 319, loss: 0.0014, instance_loss: 0.3021, weighted_loss: 0.0916, label: 1, bag_size: 1152
batch 339, loss: 0.1226, instance_loss: 0.4048, weighted_loss: 0.2072, label: 1, bag_size: 868
batch 359, loss: 0.0117, instance_loss: 0.2024, weighted_loss: 0.0689, label: 2, bag_size: 323
batch 379, loss: 0.0219, instance_loss: 0.4042, weighted_loss: 0.1366, label: 1, bag_size: 319
batch 399, loss: 0.0270, instance_loss: 0.2566, weighted_loss: 0.0959, label: 0, bag_size: 1012
batch 419, loss: 0.0000, instance_loss: 0.1422, weighted_loss: 0.0427, label: 4, bag_size: 19
batch 439, loss: 0.0001, instance_loss: 0.0309, weighted_loss: 0.0093, label: 4, bag_size: 211
batch 459, loss: 0.0016, instance_loss: 0.1972, weighted_loss: 0.0603, label: 0, bag_size: 118
batch 479, loss: 0.0789, instance_loss: 0.2897, weighted_loss: 0.1421, label: 0, bag_size: 990
batch 499, loss: 0.0003, instance_loss: 0.1558, weighted_loss: 0.0469, label: 4, bag_size: 19
batch 519, loss: 0.4340, instance_loss: 0.5643, weighted_loss: 0.4731, label: 2, bag_size: 1043
batch 539, loss: 0.0203, instance_loss: 0.1218, weighted_loss: 0.0508, label: 2, bag_size: 480


class 0 clustering acc 0.9840825688073395: correct 21453/21800
class 1 clustering acc 0.6029816513761468: correct 2629/4360
Epoch: 49, train_loss: 0.1167, train_clustering_loss:  0.2377, train_error: 0.0404
class 0: acc 0.9693877551020408, correct 95/98
class 1: acc 0.9327731092436975, correct 111/119
class 2: acc 0.9166666666666666, correct 99/108
class 3: acc 0.9905660377358491, correct 105/106
class 4: acc 0.9912280701754386, correct 113/114

Val Set, val_loss: 1.5816, val_error: 0.3200, auc: 0.8988
class 0 clustering acc 0.977: correct 1954/2000
class 1 clustering acc 0.45: correct 180/400
class 0: acc 0.8, correct 8/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0087, instance_loss: 0.1253, weighted_loss: 0.0437, label: 2, bag_size: 286
batch 39, loss: 0.0025, instance_loss: 0.1008, weighted_loss: 0.0320, label: 1, bag_size: 504
batch 59, loss: 0.0516, instance_loss: 0.2503, weighted_loss: 0.1112, label: 0, bag_size: 375
batch 79, loss: 0.0041, instance_loss: 0.3223, weighted_loss: 0.0995, label: 0, bag_size: 128
batch 99, loss: 0.0002, instance_loss: 0.0273, weighted_loss: 0.0084, label: 3, bag_size: 97
batch 119, loss: 0.2153, instance_loss: 0.3465, weighted_loss: 0.2546, label: 1, bag_size: 1646
batch 139, loss: 0.2506, instance_loss: 0.3904, weighted_loss: 0.2926, label: 2, bag_size: 356
batch 159, loss: 0.0001, instance_loss: 0.0168, weighted_loss: 0.0051, label: 0, bag_size: 521
batch 179, loss: 0.0006, instance_loss: 0.0501, weighted_loss: 0.0155, label: 4, bag_size: 79
batch 199, loss: 0.0813, instance_loss: 0.3323, weighted_loss: 0.1566, label: 3, bag_size: 841
batch 219, loss: 0.0001, instance_loss: 0.0337, weighted_loss: 0.0102, label: 4, bag_size: 160
batch 239, loss: 0.0000, instance_loss: 0.0894, weighted_loss: 0.0268, label: 3, bag_size: 18
batch 259, loss: 0.0147, instance_loss: 0.1292, weighted_loss: 0.0491, label: 0, bag_size: 478
batch 279, loss: 0.0289, instance_loss: 0.2265, weighted_loss: 0.0882, label: 0, bag_size: 736
batch 299, loss: 0.3047, instance_loss: 0.4590, weighted_loss: 0.3510, label: 1, bag_size: 377
batch 319, loss: 0.0982, instance_loss: 0.5218, weighted_loss: 0.2253, label: 2, bag_size: 878
batch 339, loss: 0.0105, instance_loss: 0.2017, weighted_loss: 0.0679, label: 2, bag_size: 292
batch 359, loss: 0.0066, instance_loss: 0.1005, weighted_loss: 0.0348, label: 4, bag_size: 28
batch 379, loss: 0.1020, instance_loss: 0.5799, weighted_loss: 0.2454, label: 2, bag_size: 1069
batch 399, loss: 0.0002, instance_loss: 0.0701, weighted_loss: 0.0211, label: 4, bag_size: 91
batch 419, loss: 0.2028, instance_loss: 0.3208, weighted_loss: 0.2382, label: 0, bag_size: 570
batch 439, loss: 0.0924, instance_loss: 0.1878, weighted_loss: 0.1210, label: 2, bag_size: 567
batch 459, loss: 0.0374, instance_loss: 0.1789, weighted_loss: 0.0798, label: 1, bag_size: 838
batch 479, loss: 0.0015, instance_loss: 0.1879, weighted_loss: 0.0575, label: 0, bag_size: 114
batch 499, loss: 0.0157, instance_loss: 0.0817, weighted_loss: 0.0355, label: 4, bag_size: 1176
batch 519, loss: 0.0029, instance_loss: 0.0586, weighted_loss: 0.0196, label: 1, bag_size: 690
batch 539, loss: 0.0773, instance_loss: 0.1699, weighted_loss: 0.1051, label: 0, bag_size: 570


class 0 clustering acc 0.986697247706422: correct 21510/21800
class 1 clustering acc 0.6206422018348624: correct 2706/4360
Epoch: 50, train_loss: 0.1359, train_clustering_loss:  0.2244, train_error: 0.0404
class 0: acc 0.9739130434782609, correct 112/115
class 1: acc 0.9298245614035088, correct 106/114
class 2: acc 0.9304347826086956, correct 107/115
class 3: acc 0.9907407407407407, correct 107/108
class 4: acc 0.978494623655914, correct 91/93

Val Set, val_loss: 1.1987, val_error: 0.3000, auc: 0.9225
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.485: correct 194/400
class 0: acc 0.7, correct 7/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5833333333333334, correct 7/12
EarlyStopping counter: 25 out of 20


batch 19, loss: 1.0780, instance_loss: 0.5608, weighted_loss: 0.9228, label: 0, bag_size: 423
batch 39, loss: 0.0002, instance_loss: 0.1064, weighted_loss: 0.0320, label: 3, bag_size: 20
batch 59, loss: 0.1859, instance_loss: 0.2400, weighted_loss: 0.2021, label: 3, bag_size: 1019
batch 79, loss: 0.0000, instance_loss: 0.0197, weighted_loss: 0.0059, label: 4, bag_size: 162
batch 99, loss: 0.0098, instance_loss: 0.1556, weighted_loss: 0.0535, label: 0, bag_size: 759
batch 119, loss: 0.0001, instance_loss: 0.5129, weighted_loss: 0.1539, label: 4, bag_size: 388
batch 139, loss: 0.0167, instance_loss: 0.3208, weighted_loss: 0.1079, label: 4, bag_size: 297
batch 159, loss: 0.0006, instance_loss: 0.1754, weighted_loss: 0.0530, label: 3, bag_size: 16
batch 179, loss: 0.0143, instance_loss: 0.1707, weighted_loss: 0.0612, label: 0, bag_size: 800
batch 199, loss: 0.0130, instance_loss: 0.1510, weighted_loss: 0.0544, label: 1, bag_size: 1651
batch 219, loss: 0.0294, instance_loss: 0.3639, weighted_loss: 0.1297, label: 0, bag_size: 245
batch 239, loss: 1.8166, instance_loss: 0.6894, weighted_loss: 1.4784, label: 1, bag_size: 936
batch 259, loss: 0.1425, instance_loss: 0.3844, weighted_loss: 0.2151, label: 1, bag_size: 139
batch 279, loss: 0.0780, instance_loss: 0.4141, weighted_loss: 0.1788, label: 2, bag_size: 1400
batch 299, loss: 0.0702, instance_loss: 0.2929, weighted_loss: 0.1370, label: 1, bag_size: 405
batch 319, loss: 0.0144, instance_loss: 0.0327, weighted_loss: 0.0199, label: 3, bag_size: 556
batch 339, loss: 0.7571, instance_loss: 0.4330, weighted_loss: 0.6598, label: 4, bag_size: 947
batch 359, loss: 0.1308, instance_loss: 0.7296, weighted_loss: 0.3104, label: 1, bag_size: 917
batch 379, loss: 0.0040, instance_loss: 0.0295, weighted_loss: 0.0117, label: 0, bag_size: 760
batch 399, loss: 0.1755, instance_loss: 0.2591, weighted_loss: 0.2006, label: 2, bag_size: 758
batch 419, loss: 0.1363, instance_loss: 0.2761, weighted_loss: 0.1783, label: 2, bag_size: 839
batch 439, loss: 0.0222, instance_loss: 0.1156, weighted_loss: 0.0502, label: 2, bag_size: 748
batch 459, loss: 1.2913, instance_loss: 0.7306, weighted_loss: 1.1231, label: 1, bag_size: 936
batch 479, loss: 0.0001, instance_loss: 0.0642, weighted_loss: 0.0193, label: 3, bag_size: 27
batch 499, loss: 0.0006, instance_loss: 0.0757, weighted_loss: 0.0231, label: 3, bag_size: 16
batch 519, loss: 0.0022, instance_loss: 0.3316, weighted_loss: 0.1010, label: 3, bag_size: 24
batch 539, loss: 0.5543, instance_loss: 0.2755, weighted_loss: 0.4707, label: 2, bag_size: 861


class 0 clustering acc 0.986651376146789: correct 21509/21800
class 1 clustering acc 0.5910550458715597: correct 2577/4360
Epoch: 51, train_loss: 0.1374, train_clustering_loss:  0.2393, train_error: 0.0422
class 0: acc 0.9848484848484849, correct 130/132
class 1: acc 0.9166666666666666, correct 88/96
class 2: acc 0.9074074074074074, correct 98/108
class 3: acc 0.9905660377358491, correct 105/106
class 4: acc 0.9805825242718447, correct 101/103

Val Set, val_loss: 1.3703, val_error: 0.3000, auc: 0.9035
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.465: correct 186/400
class 0: acc 0.9, correct 9/10
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 4/5
class 4: acc 0.5, correct 6/12
EarlyStopping counter: 26 out of 20
Early stopping
Val error: 0.2800, ROC AUC: 0.9406
Test error: 0.4000, ROC AUC: 0.8281
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.55, correct 11/20
class 3: acc 0.75, correct 3/4
class 4: acc 0.0, correct 0/3

Training Fold 9!

Init train/val/test splits... 
Done!
Training on 545 samples
Validating on 50 samples
Testing on 50 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=5, bias=True)
  (instance_classifiers): ModuleList(
    (0-4): 5 x Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 795408
Total number of trainable parameters: 795408

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6308, instance_loss: 1.2218, weighted_loss: 1.5081, label: 0, bag_size: 239
batch 39, loss: 1.5610, instance_loss: 1.0666, weighted_loss: 1.4127, label: 0, bag_size: 143
batch 59, loss: 1.7710, instance_loss: 0.9106, weighted_loss: 1.5129, label: 3, bag_size: 48
batch 79, loss: 1.7214, instance_loss: 0.6902, weighted_loss: 1.4120, label: 1, bag_size: 847
batch 99, loss: 1.8303, instance_loss: 0.5734, weighted_loss: 1.4532, label: 1, bag_size: 868
batch 119, loss: 1.5983, instance_loss: 0.5547, weighted_loss: 1.2852, label: 0, bag_size: 143
batch 139, loss: 1.7555, instance_loss: 0.5439, weighted_loss: 1.3921, label: 4, bag_size: 754
batch 159, loss: 1.4233, instance_loss: 0.5012, weighted_loss: 1.1467, label: 3, bag_size: 46
batch 179, loss: 1.5140, instance_loss: 0.5096, weighted_loss: 1.2127, label: 3, bag_size: 26
batch 199, loss: 1.4862, instance_loss: 0.5368, weighted_loss: 1.2014, label: 2, bag_size: 1164
batch 219, loss: 1.7096, instance_loss: 0.5456, weighted_loss: 1.3604, label: 0, bag_size: 446
batch 239, loss: 1.4120, instance_loss: 0.5245, weighted_loss: 1.1457, label: 0, bag_size: 760
batch 259, loss: 1.3949, instance_loss: 0.4989, weighted_loss: 1.1261, label: 1, bag_size: 377
batch 279, loss: 1.4550, instance_loss: 0.4955, weighted_loss: 1.1671, label: 0, bag_size: 148
batch 299, loss: 2.0027, instance_loss: 0.5346, weighted_loss: 1.5623, label: 4, bag_size: 366
batch 319, loss: 1.4374, instance_loss: 0.4978, weighted_loss: 1.1555, label: 1, bag_size: 847
batch 339, loss: 1.3091, instance_loss: 0.4899, weighted_loss: 1.0633, label: 1, bag_size: 965
batch 359, loss: 1.4876, instance_loss: 0.5159, weighted_loss: 1.1961, label: 1, bag_size: 898
batch 379, loss: 1.4693, instance_loss: 0.5163, weighted_loss: 1.1834, label: 2, bag_size: 419
batch 399, loss: 2.3085, instance_loss: 0.5564, weighted_loss: 1.7828, label: 4, bag_size: 511
batch 419, loss: 1.4760, instance_loss: 0.5024, weighted_loss: 1.1839, label: 2, bag_size: 934
batch 439, loss: 1.6042, instance_loss: 0.5035, weighted_loss: 1.2740, label: 2, bag_size: 194
batch 459, loss: 1.3597, instance_loss: 0.5190, weighted_loss: 1.1075, label: 2, bag_size: 471
batch 479, loss: 0.4261, instance_loss: 0.4034, weighted_loss: 0.4193, label: 4, bag_size: 20
batch 499, loss: 1.3042, instance_loss: 0.4993, weighted_loss: 1.0627, label: 1, bag_size: 847
batch 519, loss: 0.5001, instance_loss: 0.4001, weighted_loss: 0.4701, label: 4, bag_size: 23
batch 539, loss: 1.4820, instance_loss: 0.5146, weighted_loss: 1.1918, label: 2, bag_size: 636


class 0 clustering acc 0.9957339449541285: correct 21707/21800
class 1 clustering acc 0.0027522935779816515: correct 12/4360
Epoch: 0, train_loss: 1.4703, train_clustering_loss:  0.5941, train_error: 0.6440
class 0: acc 0.1743119266055046, correct 19/109
class 1: acc 0.3018867924528302, correct 32/106
class 2: acc 0.2912621359223301, correct 30/103
class 3: acc 0.3728813559322034, correct 44/118
class 4: acc 0.6330275229357798, correct 69/109

Val Set, val_loss: 1.4716, val_error: 0.6400, auc: 0.7960
class 0 clustering acc 1.0: correct 2000/2000
class 1 clustering acc 0.0: correct 0/400
class 0: acc 0.0, correct 0/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.45454545454545453, correct 10/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.25, correct 2/8
Validation loss decreased (inf --> 1.471569).  Saving model ...


batch 19, loss: 1.6815, instance_loss: 0.4323, weighted_loss: 1.3067, label: 4, bag_size: 1357
batch 39, loss: 1.4780, instance_loss: 0.5282, weighted_loss: 1.1931, label: 0, bag_size: 630
batch 59, loss: 1.6608, instance_loss: 0.5462, weighted_loss: 1.3264, label: 0, bag_size: 1061
batch 79, loss: 0.9155, instance_loss: 0.4678, weighted_loss: 0.7812, label: 3, bag_size: 18
batch 99, loss: 1.2235, instance_loss: 0.4691, weighted_loss: 0.9972, label: 1, bag_size: 700
batch 119, loss: 1.5963, instance_loss: 0.5417, weighted_loss: 1.2799, label: 0, bag_size: 756
batch 139, loss: 1.4896, instance_loss: 0.5363, weighted_loss: 1.2036, label: 0, bag_size: 1466
batch 159, loss: 1.1572, instance_loss: 0.4665, weighted_loss: 0.9500, label: 2, bag_size: 408
batch 179, loss: 1.0329, instance_loss: 0.5089, weighted_loss: 0.8757, label: 3, bag_size: 53
batch 199, loss: 0.7569, instance_loss: 0.4535, weighted_loss: 0.6659, label: 3, bag_size: 20
batch 219, loss: 1.3467, instance_loss: 0.4834, weighted_loss: 1.0877, label: 0, bag_size: 338
batch 239, loss: 0.7256, instance_loss: 0.4441, weighted_loss: 0.6412, label: 3, bag_size: 18
batch 259, loss: 1.1903, instance_loss: 0.3936, weighted_loss: 0.9513, label: 3, bag_size: 936
batch 279, loss: 1.0810, instance_loss: 0.4622, weighted_loss: 0.8954, label: 2, bag_size: 1259
batch 299, loss: 0.9999, instance_loss: 0.4693, weighted_loss: 0.8408, label: 1, bag_size: 346
batch 319, loss: 0.9528, instance_loss: 0.4604, weighted_loss: 0.8051, label: 1, bag_size: 318
batch 339, loss: 0.9256, instance_loss: 0.4612, weighted_loss: 0.7863, label: 1, bag_size: 690
batch 359, loss: 1.6268, instance_loss: 0.4953, weighted_loss: 1.2873, label: 3, bag_size: 556
batch 379, loss: 1.7628, instance_loss: 0.6287, weighted_loss: 1.4226, label: 0, bag_size: 116
batch 399, loss: 1.3398, instance_loss: 0.5200, weighted_loss: 1.0939, label: 1, bag_size: 696
batch 419, loss: 0.6481, instance_loss: 0.4079, weighted_loss: 0.5760, label: 3, bag_size: 50
batch 439, loss: 1.6991, instance_loss: 0.4582, weighted_loss: 1.3268, label: 3, bag_size: 316
batch 459, loss: 0.9811, instance_loss: 0.4461, weighted_loss: 0.8206, label: 1, bag_size: 938
batch 479, loss: 1.0779, instance_loss: 0.4247, weighted_loss: 0.8819, label: 1, bag_size: 1651
batch 499, loss: 1.3960, instance_loss: 0.5041, weighted_loss: 1.1284, label: 0, bag_size: 1174
batch 519, loss: 0.9767, instance_loss: 0.4409, weighted_loss: 0.8159, label: 0, bag_size: 382
batch 539, loss: 0.8518, instance_loss: 0.4231, weighted_loss: 0.7232, label: 0, bag_size: 446


class 0 clustering acc 0.9993577981651376: correct 21786/21800
class 1 clustering acc 0.020642201834862386: correct 90/4360
Epoch: 1, train_loss: 1.2066, train_clustering_loss:  0.4600, train_error: 0.5028
class 0: acc 0.2727272727272727, correct 30/110
class 1: acc 0.4368932038834951, correct 45/103
class 2: acc 0.37254901960784315, correct 38/102
class 3: acc 0.6910569105691057, correct 85/123
class 4: acc 0.6822429906542056, correct 73/107

Val Set, val_loss: 1.3418, val_error: 0.6000, auc: 0.8628
class 0 clustering acc 0.997: correct 1994/2000
class 1 clustering acc 0.0275: correct 11/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 1.0, correct 7/7
class 2: acc 0.0, correct 0/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.25, correct 2/8
Validation loss decreased (1.471569 --> 1.341828).  Saving model ...


batch 19, loss: 0.8354, instance_loss: 0.4394, weighted_loss: 0.7166, label: 0, bag_size: 1872
batch 39, loss: 0.7291, instance_loss: 0.3708, weighted_loss: 0.6217, label: 1, bag_size: 944
batch 59, loss: 0.8521, instance_loss: 0.4224, weighted_loss: 0.7232, label: 0, bag_size: 446
batch 79, loss: 0.1972, instance_loss: 0.3435, weighted_loss: 0.2411, label: 3, bag_size: 21
batch 99, loss: 1.2464, instance_loss: 0.5082, weighted_loss: 1.0250, label: 0, bag_size: 423
batch 119, loss: 1.6737, instance_loss: 0.5598, weighted_loss: 1.3395, label: 2, bag_size: 1416
batch 139, loss: 1.3836, instance_loss: 0.5297, weighted_loss: 1.1274, label: 1, bag_size: 442
batch 159, loss: 0.9655, instance_loss: 0.3918, weighted_loss: 0.7934, label: 0, bag_size: 432
batch 179, loss: 0.9198, instance_loss: 0.4406, weighted_loss: 0.7761, label: 2, bag_size: 910
batch 199, loss: 0.9755, instance_loss: 0.4218, weighted_loss: 0.8094, label: 1, bag_size: 530
batch 219, loss: 1.9257, instance_loss: 0.7416, weighted_loss: 1.5705, label: 0, bag_size: 109
batch 239, loss: 1.1311, instance_loss: 0.4193, weighted_loss: 0.9176, label: 4, bag_size: 23
batch 259, loss: 1.2785, instance_loss: 0.4890, weighted_loss: 1.0416, label: 2, bag_size: 222
batch 279, loss: 0.7233, instance_loss: 0.3727, weighted_loss: 0.6181, label: 1, bag_size: 754
batch 299, loss: 1.3900, instance_loss: 0.4663, weighted_loss: 1.1129, label: 2, bag_size: 1167
batch 319, loss: 0.3309, instance_loss: 0.3031, weighted_loss: 0.3225, label: 3, bag_size: 1069
batch 339, loss: 0.2415, instance_loss: 0.2647, weighted_loss: 0.2485, label: 1, bag_size: 356
batch 359, loss: 2.6547, instance_loss: 0.7011, weighted_loss: 2.0686, label: 4, bag_size: 590
batch 379, loss: 0.5298, instance_loss: 0.4133, weighted_loss: 0.4949, label: 0, bag_size: 1235
batch 399, loss: 2.4920, instance_loss: 0.6641, weighted_loss: 1.9436, label: 3, bag_size: 1167
batch 419, loss: 0.2772, instance_loss: 0.2177, weighted_loss: 0.2594, label: 4, bag_size: 114
batch 439, loss: 3.2278, instance_loss: 0.5398, weighted_loss: 2.4214, label: 3, bag_size: 952
batch 459, loss: 2.3107, instance_loss: 0.5509, weighted_loss: 1.7828, label: 1, bag_size: 660
batch 479, loss: 0.1391, instance_loss: 0.1295, weighted_loss: 0.1362, label: 3, bag_size: 1069
batch 499, loss: 0.8674, instance_loss: 0.5317, weighted_loss: 0.7667, label: 0, bag_size: 128
batch 519, loss: 1.1114, instance_loss: 0.4725, weighted_loss: 0.9197, label: 0, bag_size: 653
batch 539, loss: 0.5574, instance_loss: 0.4119, weighted_loss: 0.5137, label: 0, bag_size: 760


class 0 clustering acc 0.9962844036697248: correct 21719/21800
class 1 clustering acc 0.09610091743119266: correct 419/4360
Epoch: 2, train_loss: 1.0283, train_clustering_loss:  0.4203, train_error: 0.3890
class 0: acc 0.5826771653543307, correct 74/127
class 1: acc 0.6869565217391305, correct 79/115
class 2: acc 0.3177570093457944, correct 34/107
class 3: acc 0.7777777777777778, correct 84/108
class 4: acc 0.7045454545454546, correct 62/88

Val Set, val_loss: 1.2553, val_error: 0.6200, auc: 0.8839
class 0 clustering acc 0.999: correct 1998/2000
class 1 clustering acc 0.02: correct 8/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 1.0, correct 7/7
class 2: acc 0.0, correct 0/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.25, correct 2/8
Validation loss decreased (1.341828 --> 1.255322).  Saving model ...


batch 19, loss: 0.5466, instance_loss: 0.3820, weighted_loss: 0.4972, label: 0, bag_size: 1517
batch 39, loss: 1.2665, instance_loss: 0.5240, weighted_loss: 1.0438, label: 0, bag_size: 801
batch 59, loss: 1.3460, instance_loss: 0.5101, weighted_loss: 1.0952, label: 2, bag_size: 292
batch 79, loss: 2.4421, instance_loss: 0.6645, weighted_loss: 1.9089, label: 4, bag_size: 663
batch 99, loss: 0.5214, instance_loss: 0.3465, weighted_loss: 0.4689, label: 0, bag_size: 402
batch 119, loss: 1.3240, instance_loss: 0.5220, weighted_loss: 1.0834, label: 2, bag_size: 935
batch 139, loss: 0.6141, instance_loss: 0.3043, weighted_loss: 0.5212, label: 1, bag_size: 530
batch 159, loss: 1.0912, instance_loss: 0.4708, weighted_loss: 0.9051, label: 2, bag_size: 1128
batch 179, loss: 0.9675, instance_loss: 0.3492, weighted_loss: 0.7820, label: 1, bag_size: 959
batch 199, loss: 0.2760, instance_loss: 0.2570, weighted_loss: 0.2703, label: 3, bag_size: 28
batch 219, loss: 0.4171, instance_loss: 0.2703, weighted_loss: 0.3731, label: 1, bag_size: 944
batch 239, loss: 0.3391, instance_loss: 0.2403, weighted_loss: 0.3095, label: 1, bag_size: 944
batch 259, loss: 2.2103, instance_loss: 0.6270, weighted_loss: 1.7353, label: 4, bag_size: 1278
batch 279, loss: 2.4346, instance_loss: 0.6477, weighted_loss: 1.8985, label: 4, bag_size: 511
batch 299, loss: 0.9742, instance_loss: 0.4593, weighted_loss: 0.8198, label: 2, bag_size: 848
batch 319, loss: 0.7869, instance_loss: 0.2867, weighted_loss: 0.6369, label: 3, bag_size: 556
batch 339, loss: 0.7628, instance_loss: 0.4257, weighted_loss: 0.6617, label: 2, bag_size: 1133
batch 359, loss: 0.1318, instance_loss: 0.1707, weighted_loss: 0.1435, label: 3, bag_size: 19
batch 379, loss: 0.5436, instance_loss: 0.4111, weighted_loss: 0.5039, label: 0, bag_size: 1061
batch 399, loss: 0.4384, instance_loss: 0.3871, weighted_loss: 0.4230, label: 0, bag_size: 807
batch 419, loss: 1.8810, instance_loss: 0.5098, weighted_loss: 1.4696, label: 1, bag_size: 868
batch 439, loss: 1.9093, instance_loss: 0.4975, weighted_loss: 1.4857, label: 3, bag_size: 697
batch 459, loss: 1.2501, instance_loss: 0.5002, weighted_loss: 1.0252, label: 2, bag_size: 766
batch 479, loss: 1.1567, instance_loss: 0.3602, weighted_loss: 0.9178, label: 1, bag_size: 1273
batch 499, loss: 0.0626, instance_loss: 0.1116, weighted_loss: 0.0773, label: 4, bag_size: 160
batch 519, loss: 1.1100, instance_loss: 0.5035, weighted_loss: 0.9281, label: 2, bag_size: 868
batch 539, loss: 0.9041, instance_loss: 0.4584, weighted_loss: 0.7704, label: 2, bag_size: 270


class 0 clustering acc 0.9944036697247707: correct 21678/21800
class 1 clustering acc 0.15206422018348623: correct 663/4360
Epoch: 3, train_loss: 0.9067, train_clustering_loss:  0.3954, train_error: 0.3560
class 0: acc 0.6953125, correct 89/128
class 1: acc 0.768, correct 96/125
class 2: acc 0.3142857142857143, correct 33/105
class 3: acc 0.75, correct 63/84
class 4: acc 0.6796116504854369, correct 70/103

Val Set, val_loss: 1.0228, val_error: 0.4200, auc: 0.8850
class 0 clustering acc 0.9935: correct 1987/2000
class 1 clustering acc 0.045: correct 18/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.5454545454545454, correct 12/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.25, correct 2/8
Validation loss decreased (1.255322 --> 1.022777).  Saving model ...


batch 19, loss: 0.5919, instance_loss: 0.3865, weighted_loss: 0.5302, label: 0, bag_size: 1034
batch 39, loss: 0.9100, instance_loss: 0.4701, weighted_loss: 0.7781, label: 2, bag_size: 828
batch 59, loss: 0.1194, instance_loss: 0.2411, weighted_loss: 0.1559, label: 3, bag_size: 18
batch 79, loss: 0.1943, instance_loss: 0.1831, weighted_loss: 0.1910, label: 3, bag_size: 305
batch 99, loss: 0.1015, instance_loss: 0.1127, weighted_loss: 0.1049, label: 3, bag_size: 1069
batch 119, loss: 0.5950, instance_loss: 0.3532, weighted_loss: 0.5224, label: 2, bag_size: 400
batch 139, loss: 1.4749, instance_loss: 0.4900, weighted_loss: 1.1794, label: 2, bag_size: 1006
batch 159, loss: 0.4872, instance_loss: 0.3476, weighted_loss: 0.4453, label: 2, bag_size: 400
batch 179, loss: 0.2920, instance_loss: 0.2131, weighted_loss: 0.2684, label: 1, bag_size: 994
batch 199, loss: 0.1360, instance_loss: 0.1453, weighted_loss: 0.1388, label: 3, bag_size: 18
batch 219, loss: 0.2085, instance_loss: 0.1609, weighted_loss: 0.1942, label: 3, bag_size: 16
batch 239, loss: 0.6296, instance_loss: 0.4582, weighted_loss: 0.5781, label: 0, bag_size: 807
batch 259, loss: 0.7024, instance_loss: 0.4242, weighted_loss: 0.6189, label: 0, bag_size: 756
batch 279, loss: 2.7993, instance_loss: 0.6703, weighted_loss: 2.1606, label: 4, bag_size: 663
batch 299, loss: 0.3506, instance_loss: 0.3554, weighted_loss: 0.3520, label: 0, bag_size: 630
batch 319, loss: 0.2764, instance_loss: 0.2954, weighted_loss: 0.2821, label: 3, bag_size: 17
batch 339, loss: 1.2397, instance_loss: 0.3418, weighted_loss: 0.9703, label: 3, bag_size: 1177
batch 359, loss: 0.0964, instance_loss: 0.2723, weighted_loss: 0.1491, label: 4, bag_size: 19
batch 379, loss: 0.6407, instance_loss: 0.3499, weighted_loss: 0.5535, label: 3, bag_size: 697
batch 399, loss: 0.5455, instance_loss: 0.2966, weighted_loss: 0.4708, label: 1, bag_size: 533
batch 419, loss: 1.6831, instance_loss: 0.5563, weighted_loss: 1.3451, label: 1, bag_size: 700
batch 439, loss: 1.1692, instance_loss: 0.4719, weighted_loss: 0.9600, label: 2, bag_size: 537
batch 459, loss: 0.3484, instance_loss: 0.3703, weighted_loss: 0.3550, label: 0, bag_size: 1133
batch 479, loss: 0.6514, instance_loss: 0.3296, weighted_loss: 0.5549, label: 3, bag_size: 316
batch 499, loss: 0.0545, instance_loss: 0.1696, weighted_loss: 0.0890, label: 3, bag_size: 18
batch 519, loss: 0.8267, instance_loss: 0.4293, weighted_loss: 0.7075, label: 2, bag_size: 725
batch 539, loss: 0.1042, instance_loss: 0.0999, weighted_loss: 0.1029, label: 1, bag_size: 1086


class 0 clustering acc 0.9928899082568807: correct 21645/21800
class 1 clustering acc 0.25412844036697246: correct 1108/4360
Epoch: 4, train_loss: 0.7792, train_clustering_loss:  0.3654, train_error: 0.2771
class 0: acc 0.6732673267326733, correct 68/101
class 1: acc 0.6991150442477876, correct 79/113
class 2: acc 0.6271186440677966, correct 74/118
class 3: acc 0.8214285714285714, correct 92/112
class 4: acc 0.801980198019802, correct 81/101

Val Set, val_loss: 1.0814, val_error: 0.4200, auc: 0.8894
class 0 clustering acc 0.984: correct 1968/2000
class 1 clustering acc 0.1275: correct 51/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 1.0, correct 7/7
class 2: acc 0.45454545454545453, correct 10/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.375, correct 3/8
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8085, instance_loss: 0.4309, weighted_loss: 0.6952, label: 0, bag_size: 410
batch 39, loss: 4.6415, instance_loss: 0.7617, weighted_loss: 3.4776, label: 0, bag_size: 818
batch 59, loss: 0.2354, instance_loss: 0.2786, weighted_loss: 0.2484, label: 0, bag_size: 446
batch 79, loss: 0.6262, instance_loss: 0.4166, weighted_loss: 0.5634, label: 2, bag_size: 649
batch 99, loss: 0.6714, instance_loss: 0.4451, weighted_loss: 0.6035, label: 3, bag_size: 936
batch 119, loss: 0.3148, instance_loss: 0.2084, weighted_loss: 0.2829, label: 4, bag_size: 148
batch 139, loss: 1.8109, instance_loss: 0.5349, weighted_loss: 1.4281, label: 2, bag_size: 194
batch 159, loss: 0.5200, instance_loss: 0.3957, weighted_loss: 0.4827, label: 0, bag_size: 367
batch 179, loss: 0.6549, instance_loss: 0.4222, weighted_loss: 0.5851, label: 2, bag_size: 626
batch 199, loss: 0.4136, instance_loss: 0.4050, weighted_loss: 0.4110, label: 0, bag_size: 367
batch 219, loss: 0.0978, instance_loss: 0.1899, weighted_loss: 0.1255, label: 3, bag_size: 31
batch 239, loss: 1.3041, instance_loss: 0.7664, weighted_loss: 1.1428, label: 0, bag_size: 114
batch 259, loss: 1.3035, instance_loss: 0.4281, weighted_loss: 1.0409, label: 2, bag_size: 324
batch 279, loss: 0.7462, instance_loss: 0.4526, weighted_loss: 0.6581, label: 0, bag_size: 432
batch 299, loss: 0.0545, instance_loss: 0.2052, weighted_loss: 0.0997, label: 4, bag_size: 20
batch 319, loss: 0.5615, instance_loss: 0.4441, weighted_loss: 0.5263, label: 0, bag_size: 933
batch 339, loss: 0.5524, instance_loss: 0.3582, weighted_loss: 0.4942, label: 4, bag_size: 773
batch 359, loss: 1.0122, instance_loss: 0.4788, weighted_loss: 0.8522, label: 2, bag_size: 1069
batch 379, loss: 0.9834, instance_loss: 0.6958, weighted_loss: 0.8971, label: 0, bag_size: 116
batch 399, loss: 0.6195, instance_loss: 0.4234, weighted_loss: 0.5607, label: 0, bag_size: 424
batch 419, loss: 2.6980, instance_loss: 0.7483, weighted_loss: 2.1131, label: 4, bag_size: 625
batch 439, loss: 0.2359, instance_loss: 0.2777, weighted_loss: 0.2484, label: 0, bag_size: 446
batch 459, loss: 0.1578, instance_loss: 0.1811, weighted_loss: 0.1648, label: 1, bag_size: 858
batch 479, loss: 0.2777, instance_loss: 0.1418, weighted_loss: 0.2369, label: 1, bag_size: 504
batch 499, loss: 0.4010, instance_loss: 0.4287, weighted_loss: 0.4093, label: 4, bag_size: 542
batch 519, loss: 0.1601, instance_loss: 0.1927, weighted_loss: 0.1699, label: 4, bag_size: 178
batch 539, loss: 0.2882, instance_loss: 0.1556, weighted_loss: 0.2484, label: 1, bag_size: 346


class 0 clustering acc 0.9919266055045871: correct 21624/21800
class 1 clustering acc 0.2798165137614679: correct 1220/4360
Epoch: 5, train_loss: 0.7298, train_clustering_loss:  0.3601, train_error: 0.2789
class 0: acc 0.7589285714285714, correct 85/112
class 1: acc 0.7413793103448276, correct 86/116
class 2: acc 0.5686274509803921, correct 58/102
class 3: acc 0.7787610619469026, correct 88/113
class 4: acc 0.7450980392156863, correct 76/102

Val Set, val_loss: 0.9525, val_error: 0.3800, auc: 0.8984
class 0 clustering acc 0.989: correct 1978/2000
class 1 clustering acc 0.0875: correct 35/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.5454545454545454, correct 12/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
Validation loss decreased (1.022777 --> 0.952510).  Saving model ...


batch 19, loss: 1.0431, instance_loss: 0.3682, weighted_loss: 0.8406, label: 1, bag_size: 470
batch 39, loss: 1.9239, instance_loss: 0.6388, weighted_loss: 1.5384, label: 3, bag_size: 211
batch 59, loss: 0.0194, instance_loss: 0.1291, weighted_loss: 0.0523, label: 3, bag_size: 20
batch 79, loss: 2.0159, instance_loss: 0.6355, weighted_loss: 1.6018, label: 4, bag_size: 366
batch 99, loss: 1.1700, instance_loss: 0.5028, weighted_loss: 0.9698, label: 2, bag_size: 571
batch 119, loss: 0.2232, instance_loss: 0.2895, weighted_loss: 0.2431, label: 3, bag_size: 28
batch 139, loss: 0.4206, instance_loss: 0.3782, weighted_loss: 0.4079, label: 2, bag_size: 286
batch 159, loss: 0.5676, instance_loss: 0.3289, weighted_loss: 0.4960, label: 4, bag_size: 711
batch 179, loss: 1.8602, instance_loss: 0.6024, weighted_loss: 1.4829, label: 2, bag_size: 474
batch 199, loss: 0.8684, instance_loss: 0.4492, weighted_loss: 0.7426, label: 1, bag_size: 898
batch 219, loss: 1.2957, instance_loss: 0.5685, weighted_loss: 1.0776, label: 1, bag_size: 936
batch 239, loss: 0.9440, instance_loss: 0.4675, weighted_loss: 0.8010, label: 2, bag_size: 571
batch 259, loss: 1.2664, instance_loss: 0.6029, weighted_loss: 1.0673, label: 3, bag_size: 230
batch 279, loss: 1.1606, instance_loss: 0.6235, weighted_loss: 0.9995, label: 2, bag_size: 1348
batch 299, loss: 0.7035, instance_loss: 0.4770, weighted_loss: 0.6355, label: 1, bag_size: 860
batch 319, loss: 0.3160, instance_loss: 0.3188, weighted_loss: 0.3169, label: 0, bag_size: 1174
batch 339, loss: 0.0838, instance_loss: 0.2345, weighted_loss: 0.1290, label: 3, bag_size: 50
batch 359, loss: 0.0823, instance_loss: 0.1552, weighted_loss: 0.1041, label: 3, bag_size: 18
batch 379, loss: 2.1627, instance_loss: 0.5074, weighted_loss: 1.6661, label: 1, bag_size: 657
batch 399, loss: 0.1617, instance_loss: 0.2359, weighted_loss: 0.1840, label: 4, bag_size: 150
batch 419, loss: 0.6815, instance_loss: 0.3917, weighted_loss: 0.5946, label: 1, bag_size: 648
batch 439, loss: 1.2295, instance_loss: 0.4147, weighted_loss: 0.9851, label: 2, bag_size: 1218
batch 459, loss: 3.3654, instance_loss: 0.7519, weighted_loss: 2.5813, label: 1, bag_size: 1799
batch 479, loss: 0.7562, instance_loss: 0.4323, weighted_loss: 0.6590, label: 2, bag_size: 1180
batch 499, loss: 0.5527, instance_loss: 0.2513, weighted_loss: 0.4622, label: 1, bag_size: 405
batch 519, loss: 0.5887, instance_loss: 0.3204, weighted_loss: 0.5082, label: 3, bag_size: 697
batch 539, loss: 1.2415, instance_loss: 0.5124, weighted_loss: 1.0228, label: 0, bag_size: 1289


class 0 clustering acc 0.9924311926605505: correct 21635/21800
class 1 clustering acc 0.2834862385321101: correct 1236/4360
Epoch: 6, train_loss: 0.7239, train_clustering_loss:  0.3554, train_error: 0.2826
class 0: acc 0.6981132075471698, correct 74/106
class 1: acc 0.6782608695652174, correct 78/115
class 2: acc 0.6, correct 60/100
class 3: acc 0.7844827586206896, correct 91/116
class 4: acc 0.8148148148148148, correct 88/108

Val Set, val_loss: 1.0879, val_error: 0.4000, auc: 0.8871
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.0775: correct 31/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.36363636363636365, correct 8/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4904, instance_loss: 0.5192, weighted_loss: 0.4991, label: 2, bag_size: 373
batch 39, loss: 0.0967, instance_loss: 0.3336, weighted_loss: 0.1678, label: 3, bag_size: 16
batch 59, loss: 0.5976, instance_loss: 0.3737, weighted_loss: 0.5304, label: 2, bag_size: 471
batch 79, loss: 0.4104, instance_loss: 0.3739, weighted_loss: 0.3995, label: 0, bag_size: 1018
batch 99, loss: 0.1751, instance_loss: 0.3231, weighted_loss: 0.2195, label: 4, bag_size: 1121
batch 119, loss: 0.0734, instance_loss: 0.1506, weighted_loss: 0.0966, label: 3, bag_size: 18
batch 139, loss: 0.7105, instance_loss: 0.3713, weighted_loss: 0.6087, label: 2, bag_size: 358
batch 159, loss: 0.7808, instance_loss: 0.4254, weighted_loss: 0.6742, label: 4, bag_size: 1357
batch 179, loss: 0.5145, instance_loss: 0.4022, weighted_loss: 0.4808, label: 2, bag_size: 679
batch 199, loss: 0.1720, instance_loss: 0.1973, weighted_loss: 0.1796, label: 1, bag_size: 1402
batch 219, loss: 2.5014, instance_loss: 0.7394, weighted_loss: 1.9728, label: 3, bag_size: 317
batch 239, loss: 0.5825, instance_loss: 0.1994, weighted_loss: 0.4676, label: 1, bag_size: 356
batch 259, loss: 0.2295, instance_loss: 0.1792, weighted_loss: 0.2144, label: 1, bag_size: 696
batch 279, loss: 0.3149, instance_loss: 0.2364, weighted_loss: 0.2913, label: 1, bag_size: 1191
batch 299, loss: 1.0305, instance_loss: 0.4004, weighted_loss: 0.8415, label: 1, bag_size: 1080
batch 319, loss: 0.6890, instance_loss: 0.3799, weighted_loss: 0.5963, label: 2, bag_size: 480
batch 339, loss: 0.4171, instance_loss: 0.2269, weighted_loss: 0.3600, label: 1, bag_size: 320
batch 359, loss: 0.5910, instance_loss: 0.5725, weighted_loss: 0.5854, label: 0, bag_size: 118
batch 379, loss: 0.0333, instance_loss: 0.1820, weighted_loss: 0.0779, label: 3, bag_size: 26
batch 399, loss: 1.8905, instance_loss: 0.6011, weighted_loss: 1.5037, label: 4, bag_size: 297
batch 419, loss: 0.5619, instance_loss: 0.3620, weighted_loss: 0.5019, label: 2, bag_size: 1123
batch 439, loss: 0.0367, instance_loss: 0.0921, weighted_loss: 0.0533, label: 3, bag_size: 35
batch 459, loss: 0.0233, instance_loss: 0.0520, weighted_loss: 0.0319, label: 3, bag_size: 1069
batch 479, loss: 2.1904, instance_loss: 0.7111, weighted_loss: 1.7466, label: 2, bag_size: 373
batch 499, loss: 0.0729, instance_loss: 0.1062, weighted_loss: 0.0829, label: 3, bag_size: 451
batch 519, loss: 1.9122, instance_loss: 0.4943, weighted_loss: 1.4868, label: 3, bag_size: 1380
batch 539, loss: 0.0236, instance_loss: 0.0508, weighted_loss: 0.0317, label: 3, bag_size: 66


class 0 clustering acc 0.9912844036697248: correct 21610/21800
class 1 clustering acc 0.28761467889908254: correct 1254/4360
Epoch: 7, train_loss: 0.6868, train_clustering_loss:  0.3519, train_error: 0.2514
class 0: acc 0.77, correct 77/100
class 1: acc 0.6902654867256637, correct 78/113
class 2: acc 0.6875, correct 77/112
class 3: acc 0.8305084745762712, correct 98/118
class 4: acc 0.7647058823529411, correct 78/102

Val Set, val_loss: 1.0270, val_error: 0.4000, auc: 0.8853
class 0 clustering acc 0.9895: correct 1979/2000
class 1 clustering acc 0.0925: correct 37/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.45454545454545453, correct 10/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0881, instance_loss: 0.4020, weighted_loss: 0.8823, label: 3, bag_size: 1250
batch 39, loss: 0.4689, instance_loss: 0.3370, weighted_loss: 0.4294, label: 4, bag_size: 1002
batch 59, loss: 1.1551, instance_loss: 0.5010, weighted_loss: 0.9589, label: 1, bag_size: 747
batch 79, loss: 0.0630, instance_loss: 0.0878, weighted_loss: 0.0704, label: 3, bag_size: 23
batch 99, loss: 0.3728, instance_loss: 0.2341, weighted_loss: 0.3312, label: 1, bag_size: 944
batch 119, loss: 2.2319, instance_loss: 0.6344, weighted_loss: 1.7526, label: 3, bag_size: 283
batch 139, loss: 1.9071, instance_loss: 0.5847, weighted_loss: 1.5104, label: 2, bag_size: 248
batch 159, loss: 0.2840, instance_loss: 0.2385, weighted_loss: 0.2704, label: 1, bag_size: 318
batch 179, loss: 0.6958, instance_loss: 0.3314, weighted_loss: 0.5864, label: 2, bag_size: 738
batch 199, loss: 0.6099, instance_loss: 0.3921, weighted_loss: 0.5445, label: 4, bag_size: 646
batch 219, loss: 0.6325, instance_loss: 0.6147, weighted_loss: 0.6272, label: 0, bag_size: 116
batch 239, loss: 1.0716, instance_loss: 0.6854, weighted_loss: 0.9557, label: 4, bag_size: 366
batch 259, loss: 0.0252, instance_loss: 0.0611, weighted_loss: 0.0360, label: 4, bag_size: 96
batch 279, loss: 1.5056, instance_loss: 0.4890, weighted_loss: 1.2006, label: 0, bag_size: 1257
batch 299, loss: 1.6248, instance_loss: 0.4570, weighted_loss: 1.2744, label: 1, bag_size: 504
batch 319, loss: 0.0442, instance_loss: 0.1768, weighted_loss: 0.0839, label: 0, bag_size: 933
batch 339, loss: 0.0160, instance_loss: 0.1117, weighted_loss: 0.0447, label: 3, bag_size: 33
batch 359, loss: 0.1250, instance_loss: 0.2528, weighted_loss: 0.1633, label: 0, bag_size: 524
batch 379, loss: 0.3250, instance_loss: 0.3656, weighted_loss: 0.3372, label: 0, bag_size: 1133
batch 399, loss: 0.0998, instance_loss: 0.1155, weighted_loss: 0.1045, label: 1, bag_size: 1086
batch 419, loss: 0.8144, instance_loss: 0.4072, weighted_loss: 0.6922, label: 2, bag_size: 948
batch 439, loss: 0.7222, instance_loss: 0.3360, weighted_loss: 0.6064, label: 2, bag_size: 1235
batch 459, loss: 0.1048, instance_loss: 0.1542, weighted_loss: 0.1196, label: 4, bag_size: 19
batch 479, loss: 0.0548, instance_loss: 0.1270, weighted_loss: 0.0765, label: 4, bag_size: 168
batch 499, loss: 0.1412, instance_loss: 0.1207, weighted_loss: 0.1351, label: 1, bag_size: 346
batch 519, loss: 0.1205, instance_loss: 0.1396, weighted_loss: 0.1263, label: 3, bag_size: 43
batch 539, loss: 0.2701, instance_loss: 0.2915, weighted_loss: 0.2765, label: 0, bag_size: 962


class 0 clustering acc 0.9927981651376147: correct 21643/21800
class 1 clustering acc 0.29724770642201837: correct 1296/4360
Epoch: 8, train_loss: 0.5825, train_clustering_loss:  0.3310, train_error: 0.2257
class 0: acc 0.8290598290598291, correct 97/117
class 1: acc 0.6538461538461539, correct 68/104
class 2: acc 0.6818181818181818, correct 75/110
class 3: acc 0.7840909090909091, correct 69/88
class 4: acc 0.8968253968253969, correct 113/126

Val Set, val_loss: 0.9999, val_error: 0.4000, auc: 0.8806
class 0 clustering acc 0.9905: correct 1981/2000
class 1 clustering acc 0.1225: correct 49/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.45454545454545453, correct 10/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.5, correct 4/8
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0458, instance_loss: 0.0895, weighted_loss: 0.0589, label: 3, bag_size: 97
batch 39, loss: 0.1995, instance_loss: 0.1741, weighted_loss: 0.1919, label: 1, bag_size: 356
batch 59, loss: 0.0777, instance_loss: 0.3280, weighted_loss: 0.1528, label: 4, bag_size: 524
batch 79, loss: 0.0389, instance_loss: 0.1784, weighted_loss: 0.0807, label: 0, bag_size: 518
batch 99, loss: 0.0249, instance_loss: 0.1209, weighted_loss: 0.0537, label: 3, bag_size: 28
batch 119, loss: 0.0373, instance_loss: 0.1063, weighted_loss: 0.0580, label: 4, bag_size: 39
batch 139, loss: 0.2520, instance_loss: 0.2870, weighted_loss: 0.2625, label: 1, bag_size: 949
batch 159, loss: 3.0172, instance_loss: 1.2060, weighted_loss: 2.4739, label: 2, bag_size: 1108
batch 179, loss: 1.9987, instance_loss: 0.6318, weighted_loss: 1.5886, label: 4, bag_size: 1331
batch 199, loss: 0.1185, instance_loss: 0.2549, weighted_loss: 0.1594, label: 3, bag_size: 18
batch 219, loss: 0.3206, instance_loss: 0.3002, weighted_loss: 0.3145, label: 2, bag_size: 1281
batch 239, loss: 0.5652, instance_loss: 0.4393, weighted_loss: 0.5274, label: 2, bag_size: 1348
batch 259, loss: 0.3052, instance_loss: 0.2604, weighted_loss: 0.2917, label: 1, bag_size: 754
batch 279, loss: 0.1698, instance_loss: 0.1940, weighted_loss: 0.1771, label: 0, bag_size: 731
batch 299, loss: 0.6044, instance_loss: 0.3275, weighted_loss: 0.5214, label: 2, bag_size: 741
batch 319, loss: 1.1151, instance_loss: 0.4429, weighted_loss: 0.9135, label: 2, bag_size: 943
batch 339, loss: 0.3870, instance_loss: 0.3096, weighted_loss: 0.3637, label: 2, bag_size: 259
batch 359, loss: 0.4055, instance_loss: 0.3427, weighted_loss: 0.3867, label: 2, bag_size: 795
batch 379, loss: 0.7721, instance_loss: 0.4469, weighted_loss: 0.6745, label: 0, bag_size: 410
batch 399, loss: 0.1892, instance_loss: 0.3692, weighted_loss: 0.2432, label: 4, bag_size: 773
batch 419, loss: 0.2726, instance_loss: 0.2190, weighted_loss: 0.2565, label: 1, bag_size: 944
batch 439, loss: 3.2148, instance_loss: 0.7903, weighted_loss: 2.4874, label: 3, bag_size: 630
batch 459, loss: 0.0119, instance_loss: 0.1453, weighted_loss: 0.0520, label: 3, bag_size: 50
batch 479, loss: 0.1799, instance_loss: 0.2989, weighted_loss: 0.2156, label: 0, bag_size: 921
batch 499, loss: 0.1109, instance_loss: 0.0990, weighted_loss: 0.1073, label: 1, bag_size: 1086
batch 519, loss: 0.4338, instance_loss: 0.2503, weighted_loss: 0.3788, label: 1, bag_size: 746
batch 539, loss: 0.7653, instance_loss: 0.4641, weighted_loss: 0.6750, label: 2, bag_size: 1119


class 0 clustering acc 0.9909174311926605: correct 21602/21800
class 1 clustering acc 0.31146788990825686: correct 1358/4360
Epoch: 9, train_loss: 0.6001, train_clustering_loss:  0.3334, train_error: 0.2147
class 0: acc 0.8105263157894737, correct 77/95
class 1: acc 0.6938775510204082, correct 68/98
class 2: acc 0.7165354330708661, correct 91/127
class 3: acc 0.8260869565217391, correct 95/115
class 4: acc 0.8818181818181818, correct 97/110

Val Set, val_loss: 0.9758, val_error: 0.3400, auc: 0.8890
class 0 clustering acc 0.99: correct 1980/2000
class 1 clustering acc 0.1175: correct 47/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.5909090909090909, correct 13/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 4 out of 20


batch 19, loss: 3.1550, instance_loss: 0.6856, weighted_loss: 2.4142, label: 0, bag_size: 818
batch 39, loss: 0.7650, instance_loss: 0.4095, weighted_loss: 0.6583, label: 1, bag_size: 139
batch 59, loss: 1.1908, instance_loss: 0.4823, weighted_loss: 0.9783, label: 2, bag_size: 324
batch 79, loss: 1.3797, instance_loss: 0.4792, weighted_loss: 1.1095, label: 2, bag_size: 373
batch 99, loss: 1.5003, instance_loss: 0.4726, weighted_loss: 1.1920, label: 1, bag_size: 1144
batch 119, loss: 0.3261, instance_loss: 0.3024, weighted_loss: 0.3190, label: 0, bag_size: 381
batch 139, loss: 0.2813, instance_loss: 0.5344, weighted_loss: 0.3572, label: 4, bag_size: 823
batch 159, loss: 0.1622, instance_loss: 0.1624, weighted_loss: 0.1623, label: 1, bag_size: 346
batch 179, loss: 0.5170, instance_loss: 0.6006, weighted_loss: 0.5421, label: 0, bag_size: 128
batch 199, loss: 0.0996, instance_loss: 0.2116, weighted_loss: 0.1332, label: 4, bag_size: 24
batch 219, loss: 0.0728, instance_loss: 0.1701, weighted_loss: 0.1020, label: 3, bag_size: 143
batch 239, loss: 0.2581, instance_loss: 0.2575, weighted_loss: 0.2579, label: 2, bag_size: 1053
batch 259, loss: 0.7472, instance_loss: 0.3731, weighted_loss: 0.6349, label: 0, bag_size: 736
batch 279, loss: 1.6262, instance_loss: 0.5240, weighted_loss: 1.2956, label: 1, bag_size: 386
batch 299, loss: 0.0669, instance_loss: 0.2327, weighted_loss: 0.1167, label: 3, bag_size: 72
batch 319, loss: 0.1108, instance_loss: 0.1325, weighted_loss: 0.1173, label: 3, bag_size: 143
batch 339, loss: 0.9572, instance_loss: 0.3745, weighted_loss: 0.7824, label: 3, bag_size: 821
batch 359, loss: 0.1353, instance_loss: 0.4173, weighted_loss: 0.2199, label: 0, bag_size: 143
batch 379, loss: 0.0370, instance_loss: 0.1135, weighted_loss: 0.0600, label: 3, bag_size: 94
batch 399, loss: 0.4229, instance_loss: 0.5066, weighted_loss: 0.4480, label: 0, bag_size: 760
batch 419, loss: 0.3877, instance_loss: 0.3123, weighted_loss: 0.3651, label: 2, bag_size: 286
batch 439, loss: 0.3247, instance_loss: 0.5367, weighted_loss: 0.3883, label: 1, bag_size: 1390
batch 459, loss: 0.1275, instance_loss: 0.1503, weighted_loss: 0.1344, label: 1, bag_size: 1127
batch 479, loss: 0.8393, instance_loss: 0.3938, weighted_loss: 0.7056, label: 4, bag_size: 826
batch 499, loss: 0.6159, instance_loss: 0.4539, weighted_loss: 0.5673, label: 0, bag_size: 653
batch 519, loss: 2.7056, instance_loss: 0.8485, weighted_loss: 2.1485, label: 3, bag_size: 281
batch 539, loss: 0.5225, instance_loss: 0.4107, weighted_loss: 0.4889, label: 2, bag_size: 245


class 0 clustering acc 0.9903211009174312: correct 21589/21800
class 1 clustering acc 0.31811926605504587: correct 1387/4360
Epoch: 10, train_loss: 0.5502, train_clustering_loss:  0.3365, train_error: 0.2018
class 0: acc 0.8333333333333334, correct 100/120
class 1: acc 0.6826923076923077, correct 71/104
class 2: acc 0.72, correct 72/100
class 3: acc 0.8446601941747572, correct 87/103
class 4: acc 0.8898305084745762, correct 105/118

Val Set, val_loss: 1.0906, val_error: 0.4200, auc: 0.8896
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.1425: correct 57/400
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.5, correct 11/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0315, instance_loss: 0.1454, weighted_loss: 0.0657, label: 3, bag_size: 18
batch 39, loss: 0.6299, instance_loss: 0.4168, weighted_loss: 0.5660, label: 3, bag_size: 697
batch 59, loss: 0.0118, instance_loss: 0.1799, weighted_loss: 0.0622, label: 3, bag_size: 23
batch 79, loss: 1.1102, instance_loss: 0.4331, weighted_loss: 0.9071, label: 2, bag_size: 271
batch 99, loss: 0.0482, instance_loss: 0.2295, weighted_loss: 0.1026, label: 3, bag_size: 18
batch 119, loss: 1.2227, instance_loss: 0.5137, weighted_loss: 1.0100, label: 1, bag_size: 1376
batch 139, loss: 0.0268, instance_loss: 0.0691, weighted_loss: 0.0395, label: 4, bag_size: 119
batch 159, loss: 0.0426, instance_loss: 0.2572, weighted_loss: 0.1070, label: 4, bag_size: 168
batch 179, loss: 0.0299, instance_loss: 0.2150, weighted_loss: 0.0854, label: 3, bag_size: 16
batch 199, loss: 0.0088, instance_loss: 0.0532, weighted_loss: 0.0221, label: 4, bag_size: 202
batch 219, loss: 0.0438, instance_loss: 0.1459, weighted_loss: 0.0744, label: 3, bag_size: 29
batch 239, loss: 1.8325, instance_loss: 0.5140, weighted_loss: 1.4370, label: 1, bag_size: 786
batch 259, loss: 0.2536, instance_loss: 0.3900, weighted_loss: 0.2945, label: 4, bag_size: 17
batch 279, loss: 0.7055, instance_loss: 0.2833, weighted_loss: 0.5788, label: 4, bag_size: 1278
batch 299, loss: 0.0629, instance_loss: 0.2275, weighted_loss: 0.1123, label: 0, bag_size: 402
batch 319, loss: 0.0564, instance_loss: 0.1093, weighted_loss: 0.0723, label: 4, bag_size: 72
batch 339, loss: 1.3951, instance_loss: 0.5058, weighted_loss: 1.1283, label: 0, bag_size: 423
batch 359, loss: 0.6310, instance_loss: 0.3487, weighted_loss: 0.5463, label: 1, bag_size: 968
batch 379, loss: 0.2985, instance_loss: 0.2823, weighted_loss: 0.2936, label: 2, bag_size: 907
batch 399, loss: 0.1981, instance_loss: 0.5148, weighted_loss: 0.2931, label: 4, bag_size: 754
batch 419, loss: 0.6201, instance_loss: 0.3273, weighted_loss: 0.5322, label: 1, bag_size: 887
batch 439, loss: 0.0311, instance_loss: 0.1584, weighted_loss: 0.0693, label: 0, bag_size: 518
batch 459, loss: 0.3395, instance_loss: 0.2110, weighted_loss: 0.3010, label: 3, bag_size: 1399
batch 479, loss: 0.2417, instance_loss: 0.2249, weighted_loss: 0.2367, label: 2, bag_size: 1289
batch 499, loss: 0.3167, instance_loss: 0.3768, weighted_loss: 0.3347, label: 0, bag_size: 1174
batch 519, loss: 0.3983, instance_loss: 0.3107, weighted_loss: 0.3720, label: 2, bag_size: 237
batch 539, loss: 0.0156, instance_loss: 0.0724, weighted_loss: 0.0326, label: 4, bag_size: 157


class 0 clustering acc 0.9914220183486239: correct 21613/21800
class 1 clustering acc 0.3412844036697248: correct 1488/4360
Epoch: 11, train_loss: 0.4724, train_clustering_loss:  0.3168, train_error: 0.1523
class 0: acc 0.9181818181818182, correct 101/110
class 1: acc 0.6764705882352942, correct 69/102
class 2: acc 0.8032786885245902, correct 98/122
class 3: acc 0.9009009009009009, correct 100/111
class 4: acc 0.94, correct 94/100

Val Set, val_loss: 0.9789, val_error: 0.4000, auc: 0.8880
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.1925: correct 77/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5454545454545454, correct 12/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0467, instance_loss: 0.1503, weighted_loss: 0.0778, label: 4, bag_size: 140
batch 39, loss: 0.1032, instance_loss: 0.3349, weighted_loss: 0.1727, label: 0, bag_size: 129
batch 59, loss: 0.1280, instance_loss: 0.1935, weighted_loss: 0.1476, label: 4, bag_size: 19
batch 79, loss: 0.0226, instance_loss: 0.1872, weighted_loss: 0.0720, label: 4, bag_size: 40
batch 99, loss: 0.7643, instance_loss: 0.3984, weighted_loss: 0.6545, label: 1, bag_size: 530
batch 119, loss: 0.3705, instance_loss: 0.6108, weighted_loss: 0.4426, label: 2, bag_size: 1348
batch 139, loss: 1.1987, instance_loss: 0.7098, weighted_loss: 1.0520, label: 3, bag_size: 211
batch 159, loss: 0.7473, instance_loss: 0.4405, weighted_loss: 0.6553, label: 0, bag_size: 1196
batch 179, loss: 0.0310, instance_loss: 0.2260, weighted_loss: 0.0895, label: 3, bag_size: 24
batch 199, loss: 0.4381, instance_loss: 0.3701, weighted_loss: 0.4177, label: 0, bag_size: 1527
batch 219, loss: 0.7984, instance_loss: 0.3428, weighted_loss: 0.6617, label: 0, bag_size: 736
batch 239, loss: 0.0331, instance_loss: 0.1479, weighted_loss: 0.0675, label: 4, bag_size: 125
batch 259, loss: 0.0021, instance_loss: 0.3052, weighted_loss: 0.0930, label: 3, bag_size: 16
batch 279, loss: 0.1542, instance_loss: 0.1973, weighted_loss: 0.1672, label: 0, bag_size: 476
batch 299, loss: 0.1454, instance_loss: 0.1904, weighted_loss: 0.1589, label: 0, bag_size: 410
batch 319, loss: 0.3415, instance_loss: 0.4088, weighted_loss: 0.3617, label: 2, bag_size: 1348
batch 339, loss: 0.3171, instance_loss: 0.3907, weighted_loss: 0.3392, label: 3, bag_size: 849
batch 359, loss: 0.0405, instance_loss: 0.2968, weighted_loss: 0.1174, label: 4, bag_size: 23
batch 379, loss: 0.1451, instance_loss: 0.1931, weighted_loss: 0.1595, label: 3, bag_size: 841
batch 399, loss: 0.1132, instance_loss: 0.1909, weighted_loss: 0.1365, label: 3, bag_size: 16
batch 419, loss: 0.0109, instance_loss: 0.2228, weighted_loss: 0.0745, label: 3, bag_size: 53
batch 439, loss: 0.0139, instance_loss: 0.0963, weighted_loss: 0.0386, label: 4, bag_size: 114
batch 459, loss: 0.1928, instance_loss: 0.2106, weighted_loss: 0.1981, label: 1, bag_size: 858
batch 479, loss: 0.0523, instance_loss: 0.1149, weighted_loss: 0.0711, label: 0, bag_size: 921
batch 499, loss: 0.0582, instance_loss: 0.1406, weighted_loss: 0.0829, label: 0, bag_size: 921
batch 519, loss: 0.0273, instance_loss: 0.1032, weighted_loss: 0.0501, label: 3, bag_size: 143
batch 539, loss: 0.4479, instance_loss: 0.3687, weighted_loss: 0.4241, label: 2, bag_size: 1047


class 0 clustering acc 0.9918807339449541: correct 21623/21800
class 1 clustering acc 0.3896788990825688: correct 1699/4360
Epoch: 12, train_loss: 0.4498, train_clustering_loss:  0.3004, train_error: 0.1468
class 0: acc 0.9043478260869565, correct 104/115
class 1: acc 0.7830188679245284, correct 83/106
class 2: acc 0.7714285714285715, correct 81/105
class 3: acc 0.8728813559322034, correct 103/118
class 4: acc 0.9306930693069307, correct 94/101

Val Set, val_loss: 0.9902, val_error: 0.3400, auc: 0.8908
class 0 clustering acc 0.9865: correct 1973/2000
class 1 clustering acc 0.1775: correct 71/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6818181818181818, correct 15/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.3301, instance_loss: 0.5441, weighted_loss: 1.0943, label: 0, bag_size: 653
batch 39, loss: 0.1660, instance_loss: 0.1118, weighted_loss: 0.1498, label: 1, bag_size: 1261
batch 59, loss: 0.0269, instance_loss: 0.0764, weighted_loss: 0.0418, label: 3, bag_size: 63
batch 79, loss: 0.0213, instance_loss: 0.1334, weighted_loss: 0.0549, label: 4, bag_size: 125
batch 99, loss: 0.0670, instance_loss: 0.1198, weighted_loss: 0.0828, label: 1, bag_size: 1086
batch 119, loss: 0.0434, instance_loss: 0.2272, weighted_loss: 0.0985, label: 3, bag_size: 18
batch 139, loss: 0.9583, instance_loss: 0.4788, weighted_loss: 0.8145, label: 2, bag_size: 1218
batch 159, loss: 0.1627, instance_loss: 0.2181, weighted_loss: 0.1793, label: 2, bag_size: 848
batch 179, loss: 0.0271, instance_loss: 0.1901, weighted_loss: 0.0760, label: 4, bag_size: 40
batch 199, loss: 2.5163, instance_loss: 0.6561, weighted_loss: 1.9583, label: 0, bag_size: 255
batch 219, loss: 0.0566, instance_loss: 0.0919, weighted_loss: 0.0672, label: 4, bag_size: 123
batch 239, loss: 0.3019, instance_loss: 0.2724, weighted_loss: 0.2931, label: 2, bag_size: 347
batch 259, loss: 0.0795, instance_loss: 0.2023, weighted_loss: 0.1164, label: 4, bag_size: 19
batch 279, loss: 0.1384, instance_loss: 0.2691, weighted_loss: 0.1776, label: 0, bag_size: 524
batch 299, loss: 0.0688, instance_loss: 0.1390, weighted_loss: 0.0899, label: 4, bag_size: 24
batch 319, loss: 0.0598, instance_loss: 0.1392, weighted_loss: 0.0836, label: 1, bag_size: 1086
batch 339, loss: 0.8925, instance_loss: 0.4175, weighted_loss: 0.7500, label: 2, bag_size: 237
batch 359, loss: 0.0775, instance_loss: 0.2886, weighted_loss: 0.1408, label: 0, bag_size: 148
batch 379, loss: 0.0377, instance_loss: 0.1234, weighted_loss: 0.0634, label: 4, bag_size: 130
batch 399, loss: 1.1038, instance_loss: 0.5086, weighted_loss: 0.9253, label: 0, bag_size: 255
batch 419, loss: 0.0062, instance_loss: 0.2098, weighted_loss: 0.0673, label: 3, bag_size: 18
batch 439, loss: 0.0230, instance_loss: 0.0855, weighted_loss: 0.0418, label: 4, bag_size: 148
batch 459, loss: 0.7732, instance_loss: 0.4301, weighted_loss: 0.6703, label: 2, bag_size: 1617
batch 479, loss: 0.6729, instance_loss: 0.2874, weighted_loss: 0.5572, label: 3, bag_size: 533
batch 499, loss: 0.5304, instance_loss: 0.4724, weighted_loss: 0.5130, label: 3, bag_size: 791
batch 519, loss: 2.0420, instance_loss: 0.7379, weighted_loss: 1.6508, label: 1, bag_size: 875
batch 539, loss: 0.1182, instance_loss: 0.1193, weighted_loss: 0.1185, label: 1, bag_size: 288


class 0 clustering acc 0.9888990825688073: correct 21558/21800
class 1 clustering acc 0.3834862385321101: correct 1672/4360
Epoch: 13, train_loss: 0.4860, train_clustering_loss:  0.3136, train_error: 0.1761
class 0: acc 0.831858407079646, correct 94/113
class 1: acc 0.6846846846846847, correct 76/111
class 2: acc 0.7727272727272727, correct 85/110
class 3: acc 0.9072164948453608, correct 88/97
class 4: acc 0.9298245614035088, correct 106/114

Val Set, val_loss: 1.1334, val_error: 0.3800, auc: 0.8851
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.2: correct 80/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5909090909090909, correct 13/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.3044, instance_loss: 0.5646, weighted_loss: 1.0825, label: 1, bag_size: 535
batch 39, loss: 2.3109, instance_loss: 0.6270, weighted_loss: 1.8058, label: 0, bag_size: 1257
batch 59, loss: 0.1975, instance_loss: 0.8190, weighted_loss: 0.3840, label: 4, bag_size: 675
batch 79, loss: 0.3630, instance_loss: 0.2663, weighted_loss: 0.3340, label: 2, bag_size: 1788
batch 99, loss: 0.1761, instance_loss: 0.2592, weighted_loss: 0.2011, label: 2, bag_size: 910
batch 119, loss: 0.6982, instance_loss: 0.3915, weighted_loss: 0.6062, label: 1, bag_size: 936
batch 139, loss: 0.0430, instance_loss: 0.1087, weighted_loss: 0.0627, label: 0, bag_size: 382
batch 159, loss: 0.4745, instance_loss: 0.4899, weighted_loss: 0.4791, label: 4, bag_size: 675
batch 179, loss: 0.0048, instance_loss: 0.1923, weighted_loss: 0.0610, label: 4, bag_size: 20
batch 199, loss: 0.1460, instance_loss: 0.3766, weighted_loss: 0.2152, label: 0, bag_size: 148
batch 219, loss: 0.4225, instance_loss: 0.2128, weighted_loss: 0.3596, label: 1, bag_size: 348
batch 239, loss: 0.3728, instance_loss: 0.3177, weighted_loss: 0.3563, label: 2, bag_size: 839
batch 259, loss: 0.4895, instance_loss: 0.5102, weighted_loss: 0.4957, label: 0, bag_size: 163
batch 279, loss: 1.4050, instance_loss: 0.4588, weighted_loss: 1.1211, label: 2, bag_size: 679
batch 299, loss: 0.0547, instance_loss: 0.1947, weighted_loss: 0.0967, label: 0, bag_size: 1143
batch 319, loss: 0.0629, instance_loss: 0.0926, weighted_loss: 0.0718, label: 4, bag_size: 150
batch 339, loss: 0.0355, instance_loss: 0.0762, weighted_loss: 0.0477, label: 4, bag_size: 101
batch 359, loss: 0.2001, instance_loss: 0.2463, weighted_loss: 0.2139, label: 0, bag_size: 381
batch 379, loss: 3.9845, instance_loss: 0.9091, weighted_loss: 3.0618, label: 3, bag_size: 1380
batch 399, loss: 0.0175, instance_loss: 0.0679, weighted_loss: 0.0326, label: 4, bag_size: 157
batch 419, loss: 0.0314, instance_loss: 0.2768, weighted_loss: 0.1051, label: 3, bag_size: 18
batch 439, loss: 0.5930, instance_loss: 0.2798, weighted_loss: 0.4990, label: 2, bag_size: 655
batch 459, loss: 2.6260, instance_loss: 0.6596, weighted_loss: 2.0361, label: 2, bag_size: 248
batch 479, loss: 0.5570, instance_loss: 0.4312, weighted_loss: 0.5192, label: 4, bag_size: 974
batch 499, loss: 0.1185, instance_loss: 0.2280, weighted_loss: 0.1514, label: 4, bag_size: 134
batch 519, loss: 0.1174, instance_loss: 0.3575, weighted_loss: 0.1894, label: 2, bag_size: 330
batch 539, loss: 0.0932, instance_loss: 0.2682, weighted_loss: 0.1457, label: 4, bag_size: 17


class 0 clustering acc 0.9904587155963303: correct 21592/21800
class 1 clustering acc 0.4073394495412844: correct 1776/4360
Epoch: 14, train_loss: 0.4458, train_clustering_loss:  0.2994, train_error: 0.1651
class 0: acc 0.8596491228070176, correct 98/114
class 1: acc 0.6464646464646465, correct 64/99
class 2: acc 0.808695652173913, correct 93/115
class 3: acc 0.912621359223301, correct 94/103
class 4: acc 0.9298245614035088, correct 106/114

Val Set, val_loss: 1.2104, val_error: 0.4600, auc: 0.8676
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.2275: correct 91/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.36363636363636365, correct 8/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0175, instance_loss: 0.2431, weighted_loss: 0.0852, label: 4, bag_size: 1278
batch 39, loss: 0.0025, instance_loss: 0.0875, weighted_loss: 0.0280, label: 3, bag_size: 94
batch 59, loss: 0.0237, instance_loss: 0.0667, weighted_loss: 0.0366, label: 1, bag_size: 636
batch 79, loss: 1.9680, instance_loss: 0.7510, weighted_loss: 1.6029, label: 2, bag_size: 732
batch 99, loss: 2.0888, instance_loss: 0.7749, weighted_loss: 1.6946, label: 3, bag_size: 671
batch 119, loss: 0.1084, instance_loss: 0.1404, weighted_loss: 0.1180, label: 1, bag_size: 1402
batch 139, loss: 2.7547, instance_loss: 0.8060, weighted_loss: 2.1701, label: 3, bag_size: 281
batch 159, loss: 0.0082, instance_loss: 0.0718, weighted_loss: 0.0273, label: 3, bag_size: 37
batch 179, loss: 0.3452, instance_loss: 0.3470, weighted_loss: 0.3457, label: 2, bag_size: 1150
batch 199, loss: 0.0693, instance_loss: 0.1992, weighted_loss: 0.1083, label: 0, bag_size: 1018
batch 219, loss: 0.4180, instance_loss: 0.3460, weighted_loss: 0.3964, label: 0, bag_size: 294
batch 239, loss: 0.1563, instance_loss: 0.4979, weighted_loss: 0.2587, label: 0, bag_size: 163
batch 259, loss: 0.0184, instance_loss: 0.0877, weighted_loss: 0.0392, label: 4, bag_size: 44
batch 279, loss: 0.5086, instance_loss: 0.3471, weighted_loss: 0.4602, label: 2, bag_size: 932
batch 299, loss: 0.0315, instance_loss: 0.0875, weighted_loss: 0.0483, label: 4, bag_size: 211
batch 319, loss: 0.0073, instance_loss: 0.1231, weighted_loss: 0.0421, label: 3, bag_size: 37
batch 339, loss: 0.0448, instance_loss: 0.1399, weighted_loss: 0.0734, label: 3, bag_size: 35
batch 359, loss: 0.0811, instance_loss: 0.2854, weighted_loss: 0.1424, label: 3, bag_size: 1559
batch 379, loss: 0.0647, instance_loss: 0.0725, weighted_loss: 0.0670, label: 1, bag_size: 369
batch 399, loss: 0.6064, instance_loss: 0.3059, weighted_loss: 0.5163, label: 2, bag_size: 395
batch 419, loss: 0.3340, instance_loss: 0.3158, weighted_loss: 0.3285, label: 0, bag_size: 1247
batch 439, loss: 0.0209, instance_loss: 0.1265, weighted_loss: 0.0526, label: 3, bag_size: 18
batch 459, loss: 0.1718, instance_loss: 0.2406, weighted_loss: 0.1924, label: 2, bag_size: 1180
batch 479, loss: 0.8716, instance_loss: 0.6501, weighted_loss: 0.8052, label: 2, bag_size: 248
batch 499, loss: 0.0696, instance_loss: 0.1956, weighted_loss: 0.1074, label: 0, bag_size: 515
batch 519, loss: 0.6514, instance_loss: 0.3986, weighted_loss: 0.5755, label: 2, bag_size: 373
batch 539, loss: 0.4026, instance_loss: 0.2861, weighted_loss: 0.3677, label: 2, bag_size: 1006


class 0 clustering acc 0.990137614678899: correct 21585/21800
class 1 clustering acc 0.3912844036697248: correct 1706/4360
Epoch: 15, train_loss: 0.4274, train_clustering_loss:  0.3046, train_error: 0.1523
class 0: acc 0.8878504672897196, correct 95/107
class 1: acc 0.7596899224806202, correct 98/129
class 2: acc 0.7475728155339806, correct 77/103
class 3: acc 0.9117647058823529, correct 93/102
class 4: acc 0.9519230769230769, correct 99/104

Val Set, val_loss: 1.0161, val_error: 0.3600, auc: 0.8891
class 0 clustering acc 0.988: correct 1976/2000
class 1 clustering acc 0.2375: correct 95/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6363636363636364, correct 14/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0607, instance_loss: 0.0834, weighted_loss: 0.0675, label: 3, bag_size: 405
batch 39, loss: 0.0752, instance_loss: 0.1893, weighted_loss: 0.1094, label: 3, bag_size: 316
batch 59, loss: 0.2714, instance_loss: 0.3033, weighted_loss: 0.2809, label: 2, bag_size: 1200
batch 79, loss: 0.4477, instance_loss: 0.2479, weighted_loss: 0.3878, label: 1, bag_size: 746
batch 99, loss: 0.0068, instance_loss: 0.1964, weighted_loss: 0.0637, label: 3, bag_size: 1069
batch 119, loss: 1.4297, instance_loss: 0.6101, weighted_loss: 1.1838, label: 0, bag_size: 1527
batch 139, loss: 0.7283, instance_loss: 0.4473, weighted_loss: 0.6440, label: 3, bag_size: 697
batch 159, loss: 0.0101, instance_loss: 0.1484, weighted_loss: 0.0516, label: 4, bag_size: 44
batch 179, loss: 0.1340, instance_loss: 0.2170, weighted_loss: 0.1589, label: 0, bag_size: 294
batch 199, loss: 0.1166, instance_loss: 0.1678, weighted_loss: 0.1320, label: 0, bag_size: 410
batch 219, loss: 0.4328, instance_loss: 0.3533, weighted_loss: 0.4090, label: 2, bag_size: 1150
batch 239, loss: 0.0179, instance_loss: 0.0682, weighted_loss: 0.0330, label: 0, bag_size: 382
batch 259, loss: 0.0271, instance_loss: 0.0899, weighted_loss: 0.0460, label: 0, bag_size: 382
batch 279, loss: 0.1515, instance_loss: 0.2362, weighted_loss: 0.1769, label: 2, bag_size: 499
batch 299, loss: 0.4453, instance_loss: 0.3248, weighted_loss: 0.4091, label: 2, bag_size: 883
batch 319, loss: 0.1595, instance_loss: 0.2575, weighted_loss: 0.1889, label: 2, bag_size: 1289
batch 339, loss: 0.0077, instance_loss: 0.1101, weighted_loss: 0.0384, label: 4, bag_size: 51
batch 359, loss: 0.2008, instance_loss: 0.5357, weighted_loss: 0.3013, label: 0, bag_size: 155
batch 379, loss: 0.1604, instance_loss: 0.1932, weighted_loss: 0.1703, label: 1, bag_size: 790
batch 399, loss: 0.0305, instance_loss: 0.1356, weighted_loss: 0.0620, label: 4, bag_size: 211
batch 419, loss: 0.0090, instance_loss: 0.2466, weighted_loss: 0.0803, label: 4, bag_size: 29
batch 439, loss: 0.0029, instance_loss: 0.2199, weighted_loss: 0.0680, label: 3, bag_size: 20
batch 459, loss: 0.0132, instance_loss: 0.1384, weighted_loss: 0.0508, label: 3, bag_size: 28
batch 479, loss: 0.3896, instance_loss: 0.5113, weighted_loss: 0.4261, label: 4, bag_size: 1360
batch 499, loss: 0.2027, instance_loss: 0.3574, weighted_loss: 0.2491, label: 4, bag_size: 17
batch 519, loss: 0.1721, instance_loss: 0.3622, weighted_loss: 0.2292, label: 2, bag_size: 784
batch 539, loss: 0.1948, instance_loss: 0.2772, weighted_loss: 0.2195, label: 2, bag_size: 750


class 0 clustering acc 0.9892201834862385: correct 21565/21800
class 1 clustering acc 0.4158256880733945: correct 1813/4360
Epoch: 16, train_loss: 0.3943, train_clustering_loss:  0.3006, train_error: 0.1431
class 0: acc 0.8760330578512396, correct 106/121
class 1: acc 0.7244897959183674, correct 71/98
class 2: acc 0.8018018018018018, correct 89/111
class 3: acc 0.9026548672566371, correct 102/113
class 4: acc 0.9705882352941176, correct 99/102

Val Set, val_loss: 1.0578, val_error: 0.3800, auc: 0.9003
class 0 clustering acc 0.9885: correct 1977/2000
class 1 clustering acc 0.235: correct 94/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5909090909090909, correct 13/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.0331, instance_loss: 0.6634, weighted_loss: 0.9222, label: 3, bag_size: 200
batch 39, loss: 0.4454, instance_loss: 0.3161, weighted_loss: 0.4066, label: 2, bag_size: 1259
batch 59, loss: 0.1013, instance_loss: 0.2225, weighted_loss: 0.1377, label: 2, bag_size: 1215
batch 79, loss: 0.0020, instance_loss: 0.1168, weighted_loss: 0.0365, label: 3, bag_size: 41
batch 99, loss: 0.2117, instance_loss: 0.3597, weighted_loss: 0.2561, label: 0, bag_size: 163
batch 119, loss: 0.0545, instance_loss: 0.2602, weighted_loss: 0.1162, label: 0, bag_size: 116
batch 139, loss: 0.5217, instance_loss: 0.1818, weighted_loss: 0.4197, label: 0, bag_size: 1332
batch 159, loss: 0.9551, instance_loss: 0.4499, weighted_loss: 0.8036, label: 2, bag_size: 408
batch 179, loss: 0.0016, instance_loss: 0.1796, weighted_loss: 0.0550, label: 3, bag_size: 16
batch 199, loss: 1.4118, instance_loss: 0.5058, weighted_loss: 1.1400, label: 2, bag_size: 943
batch 219, loss: 0.0084, instance_loss: 0.1109, weighted_loss: 0.0392, label: 3, bag_size: 18
batch 239, loss: 0.0056, instance_loss: 0.0866, weighted_loss: 0.0299, label: 3, bag_size: 94
batch 259, loss: 0.3779, instance_loss: 0.2800, weighted_loss: 0.3486, label: 1, bag_size: 846
batch 279, loss: 0.0014, instance_loss: 0.1240, weighted_loss: 0.0382, label: 3, bag_size: 18
batch 299, loss: 0.9286, instance_loss: 0.4189, weighted_loss: 0.7757, label: 0, bag_size: 545
batch 319, loss: 0.0020, instance_loss: 0.0410, weighted_loss: 0.0137, label: 4, bag_size: 123
batch 339, loss: 0.1915, instance_loss: 0.6148, weighted_loss: 0.3184, label: 3, bag_size: 1380
batch 359, loss: 0.0783, instance_loss: 0.1886, weighted_loss: 0.1114, label: 3, bag_size: 841
batch 379, loss: 0.0998, instance_loss: 0.2279, weighted_loss: 0.1382, label: 2, bag_size: 314
batch 399, loss: 0.1062, instance_loss: 0.1986, weighted_loss: 0.1339, label: 0, bag_size: 756
batch 419, loss: 0.1647, instance_loss: 0.4989, weighted_loss: 0.2650, label: 0, bag_size: 109
batch 439, loss: 0.0365, instance_loss: 0.2594, weighted_loss: 0.1033, label: 0, bag_size: 118
batch 459, loss: 0.6548, instance_loss: 0.6164, weighted_loss: 0.6433, label: 3, bag_size: 283
batch 479, loss: 0.4815, instance_loss: 0.3816, weighted_loss: 0.4515, label: 2, bag_size: 324
batch 499, loss: 0.2407, instance_loss: 0.2602, weighted_loss: 0.2466, label: 2, bag_size: 357
batch 519, loss: 1.2400, instance_loss: 0.4372, weighted_loss: 0.9992, label: 0, bag_size: 912
batch 539, loss: 0.6045, instance_loss: 0.2950, weighted_loss: 0.5117, label: 2, bag_size: 1050


class 0 clustering acc 0.9887614678899083: correct 21555/21800
class 1 clustering acc 0.4169724770642202: correct 1818/4360
Epoch: 17, train_loss: 0.3773, train_clustering_loss:  0.2931, train_error: 0.1284
class 0: acc 0.9181818181818182, correct 101/110
class 1: acc 0.7567567567567568, correct 84/111
class 2: acc 0.8317757009345794, correct 89/107
class 3: acc 0.9175257731958762, correct 89/97
class 4: acc 0.9333333333333333, correct 112/120

Val Set, val_loss: 1.0764, val_error: 0.3800, auc: 0.8986
class 0 clustering acc 0.9825: correct 1965/2000
class 1 clustering acc 0.275: correct 110/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.5454545454545454, correct 12/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0233, instance_loss: 0.1394, weighted_loss: 0.0581, label: 4, bag_size: 55
batch 39, loss: 0.2068, instance_loss: 0.3086, weighted_loss: 0.2373, label: 2, bag_size: 571
batch 59, loss: 0.0991, instance_loss: 0.1692, weighted_loss: 0.1201, label: 4, bag_size: 1176
batch 79, loss: 0.1393, instance_loss: 0.2667, weighted_loss: 0.1775, label: 0, bag_size: 371
batch 99, loss: 0.0025, instance_loss: 0.0506, weighted_loss: 0.0169, label: 4, bag_size: 72
batch 119, loss: 0.0067, instance_loss: 0.0788, weighted_loss: 0.0283, label: 4, bag_size: 63
batch 139, loss: 0.5316, instance_loss: 0.3954, weighted_loss: 0.4907, label: 3, bag_size: 841
batch 159, loss: 0.0021, instance_loss: 0.0655, weighted_loss: 0.0211, label: 4, bag_size: 44
batch 179, loss: 0.4244, instance_loss: 0.1847, weighted_loss: 0.3525, label: 3, bag_size: 952
batch 199, loss: 0.0086, instance_loss: 0.1036, weighted_loss: 0.0371, label: 3, bag_size: 97
batch 219, loss: 0.1835, instance_loss: 0.3700, weighted_loss: 0.2394, label: 2, bag_size: 649
batch 239, loss: 0.1533, instance_loss: 0.2276, weighted_loss: 0.1756, label: 0, bag_size: 367
batch 259, loss: 0.1312, instance_loss: 0.2156, weighted_loss: 0.1565, label: 2, bag_size: 1404
batch 279, loss: 0.0330, instance_loss: 0.2801, weighted_loss: 0.1071, label: 0, bag_size: 128
batch 299, loss: 0.1745, instance_loss: 0.2219, weighted_loss: 0.1887, label: 2, bag_size: 848
batch 319, loss: 0.1067, instance_loss: 0.2888, weighted_loss: 0.1613, label: 2, bag_size: 1164
batch 339, loss: 0.3546, instance_loss: 0.3255, weighted_loss: 0.3459, label: 1, bag_size: 846
batch 359, loss: 0.2837, instance_loss: 0.3820, weighted_loss: 0.3132, label: 2, bag_size: 259
batch 379, loss: 0.5469, instance_loss: 0.5515, weighted_loss: 0.5483, label: 2, bag_size: 916
batch 399, loss: 0.2496, instance_loss: 0.2973, weighted_loss: 0.2639, label: 3, bag_size: 1177
batch 419, loss: 0.2869, instance_loss: 0.2490, weighted_loss: 0.2755, label: 1, bag_size: 696
batch 439, loss: 0.0380, instance_loss: 0.1468, weighted_loss: 0.0706, label: 3, bag_size: 24
batch 459, loss: 0.1863, instance_loss: 0.2799, weighted_loss: 0.2143, label: 2, bag_size: 707
batch 479, loss: 0.1064, instance_loss: 0.1927, weighted_loss: 0.1323, label: 2, bag_size: 907
batch 499, loss: 0.0018, instance_loss: 0.0919, weighted_loss: 0.0289, label: 4, bag_size: 168
batch 519, loss: 0.0227, instance_loss: 0.2852, weighted_loss: 0.1015, label: 0, bag_size: 110
batch 539, loss: 0.1312, instance_loss: 0.2275, weighted_loss: 0.1601, label: 1, bag_size: 858


class 0 clustering acc 0.9880275229357798: correct 21539/21800
class 1 clustering acc 0.4681192660550459: correct 2041/4360
Epoch: 18, train_loss: 0.3409, train_clustering_loss:  0.2789, train_error: 0.1229
class 0: acc 0.9444444444444444, correct 102/108
class 1: acc 0.7346938775510204, correct 72/98
class 2: acc 0.7857142857142857, correct 88/112
class 3: acc 0.944954128440367, correct 103/109
class 4: acc 0.9576271186440678, correct 113/118

Val Set, val_loss: 0.9922, val_error: 0.3400, auc: 0.8993
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.295: correct 118/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6363636363636364, correct 14/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3291, instance_loss: 0.3118, weighted_loss: 0.3239, label: 2, bag_size: 868
batch 39, loss: 0.0093, instance_loss: 0.1410, weighted_loss: 0.0488, label: 3, bag_size: 27
batch 59, loss: 0.3257, instance_loss: 0.2406, weighted_loss: 0.3002, label: 2, bag_size: 632
batch 79, loss: 0.0064, instance_loss: 0.0345, weighted_loss: 0.0148, label: 4, bag_size: 162
batch 99, loss: 0.0060, instance_loss: 0.0507, weighted_loss: 0.0194, label: 4, bag_size: 137
batch 119, loss: 0.0584, instance_loss: 0.3715, weighted_loss: 0.1523, label: 4, bag_size: 754
batch 139, loss: 0.3397, instance_loss: 0.3631, weighted_loss: 0.3468, label: 1, bag_size: 648
batch 159, loss: 0.0634, instance_loss: 0.1552, weighted_loss: 0.0910, label: 2, bag_size: 314
batch 179, loss: 0.6972, instance_loss: 0.3938, weighted_loss: 0.6062, label: 2, bag_size: 943
batch 199, loss: 0.0011, instance_loss: 0.0818, weighted_loss: 0.0253, label: 3, bag_size: 27
batch 219, loss: 0.5771, instance_loss: 0.6375, weighted_loss: 0.5952, label: 2, bag_size: 916
batch 239, loss: 0.4265, instance_loss: 0.7001, weighted_loss: 0.5086, label: 3, bag_size: 200
batch 259, loss: 0.1906, instance_loss: 0.4882, weighted_loss: 0.2799, label: 3, bag_size: 697
batch 279, loss: 0.0178, instance_loss: 0.2383, weighted_loss: 0.0839, label: 3, bag_size: 1069
batch 299, loss: 2.8068, instance_loss: 0.7814, weighted_loss: 2.1992, label: 1, bag_size: 386
batch 319, loss: 0.5500, instance_loss: 0.4124, weighted_loss: 0.5087, label: 1, bag_size: 1014
batch 339, loss: 0.1860, instance_loss: 0.2168, weighted_loss: 0.1952, label: 4, bag_size: 1278
batch 359, loss: 0.0265, instance_loss: 0.4617, weighted_loss: 0.1571, label: 0, bag_size: 109
batch 379, loss: 0.6592, instance_loss: 0.3133, weighted_loss: 0.5554, label: 0, bag_size: 736
batch 399, loss: 3.1460, instance_loss: 0.7164, weighted_loss: 2.4171, label: 3, bag_size: 630
batch 419, loss: 0.1004, instance_loss: 0.2020, weighted_loss: 0.1309, label: 0, bag_size: 371
batch 439, loss: 0.0101, instance_loss: 0.0553, weighted_loss: 0.0237, label: 3, bag_size: 305
batch 459, loss: 0.0602, instance_loss: 0.1464, weighted_loss: 0.0861, label: 4, bag_size: 137
batch 479, loss: 0.5337, instance_loss: 0.4361, weighted_loss: 0.5044, label: 0, bag_size: 801
batch 499, loss: 0.0278, instance_loss: 0.0445, weighted_loss: 0.0328, label: 4, bag_size: 148
batch 519, loss: 0.5221, instance_loss: 0.3085, weighted_loss: 0.4581, label: 2, bag_size: 684
batch 539, loss: 0.4758, instance_loss: 0.5848, weighted_loss: 0.5085, label: 1, bag_size: 1390


class 0 clustering acc 0.9862844036697248: correct 21501/21800
class 1 clustering acc 0.47339449541284406: correct 2064/4360
Epoch: 19, train_loss: 0.3211, train_clustering_loss:  0.2893, train_error: 0.1028
class 0: acc 0.9247311827956989, correct 86/93
class 1: acc 0.8269230769230769, correct 86/104
class 2: acc 0.85, correct 102/120
class 3: acc 0.9174311926605505, correct 100/109
class 4: acc 0.9663865546218487, correct 115/119

Val Set, val_loss: 1.1036, val_error: 0.3200, auc: 0.8883
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.23: correct 92/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6818181818181818, correct 15/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.8105, instance_loss: 0.6370, weighted_loss: 1.4585, label: 1, bag_size: 875
batch 39, loss: 0.0459, instance_loss: 0.1157, weighted_loss: 0.0668, label: 0, bag_size: 476
batch 59, loss: 0.2700, instance_loss: 0.3681, weighted_loss: 0.2995, label: 2, bag_size: 725
batch 79, loss: 0.7619, instance_loss: 0.5023, weighted_loss: 0.6840, label: 2, bag_size: 732
batch 99, loss: 0.0170, instance_loss: 0.2701, weighted_loss: 0.0929, label: 0, bag_size: 122
batch 119, loss: 0.0046, instance_loss: 0.1585, weighted_loss: 0.0508, label: 4, bag_size: 1278
batch 139, loss: 0.3388, instance_loss: 0.5914, weighted_loss: 0.4146, label: 1, bag_size: 868
batch 159, loss: 0.1255, instance_loss: 0.4235, weighted_loss: 0.2149, label: 3, bag_size: 936
batch 179, loss: 0.2429, instance_loss: 0.3606, weighted_loss: 0.2782, label: 4, bag_size: 656
batch 199, loss: 0.1070, instance_loss: 0.2116, weighted_loss: 0.1384, label: 4, bag_size: 26
batch 219, loss: 0.0019, instance_loss: 0.0264, weighted_loss: 0.0093, label: 0, bag_size: 1466
batch 239, loss: 0.1636, instance_loss: 0.2936, weighted_loss: 0.2026, label: 3, bag_size: 1172
batch 259, loss: 0.0051, instance_loss: 0.0821, weighted_loss: 0.0282, label: 4, bag_size: 114
batch 279, loss: 0.0147, instance_loss: 0.0531, weighted_loss: 0.0262, label: 4, bag_size: 150
batch 299, loss: 0.1112, instance_loss: 0.3075, weighted_loss: 0.1701, label: 4, bag_size: 17
batch 319, loss: 0.1927, instance_loss: 0.4014, weighted_loss: 0.2553, label: 2, bag_size: 571
batch 339, loss: 0.0413, instance_loss: 0.3938, weighted_loss: 0.1471, label: 3, bag_size: 936
batch 359, loss: 0.0047, instance_loss: 0.0952, weighted_loss: 0.0319, label: 3, bag_size: 48
batch 379, loss: 0.0328, instance_loss: 0.3208, weighted_loss: 0.1192, label: 3, bag_size: 15
batch 399, loss: 0.0079, instance_loss: 0.1904, weighted_loss: 0.0627, label: 4, bag_size: 19
batch 419, loss: 0.1891, instance_loss: 0.3464, weighted_loss: 0.2363, label: 4, bag_size: 17
batch 439, loss: 0.1714, instance_loss: 0.3673, weighted_loss: 0.2302, label: 1, bag_size: 818
batch 459, loss: 0.0101, instance_loss: 0.0592, weighted_loss: 0.0249, label: 0, bag_size: 382
batch 479, loss: 0.0134, instance_loss: 0.2102, weighted_loss: 0.0724, label: 3, bag_size: 20
batch 499, loss: 0.0030, instance_loss: 0.3534, weighted_loss: 0.1081, label: 4, bag_size: 636
batch 519, loss: 0.2947, instance_loss: 0.3758, weighted_loss: 0.3190, label: 1, bag_size: 1014
batch 539, loss: 0.7097, instance_loss: 0.5290, weighted_loss: 0.6555, label: 1, bag_size: 917


class 0 clustering acc 0.9888073394495412: correct 21556/21800
class 1 clustering acc 0.4426605504587156: correct 1930/4360
Epoch: 20, train_loss: 0.3430, train_clustering_loss:  0.2882, train_error: 0.1193
class 0: acc 0.9122807017543859, correct 104/114
class 1: acc 0.7857142857142857, correct 88/112
class 2: acc 0.8275862068965517, correct 96/116
class 3: acc 0.9326923076923077, correct 97/104
class 4: acc 0.9595959595959596, correct 95/99

Val Set, val_loss: 1.1489, val_error: 0.3400, auc: 0.8989
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.2325: correct 93/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6363636363636364, correct 14/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1791, instance_loss: 0.2503, weighted_loss: 0.2004, label: 1, bag_size: 867
batch 39, loss: 0.0652, instance_loss: 0.1281, weighted_loss: 0.0841, label: 1, bag_size: 696
batch 59, loss: 0.0798, instance_loss: 0.2102, weighted_loss: 0.1189, label: 2, bag_size: 910
batch 79, loss: 1.2439, instance_loss: 0.3455, weighted_loss: 0.9744, label: 1, bag_size: 405
batch 99, loss: 0.0535, instance_loss: 0.2586, weighted_loss: 0.1150, label: 4, bag_size: 773
batch 119, loss: 0.0030, instance_loss: 0.2237, weighted_loss: 0.0692, label: 3, bag_size: 16
batch 139, loss: 0.0054, instance_loss: 0.0486, weighted_loss: 0.0183, label: 3, bag_size: 115
batch 159, loss: 0.0736, instance_loss: 0.1973, weighted_loss: 0.1107, label: 0, bag_size: 340
batch 179, loss: 2.8640, instance_loss: 0.6230, weighted_loss: 2.1917, label: 1, bag_size: 1197
batch 199, loss: 0.3942, instance_loss: 0.3943, weighted_loss: 0.3942, label: 2, bag_size: 1197
batch 219, loss: 0.0313, instance_loss: 0.1300, weighted_loss: 0.0609, label: 1, bag_size: 1426
batch 239, loss: 0.2417, instance_loss: 0.3583, weighted_loss: 0.2766, label: 1, bag_size: 470
batch 259, loss: 0.1567, instance_loss: 0.3311, weighted_loss: 0.2091, label: 4, bag_size: 826
batch 279, loss: 0.0152, instance_loss: 0.0444, weighted_loss: 0.0240, label: 0, bag_size: 382
batch 299, loss: 0.0005, instance_loss: 0.0241, weighted_loss: 0.0076, label: 4, bag_size: 185
batch 319, loss: 0.1526, instance_loss: 0.3274, weighted_loss: 0.2050, label: 2, bag_size: 750
batch 339, loss: 0.5216, instance_loss: 0.4575, weighted_loss: 0.5024, label: 3, bag_size: 697
batch 359, loss: 0.0348, instance_loss: 0.2624, weighted_loss: 0.1031, label: 0, bag_size: 118
batch 379, loss: 0.0361, instance_loss: 0.0985, weighted_loss: 0.0548, label: 1, bag_size: 1261
batch 399, loss: 1.5088, instance_loss: 0.5700, weighted_loss: 1.2272, label: 1, bag_size: 386
batch 419, loss: 0.8709, instance_loss: 0.5043, weighted_loss: 0.7609, label: 1, bag_size: 651
batch 439, loss: 0.5029, instance_loss: 0.3905, weighted_loss: 0.4692, label: 0, bag_size: 1527
batch 459, loss: 0.0853, instance_loss: 0.2692, weighted_loss: 0.1404, label: 0, bag_size: 472
batch 479, loss: 0.0145, instance_loss: 0.0751, weighted_loss: 0.0327, label: 0, bag_size: 446
batch 499, loss: 0.0003, instance_loss: 0.0296, weighted_loss: 0.0091, label: 4, bag_size: 72
batch 519, loss: 1.7352, instance_loss: 0.6343, weighted_loss: 1.4049, label: 1, bag_size: 861
batch 539, loss: 0.1838, instance_loss: 0.1747, weighted_loss: 0.1810, label: 0, bag_size: 338


class 0 clustering acc 0.9876605504587156: correct 21531/21800
class 1 clustering acc 0.4763761467889908: correct 2077/4360
Epoch: 21, train_loss: 0.2912, train_clustering_loss:  0.2801, train_error: 0.0991
class 0: acc 0.9745762711864406, correct 115/118
class 1: acc 0.7920792079207921, correct 80/101
class 2: acc 0.8348623853211009, correct 91/109
class 3: acc 0.9482758620689655, correct 110/116
class 4: acc 0.9405940594059405, correct 95/101

Val Set, val_loss: 1.1060, val_error: 0.3600, auc: 0.8914
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5454545454545454, correct 12/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2070, instance_loss: 0.2335, weighted_loss: 0.2150, label: 2, bag_size: 395
batch 39, loss: 0.0713, instance_loss: 0.1902, weighted_loss: 0.1070, label: 4, bag_size: 20
batch 59, loss: 0.0042, instance_loss: 0.0539, weighted_loss: 0.0191, label: 4, bag_size: 112
batch 79, loss: 0.0213, instance_loss: 0.2805, weighted_loss: 0.0991, label: 3, bag_size: 1253
batch 99, loss: 0.0026, instance_loss: 0.0702, weighted_loss: 0.0229, label: 4, bag_size: 157
batch 119, loss: 0.1006, instance_loss: 0.3982, weighted_loss: 0.1899, label: 1, bag_size: 1646
batch 139, loss: 0.0005, instance_loss: 0.1661, weighted_loss: 0.0502, label: 4, bag_size: 20
batch 159, loss: 0.0253, instance_loss: 0.1255, weighted_loss: 0.0554, label: 4, bag_size: 28
batch 179, loss: 0.0044, instance_loss: 0.0600, weighted_loss: 0.0211, label: 4, bag_size: 160
batch 199, loss: 1.1655, instance_loss: 0.6432, weighted_loss: 1.0088, label: 2, bag_size: 732
batch 219, loss: 0.0004, instance_loss: 0.4611, weighted_loss: 0.1386, label: 4, bag_size: 1002
batch 239, loss: 0.1087, instance_loss: 0.1742, weighted_loss: 0.1283, label: 1, bag_size: 320
batch 259, loss: 0.0010, instance_loss: 0.0318, weighted_loss: 0.0103, label: 4, bag_size: 137
batch 279, loss: 1.6047, instance_loss: 0.6582, weighted_loss: 1.3207, label: 1, bag_size: 535
batch 299, loss: 0.0954, instance_loss: 0.2337, weighted_loss: 0.1369, label: 1, bag_size: 846
batch 319, loss: 0.2046, instance_loss: 0.3061, weighted_loss: 0.2350, label: 2, bag_size: 408
batch 339, loss: 0.2540, instance_loss: 0.2593, weighted_loss: 0.2556, label: 2, bag_size: 480
batch 359, loss: 0.3601, instance_loss: 0.6357, weighted_loss: 0.4428, label: 3, bag_size: 1380
batch 379, loss: 2.8414, instance_loss: 0.7563, weighted_loss: 2.2159, label: 1, bag_size: 1799
batch 399, loss: 0.1080, instance_loss: 0.1765, weighted_loss: 0.1285, label: 0, bag_size: 338
batch 419, loss: 0.8991, instance_loss: 0.4851, weighted_loss: 0.7749, label: 2, bag_size: 500
batch 439, loss: 0.0979, instance_loss: 0.2146, weighted_loss: 0.1329, label: 2, bag_size: 1053
batch 459, loss: 0.0003, instance_loss: 0.0738, weighted_loss: 0.0224, label: 4, bag_size: 137
batch 479, loss: 1.1021, instance_loss: 0.4788, weighted_loss: 0.9151, label: 2, bag_size: 295
batch 499, loss: 0.0018, instance_loss: 0.0535, weighted_loss: 0.0173, label: 4, bag_size: 790
batch 519, loss: 0.1565, instance_loss: 0.3245, weighted_loss: 0.2069, label: 1, bag_size: 968
batch 539, loss: 0.0329, instance_loss: 0.1694, weighted_loss: 0.0739, label: 0, bag_size: 760


class 0 clustering acc 0.9878440366972477: correct 21535/21800
class 1 clustering acc 0.4837155963302752: correct 2109/4360
Epoch: 22, train_loss: 0.3188, train_clustering_loss:  0.2776, train_error: 0.1138
class 0: acc 0.9326923076923077, correct 97/104
class 1: acc 0.7661290322580645, correct 95/124
class 2: acc 0.8365384615384616, correct 87/104
class 3: acc 0.9537037037037037, correct 103/108
class 4: acc 0.9619047619047619, correct 101/105

Val Set, val_loss: 1.2066, val_error: 0.3600, auc: 0.8785
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.255: correct 102/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.5454545454545454, correct 12/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0004, instance_loss: 0.0659, weighted_loss: 0.0201, label: 4, bag_size: 44
batch 39, loss: 0.0086, instance_loss: 0.1538, weighted_loss: 0.0522, label: 4, bag_size: 20
batch 59, loss: 0.0998, instance_loss: 0.6107, weighted_loss: 0.2531, label: 4, bag_size: 882
batch 79, loss: 0.0001, instance_loss: 0.0828, weighted_loss: 0.0249, label: 4, bag_size: 44
batch 99, loss: 0.0903, instance_loss: 0.1809, weighted_loss: 0.1175, label: 4, bag_size: 1121
batch 119, loss: 0.2835, instance_loss: 0.3975, weighted_loss: 0.3177, label: 0, bag_size: 1196
batch 139, loss: 0.0029, instance_loss: 0.1052, weighted_loss: 0.0336, label: 4, bag_size: 182
batch 159, loss: 0.0654, instance_loss: 0.2319, weighted_loss: 0.1153, label: 3, bag_size: 1019
batch 179, loss: 0.2889, instance_loss: 0.4423, weighted_loss: 0.3349, label: 2, bag_size: 1348
batch 199, loss: 0.2630, instance_loss: 0.2711, weighted_loss: 0.2654, label: 1, bag_size: 697
batch 219, loss: 0.0102, instance_loss: 0.0571, weighted_loss: 0.0243, label: 1, bag_size: 847
batch 239, loss: 0.0604, instance_loss: 0.2531, weighted_loss: 0.1182, label: 0, bag_size: 122
batch 259, loss: 1.5452, instance_loss: 0.5541, weighted_loss: 1.2479, label: 1, bag_size: 386
batch 279, loss: 0.1540, instance_loss: 0.1925, weighted_loss: 0.1655, label: 1, bag_size: 690
batch 299, loss: 0.0381, instance_loss: 0.2217, weighted_loss: 0.0932, label: 4, bag_size: 19
batch 319, loss: 0.9748, instance_loss: 0.6428, weighted_loss: 0.8752, label: 1, bag_size: 936
batch 339, loss: 0.0021, instance_loss: 0.2319, weighted_loss: 0.0711, label: 4, bag_size: 23
batch 359, loss: 0.0066, instance_loss: 0.0518, weighted_loss: 0.0202, label: 0, bag_size: 518
batch 379, loss: 0.2374, instance_loss: 0.3976, weighted_loss: 0.2854, label: 0, bag_size: 868
batch 399, loss: 0.2986, instance_loss: 0.1169, weighted_loss: 0.2441, label: 0, bag_size: 1247
batch 419, loss: 1.0232, instance_loss: 0.5627, weighted_loss: 0.8850, label: 2, bag_size: 732
batch 439, loss: 0.0288, instance_loss: 0.1827, weighted_loss: 0.0749, label: 0, bag_size: 807
batch 459, loss: 0.2841, instance_loss: 0.3326, weighted_loss: 0.2986, label: 1, bag_size: 504
batch 479, loss: 0.0001, instance_loss: 0.0638, weighted_loss: 0.0192, label: 4, bag_size: 157
batch 499, loss: 0.2230, instance_loss: 0.3462, weighted_loss: 0.2600, label: 0, bag_size: 962
batch 519, loss: 0.0004, instance_loss: 0.1274, weighted_loss: 0.0385, label: 4, bag_size: 137
batch 539, loss: 0.0002, instance_loss: 0.0221, weighted_loss: 0.0068, label: 4, bag_size: 167


class 0 clustering acc 0.9878899082568807: correct 21536/21800
class 1 clustering acc 0.46857798165137615: correct 2043/4360
Epoch: 23, train_loss: 0.3310, train_clustering_loss:  0.2860, train_error: 0.1229
class 0: acc 0.9363636363636364, correct 103/110
class 1: acc 0.7745098039215687, correct 79/102
class 2: acc 0.73, correct 73/100
class 3: acc 0.9454545454545454, correct 104/110
class 4: acc 0.967479674796748, correct 119/123

Val Set, val_loss: 1.0133, val_error: 0.3200, auc: 0.8944
class 0 clustering acc 0.983: correct 1966/2000
class 1 clustering acc 0.295: correct 118/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6818181818181818, correct 15/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0135, instance_loss: 0.0777, weighted_loss: 0.0328, label: 3, bag_size: 19
batch 39, loss: 0.0288, instance_loss: 0.2618, weighted_loss: 0.0987, label: 0, bag_size: 129
batch 59, loss: 0.0421, instance_loss: 0.1439, weighted_loss: 0.0726, label: 1, bag_size: 903
batch 79, loss: 0.1562, instance_loss: 0.2114, weighted_loss: 0.1728, label: 1, bag_size: 682
batch 99, loss: 0.0266, instance_loss: 0.0893, weighted_loss: 0.0454, label: 1, bag_size: 994
batch 119, loss: 0.0935, instance_loss: 0.1281, weighted_loss: 0.1039, label: 3, bag_size: 405
batch 139, loss: 0.0808, instance_loss: 0.3939, weighted_loss: 0.1747, label: 1, bag_size: 102
batch 159, loss: 0.0224, instance_loss: 0.4356, weighted_loss: 0.1463, label: 4, bag_size: 823
batch 179, loss: 0.0160, instance_loss: 0.1781, weighted_loss: 0.0646, label: 0, bag_size: 110
batch 199, loss: 0.2242, instance_loss: 0.3746, weighted_loss: 0.2694, label: 2, bag_size: 943
batch 219, loss: 0.0135, instance_loss: 0.3079, weighted_loss: 0.1018, label: 0, bag_size: 143
batch 239, loss: 0.1963, instance_loss: 0.4700, weighted_loss: 0.2784, label: 3, bag_size: 317
batch 259, loss: 0.0000, instance_loss: 0.0876, weighted_loss: 0.0263, label: 4, bag_size: 30
batch 279, loss: 0.2998, instance_loss: 0.2975, weighted_loss: 0.2991, label: 2, bag_size: 1133
batch 299, loss: 0.0782, instance_loss: 0.2607, weighted_loss: 0.1329, label: 4, bag_size: 26
batch 319, loss: 0.0154, instance_loss: 0.2134, weighted_loss: 0.0748, label: 0, bag_size: 1174
batch 339, loss: 0.0001, instance_loss: 0.0275, weighted_loss: 0.0083, label: 4, bag_size: 162
batch 359, loss: 0.0152, instance_loss: 0.0665, weighted_loss: 0.0306, label: 1, bag_size: 636
batch 379, loss: 0.0021, instance_loss: 0.0651, weighted_loss: 0.0210, label: 3, bag_size: 123
batch 399, loss: 0.0007, instance_loss: 0.1924, weighted_loss: 0.0582, label: 3, bag_size: 16
batch 419, loss: 2.2583, instance_loss: 0.5315, weighted_loss: 1.7403, label: 2, bag_size: 803
batch 439, loss: 0.1283, instance_loss: 0.2695, weighted_loss: 0.1707, label: 1, bag_size: 965
batch 459, loss: 0.1538, instance_loss: 0.2009, weighted_loss: 0.1680, label: 2, bag_size: 1348
batch 479, loss: 0.0010, instance_loss: 0.1850, weighted_loss: 0.0562, label: 4, bag_size: 24
batch 499, loss: 0.2568, instance_loss: 0.4902, weighted_loss: 0.3268, label: 1, bag_size: 786
batch 519, loss: 0.0027, instance_loss: 0.0433, weighted_loss: 0.0149, label: 0, bag_size: 1143
batch 539, loss: 0.0106, instance_loss: 0.0949, weighted_loss: 0.0359, label: 0, bag_size: 367


class 0 clustering acc 0.9865596330275229: correct 21507/21800
class 1 clustering acc 0.4901376146788991: correct 2137/4360
Epoch: 24, train_loss: 0.2462, train_clustering_loss:  0.2712, train_error: 0.0826
class 0: acc 0.9622641509433962, correct 102/106
class 1: acc 0.794392523364486, correct 85/107
class 2: acc 0.8974358974358975, correct 105/117
class 3: acc 0.954954954954955, correct 106/111
class 4: acc 0.9807692307692307, correct 102/104

Val Set, val_loss: 1.2480, val_error: 0.3800, auc: 0.8817
class 0 clustering acc 0.978: correct 1956/2000
class 1 clustering acc 0.295: correct 118/400
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5, correct 11/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.3822, instance_loss: 0.6963, weighted_loss: 1.1764, label: 3, bag_size: 281
batch 39, loss: 0.0024, instance_loss: 0.1217, weighted_loss: 0.0382, label: 4, bag_size: 128
batch 59, loss: 0.0015, instance_loss: 0.0619, weighted_loss: 0.0196, label: 3, bag_size: 48
batch 79, loss: 1.2762, instance_loss: 0.6158, weighted_loss: 1.0781, label: 2, bag_size: 959
batch 99, loss: 0.0205, instance_loss: 0.1182, weighted_loss: 0.0499, label: 1, bag_size: 1426
batch 119, loss: 0.0148, instance_loss: 0.1160, weighted_loss: 0.0452, label: 0, bag_size: 756
batch 139, loss: 0.0026, instance_loss: 0.1284, weighted_loss: 0.0404, label: 3, bag_size: 60
batch 159, loss: 0.0010, instance_loss: 0.0517, weighted_loss: 0.0162, label: 4, bag_size: 43
batch 179, loss: 0.0948, instance_loss: 0.0885, weighted_loss: 0.0929, label: 3, bag_size: 556
batch 199, loss: 0.0519, instance_loss: 0.1909, weighted_loss: 0.0936, label: 2, bag_size: 1058
batch 219, loss: 0.0907, instance_loss: 0.2209, weighted_loss: 0.1297, label: 2, bag_size: 701
batch 239, loss: 0.1199, instance_loss: 0.3601, weighted_loss: 0.1919, label: 2, bag_size: 750
batch 259, loss: 0.1507, instance_loss: 0.3539, weighted_loss: 0.2117, label: 2, bag_size: 2703
batch 279, loss: 0.0342, instance_loss: 0.3934, weighted_loss: 0.1420, label: 0, bag_size: 129
batch 299, loss: 0.4055, instance_loss: 0.2446, weighted_loss: 0.3572, label: 2, bag_size: 1050
batch 319, loss: 0.2529, instance_loss: 0.2651, weighted_loss: 0.2565, label: 0, bag_size: 200
batch 339, loss: 0.0013, instance_loss: 0.0629, weighted_loss: 0.0198, label: 4, bag_size: 125
batch 359, loss: 0.0640, instance_loss: 0.1300, weighted_loss: 0.0838, label: 1, bag_size: 965
batch 379, loss: 0.1077, instance_loss: 0.2290, weighted_loss: 0.1441, label: 2, bag_size: 317
batch 399, loss: 0.8033, instance_loss: 0.5049, weighted_loss: 0.7138, label: 1, bag_size: 1144
batch 419, loss: 0.0520, instance_loss: 0.2464, weighted_loss: 0.1103, label: 2, bag_size: 396
batch 439, loss: 0.2648, instance_loss: 0.2111, weighted_loss: 0.2487, label: 3, bag_size: 1399
batch 459, loss: 0.3467, instance_loss: 0.4253, weighted_loss: 0.3703, label: 4, bag_size: 817
batch 479, loss: 0.1184, instance_loss: 0.2239, weighted_loss: 0.1500, label: 2, bag_size: 1155
batch 499, loss: 0.6005, instance_loss: 0.4594, weighted_loss: 0.5582, label: 2, bag_size: 1150
batch 519, loss: 0.0136, instance_loss: 0.3617, weighted_loss: 0.1180, label: 0, bag_size: 122
batch 539, loss: 0.0577, instance_loss: 0.1956, weighted_loss: 0.0990, label: 4, bag_size: 1176


class 0 clustering acc 0.9873394495412844: correct 21524/21800
class 1 clustering acc 0.4928899082568807: correct 2149/4360
Epoch: 25, train_loss: 0.2663, train_clustering_loss:  0.2761, train_error: 0.0954
class 0: acc 0.954954954954955, correct 106/111
class 1: acc 0.7954545454545454, correct 70/88
class 2: acc 0.8571428571428571, correct 96/112
class 3: acc 0.9203539823008849, correct 104/113
class 4: acc 0.9669421487603306, correct 117/121

Val Set, val_loss: 1.1988, val_error: 0.2800, auc: 0.8599
class 0 clustering acc 0.9855: correct 1971/2000
class 1 clustering acc 0.34: correct 136/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.9090909090909091, correct 20/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 20 out of 20


batch 19, loss: 2.6868, instance_loss: 0.6730, weighted_loss: 2.0827, label: 0, bag_size: 423
batch 39, loss: 0.1630, instance_loss: 0.2915, weighted_loss: 0.2015, label: 0, bag_size: 437
batch 59, loss: 1.3032, instance_loss: 1.0541, weighted_loss: 1.2284, label: 2, bag_size: 319
batch 79, loss: 0.3669, instance_loss: 0.2860, weighted_loss: 0.3426, label: 0, bag_size: 736
batch 99, loss: 0.0134, instance_loss: 0.2222, weighted_loss: 0.0760, label: 4, bag_size: 1278
batch 119, loss: 2.0708, instance_loss: 0.4462, weighted_loss: 1.5834, label: 2, bag_size: 508
batch 139, loss: 0.0405, instance_loss: 0.1942, weighted_loss: 0.0866, label: 1, bag_size: 790
batch 159, loss: 0.0098, instance_loss: 0.1088, weighted_loss: 0.0395, label: 1, bag_size: 1261
batch 179, loss: 0.1706, instance_loss: 0.2732, weighted_loss: 0.2014, label: 2, bag_size: 907
batch 199, loss: 0.0053, instance_loss: 0.0555, weighted_loss: 0.0204, label: 0, bag_size: 933
batch 219, loss: 0.0125, instance_loss: 0.0665, weighted_loss: 0.0287, label: 3, bag_size: 63
batch 239, loss: 0.0045, instance_loss: 0.3060, weighted_loss: 0.0950, label: 1, bag_size: 1152
batch 259, loss: 2.4644, instance_loss: 0.8963, weighted_loss: 1.9939, label: 3, bag_size: 607
batch 279, loss: 0.0246, instance_loss: 0.6737, weighted_loss: 0.2193, label: 4, bag_size: 675
batch 299, loss: 0.0020, instance_loss: 0.1601, weighted_loss: 0.0494, label: 3, bag_size: 18
batch 319, loss: 0.0924, instance_loss: 0.2985, weighted_loss: 0.1542, label: 2, bag_size: 730
batch 339, loss: 0.0054, instance_loss: 0.0592, weighted_loss: 0.0216, label: 0, bag_size: 933
batch 359, loss: 0.0004, instance_loss: 0.1378, weighted_loss: 0.0416, label: 3, bag_size: 18
batch 379, loss: 0.0397, instance_loss: 0.1782, weighted_loss: 0.0812, label: 4, bag_size: 24
batch 399, loss: 0.1258, instance_loss: 0.3821, weighted_loss: 0.2027, label: 1, bag_size: 1646
batch 419, loss: 0.2978, instance_loss: 0.3844, weighted_loss: 0.3238, label: 0, bag_size: 432
batch 439, loss: 0.3252, instance_loss: 0.8256, weighted_loss: 0.4753, label: 3, bag_size: 211
batch 459, loss: 1.1025, instance_loss: 0.5126, weighted_loss: 0.9255, label: 2, bag_size: 1231
batch 479, loss: 0.0173, instance_loss: 0.0749, weighted_loss: 0.0346, label: 0, bag_size: 1196
batch 499, loss: 0.4323, instance_loss: 0.6333, weighted_loss: 0.4926, label: 2, bag_size: 636
batch 519, loss: 0.1710, instance_loss: 0.8748, weighted_loss: 0.3821, label: 3, bag_size: 211
batch 539, loss: 0.6967, instance_loss: 0.3588, weighted_loss: 0.5953, label: 4, bag_size: 590


class 0 clustering acc 0.9899082568807339: correct 21580/21800
class 1 clustering acc 0.4701834862385321: correct 2050/4360
Epoch: 26, train_loss: 0.2768, train_clustering_loss:  0.2776, train_error: 0.0936
class 0: acc 0.975, correct 117/120
class 1: acc 0.74, correct 74/100
class 2: acc 0.8584905660377359, correct 91/106
class 3: acc 0.9611650485436893, correct 99/103
class 4: acc 0.9741379310344828, correct 113/116

Val Set, val_loss: 1.1197, val_error: 0.3400, auc: 0.8817
class 0 clustering acc 0.987: correct 1974/2000
class 1 clustering acc 0.2575: correct 103/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7272727272727273, correct 16/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.7829, instance_loss: 0.4460, weighted_loss: 0.6818, label: 2, bag_size: 738
batch 39, loss: 0.2970, instance_loss: 0.9390, weighted_loss: 0.4896, label: 3, bag_size: 1380
batch 59, loss: 1.5176, instance_loss: 0.5840, weighted_loss: 1.2376, label: 1, bag_size: 1144
batch 79, loss: 0.0994, instance_loss: 0.4966, weighted_loss: 0.2185, label: 0, bag_size: 136
batch 99, loss: 0.0087, instance_loss: 0.2169, weighted_loss: 0.0712, label: 0, bag_size: 129
batch 119, loss: 0.1273, instance_loss: 0.3431, weighted_loss: 0.1920, label: 0, bag_size: 800
batch 139, loss: 0.1677, instance_loss: 0.2421, weighted_loss: 0.1900, label: 2, bag_size: 1053
batch 159, loss: 0.6231, instance_loss: 0.4004, weighted_loss: 0.5563, label: 2, bag_size: 632
batch 179, loss: 0.1453, instance_loss: 0.2263, weighted_loss: 0.1696, label: 1, bag_size: 320
batch 199, loss: 0.0024, instance_loss: 0.1729, weighted_loss: 0.0536, label: 3, bag_size: 16
batch 219, loss: 2.5266, instance_loss: 0.5849, weighted_loss: 1.9441, label: 1, bag_size: 700
batch 239, loss: 0.0000, instance_loss: 0.0279, weighted_loss: 0.0084, label: 4, bag_size: 112
batch 259, loss: 0.0048, instance_loss: 0.0516, weighted_loss: 0.0188, label: 0, bag_size: 1235
batch 279, loss: 0.0115, instance_loss: 0.3835, weighted_loss: 0.1231, label: 3, bag_size: 936
batch 299, loss: 0.0478, instance_loss: 0.0631, weighted_loss: 0.0524, label: 3, bag_size: 32
batch 319, loss: 0.7585, instance_loss: 0.3508, weighted_loss: 0.6362, label: 1, bag_size: 968
batch 339, loss: 0.5160, instance_loss: 0.3661, weighted_loss: 0.4710, label: 0, bag_size: 1257
batch 359, loss: 0.8993, instance_loss: 0.4343, weighted_loss: 0.7598, label: 3, bag_size: 697
batch 379, loss: 0.7687, instance_loss: 0.3580, weighted_loss: 0.6454, label: 0, bag_size: 1289
batch 399, loss: 0.0235, instance_loss: 0.1116, weighted_loss: 0.0499, label: 1, bag_size: 994
batch 419, loss: 0.0229, instance_loss: 0.1115, weighted_loss: 0.0495, label: 0, bag_size: 1061
batch 439, loss: 0.0478, instance_loss: 0.5396, weighted_loss: 0.1953, label: 2, bag_size: 571
batch 459, loss: 0.1162, instance_loss: 0.2005, weighted_loss: 0.1415, label: 0, bag_size: 800
batch 479, loss: 0.0082, instance_loss: 0.1909, weighted_loss: 0.0630, label: 3, bag_size: 18
batch 499, loss: 0.0279, instance_loss: 0.0550, weighted_loss: 0.0360, label: 1, bag_size: 1191
batch 519, loss: 0.0023, instance_loss: 0.0889, weighted_loss: 0.0283, label: 3, bag_size: 60
batch 539, loss: 0.8717, instance_loss: 0.4618, weighted_loss: 0.7488, label: 1, bag_size: 917


class 0 clustering acc 0.9872477064220183: correct 21522/21800
class 1 clustering acc 0.49655963302752293: correct 2165/4360
Epoch: 27, train_loss: 0.2777, train_clustering_loss:  0.2754, train_error: 0.0972
class 0: acc 0.9375, correct 105/112
class 1: acc 0.8294573643410853, correct 107/129
class 2: acc 0.8383838383838383, correct 83/99
class 3: acc 0.9464285714285714, correct 106/112
class 4: acc 0.978494623655914, correct 91/93

Val Set, val_loss: 1.1795, val_error: 0.3200, auc: 0.8856
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.2675: correct 107/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6818181818181818, correct 15/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 22 out of 20


batch 19, loss: 1.3332, instance_loss: 0.4403, weighted_loss: 1.0654, label: 1, bag_size: 1197
batch 39, loss: 0.2421, instance_loss: 0.2880, weighted_loss: 0.2559, label: 1, bag_size: 1014
batch 59, loss: 0.0005, instance_loss: 0.0377, weighted_loss: 0.0116, label: 4, bag_size: 110
batch 79, loss: 0.3873, instance_loss: 0.3965, weighted_loss: 0.3901, label: 0, bag_size: 653
batch 99, loss: 0.0005, instance_loss: 0.0849, weighted_loss: 0.0258, label: 4, bag_size: 48
batch 119, loss: 0.2967, instance_loss: 0.5783, weighted_loss: 0.3811, label: 2, bag_size: 916
batch 139, loss: 0.0108, instance_loss: 0.2722, weighted_loss: 0.0892, label: 0, bag_size: 114
batch 159, loss: 0.0008, instance_loss: 0.0754, weighted_loss: 0.0232, label: 1, bag_size: 1376
batch 179, loss: 0.6780, instance_loss: 0.5854, weighted_loss: 0.6502, label: 2, bag_size: 323
batch 199, loss: 0.1944, instance_loss: 0.6750, weighted_loss: 0.3386, label: 1, bag_size: 293
batch 219, loss: 0.0091, instance_loss: 0.3466, weighted_loss: 0.1104, label: 0, bag_size: 163
batch 239, loss: 0.0437, instance_loss: 0.4716, weighted_loss: 0.1721, label: 3, bag_size: 936
batch 259, loss: 0.0069, instance_loss: 0.6886, weighted_loss: 0.2114, label: 3, bag_size: 1167
batch 279, loss: 0.0041, instance_loss: 0.0323, weighted_loss: 0.0125, label: 4, bag_size: 112
batch 299, loss: 0.1192, instance_loss: 0.1557, weighted_loss: 0.1301, label: 0, bag_size: 200
batch 319, loss: 0.1948, instance_loss: 0.6242, weighted_loss: 0.3236, label: 1, bag_size: 1390
batch 339, loss: 0.0211, instance_loss: 0.1648, weighted_loss: 0.0642, label: 0, bag_size: 759
batch 359, loss: 0.1980, instance_loss: 0.1425, weighted_loss: 0.1814, label: 0, bag_size: 1247
batch 379, loss: 0.0120, instance_loss: 0.1870, weighted_loss: 0.0645, label: 2, bag_size: 1788
batch 399, loss: 0.0148, instance_loss: 0.0786, weighted_loss: 0.0339, label: 1, bag_size: 938
batch 419, loss: 0.0789, instance_loss: 0.2507, weighted_loss: 0.1304, label: 2, bag_size: 638
batch 439, loss: 0.6767, instance_loss: 0.3766, weighted_loss: 0.5867, label: 3, bag_size: 343
batch 459, loss: 0.3582, instance_loss: 0.3289, weighted_loss: 0.3494, label: 2, bag_size: 1039
batch 479, loss: 0.0102, instance_loss: 0.1769, weighted_loss: 0.0602, label: 0, bag_size: 731
batch 499, loss: 0.5612, instance_loss: 0.4113, weighted_loss: 0.5162, label: 1, bag_size: 1724
batch 519, loss: 0.5825, instance_loss: 0.3453, weighted_loss: 0.5114, label: 2, bag_size: 684
batch 539, loss: 0.1840, instance_loss: 0.2447, weighted_loss: 0.2022, label: 3, bag_size: 706


class 0 clustering acc 0.9891743119266055: correct 21564/21800
class 1 clustering acc 0.5016055045871559: correct 2187/4360
Epoch: 28, train_loss: 0.1989, train_clustering_loss:  0.2628, train_error: 0.0679
class 0: acc 0.9607843137254902, correct 98/102
class 1: acc 0.8990825688073395, correct 98/109
class 2: acc 0.8407079646017699, correct 95/113
class 3: acc 0.9734513274336283, correct 110/113
class 4: acc 0.9907407407407407, correct 107/108

Val Set, val_loss: 1.1742, val_error: 0.2800, auc: 0.8840
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.3475: correct 139/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7727272727272727, correct 17/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0091, instance_loss: 0.1457, weighted_loss: 0.0501, label: 0, bag_size: 921
batch 39, loss: 0.5273, instance_loss: 0.4632, weighted_loss: 0.5081, label: 2, bag_size: 1024
batch 59, loss: 0.3824, instance_loss: 0.3372, weighted_loss: 0.3688, label: 1, bag_size: 405
batch 79, loss: 0.4991, instance_loss: 0.3196, weighted_loss: 0.4452, label: 0, bag_size: 912
batch 99, loss: 0.0591, instance_loss: 0.2161, weighted_loss: 0.1062, label: 2, bag_size: 421
batch 119, loss: 0.9871, instance_loss: 0.5575, weighted_loss: 0.8582, label: 0, bag_size: 801
batch 139, loss: 0.0586, instance_loss: 0.3986, weighted_loss: 0.1606, label: 4, bag_size: 817
batch 159, loss: 0.0298, instance_loss: 0.3072, weighted_loss: 0.1130, label: 0, bag_size: 143
batch 179, loss: 0.0003, instance_loss: 0.0346, weighted_loss: 0.0106, label: 4, bag_size: 150
batch 199, loss: 0.7667, instance_loss: 0.5961, weighted_loss: 0.7155, label: 1, bag_size: 1376
batch 219, loss: 0.0042, instance_loss: 0.0905, weighted_loss: 0.0301, label: 4, bag_size: 101
batch 239, loss: 0.0271, instance_loss: 0.2759, weighted_loss: 0.1017, label: 3, bag_size: 1253
batch 259, loss: 0.0252, instance_loss: 0.1816, weighted_loss: 0.0721, label: 0, bag_size: 1247
batch 279, loss: 0.1251, instance_loss: 0.3115, weighted_loss: 0.1810, label: 1, bag_size: 348
batch 299, loss: 0.0010, instance_loss: 0.0786, weighted_loss: 0.0243, label: 3, bag_size: 28
batch 319, loss: 0.0003, instance_loss: 0.0280, weighted_loss: 0.0086, label: 4, bag_size: 110
batch 339, loss: 0.0749, instance_loss: 0.1811, weighted_loss: 0.1068, label: 1, bag_size: 847
batch 359, loss: 0.0003, instance_loss: 0.0135, weighted_loss: 0.0043, label: 4, bag_size: 174
batch 379, loss: 0.0019, instance_loss: 0.1657, weighted_loss: 0.0510, label: 3, bag_size: 87
batch 399, loss: 0.0454, instance_loss: 0.2178, weighted_loss: 0.0971, label: 2, bag_size: 910
batch 419, loss: 0.0033, instance_loss: 0.1088, weighted_loss: 0.0350, label: 3, bag_size: 27
batch 439, loss: 0.5170, instance_loss: 0.0971, weighted_loss: 0.3910, label: 4, bag_size: 101
batch 459, loss: 0.0164, instance_loss: 0.1003, weighted_loss: 0.0416, label: 3, bag_size: 18
batch 479, loss: 0.0001, instance_loss: 0.0401, weighted_loss: 0.0121, label: 4, bag_size: 40
batch 499, loss: 0.1147, instance_loss: 0.1923, weighted_loss: 0.1380, label: 2, bag_size: 461
batch 519, loss: 0.4326, instance_loss: 0.3649, weighted_loss: 0.4123, label: 2, bag_size: 1133
batch 539, loss: 0.1384, instance_loss: 0.2897, weighted_loss: 0.1838, label: 2, bag_size: 1180


class 0 clustering acc 0.9873853211009175: correct 21525/21800
class 1 clustering acc 0.5029816513761468: correct 2193/4360
Epoch: 29, train_loss: 0.2423, train_clustering_loss:  0.2705, train_error: 0.0899
class 0: acc 0.9345794392523364, correct 100/107
class 1: acc 0.8, correct 80/100
class 2: acc 0.8613861386138614, correct 87/101
class 3: acc 0.9532710280373832, correct 102/107
class 4: acc 0.9769230769230769, correct 127/130

Val Set, val_loss: 1.1084, val_error: 0.3600, auc: 0.8886
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.3175: correct 127/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.7272727272727273, correct 16/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0029, instance_loss: 0.0244, weighted_loss: 0.0094, label: 4, bag_size: 119
batch 39, loss: 0.8372, instance_loss: 0.3744, weighted_loss: 0.6984, label: 0, bag_size: 1527
batch 59, loss: 0.0830, instance_loss: 0.3156, weighted_loss: 0.1528, label: 0, bag_size: 432
batch 79, loss: 0.3138, instance_loss: 0.2924, weighted_loss: 0.3074, label: 2, bag_size: 357
batch 99, loss: 0.0254, instance_loss: 0.2007, weighted_loss: 0.0780, label: 0, bag_size: 800
batch 119, loss: 0.0183, instance_loss: 0.1413, weighted_loss: 0.0552, label: 3, bag_size: 1172
batch 139, loss: 0.1913, instance_loss: 0.2688, weighted_loss: 0.2145, label: 2, bag_size: 391
batch 159, loss: 0.0008, instance_loss: 0.3267, weighted_loss: 0.0986, label: 4, bag_size: 974
batch 179, loss: 0.0226, instance_loss: 0.1089, weighted_loss: 0.0485, label: 0, bag_size: 1196
batch 199, loss: 0.0033, instance_loss: 0.0550, weighted_loss: 0.0188, label: 0, bag_size: 518
batch 219, loss: 0.2294, instance_loss: 0.3746, weighted_loss: 0.2729, label: 2, bag_size: 1141
batch 239, loss: 0.2287, instance_loss: 0.4603, weighted_loss: 0.2982, label: 0, bag_size: 868
batch 259, loss: 0.0016, instance_loss: 0.0424, weighted_loss: 0.0138, label: 4, bag_size: 211
batch 279, loss: 0.3388, instance_loss: 0.4299, weighted_loss: 0.3661, label: 3, bag_size: 821
batch 299, loss: 0.0003, instance_loss: 0.0181, weighted_loss: 0.0056, label: 0, bag_size: 1599
batch 319, loss: 0.7036, instance_loss: 0.7148, weighted_loss: 0.7069, label: 0, bag_size: 423
batch 339, loss: 0.0006, instance_loss: 0.1146, weighted_loss: 0.0348, label: 4, bag_size: 790
batch 359, loss: 0.0001, instance_loss: 0.1041, weighted_loss: 0.0313, label: 4, bag_size: 134
batch 379, loss: 0.0003, instance_loss: 0.0398, weighted_loss: 0.0121, label: 4, bag_size: 130
batch 399, loss: 0.6614, instance_loss: 0.2949, weighted_loss: 0.5515, label: 2, bag_size: 828
batch 419, loss: 0.0567, instance_loss: 0.3457, weighted_loss: 0.1434, label: 2, bag_size: 1167
batch 439, loss: 0.1141, instance_loss: 0.2687, weighted_loss: 0.1605, label: 2, bag_size: 725
batch 459, loss: 0.0064, instance_loss: 0.3321, weighted_loss: 0.1042, label: 4, bag_size: 1357
batch 479, loss: 0.1348, instance_loss: 0.1979, weighted_loss: 0.1537, label: 2, bag_size: 701
batch 499, loss: 0.0843, instance_loss: 0.4649, weighted_loss: 0.1984, label: 0, bag_size: 423
batch 519, loss: 0.0068, instance_loss: 0.2590, weighted_loss: 0.0824, label: 0, bag_size: 118
batch 539, loss: 0.0016, instance_loss: 0.0916, weighted_loss: 0.0286, label: 3, bag_size: 43


class 0 clustering acc 0.9887614678899083: correct 21555/21800
class 1 clustering acc 0.4873853211009174: correct 2125/4360
Epoch: 30, train_loss: 0.2424, train_clustering_loss:  0.2708, train_error: 0.0789
class 0: acc 0.9824561403508771, correct 112/114
class 1: acc 0.7731958762886598, correct 75/97
class 2: acc 0.896, correct 112/125
class 3: acc 0.96875, correct 93/96
class 4: acc 0.9734513274336283, correct 110/113

Val Set, val_loss: 1.1272, val_error: 0.3000, auc: 0.8845
class 0 clustering acc 0.986: correct 1972/2000
class 1 clustering acc 0.3425: correct 137/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8181818181818182, correct 18/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0477, instance_loss: 0.1441, weighted_loss: 0.0766, label: 3, bag_size: 451
batch 39, loss: 0.0009, instance_loss: 0.3091, weighted_loss: 0.0933, label: 4, bag_size: 636
batch 59, loss: 0.0859, instance_loss: 0.2955, weighted_loss: 0.1488, label: 0, bag_size: 759
batch 79, loss: 0.2793, instance_loss: 0.2249, weighted_loss: 0.2630, label: 2, bag_size: 1123
batch 99, loss: 0.0018, instance_loss: 0.0854, weighted_loss: 0.0269, label: 4, bag_size: 55
batch 119, loss: 0.0346, instance_loss: 0.2446, weighted_loss: 0.0976, label: 0, bag_size: 472
batch 139, loss: 0.0001, instance_loss: 0.0738, weighted_loss: 0.0222, label: 4, bag_size: 23
batch 159, loss: 0.0690, instance_loss: 0.4203, weighted_loss: 0.1744, label: 1, bag_size: 949
batch 179, loss: 0.4315, instance_loss: 0.2713, weighted_loss: 0.3834, label: 2, bag_size: 265
batch 199, loss: 0.2862, instance_loss: 0.5867, weighted_loss: 0.3764, label: 0, bag_size: 255
batch 219, loss: 0.0248, instance_loss: 0.1119, weighted_loss: 0.0509, label: 0, bag_size: 1517
batch 239, loss: 0.0005, instance_loss: 0.0555, weighted_loss: 0.0170, label: 4, bag_size: 140
batch 259, loss: 0.1957, instance_loss: 0.3528, weighted_loss: 0.2429, label: 3, bag_size: 343
batch 279, loss: 0.0007, instance_loss: 0.1502, weighted_loss: 0.0455, label: 3, bag_size: 18
batch 299, loss: 0.0424, instance_loss: 0.3000, weighted_loss: 0.1197, label: 0, bag_size: 371
batch 319, loss: 0.0118, instance_loss: 0.0963, weighted_loss: 0.0371, label: 0, bag_size: 340
batch 339, loss: 0.0001, instance_loss: 0.0442, weighted_loss: 0.0133, label: 4, bag_size: 128
batch 359, loss: 0.1467, instance_loss: 0.6903, weighted_loss: 0.3098, label: 1, bag_size: 293
batch 379, loss: 1.7400, instance_loss: 0.6937, weighted_loss: 1.4261, label: 2, bag_size: 1231
batch 399, loss: 0.3711, instance_loss: 0.3785, weighted_loss: 0.3733, label: 3, bag_size: 841
batch 419, loss: 0.1474, instance_loss: 0.2463, weighted_loss: 0.1771, label: 2, bag_size: 1218
batch 439, loss: 0.0028, instance_loss: 0.1894, weighted_loss: 0.0588, label: 3, bag_size: 15
batch 459, loss: 0.0984, instance_loss: 0.2414, weighted_loss: 0.1413, label: 1, bag_size: 897
batch 479, loss: 0.0254, instance_loss: 0.1874, weighted_loss: 0.0740, label: 4, bag_size: 24
batch 499, loss: 0.0586, instance_loss: 0.3078, weighted_loss: 0.1334, label: 2, bag_size: 1128
batch 519, loss: 0.0034, instance_loss: 0.0699, weighted_loss: 0.0234, label: 0, bag_size: 653
batch 539, loss: 0.2919, instance_loss: 0.4221, weighted_loss: 0.3309, label: 0, bag_size: 423


class 0 clustering acc 0.9871100917431193: correct 21519/21800
class 1 clustering acc 0.5295871559633027: correct 2309/4360
Epoch: 31, train_loss: 0.1772, train_clustering_loss:  0.2597, train_error: 0.0440
class 0: acc 1.0, correct 107/107
class 1: acc 0.8918918918918919, correct 99/111
class 2: acc 0.926605504587156, correct 101/109
class 3: acc 0.9809523809523809, correct 103/105
class 4: acc 0.9823008849557522, correct 111/113

Val Set, val_loss: 1.1939, val_error: 0.3800, auc: 0.8792
class 0 clustering acc 0.973: correct 1946/2000
class 1 clustering acc 0.3625: correct 145/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.5909090909090909, correct 13/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0826, weighted_loss: 0.0249, label: 3, bag_size: 123
batch 39, loss: 0.1012, instance_loss: 0.2330, weighted_loss: 0.1407, label: 0, bag_size: 294
batch 59, loss: 0.0049, instance_loss: 0.1068, weighted_loss: 0.0355, label: 3, bag_size: 28
batch 79, loss: 0.3409, instance_loss: 0.3360, weighted_loss: 0.3395, label: 1, bag_size: 968
batch 99, loss: 1.7385, instance_loss: 0.6474, weighted_loss: 1.4111, label: 2, bag_size: 629
batch 119, loss: 0.0152, instance_loss: 0.0602, weighted_loss: 0.0287, label: 1, bag_size: 1191
batch 139, loss: 0.1042, instance_loss: 0.1669, weighted_loss: 0.1230, label: 2, bag_size: 314
batch 159, loss: 0.1672, instance_loss: 0.2433, weighted_loss: 0.1900, label: 0, bag_size: 432
batch 179, loss: 0.0559, instance_loss: 0.7648, weighted_loss: 0.2686, label: 4, bag_size: 882
batch 199, loss: 0.2992, instance_loss: 0.5782, weighted_loss: 0.3829, label: 0, bag_size: 255
batch 219, loss: 0.0226, instance_loss: 0.0582, weighted_loss: 0.0333, label: 3, bag_size: 43
batch 239, loss: 0.5172, instance_loss: 0.5057, weighted_loss: 0.5137, label: 1, bag_size: 1144
batch 259, loss: 0.3187, instance_loss: 0.3371, weighted_loss: 0.3242, label: 2, bag_size: 682
batch 279, loss: 0.1134, instance_loss: 0.2341, weighted_loss: 0.1496, label: 2, bag_size: 499
batch 299, loss: 0.0011, instance_loss: 0.0217, weighted_loss: 0.0073, label: 4, bag_size: 211
batch 319, loss: 0.0036, instance_loss: 0.1202, weighted_loss: 0.0386, label: 3, bag_size: 75
batch 339, loss: 0.0001, instance_loss: 0.0959, weighted_loss: 0.0289, label: 4, bag_size: 24
batch 359, loss: 0.0001, instance_loss: 0.2231, weighted_loss: 0.0670, label: 3, bag_size: 16
batch 379, loss: 0.2359, instance_loss: 0.6002, weighted_loss: 0.3452, label: 2, bag_size: 655
batch 399, loss: 0.2374, instance_loss: 0.2799, weighted_loss: 0.2502, label: 0, bag_size: 912
batch 419, loss: 0.0362, instance_loss: 0.1309, weighted_loss: 0.0646, label: 1, bag_size: 534
batch 439, loss: 0.0040, instance_loss: 0.1256, weighted_loss: 0.0404, label: 3, bag_size: 34
batch 459, loss: 0.7788, instance_loss: 0.4944, weighted_loss: 0.6934, label: 3, bag_size: 1019
batch 479, loss: 0.2108, instance_loss: 0.2376, weighted_loss: 0.2188, label: 2, bag_size: 701
batch 499, loss: 0.1143, instance_loss: 0.3212, weighted_loss: 0.1763, label: 1, bag_size: 1144
batch 519, loss: 0.0453, instance_loss: 0.4747, weighted_loss: 0.1741, label: 1, bag_size: 818
batch 539, loss: 0.0265, instance_loss: 0.3637, weighted_loss: 0.1277, label: 2, bag_size: 408


class 0 clustering acc 0.986697247706422: correct 21510/21800
class 1 clustering acc 0.521559633027523: correct 2274/4360
Epoch: 32, train_loss: 0.1946, train_clustering_loss:  0.2643, train_error: 0.0606
class 0: acc 0.9537037037037037, correct 103/108
class 1: acc 0.839622641509434, correct 89/106
class 2: acc 0.9344262295081968, correct 114/122
class 3: acc 0.9795918367346939, correct 96/98
class 4: acc 0.990990990990991, correct 110/111

Val Set, val_loss: 1.2310, val_error: 0.2800, auc: 0.8748
class 0 clustering acc 0.9745: correct 1949/2000
class 1 clustering acc 0.4: correct 160/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8636363636363636, correct 19/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0328, instance_loss: 0.3802, weighted_loss: 0.1370, label: 3, bag_size: 451
batch 39, loss: 0.0904, instance_loss: 0.2750, weighted_loss: 0.1458, label: 0, bag_size: 424
batch 59, loss: 0.0007, instance_loss: 0.1079, weighted_loss: 0.0328, label: 4, bag_size: 524
batch 79, loss: 0.0012, instance_loss: 0.1445, weighted_loss: 0.0441, label: 4, bag_size: 1278
batch 99, loss: 0.0006, instance_loss: 0.0465, weighted_loss: 0.0143, label: 4, bag_size: 88
batch 119, loss: 0.3089, instance_loss: 0.3930, weighted_loss: 0.3341, label: 2, bag_size: 868
batch 139, loss: 0.0121, instance_loss: 0.0653, weighted_loss: 0.0281, label: 1, bag_size: 1261
batch 159, loss: 0.2235, instance_loss: 0.3325, weighted_loss: 0.2562, label: 2, bag_size: 1050
batch 179, loss: 0.0017, instance_loss: 0.0870, weighted_loss: 0.0273, label: 1, bag_size: 636
batch 199, loss: 0.0433, instance_loss: 0.0500, weighted_loss: 0.0453, label: 3, bag_size: 1559
batch 219, loss: 0.0178, instance_loss: 0.2473, weighted_loss: 0.0866, label: 4, bag_size: 711
batch 239, loss: 0.9651, instance_loss: 0.7216, weighted_loss: 0.8921, label: 2, bag_size: 3236
batch 259, loss: 0.5128, instance_loss: 0.4836, weighted_loss: 0.5040, label: 0, bag_size: 1257
batch 279, loss: 0.1053, instance_loss: 0.2170, weighted_loss: 0.1389, label: 2, bag_size: 1289
batch 299, loss: 0.6849, instance_loss: 0.5388, weighted_loss: 0.6411, label: 1, bag_size: 535
batch 319, loss: 0.0013, instance_loss: 0.0579, weighted_loss: 0.0183, label: 4, bag_size: 51
batch 339, loss: 0.0010, instance_loss: 0.3920, weighted_loss: 0.1183, label: 4, bag_size: 1002
batch 359, loss: 0.0012, instance_loss: 0.1177, weighted_loss: 0.0361, label: 4, bag_size: 39
batch 379, loss: 0.0110, instance_loss: 0.2001, weighted_loss: 0.0677, label: 0, bag_size: 116
batch 399, loss: 0.0075, instance_loss: 0.0949, weighted_loss: 0.0337, label: 3, bag_size: 24
batch 419, loss: 0.0440, instance_loss: 0.1876, weighted_loss: 0.0871, label: 1, bag_size: 1127
batch 439, loss: 0.0003, instance_loss: 0.1042, weighted_loss: 0.0315, label: 4, bag_size: 107
batch 459, loss: 0.0757, instance_loss: 0.3052, weighted_loss: 0.1445, label: 2, bag_size: 638
batch 479, loss: 0.0051, instance_loss: 0.2597, weighted_loss: 0.0815, label: 3, bag_size: 24
batch 499, loss: 0.3828, instance_loss: 0.4936, weighted_loss: 0.4160, label: 1, bag_size: 770
batch 519, loss: 0.0072, instance_loss: 0.1769, weighted_loss: 0.0581, label: 0, bag_size: 1235
batch 539, loss: 0.0006, instance_loss: 0.0878, weighted_loss: 0.0267, label: 4, bag_size: 79


class 0 clustering acc 0.9872018348623853: correct 21521/21800
class 1 clustering acc 0.5440366972477064: correct 2372/4360
Epoch: 33, train_loss: 0.1827, train_clustering_loss:  0.2541, train_error: 0.0587
class 0: acc 0.9583333333333334, correct 92/96
class 1: acc 0.8571428571428571, correct 78/91
class 2: acc 0.8979591836734694, correct 88/98
class 3: acc 0.9849624060150376, correct 131/133
class 4: acc 0.9763779527559056, correct 124/127

Val Set, val_loss: 1.1594, val_error: 0.3400, auc: 0.8886
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.3875: correct 155/400
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8181818181818182, correct 18/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0013, instance_loss: 0.0225, weighted_loss: 0.0076, label: 3, bag_size: 31
batch 39, loss: 0.0143, instance_loss: 0.1750, weighted_loss: 0.0625, label: 3, bag_size: 21
batch 59, loss: 0.0261, instance_loss: 0.1976, weighted_loss: 0.0775, label: 0, bag_size: 367
batch 79, loss: 0.6835, instance_loss: 0.4547, weighted_loss: 0.6148, label: 2, bag_size: 471
batch 99, loss: 0.0179, instance_loss: 0.1858, weighted_loss: 0.0683, label: 0, bag_size: 515
batch 119, loss: 0.1566, instance_loss: 0.5303, weighted_loss: 0.2687, label: 0, bag_size: 1257
batch 139, loss: 0.0029, instance_loss: 0.0448, weighted_loss: 0.0154, label: 3, bag_size: 29
batch 159, loss: 0.0009, instance_loss: 0.0546, weighted_loss: 0.0170, label: 4, bag_size: 140
batch 179, loss: 0.2208, instance_loss: 0.3162, weighted_loss: 0.2495, label: 1, bag_size: 348
batch 199, loss: 0.0080, instance_loss: 0.1277, weighted_loss: 0.0439, label: 3, bag_size: 18
batch 219, loss: 0.0001, instance_loss: 0.0465, weighted_loss: 0.0140, label: 4, bag_size: 157
batch 239, loss: 0.5462, instance_loss: 0.5413, weighted_loss: 0.5447, label: 0, bag_size: 255
batch 259, loss: 0.0007, instance_loss: 0.0859, weighted_loss: 0.0262, label: 3, bag_size: 28
batch 279, loss: 0.0061, instance_loss: 0.0802, weighted_loss: 0.0283, label: 4, bag_size: 130
batch 299, loss: 0.0833, instance_loss: 0.4877, weighted_loss: 0.2046, label: 4, bag_size: 1360
batch 319, loss: 0.0218, instance_loss: 0.1999, weighted_loss: 0.0752, label: 0, bag_size: 1196
batch 339, loss: 0.1103, instance_loss: 0.2304, weighted_loss: 0.1463, label: 2, bag_size: 252
batch 359, loss: 0.0262, instance_loss: 0.0917, weighted_loss: 0.0459, label: 0, bag_size: 807
batch 379, loss: 0.3853, instance_loss: 0.4054, weighted_loss: 0.3914, label: 1, bag_size: 1144
batch 399, loss: 0.0095, instance_loss: 0.0455, weighted_loss: 0.0203, label: 3, bag_size: 43
batch 419, loss: 0.1128, instance_loss: 0.2864, weighted_loss: 0.1649, label: 3, bag_size: 360
batch 439, loss: 0.0637, instance_loss: 0.5462, weighted_loss: 0.2084, label: 1, bag_size: 700
batch 459, loss: 0.0268, instance_loss: 0.0898, weighted_loss: 0.0457, label: 1, bag_size: 1191
batch 479, loss: 0.0223, instance_loss: 0.3698, weighted_loss: 0.1266, label: 3, bag_size: 317
batch 499, loss: 0.0013, instance_loss: 0.1592, weighted_loss: 0.0487, label: 0, bag_size: 122
batch 519, loss: 0.0037, instance_loss: 0.0527, weighted_loss: 0.0184, label: 3, bag_size: 54
batch 539, loss: 0.0004, instance_loss: 0.0744, weighted_loss: 0.0226, label: 0, bag_size: 148


class 0 clustering acc 0.9869266055045871: correct 21515/21800
class 1 clustering acc 0.5380733944954128: correct 2346/4360
Epoch: 34, train_loss: 0.1995, train_clustering_loss:  0.2527, train_error: 0.0642
class 0: acc 0.9705882352941176, correct 99/102
class 1: acc 0.8673469387755102, correct 85/98
class 2: acc 0.8712871287128713, correct 88/101
class 3: acc 0.9774436090225563, correct 130/133
class 4: acc 0.972972972972973, correct 108/111

Val Set, val_loss: 1.2226, val_error: 0.3800, auc: 0.8821
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.2925: correct 117/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.5909090909090909, correct 13/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0234, instance_loss: 0.5048, weighted_loss: 0.1678, label: 4, bag_size: 533
batch 39, loss: 0.0107, instance_loss: 0.2084, weighted_loss: 0.0700, label: 0, bag_size: 371
batch 59, loss: 0.1263, instance_loss: 0.1214, weighted_loss: 0.1249, label: 3, bag_size: 18
batch 79, loss: 0.0083, instance_loss: 0.0175, weighted_loss: 0.0111, label: 4, bag_size: 86
batch 99, loss: 0.2844, instance_loss: 0.2744, weighted_loss: 0.2814, label: 3, bag_size: 821
batch 119, loss: 0.0070, instance_loss: 0.0392, weighted_loss: 0.0167, label: 3, bag_size: 41
batch 139, loss: 0.0340, instance_loss: 0.0782, weighted_loss: 0.0473, label: 1, bag_size: 369
batch 159, loss: 0.0293, instance_loss: 0.2198, weighted_loss: 0.0864, label: 0, bag_size: 630
batch 179, loss: 0.0481, instance_loss: 0.1834, weighted_loss: 0.0887, label: 0, bag_size: 410
batch 199, loss: 1.0084, instance_loss: 0.5431, weighted_loss: 0.8688, label: 1, bag_size: 657
batch 219, loss: 0.0001, instance_loss: 0.0559, weighted_loss: 0.0169, label: 4, bag_size: 211
batch 239, loss: 0.1774, instance_loss: 0.3353, weighted_loss: 0.2248, label: 2, bag_size: 809
batch 259, loss: 0.0001, instance_loss: 0.0206, weighted_loss: 0.0062, label: 4, bag_size: 167
batch 279, loss: 0.0256, instance_loss: 0.1582, weighted_loss: 0.0654, label: 1, bag_size: 790
batch 299, loss: 0.1158, instance_loss: 0.6270, weighted_loss: 0.2692, label: 2, bag_size: 1439
batch 319, loss: 0.0001, instance_loss: 0.1137, weighted_loss: 0.0342, label: 3, bag_size: 94
batch 339, loss: 0.0130, instance_loss: 0.1744, weighted_loss: 0.0614, label: 0, bag_size: 1517
batch 359, loss: 0.0002, instance_loss: 0.0319, weighted_loss: 0.0097, label: 4, bag_size: 148
batch 379, loss: 0.0132, instance_loss: 0.2341, weighted_loss: 0.0795, label: 0, bag_size: 129
batch 399, loss: 1.0714, instance_loss: 0.7658, weighted_loss: 0.9797, label: 2, bag_size: 934
batch 419, loss: 0.0246, instance_loss: 0.2162, weighted_loss: 0.0821, label: 0, bag_size: 118
batch 439, loss: 0.0017, instance_loss: 0.1295, weighted_loss: 0.0400, label: 4, bag_size: 20
batch 459, loss: 0.1095, instance_loss: 0.2619, weighted_loss: 0.1552, label: 2, bag_size: 1164
batch 479, loss: 0.0332, instance_loss: 0.2959, weighted_loss: 0.1120, label: 1, bag_size: 1646
batch 499, loss: 0.0004, instance_loss: 0.0196, weighted_loss: 0.0062, label: 1, bag_size: 847
batch 519, loss: 0.0382, instance_loss: 0.1293, weighted_loss: 0.0655, label: 1, bag_size: 1191
batch 539, loss: 0.1334, instance_loss: 0.2621, weighted_loss: 0.1720, label: 2, bag_size: 684


class 0 clustering acc 0.9870183486238532: correct 21517/21800
class 1 clustering acc 0.5277522935779817: correct 2301/4360
Epoch: 35, train_loss: 0.1648, train_clustering_loss:  0.2634, train_error: 0.0440
class 0: acc 0.9907407407407407, correct 107/108
class 1: acc 0.9026548672566371, correct 102/113
class 2: acc 0.9345794392523364, correct 100/107
class 3: acc 0.9722222222222222, correct 105/108
class 4: acc 0.981651376146789, correct 107/109

Val Set, val_loss: 1.2326, val_error: 0.2800, auc: 0.8775
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.42: correct 168/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.9090909090909091, correct 20/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0594, instance_loss: 0.2190, weighted_loss: 0.1073, label: 1, bag_size: 903
batch 39, loss: 0.4660, instance_loss: 0.6002, weighted_loss: 0.5062, label: 1, bag_size: 747
batch 59, loss: 0.0045, instance_loss: 0.0887, weighted_loss: 0.0298, label: 3, bag_size: 16
batch 79, loss: 0.7559, instance_loss: 0.7015, weighted_loss: 0.7396, label: 2, bag_size: 720
batch 99, loss: 0.0291, instance_loss: 0.1194, weighted_loss: 0.0562, label: 1, bag_size: 903
batch 119, loss: 0.0063, instance_loss: 0.2156, weighted_loss: 0.0690, label: 0, bag_size: 117
batch 139, loss: 0.1227, instance_loss: 0.3111, weighted_loss: 0.1793, label: 2, bag_size: 237
batch 159, loss: 0.0020, instance_loss: 0.0214, weighted_loss: 0.0079, label: 3, bag_size: 54
batch 179, loss: 0.1414, instance_loss: 0.3272, weighted_loss: 0.1972, label: 4, bag_size: 1235
batch 199, loss: 0.0019, instance_loss: 0.0538, weighted_loss: 0.0175, label: 4, bag_size: 104
batch 219, loss: 0.2436, instance_loss: 0.5976, weighted_loss: 0.3498, label: 2, bag_size: 720
batch 239, loss: 1.3962, instance_loss: 0.4198, weighted_loss: 1.1033, label: 1, bag_size: 1724
batch 259, loss: 0.0059, instance_loss: 0.2688, weighted_loss: 0.0848, label: 0, bag_size: 114
batch 279, loss: 2.6480, instance_loss: 0.6352, weighted_loss: 2.0442, label: 1, bag_size: 377
batch 299, loss: 0.0000, instance_loss: 0.1273, weighted_loss: 0.0382, label: 4, bag_size: 94
batch 319, loss: 1.5450, instance_loss: 0.8409, weighted_loss: 1.3338, label: 4, bag_size: 511
batch 339, loss: 0.1321, instance_loss: 0.4043, weighted_loss: 0.2138, label: 2, bag_size: 471
batch 359, loss: 0.0000, instance_loss: 0.0179, weighted_loss: 0.0054, label: 4, bag_size: 130
batch 379, loss: 0.0796, instance_loss: 0.3912, weighted_loss: 0.1731, label: 4, bag_size: 656
batch 399, loss: 0.2263, instance_loss: 0.3026, weighted_loss: 0.2492, label: 1, bag_size: 838
batch 419, loss: 0.0017, instance_loss: 0.1448, weighted_loss: 0.0446, label: 0, bag_size: 116
batch 439, loss: 0.1560, instance_loss: 0.6343, weighted_loss: 0.2995, label: 1, bag_size: 651
batch 459, loss: 0.0817, instance_loss: 0.1937, weighted_loss: 0.1153, label: 1, bag_size: 1559
batch 479, loss: 0.1629, instance_loss: 0.4811, weighted_loss: 0.2584, label: 4, bag_size: 1331
batch 499, loss: 0.0588, instance_loss: 0.2782, weighted_loss: 0.1246, label: 0, bag_size: 432
batch 519, loss: 0.0186, instance_loss: 0.5014, weighted_loss: 0.1634, label: 1, bag_size: 319
batch 539, loss: 0.1192, instance_loss: 0.1863, weighted_loss: 0.1393, label: 1, bag_size: 1144


class 0 clustering acc 0.9861926605504587: correct 21499/21800
class 1 clustering acc 0.5472477064220184: correct 2386/4360
Epoch: 36, train_loss: 0.1639, train_clustering_loss:  0.2573, train_error: 0.0514
class 0: acc 0.9801980198019802, correct 99/101
class 1: acc 0.905982905982906, correct 106/117
class 2: acc 0.9038461538461539, correct 94/104
class 3: acc 0.967479674796748, correct 119/123
class 4: acc 0.99, correct 99/100

Val Set, val_loss: 1.2761, val_error: 0.3800, auc: 0.8763
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.32: correct 128/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6818181818181818, correct 15/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0001, instance_loss: 0.1416, weighted_loss: 0.0426, label: 3, bag_size: 16
batch 39, loss: 0.0028, instance_loss: 0.0442, weighted_loss: 0.0152, label: 4, bag_size: 39
batch 59, loss: 0.0009, instance_loss: 0.1109, weighted_loss: 0.0339, label: 0, bag_size: 1235
batch 79, loss: 0.0156, instance_loss: 0.1508, weighted_loss: 0.0562, label: 0, bag_size: 367
batch 99, loss: 0.0022, instance_loss: 0.0340, weighted_loss: 0.0117, label: 3, bag_size: 1069
batch 119, loss: 0.0065, instance_loss: 0.1869, weighted_loss: 0.0606, label: 4, bag_size: 773
batch 139, loss: 0.0427, instance_loss: 0.1596, weighted_loss: 0.0778, label: 1, bag_size: 1191
batch 159, loss: 0.4223, instance_loss: 0.3843, weighted_loss: 0.4109, label: 2, bag_size: 632
batch 179, loss: 0.5381, instance_loss: 0.5396, weighted_loss: 0.5385, label: 3, bag_size: 283
batch 199, loss: 0.0001, instance_loss: 0.0416, weighted_loss: 0.0125, label: 4, bag_size: 211
batch 219, loss: 0.0069, instance_loss: 0.0334, weighted_loss: 0.0148, label: 3, bag_size: 105
batch 239, loss: 0.6054, instance_loss: 0.3493, weighted_loss: 0.5286, label: 2, bag_size: 237
batch 259, loss: 0.0263, instance_loss: 0.3350, weighted_loss: 0.1189, label: 2, bag_size: 943
batch 279, loss: 0.0202, instance_loss: 0.2715, weighted_loss: 0.0956, label: 2, bag_size: 977
batch 299, loss: 0.0193, instance_loss: 0.1994, weighted_loss: 0.0733, label: 4, bag_size: 1278
batch 319, loss: 0.0006, instance_loss: 0.0247, weighted_loss: 0.0078, label: 0, bag_size: 402
batch 339, loss: 0.5378, instance_loss: 0.4056, weighted_loss: 0.4982, label: 4, bag_size: 826
batch 359, loss: 0.0079, instance_loss: 0.1250, weighted_loss: 0.0430, label: 0, bag_size: 731
batch 379, loss: 0.0541, instance_loss: 0.4888, weighted_loss: 0.1845, label: 0, bag_size: 423
batch 399, loss: 0.0563, instance_loss: 0.4913, weighted_loss: 0.1868, label: 1, bag_size: 1390
batch 419, loss: 0.0488, instance_loss: 0.4671, weighted_loss: 0.1743, label: 1, bag_size: 1390
batch 439, loss: 0.1564, instance_loss: 0.3002, weighted_loss: 0.1996, label: 1, bag_size: 533
batch 459, loss: 0.2383, instance_loss: 0.3072, weighted_loss: 0.2590, label: 2, bag_size: 682
batch 479, loss: 0.8497, instance_loss: 0.5939, weighted_loss: 0.7729, label: 1, bag_size: 535
batch 499, loss: 0.5757, instance_loss: 0.7712, weighted_loss: 0.6343, label: 0, bag_size: 818
batch 519, loss: 0.0221, instance_loss: 0.0418, weighted_loss: 0.0280, label: 3, bag_size: 43
batch 539, loss: 0.0429, instance_loss: 0.2314, weighted_loss: 0.0994, label: 2, bag_size: 264


class 0 clustering acc 0.9856880733944954: correct 21488/21800
class 1 clustering acc 0.5389908256880734: correct 2350/4360
Epoch: 37, train_loss: 0.1966, train_clustering_loss:  0.2613, train_error: 0.0661
class 0: acc 0.9565217391304348, correct 110/115
class 1: acc 0.8709677419354839, correct 81/93
class 2: acc 0.8715596330275229, correct 95/109
class 3: acc 0.9752066115702479, correct 118/121
class 4: acc 0.9813084112149533, correct 105/107

Val Set, val_loss: 1.3468, val_error: 0.3800, auc: 0.8844
class 0 clustering acc 0.982: correct 1964/2000
class 1 clustering acc 0.3125: correct 125/400
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6818181818181818, correct 15/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0000, instance_loss: 0.0357, weighted_loss: 0.0108, label: 4, bag_size: 137
batch 39, loss: 0.0007, instance_loss: 0.1472, weighted_loss: 0.0447, label: 3, bag_size: 18
batch 59, loss: 0.0007, instance_loss: 0.0916, weighted_loss: 0.0279, label: 1, bag_size: 1261
batch 79, loss: 0.0022, instance_loss: 0.2610, weighted_loss: 0.0798, label: 1, bag_size: 959
batch 99, loss: 0.0021, instance_loss: 0.0623, weighted_loss: 0.0202, label: 0, bag_size: 476
batch 119, loss: 0.0432, instance_loss: 0.2419, weighted_loss: 0.1028, label: 2, bag_size: 1123
batch 139, loss: 0.0915, instance_loss: 0.1370, weighted_loss: 0.1052, label: 1, bag_size: 847
batch 159, loss: 0.0003, instance_loss: 0.0112, weighted_loss: 0.0036, label: 3, bag_size: 66
batch 179, loss: 0.0008, instance_loss: 0.0434, weighted_loss: 0.0136, label: 0, bag_size: 1174
batch 199, loss: 0.3179, instance_loss: 0.2177, weighted_loss: 0.2878, label: 2, bag_size: 774
batch 219, loss: 0.0714, instance_loss: 0.2647, weighted_loss: 0.1294, label: 0, bag_size: 800
batch 239, loss: 0.0302, instance_loss: 0.3399, weighted_loss: 0.1231, label: 1, bag_size: 242
batch 259, loss: 0.0012, instance_loss: 0.0734, weighted_loss: 0.0229, label: 3, bag_size: 27
batch 279, loss: 0.0000, instance_loss: 0.0821, weighted_loss: 0.0246, label: 4, bag_size: 137
batch 299, loss: 0.0286, instance_loss: 0.1602, weighted_loss: 0.0681, label: 0, bag_size: 381
batch 319, loss: 0.0166, instance_loss: 0.2725, weighted_loss: 0.0934, label: 1, bag_size: 504
batch 339, loss: 0.0000, instance_loss: 0.0699, weighted_loss: 0.0210, label: 4, bag_size: 147
batch 359, loss: 1.0959, instance_loss: 0.4415, weighted_loss: 0.8996, label: 0, bag_size: 255
batch 379, loss: 0.0333, instance_loss: 0.3755, weighted_loss: 0.1359, label: 4, bag_size: 1357
batch 399, loss: 0.0000, instance_loss: 0.0893, weighted_loss: 0.0268, label: 4, bag_size: 24
batch 419, loss: 0.0176, instance_loss: 0.1287, weighted_loss: 0.0509, label: 4, bag_size: 1235
batch 439, loss: 0.0401, instance_loss: 0.1853, weighted_loss: 0.0836, label: 2, bag_size: 1289
batch 459, loss: 1.0583, instance_loss: 0.3976, weighted_loss: 0.8601, label: 0, bag_size: 912
batch 479, loss: 0.0059, instance_loss: 0.0821, weighted_loss: 0.0288, label: 3, bag_size: 28
batch 499, loss: 0.1720, instance_loss: 0.5005, weighted_loss: 0.2706, label: 3, bag_size: 317
batch 519, loss: 0.0805, instance_loss: 0.2698, weighted_loss: 0.1373, label: 2, bag_size: 1006
batch 539, loss: 2.0663, instance_loss: 0.7193, weighted_loss: 1.6622, label: 1, bag_size: 861


class 0 clustering acc 0.9887155963302753: correct 21554/21800
class 1 clustering acc 0.5155963302752293: correct 2248/4360
Epoch: 38, train_loss: 0.1627, train_clustering_loss:  0.2596, train_error: 0.0532
class 0: acc 0.9702970297029703, correct 98/101
class 1: acc 0.8738738738738738, correct 97/111
class 2: acc 0.9047619047619048, correct 95/105
class 3: acc 0.990990990990991, correct 110/111
class 4: acc 0.9914529914529915, correct 116/117

Val Set, val_loss: 1.3067, val_error: 0.3600, auc: 0.8784
class 0 clustering acc 0.9835: correct 1967/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6363636363636364, correct 14/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0038, instance_loss: 0.0814, weighted_loss: 0.0271, label: 3, bag_size: 19
batch 39, loss: 0.1270, instance_loss: 0.4469, weighted_loss: 0.2230, label: 0, bag_size: 1257
batch 59, loss: 0.0005, instance_loss: 0.1355, weighted_loss: 0.0410, label: 0, bag_size: 116
batch 79, loss: 0.0719, instance_loss: 0.2777, weighted_loss: 0.1336, label: 3, bag_size: 343
batch 99, loss: 0.0291, instance_loss: 0.7558, weighted_loss: 0.2471, label: 4, bag_size: 882
batch 119, loss: 0.0715, instance_loss: 0.2792, weighted_loss: 0.1338, label: 1, bag_size: 598
batch 139, loss: 0.0008, instance_loss: 0.0421, weighted_loss: 0.0132, label: 0, bag_size: 446
batch 159, loss: 0.0449, instance_loss: 0.1446, weighted_loss: 0.0748, label: 1, bag_size: 356
batch 179, loss: 0.1244, instance_loss: 0.5953, weighted_loss: 0.2657, label: 1, bag_size: 651
batch 199, loss: 0.0015, instance_loss: 0.1064, weighted_loss: 0.0329, label: 1, bag_size: 866
batch 219, loss: 0.0071, instance_loss: 0.1482, weighted_loss: 0.0494, label: 0, bag_size: 1061
batch 239, loss: 0.8000, instance_loss: 0.2661, weighted_loss: 0.6398, label: 0, bag_size: 1332
batch 259, loss: 0.0278, instance_loss: 0.2612, weighted_loss: 0.0978, label: 2, bag_size: 1348
batch 279, loss: 0.0001, instance_loss: 0.0998, weighted_loss: 0.0300, label: 4, bag_size: 182
batch 299, loss: 0.1797, instance_loss: 0.2497, weighted_loss: 0.2007, label: 0, bag_size: 338
batch 319, loss: 0.0779, instance_loss: 0.3547, weighted_loss: 0.1609, label: 2, bag_size: 471
batch 339, loss: 0.2800, instance_loss: 0.3661, weighted_loss: 0.3058, label: 4, bag_size: 1331
batch 359, loss: 0.7737, instance_loss: 0.4213, weighted_loss: 0.6680, label: 2, bag_size: 948
batch 379, loss: 0.4067, instance_loss: 0.4127, weighted_loss: 0.4085, label: 4, bag_size: 1235
batch 399, loss: 0.0011, instance_loss: 0.0578, weighted_loss: 0.0181, label: 3, bag_size: 33
batch 419, loss: 0.2568, instance_loss: 0.2572, weighted_loss: 0.2569, label: 2, bag_size: 1259
batch 439, loss: 0.0003, instance_loss: 0.0267, weighted_loss: 0.0082, label: 0, bag_size: 1466
batch 459, loss: 1.3296, instance_loss: 0.5560, weighted_loss: 1.0975, label: 1, bag_size: 435
batch 479, loss: 0.0014, instance_loss: 0.0296, weighted_loss: 0.0098, label: 4, bag_size: 43
batch 499, loss: 0.3932, instance_loss: 0.3565, weighted_loss: 0.3822, label: 3, bag_size: 821
batch 519, loss: 0.1189, instance_loss: 0.2117, weighted_loss: 0.1467, label: 1, bag_size: 847
batch 539, loss: 0.0457, instance_loss: 0.3539, weighted_loss: 0.1381, label: 2, bag_size: 803


class 0 clustering acc 0.9876605504587156: correct 21531/21800
class 1 clustering acc 0.5355504587155964: correct 2335/4360
Epoch: 39, train_loss: 0.1784, train_clustering_loss:  0.2556, train_error: 0.0550
class 0: acc 0.9921875, correct 127/128
class 1: acc 0.8504672897196262, correct 91/107
class 2: acc 0.8888888888888888, correct 96/108
class 3: acc 0.989247311827957, correct 92/93
class 4: acc 1.0, correct 109/109

Val Set, val_loss: 1.1715, val_error: 0.3000, auc: 0.8846
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.35: correct 140/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7727272727272727, correct 17/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0032, instance_loss: 0.1567, weighted_loss: 0.0493, label: 0, bag_size: 118
batch 39, loss: 0.0073, instance_loss: 0.2998, weighted_loss: 0.0950, label: 4, bag_size: 17
batch 59, loss: 0.0044, instance_loss: 0.1302, weighted_loss: 0.0422, label: 0, bag_size: 110
batch 79, loss: 0.6130, instance_loss: 0.5485, weighted_loss: 0.5937, label: 1, bag_size: 657
batch 99, loss: 0.1704, instance_loss: 0.4412, weighted_loss: 0.2517, label: 1, bag_size: 747
batch 119, loss: 0.0305, instance_loss: 0.2545, weighted_loss: 0.0977, label: 3, bag_size: 17
batch 139, loss: 0.3483, instance_loss: 0.4581, weighted_loss: 0.3812, label: 2, bag_size: 1024
batch 159, loss: 0.0317, instance_loss: 0.1366, weighted_loss: 0.0631, label: 4, bag_size: 1235
batch 179, loss: 0.0025, instance_loss: 0.0558, weighted_loss: 0.0185, label: 0, bag_size: 976
batch 199, loss: 0.0003, instance_loss: 0.0446, weighted_loss: 0.0136, label: 3, bag_size: 53
batch 219, loss: 2.0348, instance_loss: 0.7478, weighted_loss: 1.6487, label: 1, bag_size: 875
batch 239, loss: 0.0564, instance_loss: 0.2326, weighted_loss: 0.1092, label: 1, bag_size: 534
batch 259, loss: 0.0030, instance_loss: 0.1796, weighted_loss: 0.0560, label: 0, bag_size: 110
batch 279, loss: 0.0338, instance_loss: 0.2660, weighted_loss: 0.1035, label: 1, bag_size: 846
batch 299, loss: 0.1937, instance_loss: 0.3683, weighted_loss: 0.2461, label: 0, bag_size: 800
batch 319, loss: 0.1019, instance_loss: 0.3027, weighted_loss: 0.1621, label: 2, bag_size: 725
batch 339, loss: 0.5049, instance_loss: 0.3460, weighted_loss: 0.4572, label: 2, bag_size: 1050
batch 359, loss: 0.0041, instance_loss: 0.0275, weighted_loss: 0.0111, label: 3, bag_size: 32
batch 379, loss: 0.0085, instance_loss: 0.0654, weighted_loss: 0.0256, label: 1, bag_size: 1127
batch 399, loss: 0.0009, instance_loss: 0.0518, weighted_loss: 0.0161, label: 3, bag_size: 41
batch 419, loss: 0.0003, instance_loss: 0.0514, weighted_loss: 0.0156, label: 3, bag_size: 143
batch 439, loss: 0.0016, instance_loss: 0.0854, weighted_loss: 0.0267, label: 3, bag_size: 60
batch 459, loss: 0.0029, instance_loss: 0.1001, weighted_loss: 0.0321, label: 0, bag_size: 1235
batch 479, loss: 0.1621, instance_loss: 0.5210, weighted_loss: 0.2698, label: 2, bag_size: 567
batch 499, loss: 0.0001, instance_loss: 0.0768, weighted_loss: 0.0231, label: 4, bag_size: 44
batch 519, loss: 0.1034, instance_loss: 0.3255, weighted_loss: 0.1700, label: 2, bag_size: 537
batch 539, loss: 0.0318, instance_loss: 0.1761, weighted_loss: 0.0751, label: 1, bag_size: 858


class 0 clustering acc 0.9886697247706422: correct 21553/21800
class 1 clustering acc 0.5426605504587156: correct 2366/4360
Epoch: 40, train_loss: 0.1467, train_clustering_loss:  0.2521, train_error: 0.0514
class 0: acc 0.9795918367346939, correct 96/98
class 1: acc 0.9, correct 117/130
class 2: acc 0.9012345679012346, correct 73/81
class 3: acc 0.9568965517241379, correct 111/116
class 4: acc 1.0, correct 120/120

Val Set, val_loss: 1.3139, val_error: 0.3200, auc: 0.8803
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.295: correct 118/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7272727272727273, correct 16/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0002, instance_loss: 0.2899, weighted_loss: 0.0871, label: 4, bag_size: 1002
batch 39, loss: 0.0117, instance_loss: 0.1996, weighted_loss: 0.0681, label: 1, bag_size: 696
batch 59, loss: 0.0001, instance_loss: 0.0093, weighted_loss: 0.0029, label: 4, bag_size: 178
batch 79, loss: 0.0030, instance_loss: 0.0709, weighted_loss: 0.0234, label: 1, bag_size: 866
batch 99, loss: 0.0002, instance_loss: 0.0240, weighted_loss: 0.0073, label: 4, bag_size: 150
batch 119, loss: 0.0008, instance_loss: 0.1431, weighted_loss: 0.0435, label: 3, bag_size: 18
batch 139, loss: 0.0118, instance_loss: 0.3685, weighted_loss: 0.1188, label: 1, bag_size: 968
batch 159, loss: 0.1480, instance_loss: 0.4041, weighted_loss: 0.2249, label: 1, bag_size: 887
batch 179, loss: 0.2150, instance_loss: 0.3355, weighted_loss: 0.2512, label: 1, bag_size: 898
batch 199, loss: 0.0025, instance_loss: 0.2378, weighted_loss: 0.0731, label: 0, bag_size: 122
batch 219, loss: 0.4218, instance_loss: 0.2986, weighted_loss: 0.3848, label: 2, bag_size: 632
batch 239, loss: 0.0024, instance_loss: 0.0567, weighted_loss: 0.0187, label: 3, bag_size: 115
batch 259, loss: 0.0001, instance_loss: 0.0192, weighted_loss: 0.0058, label: 0, bag_size: 1599
batch 279, loss: 0.0009, instance_loss: 0.1682, weighted_loss: 0.0510, label: 3, bag_size: 18
batch 299, loss: 0.0095, instance_loss: 0.2798, weighted_loss: 0.0906, label: 3, bag_size: 15
batch 319, loss: 0.0259, instance_loss: 0.2690, weighted_loss: 0.0989, label: 0, bag_size: 437
batch 339, loss: 0.0271, instance_loss: 0.1395, weighted_loss: 0.0608, label: 0, bag_size: 1332
batch 359, loss: 0.1828, instance_loss: 0.3147, weighted_loss: 0.2224, label: 2, bag_size: 636
batch 379, loss: 0.0192, instance_loss: 0.1074, weighted_loss: 0.0457, label: 1, bag_size: 598
batch 399, loss: 0.0000, instance_loss: 0.0237, weighted_loss: 0.0071, label: 4, bag_size: 185
batch 419, loss: 0.0323, instance_loss: 0.1719, weighted_loss: 0.0742, label: 2, bag_size: 636
batch 439, loss: 1.5701, instance_loss: 0.3543, weighted_loss: 1.2053, label: 2, bag_size: 1404
batch 459, loss: 0.0020, instance_loss: 0.4471, weighted_loss: 0.1355, label: 1, bag_size: 786
batch 479, loss: 0.0001, instance_loss: 0.0435, weighted_loss: 0.0131, label: 3, bag_size: 48
batch 499, loss: 0.0003, instance_loss: 0.1136, weighted_loss: 0.0343, label: 3, bag_size: 16
batch 519, loss: 0.0077, instance_loss: 0.2918, weighted_loss: 0.0929, label: 2, bag_size: 278
batch 539, loss: 0.0572, instance_loss: 0.4583, weighted_loss: 0.1776, label: 1, bag_size: 293


class 0 clustering acc 0.9882110091743119: correct 21543/21800
class 1 clustering acc 0.5442660550458716: correct 2373/4360
Epoch: 41, train_loss: 0.1438, train_clustering_loss:  0.2525, train_error: 0.0404
class 0: acc 0.9918032786885246, correct 121/122
class 1: acc 0.9134615384615384, correct 95/104
class 2: acc 0.918918918918919, correct 102/111
class 3: acc 0.9690721649484536, correct 94/97
class 4: acc 1.0, correct 111/111

Val Set, val_loss: 1.1498, val_error: 0.2600, auc: 0.8966
class 0 clustering acc 0.981: correct 1962/2000
class 1 clustering acc 0.4225: correct 169/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8636363636363636, correct 19/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0034, instance_loss: 0.1194, weighted_loss: 0.0382, label: 3, bag_size: 18
batch 39, loss: 2.7929, instance_loss: 0.7302, weighted_loss: 2.1741, label: 1, bag_size: 700
batch 59, loss: 0.0072, instance_loss: 0.0943, weighted_loss: 0.0333, label: 1, bag_size: 369
batch 79, loss: 0.1406, instance_loss: 0.1948, weighted_loss: 0.1569, label: 2, bag_size: 730
batch 99, loss: 0.1818, instance_loss: 0.2771, weighted_loss: 0.2104, label: 2, bag_size: 839
batch 119, loss: 0.0019, instance_loss: 0.0535, weighted_loss: 0.0174, label: 0, bag_size: 976
batch 139, loss: 0.0004, instance_loss: 0.8092, weighted_loss: 0.2430, label: 4, bag_size: 663
batch 159, loss: 0.6673, instance_loss: 0.7227, weighted_loss: 0.6839, label: 0, bag_size: 818
batch 179, loss: 0.0055, instance_loss: 0.1149, weighted_loss: 0.0383, label: 1, bag_size: 790
batch 199, loss: 0.0128, instance_loss: 0.1844, weighted_loss: 0.0643, label: 1, bag_size: 318
batch 219, loss: 0.0003, instance_loss: 0.0194, weighted_loss: 0.0060, label: 0, bag_size: 239
batch 239, loss: 0.0368, instance_loss: 0.2158, weighted_loss: 0.0905, label: 1, bag_size: 1127
batch 259, loss: 0.0436, instance_loss: 0.6762, weighted_loss: 0.2334, label: 3, bag_size: 1250
batch 279, loss: 0.0020, instance_loss: 0.1556, weighted_loss: 0.0481, label: 1, bag_size: 790
batch 299, loss: 0.0332, instance_loss: 0.4421, weighted_loss: 0.1559, label: 2, bag_size: 732
batch 319, loss: 0.0135, instance_loss: 0.1211, weighted_loss: 0.0458, label: 4, bag_size: 91
batch 339, loss: 0.2014, instance_loss: 0.2537, weighted_loss: 0.2171, label: 2, bag_size: 265
batch 359, loss: 0.0515, instance_loss: 0.2531, weighted_loss: 0.1120, label: 2, bag_size: 626
batch 379, loss: 0.0062, instance_loss: 0.3453, weighted_loss: 0.1080, label: 1, bag_size: 1646
batch 399, loss: 0.0612, instance_loss: 0.1881, weighted_loss: 0.0993, label: 1, bag_size: 746
batch 419, loss: 0.0011, instance_loss: 0.0286, weighted_loss: 0.0094, label: 0, bag_size: 518
batch 439, loss: 0.5489, instance_loss: 0.4196, weighted_loss: 0.5101, label: 2, bag_size: 1133
batch 459, loss: 0.0109, instance_loss: 0.1936, weighted_loss: 0.0657, label: 0, bag_size: 155
batch 479, loss: 0.0001, instance_loss: 0.0351, weighted_loss: 0.0106, label: 3, bag_size: 143
batch 499, loss: 0.4725, instance_loss: 0.4153, weighted_loss: 0.4554, label: 2, bag_size: 1133
batch 519, loss: 0.0342, instance_loss: 0.3048, weighted_loss: 0.1154, label: 0, bag_size: 163
batch 539, loss: 0.0010, instance_loss: 0.0726, weighted_loss: 0.0225, label: 1, bag_size: 938


class 0 clustering acc 0.9871100917431193: correct 21519/21800
class 1 clustering acc 0.5527522935779816: correct 2410/4360
Epoch: 42, train_loss: 0.1461, train_clustering_loss:  0.2496, train_error: 0.0459
class 0: acc 0.990990990990991, correct 110/111
class 1: acc 0.8532110091743119, correct 93/109
class 2: acc 0.9504132231404959, correct 115/121
class 3: acc 0.9813084112149533, correct 105/107
class 4: acc 1.0, correct 97/97

Val Set, val_loss: 1.3522, val_error: 0.2800, auc: 0.8687
class 0 clustering acc 0.9775: correct 1955/2000
class 1 clustering acc 0.42: correct 168/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8636363636363636, correct 19/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.1320, instance_loss: 0.2854, weighted_loss: 0.1780, label: 2, bag_size: 649
batch 39, loss: 0.0427, instance_loss: 0.1056, weighted_loss: 0.0615, label: 0, bag_size: 200
batch 59, loss: 0.0102, instance_loss: 0.1358, weighted_loss: 0.0479, label: 1, bag_size: 1127
batch 79, loss: 0.0458, instance_loss: 0.2101, weighted_loss: 0.0951, label: 2, bag_size: 1039
batch 99, loss: 0.0132, instance_loss: 0.2882, weighted_loss: 0.0957, label: 3, bag_size: 791
batch 119, loss: 0.0020, instance_loss: 0.0521, weighted_loss: 0.0170, label: 0, bag_size: 1872
batch 139, loss: 0.0001, instance_loss: 0.0416, weighted_loss: 0.0125, label: 4, bag_size: 150
batch 159, loss: 0.0460, instance_loss: 0.6417, weighted_loss: 0.2247, label: 4, bag_size: 823
batch 179, loss: 0.1517, instance_loss: 0.3593, weighted_loss: 0.2140, label: 0, bag_size: 255
batch 199, loss: 0.0336, instance_loss: 0.5227, weighted_loss: 0.1804, label: 3, bag_size: 671
batch 219, loss: 0.0810, instance_loss: 0.1992, weighted_loss: 0.1165, label: 0, bag_size: 410
batch 239, loss: 0.0263, instance_loss: 0.1951, weighted_loss: 0.0769, label: 2, bag_size: 347
batch 259, loss: 0.0000, instance_loss: 0.0491, weighted_loss: 0.0147, label: 4, bag_size: 48
batch 279, loss: 0.0092, instance_loss: 0.1065, weighted_loss: 0.0384, label: 1, bag_size: 682
batch 299, loss: 0.0345, instance_loss: 0.1958, weighted_loss: 0.0829, label: 0, bag_size: 200
batch 319, loss: 0.1012, instance_loss: 0.2662, weighted_loss: 0.1507, label: 0, bag_size: 294
batch 339, loss: 0.0668, instance_loss: 0.3633, weighted_loss: 0.1557, label: 0, bag_size: 117
batch 359, loss: 0.0142, instance_loss: 0.2924, weighted_loss: 0.0976, label: 4, bag_size: 773
batch 379, loss: 0.0049, instance_loss: 0.1209, weighted_loss: 0.0397, label: 4, bag_size: 86
batch 399, loss: 1.1481, instance_loss: 0.7703, weighted_loss: 1.0348, label: 1, bag_size: 875
batch 419, loss: 0.0050, instance_loss: 0.4352, weighted_loss: 0.1341, label: 3, bag_size: 317
batch 439, loss: 0.0081, instance_loss: 0.2138, weighted_loss: 0.0698, label: 1, bag_size: 356
batch 459, loss: 0.0316, instance_loss: 0.2867, weighted_loss: 0.1082, label: 3, bag_size: 316
batch 479, loss: 0.3719, instance_loss: 0.6321, weighted_loss: 0.4500, label: 2, bag_size: 967
batch 499, loss: 0.0018, instance_loss: 0.1016, weighted_loss: 0.0317, label: 0, bag_size: 933
batch 519, loss: 0.0003, instance_loss: 0.2068, weighted_loss: 0.0622, label: 3, bag_size: 18
batch 539, loss: 0.0000, instance_loss: 0.0864, weighted_loss: 0.0260, label: 4, bag_size: 88


class 0 clustering acc 0.9873394495412844: correct 21524/21800
class 1 clustering acc 0.5383027522935779: correct 2347/4360
Epoch: 43, train_loss: 0.1449, train_clustering_loss:  0.2592, train_error: 0.0514
class 0: acc 0.9907407407407407, correct 107/108
class 1: acc 0.905982905982906, correct 106/117
class 2: acc 0.8737864077669902, correct 90/103
class 3: acc 0.9829059829059829, correct 115/117
class 4: acc 0.99, correct 99/100

Val Set, val_loss: 1.3001, val_error: 0.3200, auc: 0.8757
class 0 clustering acc 0.985: correct 1970/2000
class 1 clustering acc 0.315: correct 126/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.7272727272727273, correct 16/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0002, instance_loss: 0.0218, weighted_loss: 0.0067, label: 3, bag_size: 72
batch 39, loss: 0.0008, instance_loss: 0.1482, weighted_loss: 0.0450, label: 0, bag_size: 148
batch 59, loss: 0.0061, instance_loss: 0.2394, weighted_loss: 0.0761, label: 0, bag_size: 128
batch 79, loss: 0.0010, instance_loss: 0.0356, weighted_loss: 0.0114, label: 4, bag_size: 79
batch 99, loss: 0.0004, instance_loss: 0.0235, weighted_loss: 0.0073, label: 0, bag_size: 933
batch 119, loss: 0.0001, instance_loss: 0.0505, weighted_loss: 0.0152, label: 3, bag_size: 115
batch 139, loss: 0.0099, instance_loss: 0.4192, weighted_loss: 0.1327, label: 2, bag_size: 1653
batch 159, loss: 0.0078, instance_loss: 0.1402, weighted_loss: 0.0475, label: 0, bag_size: 756
batch 179, loss: 0.1330, instance_loss: 0.2362, weighted_loss: 0.1639, label: 2, bag_size: 1404
batch 199, loss: 0.0042, instance_loss: 0.2281, weighted_loss: 0.0713, label: 4, bag_size: 533
batch 219, loss: 0.0146, instance_loss: 0.4733, weighted_loss: 0.1522, label: 1, bag_size: 102
batch 239, loss: 0.1874, instance_loss: 0.5684, weighted_loss: 0.3017, label: 1, bag_size: 1390
batch 259, loss: 0.0001, instance_loss: 0.0573, weighted_loss: 0.0173, label: 4, bag_size: 211
batch 279, loss: 0.0056, instance_loss: 0.1182, weighted_loss: 0.0394, label: 1, bag_size: 534
batch 299, loss: 0.4129, instance_loss: 0.7261, weighted_loss: 0.5068, label: 1, bag_size: 936
batch 319, loss: 0.0075, instance_loss: 0.2720, weighted_loss: 0.0869, label: 0, bag_size: 424
batch 339, loss: 0.0241, instance_loss: 0.3735, weighted_loss: 0.1289, label: 3, bag_size: 936
batch 359, loss: 0.0010, instance_loss: 0.0241, weighted_loss: 0.0079, label: 3, bag_size: 123
batch 379, loss: 0.0001, instance_loss: 0.0571, weighted_loss: 0.0172, label: 1, bag_size: 1376
batch 399, loss: 0.0093, instance_loss: 0.4860, weighted_loss: 0.1523, label: 1, bag_size: 102
batch 419, loss: 0.0007, instance_loss: 0.3035, weighted_loss: 0.0916, label: 3, bag_size: 18
batch 439, loss: 0.3974, instance_loss: 0.1971, weighted_loss: 0.3373, label: 3, bag_size: 15
batch 459, loss: 0.0017, instance_loss: 0.1328, weighted_loss: 0.0410, label: 1, bag_size: 834
batch 479, loss: 0.0015, instance_loss: 0.4968, weighted_loss: 0.1501, label: 4, bag_size: 354
batch 499, loss: 0.0317, instance_loss: 0.1885, weighted_loss: 0.0787, label: 1, bag_size: 405
batch 519, loss: 0.0018, instance_loss: 0.1039, weighted_loss: 0.0324, label: 0, bag_size: 760
batch 539, loss: 0.0013, instance_loss: 0.0415, weighted_loss: 0.0133, label: 0, bag_size: 340


class 0 clustering acc 0.9872477064220183: correct 21522/21800
class 1 clustering acc 0.5777522935779816: correct 2519/4360
Epoch: 44, train_loss: 0.0998, train_clustering_loss:  0.2380, train_error: 0.0239
class 0: acc 0.990909090909091, correct 109/110
class 1: acc 0.9223300970873787, correct 95/103
class 2: acc 0.9716981132075472, correct 103/106
class 3: acc 0.9913793103448276, correct 115/116
class 4: acc 1.0, correct 110/110

Val Set, val_loss: 1.3687, val_error: 0.3000, auc: 0.8759
class 0 clustering acc 0.98: correct 1960/2000
class 1 clustering acc 0.355: correct 142/400
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8181818181818182, correct 18/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 39 out of 20


batch 19, loss: 1.3926, instance_loss: 0.5718, weighted_loss: 1.1464, label: 1, bag_size: 446
batch 39, loss: 0.2634, instance_loss: 0.2889, weighted_loss: 0.2711, label: 0, bag_size: 545
batch 59, loss: 0.0024, instance_loss: 0.0256, weighted_loss: 0.0093, label: 1, bag_size: 369
batch 79, loss: 0.0004, instance_loss: 0.1309, weighted_loss: 0.0396, label: 0, bag_size: 155
batch 99, loss: 0.1401, instance_loss: 0.9056, weighted_loss: 0.3698, label: 3, bag_size: 200
batch 119, loss: 0.0000, instance_loss: 0.0217, weighted_loss: 0.0065, label: 4, bag_size: 104
batch 139, loss: 0.0841, instance_loss: 0.9605, weighted_loss: 0.3470, label: 3, bag_size: 211
batch 159, loss: 0.0637, instance_loss: 0.3711, weighted_loss: 0.1559, label: 2, bag_size: 373
batch 179, loss: 0.0037, instance_loss: 0.0874, weighted_loss: 0.0288, label: 1, bag_size: 356
batch 199, loss: 0.0130, instance_loss: 0.3822, weighted_loss: 0.1237, label: 2, bag_size: 408
batch 219, loss: 0.1524, instance_loss: 0.4256, weighted_loss: 0.2343, label: 4, bag_size: 1331
batch 239, loss: 0.0084, instance_loss: 0.0823, weighted_loss: 0.0306, label: 1, bag_size: 690
batch 259, loss: 0.0000, instance_loss: 0.0774, weighted_loss: 0.0232, label: 4, bag_size: 192
batch 279, loss: 0.0002, instance_loss: 0.0224, weighted_loss: 0.0069, label: 4, bag_size: 160
batch 299, loss: 0.0001, instance_loss: 0.0813, weighted_loss: 0.0245, label: 3, bag_size: 33
batch 319, loss: 0.0001, instance_loss: 0.0198, weighted_loss: 0.0060, label: 4, bag_size: 137
batch 339, loss: 0.0003, instance_loss: 0.2761, weighted_loss: 0.0830, label: 4, bag_size: 974
batch 359, loss: 0.0381, instance_loss: 0.2019, weighted_loss: 0.0872, label: 4, bag_size: 524
batch 379, loss: 0.4178, instance_loss: 0.3182, weighted_loss: 0.3880, label: 4, bag_size: 826
batch 399, loss: 0.0826, instance_loss: 0.2675, weighted_loss: 0.1381, label: 0, bag_size: 472
batch 419, loss: 0.0978, instance_loss: 0.4290, weighted_loss: 0.1971, label: 1, bag_size: 1273
batch 439, loss: 0.0156, instance_loss: 0.1686, weighted_loss: 0.0615, label: 1, bag_size: 598
batch 459, loss: 0.0019, instance_loss: 0.3839, weighted_loss: 0.1165, label: 3, bag_size: 317
batch 479, loss: 0.0045, instance_loss: 0.1953, weighted_loss: 0.0618, label: 0, bag_size: 110
batch 499, loss: 0.0338, instance_loss: 0.2959, weighted_loss: 0.1124, label: 1, bag_size: 242
batch 519, loss: 0.0629, instance_loss: 0.3712, weighted_loss: 0.1554, label: 1, bag_size: 648
batch 539, loss: 0.0019, instance_loss: 0.2198, weighted_loss: 0.0673, label: 3, bag_size: 16


class 0 clustering acc 0.9872477064220183: correct 21522/21800
class 1 clustering acc 0.5798165137614679: correct 2528/4360
Epoch: 45, train_loss: 0.1433, train_clustering_loss:  0.2424, train_error: 0.0495
class 0: acc 0.992, correct 124/125
class 1: acc 0.8924731182795699, correct 83/93
class 2: acc 0.8817204301075269, correct 82/93
class 3: acc 0.9636363636363636, correct 106/110
class 4: acc 0.9919354838709677, correct 123/124

Val Set, val_loss: 1.3581, val_error: 0.3200, auc: 0.8727
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.3925: correct 157/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7727272727272727, correct 17/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.0080, instance_loss: 0.1897, weighted_loss: 0.0625, label: 0, bag_size: 371
batch 39, loss: 0.0137, instance_loss: 0.2592, weighted_loss: 0.0874, label: 4, bag_size: 524
batch 59, loss: 0.0132, instance_loss: 0.1447, weighted_loss: 0.0527, label: 0, bag_size: 437
batch 79, loss: 0.0000, instance_loss: 0.0317, weighted_loss: 0.0095, label: 4, bag_size: 140
batch 99, loss: 0.0003, instance_loss: 0.1459, weighted_loss: 0.0440, label: 3, bag_size: 31
batch 119, loss: 0.0050, instance_loss: 0.0300, weighted_loss: 0.0125, label: 1, bag_size: 937
batch 139, loss: 0.0075, instance_loss: 0.9223, weighted_loss: 0.2820, label: 3, bag_size: 1167
batch 159, loss: 0.0949, instance_loss: 0.2471, weighted_loss: 0.1405, label: 1, bag_size: 614
batch 179, loss: 0.0437, instance_loss: 0.4415, weighted_loss: 0.1631, label: 1, bag_size: 648
batch 199, loss: 0.0000, instance_loss: 0.0615, weighted_loss: 0.0185, label: 4, bag_size: 47
batch 219, loss: 0.0006, instance_loss: 0.0302, weighted_loss: 0.0095, label: 3, bag_size: 54
batch 239, loss: 0.0217, instance_loss: 0.4858, weighted_loss: 0.1609, label: 1, bag_size: 700
batch 259, loss: 0.0105, instance_loss: 0.1229, weighted_loss: 0.0442, label: 2, bag_size: 317
batch 279, loss: 0.1716, instance_loss: 0.2506, weighted_loss: 0.1953, label: 0, bag_size: 410
batch 299, loss: 0.0214, instance_loss: 0.3386, weighted_loss: 0.1166, label: 0, bag_size: 114
batch 319, loss: 0.0190, instance_loss: 0.3509, weighted_loss: 0.1186, label: 1, bag_size: 867
batch 339, loss: 0.0198, instance_loss: 0.5184, weighted_loss: 0.1694, label: 4, bag_size: 354
batch 359, loss: 0.0046, instance_loss: 0.0944, weighted_loss: 0.0316, label: 3, bag_size: 18
batch 379, loss: 0.0001, instance_loss: 0.0146, weighted_loss: 0.0045, label: 4, bag_size: 148
batch 399, loss: 0.0101, instance_loss: 0.1997, weighted_loss: 0.0670, label: 1, bag_size: 838
batch 419, loss: 0.1752, instance_loss: 0.6288, weighted_loss: 0.3113, label: 0, bag_size: 423
batch 439, loss: 0.0013, instance_loss: 0.1741, weighted_loss: 0.0531, label: 0, bag_size: 155
batch 459, loss: 0.1108, instance_loss: 0.3476, weighted_loss: 0.1818, label: 2, bag_size: 1306
batch 479, loss: 0.0102, instance_loss: 0.2201, weighted_loss: 0.0732, label: 0, bag_size: 1196
batch 499, loss: 0.0203, instance_loss: 0.3448, weighted_loss: 0.1177, label: 0, bag_size: 163
batch 519, loss: 0.0030, instance_loss: 0.1512, weighted_loss: 0.0475, label: 0, bag_size: 1235
batch 539, loss: 0.5409, instance_loss: 0.2426, weighted_loss: 0.4514, label: 0, bag_size: 117


class 0 clustering acc 0.9874311926605505: correct 21526/21800
class 1 clustering acc 0.5321100917431193: correct 2320/4360
Epoch: 46, train_loss: 0.1084, train_clustering_loss:  0.2568, train_error: 0.0312
class 0: acc 1.0, correct 114/114
class 1: acc 0.9327731092436975, correct 111/119
class 2: acc 0.9285714285714286, correct 104/112
class 3: acc 0.9895833333333334, correct 95/96
class 4: acc 1.0, correct 104/104

Val Set, val_loss: 1.4530, val_error: 0.3600, auc: 0.8775
class 0 clustering acc 0.9785: correct 1957/2000
class 1 clustering acc 0.4025: correct 161/400
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6818181818181818, correct 15/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.0046, instance_loss: 0.0624, weighted_loss: 0.0220, label: 0, bag_size: 1174
batch 39, loss: 0.0268, instance_loss: 0.1183, weighted_loss: 0.0542, label: 0, bag_size: 607
batch 59, loss: 0.0028, instance_loss: 0.2265, weighted_loss: 0.0699, label: 1, bag_size: 898
batch 79, loss: 0.0380, instance_loss: 0.2412, weighted_loss: 0.0989, label: 1, bag_size: 530
batch 99, loss: 0.0503, instance_loss: 0.1865, weighted_loss: 0.0911, label: 2, bag_size: 1200
batch 119, loss: 0.0291, instance_loss: 0.2357, weighted_loss: 0.0911, label: 0, bag_size: 1579
batch 139, loss: 0.0069, instance_loss: 0.0805, weighted_loss: 0.0290, label: 3, bag_size: 1172
batch 159, loss: 0.0663, instance_loss: 0.2150, weighted_loss: 0.1109, label: 1, bag_size: 746
batch 179, loss: 0.7952, instance_loss: 0.5660, weighted_loss: 0.7264, label: 2, bag_size: 959
batch 199, loss: 0.0065, instance_loss: 0.7549, weighted_loss: 0.2310, label: 3, bag_size: 1380
batch 219, loss: 0.1202, instance_loss: 0.6427, weighted_loss: 0.2770, label: 3, bag_size: 1250
batch 239, loss: 0.1382, instance_loss: 0.5348, weighted_loss: 0.2572, label: 1, bag_size: 747
batch 259, loss: 0.0001, instance_loss: 0.0512, weighted_loss: 0.0154, label: 3, bag_size: 50
batch 279, loss: 0.0087, instance_loss: 0.0472, weighted_loss: 0.0203, label: 1, bag_size: 1191
batch 299, loss: 0.0005, instance_loss: 0.1329, weighted_loss: 0.0402, label: 4, bag_size: 29
batch 319, loss: 0.1519, instance_loss: 0.2500, weighted_loss: 0.1813, label: 3, bag_size: 533
batch 339, loss: 0.0056, instance_loss: 0.1804, weighted_loss: 0.0581, label: 2, bag_size: 626
batch 359, loss: 0.1198, instance_loss: 0.6032, weighted_loss: 0.2648, label: 1, bag_size: 1390
batch 379, loss: 0.2160, instance_loss: 0.4456, weighted_loss: 0.2849, label: 1, bag_size: 386
batch 399, loss: 0.2930, instance_loss: 0.2496, weighted_loss: 0.2800, label: 2, bag_size: 295
batch 419, loss: 0.0005, instance_loss: 0.0420, weighted_loss: 0.0130, label: 3, bag_size: 46
batch 439, loss: 0.0129, instance_loss: 0.5471, weighted_loss: 0.1732, label: 1, bag_size: 1390
batch 459, loss: 0.2822, instance_loss: 0.3529, weighted_loss: 0.3034, label: 0, bag_size: 545
batch 479, loss: 0.8680, instance_loss: 0.5303, weighted_loss: 0.7667, label: 2, bag_size: 795
batch 499, loss: 0.0087, instance_loss: 0.4309, weighted_loss: 0.1354, label: 1, bag_size: 1646
batch 519, loss: 0.2607, instance_loss: 0.4420, weighted_loss: 0.3151, label: 1, bag_size: 657
batch 539, loss: 0.0490, instance_loss: 0.3578, weighted_loss: 0.1417, label: 0, bag_size: 1289


class 0 clustering acc 0.9860550458715597: correct 21496/21800
class 1 clustering acc 0.5527522935779816: correct 2410/4360
Epoch: 47, train_loss: 0.1186, train_clustering_loss:  0.2589, train_error: 0.0275
class 0: acc 0.9916666666666667, correct 119/120
class 1: acc 0.9322033898305084, correct 110/118
class 2: acc 0.9642857142857143, correct 108/112
class 3: acc 0.9803921568627451, correct 100/102
class 4: acc 1.0, correct 93/93

Val Set, val_loss: 1.6062, val_error: 0.4000, auc: 0.8915
class 0 clustering acc 0.9755: correct 1951/2000
class 1 clustering acc 0.35: correct 140/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5, correct 11/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.0275, instance_loss: 0.1744, weighted_loss: 0.0716, label: 2, bag_size: 1281
batch 39, loss: 0.0114, instance_loss: 0.1681, weighted_loss: 0.0584, label: 2, bag_size: 1215
batch 59, loss: 0.0003, instance_loss: 0.1009, weighted_loss: 0.0305, label: 4, bag_size: 40
batch 79, loss: 0.0018, instance_loss: 0.1662, weighted_loss: 0.0511, label: 0, bag_size: 118
batch 99, loss: 0.0063, instance_loss: 0.1067, weighted_loss: 0.0364, label: 1, bag_size: 1325
batch 119, loss: 0.0267, instance_loss: 0.1883, weighted_loss: 0.0752, label: 2, bag_size: 395
batch 139, loss: 0.1194, instance_loss: 0.4882, weighted_loss: 0.2300, label: 4, bag_size: 297
batch 159, loss: 0.0001, instance_loss: 0.0208, weighted_loss: 0.0063, label: 4, bag_size: 125
batch 179, loss: 1.4475, instance_loss: 0.6705, weighted_loss: 1.2144, label: 3, bag_size: 281
batch 199, loss: 0.0016, instance_loss: 0.4587, weighted_loss: 0.1387, label: 1, bag_size: 102
batch 219, loss: 0.0002, instance_loss: 0.1869, weighted_loss: 0.0562, label: 1, bag_size: 318
batch 239, loss: 0.0119, instance_loss: 0.0523, weighted_loss: 0.0240, label: 3, bag_size: 97
batch 259, loss: 0.0050, instance_loss: 0.2033, weighted_loss: 0.0645, label: 0, bag_size: 128
batch 279, loss: 0.0006, instance_loss: 0.0774, weighted_loss: 0.0237, label: 0, bag_size: 1018
batch 299, loss: 0.0271, instance_loss: 0.3422, weighted_loss: 0.1216, label: 2, bag_size: 916
batch 319, loss: 0.0001, instance_loss: 0.3769, weighted_loss: 0.1131, label: 4, bag_size: 974
batch 339, loss: 0.0608, instance_loss: 0.2667, weighted_loss: 0.1226, label: 1, bag_size: 838
batch 359, loss: 0.0351, instance_loss: 0.7798, weighted_loss: 0.2585, label: 3, bag_size: 607
batch 379, loss: 0.0019, instance_loss: 0.0215, weighted_loss: 0.0078, label: 1, bag_size: 937
batch 399, loss: 0.0387, instance_loss: 0.5923, weighted_loss: 0.2048, label: 0, bag_size: 818
batch 419, loss: 0.1405, instance_loss: 0.4396, weighted_loss: 0.2302, label: 2, bag_size: 471
batch 439, loss: 0.0024, instance_loss: 0.1543, weighted_loss: 0.0480, label: 0, bag_size: 807
batch 459, loss: 0.0714, instance_loss: 0.3259, weighted_loss: 0.1478, label: 0, bag_size: 759
batch 479, loss: 0.0720, instance_loss: 0.1969, weighted_loss: 0.1095, label: 1, bag_size: 320
batch 499, loss: 0.1705, instance_loss: 0.3269, weighted_loss: 0.2174, label: 2, bag_size: 868
batch 519, loss: 0.1336, instance_loss: 0.3014, weighted_loss: 0.1839, label: 2, bag_size: 355
batch 539, loss: 0.1959, instance_loss: 0.3253, weighted_loss: 0.2347, label: 2, bag_size: 330


class 0 clustering acc 0.9846330275229358: correct 21465/21800
class 1 clustering acc 0.5685779816513762: correct 2479/4360
Epoch: 48, train_loss: 0.0943, train_clustering_loss:  0.2478, train_error: 0.0275
class 0: acc 1.0, correct 107/107
class 1: acc 0.9021739130434783, correct 83/92
class 2: acc 0.954954954954955, correct 106/111
class 3: acc 0.9916666666666667, correct 119/120
class 4: acc 1.0, correct 115/115

Val Set, val_loss: 1.4405, val_error: 0.3600, auc: 0.8991
class 0 clustering acc 0.9805: correct 1961/2000
class 1 clustering acc 0.36: correct 144/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.5454545454545454, correct 12/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.0811, instance_loss: 0.0972, weighted_loss: 0.0859, label: 1, bag_size: 697
batch 39, loss: 0.0001, instance_loss: 0.0218, weighted_loss: 0.0066, label: 4, bag_size: 79
batch 59, loss: 0.0000, instance_loss: 0.0348, weighted_loss: 0.0104, label: 4, bag_size: 192
batch 79, loss: 0.0007, instance_loss: 0.0389, weighted_loss: 0.0122, label: 0, bag_size: 1018
batch 99, loss: 0.1143, instance_loss: 0.0632, weighted_loss: 0.0990, label: 3, bag_size: 105
batch 119, loss: 0.0059, instance_loss: 0.0872, weighted_loss: 0.0303, label: 4, bag_size: 147
batch 139, loss: 0.0050, instance_loss: 0.1091, weighted_loss: 0.0362, label: 0, bag_size: 607
batch 159, loss: 0.0004, instance_loss: 0.0543, weighted_loss: 0.0165, label: 3, bag_size: 123
batch 179, loss: 0.0000, instance_loss: 0.0308, weighted_loss: 0.0093, label: 3, bag_size: 53
batch 199, loss: 0.0002, instance_loss: 0.0561, weighted_loss: 0.0169, label: 4, bag_size: 39
batch 219, loss: 0.0000, instance_loss: 0.0325, weighted_loss: 0.0097, label: 4, bag_size: 140
batch 239, loss: 0.8414, instance_loss: 0.6214, weighted_loss: 0.7754, label: 1, bag_size: 446
batch 259, loss: 0.0032, instance_loss: 0.0681, weighted_loss: 0.0227, label: 0, bag_size: 1872
batch 279, loss: 0.1627, instance_loss: 0.3956, weighted_loss: 0.2326, label: 1, bag_size: 405
batch 299, loss: 0.0000, instance_loss: 0.0569, weighted_loss: 0.0171, label: 4, bag_size: 134
batch 319, loss: 0.1838, instance_loss: 0.2776, weighted_loss: 0.2119, label: 0, bag_size: 1289
batch 339, loss: 0.5150, instance_loss: 0.2834, weighted_loss: 0.4455, label: 4, bag_size: 1278
batch 359, loss: 0.0011, instance_loss: 0.3516, weighted_loss: 0.1063, label: 1, bag_size: 1152
batch 379, loss: 0.0159, instance_loss: 0.0912, weighted_loss: 0.0385, label: 0, bag_size: 1133
batch 399, loss: 0.0043, instance_loss: 0.2968, weighted_loss: 0.0920, label: 1, bag_size: 1144
batch 419, loss: 0.0000, instance_loss: 0.1454, weighted_loss: 0.0436, label: 4, bag_size: 19
batch 439, loss: 0.0000, instance_loss: 0.0238, weighted_loss: 0.0072, label: 4, bag_size: 211
batch 459, loss: 0.0005, instance_loss: 0.0989, weighted_loss: 0.0300, label: 4, bag_size: 24
batch 479, loss: 0.0062, instance_loss: 0.0754, weighted_loss: 0.0270, label: 1, bag_size: 1191
batch 499, loss: 0.0264, instance_loss: 0.1956, weighted_loss: 0.0772, label: 3, bag_size: 18
batch 519, loss: 0.0010, instance_loss: 0.0651, weighted_loss: 0.0203, label: 1, bag_size: 886
batch 539, loss: 0.0045, instance_loss: 0.2151, weighted_loss: 0.0677, label: 2, bag_size: 1788


class 0 clustering acc 0.9865596330275229: correct 21507/21800
class 1 clustering acc 0.6213302752293578: correct 2709/4360
Epoch: 49, train_loss: 0.0717, train_clustering_loss:  0.2232, train_error: 0.0220
class 0: acc 0.9809523809523809, correct 103/105
class 1: acc 0.9433962264150944, correct 100/106
class 2: acc 0.9727272727272728, correct 107/110
class 3: acc 0.9908256880733946, correct 108/109
class 4: acc 1.0, correct 115/115

Val Set, val_loss: 1.4905, val_error: 0.3000, auc: 0.8712
class 0 clustering acc 0.9715: correct 1943/2000
class 1 clustering acc 0.435: correct 174/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7272727272727273, correct 16/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.2650, instance_loss: 0.4665, weighted_loss: 0.3255, label: 1, bag_size: 530
batch 39, loss: 0.0016, instance_loss: 0.0370, weighted_loss: 0.0122, label: 1, bag_size: 944
batch 59, loss: 0.1257, instance_loss: 0.1255, weighted_loss: 0.1256, label: 1, bag_size: 746
batch 79, loss: 0.0031, instance_loss: 0.2152, weighted_loss: 0.0667, label: 0, bag_size: 128
batch 99, loss: 0.0000, instance_loss: 0.1508, weighted_loss: 0.0453, label: 4, bag_size: 20
batch 119, loss: 0.0899, instance_loss: 0.3421, weighted_loss: 0.1655, label: 1, bag_size: 343
batch 139, loss: 0.0196, instance_loss: 0.4718, weighted_loss: 0.1552, label: 0, bag_size: 801
batch 159, loss: 0.0168, instance_loss: 0.6000, weighted_loss: 0.1918, label: 2, bag_size: 248
batch 179, loss: 0.0097, instance_loss: 0.1891, weighted_loss: 0.0636, label: 4, bag_size: 17
batch 199, loss: 0.0869, instance_loss: 0.5122, weighted_loss: 0.2145, label: 2, bag_size: 1069
batch 219, loss: 0.0005, instance_loss: 0.0626, weighted_loss: 0.0191, label: 4, bag_size: 160
batch 239, loss: 0.0029, instance_loss: 0.0694, weighted_loss: 0.0229, label: 3, bag_size: 34
batch 259, loss: 0.0008, instance_loss: 0.1283, weighted_loss: 0.0391, label: 0, bag_size: 807
batch 279, loss: 0.2624, instance_loss: 0.1484, weighted_loss: 0.2282, label: 1, bag_size: 847
batch 299, loss: 0.0498, instance_loss: 0.2644, weighted_loss: 0.1142, label: 0, bag_size: 524
batch 319, loss: 0.0035, instance_loss: 0.0828, weighted_loss: 0.0273, label: 0, bag_size: 731
batch 339, loss: 0.0447, instance_loss: 0.2940, weighted_loss: 0.1195, label: 2, bag_size: 986
batch 359, loss: 0.0073, instance_loss: 0.0901, weighted_loss: 0.0321, label: 3, bag_size: 75
batch 379, loss: 0.0017, instance_loss: 0.3509, weighted_loss: 0.1065, label: 0, bag_size: 653
batch 399, loss: 0.0008, instance_loss: 0.2074, weighted_loss: 0.0628, label: 3, bag_size: 16
batch 419, loss: 0.0064, instance_loss: 0.3039, weighted_loss: 0.0957, label: 3, bag_size: 841
batch 439, loss: 0.0085, instance_loss: 0.0873, weighted_loss: 0.0321, label: 0, bag_size: 607
batch 459, loss: 0.3077, instance_loss: 0.2268, weighted_loss: 0.2834, label: 0, bag_size: 545
batch 479, loss: 0.0082, instance_loss: 0.3466, weighted_loss: 0.1098, label: 3, bag_size: 18
batch 499, loss: 0.0340, instance_loss: 0.1784, weighted_loss: 0.0773, label: 1, bag_size: 348
batch 519, loss: 0.1231, instance_loss: 0.2260, weighted_loss: 0.1540, label: 2, bag_size: 265
batch 539, loss: 0.0242, instance_loss: 0.1836, weighted_loss: 0.0720, label: 4, bag_size: 1474


class 0 clustering acc 0.9844954128440367: correct 21462/21800
class 1 clustering acc 0.5548165137614679: correct 2419/4360
Epoch: 50, train_loss: 0.1163, train_clustering_loss:  0.2585, train_error: 0.0404
class 0: acc 0.9911504424778761, correct 112/113
class 1: acc 0.8962264150943396, correct 95/106
class 2: acc 0.9401709401709402, correct 110/117
class 3: acc 0.990909090909091, correct 109/110
class 4: acc 0.9797979797979798, correct 97/99

Val Set, val_loss: 1.3806, val_error: 0.3600, auc: 0.8855
class 0 clustering acc 0.979: correct 1958/2000
class 1 clustering acc 0.3975: correct 159/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.5909090909090909, correct 13/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 45 out of 20


batch 19, loss: 0.0001, instance_loss: 0.0163, weighted_loss: 0.0049, label: 0, bag_size: 518
batch 39, loss: 0.0007, instance_loss: 0.2203, weighted_loss: 0.0666, label: 0, bag_size: 176
batch 59, loss: 0.0220, instance_loss: 0.9251, weighted_loss: 0.2929, label: 3, bag_size: 211
batch 79, loss: 0.0008, instance_loss: 0.3969, weighted_loss: 0.1196, label: 4, bag_size: 14
batch 99, loss: 0.0136, instance_loss: 0.1356, weighted_loss: 0.0502, label: 0, bag_size: 962
batch 119, loss: 0.1194, instance_loss: 0.3553, weighted_loss: 0.1902, label: 2, bag_size: 1133
batch 139, loss: 0.0278, instance_loss: 0.2715, weighted_loss: 0.1009, label: 2, bag_size: 621
batch 159, loss: 0.0000, instance_loss: 0.0991, weighted_loss: 0.0297, label: 4, bag_size: 128
batch 179, loss: 0.2086, instance_loss: 0.8737, weighted_loss: 0.4081, label: 3, bag_size: 607
batch 199, loss: 0.0603, instance_loss: 0.2330, weighted_loss: 0.1121, label: 0, bag_size: 200
batch 219, loss: 0.0129, instance_loss: 0.1656, weighted_loss: 0.0587, label: 2, bag_size: 1514
batch 239, loss: 0.0096, instance_loss: 0.0781, weighted_loss: 0.0302, label: 2, bag_size: 455
batch 259, loss: 1.6859, instance_loss: 0.8205, weighted_loss: 1.4263, label: 1, bag_size: 700
batch 279, loss: 0.0092, instance_loss: 0.2325, weighted_loss: 0.0762, label: 0, bag_size: 424
batch 299, loss: 0.2158, instance_loss: 0.3713, weighted_loss: 0.2625, label: 2, bag_size: 682
batch 319, loss: 0.0301, instance_loss: 0.2717, weighted_loss: 0.1026, label: 1, bag_size: 470
batch 339, loss: 0.0013, instance_loss: 0.3083, weighted_loss: 0.0934, label: 1, bag_size: 504
batch 359, loss: 0.0634, instance_loss: 0.1903, weighted_loss: 0.1015, label: 0, bag_size: 294
batch 379, loss: 0.0224, instance_loss: 0.2022, weighted_loss: 0.0764, label: 1, bag_size: 320
batch 399, loss: 0.4627, instance_loss: 0.4436, weighted_loss: 0.4570, label: 2, bag_size: 1006
batch 419, loss: 0.0366, instance_loss: 0.2030, weighted_loss: 0.0865, label: 4, bag_size: 826
batch 439, loss: 0.0739, instance_loss: 0.3720, weighted_loss: 0.1634, label: 2, bag_size: 278
batch 459, loss: 0.0539, instance_loss: 0.1138, weighted_loss: 0.0719, label: 2, bag_size: 455
batch 479, loss: 0.0007, instance_loss: 0.1831, weighted_loss: 0.0554, label: 0, bag_size: 176
batch 499, loss: 0.0000, instance_loss: 0.1360, weighted_loss: 0.0408, label: 4, bag_size: 134
batch 519, loss: 0.0005, instance_loss: 0.1726, weighted_loss: 0.0521, label: 0, bag_size: 136
batch 539, loss: 0.0181, instance_loss: 0.2462, weighted_loss: 0.0866, label: 2, bag_size: 828


class 0 clustering acc 0.9862844036697248: correct 21501/21800
class 1 clustering acc 0.5561926605504587: correct 2425/4360
Epoch: 51, train_loss: 0.0802, train_clustering_loss:  0.2530, train_error: 0.0165
class 0: acc 1.0, correct 108/108
class 1: acc 0.9396551724137931, correct 109/116
class 2: acc 0.9826086956521739, correct 113/115
class 3: acc 1.0, correct 103/103
class 4: acc 1.0, correct 103/103

Val Set, val_loss: 1.4834, val_error: 0.3600, auc: 0.8744
class 0 clustering acc 0.9765: correct 1953/2000
class 1 clustering acc 0.39: correct 156/400
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6363636363636364, correct 14/22
class 3: acc 1.0, correct 2/2
class 4: acc 0.625, correct 5/8
EarlyStopping counter: 46 out of 20
Early stopping
Val error: 0.3800, ROC AUC: 0.8984
Test error: 0.3800, ROC AUC: 0.7634
class 0: acc 0.9375, correct 15/16
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.6190476190476191, correct 13/21
class 3: acc 0.0, correct 0/2
class 4: acc 0.5, correct 1/2
finished!
end script
